<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit"/>
<meta name="force-rendering" content="webkit"/>
<meta name="referrer" content="always" />
<meta name="description" content="安全KER - 安全资讯平台" />
<link rel="icon" href="https://s3.ssl.qhres2.com/static/02b5158bbb6adeac.ico" type="image/x-icon" />
<link rel="shortcut icon" href="https://s3.ssl.qhres2.com/static/02b5158bbb6adeac.ico" type="image/x-icon" />
<meta name="keywords"
    content="安全媒体,安全资讯,安全知识, 安全热点,安全招聘,安全趋势,移动安全,网站安全,终端安全,无线安全,工控安全,物联网安全,WEB安全,系统安全,网络安全,区块链安全,安全活动,信息安全,安全预警,安全会议" />

  <title>Konni APT 组织以朝鲜疫情物资话题为诱饵的攻击活动分析-安全KER - 安全资讯平台</title>
  <meta name="description" content="安全KER - 安全资讯平台" />
  <meta name="keywords"
    content="安全媒体,安全资讯,安全知识, 安全热点,安全招聘,安全趋势,移动安全,网站安全,终端安全,无线安全,工控安全,物联网安全,WEB安全,系统安全,网络安全,区块链安全,安全活动,信息安全,安全预警,安全会议" />
  <script>(function(window){
        

function empty() {}

empty();
      })(this);</script>

<link rel="stylesheet" href="https://s1.ssl.qhimg.com/static/d4cec9cd8efbfd10.css">
<link rel="stylesheet" href="https://s1.ssl.qhimg.com/static/a51843d6b82241be,d94674bd62441768,56ce5cef8079a575,e98ec238ee2ffb39,4802c0c382205144,1b5a1fb730023ac8,837278d6b5419b90,c7765696eed0082a,f1af72694eaaa012,683a3fb8c1059410,49838656db94d1e8,ba6e842bd2d94f68,a929f1bafe3273eb,9af1a80d0fb89e1c,d862a00f51adc0b3,409c729e71612781,86af6fd9b93edda6,4259dd4f2283e279,7c59ccb9d3cd9415,c60211756006c43c,8f60519783ce29e3,0dcf6db729973e3e,5f39838e3d3adabf,3f8755b1df1963af,9cb495849e780c9d,f6c764a295c746ab,ebf4b8e2a4618051,1c9f8ac823a5b02a,8101669cb8389279,810b29c6ecc6ef26,7a9446af61fe322b.css">
<script>window._dynamic_deps_={}</script>
</head>

<body>
  <div id='app'><!--[--><div class="_10" style="height:60px;"><div class="g-w"><a class="logo" href="/"></a><div class="_11"><!--[--><div class="item"><div style="cursor:pointer;"><span>首页</span><ul><!--[--><!--]--></ul></div></div><div class="item"><div style=""><span>阅读</span><ul><!--[--><li class="sub-item"><a href=" https://www.anquanke.com/news">安全资讯</a></li><li class="sub-item"><a href="https://www.anquanke.com/knowledge">安全知识</a></li><li class="sub-item"><a href="https://www.anquanke.com/tool">安全工具</a></li><!--]--></ul></div></div><div class="item"><div style="cursor:pointer;"><span>活动</span><ul><!--[--><!--]--></ul></div></div><div class="item"><div style="cursor:pointer;"><span>社区</span><ul><!--[--><!--]--></ul></div></div><div class="item"><div style="cursor:pointer;"><span>学院</span><ul><!--[--><!--]--></ul></div></div><div class="item"><div style="cursor:pointer;"><span>安全导航</span><ul><!--[--><!--]--></ul></div></div><div class="item"><div style="cursor:pointer;"><span>内容精选</span><ul><!--[--><li class="sub-item"><a href="/column/index.html">专栏</a></li><li class="sub-item"><a href="https://www.anquanke.com/subject-list">精选专题</a></li><li class="sub-item"><a href="https://www.anquanke.com/discovery">安全KER季刊</a></li><li class="sub-item"><a href="https://www.anquanke.com/week-list">360网络安全周报</a></li><!--]--></ul></div></div><!--]--></div><!----></div></div><div class="index"><div class="index-main"><div class="_45"><h1>Konni APT 组织以朝鲜疫情物资话题为诱饵的攻击活动分析</h1><div class="read"><p><span class="read-text">阅读量</span><b class="read-num">1226876</b></p><!----><!----></div><p class="publish">发布时间 : 2021-02-01 14:30:00</p><div class="_44" style="display:none;"><b class="close">x</b><h5>译文声明</h5><p> 本文是翻译文章<!----><!----></p><!----><p>译文仅供参考，具体内容表达以及含义原文为准。</p></div><div class="content" id="js-article"><html>
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head>
<body>
<p><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t01eac4d19531e13476.jpg"></p>
<p> </p>
<h2 name="h2-0" id="h2-0">概述</h2>
<p>Konni APT 组织是朝鲜半岛地区最具代表性的 APT 组织之一，自 2014 年以来一直持续活动，据悉其背后由朝鲜政府提供支持，该组织经常使用鱼叉式网络钓鱼的攻击手法，经常使用与朝鲜相关的内容或当前社会热点事件来进行攻击活动，该组织的主要目标为韩国政治组织，以及日本、越南、俄罗斯、中国等地区。</p>
<p>微步情报局近期通过威胁狩猎系统监测到 Konni APT 组织最新攻击活动，经过分析有如下发现：</p>
<ol>
<li data-list="bullet">攻击者以“朝鲜疫情物资”话题相关文章作为诱饵文档进行攻击活动，诱饵文档延续了该组织以往的攻击手法，将正文颜色设置为难以阅读的颜色以诱导用户启用宏。</li>
<li data-list="bullet">在文档携带的恶意宏中，从失陷的服务器中下载后门模块并执行。</li>
<li data-list="bullet">后门模块为 Amadey 家族木马，攻击者可利用该后门模块进行下一步恶意模块的分发，该组织经常使用此家族木马进行攻击活动。</li>
<li data-list="bullet">根据样本关联信息显示，本次攻击活动手法与以往安全机构披露的“隐士”、“BlueSky” 等攻击活动手法类似，另外还与具有相同背景的半岛地区 APT 组织 Kimsuky 有诸多关联之处。</li>
<li data-list="bullet">微步在线通过对相关样本、IP 和域名的溯源分析，共提取 31 条相关 IOC，可用于威胁情报检测。微步在线威胁感知平台 TDP、威胁情报管理平台 TIP、威胁情报云 API、互联网安全接入 OneDNS 等均已支持对此次攻击事件和团伙的检测。</li>
</ol>
<p> </p>
<h2 name="h2-1" id="h2-1">详情</h2>
<p>本次攻击活动依然采用 Konni APT 组织最常用的攻击方式，投递的诱饵文件具有一定的诱惑性，攻击者引用 NKNews 近期发表的朝鲜 COVID-19 话题相关文章作为诱饵文档，将正文文字颜色设置为难以阅读的颜色，只有启用宏之后才能修改为容易阅读的颜色，原文链接：https://www.nknews.org/2020/10/pyongyang-stores-low-on-foreign-goods-amid-north-korean-covid-19-paranoia/。</p>
<table><tbody>
<tr>
<td class="ql-align-center" data-row="1">文件名称</td>
<td data-row="1">Pyongyang stores low on foreign goods amid North Korean COVID-19 paranoia (1).doc</td>
</tr>
<tr>
<td class="ql-align-center" data-row="2">SHA256</td>
<td data-row="2">9891b3d68ffbdb4a4bd0e7e49ba7b1e6d30ffb35935357551c312af5ae3a4f1e</td>
</tr>
<tr>
<td class="ql-align-center" data-row="3">创建时间</td>
<td data-row="3">2020/11/27 06:28</td>
</tr>
</tbody></table>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p3.ssl.qhimg.com/t01b785c2f7b6a3687a.png"></p>
<p class="ql-align-center" style="text-align: center;">图1. doc诱饵文档启用宏前后</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t01a3c1e891661cbad8.png"></p>
<p class="ql-align-center" style="text-align: center;">图2. 样本执行流程图</p>
<p> </p>
<h2 name="h2-2" id="h2-2">样本分析</h2>
<p class="ql-align-justify">在 doc 文档携带的恶意宏中，首先将正文颜色修改为黑色以迷惑用户，之后从失陷的服务器（https://rabadaun.com/wordpress/wp-content/themes/TEMP.so）下载文件数据保存到主机 Templates 目录下 spolsve.exe 并执行。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p0.ssl.qhimg.com/t01244466e83d6a36b4.png"></p>
<p class="ql-align-center" style="text-align: center;">图3. 文档中携带的恶意宏</p>
<p>下载的文件为木马 Loader 模块，样本信息如下：</p>
<table><tbody>
<tr>
<td data-row="1">文件名</td>
<td data-row="1">TEMP.so、spolsve.exe、tlworker.exe</td>
</tr>
<tr>
<td data-row="2">文件大小</td>
<td data-row="2">290816 字节 (284.00 KB)</td>
</tr>
<tr>
<td data-row="3">MD5</td>
<td data-row="3">f160c057fded2c01bfdb65bb7aa9dfcc</td>
</tr>
<tr>
<td data-row="4">SHA1</td>
<td data-row="4">1e14de870b1c4b09cbf81206562a254c27178d85</td>
</tr>
<tr>
<td data-row="5">SHA256</td>
<td data-row="5">efc139dc0e280a374065dc59c55a45b5146f091a85a3abd6f0caf1a9a2f8b060</td>
</tr>
<tr>
<td data-row="6">编译时间戳</td>
<td data-row="6">2016/12/06 11:35:32</td>
</tr>
</tbody></table>
<p>Loader 模块执行后，先通过累加一个比较大的数值 0xBAADBEEF，来制造一个比较大的延时效果，之后将 EnumChildWindows 的回调函数进行动态解密并执行，这在一定程度上干扰了静态分析。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p1.ssl.qhimg.com/t01a8cfe03a9b2675ef.png"></p>
<p class="ql-align-center" style="text-align: center;">图4. 调用EnumChildWindows反汇编代码片段</p>
<p>之后找到 .pnuvq 区段数据，使用密钥“nfnljhbnntphxhxthxdpjdtdtjlppltxvrrzbbrlbvfvrnpp ”进行解密。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p0.ssl.qhimg.com/t018666ffcb152bb52a.png"></p>
<p class="ql-align-center" style="text-align: center;">图5. Loader模块的PE区段表</p>
<p>解密后的数据为后门 PE 模块，紧接着再次创建一份自身进程，将后门模块注入执行。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p3.ssl.qhimg.com/t0134e8e6d252227dda.png"></p>
<p class="ql-align-center" style="text-align: center;">图6. 后门模块PE头数据</p>
<h3 name="h3-3" id="h3-3"><strong>Backdoor模块</strong></h3>
<table><tbody>
<tr>
<td data-row="1">文件大小</td>
<td data-row="1">68608 字节 (67.00 KB)</td>
</tr>
<tr>
<td data-row="2">MD5</td>
<td data-row="2">f108a4d064dd05c0a097f517ec738b1a</td>
</tr>
<tr>
<td data-row="3">SHA1</td>
<td data-row="3">f197a7be7fdb286bc9673a57b54994c02a7af8d6</td>
</tr>
<tr>
<td data-row="4">SHA256</td>
<td data-row="4">d1baefd0bdc7f3b0369c5b7126c3b98469a518cf4db788fad1d243d8661a17b9</td>
</tr>
<tr>
<td data-row="5">编译时间戳</td>
<td data-row="5">2020/11/19 17:00:55</td>
</tr>
</tbody></table>
<p>后门模块中的字符串均以加密形式存储，使用密钥”a7963b909152f8ebc3ec69b1dee2b255a9678a5b7b827e8c75bd9b0″动态解密。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p3.ssl.qhimg.com/t018e0adaa05c649490.png"></p>
<p class="ql-align-center" style="text-align: center;">图7. 字符串解密函数反汇编代码片段</p>
<p>该模块执行后，首先检查常见的杀软文件是否存在，用以检查主机上存在的杀软信息。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p3.ssl.qhimg.com/t017d412f0e9d4d1c45.png"></p>
<p class="ql-align-center" style="text-align: center;">图8. 检查主机杀软信息</p>
<p>再检查当前运行目录是否是 C:\ProgramData\a7963\TlWorker.exe，如果不是，则自我复制到该目录。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t0165aaf8a7a5c49130.png"></p>
<p class="ql-align-center" style="text-align: center;">图9. 后门模块的自我复制</p>
<p>并调用 cmd 设置注册表开机启动项以在主机上建立持久化机制。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p0.ssl.qhimg.com/t01a93e5dbc3300486b.png"></p>
<p class="ql-align-center" style="text-align: center;">图10. 设置开机启动项</p>
<p>之后解密出 C2 地址。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p2.ssl.qhimg.com/t0110832ee15f3daffd.png"></p>
<p class="ql-align-center" style="text-align: center;">图11. 解密C2服务器地址</p>
<p>将硬盘序列号、木马版本、是否为管理员、系统版本、杀软信息、主机名、用户名作为上线数据包以 HTTP 协议 POST 方法发送至 C2 服务器（http:// 186.122.150.107/cc/index.php）。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t019eeb48b3b83ae8b8.png"></p>
<p class="ql-align-center" style="text-align: center;">图12. 向C2服务器上传的主机信息数据包</p>
<p>然后接受 C2 服务器返回数据，从中取出服务器所下发的下载链接，继续下载其他恶意模块，每隔 60 秒与服务器通信 1 次。截至分析时，服务器暂未下发有效指令。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t0192ac4c53636813f8.png"></p>
<p class="ql-align-center" style="text-align: center;">图13. 响应C2服务器远程指令</p>
<p>该 C2 服务器部署了 Amadey 家族木马服务端用以对目标进行控制。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t017b3a17a4fd5818a5.png"></p>
<p class="ql-align-center" style="text-align: center;">图14. C2服务器上所部署的Amadey木马服务端</p>
<p>在上线列表中发现已经有用户被感染，根据 IP 判断包括 1 例韩国受害者，这符合该组织的攻击目标范围，攻击者可随时设置任务，下发给目标以进行下步恶意模块的分发。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t01a6b2bceb6fa234e3.png"></p>
<p class="ql-align-center" style="text-align: center;">图15. Amadey木马服务端所显示的感染列表</p>
<p> </p>
<h2 name="h2-4" id="h2-4">关联分析</h2>
<p>在关联分析工作中，另外发现一个以“俄罗斯专家介绍”为主题的诱饵文档。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p2.ssl.qhimg.com/t01eb3e1a5e2ca9fff3.png"></p>
<p class="ql-align-center" style="text-align: center;">图16. 以“俄罗斯专家介绍”为主题的诱饵文档</p>
<p>在其恶意宏中同样从失陷的网站服务器下载恶意模块执行（http://fd-com.fr/wp-content/themes/consultingservices/upload/tmp.txt），虽然目前已经无法正常下载，但根据关联分析信息，发现之后的恶意流程与上面样本一致，同样使用 Amadey 木马在主机建立持久化机制，并从 C2 服务器（http://108.62.118.185/cc/index.php）获取下载链接继续下一步恶意行为。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t015cfd9c4b09a45b1e.png"></p>
<p class="ql-align-center" style="text-align: center;">图17. 恶意宏代码中的失陷服务器</p>
<p>在本次攻击活动中，攻击者依然延续了以往的攻击手法，将诱饵文档颜色设置为不可读颜色诱导用户启用宏，从攻击手法多维度信息来看，与以往攻击活动手法基本一致，例如使用基本一致的解密算法。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t017606dacdc1adc1aa.png"></p>
<p class="ql-align-center" style="text-align: center;">图18. 一致的解密算法</p>
<p class="ql-align-justify">同样使用 Amadey 家族木马套件。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p2.ssl.qhimg.com/t01040e099f2ce31fb9.png"></p>
<p class="ql-align-center" style="text-align: center;">图19. 一致的Amadey木马服务端</p>
<p class="ql-align-justify">在微步在线追踪溯源系统中检索攻击者使用的 C2 服务器的关联信息，发现历史解析域名基本都带有一定的迷惑性，推测攻击者用来进行钓鱼攻击，这符合 Konni 以往的攻击手法。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p0.ssl.qhimg.com/t01117cda897c387da9.png"></p>
<p class="ql-align-center" style="text-align: center;">图20. 微步在线追踪溯源系统关联信息</p>
<h3 name="h3-5" id="h3-5"><strong>与 Kimsuky APT 组织的关联性</strong></h3>
<p class="ql-align-justify">在 Kimsuky 组织最近的一起攻击活动中，其使用了“世界卫生大会”相关内容作为诱饵文档（57b59b770f313b0a09b651bfba0c95cdba482d4a41fa2e95593674dd5cd83c5b），同样将正文颜色设置为难以阅读的颜色，且攻击者编辑文档环境为朝鲜语。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t01db29376501e12f84.png"></p>
<p class="ql-align-center" style="text-align: center;">图21. 以“世界卫生大会”为主题的诱饵文档</p>
<p class="ql-align-justify">Kimsuky 组织在以往攻击活动中经常使用带有恶意宏的文档进行攻击，在恶意宏中从 C2 服务器拉取下阶段脚本代码执行，本次攻击活动依然使用同样的攻击手法，另外该组织以往还经常使用包含“.php?op={参数值}”的 URL，其中参数值代表不同阶段的行为，在此次攻击活动中就使用到以下 URL：</p>
<ol>
<li class="ql-align-justify" data-list="bullet">http://documentserver.site/dark/index.php?op=5</li>
<li class="ql-align-justify" data-list="bullet">http://documentserver.site/dark/index.php?op=7</li>
</ol>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t01f8c495b72029de19.png"></p>
<p class="ql-align-center" style="text-align: center;">图22. Kimsuky组织使用的URL示例图</p>
<p class="ql-align-justify">而通过分析 Konni 以往所使用的 Amadey 家族攻击样本，发现有攻击样本（544aaf0804060598138f2db809c31bb651dd8f4fce2e64b49f7db051fc54a764）曾使用过 C2 服务器 http://securelevel.site/pppp/index.php，经过对比，与 Kimsuky 所使用的 C2 服务器 Whois 注册信息完全一致。</p>
<table><tbody>
<tr>
<td data-row="1">注册者</td>
<td data-row="1">aoler jack</td>
</tr>
<tr>
<td data-row="2">邮箱</td>
<td data-row="2">poole.sion2015@yandex.com</td>
</tr>
<tr>
<td data-row="3">电话</td>
<td data-row="3">+82.12035386476</td>
</tr>
</tbody></table>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t0146f6592b896b1d7a.png"></p>
<p class="ql-align-center" style="text-align: center;">图23. Kimsuky和Konni两者相同的Whois注册信息</p>
<p>由此我们发现，Konni 组织与具有相同朝鲜半岛背景的 Kimsuky 组织有一定程度的资产重叠，从攻击目标与攻击手法来看也有不同程度的技术重叠，依靠现有的一些证据，可以合理地怀疑他们可能存在某种意义上的关联性，当然仅凭有限的内容来判定他们之间的关联并不容易，有必要继续跟踪观察他们之间的关系，通过大量的恶意文件样本和各种分析指标来获取更明确的答案。</p>
<h2 name="h2-6" id="h2-6">结论</h2>
<p>Konni APT 组织善于使用朝鲜相关热点话题进行攻击活动，且极具针对性，本次攻击活动中依然使用诱饵文档+Amadey 家族木马套件的攻击方式，与相同背景的半岛地区 APT 组织 Kimsuky 组织或有关联，基于该组织所在地区及目标的地缘政治敏感性，也可能会给我国带来一定程度的负面影响，微步在线情报局会对该组织攻击活动持续进行跟踪，及时发现安全威胁并快速响应处置。</p>
<p> </p>
<h2 name="h2-7" id="h2-7">附录 – IOC</h2>
<h3 name="h3-8" id="h3-8"><strong>C&amp;C</strong></h3>
<p><img class="size-full wp-image-230120 alignnone" alt="" width="229" height="621" data-original="https://p3.ssl.qhimg.com/t01be85b67ac08e163a.png"></p>
<h3 name="h3-9" id="h3-9"><strong>Compromised Domain</strong></h3>
<p><img class="size-large wp-image-230121 alignnone" alt="" width="229" height="41" data-original="https://p4.ssl.qhimg.com/t011088d74d14f28d30.png"></p>
<h3 name="h3-10" id="h3-10"><strong>Hash</strong></h3>
<ol>
<li data-list="bullet">9891b3d68ffbdb4a4bd0e7e49ba7b1e6d30ffb35935357551c312af5ae3a4f1e</li>
<li data-list="bullet">efc139dc0e280a374065dc59c55a45b5146f091a85a3abd6f0caf1a9a2f8b060</li>
<li data-list="bullet">d1baefd0bdc7f3b0369c5b7126c3b98469a518cf4db788fad1d243d8661a17b9</li>
<li data-list="bullet">5bd48c2f61541124920d71e674ce3fd5927702f69c2baacc5a509debe3a893c8</li>
<li data-list="bullet">9aab5a536b95963c4e3c990ab40bdeb25c850e2a862ea528b81d470d6acdadb1</li>
</ol>
<h3 name="h3-11" id="h3-11"><strong>Email</strong></h3>
<ol>
<li data-list="bullet">glorify0717@gmail.com</li>
<li data-list="bullet">mypretty0914@gmail.com</li>
<li data-list="bullet">norelyeverland@hanmail.net</li>
<li data-list="bullet"><a style="color: black;" href="mailto:poole.sion2015@yandex.com" target="_blank" rel="noopener noreferrer">poole.sion2015@yandex.com</a></li>
</ol>
<p> </p>
<h2 name="h2-12" id="h2-12">参考链接</h2>
<ol>
<li data-list="bullet">https://s.threatbook.cn/report/file/efc139dc0e280a374065dc59c55a45b5146f091a85a3abd6f0caf1a9a2f8b060/?sign=history&amp;env=win7_sp1_enx86_office2013</li>
<li data-list="bullet">https://s.tencent.com/research/report/727.html</li>
<li data-list="bullet">https://blog.alyac.co.kr/2308</li>
<li data-list="bullet">https://blog.alyac.co.kr/3390</li>
</ol>
<h3 name="h3-13" id="h3-13"><strong>关于微步情报局</strong></h3>
<p>微步情报局，即微步在线研究响应团队，负责微步在线安全分析与安全服务业务，主要研究内容包括威胁情报自动化研发、高级 APT 组织&amp;黑产研究与追踪、恶意代码与自动化分析技术、重大事件应急响应等。</p>
</body>
</html></div><div class="_43" style="display:none;"> 本文翻译自 <a href="" target="_blank">原文链接</a>。如若转载请注明出处。 </div><div class="_50" style="display:none;"> 商务合作，文章发布请联系 anquanke@360.cn </div><div class="_49" style=""><p> 本文由<b>微步在线研究响应团队</b>原创发布 </p><p> 转载，请参考<a href="https://www.anquanke.com/note/repost" target="_blank">转载声明</a>，注明出处： <a href="/post/id/230116" target="_blank">https://www.anquanke.com/post/id/230116</a></p><p>安全KER - 有思想的安全新媒体</p></div><div class="_53" style="display:none;"><p> 本文转载自: <a href=""></a></p><p> 如若转载,请注明出处： <a href="" target="_blank"></a></p><p>安全KER - 有思想的安全新媒体</p></div><div class="_54 share1"><div class="main-w"><div class="bg"></div><div class="main"><span>分享到：</span><img class="icon" data-cmd="weixin" alt="微信" src="https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png"></div></div><div class="qrcode" style="display:none;"></div></div><ul class="_56"><!--[--><li><a target="_blank" href="/tag/COVID-19">COVID-19</a></li><li><a target="_blank" href="/tag/Konni APT">Konni APT</a></li><!--]--></ul><div class="_46"><div class="line line1"><div class="_17 item1"><b style="display:none;">+1</b><i class="iconfont icon-rate"></i><span class="rate-text">3赞</span></div><div class="_9 item1"><i class=""></i><span>收藏</span></div></div><div class="line line2"><div class="user"><img class="avatar" src="https://p2.ssl.qhimg.com/t01aa27e1778b04d216.png"><span class="name">微步在线研究响应团队</span><span class="label-verify label"></span></div><div class="_54 share2"><div class="main-w"><div class="bg"></div><div class="main"><span>分享到：</span><img class="icon" data-cmd="weixin" alt="微信" src="https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png"></div></div><div class="qrcode" style="display:none;"></div></div></div></div></div><div class="_51"><!----><!----></div><div class="_2 index-comment"><h2 class="g-title">发表评论</h2><div class="login"><p class="login-text">您还未登录，请先登录。</p><p class="login-bar"><a href="/login/index.html">登录</a></p></div><!----><!----><!----></div></div><div class="index-side"><div class="index-side-top"><div class="_57"><img class="banner" src="https://p5.ssl.qhimg.com/t01573092fda7526799.png"><div class="w"><a class="avatar" href="/member.html?memberId=155341"><img src="https://p2.ssl.qhimg.com/t01aa27e1778b04d216.png"></a><p class="info"><a href="/member.html?memberId=155341" class="name">微步在线研究响应团队</a><a href="/member.html?memberId=155341" class="user-label-verify user-label"></a></p><p class="hint">神秘，低调，手里全是情报。中国网络安全圈不可缺少的力量。</p><div class="bottom"><ul class="bottom-1"><li>文章</li><li><strong>34</strong></li></ul><ul class="bottom-2"><li>粉丝</li><li><strong>33</strong></li></ul><div class="spacer"></div><!----></div></div></div><div class="_55"><h3 class="title"> TA的文章</h3><ul><!--[--><li><h5><a href="/post/id/263872">Emotet木马&quot;卷土重来&quot;</a></h5><p>2021-12-28 17:30:46</p></li><li><h5><a href="/post/id/259453">相煎何急，印APT组织蔓灵花针对巴基斯坦政府机构展开定向攻击</a></h5><p>2021-11-23 12:00:45</p></li><li><h5><a href="/post/id/258873">双十一，明知是骗局还想薅骗子羊毛，我做到了！</a></h5><p>2021-11-12 12:00:09</p></li><li><h5><a href="/post/id/258167">涉俄APT组织“圣贤熊”针对军队、政府展开经济犯罪和间谍攻击</a></h5><p>2021-11-04 12:00:48</p></li><li><h5><a href="/post/id/255674">推陈出新，Donot组织窃密手法再升级</a></h5><p>2021-10-21 12:00:10</p></li><!--]--></ul></div><div class="_52"><h3 class="title"> 相关文章</h3><ul><!--[--><li><h5><a href="/post/id/311884">教你打造一款AI安全助手 | 安全MCP的实践指南</a></h5><p>2025-09-05 10:40:51</p></li><li><h5><a href="/post/id/311597">当数字世界的“万能钥匙”被滥用，谁来守护核心资产？火山的 MCP 安全授权新范式</a></h5><p>2025-08-28 09:50:41</p></li><li><h5><a href="/post/id/311484">Python代码保护之重置操作码映射的攻与防探究（一）</a></h5><p>2025-08-26 10:49:47</p></li><li><h5><a href="/post/id/311498">广汽集团×火山引擎：出海合规助力企业新增长</a></h5><p>2025-08-26 10:17:09</p></li><li><h5><a href="/post/id/310094">从技术到安全：中科固源拆解车载以太网的演进路径与防护策略</a></h5><p>2025-08-21 21:48:41</p></li><!--]--></ul></div><div class="_42"><h3 class="title">热门推荐</h3><ul><!--[--><!--]--></ul></div></div><div class="_47"><div class="wrap" style=""><div class="title">文章目录</div><ul class="list"><!--[--><li class="item"><a target="_self" href="#h2-0" class="g-line1">概述</a><ul><!--[--><!--]--></ul></li><li class="item"><a target="_self" href="#h2-1" class="g-line1">详情</a><ul><!--[--><!--]--></ul></li><li class="item"><a target="_self" href="#h2-2" class="g-line1">样本分析</a><ul><!--[--><li class="subitem"><a class="g-line1" href="#h3-3">Backdoor模块</a></li><!--]--></ul></li><li class="item"><a target="_self" href="#h2-4" class="g-line1">关联分析</a><ul><!--[--><li class="subitem"><a class="g-line1" href="#h3-5">与 Kimsuky APT 组织的关联性</a></li><!--]--></ul></li><li class="item"><a target="_self" href="#h2-6" class="g-line1">结论</a><ul><!--[--><!--]--></ul></li><li class="item"><a target="_self" href="#h2-7" class="g-line1">附录 – IOC</a><ul><!--[--><li class="subitem"><a class="g-line1" href="#h3-8">C&amp;C</a></li><li class="subitem"><a class="g-line1" href="#h3-9">Compromised Domain</a></li><li class="subitem"><a class="g-line1" href="#h3-10">Hash</a></li><li class="subitem"><a class="g-line1" href="#h3-11">Email</a></li><!--]--></ul></li><li class="item"><a target="_self" href="#h2-12" class="g-line1">参考链接</a><ul><!--[--><li class="subitem"><a class="g-line1" href="#h3-13">关于微步情报局</a></li><!--]--></ul></li><!--]--></ul></div></div></div></div><div class="_16"><div class="g-w main"><div class="col1"><p class="col1-logo"><img src="https://p0.qhimg.com/t11098f6bcd5614af4bf21ef9b5.png"></p><div class="col1-link"><b class="col1-weixin"></b><a href="https://weibo.com/360adlab" class="col1-sina"></a><a href="https://zhuanlan.zhihu.com/c_118578260" class="col1-zhi"></a></div></div><div class="col2"><div class="title">安全KER</div><ul class="col2-list"><li><a href="/about" rel="noopener noreferrer" target="_blank">关于我们</a></li><li><a href="/note/contact" target="_blank" rel="noopener noreferrer">联系我们</a></li><li><a href="/note/protocol" target="_blank" rel="noopener noreferrer">用户协议</a></li><li><a href="/note/privacy" target="_blank" rel="noopener noreferrer">隐私协议</a></li></ul></div><div class="col3"><div class="title">商务合作</div><ul class="col3-list"><li><a href="/note/business" target="_blank" rel="noopener noreferrer">合作内容</a></li><li><a href="/note/contact" target="_blank" rel="noopener noreferrer">联系方式</a></li><li><a href="/link" target="_blank" rel="noopener noreferrer">友情链接</a></li></ul></div><div class="col4"><div class="title">内容需知</div><ul><li><a href="https://www.anquanke.com/contribute/tips" target="_blank" rel="noopener noreferrer">投稿须知</a></li><li><a href="/note/repost" target="_blank" rel="noopener noreferrer">转载须知</a></li><li>官网QQ群：568681302</li></ul></div><div class="col5"><div class="title">合作单位</div><ul><li><a href="http://www.cert.org.cn/" target="_blank" rel="noopener noreferrer"><img alt="安全KER" src="https://p0.ssl.qhimg.com/t01592a959354157bc0.png" style="max-height:40px;"></a></li><li style="margin-top:-20px;"><a href="http://www.cnnvd.org.cn/" target="_blank" rel="noopener noreferrer"><img alt="安全KER" src="https://p0.ssl.qhimg.com/t014f76fcea94035e47.png" style="max-height:50px;margin-top:10px;"></a></li></ul></div></div><div class="right g-w"><span>Copyright © 北京奇虎科技有限公司 三六零数字安全科技集团有限公司 安全KER All Rights Reserved </span><a href="https://beian.miit.gov.cn/">京ICP备08010314号-66</a><span id="cnzz_stat_icon_1271278035"><a href="https://www.cnzz.com/stat/website.php?web_id=1271278035" target="_blank" title="站长统计"><img border="0" hspace="0" vspace="0" src="https://icon.cnzz.com/img/pic.gif"></a></span></div><div class="layer" style="display:none;"><div class="layer-main"><div class="layer-title">微信二维码</div><b class="layer-close">X</b><img src="https://p0.ssl.qhimg.com/t0151209205b47f2270.jpg" alt="安全KER"></div></div></div><!--]--></div><script>window.__state__={"artical":{"post":{"id":230116,"title":"Konni APT 组织以朝鲜疫情物资话题为诱饵的攻击活动分析","category_name":"安全知识","category_slug":"knowledge","desc":"Konni APT 组织是朝鲜半岛地区最具代表性的 APT 组织之一，自 2014 年以来一直持续活动，据悉其背后由朝鲜政府提供支持，该组织经常使用鱼叉式网络钓鱼的攻击手法，经常使用与朝鲜相关的内容或当前社会热点事件来进行攻击活动，该组织的主要目标为韩国政治组织，以及日本、越南、俄罗斯、中国等地区。","date":"2021-02-01 14:30:00","time_interval":"2021-02-01","status":"publish","comment":0,"cover":"https://p5.ssl.qhimg.com/t01eac4d19531e13476.jpg","subject":false,"red":false,"type":"origin","url":"","source":"","fee":"","origin_author":"","pv":1226876,"like_count":3,"liked":0,"tags":["COVID-19","Konni APT"],"is_favorite":false,"favorite_count":2,"content":"<html>\n<head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"></head>\n<body>\n<p><img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t01eac4d19531e13476.jpg\"></p>\n<p> </p>\n<h2 name=\"h2-0\" id=\"h2-0\">概述</h2>\n<p>Konni APT 组织是朝鲜半岛地区最具代表性的 APT 组织之一，自 2014 年以来一直持续活动，据悉其背后由朝鲜政府提供支持，该组织经常使用鱼叉式网络钓鱼的攻击手法，经常使用与朝鲜相关的内容或当前社会热点事件来进行攻击活动，该组织的主要目标为韩国政治组织，以及日本、越南、俄罗斯、中国等地区。</p>\n<p>微步情报局近期通过威胁狩猎系统监测到 Konni APT 组织最新攻击活动，经过分析有如下发现：</p>\n<ol>\n<li data-list=\"bullet\">攻击者以“朝鲜疫情物资”话题相关文章作为诱饵文档进行攻击活动，诱饵文档延续了该组织以往的攻击手法，将正文颜色设置为难以阅读的颜色以诱导用户启用宏。</li>\n<li data-list=\"bullet\">在文档携带的恶意宏中，从失陷的服务器中下载后门模块并执行。</li>\n<li data-list=\"bullet\">后门模块为 Amadey 家族木马，攻击者可利用该后门模块进行下一步恶意模块的分发，该组织经常使用此家族木马进行攻击活动。</li>\n<li data-list=\"bullet\">根据样本关联信息显示，本次攻击活动手法与以往安全机构披露的“隐士”、“BlueSky” 等攻击活动手法类似，另外还与具有相同背景的半岛地区 APT 组织 Kimsuky 有诸多关联之处。</li>\n<li data-list=\"bullet\">微步在线通过对相关样本、IP 和域名的溯源分析，共提取 31 条相关 IOC，可用于威胁情报检测。微步在线威胁感知平台 TDP、威胁情报管理平台 TIP、威胁情报云 API、互联网安全接入 OneDNS 等均已支持对此次攻击事件和团伙的检测。</li>\n</ol>\n<p> </p>\n<h2 name=\"h2-1\" id=\"h2-1\">详情</h2>\n<p>本次攻击活动依然采用 Konni APT 组织最常用的攻击方式，投递的诱饵文件具有一定的诱惑性，攻击者引用 NKNews 近期发表的朝鲜 COVID-19 话题相关文章作为诱饵文档，将正文文字颜色设置为难以阅读的颜色，只有启用宏之后才能修改为容易阅读的颜色，原文链接：https://www.nknews.org/2020/10/pyongyang-stores-low-on-foreign-goods-amid-north-korean-covid-19-paranoia/。</p>\n<table><tbody>\n<tr>\n<td class=\"ql-align-center\" data-row=\"1\">文件名称</td>\n<td data-row=\"1\">Pyongyang stores low on foreign goods amid North Korean COVID-19 paranoia (1).doc</td>\n</tr>\n<tr>\n<td class=\"ql-align-center\" data-row=\"2\">SHA256</td>\n<td data-row=\"2\">9891b3d68ffbdb4a4bd0e7e49ba7b1e6d30ffb35935357551c312af5ae3a4f1e</td>\n</tr>\n<tr>\n<td class=\"ql-align-center\" data-row=\"3\">创建时间</td>\n<td data-row=\"3\">2020/11/27 06:28</td>\n</tr>\n</tbody></table>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p3.ssl.qhimg.com/t01b785c2f7b6a3687a.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图1. doc诱饵文档启用宏前后</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t01a3c1e891661cbad8.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图2. 样本执行流程图</p>\n<p> </p>\n<h2 name=\"h2-2\" id=\"h2-2\">样本分析</h2>\n<p class=\"ql-align-justify\">在 doc 文档携带的恶意宏中，首先将正文颜色修改为黑色以迷惑用户，之后从失陷的服务器（https://rabadaun.com/wordpress/wp-content/themes/TEMP.so）下载文件数据保存到主机 Templates 目录下 spolsve.exe 并执行。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p0.ssl.qhimg.com/t01244466e83d6a36b4.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图3. 文档中携带的恶意宏</p>\n<p>下载的文件为木马 Loader 模块，样本信息如下：</p>\n<table><tbody>\n<tr>\n<td data-row=\"1\">文件名</td>\n<td data-row=\"1\">TEMP.so、spolsve.exe、tlworker.exe</td>\n</tr>\n<tr>\n<td data-row=\"2\">文件大小</td>\n<td data-row=\"2\">290816 字节 (284.00 KB)</td>\n</tr>\n<tr>\n<td data-row=\"3\">MD5</td>\n<td data-row=\"3\">f160c057fded2c01bfdb65bb7aa9dfcc</td>\n</tr>\n<tr>\n<td data-row=\"4\">SHA1</td>\n<td data-row=\"4\">1e14de870b1c4b09cbf81206562a254c27178d85</td>\n</tr>\n<tr>\n<td data-row=\"5\">SHA256</td>\n<td data-row=\"5\">efc139dc0e280a374065dc59c55a45b5146f091a85a3abd6f0caf1a9a2f8b060</td>\n</tr>\n<tr>\n<td data-row=\"6\">编译时间戳</td>\n<td data-row=\"6\">2016/12/06 11:35:32</td>\n</tr>\n</tbody></table>\n<p>Loader 模块执行后，先通过累加一个比较大的数值 0xBAADBEEF，来制造一个比较大的延时效果，之后将 EnumChildWindows 的回调函数进行动态解密并执行，这在一定程度上干扰了静态分析。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p1.ssl.qhimg.com/t01a8cfe03a9b2675ef.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图4. 调用EnumChildWindows反汇编代码片段</p>\n<p>之后找到 .pnuvq 区段数据，使用密钥“nfnljhbnntphxhxthxdpjdtdtjlppltxvrrzbbrlbvfvrnpp ”进行解密。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p0.ssl.qhimg.com/t018666ffcb152bb52a.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图5. Loader模块的PE区段表</p>\n<p>解密后的数据为后门 PE 模块，紧接着再次创建一份自身进程，将后门模块注入执行。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p3.ssl.qhimg.com/t0134e8e6d252227dda.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图6. 后门模块PE头数据</p>\n<h3 name=\"h3-3\" id=\"h3-3\"><strong>Backdoor模块</strong></h3>\n<table><tbody>\n<tr>\n<td data-row=\"1\">文件大小</td>\n<td data-row=\"1\">68608 字节 (67.00 KB)</td>\n</tr>\n<tr>\n<td data-row=\"2\">MD5</td>\n<td data-row=\"2\">f108a4d064dd05c0a097f517ec738b1a</td>\n</tr>\n<tr>\n<td data-row=\"3\">SHA1</td>\n<td data-row=\"3\">f197a7be7fdb286bc9673a57b54994c02a7af8d6</td>\n</tr>\n<tr>\n<td data-row=\"4\">SHA256</td>\n<td data-row=\"4\">d1baefd0bdc7f3b0369c5b7126c3b98469a518cf4db788fad1d243d8661a17b9</td>\n</tr>\n<tr>\n<td data-row=\"5\">编译时间戳</td>\n<td data-row=\"5\">2020/11/19 17:00:55</td>\n</tr>\n</tbody></table>\n<p>后门模块中的字符串均以加密形式存储，使用密钥”a7963b909152f8ebc3ec69b1dee2b255a9678a5b7b827e8c75bd9b0″动态解密。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p3.ssl.qhimg.com/t018e0adaa05c649490.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图7. 字符串解密函数反汇编代码片段</p>\n<p>该模块执行后，首先检查常见的杀软文件是否存在，用以检查主机上存在的杀软信息。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p3.ssl.qhimg.com/t017d412f0e9d4d1c45.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图8. 检查主机杀软信息</p>\n<p>再检查当前运行目录是否是 C:\\ProgramData\\a7963\\TlWorker.exe，如果不是，则自我复制到该目录。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t0165aaf8a7a5c49130.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图9. 后门模块的自我复制</p>\n<p>并调用 cmd 设置注册表开机启动项以在主机上建立持久化机制。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p0.ssl.qhimg.com/t01a93e5dbc3300486b.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图10. 设置开机启动项</p>\n<p>之后解密出 C2 地址。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p2.ssl.qhimg.com/t0110832ee15f3daffd.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图11. 解密C2服务器地址</p>\n<p>将硬盘序列号、木马版本、是否为管理员、系统版本、杀软信息、主机名、用户名作为上线数据包以 HTTP 协议 POST 方法发送至 C2 服务器（http:// 186.122.150.107/cc/index.php）。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t019eeb48b3b83ae8b8.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图12. 向C2服务器上传的主机信息数据包</p>\n<p>然后接受 C2 服务器返回数据，从中取出服务器所下发的下载链接，继续下载其他恶意模块，每隔 60 秒与服务器通信 1 次。截至分析时，服务器暂未下发有效指令。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t0192ac4c53636813f8.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图13. 响应C2服务器远程指令</p>\n<p>该 C2 服务器部署了 Amadey 家族木马服务端用以对目标进行控制。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t017b3a17a4fd5818a5.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图14. C2服务器上所部署的Amadey木马服务端</p>\n<p>在上线列表中发现已经有用户被感染，根据 IP 判断包括 1 例韩国受害者，这符合该组织的攻击目标范围，攻击者可随时设置任务，下发给目标以进行下步恶意模块的分发。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t01a6b2bceb6fa234e3.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图15. Amadey木马服务端所显示的感染列表</p>\n<p> </p>\n<h2 name=\"h2-4\" id=\"h2-4\">关联分析</h2>\n<p>在关联分析工作中，另外发现一个以“俄罗斯专家介绍”为主题的诱饵文档。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p2.ssl.qhimg.com/t01eb3e1a5e2ca9fff3.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图16. 以“俄罗斯专家介绍”为主题的诱饵文档</p>\n<p>在其恶意宏中同样从失陷的网站服务器下载恶意模块执行（http://fd-com.fr/wp-content/themes/consultingservices/upload/tmp.txt），虽然目前已经无法正常下载，但根据关联分析信息，发现之后的恶意流程与上面样本一致，同样使用 Amadey 木马在主机建立持久化机制，并从 C2 服务器（http://108.62.118.185/cc/index.php）获取下载链接继续下一步恶意行为。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t015cfd9c4b09a45b1e.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图17. 恶意宏代码中的失陷服务器</p>\n<p>在本次攻击活动中，攻击者依然延续了以往的攻击手法，将诱饵文档颜色设置为不可读颜色诱导用户启用宏，从攻击手法多维度信息来看，与以往攻击活动手法基本一致，例如使用基本一致的解密算法。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t017606dacdc1adc1aa.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图18. 一致的解密算法</p>\n<p class=\"ql-align-justify\">同样使用 Amadey 家族木马套件。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p2.ssl.qhimg.com/t01040e099f2ce31fb9.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图19. 一致的Amadey木马服务端</p>\n<p class=\"ql-align-justify\">在微步在线追踪溯源系统中检索攻击者使用的 C2 服务器的关联信息，发现历史解析域名基本都带有一定的迷惑性，推测攻击者用来进行钓鱼攻击，这符合 Konni 以往的攻击手法。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p0.ssl.qhimg.com/t01117cda897c387da9.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图20. 微步在线追踪溯源系统关联信息</p>\n<h3 name=\"h3-5\" id=\"h3-5\"><strong>与 Kimsuky APT 组织的关联性</strong></h3>\n<p class=\"ql-align-justify\">在 Kimsuky 组织最近的一起攻击活动中，其使用了“世界卫生大会”相关内容作为诱饵文档（57b59b770f313b0a09b651bfba0c95cdba482d4a41fa2e95593674dd5cd83c5b），同样将正文颜色设置为难以阅读的颜色，且攻击者编辑文档环境为朝鲜语。</p>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t01db29376501e12f84.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图21. 以“世界卫生大会”为主题的诱饵文档</p>\n<p class=\"ql-align-justify\">Kimsuky 组织在以往攻击活动中经常使用带有恶意宏的文档进行攻击，在恶意宏中从 C2 服务器拉取下阶段脚本代码执行，本次攻击活动依然使用同样的攻击手法，另外该组织以往还经常使用包含“.php?op={参数值}”的 URL，其中参数值代表不同阶段的行为，在此次攻击活动中就使用到以下 URL：</p>\n<ol>\n<li class=\"ql-align-justify\" data-list=\"bullet\">http://documentserver.site/dark/index.php?op=5</li>\n<li class=\"ql-align-justify\" data-list=\"bullet\">http://documentserver.site/dark/index.php?op=7</li>\n</ol>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t01f8c495b72029de19.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图22. Kimsuky组织使用的URL示例图</p>\n<p class=\"ql-align-justify\">而通过分析 Konni 以往所使用的 Amadey 家族攻击样本，发现有攻击样本（544aaf0804060598138f2db809c31bb651dd8f4fce2e64b49f7db051fc54a764）曾使用过 C2 服务器 http://securelevel.site/pppp/index.php，经过对比，与 Kimsuky 所使用的 C2 服务器 Whois 注册信息完全一致。</p>\n<table><tbody>\n<tr>\n<td data-row=\"1\">注册者</td>\n<td data-row=\"1\">aoler jack</td>\n</tr>\n<tr>\n<td data-row=\"2\">邮箱</td>\n<td data-row=\"2\">poole.sion2015@yandex.com</td>\n</tr>\n<tr>\n<td data-row=\"3\">电话</td>\n<td data-row=\"3\">+82.12035386476</td>\n</tr>\n</tbody></table>\n<p class=\"ql-align-center\"><img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t0146f6592b896b1d7a.png\"></p>\n<p class=\"ql-align-center\" style=\"text-align: center;\">图23. Kimsuky和Konni两者相同的Whois注册信息</p>\n<p>由此我们发现，Konni 组织与具有相同朝鲜半岛背景的 Kimsuky 组织有一定程度的资产重叠，从攻击目标与攻击手法来看也有不同程度的技术重叠，依靠现有的一些证据，可以合理地怀疑他们可能存在某种意义上的关联性，当然仅凭有限的内容来判定他们之间的关联并不容易，有必要继续跟踪观察他们之间的关系，通过大量的恶意文件样本和各种分析指标来获取更明确的答案。</p>\n<h2 name=\"h2-6\" id=\"h2-6\">结论</h2>\n<p>Konni APT 组织善于使用朝鲜相关热点话题进行攻击活动，且极具针对性，本次攻击活动中依然使用诱饵文档+Amadey 家族木马套件的攻击方式，与相同背景的半岛地区 APT 组织 Kimsuky 组织或有关联，基于该组织所在地区及目标的地缘政治敏感性，也可能会给我国带来一定程度的负面影响，微步在线情报局会对该组织攻击活动持续进行跟踪，及时发现安全威胁并快速响应处置。</p>\n<p> </p>\n<h2 name=\"h2-7\" id=\"h2-7\">附录 – IOC</h2>\n<h3 name=\"h3-8\" id=\"h3-8\"><strong>C&amp;C</strong></h3>\n<p><img class=\"size-full wp-image-230120 alignnone\" alt=\"\" width=\"229\" height=\"621\" data-original=\"https://p3.ssl.qhimg.com/t01be85b67ac08e163a.png\"></p>\n<h3 name=\"h3-9\" id=\"h3-9\"><strong>Compromised Domain</strong></h3>\n<p><img class=\"size-large wp-image-230121 alignnone\" alt=\"\" width=\"229\" height=\"41\" data-original=\"https://p4.ssl.qhimg.com/t011088d74d14f28d30.png\"></p>\n<h3 name=\"h3-10\" id=\"h3-10\"><strong>Hash</strong></h3>\n<ol>\n<li data-list=\"bullet\">9891b3d68ffbdb4a4bd0e7e49ba7b1e6d30ffb35935357551c312af5ae3a4f1e</li>\n<li data-list=\"bullet\">efc139dc0e280a374065dc59c55a45b5146f091a85a3abd6f0caf1a9a2f8b060</li>\n<li data-list=\"bullet\">d1baefd0bdc7f3b0369c5b7126c3b98469a518cf4db788fad1d243d8661a17b9</li>\n<li data-list=\"bullet\">5bd48c2f61541124920d71e674ce3fd5927702f69c2baacc5a509debe3a893c8</li>\n<li data-list=\"bullet\">9aab5a536b95963c4e3c990ab40bdeb25c850e2a862ea528b81d470d6acdadb1</li>\n</ol>\n<h3 name=\"h3-11\" id=\"h3-11\"><strong>Email</strong></h3>\n<ol>\n<li data-list=\"bullet\">glorify0717@gmail.com</li>\n<li data-list=\"bullet\">mypretty0914@gmail.com</li>\n<li data-list=\"bullet\">norelyeverland@hanmail.net</li>\n<li data-list=\"bullet\"><a style=\"color: black;\" href=\"mailto:poole.sion2015@yandex.com\" target=\"_blank\" rel=\"noopener noreferrer\">poole.sion2015@yandex.com</a></li>\n</ol>\n<p> </p>\n<h2 name=\"h2-12\" id=\"h2-12\">参考链接</h2>\n<ol>\n<li data-list=\"bullet\">https://s.threatbook.cn/report/file/efc139dc0e280a374065dc59c55a45b5146f091a85a3abd6f0caf1a9a2f8b060/?sign=history&amp;env=win7_sp1_enx86_office2013</li>\n<li data-list=\"bullet\">https://s.tencent.com/research/report/727.html</li>\n<li data-list=\"bullet\">https://blog.alyac.co.kr/2308</li>\n<li data-list=\"bullet\">https://blog.alyac.co.kr/3390</li>\n</ol>\n<h3 name=\"h3-13\" id=\"h3-13\"><strong>关于微步情报局</strong></h3>\n<p>微步情报局，即微步在线研究响应团队，负责微步在线安全分析与安全服务业务，主要研究内容包括威胁情报自动化研发、高级 APT 组织&amp;黑产研究与追踪、恶意代码与自动化分析技术、重大事件应急响应等。</p>\n</body>\n</html>","index":[{"title":"概述","id":"#h2-0","sub":[]},{"title":"详情","id":"#h2-1","sub":[]},{"title":"样本分析","id":"#h2-2","sub":[{"title":"Backdoor模块","id":"#h3-3"}]},{"title":"关联分析","id":"#h2-4","sub":[{"title":"与 Kimsuky APT 组织的关联性","id":"#h3-5"}]},{"title":"结论","id":"#h2-6","sub":[]},{"title":"附录 – IOC","id":"#h2-7","sub":[{"title":"C&C","id":"#h3-8"},{"title":"Compromised Domain","id":"#h3-9"},{"title":"Hash","id":"#h3-10"},{"title":"Email","id":"#h3-11"}]},{"title":"参考链接","id":"#h2-12","sub":[{"title":"关于微步情报局","id":"#h3-13"}]}],"success":true},"share":{"title":"Konni APT 组织以朝鲜疫情物资话题为诱饵的攻击活动分析","desc":"Konni APT 组织是朝鲜半岛地区最具代表性的 APT 组织之一，自 2014 年以来一直持续活动，据悉其背后由朝鲜政府提供支持，该组织经常使用鱼叉式网络钓鱼的攻击手法，经常使用与朝鲜相关的内容或当前社会热点事件来进行攻击活动，该组织的主要目标为韩国政治组织，以及日本、越南、俄罗斯、中国等地区。","imgUrl":"https://p5.ssl.qhimg.com/sdm/160_160_100/t01eac4d19531e13476.jpg"},"author":{"nickname":"微步在线研究响应团队","user_url":"","id":155341,"avatar":"https://p2.ssl.qhimg.com/t01aa27e1778b04d216.png","banner":"https://p5.ssl.qhimg.com/t01573092fda7526799.png","location":"","user_label":"verify","description":"神秘，低调，手里全是情报。中国网络安全圈不可缺少的力量。","register_date":"2020-11-13 14:44:37","self":false,"follow":false,"post_count":34,"follower_count":33,"follow_count":0,"comment_count":0},"relevant":[{"id":311884,"title":"教你打造一款AI安全助手 | 安全MCP的实践指南","category_name":"安全知识","category_slug":"knowledge","desc":"","date":"2025-09-05 10:40:51","time_interval":"16天前","status":"publish","comment":0,"cover":"https://p5.ssl.qhimg.com/t11fd941d71598ace15e7723411.png","subject":false,"red":false,"type":"origin","url":"","source":"","fee":"","origin_author":"","pv":117508,"like_count":0,"liked":false,"tags":["安全","MCP","安全智能体"],"author":{"nickname":"火山引擎云安全","user_url":"https://www.volcengine.com/product/list","id":165382,"avatar":"https://p3.ssl.qhimg.com/t01d7c5cb6fdb04a6cc.png","banner":"https://p4.ssl.qhimg.com/t014757b72460d855bf.png","location":"","user_label":"","description":"火山引擎云安全产品是字节跳动旗下的企业级安全技术服务产品","register_date":"2022-01-25 13:30:49","self":false,"follow":false,"post_count":39,"follower_count":4,"follow_count":0,"comment_count":0},"is_favorite":false,"favorite_count":0},{"id":311597,"title":"当数字世界的“万能钥匙”被滥用，谁来守护核心资产？火山的 MCP 安全授权新范式","category_name":"安全知识","category_slug":"knowledge","desc":"","date":"2025-08-28 09:50:41","time_interval":"24天前","status":"publish","comment":0,"cover":"https://p3.ssl.qhimg.com/t11fd941d717b312b2021a7fdcf.png","subject":false,"red":false,"type":"origin","url":"","source":"","fee":"","origin_author":"","pv":143536,"like_count":3,"liked":false,"tags":["身份安全","MCP","智能体安全"],"author":{"nickname":"火山引擎云安全","user_url":"https://www.volcengine.com/product/list","id":165382,"avatar":"https://p3.ssl.qhimg.com/t01d7c5cb6fdb04a6cc.png","banner":"https://p1.ssl.qhimg.com/t014757b72460d855bf.png","location":"","user_label":"","description":"火山引擎云安全产品是字节跳动旗下的企业级安全技术服务产品","register_date":"2022-01-25 13:30:49","self":false,"follow":false,"post_count":39,"follower_count":4,"follow_count":0,"comment_count":0},"is_favorite":false,"favorite_count":0},{"id":311484,"title":"Python代码保护之重置操作码映射的攻与防探究（一）","category_name":"安全知识","category_slug":"knowledge","desc":"","date":"2025-08-26 10:49:47","time_interval":"26天前","status":"publish","comment":0,"cover":"https://p2.ssl.qhimg.com/t11fd941d718feac099204e518e.png","subject":false,"red":false,"type":"origin","url":"","source":"","fee":"","origin_author":"","pv":162614,"like_count":2,"liked":false,"tags":["#软件保护"],"author":{"nickname":"360安全应急响应中心","user_url":"","id":122586,"avatar":"https://p1.ssl.qhmsg.com/dm/200_200_100/t01b5d8fecc4d01072b.jpg","banner":"https://p4.ssl.qhimg.com/t014757b72460d855bf.png","location":"","user_label":"src","description":"360安全应急响应中心（360 Security Response Center，简称360SRC）是360公司致力于保障产品及业务安全，促进白帽专家合作与交流的平台。诚邀白帽专家向我们反馈360产品安全漏洞、威胁情报，共筑数字安全基石，保障数亿用户业务和产品的安全。","register_date":"2017-11-29 02:36:21","self":false,"follow":false,"post_count":67,"follower_count":13,"follow_count":0,"comment_count":1},"is_favorite":false,"favorite_count":0},{"id":311498,"title":"广汽集团×火山引擎：出海合规助力企业新增长","category_name":"安全知识","category_slug":"knowledge","desc":"","date":"2025-08-26 10:17:09","time_interval":"26天前","status":"publish","comment":0,"cover":"https://p2.ssl.qhimg.com/t11fd941d71f49ce41992f50a9f.png","subject":false,"red":false,"type":"origin","url":"","source":"","fee":"","origin_author":"","pv":127989,"like_count":2,"liked":false,"tags":["数据安全","出海合规","跨境合规"],"author":{"nickname":"火山引擎云安全","user_url":"https://www.volcengine.com/product/list","id":165382,"avatar":"https://p3.ssl.qhimg.com/t01d7c5cb6fdb04a6cc.png","banner":"https://p1.ssl.qhimg.com/t014757b72460d855bf.png","location":"","user_label":"","description":"火山引擎云安全产品是字节跳动旗下的企业级安全技术服务产品","register_date":"2022-01-25 13:30:49","self":false,"follow":false,"post_count":39,"follower_count":4,"follow_count":0,"comment_count":0},"is_favorite":false,"favorite_count":0},{"id":310094,"title":"从技术到安全：中科固源拆解车载以太网的演进路径与防护策略","category_name":"安全知识","category_slug":"knowledge","desc":"","date":"2025-08-21 21:48:41","time_interval":"1月前","status":"publish","comment":0,"cover":"https://p5.ssl.qhimg.com/t11fd941d71d8518af958972c1e.png","subject":false,"red":false,"type":"origin","url":"","source":"","fee":"","origin_author":"","pv":145494,"like_count":3,"liked":false,"tags":[],"author":{"nickname":"中科数测","user_url":"http://www.gysecurity.cn/","id":175961,"avatar":"https://p4.ssl.qhimg.com/t11fd941d712ac4e71048598691.png","banner":"https://p1.ssl.qhimg.com/t11fd941d7193e6e009506afa34.png","location":"江苏 无锡","user_label":"","description":"致力于成为全球领先的软件应用安全解决方案提供商","register_date":"2025-03-06 14:53:19","self":false,"follow":false,"post_count":24,"follower_count":1,"follow_count":0,"comment_count":0},"is_favorite":false,"favorite_count":0}],"authorPostList":[{"post_id":263872,"title":"Emotet木马\"卷土重来\"","cover":"https://p2.ssl.qhimg.com/sdm/229_160_100/t01091ed8e9cdd4d7b6.jpg","date":"2021-12-28 17:30:46"},{"post_id":259453,"title":"相煎何急，印APT组织蔓灵花针对巴基斯坦政府机构展开定向攻击","cover":"https://p1.ssl.qhimg.com/sdm/229_160_100/t01cec7932b452164ec.jpg","date":"2021-11-23 12:00:45"},{"post_id":258873,"title":"双十一，明知是骗局还想薅骗子羊毛，我做到了！","cover":"https://p1.ssl.qhimg.com/sdm/229_160_100/t01920b9ec8dc6d5856.jpg","date":"2021-11-12 12:00:09"},{"post_id":258167,"title":"涉俄APT组织“圣贤熊”针对军队、政府展开经济犯罪和间谍攻击","cover":"https://p5.ssl.qhimg.com/sdm/229_160_100/t0128e5ff6ca47bc6dc.jpg","date":"2021-11-04 12:00:48"},{"post_id":255674,"title":"推陈出新，Donot组织窃密手法再升级","cover":"https://p2.ssl.qhimg.com/sdm/229_160_100/t011da4e61721e1aef2.jpg","date":"2021-10-21 12:00:10"}],"cookie":[]}};
//published at: 9/22/2025, 12:08:28 AM</script>

<script src="https://s0.ssl.qhimg.com/static/a89b1e55fab19834,969b9d2ab6d58ff9.js"></script>
<script src="https://s0.ssl.qhimg.com/static/e855bc476c0070c4,d70645fabcfd28e5,b00f894d26352cfe,374cd4f654903275,1fbf0cc911f15a9c.js"></script>
<script src="https://s0.ssl.qhimg.com/static/43c736269a19e5f8,d7c4492c306d9e12.js"></script>
<script src="https://s1.ssl.qhimg.com/static/c3f64e723fc684b2,d29a864a4b5dd4b6,5c4b8b1bbe75533d,3cbbb5bd7b96ace3,f9f572860e7f1fa6,6ab68363fa2cf1cd,202ac292c7470749,1b09dc0e16bd1842,7ebff756a224229c,7e2ef3c63800d75a,88ed2ee38308fdef,12d46f82993a5686,a0f3df7d061398da,d13f12550890a37e,0a46dc26872c97c8,93cffabea9a518c8,dfb86725ae65031a,ec64945fd96853ad,e5735d42c0d2e056,915e3f96382bc34a,ad5f8a7d3f94a99b,2a6f530aa0ff4ab1,e0c05ab86f3f1d93,8c7ec1ccfc0836b8,0c4f9ca675acc69c,a4c086374473de3d,935fc52afa3b9d16,0df21b2fbcae7ee2,5ed46454edb70992,48968bfda2315809,fb90e4d59de7fa39,2ac5433e81c47d4c,7080ac52e5b55154,1b7923b08f6ff00b,740d61a0f003e846,7fde21428a656560,28897353362cd92d,89489b46bbccea23,40868d970272a376,7e4ef35e980d3675,1fbafd3380b80586.js"></script>
</body>

</html>