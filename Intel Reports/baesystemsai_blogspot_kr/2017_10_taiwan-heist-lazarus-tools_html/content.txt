<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/55013136-widget_css_bundle.css' rel='stylesheet' type='text/css'/>
<meta content='0Gdhs7qJFR_2QHyAFCpxiAwHZOcJLqubEPCnkznXW3k' name='google-site-verification'/>
<link href="//fonts.googleapis.com/css?family=Open+Sans:700,400,300%7CViga%7CPT+Serif:400,700,400italic,700italic" rel="stylesheet">
<link href="//fonts.googleapis.com/css?family=Oswald:400,700,300" rel="stylesheet" type="text/css">
<meta charset='utf-8'/>
<meta content='width=device-width, initial-scale=1.0' name='viewport'/>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://baesystemsai.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="BAE Systems Threat Research Blog - Atom" href="https://baesystemsai.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="BAE Systems Threat Research Blog - RSS" href="https://baesystemsai.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="BAE Systems Threat Research Blog - Atom" href="https://www.blogger.com/feeds/7345515085838422799/posts/default" />

<link rel="alternate" type="application/atom+xml" title="BAE Systems Threat Research Blog - Atom" href="https://baesystemsai.blogspot.com/feeds/2605495890058237459/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhg3s3hYeUw6wZKwmtJ6ZhvxxsBXQ6Y4Sn51fK9cgofB8AJGWKCJJuKbxmGHlBWFRu2nkkaUifMKCDEFGHUYEEa-fMgavskBi94jpSv8lp194wrbgrjjV09R0dO8zOM1yQNOHisRTDhEeo/s1600/Timeline.png' rel='image_src'/>
<meta content='https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html' property='og:url'/>
<meta content='Taiwan Heist: Lazarus Tools and Ransomware' property='og:title'/>
<meta content='Written by Sergei Shevchenko, Hirman Muhammad bin Abu Bakar, and James Wong   BACKGROUND   Reports emerged just over a week ago of a new cyb...' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhg3s3hYeUw6wZKwmtJ6ZhvxxsBXQ6Y4Sn51fK9cgofB8AJGWKCJJuKbxmGHlBWFRu2nkkaUifMKCDEFGHUYEEa-fMgavskBi94jpSv8lp194wrbgrjjV09R0dO8zOM1yQNOHisRTDhEeo/w1200-h630-p-k-no-nu/Timeline.png' property='og:image'/>
<title>BAE Systems Threat Research Blog: Taiwan Heist: Lazarus Tools and Ransomware</title>
<style id='page-skin-1' type='text/css'><!--
/*
/*------------------------------------------------------
Variable @ Template Designer
--------------------------------------------------------
<Variable name="keycolor" description="Main Color" type="color" default="#66bbdd"/>
<Variable name="body.background" description="Body Background" type="background"
color="transparent" default="$(color) none repeat scroll top left"/>
<Group description="Body" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 16px/1.7em 'PT Serif', Georgia, Serif"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#555"/>
<Variable name="body.link.color" description="Link Color" type="color" default="#758ee2"/>
</Group>
<Group description="Heading" selector=".post h3, .widget h2">
<Variable name="heading.font" description="Title Font" type="font"
default="normal normal 14px/1.8em 'Open Sans', 'Helvetica Neue', Helvetica, Arial"/>
<Variable name="heading.color" description="Title Color" type="color" default="#222222"/>
</Group>
<Group description="Element" selector=".post h3, .widget h2">
<Variable name="post.title.font" description="Post Title Font" type="font"
default="normal normal 48px/1em 'Viga', 'Helvetica Neue', Helvetica, Arial"/>
<Variable name="widget.title.font" description="Widget Title Font" type="font"
default="normal normal 16px/1.8em 'Open Sans', 'Helvetica Neue', Helvetica, Arial"/>
<Variable name="branding.font" description="Tagline Font" type="font"
default="300 normal 48px/1.2em 'Open Sans', Helvetica, Arial"/>
</Group>
<Group description="Additional" selector=".navigation">
<Variable name="navigation.font" description="Navigation Font" type="font"
default="bold normal 13px/1.6em 'Open sans', 'Helvetica Neue', Helvetica, Arial"/>
<Variable name="scheme.color" description="Scheme Color" type="color" default="#7c98e4"/>
</Group>
------------------------------------------------------*/
/*------------------------------------------------------
00. Table of Content
--------------------------------------------------------
01. Reset CSS
02. Global
* font-family: PT Serif, Open Sans, Sans-serif;
* font-size: 16px;
03. Header
- Logo
- Navigation
04. Tagline
05. Slidetoggle
06. Main
- Primary Content
- Blog pager
- Comments
07. Sidebar
08. Widgets
- Flickr
- Popular posts
- Search
09. Footer
----------------------------------------------------- */
/*------------------------------------------------------
01. Reset CSS
------------------------------------------------------*/
body, html  { height: 100%}
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, font, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td {
margin: 0;
padding: 0;
border: 0;
outline: 0;
font-size: 100%;
vertical-align: baseline;
}
body { line-height: 1}
ol, ul { list-style: none}
blockquote, q { quotes: none}
blockquote:before, blockquote:after, q:before, q:after { content: ''; content: none}
:focus { outline: 0}
del { text-decoration: line-through}
table { border-collapse: collapse; border-spacing: 0}
/*------------------------------------------------------
02. Global
------------------------------------------------------*/
body {
color: #555555;
font-family: Arial, sans-serif;
}
.container {
background: #fff;
}
.content-wrapper {
background: #fff;
width: 1020px;
margin: 0 auto;
padding: 20px 0 50px;
}
/*
* Shortcode
*/
.left {
float:left
}
.right {
float:right
}
.center {
text-align:center
}
.clear {
clear:both
}
ul:after {
visibility: hidden;
display: block;
height: 0;
clear: both;
}
pre {
padding:10px;
margin:20px 0;
border:1px solid #ddd;
background:#e8e8e8;
overflow:auto;
}
pre br{
display:none;
}
code {
font:1em/1.2em 'courier new', courier, monospace;
}
a:link {
color: #333;
text-decoration: none;
}
a:visited,
a:hover {
color: #333;
text-decoration: underline;
}
h1, h2, h3, h4, h5, h6 {
font-family: 'Oswald', sans-serif;
font-weight: 700;
}
/*
* Button
*/
.button {
font: bold normal 13px/1.6em 'Open sans', 'Helvetica Neue', Helvetica, Arial;
text-transform: uppercase;
background-color: #758ee2;
padding: 7px 15px;
text-decoration: none !important;
border-radius: 2px;
overflow: hidden;
cursor: pointer;
display: inline-block;
color: #fff !important;
}
/*------------------------------------------------------
03. Header
------------------------------------------------------*/
.outer-header {
border-bottom: 7px solid rgb(252,76,2);
width: 100%;
}
.header-wrapper {
background: #fff;
width: 1020px;
margin: 0 auto;
padding: 30px 0 0;
clear: both;
}
.header h1 {
color: #333;
font-family: 'Oswald', sans-serif;
font-size: 22px;
font-weight: 700;
text-transform: uppercase;
}
.header .description {
font-size: 10px;
text-transform: uppercase;
}
#header {
margin-bottom: 16px;
}
.top-menu {
float: right;
}
.top-menu li {
display: inline-block;
}
.top-menu a {
color: #3a3a3a;
font-size: 12px;
padding: 0 5px;
}
/*
* Navigation
*/
.navigation {
width: 100%;
}
.navigation h2 {
display: none;
}
.navigation ul {
float: left;
}
.navigation ul li {
display: inline;
float: left;
}
.navigation ul li a {
display: block;
font: 16px/1.6 Arial, sans-serif;
color: #222;
padding: 10px 16px;
text-decoration: none;
}
.navigation li.selected a,
.navigation ul li a:hover {
background: rgb(252,76,2);
color: #fff;
}
.PageList LI.selected A {
font-weight: normal !important;
}
.PageList {
float: left;
width: auto;
}
.CustomSearch {
float: left;
height: 45px;
line-height: 45px;
margin-left: 1%;
width: 22%;
}
input.gsc-input {
border-radius: 2px;
padding: 8px 6px !important;
width: 94% !important;
}
input.gsc-search-button {
background: #333;
border: none !important;
color: #fafafa;
font-family: 'Open Sans', sans-serif;
font-size: 13px;
font-weight: 700;
margin-top: 6px;
margin-left: 12px !important;
outline: none;
padding: 8px 14px;
text-transform: uppercase;
-webkit-appearance: none;
border-radius: 0;
}
input.gsc-search-button:hover {
background: rgb(252,76,2);
}
div#BlogArchive1 {
display: none;
}
table.gsc-search-box td.gsc-input {
padding-right: 0 !important;
}
/*------------------------------------------------------
04. Tagline
------------------------------------------------------*/
.branding {
position: relative;
width: 100%;
}
.branding-wrap {
width: 1020px;
margin: auto;
position: absolute;
top: 0;
right: 0;
left: 0;
}
.branding .sidebar {
padding: 0 !important;
margin: 0;
text-align: center;
color: #fff;
font: 300 normal 48px/1.2em 'Open Sans', Helvetica, Arial;
}
.branding .sidebar .button {
background: transparent;
border: 2px solid #fff;
}
.branding .sidebar .widget {
margin: 0;
padding: 0;
}
.banner-text {
border-left: 7px solid #333;
float: left;
margin-top: 20px;
padding: 4px 0;
width: 520px;
}
.banner-text .widget-content span:first-of-type,
.banner-text .widget-content a,
.banner-text .widget-content p {
background: #333 !important;
color: #fff !important;
font-family: 'Oswald', sans-serif !important;
font-size: 36px !important;
font-weight: 700 !important;
line-height: 1.3 !important;
padding: 0 8px 0 0 !important;
text-transform: uppercase !important;
white-space: pre-wrap !important;
}
.banner-logo {
float: right;
margin-top: 20px;
}
div#Image1 .widget-content img {
min-height: 190px;
max-height: 300px;
}
div#Image2 {
margin: auto;
width: 1020px;
}
div#Image2 .widget-content {
position: absolute;
top: 22px;
right: 22%;
}
div#Image2 .widget-content img {
width: 210px;
}
/*------------------------------------------------------
05. Slidetoggle #theGrid
------------------------------------------------------*/
.slidetoggle {
padding: 40px 0;
background: #444;
color: #aaa;
text-align: center;
display: none;
}
.slides {
width: 1020px;
margin: 0 auto;
background: url(https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3h73woD4JYgcNu56jZPLZP804dpqYaalIQ1WZflaypk2WJvofBwql6wZBgUfEki_XCgccxMYSMMMuw_mxjIx55UwXVkiaUFyRRs51fB2FhWq3qwDVpy63llBNPpgUQO0MCpLAf_P2_T8T/s1600/border_slides.png) repeat-y center center;
}
.slides .grid {
width: 340px;
padding: 0;
}
.slides .grid .widget {
padding: 0 20px;
background: none;
margin-bottom: 0;
}
.slides .grid .widget h2 {
background: none;
color: #bbb;
}
.grid a,
.grid a:visited {
color: #f2f2f2;
}
.grid a:hover {
color: #fff;
text-decoration: underline;
}
/*------------------------------------------------------
06. Main
------------------------------------------------------*/
.main-wrapper {
width: 700px;
}
/*
* Primary content
*/
.post-outer {
padding-bottom: 50px;
border-bottom: 1px solid #ddd;
margin: 0 10px !important;
text-align: inherit !important;
}
.post h3.entry-title a, .post h3.entry-title {
color: #444;
margin: 10px 0 30px 0;
text-decoration: none;
text-transform: uppercase;
font-family: 'Oswald', sans-serif;
font-size: 24px;
font-weight: 700;
line-height: 1.5;
}
.post-body {
font-size: 15px;
line-height: 1.5em;
font-family: Arial, sans-serif;
}
.post-body img,
.post-body iframe {
max-width: 100%;
height: auto;
margin-top: -5px;
margin-bottom: 10px;
}
.post-body h1,
.post-body h2,
.post-body h3,
.post-body h4,
.post-body h5,
.post-body h6 {
margin-top: 20px;
margin-bottom: 20px
font-size: 48px;
line-height: 1.2em;
font-weight: normal;
}
.post-body h2 {
font-size: 37px;
}
.post-body h3 {
font-size: 32px;
line-height: 1.5em;
}
.post-body h4 {
font-size: 27px;
line-height: 1.6em;
}
.post-body h5 {
font-size: 20px;
line-height: 1.8em;
}
.post-body h6 {
font-size: 18px;
line-height: 1.8em;
}
.post-body blockquote {
font-style: italic;
line-height: 1.6em;
font-size: 22px;
margin: 30px 0 20px -20px;
padding-left: 15px;
border-left: 5px solid #758ee2;
}
.post-body blockquote p {
padding: 0;
margin: 0;
}
.post-body a:link,
.post-body a:visited {
text-decoration: underline;
}
.post-header-line-0 {
border-top: 1px dotted #c1c1c1;
color: #aaa;
margin-bottom: 20px;
padding-top: 20px;
}
.post-header-line-0 a {
color: #aaa;
text-decoration: underline;
}
.post-footer {
font: normal 13px/1.6em 'Open Sans', Helvetica, Arial;
color: #aaa;
margin-top: 40px;
}
.jump-link a {
color: #fff;
font: bold normal 13px/1.6em 'Open sans', 'Helvetica Neue', Helvetica, Arial;
text-transform: uppercase;
background: #444;
padding: 5px 20px;
border-radius: 2px;
}
.breadcrumbs {
font-size: 12px;
margin-bottom: 24px;
padding-left: 10px;
}
.breadcrumbs a {
text-decoration: underline !important;
}
/*
* Blog pager
*/
#blog-pager {
margin-top: 60px;
clear: both;
}
#blog-pager a {
float: left;
text-decoration: none;
color: #fff;
background: #ccc;
padding: 10px 20px;
text-transform: uppercase;
font: bold normal 13px/1.6em 'Open sans', 'Helvetica Neue', Helvetica, Arial;
border-radius: 2px;
}
#blog-pager a:hover {
background: rgb(252,76,2) url(https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0MOVywxg59TmK3wWYS0_1tb96BdjTnmRVa1AfIpa1FOY2BUfROxbSWEBQa48n_qWHncRbH8ERaVm2W2rtmJgB-KEOe_lymWdzhgnjI1Ya2srspqksFM68yBJhoHBqPXWWLWkb_2lBMUzJ/s1600/icon_home.png) no-repeat center;
}
#blog-pager span {
float: left;
margin-right: 5px;
}
#blog-pager .home-link {
margin-right: 5px;
width: 2px;
text-indent: -900px;
overflow: hidden;
background: #333 url(https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0MOVywxg59TmK3wWYS0_1tb96BdjTnmRVa1AfIpa1FOY2BUfROxbSWEBQa48n_qWHncRbH8ERaVm2W2rtmJgB-KEOe_lymWdzhgnjI1Ya2srspqksFM68yBJhoHBqPXWWLWkb_2lBMUzJ/s1600/icon_home.png) no-repeat center;
}
.feed-links {
display: none;
}
.status-msg-border {
border: none !important;
}
.status-msg-bg {
background-color: #eaeaea !important;
}
.blog-posts.hfeed {
box-sizing: border-box;
float: left;
margin-bottom: 20px;
width: 100%;
}
.blog-pager-older-link:hover,
.blog-pager-newer-link:hover {
background-image: none !important;
background-color: rgb(252,76,2);
}
/*
* Comments
*/
.comments {
margin-top: 40px;
padding-top: 20px;
border-top: 1px solid #ccc;
}
.comments h4 {
background: url(https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgVfA0GdQOhwRczDQWsBNBqljELJkJqv0F-ISqWVMdv34kdWN4DXjER5M2PyP5XXvMsIdHw9UxRAXHObDPThud-06w1t2nusNiVmdvRXJNFpoCMuK-qOlaDaiZAGTBP9zBRZMFwg72maW9O/s1600/icon_comments.png) no-repeat left 5px;
margin-bottom: 20px;
padding-bottom: 20px;
padding-left: 30px;
clear: both;
font-family: 'Open Sans', sans-serif;
}
.comment-header .user {
padding-right:10px;
margin-right:10px;
border-right:1px solid #ddd;
}
.comment-header .user a {
font: normal normal 16px/1em 'Viga', 'Helvetica Neue', Helvetica, Arial;
text-decoration:none;
}
.comment-header span.blog-author,
.comment-header span.icon {display:none!important}
.comment-header .datetime a {
font-size: 12px;
color: #aaa;
}
.comment-thread li .comment-block {
border-bottom:1px dotted #ddd;
padding-bottom:10px;
}
.comment-content {
}
.comments blockquote {
margin-bottom:20px;
padding:10px 0;
border-bottom:1px solid #ddd;
line-height:1.6em;
}
#comment-holder .comment-block .comment-actions a {
font-size:12px;
margin-right:10px;
background-position:-15px center;
-o-transition: all 0.5s;
-moz-transition: all 0.5s;
-webkit-transition: all 0.5s;
}
#comment-holder .avatar-image-container {
border-radius: 2px;
overflow: hidden;
}
#comment-holder .avatar-image-container img {
}
#comments-block.avatar-comment-indent  {
position:relative;
margin:0 auto;
}
.widget-content.list-label-widget-content span {
color: rgb(252,76,2);
font-family: Arial, sans-serif;
font-size: 14px;
line-height: 1.5;
}
/*------------------------------------------------------
07. Sidebar
------------------------------------------------------*/
#sidebar {
margin-bottom: -40px;
}
#sidebar .widget h2 {
margin-left: -15px;
margin-right: -15px;
padding: 12px 15px;
font-family: 'Oswald', sans-serif;
font-size: 16px;
color: #444;
text-transform: uppercase;
background: #e1e1e1;
}
#sidebar .widget a:link,
#sidebar .widget a:visited {
text-decoration: none;
font-family: Arial, sans-serif;
font-size: 13px;
line-height: 1.5;
}
.sidebar-wrapper {
width: 300px;
margin-left: 20px;
border-radius: 2px;
}
.sidebar .widget h2 {
margin-bottom: 20px;
}
.sidebar .widget {
margin-bottom: 20px;
}
.sidebar .widget img,
.sidebar .widget iframe {
width: 100%;
height: auto;
}
div#Label2,
div#PopularPosts1 {
background: #efefef;
padding: 0 15px 15px;
}
div#HTML1, div#HTML2 {
background: #efefef;
padding: 0;
}
#HTML1 h2.title, #HTML2 h2.title {
background: #e1e1e1;
font-size: 16px;
margin: 0;
padding: 12px 15px;
}
#HTML1 .widget-content, #HTML2 .widget-content {
padding: 15px;
}
#HTML1 p, #HTML2 p {
color: #2c2c2c;
font-size: 13px;
line-height: 1.5;
}
.contact-info {
border-top: 1px dotted #c1c1c1;
float: left;
margin: 15px -15px 0;
padding: 15px;
width: 100%;
}
.contact-info a:first-of-type {
color: rgb(252,76,2);
}
.contact-btn {
background-color: #333;
background-image: url('https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_tXvUbfdTzvRN6sTZ3vv7hwQlS7YP1zBuTHIAF09v5_uS-kLqramelkqvtAn6AgWkAZtb7BttI7WYekhWuJ7By6iXqTY6Udr9tPCNR7MIvKXyvTt8bzOSwQiQRJ3flcqeMn7PwuAO-EtisQkiFQx1QDOBE=s0-d');
background-position: right center;
background-repeat: no-repeat;
border-radius: 8px;
color: #fff !important;
display: block;
float: left;
margin-bottom: 20px;
padding: 8px 24px 8px 10px;
}
.contact-btn:hover {
background-color: rgb(252,76,2);
}
span.tag-count {
background: #2c2c2c;
color: #fff !important;
float: right;
font-family: 'Open Sans', sans-serif !important;
font-size: 12px !important;
font-weight: bold;
padding: 0 5px;
}
.widget-content.list-label-widget-content li {
border-bottom: 1px solid #c1c1c1;
margin-bottom: 5px;
padding-bottom: 5px;
}
.widget-content.list-label-widget-content li:last-of-type {
border: none;
}
/*------------------------------------------------------
08. Widgets
------------------------------------------------------*/
.widget a {
text-decoration: none;
}
/*
* Flickr
*/
.flickr_wrap {
margin-left: -5px;
margin-right: -5px;
}
.flickr_badge_image {
float: left;
margin: 5px;
height: 60px;
width: 60px;
border-radius: 2px;
overflow: hidden;
}
.flickr_badge_image img {
height: 100%;
width: 100%;
}
.grid .flickr_wrap {
margin-left: -7px;
margin-right: -7px;
}
.grid .flickr_badge_image {
margin: 7px;
height: 64.5px;
width: 64.5px;
}
/*
* Popular Posts
*/
.PopularPosts ul li {
margin-bottom: 5px;
padding-bottom: 5px;
border-bottom: 1px solid #c1c1c1;
}
.PopularPosts ul li:last-of-type {
border: none;
}
.PopularPosts .item-title {
float: left !important;
min-height: 60px;
width: 74%;
}
.PopularPosts .item-title a {
font-weight: bold;
font-size: 14px !important;
line-height: 1.5 !important;
display: block;
margin-top: 5px;
text-decoration: none;
font-family: 'Oswald', sans-serif !important;
text-transform: uppercase;
}
.PopularPosts .item-snippet {
font-size: 14px;
line-height: 1.6em;
}
.PopularPosts .item-thumbnail {
width: 60px;
height: 60px;
border-radius: 2px;
overflow: hidden;
margin-right: 10px;
margin-top: 5px;
}
.PopularPosts .item-thumbnail img {
width: 60px;
height: 60px;
}
.post-labels a {
font-size: 14px !important;
font-family: Arial, sans-serif !important;
}
/*
* Search
*/
#searchform {
background: #fff;
padding: 10px;
border-radius: 2px;
border: 1px solid #e1e1e1;
overflow: hidden;
}
#searchform:after {
content: ".";
visibility: hidden;
display: block;
height: 0;
clear: both;
}
#searchform label {
display:none;
}
#searchform #s {
width: 150px;
border: 0;
padding: 0;
float: left;
color: #aaa;
}
#searchform #searchsubmit {
background: url(https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhhIMt_iHr0pgw8VvSdKGq8R9pWLJCTqIruC105rZ0FG2SPzvKY22ci_nUsml6qf8XI6P6BlpG5RmlsKRJGEB8eqrzqKD-k9YCcjf1o4gw4XM0NPvuO9hPzaG6oTeKFjN5hr5pqtcnqmdWO/s1600/icon_search.png) no-repeat center center;
width: 20px;
float: right;
border: 0;
padding: 0;
text-indent: -900px;
}
.status-msg-wrap {
font-size: 14px !important;
margin: 20px auto !important;
width: 100% !important;
}
.status-msg-body {
text-align: inherit !important;
padding-left: 10px !important;
}
.status-msg-bg {
background: none !important;
}
.status-msg-body a {
background: #ccc;
border-radius: 2px;
color: #fff;
font-family: 'Open Sans', sans-serif;
font-size: 13px;
font-weight: bold;
float: right;
margin: -10px 20px 0 0;
padding: 10px 20px;
text-transform: uppercase;
}
.status-msg-body a:hover {
background: rgb(252,76,2);
}
/*------------------------------------------------------
09. Credit
------------------------------------------------------*/
footer.credit {
background: #444;
padding: 40px 0;
color: #ccc;
text-align: center;
}
footer.credit a {
color: #fff;
}
footer.credit a:hover {
text-decoration: underline;
}
footer { color : #FFFFFF }
footer nav { height : 96px; background : #222 }
footer .wrap { width: 1020px; margin: auto; }
footer div#social { background : #000000; font-weight : 700; padding-top : 40px }
footer div#social div#connect { float : left; display: block; margin-top: 14px; }
footer div#social span#connect-text { display : inline-block; line-height : 25px; position : relative; top : -6px; margin-right : 5px }
footer div#copyright { background : #000000; font-size : 80%; padding-top : 13px; padding-bottom : 50px }
/* UPDATED SOCIAL ICONS */
.social-icon-list { float: left; padding: 26px 0 26px 10px; list-style: none; }
.social-icon-list li { float: left; margin-right: 10px; cursor: pointer; height: 44px; width: 44px; position: relative; }
.social-icon-list li a { height: 0; width: 0; display: inline-block; position: absolute; top: 22px; left: 22px; margin: auto; background-size: 44px 44px; background-position: center; border-radius: 22px; transition: width 1.1s cubic-bezier(0.19, 1, 0.22, 1), height 1.1s cubic-bezier(0.19, 1, 0.22, 1), top 1.1s cubic-bezier(0.19, 1, 0.22, 1), left 1.1s cubic-bezier(0.19, 1, 0.22, 1), border-radius 1.5s cubic-bezier(0.19, 1, 0.22, 1) 0.2s; }
.social-icon-list li:hover a { width: 44px; height: 44px; border-radius: 0px; top: 0; left: 0; }
.social-icon-list .twitter-icon { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_u0Nk_TwDrR5JijIKqAjMVUPNb-zMOtCVZ6LlWFWX3fu_zGM3k71c-3JUQBehke0uvWJGBMbIFg09sW9lsgcuFaah4P8L8APlk-8u6dArTwFa7QGnh6LhvzNYPAL0AOWr0=s0-d"); }
.social-icon-list .twitter-icon:hover a { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_tzEoyU-FrF8a57rhmBcYdyE15bEMI7AoE0wEOWZwncPgw4KKhvZh1h9N8-b7oNp99HSda3UWSanebbTE8XodWhlBi1fRpedE3iOLKwlGHyryfRSsxc4zSNYqr53hqm8h7415lETx-e=s0-d"); }
.social-icon-list .fb-icon { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_tPgB2nKO3_Zv0xIn7aybMDQud9btKywfblXnr3ZNB4GKJht1ol33PV5pSnyDdqxSEkhMnGwuyUomSpg9O0_ycniU6qsgX2v-CsVECtn7rVJgizGLlRc2c5Uwt2yCI1RHTH=s0-d"); }
.social-icon-list .fb-icon:hover a { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_u5r2gnbH5Nq1G77_7mvwsR_3FTo60yNGisYtEihKx0K9FFx4xGpHO0Y1lWzgTWK6DhQOCAPXNj8VBzDybkSm0rOWbt1gnjkFZLa-SLhN_wDxJFmtGeMtMxr9YCnoBJzD8io6ThmnGlgQ=s0-d"); }
.social-icon-list .in-icon { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_vLALJs-U1DF806jbXqSKMVEqpEywf6fkTtYbp8_tLiuTg55HbzdvOKioCFfG-QdGQXCmS29y8GIHPw4UfWMD-VQCiKIQ5Q2Mg3KZ91QOFLOBXzYpL5wN7p1T_6K0ZVvnER=s0-d"); }
.social-icon-list .in-icon:hover a { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_t3PvrpbHNFeHHumdErk02klftQKE8mT75GXZ-42SGBC2lipFJh29betoHVOEjriL_4s2Ep08fqpa9Styt10vXKuJu3_kk8D3fcHfaVPBZWhbz3ekSTMCyXdN7vR1v5tE0iFYDiumDPJQ=s0-d"); }
.social-icon-list .flickr-icon { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_uXcoC3lIU96yao6_21zGaWRJJNio-ZsaGPKpjpnaMytqGIvRr8rwHhyvhF2vCu_dByoBbXSUgn7J7dzXuVMLTFWpxNG8BWw2UUXv0UVeaA6KTEimO3OWlVPlQSg-ENTBA=s0-d"); }
.social-icon-list .flickr-icon:hover a { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_vLLyfGcJwCvW3sWrXPNm0Cl2fXpCAW7280Vlj5Y_fRzhZKZW_s_7hnS7WNuX3XarUipnQcoHSigMVUsmR_OxUgugaUllE3WYgP3graNpoWSU-f3GVfCMVTYnxh8rvjTZ19uJ6s1Uw=s0-d"); }
.social-icon-list .youtube-icon { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_ukuCceStZl4i48bdMoip2ijs_co7tAH7bKrLu7JCrHE38fgLMZt2QdHwtIF0do15q6pF1wKZXOSP1dA9SpYOvFGSi5ZD-FtDi-mdI5KxoGiQE3qZNhGy_OfIibx-X1RTKr=s0-d"); }
.social-icon-list .youtube-icon:hover a { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_ue-WAtHwlhYoB1dTePVz0kN_4xumVVZM_taIT_G2UepOWV7IgfWMI8-SEFe7kK1WK1LTevhLY1_00k1XCODEmIp210NerTXVxjilWIQJH9zpY1HpHCACo1ylsPvinkULNtLvaL_P1l=s0-d"); }
/* FOOTER UPDATES */
.footerWrapper { background: url("https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_tHnsgF5BBMtl1j_8xgAVaodVCik9MWauO7w634XMc889ndworuHgsuGBx9NIow2lk08oJOHCEwZIdoDs8BmreCezZWuZqr3q3W3ZG1QKmDDMl74zXb2mgb3z_iRSgXQPA=s0-d") right center; background-repeat: no-repeat; margin: auto; min-height: 96px;}
.bottom-bar { background: #111; min-height: 48px; }
.footerList { padding: 12px 0; float: left; list-style: none; line-height: 24px; }
.footerList li { float: left; position: relative; }
.footerList li a { color: #666; font-size: 12px; font-family: Arial, sans-serif; border-right: 1px solid #666; padding: 0 10px; text-decoration: none; }
.footerList li:last-child a { border: none; }
.copy { float: right; padding: 12px 0; color: #666; font-size: 12px; line-height: 24px; }
.copyright { float: right; line-height: 24px; color: #666; font-family: Arial, sans-serif; font-size: 12px; padding: 12px 0; }
blockquote {
width:450px;
quotes: '"' '"';
text-align:left;
padding: 0.5em 10px;
margin: 1.5em 10px;
border-left: 4px solid #fc4c02;
}
blockquote:before {
content: open-quote;
font-size: 24pt;
text-align: center;
line-height: 42px;
color: #fff;
background: #ddd;
float: left;
position: relative;
border-radius: 25px;
margin-right: 0.5em;
vertical-align: -0.4em;
/** define it as a block element **/
display: block;
height: 25px;
width: 25px;
}
blockquote:after {
content: close-quote;
font-size: 24pt;
text-align: center;
line-height: 42px;
color: #fff;
background: #ddd;
float: right;
position: relative;
border-radius: 25px;
margin-right: 1em;
vertical-align: -0.5em;
/** define it as a block element **/
display: block;
height: 25px;
width: 25px;
}
blockquote:hover:after, blockquote:hover:before {
background-color: #FC4C02;
transition: all 350ms;
-o-transition: all 350ms;
-moz-transition: all 350ms;
-webkit-transition: all 350ms;
}
--></style>
<!-- = / jQuery /= -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="//i-biyan.com/js/html5.js"></script>
<!-- = / JS Trigger / = -->
<!-- = / conditional statement / = -->
<!-- = / Responsive / = -->
<style>
    @media screen and (max-width: 1040px) {
      .header-wrapper {
        width: 900px;
      }
      .branding .sidebar {
        margin: 0 auto;
      }
      .content-wrapper {
        width: 900px;
      }
      .main-wrapper {
        width: 580px;
		padding: 0 60px;
		box-sizing: border-box;
      }
      .slides {
        width: 760px;
        background-image: none;
      }
      .slides .grid {
        width: 233.33333333333333333333333333333px;
        margin-left: 10px;
        margin-right:10px;
      }
	  .navigation ul li a {
	    font-size: 14px;
		padding: 12px 14px;
      }
	  .branding-wrap {
		width: 900px;
      }
	  .sidebar-wrapper {
		margin: 0 10px;
      }
	  footer .wrap {
		width: 880px;
		padding: 0 10px;
      }
	  .banner-text span {
		font-size: 32px;
      }
    }

	@media screen and (max-width: 920px) {
	  .header-wrapper {
		width: 740px;
      }
	  #header {
		margin-left: 2%;
      }
	  .PageList {
		float: none;
		margin: auto;
		width: 96%;
      }
	  .CustomSearch {
		float: none;
		margin: auto;
		width: 40%;
      }
	  .branding-wrap {
		width: 740px;
      }
	  .content-wrapper {
		width: 740px;
      }
	  .main-wrapper {
		width: 460px;
		padding: 0 20px;
      }
	  .post-body .thumbs {
		width: 120px;
		height: 120px;
      }
	  .sidebar-wrapper {
		width: 260px;
      }
	  .PopularPosts .item-title {
		width: 68%;
      }
	  footer .wrap {
		width: 720px;
      }

    }

    @media screen and (max-width: 767px) {
      .header-wrapper {
        width: 100%;
		padding-top: 20px;
      }
      .header, .navigation {
        width: 100%;
        float: none;
        clear: both;
        text-align: center;
      }
      .header img {
        margin-left: auto;
        margin-right: auto;
      }
	  div#header {
		width: auto;
		float: left;
		margin: -18px 0 20px 23px;
      }
      .navigation {
        margin-top: 30px;
      }
      .navigation ul li {
        text-align: center;
        display: inline;
      }
      .branding .sidebar {
        width: 100%;
      }
	  .branding-wrap {
		width: 90%;
		margin: auto;
      }
	  div#Image1 .widget-content img {
		min-height: 200px;
      }
      .content-wrapper {
        width: 500px;
      }
      .sidebar-wrapper {
        width: 500px;
        margin: 40px 0 0 0;
      }
      .slides {
        width: 500px;
      }
      .slides .grid {
        width: 100%;
        margin: 0 0 30px 0;
        padding: 0 0 30px 0;
        border-bottom: 1px dotted #777;
      }
      footer.credit .footer {
        width: 500px;
        margin: 0 auto;
      }
	  footer .wrap {
		width: 96%;
		padding: 0 2%;
      }
    }

	@media screen and (max-width: 620px) {
	  .content-wrapper {
		width: 90%;
      }
	  .main-wrapper {
		width: 100%;
      }
    }
		
  </style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7345515085838422799&amp;zx=c37a2204-52be-4b6f-b261-6482fac393db' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7345515085838422799&amp;zx=c37a2204-52be-4b6f-b261-6482fac393db' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading'>
<div class='navbar section' id='navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar/7345515085838422799?po\x3d2605495890058237459\x26origin\x3dhttps://baesystemsai.blogspot.com',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='outer-wrapper'>
<div class='container'>
<div class='outer-header'>
<header class='header-wrapper'>
<div class='top-menu'>
<ul>
<li><a href='http://www.baesystems.com/en/cybersecurity/resources' target='_blank'>Resources</a></li>
<li><a href='http://www.baesystems.com/en/cybersecurity/contact-us' target='_blank'>Contact us</a></li>
</ul>
</div>
<div class='header left section' id='header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://baesystemsai.blogspot.com/'>
BAE Systems Threat Research Blog
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
<div class='navigation right section' id='navigation'><div class='widget PageList' data-version='1' id='PageList1'>
<h2>Pages</h2>
<div class='widget-content'>
<ul>
<li>
<a href='https://baesystemsai.blogspot.com/'>Home</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/products'>Products</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/solutions'>Solutions</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/news-and-events'>News & Events</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/partners'>Partners</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/about-us'>About Us</a>
</li>
<li>
<a href='http://www.baesystems.com/en/cybersecurity/careers'>Careers</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2017/'>
2017
</a>
<span class='post-count' dir='ltr'>(5)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2017/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='posts'>
<li><a href='https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html'>Taiwan Heist: Lazarus Tools and Ransomware</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2017/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2017/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2017/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2016/'>
2016
</a>
<span class='post-count' dir='ltr'>(4)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2016/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2016/04/'>
April
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2016/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2015/'>
2015
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2015/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2015/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2015/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2013/'>
2013
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://baesystemsai.blogspot.com/2013/11/'>
November
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
</div>
</div><div class='widget BlogSearch' data-version='1' id='BlogSearch1'>
<h2 class='title'>Search</h2>
<div class='widget-content'>
<div id='BlogSearch1_form'>
<form action='https://baesystemsai.blogspot.com/search' class='gsc-search-box' target='_top'>
<table cellpadding='0' cellspacing='0' class='gsc-search-box'>
<tbody>
<tr>
<td class='gsc-input'>
<input autocomplete='off' class='gsc-input' name='q' size='10' title='search' type='text' value=''/>
</td>
<td class='gsc-search-button'>
<input class='gsc-search-button' title='search' type='submit' value='Search'/>
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class='clear'></div>
</div></div>
<div class='clear'></div>
</header><!-- END HeaderWrapper -->
</div>
</div>
<div class='branding'>
<div class='sidebar tagline section' id='tagline'><div class='widget Image' data-version='1' id='Image1'>
<div class='widget-content'>
<img alt='BAE Systems AI Blog Banner' height='180' id='Image1_img' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjprvi0pJhuy3vOA2R4XPr0uQUleJp9wXv1gAselLH6PoELE3uo6wFTTXc-_JWDaErgR_b5qKOy_Svf82dcRmdDHhMiGlYgg5n7BNZ0qNN7PBzLixVguXMD0RhTLDnsa9jegdhRP4_B8sg/s1600-r/Threat+Research+Blog+Banner.jpg' width='1600'/>
<br/>
</div>
<div class='clear'></div>
</div></div>
<div class='branding-wrap'>
<div class='banner-text section' id='ban-text'><div class='widget Text' data-version='1' id='Text1'>
<div class='widget-content'>
<span>Threat Research Blog</span>
</div>
<div class='clear'></div>
</div></div>
<div class='banner-logo'>
<img src="https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_sQ63vyVQ52lEINZfthlhM_IS0hVS6nzQ7jweNsEP8AKK7kTGlDW2tX9qjfwvhQKqrKlX52aRoJgRBRJDiwZrvPnvKH-eCWkV9hLV3-lbDu5taDIyHJzXz8Th297aEnC6E-21su=s0-d">
</div>
</div>
</div>
<div class='slidetoggle'>
<div class='slides'>
<div class='sidebar grid left no-items section' id='grid1'>
</div>
<div class='sidebar grid left section' id='grid2'><div class='widget HTML' data-version='1' id='HTML3'>
<h2 class='title'>Flickr</h2>
<div class='widget-content'>
</div>
<div class='clear'></div>
</div></div>
<div class='sidebar grid left section' id='grid3'><div class='widget Label' data-version='1' id='Label1'>
<h2>Labels</h2>
<div class='widget-content list-label-widget-content'>
<ul>
<li>
<a dir='ltr' href='https://baesystemsai.blogspot.com/search/label/Threat%20Research'>Threat Research</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div></div>
<div class='clear'></div>
</div>
</div>
<div class='container'>
<div class='content-wrapper'>
<div class='main-wrapper left'>
<div class='main section' id='main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>
<div class='breadcrumbs' xmlns:v='http://rdf.data-vocabulary.org/#'>
<span typeof='v:Breadcrumb'><a href='https://baesystemsai.blogspot.com/' property='v:title' rel='v:url'>Home</a></span>

 &#187; <span typeof='v:Breadcrumb'><a href='https://baesystemsai.blogspot.com/search/label/Threat%20Research' property='v:title' rel='v:url'>Threat Research</a></span>

 &#187; <span>Taiwan Heist: Lazarus Tools and Ransomware</span>
</div>
<!--Can't find substitution for tag [defaultAdStart]-->

          <div class="date-outer">
        

          <div class="date-posts">
        
<div class='post-outer blog-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhg3s3hYeUw6wZKwmtJ6ZhvxxsBXQ6Y4Sn51fK9cgofB8AJGWKCJJuKbxmGHlBWFRu2nkkaUifMKCDEFGHUYEEa-fMgavskBi94jpSv8lp194wrbgrjjV09R0dO8zOM1yQNOHisRTDhEeo/s1600/Timeline.png' itemprop='image_url'/>
<meta content='7345515085838422799' itemprop='blogId'/>
<meta content='2605495890058237459' itemprop='postId'/>
<a name='2605495890058237459'></a>
<div class='post-header-line-0'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/02091583469404483428' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/02091583469404483428' rel='author' title='author profile'>
<span itemprop='name'>BAE Systems Applied Intelligence</span>
</a>
</span>
</span>
<span class='date-footer'>- Monday, 16 October 2017</span>
</div>
<h3 class='post-title entry-title' itemprop='name'>
Taiwan Heist: Lazarus Tools and Ransomware
</h3>
<div class='post-header'>
<div class='post-header-line-1'>
</div>
</div>
<div class='post-body entry-content' id='post-body-2605495890058237459' itemprop='articleBody'>
<em>Written by Sergei Shevchenko, Hirman Muhammad bin Abu Bakar, and James Wong</em><br />
<h5 style="font-size: 20px; margin-bottom: 0px;">
BACKGROUND</h5>
<br />
Reports emerged just over a week ago of a new cyber-enabled bank heist in Asia. Attackers targeting Far Eastern International Bank (FEIB), a commercial firm in Taiwan, moved funds from its accounts to multiple overseas beneficiaries. In a story which reminds us of the Bangladesh Bank case &#8211; the culprits had compromised the bank&#8217;s system connected to the SWIFT network and used this to perform the transfers.
<br />
<br />
In recent days, various malware samples have been uploaded to malware repositories which appear to originate from the intrusion. These include both known Lazarus group tools, as well as a rare ransomware variant called &#8216;Hermes&#8217; which may have been used as a distraction or cover-up for the security team whilst the heist was occurring.
<br />
<br />
The timeline below provides an overview of the key events: 
<br />
<br />
<div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhg3s3hYeUw6wZKwmtJ6ZhvxxsBXQ6Y4Sn51fK9cgofB8AJGWKCJJuKbxmGHlBWFRu2nkkaUifMKCDEFGHUYEEa-fMgavskBi94jpSv8lp194wrbgrjjV09R0dO8zOM1yQNOHisRTDhEeo/s1600/Timeline.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="272" data-original-width="925" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhg3s3hYeUw6wZKwmtJ6ZhvxxsBXQ6Y4Sn51fK9cgofB8AJGWKCJJuKbxmGHlBWFRu2nkkaUifMKCDEFGHUYEEa-fMgavskBi94jpSv8lp194wrbgrjjV09R0dO8zOM1yQNOHisRTDhEeo/s1600/Timeline.png" /></a></div>
Little information is available at present about when or how the attackers compromised the bank, but it is likely more details will emerge in the coming weeks. This blogpost seeks to summarise what is in the public domain at the  moment, as well as analyse the samples uploaded to malware repositories.
<br />
<h5 style="font-size: 20px;">
ANALYSIS</h5>
<br />
Several files have been uploaded to malware databases which appear to be related to this attack, including an archive titled &#8220;FEIB_Samples&#8221; submitted from Taiwan on 12<span style="font-size: 80%; position: relative; top: -0.5em;">th</span> Oct 2017. These and other samples are listed below:
<br />
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;"><tbody>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">#</td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">MD5 </td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Filenames </td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Submitted From</td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">First Seen </td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Compile Time</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">1 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>9563e2f443c3b4e1b00f25be0a30d56e</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>FEIB_Samples_pwd(Virus).zi_</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">TW </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-10-12 02:50:16 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">N/A</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>d08f1211fe0138134e822e31a47ec5d4</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>bitsran.exe</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">TW </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-10-03 01:01:31 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-10-01 15:37:31</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">3 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>b27881f59c8d8cc529fa80a58709db36</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>RSW7B37.tmp</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">- </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-10-03 01:01:37 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-10-01 11:34:07</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">4 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>3c9e71400b72cc0213c9c3e4ab4df9df</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>msmpeng.exe</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">US </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-10-07 08:58:00 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-02-20 11:09:30</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">5 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>0edbad9e6041d43f97c7369439a40138</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>FileTokenBroker.dll</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">TW </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-10-12 02:50:15</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-01-05 01:11:33</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">6 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>97aaf130cfa251e5207ea74b2558293d</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>splwow32.exe</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">TW </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-10-12 02:50:15</td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-02-20 11:09:30</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">7 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>62217af0299d6e241778adb849fd2823</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">N/A </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">GB </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-10-08 03:32:47 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-09-21 09:27:43</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">8 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>0dd7da89b7d1fe97e669f8b4156067c8</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">N/A </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">MY </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-03-14 02:13:01 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-03-06 17:32:58</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">9 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>61075faba222f97d3367866793f0907b</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">N/A </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">MY </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-02-16 03:25:00 </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">2017-02-10 15:03:30</td>
</tr>
</tbody></table>
</div>
<br />
File #1 is the ZIP file containing samples #2-6 inside. Samples #2-4 were also separately uploaded by users in Taiwan and the US on the dates given above.
<br />
<br />
Samples #7-9 are older versions of the Hermes ransomware.
<br />
<h5 style="font-size: 20px;">
Malware Analysis &#8211; Sample #2; Bitsran loader / spreader</h5>
<br />
Sample #2 is designed to run and spread a malicious payload on the victim's network. On execution, the malware places a copy of itself into the location:
<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>C:\Windows\Temp\bitsran.exe</code></div>
</div>
<br />
Next, the file establishes a persistence mechanism with the registry key:
<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run</code></div>
</div>
<br />
It sets the value of <code>&#8216;BITSRAN&#8217;</code> to point to the executable in the <code>Temp</code> location above.
<br />
<br />
The malware then enumerates all processes, searching for specific anti-virus processes and attempts to kill these using the command line tool <code>taskkill</code>.
<br />
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;"><tbody>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Process Name </td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Process Description</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>tmbmsrv.exe</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Trend Micro Unauthorized Change Prevention Service</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>tmccsf.exe</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Trend Micro OfficeScan Common Client Solution Framework</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>cntaosmgr.exe</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Trend Micro OfficeScan Add-on Service Client Management Service</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>ntrtscan.exe</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Trend Micro OfficeScan NT RealTime Scan</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>pccntmon.exe</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Trend Micro OfficeScan Antivirus real-time scan monitor</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>tmlisten.exe</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Trend Micro OfficeScan NT Listener</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>tmpfw.exe</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Trend Micro OfficeScan NT Firewall</td>
</tr>
</tbody></table>
</div>
<br />
Next, the process attempts to find an embedded <code>&#8216;IMAGE&#8217;</code> resource with offset <code>#110</code>. If successful, this file is loaded into memory. When manually extracting this file, it can be seen to represent a pixelated bitmap (BMP) file. 

<br />
<br />
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj65vBw02EAnzlP-2cPyBwA_ePI2OARVUeqQ2OAUuqK5m7lm_y-uSUi0U_zOelVGyUIzJZHVZ2K8FliuqK4Lu-mGdoEUGdo5t0Nob8M4rdf4G0XtHcI_CeV8Z2ehIkhe_wwIhQ0P0YFzQQ/s1600/pix.png" imageanchor="1"><img border="0" data-original-height="379" data-original-width="440" height="276" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj65vBw02EAnzlP-2cPyBwA_ePI2OARVUeqQ2OAUuqK5m7lm_y-uSUi0U_zOelVGyUIzJZHVZ2K8FliuqK4Lu-mGdoEUGdo5t0Nob8M4rdf4G0XtHcI_CeV8Z2ehIkhe_wwIhQ0P0YFzQQ/s320/pix.png" width="320" /></a>

<br />
<br />
However, further investigation reveals that the file is what is known as a &#8216;Polyglot&#8217; file, whereby a file is contained within another file. Using a HEX viewer, it is possible to see that this file also contains a ZIP file (beginning at the &#8216;PK&#8217; header), with the pixelated image above referencing the bytes of the file to be RGB values.

<br />
<br />
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjdab-0xo3pHm2mP6TU_8J_Ek2aGn8lPfJ2KCsCxhb9OBXxLBBF0hhyVrXq4omP4HStOUOcO2BtR2t5AGeaq-z5GK8COSZD7m1NVJwCu2hVVdny3FDyipcW9hVRAWf1beDdC2QYqCL1dtU/s1600/bmp.png" imageanchor="1"><img border="0" data-original-height="265" data-original-width="626" height="271" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjdab-0xo3pHm2mP6TU_8J_Ek2aGn8lPfJ2KCsCxhb9OBXxLBBF0hhyVrXq4omP4HStOUOcO2BtR2t5AGeaq-z5GK8COSZD7m1NVJwCu2hVVdny3FDyipcW9hVRAWf1beDdC2QYqCL1dtU/s640/bmp.png" width="640" /></a>


<br />
<br />
The contents of this resource is decompressed from offset 54, with the last 4 bytes of the file specifying the ZIP&#8217;s file size in bytes. When successfully decrypted, the file is saved into the same directory as the initial executable. This takes the filename <code>&#8216;RSWXXXX.tmp&#8217;</code>, where <code>&#8216;XXXX&#8217;</code> is randomly generated through the GetTempFileName function. Once written to disk, this process is created through the CreateProcess function. Sample #3 (<code>RSW7B37.tmp</code>) is an example of this file.
<br />
<br />
Whilst this additional payload is executing, the initial malware attempts to copy itself to other devices on the network. Two user accounts are hardcoded into the malware, and are used to establish connections to the <code>C$</code> SMB shares on Windows devices. These are the accounts: 
<br />
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;"><tbody>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Account Name </td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Account Password</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>FEIB\SPUSER14</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>#ED{REMOVED}</code></td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>FEIB\scomadmin</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>!it{REMOVED}</code></td>
</tr>
</tbody></table>
</div>
<br />
Both accounts clearly relate to FEIB, though we couldn&#8217;t confirm whether the credentials are valid or not. The <code>SPUSER14</code> may be a Sharepoint user account whilst <code>scomadmin</code> likely corresponds to System Center Operations Manager admin &#8211; an account for managing machines in a data centre.
<br />
<br />
Instead of enumerating all devices on the network, the malware iterates through a hardcoded list of 5357 IP addresses, in the ranges:
<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>
</code>
<br />
<ul><code>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;10.49.*</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;10.50.*</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;10.51.*</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;10.59.*</li>
</code></ul>
<code>
</code></div>
</div>
<br />
It is assumed that previous reconnaissance was conducted by the actors on the internal network to identify active and responding devices, as well as capturing admin credentials for the network.
<br />
<br />
If a device successfully responds to a SMB packet on port 445, the malware copies itself to the <code>C$</code> network share using the provided credentials, writing the file to the location:
<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>C:\Windows\Temp\bitsran.exe</code></div>
</div>
<br />
If successful, a further command is executed using the same credentials, to create a scheduled task on the remote device with the name &#8216;BITSRAN&#8217;. The full command executed is:
<br />
<br />
<div style="background: #3d4146; color: white; padding: 5pt; text-align: left;">
<code>cmd.exe /c schtasks /create /tn &#8220;BITSRAN&#8221; /tr <filepath> /s <devicename> /u <username> /p <password> /st 00:00 /et 23:59 /sc minute /mo 1 /ru system /f</password></username></devicename></filepath></code></div>
<br />
<h5 style="font-size: 20px;">
Malware Analysis &#8211; Sample #3, Dropped file / Hermes Ransomware</h5>
<br />
The dropped file is a variant of the Hermes ransomware.
<br />
<br />
The ransomware calls <em>GetSystemDefaultLangID()</em> to obtain language identifier for the system locale. It contains a list of three system language codes: <code>0x0419</code> (Russian), <code>0x0422</code> (Ukrainian), and <code>0x0423</code> (Belarusian). However, it only checks against the last two, and, if matching, the malware quits. Whether this is a false-flag or not is unknown. 
<br />
<br />
The ransomware deletes the Volume Shadow Copies (a type of backup on Windows), using command:
<br />
<br />
<div style="background: #3d4146; color: white; padding: 5pt; text-align: left;">
<code>vssadmin Delete Shadows /all /quiet</code></div>
<br />
Following that, it deletes all VSS (Volume Shadow Copy Service) backup files (which include System Restore files) and orphaned shadows, by running commands below for the drives from <code>C:</code>, <code>D:</code>, <code>E:</code>, <code>F:</code>, <code>G:</code>, and <code>H:</code>
<br />
<br />
<div style="background: #3d4146; color: white; padding: 5pt; text-align: left;">
<code>vssadmin resize shadowstorage /for=%DRIVE% /on=%DRIVE% /maxsize=401MB
vssadmin resize shadowstorage /for=%DRIVE% /on=%DRIVE% /maxsize=unbounded</code></div>
<br />
The trick above is called <em>"pulling the carpet"</em> as it <a href="http://backupchain.com/i/how-to-delete-all-vss-shadows-and-orphaned-shadows" target="_blank">forces</a> Windows to voluntarily dump all shadows due to lack of space.
<br />
<br />
The ransomware then recursively deletes all backup files from the drives <code>C:</code>, <code>D:</code>, <code>E:</code>, <code>F:</code>, <code>G:</code>, and <code>H:</code>, having the following
extensions:<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code></code><br />
<ul><code>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;*.VHD</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;*.bac</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;*.bak</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;*.wbcat</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;*.bkf</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;Backup*.*</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;backup*.*</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;*.set</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;*.win</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;*.dsk</li>
</code></ul>
</div>
</div>
<br />
Using Windows CryptoAPI platform, the malware creates an exchange key pair, and then exports the 2,048-bit public RSA key into an external file called <code>PUBLIC</code>.
<br />
<br />
The ransomware then enumerates both local and network resources, and encrypts files using AES256 algorithm.
<br />
<br />
Each encrypted directory will have a ransom note left in it:
<br />
<br />
<div style="background: #3d4146; color: white; padding: 5pt; text-align: left;">
<code>HERMES 2.1 RANSOMWARE radical edition<br />
All your important files are encrypted<br />
Your files has been encrypted using RSA2048 algorithm with unique public-key stored on your PC.<br />
There is only one way to get your files back: contact with us, pay, and get decryptor software.<br />
You have "UNIQUE_ID_DO_NOT_REMOVE" file on your desktop also it duplicated in some folders,<br />
its your unique idkey, attach it to letter when contact with us. Also you can decrypt 3 files for test.<br />
We accept Bitcoin, you can find exchangers on https://www.bitcoin.com/buy-bitcoin and others.<br />
Contact information: BM-2cVcZL1xfve1yGGKwEBgG1ge6xJ5PYGfGw@bitmessage.ch<br />
reserve: BM-2cT4U1vBdjfqKDeWMEXgCWs9SfnMK1GLTF@bitmessage.ch</code></div>
<br />
<h5 style="font-size: 20px;">
Malware Analysis &#8211; Samples #4 and #6, Lazarus malware</h5>
<br />
Sample #4 (<code>msmpeng.exe</code>) is packed with Themida to hamper analysis under a debugger, a monitoring application, or a virtual machine.
<br />
<br />
Once fully unpacked in memory, it appears to be an x86 variant of the <code>fdsvc.dll</code> backdoor described in our February <a href="http://baesystemsai.blogspot.com/2017/02/lazarus-false-flag-malware.html" target="_blank">blogpost</a> &#8220;Lazarus&#8217; False Flag Malware&#8221;. This malware was discovered on networks in Poland and Mexico, following a series of watering-hole attacks.
<br />
<br />
Just like before, the backdoor uses several transliterated Russian words to either indicate the state of its communication or issue backdoor commands:
<br />
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;"><tbody>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">State/Command </td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Translation from Russian </td>
<td style="background: #3d4146; border-left: none; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">Meaning</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>Nachalo</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">beginning </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">start communication session</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>ustanavlivat</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">to set </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">handshake state</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>poluchit</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">to receive </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">receive data</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>pereslat</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">to send </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">send data</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>derzhat</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">to maintain </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">maintain communication session</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>vykhodit</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">to exit </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">exit communication session</td>
</tr>
<tr>
<td style="border-top: none; border: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>kliyent2podklyuchit</code> </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">client to connect </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">client is ready to connect </td>
</tr>
</tbody></table>
</div>
<br />
Sample #6 (<code>splwow32.exe</code>) is the same backdoor, only it&#8217;s not packed.
<br />
<br />
Both sample #4 and #6 have the same time stamp: 20 February 2017, 11:09:30. It appears that sample #6 was actually obtained by packing sample #4 with Themida (potentially, to avoid detection), as code/data found in both
samples is identical.
<br />
<br />
The backdoor expects a command line parameter that specifies remote C&amp;C address and port number. If it is executed
with no command-line parameters, it quits.
<br />
<br />
The specified command-line parameter is decrypted, using some basic character manipulations and applying XOR with 2
keys:
<br />
<br />
<div style="background: #3d4146; color: white; padding: 5pt; text-align: left;">
<code><code>0x517A4563</code> (<code>&#8220;QzEc&#8221;</code>)<br /><code>0x77506F66</code> (<code>&#8220;wPof&#8221;</code>)</code></div>
<br />
The decrypted string is expected to delimit C&amp;C address and port number with the <code>&#8220;:&#8221;</code> character. Multiple C&amp;Cs can be delimited with the <code>&#8220;|&#8221;</code> character.
<br />
<br />
If the backdoor finds no valid pair of C&amp;C address and port number delimited with the <code>&#8220;:&#8221;</code> character, it quits.
<br />
<br />
Otherwise, it starts polling the remote C&amp;C for a remote task to execute. Each polling attempt starts from a state <code>&#8220;Nachalo&#8221;</code> (&#8220;start communication session&#8221;), with a 3 second delay between each attempt to connect to the C&amp;C.
<br />
<br />
Each connection attempt starts from a state called <code>&#8220;kliyent2podklyuchit&#8221;</code> (&#8220;client is ready to connect&#8221;).
<br />
<br />
If the backdoor fails to connect five times, or if it connects, but the task it receives is <code>&#8220;vykhodit&#8221;</code> (&#8220;exit communication session&#8221;), then the backdoor will quit. Otherwise, it will execute the remote command, effectively giving the attackers full control over the compromised system. After the execution, the polling cycle continues. 
<br />
<h5 style="font-size: 20px;">
Malware Analysis &#8211; Sample #5</h5>
<br />
<code>FileTokenBroker.dll</code> is a DLL, installed as a service under the <code>svchost.exe</code> (<code>netsvcs</code>) service host.
<br />
<br />
Once loaded as a service DLL, the DLL's export <em>ServiceMain()</em> is called. The DLL then constructs a file name that consists of the host process name, formatted as:
<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>%SYSTEM%\en-US\[HOST_PROCESS_NAME_NO_EXTENSION].dll.mui </code></div>
</div>
<br />
For example, if the DLL is loaded into the address space of <code>svchost.exe</code>, the constructed filename will be:
<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>c:\windows\system32\en-US\svchost.dll.mui</code></div>
</div>
<br />
Another possible name is:
<br />
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code>c:\windows\system32\en-US\netsvc.dll.mui</code></div>
</div>
<br />
The DLL then reads this file, and decrypts it with a running XOR mask. Once decrypted, it further reads an RC4 key from it, and decrypts it with the RC4 algorithm.
<br />
<br />
The decrypted file will contain a hash, so the DLL checks the hash as well to make sure the integrity of the decrypted file is intact.
<br />
<br />
A fully decrypted file is then parsed as a PE file, and loaded as a DLL.
<br />
<br />
Hence, <code>FileTokenBroker.dll</code> decrypts and executes a payload that is created by an external dropper or is implanted by the attackers.
<br />
<br />
The <code>%SYSTEM%\en-US</code> directory will have multiple system files in it, so it is chosen to blend the encrypted payload file with the other legitimate system files. Unlike other <code>*.dll.mui</code> files in <code>%SYSTEM%\en-US</code> directory that are MZ files, the encrypted payload is not an MZ file.
<br />
<h5 style="font-size: 20px;">
Malware Analysis &#8211; Samples #7, #8, and #9, Further Hermes malware</h5>
<br />
Samples #7, #8, and #9 relate to previous instances of Hermes ransomware.
<br />
<br />
Malware of this category is typically widespread, but in the case of Hermes it seems relatively rare. This is suspicious in itself and reminds us of WannaCry &#8211; another rarely observed ransomware. Further analysis is on-going to understand the history of this malware variant. 
<br />
<h5 style="font-size: 20px;">
Transactions</h5>
<br />
Through working with trusted partners, we have been able to get insight into the transactions made as part of the heist. The transactions consisted of two common SWIFT message types, <code><strong>MT103</strong></code> and <code><strong>MT202COV</strong></code>.
<br />
<br />
<code><strong>MT103</strong></code> messages are used for normal, cross border, cash transfers which would typically request funds be transferred into a personal or company beneficiary account. <code><strong>MT103</strong></code> messages can be used on their own, or can be coupled with a cover message; <code><strong>MT202COV</strong></code> is used to order the movement of funds to the beneficiary institution via another financial institution/Intermediary Bank.
<br />
<br />
In this heist the attackers created <code><strong>MT103</strong></code> messages to transfer funds to Cambodia, the US, and Sri Lanka. In addition to the <code><strong>MT103</strong></code> messages, the attackers created <code><strong>MT202COV</strong></code> messages; the content of these messages was syntactically correct but the values in specific fields were wrong. As a result, they were received by the intermediary bank but had no further influence on the funds transferred to the beneficiary accounts.
<br />
<br />
Reports of $60M being stolen appear to be due to confusion over these latter messages, and the amounts actually stolen were considerably lower. Most of these appear to have been recovered.
<br />
<br />
Further details of the destination accounts within Sri Lanka have emerged in open source. The money had been transferred to the Bank of Ceylon in Sri Lanka on 3 October. The following day, an individual in Sri Lanka allegedly <a href="https://visitsrilanka.com/news/hack-on-taiwanese-bank-sri-lankan-suspect-arrested-another-in-hiding-newsfirst/" target="_blank">withdrew</a> RS 30m (about $195K). Two days after that, the same individual returned to withdraw a further RS 8m, but was arrested when he arrived at the bank. Sri Lankan police have since arrested another individual and a further suspect is wanted by Sri Lankan law enforcement.
<br />
<h5 style="font-size: 20px;">
CONCLUSIONS</h5>
<br />
It has been over a year since the last activity on a payments system from the attackers behind the infamous Bangladesh Bank heist. Lazarus, the prime suspects, have been busy nonetheless &#8211; targeting Bitcoin in various ways, as well as other intrusions into banks such as in Poland and Mexico (albeit without evidence of targeting payment systems). In one of these cases we and other <a href="https://securelist.com/lazarus-under-the-hood/77908/" target="_blank">researchers</a> were able to observe infrastructure in North Korea controlling the malware &#8211; further clues as to the origins of these attackers.
<br />
<br />
The attack this month on Taiwanese Far Eastern International Bank has some of the hallmarks of the Lazarus group:
<br />
<br />
<ul>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;Destination beneficiary accounts in Sri Lanka and Cambodia &#8211; both countries have been used previously as destinations for Lazarus&#8217; bank heist activity;</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;
Use of malware previously seen in Lazarus&#8217; Poland and Mexico bank attacks. Where these files were found and the context of their use needs to be confirmed, but could provide a crucial attributive link;</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;
Use of unusual ransomware, potentially as a distraction.</li>
</ul>
<br />
Despite their continued success in getting onto payment systems in banks, the Lazarus group still struggle getting the cash in the end, with payments being reversed soon after the attacks are uncovered. The group may be trying new tricks to disrupt victims and delay their ability to respond &#8211; such as different message formats, and the deployment of ransomware across the victim&#8217;s network as a smokescreen for their other activity. It&#8217;s likely they&#8217;ll continue their heist attempts against banks in the coming months and we expect they will evolve their modus operandi to incorporate new ways of disrupting victims (and possibly the wider community) from responding.
<br />
<br />
More work needs to be done to identify how FEIB was attacked, whether further custom tools were involved, confirm the context of the Lazarus malware in the intrusion, and where else this Hermes ransomware has been seen.
<br />
<br />
Assuming Lazarus are indeed back to targeting bank payment systems, this will serve to emphasize the importance of network hardening and controls frameworks being pushed by the <a href="https://www.swift.com/myswift/customer-security-programme-csp" target="_blank">industry</a> at present. 
<br />
<h5 style="font-size: 20px;">
RECOMMENDATIONS</h5>
<br />
Some general network hardening and monitoring lessons can be taken from this:
<br />
<br />
<ul>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;Firewall off SMB (445) for internal computers. If access to this service is required, it should be permitted only for those IP&#8217;s that require access. i.e. 445 is required for SCOM to push an agent install, therefore 445 should only be allowed from that source server;</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;
Application blacklisting should be implemented to prevent the use of tools such as <code>vssadmin.exe</code>, <code>cmd.exe</code>, <code>powershell.exe</code> and similar;</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;
File Integrity Monitoring should be considered and configured to monitor file creations in &#8220;trusted&#8221; locations such as the System32 directory. This can also be used to monitor deletes, with an alert configured to fire on excessive deletes in a row;</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;
Windows Security Event logs should be monitored to capture Scheduled Task creation events &#8211; Event ID <code>4698</code>;</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;
Registry Auditing should be enabled and monitored to capture any additions to<br /><code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run</code>;</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;
Excessive use of known administrative privilege accounts should be alerted on &#8211; specifically in a &#8220;one to many&#8221; behavioural configuration. i.e. is one specific IP connecting to a large number of devices using the same credentials in a short period of time;</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;
Ensure privileged accounts have a complex password that does not include any part of the username, or application it relates to.</li>
</ul>
<br />
Additional longer term recommendations for financial institutions:
<br />
<br />
<ul>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;Practice incident response scenarios which include complex attacks combining covert payment fraud and overt network disruption through ransomware, DDoS, network downtime, etc.</li>
<li style="list-style-type: none; text-align: left;">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;
Ensure that you are progressing towards being able to attest against the SWIFT 27 controls. 
<br />
For more information see:
<br />
http://www.baesystems.com/en/cybersecurity/swift-customer-security-programme</li>
</ul>
<br />
<h5 style="font-size: 20px;">
APPENDIX A &#8211; INDICATORS OF ATTACK </h5>
<br />
<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border: none; width: 100%px;"><tbody>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">MD5 Hashes </td>
<td style="border-bottom: none; border-left: none; border-right: solid #3d4146 1.0pt; border-top: solid #3d4146 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>d08f1211fe0138134e822e31a47ec5d4</code></td>
</tr>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"></td>
<td style="border-bottom: none; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>b27881f59c8d8cc529fa80a58709db36</code></td>
</tr>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"></td>
<td style="border-bottom: none; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>3c9e71400b72cc0213c9c3e4ab4df9df</code></td>
</tr>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"></td>
<td style="border-bottom: none; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>0edbad9e6041d43f97c7369439a40138</code></td>
</tr>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"></td>
<td style="border-bottom: none; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>97aaf130cfa251e5207ea74b2558293d</code></td>
</tr>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"></td>
<td style="border-bottom: none; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>62217af0299d6e241778adb849fd2823</code></td>
</tr>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"></td>
<td style="border-bottom: none; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>0dd7da89b7d1fe97e669f8b4156067c8</code></td>
</tr>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"></td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>61075faba222f97d3367866793f0907b</code></td>
</tr>
<tr>
<td style="background: #3d4146; border: solid #3d4146 1.0pt; color: white; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle">File / Process name  </td>
<td style="border-bottom: solid #3d4146 1.0pt; border-left: none; border-right: solid #3d4146 1.0pt; border-top: none; padding: 0cm 5.4pt 0cm 5.4pt; vertical-align: middle;" valign="middle"><code>bitsran.exe</code> </td>
</tr>
</tbody></table>
</div>
<br />
<h5 style="font-size: 20px;">
APPENDIX B &#8211; YARA RULE </h5>
<br />
<div style="background: #f2f2f2; border: solid #a6a6a6 1.0pt; padding: 2pt; text-align: left;">
<div style="background: #f2f2f2; margin-left: 5px;">
<code><strong>rule Hermes2_1</strong> {<br />
&nbsp;&nbsp;&nbsp;<strong>meta:</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date&nbsp;=&nbsp;<span style="color: #880000;">"2017/10/11"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;author&nbsp;=&nbsp;<span style="color: #880000;">"BAE"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hash&nbsp;=&nbsp;<span style="color: #880000;">"b27881f59c8d8cc529fa80a58709db36"</span><br />
&nbsp;&nbsp;&nbsp;<strong>strings:</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$magic&nbsp;=&nbsp;{&nbsp;4D&nbsp;5A&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008800;">//in&nbsp;both&nbsp;version&nbsp;2.1&nbsp;and&nbsp;sample&nbsp;in&nbsp;Feb</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s1&nbsp;=&nbsp;<span style="color: #880000;">"SYSTEM\\CurrentControlSet\\Control\\Nls\\Language\\"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s2&nbsp;=&nbsp;<span style="color: #880000;">"0419"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s3&nbsp;=&nbsp;<span style="color: #880000;">"0422"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s4&nbsp;=&nbsp;<span style="color: #880000;">"0423"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008800;">//in&nbsp;version&nbsp;2.1&nbsp;only</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$S1&nbsp;=&nbsp;<span style="color: #880000;">"HERMES"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$S2&nbsp;=&nbsp;<span style="color: #880000;">"vssadminn"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$S3&nbsp;=&nbsp;<span style="color: #880000;">"finish&nbsp;work"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$S4&nbsp;=&nbsp;<span style="color: #880000;">"testlib.dll"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$S5&nbsp;=&nbsp;<span style="color: #880000;">"shadowstorageiet"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008800;">//maybe&nbsp;unique&nbsp;in&nbsp;the&nbsp;file</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$u1&nbsp;=&nbsp;<span style="color: #880000;">"ALKnvfoi4tbmiom3t40iomfr0i3t4jmvri3tb4mvi3btv3rgt4t777"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$u2&nbsp;=&nbsp;<span style="color: #880000;">"HERMES&nbsp;2.1&nbsp;TEST&nbsp;BUILD,&nbsp;press&nbsp;ok"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$u3&nbsp;=&nbsp;<span style="color: #880000;">"hnKwtMcOadHwnXutKHqPvpgfysFXfAFTcaDHNdCnktA"</span>&nbsp;<span style="color: #008800;">//RSA&nbsp;Key&nbsp;part</span><br />
&nbsp;&nbsp;&nbsp;<strong>condition:</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$magic&nbsp;at&nbsp;0&nbsp;and&nbsp;all&nbsp;of&nbsp;($s*)&nbsp;and&nbsp;3&nbsp;of&nbsp;($S*)&nbsp;and&nbsp;1&nbsp;of&nbsp;($u*)<br />
}</code></div>
</div>
<br />
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-timestamp'>
at
<meta content='https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html' itemprop='url'/>
<a class='timestamp-link' href='https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2017-10-16T22:32:00+01:00'>22:32</abbr></a>
</span>
<span class='reaction-buttons'>
</span>
<span class='star-ratings'>
</span>
<span class='post-comment-link'>
</span>
<span class='post-backlinks post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-1242271774'>
<a href='https://www.blogger.com/post-edit.g?blogID=7345515085838422799&postID=2605495890058237459&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Labels:
<a href='https://baesystemsai.blogspot.com/search/label/Threat%20Research' rel='tag'>Threat Research</a>
</span>
<br/><span class='post-location'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=7345515085838422799&postID=2605495890058237459&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=7345515085838422799&postID=2605495890058237459&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=7345515085838422799&postID=2605495890058237459&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=7345515085838422799&postID=2605495890058237459&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a>
</div>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>No comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
</dl>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<h4 id='comment-post-message'>Post a Comment</h4>
<p>
</p>
<a href='https://www.blogger.com/comment/frame/7345515085838422799?po=2605495890058237459&hl=en-GB' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<!--Can't find substitution for tag [post.friendConnectJs]-->
<script src='https://www.blogger.com/static/v1/jsbin/681870030-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html', '0');
    </script>
</div>
</p>
</div>
</div>

        </div></div>
      
<!--Can't find substitution for tag [adEnd]-->
</div>
<div class='blog-pager' id='blog-pager'>
<a class='home-link' href='https://baesystemsai.blogspot.com/'>Home</a>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://baesystemsai.blogspot.com/2017/05/wanacrypt0r-ransomworm.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://baesystemsai.blogspot.com/feeds/2605495890058237459/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
<div class='sidebar-wrapper right'>
<div class='sidebar section' id='sidebar'><div class='widget HTML' data-version='1' id='HTML2'>
<h2 class='title'>SUBSCRIBE</h2>
<div class='widget-content'>
<p>Sign up to receive our regular Cyber Threat Bulletin.</p>
<div class="contact-info">
<a href=" http://www.baesystems.com/en/cybersecurity/cyber-threat-bulletin" class="contact-btn">Sign up</a>
</div>
</div>
<div class='clear'></div>
</div><div class='widget PopularPosts' data-version='1' id='PopularPosts1'>
<h2>Popular Posts</h2>
<div class='widget-content popular-posts'>
<ul>
<li>
<div class='item-thumbnail-only'>
<div class='item-thumbnail'>
<a href='https://baesystemsai.blogspot.com/2016/04/two-bytes-to-951m.html' target='_blank'>
<img alt='' border='0' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjedDchK2wsPRnYQ1N8_5fdhoN-gdAZYZgbu44hlHT97ZOw2l9IAWy0bcCpMdf59VvZyfSzQqO4v0Ctlk577QbQdkLDn69ncxK2_h8HDPWxY3zOwvu54D10KvDy_3PAdREEf3dF6lZpiUfZ/w72-h72-p-k-no-nu/scheme1.png'/>
</a>
</div>
<div class='item-title'><a href='https://baesystemsai.blogspot.com/2016/04/two-bytes-to-951m.html'>Two bytes to $951m</a></div>
</div>
<div style='clear: both;'></div>
</li>
<li>
<div class='item-thumbnail-only'>
<div class='item-thumbnail'>
<a href='https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html' target='_blank'>
<img alt='' border='0' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhg3s3hYeUw6wZKwmtJ6ZhvxxsBXQ6Y4Sn51fK9cgofB8AJGWKCJJuKbxmGHlBWFRu2nkkaUifMKCDEFGHUYEEa-fMgavskBi94jpSv8lp194wrbgrjjV09R0dO8zOM1yQNOHisRTDhEeo/w72-h72-p-k-no-nu/Timeline.png'/>
</a>
</div>
<div class='item-title'><a href='https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html'>Taiwan Heist: Lazarus Tools and Ransomware</a></div>
</div>
<div style='clear: both;'></div>
</li>
<li>
<div class='item-thumbnail-only'>
<div class='item-thumbnail'>
<a href='https://baesystemsai.blogspot.com/2017/02/lazarus-watering-hole-attacks.html' target='_blank'>
<img alt='' border='0' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMzqY9AP7r9TMBFOe-a4OisTN9oIrJk-EpP7MHQSKmSY1CJocMvBWe3XcyocODheWR8bX3_AMIDC3jreQ16j-rvMQI0WFfCB0Ps6UjrZ56p7vYbUoShsHWUqnrYlWqbivMU0wGBTFF0M8/w72-h72-p-k-no-nu/Lazarus_and_watering_hole_attacks_one.png'/>
</a>
</div>
<div class='item-title'><a href='https://baesystemsai.blogspot.com/2017/02/lazarus-watering-hole-attacks.html'>Lazarus & Watering-hole attacks</a></div>
</div>
<div style='clear: both;'></div>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget HTML' data-version='1' id='HTML1'>
<h2 class='title'>Contact</h2>
<div class='widget-content'>
<p>For further information or to talk to an expert, please contact us.</p>
<div class="contact-info">
<a href="mailto:learn@baesystems.com">learn@baesystems.com</a>
<br/><br/><br/>
<a href="http://www.baesystems.com/en/cybersecurity/contact-us " class="contact-btn">Contact</a>
</div>
</div>
<div class='clear'></div>
</div></div>
</div>
<div class='clear'></div>
</div><!-- END ContentWrapper -->
</div>
<footer>
<nav>
<div class='wrap'>
<div class='footerWrapper'>
<ul class='social-icon-list'>
<li class='twitter-icon'>
<a href='https://twitter.com/baesystems_ai'></a>
</li>
<li class='fb-icon'>
<a href='https://facebook.com/baesystemsappliedintelligence'></a>
</li>
<li class='in-icon'>
<a href='https://linkedin.com/company/baesystemsai'></a>
</li>
<li class='flickr-icon'>
<a href='https://flickr.com/photos/bae_systemsplc'></a>
</li>
<li class='youtube-icon'>
<a href='https://www.youtube.com/user/BAESystemsAI'></a>
</li>
</ul>
</div>
</div>
</nav>
<div class='bottom-bar'>
<div class='wrap'>
<ul class='footerList'>
<li><a href='https://baesystems.com/page/accessibility'>Accessibility</a></li>
<li><a href='https://baesystems.com/page/terms_conditions'>Terms & conditions</a></li>
<li><a href='https://www.baesystems.com/en/bae-systems-privacy-notice'>Privacy</a></li>
<li><a href='https://baesystems.com/page/sitemap'>Sitemap</a></li>
</ul>
<p class='copyright'>&#169; 2015 BAE Systems. All rights reserved</p>
</div>
</div>
</footer>
</div>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/1812387825-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY5KAVkTbNgvceHZ7nK2740MiIpr5A:1742282820372';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d7345515085838422799','//baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html','7345515085838422799');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '7345515085838422799', 'title': 'BAE Systems Threat Research Blog', 'url': 'https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html', 'canonicalUrl': 'https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html', 'homepageUrl': 'https://baesystemsai.blogspot.com/', 'searchUrl': 'https://baesystemsai.blogspot.com/search', 'canonicalHomepageUrl': 'https://baesystemsai.blogspot.com/', 'blogspotFaviconUrl': 'https://baesystemsai.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en-GB', 'localeUnderscoreDelimited': 'en_gb', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22BAE Systems Threat Research Blog - Atom\x22 href\x3d\x22https://baesystemsai.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22BAE Systems Threat Research Blog - RSS\x22 href\x3d\x22https://baesystemsai.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22BAE Systems Threat Research Blog - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/7345515085838422799/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22BAE Systems Threat Research Blog - Atom\x22 href\x3d\x22https://baesystemsai.blogspot.com/feeds/2605495890058237459/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/459db401c2dc748e', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en_GB\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': true, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '2605495890058237459', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhg3s3hYeUw6wZKwmtJ6ZhvxxsBXQ6Y4Sn51fK9cgofB8AJGWKCJJuKbxmGHlBWFRu2nkkaUifMKCDEFGHUYEEa-fMgavskBi94jpSv8lp194wrbgrjjV09R0dO8zOM1yQNOHisRTDhEeo/s72-c/Timeline.png', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhg3s3hYeUw6wZKwmtJ6ZhvxxsBXQ6Y4Sn51fK9cgofB8AJGWKCJJuKbxmGHlBWFRu2nkkaUifMKCDEFGHUYEEa-fMgavskBi94jpSv8lp194wrbgrjjV09R0dO8zOM1yQNOHisRTDhEeo/s1600/Timeline.png', 'pageName': 'Taiwan Heist: Lazarus Tools and Ransomware', 'pageTitle': 'BAE Systems Threat Research Blog: Taiwan Heist: Lazarus Tools and Ransomware'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard', 'ok': 'Ok', 'postLink': 'Post link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Taiwan Heist: Lazarus Tools and Ransomware', 'description': 'Written by Sergei Shevchenko, Hirman Muhammad bin Abu Bakar, and James Wong   BACKGROUND   Reports emerged just over a week ago of a new cyb...', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhg3s3hYeUw6wZKwmtJ6ZhvxxsBXQ6Y4Sn51fK9cgofB8AJGWKCJJuKbxmGHlBWFRu2nkkaUifMKCDEFGHUYEEa-fMgavskBi94jpSv8lp194wrbgrjjV09R0dO8zOM1yQNOHisRTDhEeo/s1600/Timeline.png', 'url': 'https://baesystemsai.blogspot.com/2017/10/taiwan-heist-lazarus-tools.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 2605495890058237459}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'navigation', document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'isCurrentPage': false, 'href': 'https://baesystemsai.blogspot.com/', 'title': 'Home'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/products', 'title': 'Products'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/solutions', 'title': 'Solutions'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/news-and-events', 'title': 'News \x26 Events'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/partners', 'title': 'Partners'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/about-us', 'title': 'About Us'}, {'isCurrentPage': false, 'href': 'http://www.baesystems.com/en/cybersecurity/careers', 'title': 'Careers'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'navigation', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'navigation', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ImageView', new _WidgetInfo('Image1', 'tagline', document.getElementById('Image1'), {'resize': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_TextView', new _WidgetInfo('Text1', 'ban-text', document.getElementById('Text1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML3', 'grid2', document.getElementById('HTML3'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LabelView', new _WidgetInfo('Label1', 'grid3', document.getElementById('Label1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/2172000626-lbx__en_gb.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML2', 'sidebar', document.getElementById('HTML2'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PopularPostsView', new _WidgetInfo('PopularPosts1', 'sidebar', document.getElementById('PopularPosts1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'sidebar', document.getElementById('HTML1'), {}, 'displayModeFull'));
</script>
</body>
</html>