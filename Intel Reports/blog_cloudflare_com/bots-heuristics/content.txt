<!DOCTYPE html><script type="module" src="/_astro/index.astro_astro_type_script_index_0_lang.CoXd8L9s.js"></script> <html lang="en-us" dir="ltr"> <head><script async src="https://ot.www.cloudflare.com/public/vendor/onetrust/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" data-domain-script="b1e05d49-f072-4bae-9116-bdb78af15448"></script><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="KeThzeyMOr"><meta name="baidu-site-verification" content="code-NIlrS7gNhx"><meta charset="UTF-8"><meta name="description" content="By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules, deploy new releases rapidly, and give Bot Management customers the explainability and control they were asking for. "><title>Improved Bot Management flexibility and visibility with new high-precision heuristics</title><meta name="title" content="Improved Bot Management flexibility and visibility with new high-precision heuristics"><meta name="msvalidate.01" content="CF295E1604697F9CAD18B5A232E871F6"><meta class="swiftype" name="language" data-type="string" content="en"><script src="/static/z/i.js" type="text/javascript" referrerpolicy="origin"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-32x32.png"><link rel="mask-icon" href="/images/favicon-32x32.png" color="#f78100"><link rel="stylesheet" href="/themes/ashes.min.css"><link rel="sitemap" href="/sitemap.xml"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link rel="canonical" href="https://blog.cloudflare.com/bots-heuristics/"><link rel="alternate" hreflang="en-us" href="https://blog.cloudflare.com/bots-heuristics/"><!-- General Meta Tags --><meta property="article:published_time" content="2025-03-19T13:00+00:00"><meta property="article:modified_time" content="2025-03-19T13:00:03.157Z"><meta property="article:tag" content="Security Week"><meta property="article:tag" content="Bots"><meta property="article:tag" content="Bot Management"><meta property="article:tag" content="Application Security"><meta property="article:tag" content="Machine Learning"><meta property="article:tag" content="Heuristics"><meta property="article:tag" content="Edge Rules"><meta property="article:tag" content="Security"><meta property="article:publisher" content="https://www.facebook.com/cloudflare"><!-- Facebook Meta Tags --><meta property="og:site_name" content="The Cloudflare Blog"><meta property="og:type" content="article"><meta property="og:title" content="Improved Bot Management flexibility and visibility with new high-precision heuristics"><meta property="og:description" content="By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules, deploy new releases rapidly, and give Bot Management customers the explainability and control they were asking for."><meta property="og:url" content="https://blog.cloudflare.com/bots-heuristics/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="628"><!-- Twitter/X Meta Tags --><meta name="twitter:title" content="Improved Bot Management flexibility and visibility with new high-precision heuristics"><meta name="twitter:description" content="By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules, deploy new releases rapidly, and give Bot Management customers the explainability and control they were asking for."><meta name="twitter:url" content="https://blog.cloudflare.com/bots-heuristics/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label1" content="Written by"><meta name="twitter:data1" content="Curtis Lowder"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="Security Week,Bots,Bot Management,Application Security,Machine Learning,Heuristics,Edge Rules,Security"><meta name="twitter:site" content="@cloudflare"><meta property="og:image" content="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7aUOa73viLqPiL6maGTTBD/47488b4df31256d503af51b10bc3fcb2/OG_Share_2024__18_.png"><meta name="twitter:image" content="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7aUOa73viLqPiL6maGTTBD/47488b4df31256d503af51b10bc3fcb2/OG_Share_2024__18_.png"><link rel="stylesheet" href="/_astro/index.Bpd2cWaZ.css"></head><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="ZhAbXu" component-url="/_astro/GoogleAnalytics.DSjxwi8U.js" component-export="GoogleAnalytics" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;title&quot;:[0,&quot;Improved Bot Management flexibility and visibility with new high-precision heuristics&quot;],&quot;canonical&quot;:[0,&quot;https://blog.cloudflare.com/bots-heuristics&quot;],&quot;info&quot;:[0,{&quot;id&quot;:[0,&quot;4IkgXzyemEEsN7A6Cd18hb&quot;],&quot;title&quot;:[0,&quot;Improved Bot Management flexibility and visibility with new high-precision heuristics&quot;],&quot;slug&quot;:[0,&quot;bots-heuristics&quot;],&quot;excerpt&quot;:[0,&quot;By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules and deploy new releases rapidly.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Within the Cloudflare Application Security team, every &lt;a href=\&quot;https://www.cloudflare.com/learning/ai/what-is-machine-learning/\&quot;&gt;&lt;u&gt;machine learning&lt;/u&gt;&lt;/a&gt; model we use is underpinned by a rich set of static rules that serve as a ground truth and a baseline comparison for how our models are performing. These are called heuristics. Our Bot Management heuristics engine has served as an important part of eight global &lt;a href=\&quot;https://developers.cloudflare.com/bots/concepts/bot-score/#machine-learning\&quot;&gt;&lt;u&gt;machine learning (ML) models&lt;/u&gt;&lt;/a&gt;, but we needed a more expressive engine to increase our accuracy. In this post, weâll review how we solved this by moving our heuristics to the Cloudflare &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/\&quot;&gt;&lt;u&gt;Ruleset Engine&lt;/u&gt;&lt;/a&gt;. Not only did this provide the platform we needed to write more nuanced rules, it made our platform simpler and safer, and provided &lt;a href=\&quot;https://www.cloudflare.com/application-services/products/bot-management/\&quot;&gt;&lt;u&gt;Bot Management&lt;/u&gt;&lt;/a&gt; customers more flexibility and visibility into their bot traffic.Â Â Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;bot-detection-via-simple-heuristics\&quot;&gt;Bot detection via simple heuristics&lt;/h3&gt;\n            &lt;a href=\&quot;#bot-detection-via-simple-heuristics\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In Cloudflareâs bot detection, we build heuristics from attributes like software library fingerprints, HTTP request characteristics, and internal threat intelligence. Heuristics serve three separate purposes for bot detection:Â &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Bot identification: If traffic matches a heuristic, we can identify the traffic as definitely automated traffic (with a &lt;a href=\&quot;https://developers.cloudflare.com/bots/concepts/bot-score/\&quot;&gt;&lt;u&gt;bot score&lt;/u&gt;&lt;/a&gt; of 1) without the need of a machine learning model.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Train ML models: When traffic matches our heuristics, we create labelled datasets of bot traffic to train new models. Weâll use many different sources of labelled bot traffic to train a new model, but our heuristics datasets are one of the highest confidence datasets available to us.Â Â Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Validate models: We benchmark any new model candidateâs performance against our heuristic detections (among many other checks) to make sure it meets a required level of accuracy.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;While the existing heuristics engine has worked very well for us, as bots evolved we needed the flexibility to write increasingly complex rules. Unfortunately, such rules were not easily supported in the old engine. Customers have also been asking for more details about which specific heuristic caught a request, and for the flexibility to enforce different policies per heuristic ID.Â  We found that by building a new heuristics framework integrated into the Cloudflare Ruleset Engine, we could build a more flexible system to write rules and give Bot Management customers the granular explainability and control they were asking for.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-need-for-more-efficient-precise-rules\&quot;&gt;The need for more efficient, precise rules&lt;/h3&gt;\n            &lt;a href=\&quot;#the-need-for-more-efficient-precise-rules\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In our previous heuristics engine, we wrote rules in &lt;a href=\&quot;https://www.lua.org/\&quot;&gt;&lt;u&gt;Lua&lt;/u&gt;&lt;/a&gt; as part of our &lt;a href=\&quot;https://openresty.org/\&quot;&gt;&lt;u&gt;openresty&lt;/u&gt;&lt;/a&gt;-based reverse proxy. The Lua-based engine was limited to a very small number of characteristics in a rule because of the high engineering cost we observed with adding more complexity.&lt;/p&gt;&lt;p&gt;With Lua, we would write fairly simple logic to match on specific characteristics of a request (i.e. user agent). Creating new heuristics of an existing class was fairly straight forward. All weâd need to do is define another instance of the existing class in our database. However, if we observed malicious traffic that required more than two characteristics (as a simple example, user-agent and &lt;a href=\&quot;https://en.wikipedia.org/wiki/Autonomous_system_(Internet)\&quot;&gt;&lt;u&gt;ASN&lt;/u&gt;&lt;/a&gt;) to identify, weâd need to create bespoke logic for detections. Because our Lua heuristics engine was bundled with the code that ran ML models and other important logic, all changes had to go through the same review and release process. If we identified malicious traffic that needed a new heuristic class, and we were also blocked by pending changes in the codebase, weâd be forced to either wait or rollback the changes. If weâre writing a new rule for an âunder attackâ scenario, every extra minute it takes to deploy a new rule can mean an unacceptable impact to our customerâs business.Â &lt;/p&gt;&lt;p&gt;More critical than time to deploy is the complexity that the heuristics engine supports. The old heuristics engine only supported using specific request attributes when creating a new rule. As bots became more sophisticated, we found we had to reject an increasing number of new heuristic candidates because we werenât able to write precise enough rules. For example, we found a &lt;a href=\&quot;https://go.dev/\&quot;&gt;&lt;u&gt;Golang&lt;/u&gt;&lt;/a&gt; TLS fingerprint frequently used by bots and by a small number of corporate VPNs. We couldnât block the bots without also stopping the legitimate VPN usage as well, because the old heuristics platform lacked the flexibility to quickly compile sufficiently nuanced rules. Luckily, we already had the perfect solution with Cloudflare Ruleset Engine.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;our-new-heuristics-engine\&quot;&gt;Our new heuristics engine&lt;/h3&gt;\n            &lt;a href=\&quot;#our-new-heuristics-engine\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The Ruleset Engine is familiar to anyone who has written a WAF rule, Load Balancing rule, or Transform rule, &lt;a href=\&quot;https://blog.cloudflare.com/announcing-firewall-rules/\&quot;&gt;&lt;u&gt;just to name a few&lt;/u&gt;&lt;/a&gt;. For Bot Management, the Wireshark-inspired syntax allows us to quickly write heuristics with much greater flexibility to vastly improve accuracy. We can write a rule in &lt;a href=\&quot;https://yaml.org/\&quot;&gt;&lt;u&gt;YAML&lt;/u&gt;&lt;/a&gt; that includes arbitrary sub-conditions and inherit the same framework the WAF team uses to both ensure any new rule undergoes a rigorous testing process with the ability to rapidly release new rules to stop attacks in real-time.Â &lt;/p&gt;&lt;p&gt;Writing heuristics on the Cloudflare Ruleset Engine allows our engineers and analysts to write new rules in an easy to understand YAML syntax. This is critical to supporting a rapid response in under attack scenarios, especially as we support greater rule complexity. Hereâs a simple rule using the new engine, to detect empty user-agents restricted to a specific JA4 fingerprint (right), compared to the empty user-agent detection in the old Lua based system (left):Â &lt;/p&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;b&gt;Old&lt;/b&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;b&gt;New&lt;/b&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;code&gt;local _M = {}&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;local EmptyUserAgentHeuristic = {&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â heuristic = {},&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;}&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;EmptyUserAgentHeuristic.__index = EmptyUserAgentHeuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;--- Creates and returns empty user agent heuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @param params table contains parameters injected into EmptyUserAgentHeuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @return EmptyUserAgentHeuristic table&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;function _M.new(params)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â return setmetatable(params, EmptyUserAgentHeuristic)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;--- Adds heuristic to be used for inference in `detect` method&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @param heuristic schema.Heuristic table&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;function EmptyUserAgentHeuristic:add(heuristic)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â self.heuristic = heuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;--- Detect runs empty user agent heuristic detection&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @param ctx context of request&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @return schema.Heuristic table on successful detection or nil otherwise&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;function EmptyUserAgentHeuristic:detect(ctx)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â local ua = ctx.user_agent&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â if not ua or ua == &amp;#39;&amp;#39; then&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â return self.heuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;return _M&lt;/code&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;code&gt;ref: empty-user-agent&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â description: Empty or missing &lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;User-Agent header&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â action: add_bot_detection&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â action_parameters:&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â Â Â active_mode: false&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â expression: http.user_agent eq &lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;&amp;quot;&amp;quot; and cf.bot_management.ja4 = &amp;quot;t13d1516h2_8daaf6152771_b186095e22b6&amp;quot;&lt;/code&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;The Golang heuristic that captured corporate proxy traffic as well (mentioned above) was one of the first to migrate to the new Ruleset engine. Before the migration, traffic matching on this heuristic had a false positive rate of 0.01%. While that sounds like a very small number, this means for every million bots we block, 100 real users saw a Cloudflare challenge page unnecessarily. At Cloudflare scale, even small issues can have real, negative impact.&lt;/p&gt;&lt;p&gt;When we analyzed the traffic caught by this heuristic rule in depth, we saw the vast majority of attack traffic came from a small number of abusive networks. After narrowing the definition of the heuristic to flag the Golang fingerprint only when itâs sourced by the abusive networks, the rule now has a false positive rate of 0.0001% (One out of 1 million).Â  Updating the heuristic to include the network context improved our accuracy, while still blocking millions of bots every week and giving us plenty of training data for our bot detection models. Because this heuristic is now more accurate, newer ML models make more accurate decisions on whatâs a bot and what isnât.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;new-visibility-and-flexibility-for-bot-management-customers\&quot;&gt;New visibility and flexibility for Bot Management customersÂ &lt;/h3&gt;\n            &lt;a href=\&quot;#new-visibility-and-flexibility-for-bot-management-customers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;While the new heuristics engine provides more accurate detections for all customers and a better experience for our analysts, moving to the Cloudflare Ruleset Engine also allows us to deliver new functionality for Enterprise Bot Management customers, specifically by offering more visibility. This new visibility is via a new field for Bot Management customers called Bot Detection IDs. Every heuristic we use includes a unique Bot Detection ID. These are visible to Bot Management customers in analytics, logs, and firewall events, and they can be used in the firewall to write precise rules for individual bots.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3cYXHw8tFUjdJQGm93gFcE/0a3f6ab89a70410ebb7dd2c6f4f3a677/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1043\&quot; height=\&quot;292\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/9d7L1r7yN9AEhO26H7SgQ/434f0f934dd4f4498a8d13e85a7660ae/2.png\&quot; alt=\&quot;Bot Detection IDs can be selected in HTTP Request LogPush job configurations\&quot; class=\&quot;kg-image\&quot; width=\&quot;1291\&quot; height=\&quot;485\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Detections also include a specific tag describing the class of heuristic. Customers see these plotted over time in their analytics. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2UlkGQ070UWsmU76IXYqDd/6bca8f28959a8fe8f3013792a17b348a/image4.png\&quot; alt=\&quot;Bot Detection tags plotted over time in customer analytics\&quot; class=\&quot;kg-image\&quot; width=\&quot;881\&quot; height=\&quot;509\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;To illustrate how this data can help give customers visibility into why we blocked a request, hereâs an example request flagged by Bot Management (with the IP address, ASN, and country changed):&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3i6k9ejsBVwlbXUrZFIFJG/4c9cddd11d9f7a8ddf10eb5ff30a027b/4.png\&quot; alt=\&quot; A Firewall Event from a request with an empty user-agent\&quot; class=\&quot;kg-image\&quot; width=\&quot;1574\&quot; height=\&quot;580\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Before, just seeing that our heuristics gave the request a score of 1 was not very helpful in understanding why it was flagged as a bot. Adding our Detection IDs to Firewall Events helps to paint a better picture for customers that weâve identified this request as a bot because that traffic used an empty user-agent. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5UQd20VnXCnIav1skHiX6i/18e0cf01106601ae7faf18be50d43365/5.png\&quot; alt=\&quot;A Firewall Event from a request with an empty user-agent that now receives a detection ID described as âempty_ua\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1528\&quot; height=\&quot;938\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In addition to Analytics and Firewall Events, Bot Detection IDs are now available for Bot Management customers to use in Custom Rules, Rate Limiting Rules, Transform Rules, and Workers.Â &lt;/p&gt;&lt;h4&gt;Account takeover detection IDs&lt;/h4&gt;&lt;p&gt;One way weâre focused on improving Bot Management for our customers is by surfacing more attack-specific detections. During Birthday Week, we &lt;a href=\&quot;https://blog.cloudflare.com/a-safer-internet-with-cloudflare/\&quot;&gt;&lt;u&gt;launched Leaked Credentials Check&lt;/u&gt;&lt;/a&gt; for all customers so that security teams could help &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/solutions/account-takeover-prevention/\&quot;&gt;&lt;u&gt;prevent account takeover (ATO) attacks&lt;/u&gt;&lt;/a&gt; by identifying accounts at risk due to leaked credentials. Weâve now added two more detections that can help Bot Management enterprise customers identify suspicious login activity via specific &lt;a href=\&quot;https://developers.cloudflare.com/bots/concepts/detection-ids/#account-takeover-detections\&quot;&gt;&lt;u&gt;detection IDs&lt;/u&gt;&lt;/a&gt; that monitor login attempts and failures on the zone. These detection IDs are not currently affecting the bot score, but will begin to later in 2025. Already, they can help many customers detect more account takeover events now.&lt;/p&gt;&lt;p&gt;Detection ID &lt;b&gt;201326592 &lt;/b&gt;monitors traffic on a customer website and looks for an anomalous rise in login failures (usually associated with brute force attacks), and ID &lt;b&gt;201326593 &lt;/b&gt;looks for an anomalous rise in login attempts (usually associated with credential stuffing).Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4a2LGgB1bXGwFgHQEKFSI9/ff4194a6a470e466274f7b7c51e9dc18/6.png\&quot; alt=\&quot;A new Account Abuse Insights Panel in Security Analytics provides quick filters for Detection IDs measuring suspicious login attempts and failures. These detection IDs can also be combined with other Account Abuse signals like Leaked Credentials.  \&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;714\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;protect-your-applications\&quot;&gt;Protect your applications&lt;/h3&gt;\n            &lt;a href=\&quot;#protect-your-applications\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;If you are a Bot Management customer, log in and head over to the Cloudflare dashboard and take a look in Security Analytics for bot detection IDs &lt;code&gt;201326592&lt;/code&gt; and &lt;code&gt;201326593&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;These will highlight ATO attempts targeting your site. If you spot anything suspicious, or would like to be protected against future attacks, create a rule that uses these detections to keep your application safe.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-19T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-19T13:00:03.157Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5dT9qTVfruhhuHXbJ2N880/792486605cb75cc693f4a64fd3675961/BLOG_1398.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;4l3WDYLk6bXCyaRc9pRzXa&quot;],&quot;name&quot;:[0,&quot;Bots&quot;],&quot;slug&quot;:[0,&quot;bots&quot;]}],[0,{&quot;id&quot;:[0,&quot;267TTPMscUWABgYgHSH4ye&quot;],&quot;name&quot;:[0,&quot;Bot Management&quot;],&quot;slug&quot;:[0,&quot;bot-management&quot;]}],[0,{&quot;id&quot;:[0,&quot;urEf9QllkDeGxTu3ysdlo&quot;],&quot;name&quot;:[0,&quot;Application Security&quot;],&quot;slug&quot;:[0,&quot;application-security&quot;]}],[0,{&quot;id&quot;:[0,&quot;1HAYmR545ufVxM2rQzz0SE&quot;],&quot;name&quot;:[0,&quot;Machine Learning&quot;],&quot;slug&quot;:[0,&quot;machine-learning&quot;]}],[0,{&quot;id&quot;:[0,&quot;1QFszkvherAG520Xi1w4Ke&quot;],&quot;name&quot;:[0,&quot;Heuristics&quot;],&quot;slug&quot;:[0,&quot;heuristics&quot;]}],[0,{&quot;id&quot;:[0,&quot;4Hr4XSACbfTmrYAA7iESxH&quot;],&quot;name&quot;:[0,&quot;Edge Rules&quot;],&quot;slug&quot;:[0,&quot;edge-rules&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Curtis Lowder&quot;],&quot;slug&quot;:[0,&quot;curtis-lowder&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7nRYvsW2SrtTZfr9JeX3pL/cf30e6b9652d7d4e1c589cbed3961d60/Curtis_Lowder.png&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Brian Mitchell&quot;],&quot;slug&quot;:[0,&quot;brian-mitchell&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6TRFlHnVIfXX2cQhjt7wuc/86f2173516450dfa1e035b04cd4671c6/Screenshot_2024-12-21_at_17.56.35.png&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Adam Martinetti&quot;],&quot;slug&quot;:[0,&quot;adam-martinetti&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3sL65Jw7yfClw41pjnBfKp/75bfcc0615d0f01e0631ab0139900cd2/adam-martinetti.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@adamemcf&quot;],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules, deploy new releases rapidly, and give Bot Management customers the explainability and control they were asking for. &quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/bots-heuristics&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Improved Bot Management flexibility and visibility with new high-precision heuristics&quot;],&quot;description&quot;:[0,&quot;By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules, deploy new releases rapidly, and give Bot Management customers the explainability and control they were asking for.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7aUOa73viLqPiL6maGTTBD/47488b4df31256d503af51b10bc3fcb2/OG_Share_2024__18_.png&quot;]}]}],&quot;tagInfo&quot;:[0],&quot;authorInfo&quot;:[0],&quot;translatedPosts&quot;:[1,[]]}" ssr client="only" opts="{&quot;name&quot;:&quot;GoogleAnalytics&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island><script>(()=>{var l=(n,t)=>{let i=async()=>{await(await n())()},e=typeof t.value=="object"?t.value:void 0,s={timeout:e==null?void 0:e.timeout};"requestIdleCallback"in window?window.requestIdleCallback(i,s):setTimeout(i,s.timeout||200)};(self.Astro||(self.Astro={})).idle=l;window.dispatchEvent(new Event("astro:idle"));})();</script><astro-island uid="UBfBg" prefix="r3" component-url="/_astro/Navigation.CSu6dGvY.js" component-export="Navigation" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;logo&quot;:[0,&quot;//images.ctfassets.net/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png&quot;],&quot;pagesStore&quot;:[0,{&quot;page&quot;:[0,&quot;Post&quot;],&quot;slug&quot;:[0,&quot;bots-heuristics&quot;],&quot;translationsAvailable&quot;:[1,[]],&quot;navData&quot;:[1,[[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;J61Eszqn98amrYHq4IhTx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:46.068Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-21T17:03:18.285Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,102],&quot;revision&quot;:[0,35],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Zero Trust&quot;],&quot;name&quot;:[0,&quot;Zero Trust&quot;],&quot;slug&quot;:[0,&quot;zero-trust&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:21.536Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-20T11:02:39.512Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,75],&quot;revision&quot;:[0,31],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Developers&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:42:46.231Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-19T05:05:32.927Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,126],&quot;revision&quot;:[0,38],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Security&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:20.198Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-19T05:03:51.026Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,63],&quot;revision&quot;:[0,26],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Product News&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T22:44:28.803Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-19T05:02:57.122Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,88],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;AI&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;5kZtWqjqa7aOUoZr8NFGwI&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:26.040Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-19T05:02:54.727Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,120],&quot;revision&quot;:[0,36],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;name&quot;:[0,&quot;Radar&quot;],&quot;slug&quot;:[0,&quot;cloudflare-radar&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4g8tPriKOAUwdUT4jNPebe&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:40.927Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-18T17:04:03.027Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,65],&quot;revision&quot;:[0,26],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;name&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;slug&quot;:[0,&quot;life-at-cloudflare&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;48r7QV00gLMWOIcM1CSDRy&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:54:22.790Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-02-04T17:17:33.067Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,59],&quot;revision&quot;:[0,26],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;name&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;slug&quot;:[0,&quot;speed-and-reliability&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;V86khSc459Yi1AhTlvtY7&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:53.657Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-02-04T17:12:59.473Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,57],&quot;revision&quot;:[0,21],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Partners&quot;],&quot;name&quot;:[0,&quot;Partners&quot;],&quot;slug&quot;:[0,&quot;partners&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;16yk8DVbNNifxov5cWvAov&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:56:23.848Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-01-29T05:03:35.958Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,63],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;name&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;slug&quot;:[0,&quot;policy&quot;],&quot;featured&quot;:[0,true]}]}]]]}],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="idle" opts="{&quot;name&quot;:&quot;NavigationComponent&quot;,&quot;value&quot;:true}" await-children><header class="flex flex-row flex-wrap justify-between items-flex-end mw8 center mv3 pl3 pr1"><div class="w-100 flex items-flex-end justify-between justify-start-l"><div class="w-100 tr flex justify-end"><div class="flex justify-between items-center"><span class="dn di-l pr1"><a href="https://dash.cloudflare.com/sign-up" class="f1 blue1 dn di-l b no-underline underline-hover" target="_blank" rel="noreferrer">Get Started Free</a></span><span class="f1 gray4 dn di-l pr1">|</span><span class="dn di-l"><a target="_blank" href="https://www.cloudflare.com/plans/enterprise/contact/" class="f1 gray4 no-underline underline-hover pr1" rel="noreferrer">Contact Sales</a></span></div></div></div><div class="w-100 w-50-l flex items-end nb5 nb1-l"><a href="/" class="header-logo mr4 dn db-l"><img class="header-logo" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png" alt="The Cloudflare Blog" width="170" height="57"/></a><h2 class="mt0 mb1 dn di-l"><a href="/" class="fw5 f5 gray3 no-underline"><span class="dn di-l">The Cloudflare Blog</span></a></h2></div><div class="w-100 w-50-l dn db-l"><div class="w-100 tr mkto-sub-message"><p class="f2">Subscribe to receive notifications of new posts:</p></div><div class="w-100 tr"><div class="marketo-form-container"><form id="mktoForm_1653"><div class="top-subscribe-form-container"><div class="top-subscribe-form-field"><input placeholder="Email Address" class="top-subscribe-form-input" name="email" type="email" title="Must be valid email."/></div><button class="top-subscribe-form-button" type="button">Subscribe</button></div></form></div></div></div></header><nav dir="ltr" class="bb b--black-10 db dn-l w-100 ph3 "><div class=" flex justify-between items-center" style="height:44px"><a href="/search/"><img class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a><button type="button" style="background:transparent;border:none"><img src="/images/hamburger.svg" alt="hamburger menu"/></button></div><div class="js-mobile-nav-container dn"><div class="flex flex-column flex-wrap bg-gray9 o-95 absolute w-90 ph3 z-1"><div class="pv3 ph2 tl"><a href="/tag/zero-trust/" class="no-underline gray1 f4 fw7">Zero Trust</a></div><div class="pv3 ph2 tl"><a href="/tag/developers/" class="no-underline gray1 f4 fw7">Developers</a></div><div class="pv3 ph2 tl"><a href="/tag/security/" class="no-underline gray1 f4 fw7">Security</a></div><div class="pv3 ph2 tl"><a href="/tag/product-news/" class="no-underline gray1 f4 fw7">Product News</a></div><div class="pv3 ph2 tl"><a href="/tag/ai/" class="no-underline gray1 f4 fw7">AI</a></div><div class="pv3 ph2 tl"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f4 fw7">Radar</a></div><div class="pv3 ph2 tl"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f4 fw7">Life at Cloudflare</a></div><div class="pv3 ph2 tl"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f4 fw7">Speed &amp; Reliability</a></div><div class="pv3 ph2 tl"><a href="/tag/partners/" class="no-underline gray1 f4 fw7">Partners</a></div><div class="pv3 ph2 tl"><a href="/tag/policy/" class="no-underline gray1 f4 fw7">Policy &amp; Legal</a></div></div></div></nav><nav id="nav" class="w-100 bb-0 bb-l b--black-10 z-1"><div id="desktop-nav-items-container" class="flex flex-wrap justify-between items-center mw8 center mv3 mv0-l"><div data-tag="zero-trust" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/zero-trust/" class="no-underline gray1 f2 fw5 pv3">Zero Trust</a></div><div data-tag="developers" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/developers/" class="no-underline gray1 f2 fw5 pv3">Developers</a></div><div data-tag="security" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/security/" class="no-underline gray1 f2 fw5 pv3">Security</a></div><div data-tag="product-news" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/product-news/" class="no-underline gray1 f2 fw5 pv3">Product News</a></div><div data-tag="ai" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/ai/" class="no-underline gray1 f2 fw5 pv3">AI</a></div><div data-tag="cloudflare-radar" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f2 fw5 pv3">Radar</a></div><div data-tag="life-at-cloudflare" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f2 fw5 pv3">Life at Cloudflare</a></div><div data-tag="speed-and-reliability" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f2 fw5 pv3">Speed &amp; Reliability</a></div><div data-tag="partners" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/partners/" class="no-underline gray1 f2 fw5 pv3">Partners</a></div><div data-tag="policy" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/policy/" class="no-underline gray1 f2 fw5 pv3">Policy &amp; Legal</a></div><div class="nav-item ml2 mr3 dn db-l pv3" data-tag="search icon"><a href="/search/"><img id="search-icon" class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a></div></div></nav><!--astro:end--></astro-island><progress class="reading-progress" value="0" max="100" aria-label="Reading progress"></progress><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="20KhiP" prefix="r1" component-url="/_astro/Post.CgzUE9si.js" component-export="Post" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;4IkgXzyemEEsN7A6Cd18hb&quot;],&quot;title&quot;:[0,&quot;Improved Bot Management flexibility and visibility with new high-precision heuristics&quot;],&quot;slug&quot;:[0,&quot;bots-heuristics&quot;],&quot;excerpt&quot;:[0,&quot;By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules and deploy new releases rapidly.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Within the Cloudflare Application Security team, every &lt;a href=\&quot;https://www.cloudflare.com/learning/ai/what-is-machine-learning/\&quot;&gt;&lt;u&gt;machine learning&lt;/u&gt;&lt;/a&gt; model we use is underpinned by a rich set of static rules that serve as a ground truth and a baseline comparison for how our models are performing. These are called heuristics. Our Bot Management heuristics engine has served as an important part of eight global &lt;a href=\&quot;https://developers.cloudflare.com/bots/concepts/bot-score/#machine-learning\&quot;&gt;&lt;u&gt;machine learning (ML) models&lt;/u&gt;&lt;/a&gt;, but we needed a more expressive engine to increase our accuracy. In this post, weâll review how we solved this by moving our heuristics to the Cloudflare &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/\&quot;&gt;&lt;u&gt;Ruleset Engine&lt;/u&gt;&lt;/a&gt;. Not only did this provide the platform we needed to write more nuanced rules, it made our platform simpler and safer, and provided &lt;a href=\&quot;https://www.cloudflare.com/application-services/products/bot-management/\&quot;&gt;&lt;u&gt;Bot Management&lt;/u&gt;&lt;/a&gt; customers more flexibility and visibility into their bot traffic.Â Â Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;bot-detection-via-simple-heuristics\&quot;&gt;Bot detection via simple heuristics&lt;/h3&gt;\n            &lt;a href=\&quot;#bot-detection-via-simple-heuristics\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In Cloudflareâs bot detection, we build heuristics from attributes like software library fingerprints, HTTP request characteristics, and internal threat intelligence. Heuristics serve three separate purposes for bot detection:Â &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Bot identification: If traffic matches a heuristic, we can identify the traffic as definitely automated traffic (with a &lt;a href=\&quot;https://developers.cloudflare.com/bots/concepts/bot-score/\&quot;&gt;&lt;u&gt;bot score&lt;/u&gt;&lt;/a&gt; of 1) without the need of a machine learning model.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Train ML models: When traffic matches our heuristics, we create labelled datasets of bot traffic to train new models. Weâll use many different sources of labelled bot traffic to train a new model, but our heuristics datasets are one of the highest confidence datasets available to us.Â Â Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Validate models: We benchmark any new model candidateâs performance against our heuristic detections (among many other checks) to make sure it meets a required level of accuracy.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;While the existing heuristics engine has worked very well for us, as bots evolved we needed the flexibility to write increasingly complex rules. Unfortunately, such rules were not easily supported in the old engine. Customers have also been asking for more details about which specific heuristic caught a request, and for the flexibility to enforce different policies per heuristic ID.Â  We found that by building a new heuristics framework integrated into the Cloudflare Ruleset Engine, we could build a more flexible system to write rules and give Bot Management customers the granular explainability and control they were asking for.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-need-for-more-efficient-precise-rules\&quot;&gt;The need for more efficient, precise rules&lt;/h3&gt;\n            &lt;a href=\&quot;#the-need-for-more-efficient-precise-rules\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In our previous heuristics engine, we wrote rules in &lt;a href=\&quot;https://www.lua.org/\&quot;&gt;&lt;u&gt;Lua&lt;/u&gt;&lt;/a&gt; as part of our &lt;a href=\&quot;https://openresty.org/\&quot;&gt;&lt;u&gt;openresty&lt;/u&gt;&lt;/a&gt;-based reverse proxy. The Lua-based engine was limited to a very small number of characteristics in a rule because of the high engineering cost we observed with adding more complexity.&lt;/p&gt;&lt;p&gt;With Lua, we would write fairly simple logic to match on specific characteristics of a request (i.e. user agent). Creating new heuristics of an existing class was fairly straight forward. All weâd need to do is define another instance of the existing class in our database. However, if we observed malicious traffic that required more than two characteristics (as a simple example, user-agent and &lt;a href=\&quot;https://en.wikipedia.org/wiki/Autonomous_system_(Internet)\&quot;&gt;&lt;u&gt;ASN&lt;/u&gt;&lt;/a&gt;) to identify, weâd need to create bespoke logic for detections. Because our Lua heuristics engine was bundled with the code that ran ML models and other important logic, all changes had to go through the same review and release process. If we identified malicious traffic that needed a new heuristic class, and we were also blocked by pending changes in the codebase, weâd be forced to either wait or rollback the changes. If weâre writing a new rule for an âunder attackâ scenario, every extra minute it takes to deploy a new rule can mean an unacceptable impact to our customerâs business.Â &lt;/p&gt;&lt;p&gt;More critical than time to deploy is the complexity that the heuristics engine supports. The old heuristics engine only supported using specific request attributes when creating a new rule. As bots became more sophisticated, we found we had to reject an increasing number of new heuristic candidates because we werenât able to write precise enough rules. For example, we found a &lt;a href=\&quot;https://go.dev/\&quot;&gt;&lt;u&gt;Golang&lt;/u&gt;&lt;/a&gt; TLS fingerprint frequently used by bots and by a small number of corporate VPNs. We couldnât block the bots without also stopping the legitimate VPN usage as well, because the old heuristics platform lacked the flexibility to quickly compile sufficiently nuanced rules. Luckily, we already had the perfect solution with Cloudflare Ruleset Engine.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;our-new-heuristics-engine\&quot;&gt;Our new heuristics engine&lt;/h3&gt;\n            &lt;a href=\&quot;#our-new-heuristics-engine\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The Ruleset Engine is familiar to anyone who has written a WAF rule, Load Balancing rule, or Transform rule, &lt;a href=\&quot;https://blog.cloudflare.com/announcing-firewall-rules/\&quot;&gt;&lt;u&gt;just to name a few&lt;/u&gt;&lt;/a&gt;. For Bot Management, the Wireshark-inspired syntax allows us to quickly write heuristics with much greater flexibility to vastly improve accuracy. We can write a rule in &lt;a href=\&quot;https://yaml.org/\&quot;&gt;&lt;u&gt;YAML&lt;/u&gt;&lt;/a&gt; that includes arbitrary sub-conditions and inherit the same framework the WAF team uses to both ensure any new rule undergoes a rigorous testing process with the ability to rapidly release new rules to stop attacks in real-time.Â &lt;/p&gt;&lt;p&gt;Writing heuristics on the Cloudflare Ruleset Engine allows our engineers and analysts to write new rules in an easy to understand YAML syntax. This is critical to supporting a rapid response in under attack scenarios, especially as we support greater rule complexity. Hereâs a simple rule using the new engine, to detect empty user-agents restricted to a specific JA4 fingerprint (right), compared to the empty user-agent detection in the old Lua based system (left):Â &lt;/p&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;b&gt;Old&lt;/b&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;b&gt;New&lt;/b&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;code&gt;local _M = {}&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;local EmptyUserAgentHeuristic = {&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â heuristic = {},&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;}&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;EmptyUserAgentHeuristic.__index = EmptyUserAgentHeuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;--- Creates and returns empty user agent heuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @param params table contains parameters injected into EmptyUserAgentHeuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @return EmptyUserAgentHeuristic table&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;function _M.new(params)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â return setmetatable(params, EmptyUserAgentHeuristic)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;--- Adds heuristic to be used for inference in `detect` method&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @param heuristic schema.Heuristic table&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;function EmptyUserAgentHeuristic:add(heuristic)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â self.heuristic = heuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;--- Detect runs empty user agent heuristic detection&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @param ctx context of request&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @return schema.Heuristic table on successful detection or nil otherwise&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;function EmptyUserAgentHeuristic:detect(ctx)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â local ua = ctx.user_agent&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â if not ua or ua == &amp;#39;&amp;#39; then&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â return self.heuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;return _M&lt;/code&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;code&gt;ref: empty-user-agent&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â description: Empty or missing &lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;User-Agent header&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â action: add_bot_detection&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â action_parameters:&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â Â Â active_mode: false&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â expression: http.user_agent eq &lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;&amp;quot;&amp;quot; and cf.bot_management.ja4 = &amp;quot;t13d1516h2_8daaf6152771_b186095e22b6&amp;quot;&lt;/code&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;The Golang heuristic that captured corporate proxy traffic as well (mentioned above) was one of the first to migrate to the new Ruleset engine. Before the migration, traffic matching on this heuristic had a false positive rate of 0.01%. While that sounds like a very small number, this means for every million bots we block, 100 real users saw a Cloudflare challenge page unnecessarily. At Cloudflare scale, even small issues can have real, negative impact.&lt;/p&gt;&lt;p&gt;When we analyzed the traffic caught by this heuristic rule in depth, we saw the vast majority of attack traffic came from a small number of abusive networks. After narrowing the definition of the heuristic to flag the Golang fingerprint only when itâs sourced by the abusive networks, the rule now has a false positive rate of 0.0001% (One out of 1 million).Â  Updating the heuristic to include the network context improved our accuracy, while still blocking millions of bots every week and giving us plenty of training data for our bot detection models. Because this heuristic is now more accurate, newer ML models make more accurate decisions on whatâs a bot and what isnât.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;new-visibility-and-flexibility-for-bot-management-customers\&quot;&gt;New visibility and flexibility for Bot Management customersÂ &lt;/h3&gt;\n            &lt;a href=\&quot;#new-visibility-and-flexibility-for-bot-management-customers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;While the new heuristics engine provides more accurate detections for all customers and a better experience for our analysts, moving to the Cloudflare Ruleset Engine also allows us to deliver new functionality for Enterprise Bot Management customers, specifically by offering more visibility. This new visibility is via a new field for Bot Management customers called Bot Detection IDs. Every heuristic we use includes a unique Bot Detection ID. These are visible to Bot Management customers in analytics, logs, and firewall events, and they can be used in the firewall to write precise rules for individual bots.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3cYXHw8tFUjdJQGm93gFcE/0a3f6ab89a70410ebb7dd2c6f4f3a677/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1043\&quot; height=\&quot;292\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/9d7L1r7yN9AEhO26H7SgQ/434f0f934dd4f4498a8d13e85a7660ae/2.png\&quot; alt=\&quot;Bot Detection IDs can be selected in HTTP Request LogPush job configurations\&quot; class=\&quot;kg-image\&quot; width=\&quot;1291\&quot; height=\&quot;485\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Detections also include a specific tag describing the class of heuristic. Customers see these plotted over time in their analytics. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2UlkGQ070UWsmU76IXYqDd/6bca8f28959a8fe8f3013792a17b348a/image4.png\&quot; alt=\&quot;Bot Detection tags plotted over time in customer analytics\&quot; class=\&quot;kg-image\&quot; width=\&quot;881\&quot; height=\&quot;509\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;To illustrate how this data can help give customers visibility into why we blocked a request, hereâs an example request flagged by Bot Management (with the IP address, ASN, and country changed):&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3i6k9ejsBVwlbXUrZFIFJG/4c9cddd11d9f7a8ddf10eb5ff30a027b/4.png\&quot; alt=\&quot; A Firewall Event from a request with an empty user-agent\&quot; class=\&quot;kg-image\&quot; width=\&quot;1574\&quot; height=\&quot;580\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Before, just seeing that our heuristics gave the request a score of 1 was not very helpful in understanding why it was flagged as a bot. Adding our Detection IDs to Firewall Events helps to paint a better picture for customers that weâve identified this request as a bot because that traffic used an empty user-agent. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5UQd20VnXCnIav1skHiX6i/18e0cf01106601ae7faf18be50d43365/5.png\&quot; alt=\&quot;A Firewall Event from a request with an empty user-agent that now receives a detection ID described as âempty_ua\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1528\&quot; height=\&quot;938\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In addition to Analytics and Firewall Events, Bot Detection IDs are now available for Bot Management customers to use in Custom Rules, Rate Limiting Rules, Transform Rules, and Workers.Â &lt;/p&gt;&lt;h4&gt;Account takeover detection IDs&lt;/h4&gt;&lt;p&gt;One way weâre focused on improving Bot Management for our customers is by surfacing more attack-specific detections. During Birthday Week, we &lt;a href=\&quot;https://blog.cloudflare.com/a-safer-internet-with-cloudflare/\&quot;&gt;&lt;u&gt;launched Leaked Credentials Check&lt;/u&gt;&lt;/a&gt; for all customers so that security teams could help &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/solutions/account-takeover-prevention/\&quot;&gt;&lt;u&gt;prevent account takeover (ATO) attacks&lt;/u&gt;&lt;/a&gt; by identifying accounts at risk due to leaked credentials. Weâve now added two more detections that can help Bot Management enterprise customers identify suspicious login activity via specific &lt;a href=\&quot;https://developers.cloudflare.com/bots/concepts/detection-ids/#account-takeover-detections\&quot;&gt;&lt;u&gt;detection IDs&lt;/u&gt;&lt;/a&gt; that monitor login attempts and failures on the zone. These detection IDs are not currently affecting the bot score, but will begin to later in 2025. Already, they can help many customers detect more account takeover events now.&lt;/p&gt;&lt;p&gt;Detection ID &lt;b&gt;201326592 &lt;/b&gt;monitors traffic on a customer website and looks for an anomalous rise in login failures (usually associated with brute force attacks), and ID &lt;b&gt;201326593 &lt;/b&gt;looks for an anomalous rise in login attempts (usually associated with credential stuffing).Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4a2LGgB1bXGwFgHQEKFSI9/ff4194a6a470e466274f7b7c51e9dc18/6.png\&quot; alt=\&quot;A new Account Abuse Insights Panel in Security Analytics provides quick filters for Detection IDs measuring suspicious login attempts and failures. These detection IDs can also be combined with other Account Abuse signals like Leaked Credentials.  \&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;714\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;protect-your-applications\&quot;&gt;Protect your applications&lt;/h3&gt;\n            &lt;a href=\&quot;#protect-your-applications\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;If you are a Bot Management customer, log in and head over to the Cloudflare dashboard and take a look in Security Analytics for bot detection IDs &lt;code&gt;201326592&lt;/code&gt; and &lt;code&gt;201326593&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;These will highlight ATO attempts targeting your site. If you spot anything suspicious, or would like to be protected against future attacks, create a rule that uses these detections to keep your application safe.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-19T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-19T13:00:03.157Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5dT9qTVfruhhuHXbJ2N880/792486605cb75cc693f4a64fd3675961/BLOG_1398.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;4l3WDYLk6bXCyaRc9pRzXa&quot;],&quot;name&quot;:[0,&quot;Bots&quot;],&quot;slug&quot;:[0,&quot;bots&quot;]}],[0,{&quot;id&quot;:[0,&quot;267TTPMscUWABgYgHSH4ye&quot;],&quot;name&quot;:[0,&quot;Bot Management&quot;],&quot;slug&quot;:[0,&quot;bot-management&quot;]}],[0,{&quot;id&quot;:[0,&quot;urEf9QllkDeGxTu3ysdlo&quot;],&quot;name&quot;:[0,&quot;Application Security&quot;],&quot;slug&quot;:[0,&quot;application-security&quot;]}],[0,{&quot;id&quot;:[0,&quot;1HAYmR545ufVxM2rQzz0SE&quot;],&quot;name&quot;:[0,&quot;Machine Learning&quot;],&quot;slug&quot;:[0,&quot;machine-learning&quot;]}],[0,{&quot;id&quot;:[0,&quot;1QFszkvherAG520Xi1w4Ke&quot;],&quot;name&quot;:[0,&quot;Heuristics&quot;],&quot;slug&quot;:[0,&quot;heuristics&quot;]}],[0,{&quot;id&quot;:[0,&quot;4Hr4XSACbfTmrYAA7iESxH&quot;],&quot;name&quot;:[0,&quot;Edge Rules&quot;],&quot;slug&quot;:[0,&quot;edge-rules&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Curtis Lowder&quot;],&quot;slug&quot;:[0,&quot;curtis-lowder&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7nRYvsW2SrtTZfr9JeX3pL/cf30e6b9652d7d4e1c589cbed3961d60/Curtis_Lowder.png&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Brian Mitchell&quot;],&quot;slug&quot;:[0,&quot;brian-mitchell&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6TRFlHnVIfXX2cQhjt7wuc/86f2173516450dfa1e035b04cd4671c6/Screenshot_2024-12-21_at_17.56.35.png&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Adam Martinetti&quot;],&quot;slug&quot;:[0,&quot;adam-martinetti&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3sL65Jw7yfClw41pjnBfKp/75bfcc0615d0f01e0631ab0139900cd2/adam-martinetti.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@adamemcf&quot;],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules, deploy new releases rapidly, and give Bot Management customers the explainability and control they were asking for. &quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/bots-heuristics&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Improved Bot Management flexibility and visibility with new high-precision heuristics&quot;],&quot;description&quot;:[0,&quot;By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules, deploy new releases rapidly, and give Bot Management customers the explainability and control they were asking for.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7aUOa73viLqPiL6maGTTBD/47488b4df31256d503af51b10bc3fcb2/OG_Share_2024__18_.png&quot;]}]}],&quot;initialReadingTime&quot;:[0,&quot;7&quot;],&quot;relatedPosts&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;2hlOlV28pXRFpnmnkqbbhw&quot;],&quot;title&quot;:[0,&quot;Detecting sensitive data and misconfigurations in AWS and GCP with Cloudflare One&quot;],&quot;slug&quot;:[0,&quot;scan-cloud-dlp-with-casb&quot;],&quot;excerpt&quot;:[0,&quot;Using Cloudflareâs CASB, integrate, scan, and detect sensitive data and misconfigurations in your cloud storage accounts.&quot;],&quot;featured&quot;:[0,true],&quot;html&quot;:[0,&quot;&lt;p&gt;Today is the final day of Security Week 2025, and after a great week of blog posts across a variety of topics, weâre excited to share the latest on Cloudflareâs data security products.&lt;/p&gt;&lt;p&gt;This announcement takes us to Cloudflareâs SASE platform, &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/products/\&quot;&gt;&lt;u&gt;Cloudflare One&lt;/u&gt;&lt;/a&gt;, used by enterprise security and IT teams to manage the security of their employees, applications, and third-party tools, all in one place.&lt;/p&gt;&lt;p&gt;Starting today, Cloudflare One users can now use the &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/products/casb/\&quot;&gt;&lt;u&gt;CASB&lt;/u&gt;&lt;/a&gt; (Cloud Access Security Broker) product to integrate with and scan Amazon Web Services (AWS) S3 and Google Cloud Storage, for posture- and Data Loss Prevention (DLP)-related security issues. &lt;a href=\&quot;https://dash.cloudflare.com/sign-up\&quot;&gt;&lt;u&gt;Create a free account&lt;/u&gt;&lt;/a&gt; to check it out.&lt;/p&gt;&lt;p&gt;Scanning both point-in-time and continuously, users can identify misconfigurations in Identity and Access Management (IAM), bucket, and object settings, and detect sensitive information, like Social Security numbers, credit card numbers, or any other pattern using regex, in cloud storage objects.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;cloud-dlp\&quot;&gt;Cloud DLP&lt;/h3&gt;\n            &lt;a href=\&quot;#cloud-dlp\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        \n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1R1bE9TRmTdHDTg1XeLS60/8269b687ec65e70bcaee437f30d5f590/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1111\&quot; height=\&quot;677\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Over the last few years, our customers â predominantly security and IT teams â have told us about their appreciation for CASBâs simplicity and effectiveness as a SaaS security product. Its number of &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/applications/casb/casb-integrations/\&quot;&gt;&lt;u&gt;supported integrations&lt;/u&gt;&lt;/a&gt;, its ease of setup, and speed in identifying critical issues across popular SaaS platforms, like files shared publicly in Microsoft 365 and exposed sensitive data in Google Workspace, has made it a go-to for many.&lt;/p&gt;&lt;p&gt;However, as weâve engaged with customers, one thing became clear: the risks of unmonitored or exposed data at-rest go far beyond just SaaS environments. Sensitive information â whether intellectual property, customer data, or personal identifiers â can wreak havoc on an organizationâs reputation and its obligations to its customers if it falls into the wrong hands. For many of our customers, the security of data stored in cloud providers like AWS and GCP is even more critical than the security of data in their SaaS tools.&lt;/p&gt;&lt;p&gt;Thatâs why weâve extended Cloudflare CASB to include &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/policies/data-loss-prevention/\&quot;&gt;&lt;u&gt;Cloud DLP (Data Loss Prevention)&lt;/u&gt;&lt;/a&gt; functionality, enabling users to scan objects in Amazon S3 buckets and Google Cloud Storage for sensitive data matchesâ.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5TKXiAkQKxw3GFQBCuQLjX/198e4620da8239280eff669b7b62678b/2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1036\&quot; height=\&quot;704\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;With &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/products/dlp/\&quot;&gt;&lt;u&gt;Cloudflare DLP&lt;/u&gt;&lt;/a&gt;, you can choose from pre-built detection profiles that look for common data types (such as Social Security Numbers or credit card numbers) or create your own custom profiles using regular expressionsâ. As soon as an object matching a DLP profile is detected, you can dive into the details, understanding the fileâs context, seeing who owns it, and more. These capabilities provide the insight needed to quickly protect data and prevent exposure in real time.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4cyOaQJ0ZyPO8r7LyeU6ON/30b8453888d6cb13dcb15225f875a0cd/3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1224\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;And as with all CASB integrations, this new functionality also comes with posture management features, meaning whether youâre using AWS or GCP, weâll help you identify misconfigurations and other cloud security issues that could leave your data vulnerableâ, like buckets that are publicly-accessible or have critical logging settings disabled, access keys needing rotation, or users without &lt;a href=\&quot;https://www.cloudflare.com/learning/access-management/what-is-multi-factor-authentication/\&quot;&gt;&lt;u&gt;multi-factor authentication (MFA)&lt;/u&gt;&lt;/a&gt;. Itâs all included.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;simple-by-default-configurable-where-you-want-it\&quot;&gt;Simple by default, configurable where you want it&lt;/h3&gt;\n            &lt;a href=\&quot;#simple-by-default-configurable-where-you-want-it\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Cloudflare CASB and DLP are simple to use by default, making it easy to get started right away. But itâs also highly configurable, giving you the flexibility to fine-tune the scanning profiles to suit your specific needs.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5MLh3y7SMHnX52cjuu4pmE/b7bb67497fc21bc9d3f3f740a9b3fe52/4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1402\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;For example, you can adjust which storage buckets or file types to scan, and even sample only a percentage of objects for analysisâ. The scanning also runs within your own cloud environment, so your data never leaves your infrastructureâ. This approach keeps your cloud storage secure and your costs managed while allowing you to tailor the solution to your organizationâs unique compliance and security requirements.&lt;/p&gt;&lt;p&gt;Looking ahead, our roadmap also includes expanding support to additional cloud storage environments, such as Azure Blob Storage and Cloudflare R2, further extending our comprehensive, multi-cloud security strategy. Stay tuned for more on that!&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;how-it-works\&quot;&gt;How it works&lt;/h3&gt;\n            &lt;a href=\&quot;#how-it-works\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;From the start, we knew that to deliver DLP capabilities across cloud environments, it would require an efficient and scalable design to enable real-time detection of sensitive data exposure.&lt;/p&gt;&lt;h4&gt;Serverless architecture for streamlined processing&lt;/h4&gt;&lt;p&gt;An early design decision was made to leverage a serverless architecture approach to ensure sensitive data discovery is both efficient and scalable. Hereâs how it works:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Compute Account&lt;/b&gt;: The entire process runs within a cloud account owned by your organization, known as a Compute Account. This design ensures your data remains within your boundaries, avoiding costly cloud egress fees. The Compute Account can be launched in under 15 minutes using a provided Terraform template.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Controller function&lt;/b&gt;: Every minute, a lightweight, serverless controller function in your cloud environment communicates with Cloudflareâs APIs, fetching the latest DLP configurations and security profiles from your Cloudflare One account.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Crawler process&lt;/b&gt;: The controller triggers an object discovery task, which is processed by a second serverless function known as the Crawler. The Crawler queries cloud storage accounts, like AWS S3 or Google Cloud Storage, via API to identify new objects. Redis is used within the Compute Account to track which objects have yet to be evaluated.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Scanning for sensitive data&lt;/b&gt;: Newly discovered objects are sent through a queue to a third serverless function called the Scanner. This function downloads the objects and streams their contents to the DLP engine in the Compute Account, which scans for matches against predefined or custom DLP Profiles.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Finding generation and alerts&lt;/b&gt;: If a DLP match is found, metadata about the object, such as context and ownership details, is published to a queue. This data is ingested by a Cloudflare-hosted service and presented in the Cloudflare Dashboard as findings, giving security teams the visibility needed to take swift action.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4&gt;Scalable and secure design&lt;/h4&gt;&lt;p&gt;The DLP pipeline ensures that sensitive data never leaves your cloud environment â a privacy-first approach. All communication between the Compute Account and Cloudflare&amp;#39;s APIs are initiated by the controller, also meaning there is no need to perform any extra configuration to allow ingress traffic.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;how-to-get-started\&quot;&gt;How to get started&lt;/h3&gt;\n            &lt;a href=\&quot;#how-to-get-started\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;To get started, reach out to your account team to learn more about this new data security functionality and our roadmap. If you want to try this out on your own, you can login to the Cloudflare One dashboard (create a free account &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/products/\&quot;&gt;&lt;u&gt;here&lt;/u&gt;&lt;/a&gt; if you donât have one) and navigate to the CASB page to set up your first integration.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;watch-on-cloudflare-tv\&quot;&gt;Watch on Cloudflare TV&lt;/h3&gt;\n            &lt;a href=\&quot;#watch-on-cloudflare-tv\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;div style=\&quot;position: relative; padding-top: 56.25%;\&quot;&gt;\n  &lt;iframe\n    src=\&quot;https://customer-rhnwzxvb3mg4wz3v.cloudflarestream.com/f51cb1a22818fc567453d3d1ccbf3207/iframe?preload=true&amp;poster=https%3A%2F%2Fcustomer-rhnwzxvb3mg4wz3v.cloudflarestream.com%2Ff51cb1a22818fc567453d3d1ccbf3207%2Fthumbnails%2Fthumbnail.jpg%3Ftime%3D9s%26height%3D600&amp;startTime=9s&amp;controls=false\&quot;\n    loading=\&quot;lazy\&quot;\n    style=\&quot;border: none; position: absolute; top: 0; left: 0; height: 100%; width: 100%;\&quot;\n    allow=\&quot;accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;\&quot;\n    allowfullscreen=\&quot;true\&quot;\n  &gt;&lt;/iframe&gt;\n&lt;/div&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-21T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-21T13:00:02.812Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7hZUKPoHuvfDk2w9Cdm7Hs/284b2fc5add90e2da1550bd003e1fc46/Feature_Image_.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;4Z2oveL0P0AeqGa5lL4Vo1&quot;],&quot;name&quot;:[0,&quot;Cloudflare One&quot;],&quot;slug&quot;:[0,&quot;cloudflare-one&quot;]}],[0,{&quot;id&quot;:[0,&quot;3iAX3DmDBEfSj3TULqvhPD&quot;],&quot;name&quot;:[0,&quot;CASB&quot;],&quot;slug&quot;:[0,&quot;casb&quot;]}],[0,{&quot;id&quot;:[0,&quot;4yBlHkuMJq9VSFd341CkxY&quot;],&quot;name&quot;:[0,&quot;DLP&quot;],&quot;slug&quot;:[0,&quot;dlp&quot;]}],[0,{&quot;id&quot;:[0,&quot;4xYkcVnnMwHSYkL19IbOFd&quot;],&quot;name&quot;:[0,&quot;AWS&quot;],&quot;slug&quot;:[0,&quot;aws&quot;]}],[0,{&quot;id&quot;:[0,&quot;2XaNX3TUr0DobetHd9z2GL&quot;],&quot;name&quot;:[0,&quot;Google Cloud&quot;],&quot;slug&quot;:[0,&quot;google-cloud&quot;]}],[0,{&quot;id&quot;:[0,&quot;J61Eszqn98amrYHq4IhTx&quot;],&quot;name&quot;:[0,&quot;Zero Trust&quot;],&quot;slug&quot;:[0,&quot;zero-trust&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Alex Dunbrack&quot;],&quot;slug&quot;:[0,&quot;alex-dunbrack&quot;],&quot;bio&quot;:[0,&quot;Product manager @Cloudflare, previously co-founder @Vectrix, alum @Y Combinator&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/73rgMyGhcPKcLk84gVa7pR/5597006a4e659bc31ff6862749681bb8/alex-dunbrack.jpeg&quot;],&quot;location&quot;:[0,&quot;San Francisco&quot;],&quot;website&quot;:[0,&quot;https://www.linkedin.com/in/alexdunbrack&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Michael Leslie &quot;],&quot;slug&quot;:[0,&quot;michael-leslie&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4I3JcVtd72w52ahCe6p8sH/2b5ffa332eb2bda9a60e5e0610ccc998/Michael_Leslie.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}]]],&quot;meta_description&quot;:[0,&quot;Using Cloudflareâs CASB, integrate, scan, and detect sensitive data and misconfigurations in your cloud storage accounts.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/scan-cloud-dlp-with-casb&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Detecting sensitive data and misconfigurations in AWS and GCP with Cloudflare One&quot;],&quot;description&quot;:[0,&quot;Using Cloudflareâs CASB, integrate, scan, and detect sensitive data and misconfigurations in your cloud storage accounts.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/43mPUgYv5tjRyfv8VYb35D/49d28831f733c0a7aafb7272a0707f66/OG_Share_2024__24_.png&quot;]}]}],[0,{&quot;id&quot;:[0,&quot;2P5rqqGRcQQFywmNmp85oM&quot;],&quot;title&quot;:[0,&quot;RDP without the risk: Cloudflare&#39;s browser-based solution for secure third-party access&quot;],&quot;slug&quot;:[0,&quot;browser-based-rdp&quot;],&quot;excerpt&quot;:[0,&quot;Cloudflare now provides clientless, browser-based support for the Remote Desktop Protocol (RDP). It enables secure, remote Windows server access without VPNs or RDP clients.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;a href=\&quot;https://blog.cloudflare.com/intro-access-for-infrastructure-ssh/\&quot;&gt;&lt;u&gt;Short-lived SSH access&lt;/u&gt;&lt;/a&gt; made its debut on Cloudflareâs &lt;a href=\&quot;https://www.cloudflare.com/learning/access-management/what-is-sase\&quot;&gt;&lt;u&gt;SASE&lt;/u&gt;&lt;/a&gt; platform in October 2024. Leveraging the knowledge gained through the &lt;a href=\&quot;https://blog.cloudflare.com/cloudflare-acquires-bastionzero/\&quot;&gt;&lt;u&gt;BastionZero acquisition&lt;/u&gt;&lt;/a&gt;, short-lived SSH access enables organizations to apply Zero Trust controls in front of their Linux servers. That was just the beginning, however, as we are thrilled to announce the release of a long-requested feature: clientless, browser-based support for the &lt;a href=\&quot;https://www.cloudflare.com/learning/access-management/what-is-the-remote-desktop-protocol/\&quot;&gt;&lt;u&gt;Remote Desktop Protocol&lt;/u&gt;&lt;/a&gt; (RDP). Built on top of Cloudflareâs modern proxy architecture, our RDP proxy offers a secure and performant solution that, critically, is also easy to set up, maintain, and use.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;security-challenges-of-rdp\&quot;&gt;Security challenges of RDPÂ &lt;/h3&gt;\n            &lt;a href=\&quot;#security-challenges-of-rdp\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/use-cases/rdp/\&quot;&gt;&lt;u&gt;Remote Desktop Protocol (RDP)&lt;/u&gt;&lt;/a&gt; was born in 1998 with &lt;a href=\&quot;https://news.microsoft.com/1998/06/16/microsoft-releases-windows-nt-server-4-0-terminal-server-edition/\&quot;&gt;&lt;u&gt;Windows NT 4.0 Terminal Server Edition&lt;/u&gt;&lt;/a&gt;. If you have never heard of that Windows version, itâs because, well, thereâs been 16 major Windows releases since then. Regardless, RDP is still used across thousands of organizations to enable remote access to Windows servers. Itâs a bit of a strange protocol that relies on a graphical user interface to display screen captures taken in very close succession in order to emulate the interactions on the remote Windows server. (Thereâs more happening here beyond the screen captures, including drawing commands, bitmap updates, and even video streams. Like we said â itâs a bit strange.) Because of this complexity, RDP can be computationally demanding and poses a challenge for running at high performance over traditional VPNs.&lt;/p&gt;&lt;p&gt;Beyond its quirks, RDP has also had a rather &lt;a href=\&quot;https://www.cloudflare.com/learning/access-management/rdp-security-risks/\&quot;&gt;&lt;u&gt;unsavory reputation&lt;/u&gt;&lt;/a&gt; in the security industry due to early vulnerabilities with the protocol. The two main offenders are weak user sign-in credentials and unrestricted port access. Windows servers are commonly protected by passwords, which often have inadequate security to start, and worse still, may be shared across multiple accounts. This leaves these RDP servers open to brute force or credential stuffing attacks.Â &lt;/p&gt;&lt;p&gt;Bad actors have abused RDPâs default port, 3389, to carry out on-path attacks. One of the most severe RDP vulnerabilities discovered is called BlueKeep. Officially known as &lt;a href=\&quot;https://nvd.nist.gov/vuln/detail/CVE-2019-0708\&quot;&gt;&lt;i&gt;CVE-2019-0708&lt;/i&gt;&lt;/a&gt;, BlueKeep is a vulnerability that allows remote code execution (RCE) without authentication, as long as the request adheres to a specific format and is sent to a port running RDP. Worse still, it is wormable, meaning that BlueKeep can spread to other machines within the network with no user action. Because bad actors can compromise RDP to gain unauthorized access, attackers can then move laterally within the network, escalating privileges, and installing malware. RDP has also been used to deploy ransomware such as Ryuk, Conti, and DoppelPaymer, earning it the nickname âRansomware Delivery Protocol.âÂ &lt;/p&gt;&lt;p&gt;This is a subset of vulnerabilities in RDPâs history, but we donât mean to be discouraging. Thankfully, due to newer versions of Windows, CVE patches, improved password hygiene, and better awareness of privileged access, many organizations have reduced their attack surface. However, for as many secured Windows servers that exist, there are still countless unpatched or poorly configured systems online, making them easy targets for ransomware and botnets.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-need-for-a-browser-based-rdp-solution\&quot;&gt;The need for a browser-based RDP solution&lt;/h3&gt;\n            &lt;a href=\&quot;#the-need-for-a-browser-based-rdp-solution\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Despite its security risks, RDP remains essential for many organizations, particularly those with distributed workforces and third-party contractors. It provides value for compute-intensive tasks that require high-powered Windows servers with CPU/GPU resources greater than usersâ machines can offer. For security-focused organizations, RDP grants better visibility into who is accessing Windows servers and what actions are taken during those sessions.Â &lt;/p&gt;&lt;p&gt;Because issuing corporate devices to contractors is costly and cumbersome, many organizations adopt a bring-your-own-device (BYOD) policy. This decision instead requires organizations to provide contractors with a means to RDP to a Windows server with the necessary corporate resources to fulfill their role.&lt;/p&gt;&lt;p&gt;Traditional RDP requires client software on user devices, so this is not an appropriate solution for contractors (or any employees) using personal machines or unmanaged devices. Previously, Cloudflare customers had to rely on self-hosted third-party tools like &lt;a href=\&quot;https://guacamole.apache.org/\&quot;&gt;&lt;u&gt;Apache Guacamole&lt;/u&gt;&lt;/a&gt; or &lt;a href=\&quot;https://devolutions.net/gateway/\&quot;&gt;&lt;u&gt;Devolutions Gateway&lt;/u&gt;&lt;/a&gt; to enable browser-based RDP access. This created several operational pain points:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Infrastructure complexity:&lt;/b&gt; Deploying and maintaining RDP gateways increases operational overhead.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Maintenance burden:&lt;/b&gt; Commercial and open-source tools may require frequent updates and patches, sometimes even necessitating custom forks.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Compliance challenges:&lt;/b&gt; Third-party software requires additional security audits and risk management assessments, particularly for regulated industries.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Redundancy, but not the good kind&lt;/b&gt; - Customers come to Cloudflare to reduce the complexity of maintaining their infrastructure, &lt;i&gt;not add to it&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Weâve been listening. Cloudflare has architectured a high-performance RDP proxy that leverages the modern security controls already part of our &lt;a href=\&quot;https://www.cloudflare.com/learning/access-management/what-is-ztna/\&quot;&gt;&lt;u&gt;Zero Trust Network Access (ZTNA)&lt;/u&gt;&lt;/a&gt; service. We feel that the âsecurity/performance tradeoffâ the industry commonly touts is a dated mindset. With the right underlying network architecture, we can help mitigate RDPâs most infamous challenges.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;introducing-browser-based-rdp-with-access\&quot;&gt;Introducing browser-based RDP with Access&lt;/h3&gt;\n            &lt;a href=\&quot;#introducing-browser-based-rdp-with-access\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Cloudflare&amp;#39;s browser-based RDP solution is the newest addition to &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/products/access/\&quot;&gt;&lt;u&gt;Cloudflare Access&lt;/u&gt;&lt;/a&gt; alongside existing &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/applications/non-http/browser-rendering/\&quot;&gt;&lt;u&gt;clientless SSH and VNC offerings&lt;/u&gt;&lt;/a&gt;, enabling secure, remote Windows server access without VPNs or RDP clients. Built natively within Cloudflareâs global network, it requires no additional infrastructure.&lt;/p&gt;&lt;p&gt;Our browser-based RDP access combines the power of self-hosted Access applications with the additional flexibility of &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/use-cases/ssh/ssh-infrastructure-access/#4-add-a-target\&quot;&gt;targets&lt;/a&gt;, introduced with &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/applications/non-http/infrastructure-apps/\&quot;&gt;&lt;u&gt;Access for Infrastructure&lt;/u&gt;&lt;/a&gt;. Administrators can enforce:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Authentication&lt;/b&gt;: Control how users authenticate to your internal RDP resources with SSO, MFA, and device posture.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Authorization:&lt;/b&gt; Use policy-based access control to determine who can access what target and when.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Auditing:&lt;/b&gt; Provide Access logs to support regulatory compliance and visibility in the event of a security breach.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Users only need a web browser â no native RDP client is necessary! RDP servers are accessed through our app connector, &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/\&quot;&gt;&lt;u&gt;Cloudflare Tunnel&lt;/u&gt;&lt;/a&gt;, using a common deployment model of existing Access customers. There is no need to provision user devices to access particular RDP servers, making for minimal setup to adopt this new functionality.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6vAxzxVY1RXc0batsTEdfn/3c9cba95add32a248da623af5db68256/2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1027\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;h4&gt;How it works&lt;/h4&gt;&lt;h5&gt;The client&lt;/h5&gt;&lt;p&gt;Cloudflareâs implementation leverages &lt;a href=\&quot;https://github.com/Devolutions/IronRDP\&quot;&gt;&lt;u&gt;IronRDP&lt;/u&gt;&lt;/a&gt;, a high-performance RDP client that runs in the browser. It was selected because it is a modern, well-maintained, RDP client implementation that offers an efficient and responsive experience. Unlike Java-based Apache Guacamole, another popular RDP client implementation, IronRDP is built with Rust and integrates very well with Cloudflareâs development ecosystem.&lt;/p&gt;&lt;p&gt;While selecting the right tools can make all the difference, using a browser to facilitate an RDP session faces some challenges. From a practical perspective, browsers just can&amp;#39;t send RDP messages. RDP relies directly on the Layer 4 Transmission Control Protocol (TCP) for communication, and while browsers can use TCP as the underlying protocol, they do not expose APIs that would let apps build protocol support directly on raw TCP sockets.&lt;/p&gt;&lt;p&gt;Another challenge is rooted in a security consideration: the username and password authentication mechanism that is native to RDP leaves a lot to be desired in the modern world of Zero Trust.&lt;/p&gt;&lt;p&gt;In order to tackle both of these challenges, the IronRDP client encapsulates the RDP session in a WebSocket connection. Wrapping the Layer 4 TCP traffic in HTTPS enables the client to use native browser APIs to communicate with Cloudflareâs RDP proxy. Additionally, it enables Cloudflare Access to secure the entire session using identity-aware policies. By attaching a Cloudflare Access authorization JSON Web Token (JWT) via cookie to the WebSocket connection, every inter-service hop of the RDP session is verified to be coming from the authenticated user.Â Â &lt;/p&gt;&lt;p&gt;A brief aside into how security and performance is optimized: in conventional client-based RDP traffic, the client and server negotiate a TLS connection to secure and verify the session. However, because the browser WebSocket connection is already secured with TLS to Cloudflare, we employ IronRDPâs RDCleanPath protocol extension to eliminate this second encapsulation of traffic. Removing this redundancy avoids unnecessary performance degradation and increased complexity during session handshakes.&lt;/p&gt;&lt;h5&gt;The server&lt;/h5&gt;&lt;p&gt;The IronRDP client initiates a WebSocket connection to a dedicated WebSocket proxy, which is responsible for authenticating the client, terminating the WebSocket connection, and proxying tunneled RDP traffic deeper into Cloudflareâs infrastructure to facilitate connectivity. The seemingly simple task of determining how this WebSocket proxy should be built turned out to be the most challenging&lt;b&gt; &lt;/b&gt;decision in the development process.Â &lt;/p&gt;&lt;p&gt;Our initial proposal was to develop a new service that would run on every server within our network. While this was feasible, operating a new service would introduce a non-trivial maintenance burden, which ultimately turned out to be more overhead than value-add in this case. The next proposal was to build it into &lt;a href=\&quot;https://blog.cloudflare.com/upgrading-one-of-the-oldest-components-in-cloudflare-software-stack/\&quot;&gt;&lt;u&gt;Front Line&lt;/u&gt;&lt;/a&gt; (FL), one of Cloudflareâs oldest services that is responsible for handling tens of millions of HTTP requests per second. This approach would have sidestepped the need to expose new IP addresses and benefitted from the existing scaffolding to let the team move quickly. Despite being promising at first, this approach was decided against because FL is undergoing significant investment, and the team didn&amp;#39;t want to build on shifting sands.&lt;/p&gt;&lt;p&gt;Finally, we identified a solution that implements the proxy service using &lt;a href=\&quot;https://workers.cloudflare.com/\&quot;&gt;&lt;u&gt;Cloudflare Workers&lt;/u&gt;&lt;/a&gt;! Fortunately, Workers automatically scales to massive request rates, which eliminates some of the groundwork weâd lay if we had chosen to build a new service. Candidly, this approach was not initially preferred due to some ambiguities around how Workers communicates with internal Cloudflare services, but with support from the Workers team, we found a path forward.Â &lt;/p&gt;&lt;p&gt;From the WebSocket proxy Worker, the tunneled RDP connection is sent to the Apollo service, which is responsible for routing traffic between on-ramps and off-ramps for Cloudflare Zero Trust. Apollo centralizes and abstracts these complexities to let other services focus on application-specific functionality. Apollo determines which Cloudflare colo is closest to the target Cloudflare Tunnel and establishes a connection to an identical Apollo instance running in that colo. The egressing Apollo instance can then facilitate the final connection to the Cloudflare Tunnel. By using Cloudflare&amp;#39;s global network to traverse the distance between the ingress colo and the target Cloudflare Tunnel, network disruptions and congestion is managed.&lt;/p&gt;&lt;p&gt;Apollo connects to the RDP server and passes the ingress and egress connections to &lt;a href=\&quot;https://blog.cloudflare.com/from-ip-packets-to-http-the-many-faces-of-our-oxy-framework/\&quot;&gt;&lt;u&gt;Oxy&lt;/u&gt;&lt;/a&gt;-teams, the service responsible for inspecting and proxying the RDP traffic. It functions as a pass-through (strictly enabling traffic connectivity) as the web client authenticates to the RDP server. Our initial release makes use of &lt;a href=\&quot;https://learn.microsoft.com/en-us/windows-server/security/kerberos/ntlm-overview\&quot;&gt;&lt;u&gt;NT Lan Manager (NTLM)&lt;/u&gt;&lt;/a&gt; authentication, a challenge-response authentication protocol requiring username and password entry. Once the client has authenticated with the server, Oxy-teams is able to proxy all subsequent RDP traffic!&lt;/p&gt;&lt;p&gt;This may sound like a lot of hops, but every server in our network runs every service. So believe it or not, this complex dance takes place on a single server and by using UNIX domain sockets for communication, we also minimize any performance impact. If any of these servers become overloaded, experience a network fault, or have a hardware problem, the load is automatically shifted to a neighboring server with the help of &lt;a href=\&quot;https://blog.cloudflare.com/unimog-cloudflares-edge-load-balancer/\&quot;&gt;&lt;u&gt;Unimog&lt;/u&gt;&lt;/a&gt;, Cloudflareâs L4 load balancer.&lt;/p&gt;&lt;h4&gt;Putting it all together&lt;/h4&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;User initiation:&lt;/b&gt; The user selects an RDP server from Cloudflareâs &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/applications/app-launcher/\&quot;&gt;&lt;u&gt;App Launcher&lt;/u&gt;&lt;/a&gt; (or accesses it via a direct URL). Each RDP server is associated with a public hostname secured by Cloudflare.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Ingress:&lt;/b&gt; This request is received by the closest data center within &lt;a href=\&quot;https://www.cloudflare.com/network/\&quot;&gt;&lt;u&gt;Cloudflareâs network&lt;/u&gt;&lt;/a&gt;.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Authentication:&lt;/b&gt; Cloudflare Access authenticates the session by validating that the request contains a valid JWT. This token certifies that the user is authorized to access the selected RDP server through the specified domain.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Web client delivery:&lt;/b&gt; &lt;a href=\&quot;https://developers.cloudflare.com/workers/\&quot;&gt;&lt;u&gt;Cloudflare Workers&lt;/u&gt;&lt;/a&gt; serves the IronRDP web client to the userâs browser.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Secure tunneling:&lt;/b&gt; The client tunnels RDP traffic from the userâs browser over a TLS-secured WebSocket to another Cloudflare Worker.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Traffic routing:&lt;/b&gt; The Worker that receives the IronRDP connection terminates the WebSocket and initiates a connection to &lt;a href=\&quot;https://blog.cloudflare.com/extending-local-traffic-management-load-balancing-to-layer-4-with-spectrum/#how-we-enabled-spectrum-to-support-private-networks\&quot;&gt;&lt;u&gt;Apollo&lt;/u&gt;&lt;/a&gt;. From there, Apollo creates a connection to the RDP server.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Authentication relay:&lt;/b&gt; With a connection established, Apollo relays RDP authentication messages between the web client and the RDP server.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Connection establishment:&lt;/b&gt; Upon successful authentication, Cloudflare serves as an RDP proxy between the web browser and the RDP server, connecting the user to the RDP server with free-flowing traffic.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Policy enforcement:&lt;/b&gt; Cloudflare&amp;#39;s secure web gateway, &lt;a href=\&quot;https://blog.cloudflare.com/from-ip-packets-to-http-the-many-faces-of-our-oxy-framework/\&quot;&gt;&lt;u&gt;Oxy&lt;/u&gt;&lt;/a&gt;-teams, applies Layer 4 policy enforcement and logging of the RDP traffic. &lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2wWryOYY69cHw5cDmQHAqi/cb40a492b1e194cd572018eb4a5792ba/3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1329\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Key benefits of this architecture:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;No additional software:&lt;/b&gt; Access Windows servers directly from a browser.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Low latency:&lt;/b&gt; Cloudflareâs global network minimizes performance overhead.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Enhanced security:&lt;/b&gt; RDP access is protected by Access policies, preventing lateral movement.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Integrated logging and monitoring:&lt;/b&gt; Administrators can observe and control RDP traffic.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;To learn more about Cloudflare&amp;#39;s proxy capabilities, take a look at our &lt;a href=\&quot;https://blog.cloudflare.com/introducing-oxy/\&quot;&gt;&lt;u&gt;related blog post&lt;/u&gt;&lt;/a&gt; explaining our proxy framework.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;selective-modern-rdp-authentication\&quot;&gt;Selective, modern RDP authentication&lt;/h3&gt;\n            &lt;a href=\&quot;#selective-modern-rdp-authentication\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Cloudflareâs browser-based RDP solution exclusively supports modern RDP authentication mechanisms, enforcing best practices for secure access. Our architecture ensures that RDP traffic using outdated or weak legacy security features from older versions of the RDP standard, such as unsecured password-based authentication or RC4 encryption, are never allowed to reach customer endpoints.&lt;/p&gt;&lt;p&gt;Cloudflare supports secure session negotiation using the following principles:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;TLS-based WebSocket connection for transport security.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Fine-grained policies that enforce single sign on (SSO), multi-factor authentication (MFA), and dynamic authorization.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Integration with enterprise identity providers via SAML (Security Assertion Markup Language) and OIDC (OpenID Connect).&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Every RDP session that passes through Cloudflareâs network is encrypted and authenticated.&lt;/p&gt;&lt;h4&gt;Whatâs next?Â &lt;/h4&gt;&lt;p&gt;This is only the beginning for our browser-based RDP solution! We have already identified a few areas for continued focus:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Enhanced visibility and control for administrators:&lt;/b&gt; Because RDP traffic passes through Cloudflare Workers and proxy services, browser-based RDP will expand to include session monitoring. We are also evaluating data loss prevention (DLP) support, such as restricting actions like file transfers and clipboard use, to prevent unauthorized data exfiltration without compromising performance.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Advanced authentication:&lt;/b&gt; Long-lived credentials are a thing of the past. Future iterations of browser-based RDP will include passwordless functionality, eliminating the need for end users to remember passwords and administrators from having to manage them. To that end, we are evaluating methods such as client certificate authentication, passkeys and smart cards, and integration with third-party authentication providers via Access.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h5&gt;Compliance and FedRAMP High certification&lt;/h5&gt;&lt;p&gt;We plan to include browser-based RDP in our FedRAMP High offering for enterprise and government organizations, a high-priority initiative &lt;a href=\&quot;https://blog.cloudflare.com/cloudflares-commitment-to-advancing-public-sector-security-worldwide/\&quot;&gt;&lt;u&gt;we announced in early February&lt;/u&gt;&lt;/a&gt;. This certification will validate that our solution meets the highest standards for:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Data protection&lt;/b&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Identity and access management&lt;/b&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Continuous monitoring&lt;/b&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Incident response&lt;/b&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Seeking FedRAMP High compliance demonstrates Cloudflareâs commitment to securing sensitive environments, such as those in the federal government, healthcare, and financial sectors.&lt;/p&gt;&lt;p&gt;By enforcing a modern, opinionated, and secure implementation of RDP, Cloudflare provides a secure, scalable, and compliant solution tailored to the needs of organizations with critical security and compliance mandates.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;get-started-today\&quot;&gt;Get started today&lt;/h3&gt;\n            &lt;a href=\&quot;#get-started-today\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;At Cloudflare, we are committed to providing the most comprehensive solution for ZTNA, which now also includes privileged access to sensitive infrastructure like Windows servers over browser-based RDP. Cloudflareâs browser-based RDP solution is in closed beta with new customers being onboarded each week. You can &lt;a href=\&quot;http://www.cloudflare.com/lp/browser-based-rdp-beta\&quot;&gt;&lt;u&gt;request access here&lt;/u&gt;&lt;/a&gt; to try out this exciting new feature.&lt;/p&gt;&lt;p&gt;In the meantime, check out our&lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/applications/non-http/infrastructure-apps/\&quot;&gt; &lt;u&gt;Access for Infrastructure&lt;/u&gt;&lt;/a&gt; documentation to learn more about how Cloudflare protects privileged access to sensitive infrastructure. Access for Infrastructure is currently &lt;a href=\&quot;https://dash.cloudflare.com/sign-up/teams\&quot;&gt;&lt;u&gt;available free&lt;/u&gt;&lt;/a&gt; to teams of under 50 users, and at no extra cost to existing pay-as-you-go and Contract plan customers through an Access or Zero Trust subscription. Stay tuned as we continue to natively rebuild BastionZeroâs technology into Cloudflareâs Access for Infrastructure service!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-21T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-21T13:00:02.798Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3tAU6bDy8dl7yw6ZfAo7rD/6fd219daec1ebd50cf8d0d3692cee6d1/Feature_Image.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;J61Eszqn98amrYHq4IhTx&quot;],&quot;name&quot;:[0,&quot;Zero Trust&quot;],&quot;slug&quot;:[0,&quot;zero-trust&quot;]}],[0,{&quot;id&quot;:[0,&quot;3QNaVNNpUXrfZYUGDJkXwA&quot;],&quot;name&quot;:[0,&quot;Cloudflare Zero Trust&quot;],&quot;slug&quot;:[0,&quot;cloudflare-zero-trust&quot;]}],[0,{&quot;id&quot;:[0,&quot;013htAspXBEMdE76Afcyq2&quot;],&quot;name&quot;:[0,&quot;Acquisitions&quot;],&quot;slug&quot;:[0,&quot;acquisitions&quot;]}],[0,{&quot;id&quot;:[0,&quot;6c9EM6c5poinGKIR6xldFo&quot;],&quot;name&quot;:[0,&quot;Cloudflare Access&quot;],&quot;slug&quot;:[0,&quot;cloudflare-access&quot;]}],[0,{&quot;id&quot;:[0,&quot;4Z2oveL0P0AeqGa5lL4Vo1&quot;],&quot;name&quot;:[0,&quot;Cloudflare One&quot;],&quot;slug&quot;:[0,&quot;cloudflare-one&quot;]}],[0,{&quot;id&quot;:[0,&quot;508ajJjUtcMvqh0DBTVGnj&quot;],&quot;name&quot;:[0,&quot;Clientless&quot;],&quot;slug&quot;:[0,&quot;clientless&quot;]}],[0,{&quot;id&quot;:[0,&quot;4rwRlSjN0fZqSYXtCZOZzJ&quot;],&quot;name&quot;:[0,&quot;Remote Work&quot;],&quot;slug&quot;:[0,&quot;remote-work&quot;]}],[0,{&quot;id&quot;:[0,&quot;MWg8pYtDEfKC5nihhDVr9&quot;],&quot;name&quot;:[0,&quot;VDI&quot;],&quot;slug&quot;:[0,&quot;vdi&quot;]}],[0,{&quot;id&quot;:[0,&quot;1KluW2e7pyQ2X59tLBc9RZ&quot;],&quot;name&quot;:[0,&quot;Remote Desktop Protocol &quot;],&quot;slug&quot;:[0,&quot;remote-desktop-protocol&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Ann Ming Samborski&quot;],&quot;slug&quot;:[0,&quot;ann-ming-samborski&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4K0P5wAoqGbOXiq1av6lQG/79f00a158601cad50455f23a261c6c7f/headshot-small.png&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Gabriel Bauman&quot;],&quot;slug&quot;:[0,&quot;gabriel-bauman&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3GGh9AUKMzqkSZpci47jXy/ef54eb6177bdf0d7d497190b92aa5690/Gabriel_Bauman.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Athanasios Filippidis&quot;],&quot;slug&quot;:[0,&quot;athanasios-filippidis&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2cYSRCVcHmhtMCktLP6Ceb/2461df185c5d34cd63c28eb03678ace9/Athanasios_Filippidis.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Mike Borkenstein&quot;],&quot;slug&quot;:[0,&quot;michael-borkenstein&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3n0fzvK63yHIcJGPKmmsHz/d902dd741c0aa0a7ef0121e67c3533ea/michael-borkenstein.JPG&quot;],&quot;location&quot;:[0,&quot;Austin, TX&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflare now provides clientless, browser-based support for the Remote Desktop Protocol (RDP). It natively enables secure, remote Windows server access without VPNs or RDP clients, to support third-party access and BYOD security.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/browser-based-rdp&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;RDP without the risk: Cloudflare&#39;s browser-based solution for secure third-party access&quot;],&quot;description&quot;:[0,&quot;Cloudflare now provides clientless, browser-based support for the Remote Desktop Protocol (RDP). It natively enables secure, remote Windows server access without VPNs or RDP clients, to support third-party access and BYOD security.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6CTftkXBXkAOYfZE6LTJfT/af1e09c686ff9621dcb0699314149fa3/OG_Share_2024__22_.png&quot;]}]}],[0,{&quot;id&quot;:[0,&quot;qBn1L12sUXNIbkTPY5HyK&quot;],&quot;title&quot;:[0,&quot;Improving Data Loss Prevention accuracy with AI-powered context analysis&quot;],&quot;slug&quot;:[0,&quot;improving-data-loss-prevention-accuracy-with-ai-context-analysis&quot;],&quot;excerpt&quot;:[0,&quot;Cloudflareâs Data Loss Prevention is reducing false positives by using a self-improving AI-powered algorithm, built on Cloudflareâs Developer Platform.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;We are excited to announce our latest innovation to Cloudflareâs &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/products/dlp/\&quot;&gt;&lt;u&gt;Data Loss Prevention&lt;/u&gt;&lt;/a&gt; (DLP) solution: a self-improving AI-powered algorithm that adapts to your organizationâs unique traffic patterns to reduce false positives.Â &lt;/p&gt;&lt;p&gt;Many customers are plagued by the shapeshifting task of identifying and protecting their sensitive data as it moves within and even outside of their organization. Detecting this data through deterministic means, such as regular expressions, often fails because they cannot identify details that are categorized as personally identifiable information (PII) nor intellectual property (IP). This can generate a high rate of false positives, which contributes to noisy alerts that subsequently may lead to review fatigue. Even more critically, this less than ideal experience can turn users away from relying on our DLP product and result in a reduction in their overall security posture.Â &lt;/p&gt;&lt;p&gt;Built into Cloudflareâs DLP Engine, AI enables us to intelligently assess the contents of a document or HTTP request in parallel with a customerâs historical reports to determine context similarity and draw conclusions on data sensitivity with increased accuracy.&lt;/p&gt;&lt;p&gt;In this blog post, weâll explore &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/policies/data-loss-prevention/dlp-profiles/advanced-settings/\&quot;&gt;&lt;u&gt;DLP AI Context Analysis&lt;/u&gt;&lt;/a&gt;, its implementation using &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/workers-ai/\&quot;&gt;&lt;u&gt;Workers AI&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/vectorize/\&quot;&gt;&lt;u&gt;Vectorize&lt;/u&gt;&lt;/a&gt;, and future improvements weâre developing.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;understanding-false-positives-and-their-impact-on-user-confidence\&quot;&gt;Understanding false positives and their impact on user confidence&lt;/h3&gt;\n            &lt;a href=\&quot;#understanding-false-positives-and-their-impact-on-user-confidence\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Data Loss Prevention (DLP) at Cloudflare detects sensitive information by scanning potential sources of data leakage across various channels such as web, cloud, email, and SaaS applications. While we leverage several detection methods, pattern-based methods like regular expressions play a key role in our approach. This method is effective for many types of sensitive data. However, certain information can be challenging to classify solely through patterns. For instance, U.S. Social Security Numbers (SSNs), structured as &lt;a href=\&quot;https://en.wikipedia.org/wiki/Social_Security_number#Structure\&quot;&gt;&lt;u&gt;AAA-GG-SSSS&lt;/u&gt;&lt;/a&gt;, sometimes with dashes omitted, are often confused with other similarly formatted data, such as U.S. taxpayer identification numbers, bank account numbers, or phone numbers.Â &lt;/p&gt;&lt;p&gt;Since &lt;a href=\&quot;https://blog.cloudflare.com/inline-data-loss-prevention/\&quot;&gt;&lt;u&gt;announcing&lt;/u&gt;&lt;/a&gt; our DLP product, we have introduced new capabilities like &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/policies/data-loss-prevention/dlp-profiles/advanced-settings/#confidence-levels\&quot;&gt;&lt;u&gt;confidence thresholds&lt;/u&gt;&lt;/a&gt; to reduce the number of false positives users receive. This method involves examining the surrounding context of a pattern match to assess Cloudflareâs confidence in its accuracy. With confidence thresholds, users specify a threshold (low, medium, or high) to signify a preference for how tolerant detections are to false positives. DLP uses the chosen threshold as a minimum, surfacing only those detections with a confidence score that meets or exceeds the specified threshold.Â Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1EOKyJisPTPWcSOep9Se7F/22c1bf40cbd0d698b0e24095826548cd/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1628\&quot; height=\&quot;866\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;However, implementing context analysis is also not a trivial task. A straightforward approach might involve looking for specific keywords near the matched pattern, such as &amp;quot;SSN&amp;quot; near a potential SSN match, but this method has its limitations. Keyword lists are often incomplete, users may make typographical errors, and many true positives do not have any identifying keywords nearby (e.g., bank accounts near routing numbers or SSNs near names).&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;leveraging-ai-ml-for-enhanced-detection-accuracy\&quot;&gt;Leveraging AI/ML for enhanced detection accuracy&lt;/h3&gt;\n            &lt;a href=\&quot;#leveraging-ai-ml-for-enhanced-detection-accuracy\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;To address the limitations of a hardcoded strategy for context analysis, we have developed a dynamic, self-improving algorithm that learns from customer feedback to further improve their future experience. Each time a customer reports a false positive via &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/policies/data-loss-prevention/dlp-policies/logging-options/#4-view-payload-logs\&quot;&gt;&lt;u&gt;decrypted payload logs&lt;/u&gt;&lt;/a&gt;, the system reduces its future confidence for hits in similar contexts. Conversely, reports of true positives increase the system&amp;#39;s confidence for hits in similar contexts.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4h84zJ0SNtfhTVGzwxVyk0/bbdcce73d4538619abb296617d793bff/2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;946\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;To determine context similarity, we leverage Workers AI. Specifically, &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/models/bge-base-en-v1.5/\&quot;&gt;&lt;u&gt;a pretrained language model&lt;/u&gt;&lt;/a&gt; that converts the text into a high-dimensional vector (i.e. text embedding). These embeddings capture the meaning of the text, ensuring that two sentences with the same meaning but different wording map to vectors that are close to each other.Â &lt;/p&gt;&lt;p&gt;When a pattern match is detected, the system uses the AI model to compute the embedding of the surrounding context. It then performs a nearest neighbor search to find previously logged false or true positives with similar meanings. This allows the system to identify context similarities even if the exact wording differs, but the meaning remains the same.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/z8yLmrAXES70MzTn2GdQE/0845b35884535843fa01e4f1a92a3f41/3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;795\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In our experiments using Cloudflare employee traffic, this approach has proven robust, effectively handling new pattern matches it hadn&amp;#39;t encountered before. When the DLP admin reports false and true positives through the Cloudflare dashboard while viewing the payload log of a &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/policies/data-loss-prevention/dlp-policies/\&quot;&gt;&lt;u&gt;policy&lt;/u&gt;&lt;/a&gt; match, it helps DLP continue to improve, leading to a significant reduction in false positives over time.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;seamless-integration-with-workers-ai-and-vectorize\&quot;&gt;Seamless integration with Workers AI and Vectorize&lt;/h3&gt;\n            &lt;a href=\&quot;#seamless-integration-with-workers-ai-and-vectorize\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In developing this new feature, we used components from Cloudflare&amp;#39;s developer platform â &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/\&quot;&gt;&lt;u&gt;Workers AI&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/vectorize/\&quot;&gt;&lt;u&gt;Vectorize&lt;/u&gt;&lt;/a&gt; â which helps simplify our design. Instead of managing the underlying infrastructure ourselves, we leveraged &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/workers/\&quot;&gt;&lt;u&gt;Cloudflare Workers&lt;/u&gt;&lt;/a&gt; as the foundation, using Workers AI for text embedding, and Vectorize as the vector database. This setup allows us to focus on the algorithm itself without the overhead of provisioning underlying resources.Â Â &lt;/p&gt;&lt;p&gt;Thanks to Workers AI, converting text into embeddings couldnât be easier. With just a single line of code we can transform any text into its corresponding vector representation.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const result = await env.AI.run(model, {text: [text]}).data;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This handles everything from tokenization to GPU-powered inference, making the process both simple and scalable.&lt;/p&gt;&lt;p&gt;The nearest neighbor search is equally straightforward. After obtaining the vector from Workers AI, we use Vectorize to quickly find similar contexts from past reports. In the meantime, we store the vector for the current pattern match in Vectorize, allowing us to learn from future feedback.Â &lt;/p&gt;&lt;p&gt;To optimize resource usage, weâve incorporated a few more clever techniques. For example, instead of storing every vector from pattern hits, we use online clustering to group vectors into clusters and store only the cluster centroids along with counters for tracking hits and reports. This reduces storage needs and speeds up searches. Additionally, weâve integrated &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/cloudflare-queues/\&quot;&gt;&lt;u&gt;Cloudflare Queues&lt;/u&gt;&lt;/a&gt; to separate the indexing process from the DLP scanning hot path, ensuring a robust and responsive system.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6e6krasQ5t5ekp1TK0kJ0A/414f74fd48ef10a16e369775ead189b7/4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;981\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Privacy is a top priority. We redact any matched text before conversion to embeddings, and all vectors and reports are stored in customer-specific private namespaces across &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/vectorize/\&quot;&gt;&lt;u&gt;Vectorize&lt;/u&gt;&lt;/a&gt;, &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/d1/\&quot;&gt;&lt;u&gt;D1&lt;/u&gt;&lt;/a&gt;, and &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/workers-kv/\&quot;&gt;&lt;u&gt;Workers KV&lt;/u&gt;&lt;/a&gt;. This means each customerâs learning process is independent and secure. In addition, we implement data retention policies so that vectors that have not been accessed or referenced within 60 days are automatically removed from our system.Â Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;limitations-and-continuous-improvements\&quot;&gt;Limitations and continuous improvements&lt;/h3&gt;\n            &lt;a href=\&quot;#limitations-and-continuous-improvements\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;AI-driven context analysis significantly improves the accuracy of our detections. However, this comes at the cost of some increase in latency for the end user experience.Â  For requests that do not match any enabled DLP entries, there will be no latency increase.Â  However, requests that match an enabled entry in a profile with AI context analysis enabled will typically experience an increase in latency of about 400ms. In rare extreme cases, for example requests that match multiple entries, that latency increase could be as high as 1.5 seconds. We are actively working to drive the latency down, ideally to a typical increase of 250ms or better.Â &lt;/p&gt;&lt;p&gt;Another limitation is that the current implementation supports English exclusively because of our choice of the language model. However, Workers AI is developing a multilingual model which will enable DLP to increase support across different regions and languages.&lt;/p&gt;&lt;p&gt;Looking ahead, we also aim to enhance the transparency of AI context analysis. Currently, users have no visibility on how the decisions are made based on their past false and true positive reports. We plan to develop tools and interfaces that provide more insight into how confidence scores are calculated, making the system more explainable and user-friendly.Â Â &lt;/p&gt;&lt;p&gt;With this launch, AI context analysis is only available for Gateway HTTP traffic. By the end of 2025, AI context analysis will be available in both &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/products/casb/\&quot;&gt;&lt;u&gt;CASB&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/products/email-security/\&quot;&gt;&lt;u&gt;Email Security&lt;/u&gt;&lt;/a&gt; so that customers receive the same AI enhancements across their entire data landscape.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;unlock-the-benefits-start-using-ai-powered-detection-features-today\&quot;&gt;Unlock the benefits: start using AI-powered detection features today&lt;/h3&gt;\n            &lt;a href=\&quot;#unlock-the-benefits-start-using-ai-powered-detection-features-today\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;DLPâs AI context analysis is in closed beta. Sign up &lt;a href=\&quot;https://www.cloudflare.com/lp/dlp-ai-context-analysis/\&quot;&gt;&lt;u&gt;here&lt;/u&gt;&lt;/a&gt; for early access to experience immediate improvements to your DLP HTTP traffic matches. More updates are coming soon as we approach general availability!&lt;/p&gt;&lt;p&gt;To get access to DLP via Cloudflare One, contact your account manager.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-21T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-21T13:00:03.555Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7k1jqytoKrUA4FF4ivwLvy/ddf9a33f4722a915b9ae51095cfde33a/Feature_Image.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;J61Eszqn98amrYHq4IhTx&quot;],&quot;name&quot;:[0,&quot;Zero Trust&quot;],&quot;slug&quot;:[0,&quot;zero-trust&quot;]}],[0,{&quot;id&quot;:[0,&quot;4yBlHkuMJq9VSFd341CkxY&quot;],&quot;name&quot;:[0,&quot;DLP&quot;],&quot;slug&quot;:[0,&quot;dlp&quot;]}],[0,{&quot;id&quot;:[0,&quot;2UI24t7uddD0CIIUJCu1f4&quot;],&quot;name&quot;:[0,&quot;SASE&quot;],&quot;slug&quot;:[0,&quot;sase&quot;]}],[0,{&quot;id&quot;:[0,&quot;6l7hyMgGAf9GhOz3E7MNxh&quot;],&quot;name&quot;:[0,&quot;Data Protection&quot;],&quot;slug&quot;:[0,&quot;data-protection&quot;]}],[0,{&quot;id&quot;:[0,&quot;4Z2oveL0P0AeqGa5lL4Vo1&quot;],&quot;name&quot;:[0,&quot;Cloudflare One&quot;],&quot;slug&quot;:[0,&quot;cloudflare-one&quot;]}],[0,{&quot;id&quot;:[0,&quot;1Wf1Dpb2AFicG44jpRT29y&quot;],&quot;name&quot;:[0,&quot;Workers AI&quot;],&quot;slug&quot;:[0,&quot;workers-ai&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Warnessa Weaver&quot;],&quot;slug&quot;:[0,&quot;warnessa-weaver&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5MqbUUVujPmYlSKnjtuH7g/285e845343651fb875097ade26346ebf/_tmp_mini_magick20231208-2-1rx6cqm.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Tom Shen&quot;],&quot;slug&quot;:[0,&quot;tom-shen&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/e0rSZrw05SKGlLQ3lRzfO/baca2afabcc0fb0cd1f22d9da9cb3770/Tom_Shen.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Joshua Johnson&quot;],&quot;slug&quot;:[0,&quot;joshua-johnson&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/18NCR3dW2lVfMZmp51xguR/e3cd69751dd3b327c8a98794f4809ca6/joshua-johnson.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,&quot;https://www.linkedin.com/in/joshua-johnson-04418182/&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflareâs Data Loss Prevention is reducing false positives by using a self-improving AI-powered algorithm, built on Cloudflareâs Developer Platform, to improve detection accuracy through AI context analysis.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/improving-data-loss-prevention-accuracy-with-ai-context-analysis&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Improving Data Loss Prevention accuracy with AI-powered context analysis&quot;],&quot;description&quot;:[0,&quot;Cloudflareâs Data Loss Prevention is reducing false positives by using a self-improving AI-powered algorithm, built on Cloudflareâs Developer Platform, to improve detection accuracy through AI context analysis.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3lPS0SwIYd8olZ6LylEllW/e14a79518af9464962710e80ffb24832/OG_Share_2024__25_.png&quot;]}]}],[0,{&quot;id&quot;:[0,&quot;01euRoOpkvsq16eKrMZ6hu&quot;],&quot;title&quot;:[0,&quot;Prepping for post-quantum: a beginnerâs guide to lattice cryptography&quot;],&quot;slug&quot;:[0,&quot;lattice-crypto-primer&quot;],&quot;excerpt&quot;:[0,&quot;This post is a beginner&#39;s guide to lattices, the math at the heart of the transition to post-quantum (PQ) cryptography. It explains how to do lattice-based encryption and authentication from scratch.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;The cryptography that secures the Internet is evolving, and it&amp;#39;s time to catch up. This post is a tutorial on lattice cryptography, the paradigm at the heart of the post-quantum (PQ) transition.&lt;/p&gt;&lt;p&gt;Twelve years ago (in 2013), the &lt;a href=\&quot;https://en.wikipedia.org/wiki/Edward_Snowden\&quot;&gt;&lt;u&gt;revelation of mass surveillance in the US&lt;/u&gt;&lt;/a&gt; kicked off the widespread adoption of &lt;a href=\&quot;https://en.wikipedia.org/wiki/Transport_Layer_Security\&quot;&gt;&lt;u&gt;TLS&lt;/u&gt;&lt;/a&gt; for encryption and authentication on the web. This transition was buoyed by the standardization and implementation of new, more efficient public-key cryptography based on &lt;a href=\&quot;https://blog.cloudflare.com/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/\&quot;&gt;&lt;u&gt;elliptic curves&lt;/u&gt;&lt;/a&gt;. Elliptic curve cryptography was both faster and required less communication than its predecessors, including &lt;a href=\&quot;https://en.wikipedia.org/wiki/RSA_(cryptosystem)\&quot;&gt;&lt;u&gt;RSA&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange\&quot;&gt;&lt;u&gt;Diffie-Hellman&lt;/u&gt;&lt;/a&gt; over finite fields.&lt;/p&gt;&lt;p&gt;Today&amp;#39;s transition to &lt;a href=\&quot;https://blog.cloudflare.com/pq-2024/\&quot;&gt;&lt;u&gt;PQ cryptography&lt;/u&gt;&lt;/a&gt; addresses a looming threat for TLS and beyond: once built, a sufficiently large quantum computer can be used to break all public-key cryptography in use today. And we continue to see &lt;a href=\&quot;https://blog.google/technology/research/google-willow-quantum-chip/\&quot;&gt;&lt;u&gt;advancements&lt;/u&gt;&lt;/a&gt; in quantum-computer engineering that bring us closer to this threat becoming a reality.&lt;/p&gt;&lt;p&gt;Fortunately, this transition is well underway. The research and standards communities have spent the last several years developing alternatives that resist quantum cryptanalysis. For its part, Cloudflare has contributed to this process and is an early adopter of newly developed schemes. In fact, PQ encryption has been available at our edge &lt;a href=\&quot;https://blog.cloudflare.com/post-quantum-for-all/\&quot;&gt;&lt;u&gt;since 2022&lt;/u&gt;&lt;/a&gt; and is &lt;a href=\&quot;https://radar.cloudflare.com/adoption-and-usage#post-quantum-encryption-adoption\&quot;&gt;&lt;u&gt;used in over 35% of non-automated HTTPS traffic today (2025)&lt;/u&gt;&lt;/a&gt;. And this year we&amp;#39;re beginning a major push towards PQ authentication for the TLS ecosystem.&lt;/p&gt;&lt;p&gt;Lattice-based cryptography is the first paradigm that will replace &lt;a href=\&quot;https://blog.cloudflare.com/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/\&quot;&gt;&lt;u&gt;elliptic curves&lt;/u&gt;&lt;/a&gt;. Apart from being PQ secure, lattices are often as fast, and sometimes faster, in terms of CPU time. However, this new paradigm for public key crypto has one major cost: &lt;b&gt;lattices require much more communication than elliptic curves.&lt;/b&gt; For example, establishing an encryption key using lattices requires 2272 bytes of communication between the client and the server (&lt;a href=\&quot;https://csrc.nist.gov/pubs/fips/203/final\&quot;&gt;&lt;u&gt;ML-KEM-768&lt;/u&gt;&lt;/a&gt;), compared to just 64 bytes for a key exchange using a modern elliptic-curve-based scheme (&lt;a href=\&quot;https://datatracker.ietf.org/doc/html/rfc7748\&quot;&gt;&lt;u&gt;X25519&lt;/u&gt;&lt;/a&gt;). Accommodating such costs requires a significant amount of engineering, from dealing with &lt;a href=\&quot;https://blog.cloudflare.com/sizing-up-post-quantum-signatures/\&quot;&gt;&lt;u&gt;TCP packet fragmentation&lt;/u&gt;&lt;/a&gt;, to reworking &lt;a href=\&quot;https://blog.cloudflare.com/pq-2024/#two-migrations\&quot;&gt;&lt;u&gt;TLS and its public key infrastructure&lt;/u&gt;&lt;/a&gt;. Thus, the PQ transition is going to require the participation of a large number of people with a variety of backgrounds, not just cryptographers.&lt;/p&gt;&lt;p&gt;The primary audience for this blog post is those who find themselves involved in the PQ transition and want to better understand what&amp;#39;s going on under the hood. However, more fundamentally, we think it&amp;#39;s important for everyone to understand lattice cryptography on some level, especially if we&amp;#39;re going to trust it for our security and privacy.&lt;/p&gt;&lt;p&gt;We&amp;#39;ll assume you have a software-engineering background and some familiarity with concepts like TLS, encryption, and authentication. We&amp;#39;ll see that the math behind lattice cryptography is, at least at the highest level, not difficult to grasp. Readers with a crypto-engineering background who want to go deeper might want to start with the excellent &lt;a href=\&quot;https://eprint.iacr.org/2024/1287\&quot;&gt;&lt;u&gt;tutorial by Vadim Lyubashevsky&lt;/u&gt;&lt;/a&gt; on which this blog post is based. We also recommend &lt;a href=\&quot;https://keymaterial.net/2023/09/01/learning-but-with-errors/\&quot;&gt;&lt;u&gt;Sophie Schmieg&amp;#39;s blog&lt;/u&gt;&lt;/a&gt; on this subject.&lt;/p&gt;&lt;p&gt;While the transition to lattice cryptography incurs costs, it also creates opportunities. Many things we can build with elliptic curves we can also build with lattices, though not always as efficiently; but there are also things we can do with lattices that we don&amp;#39;t know how to do efficiently with anything else. We&amp;#39;ll touch on some of these applications at the very end.&lt;/p&gt;&lt;p&gt;We&amp;#39;re going to cover a lot of ground in this post. If you stick with it, we hope you&amp;#39;ll come away feeling empowered, not only to tackle the engineering challenges the PQ transition entails, but to solve problems you didn&amp;#39;t know how to solve before.&lt;/p&gt;&lt;p&gt;Strap in â let&amp;#39;s have some fun!&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;encryption\&quot;&gt;Encryption&lt;/h3&gt;\n            &lt;a href=\&quot;#encryption\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The most pressing problem for the PQ transition is to ensure that tomorrow&amp;#39;s quantum computers don&amp;#39;t break today&amp;#39;s encryption. An attacker today can store the packets exchanged between your laptop and a website you visit, and then, some time in the future, decrypt those packets with the help of a quantum computer. This means that much of the sensitive information transiting the Internet today â everything from &lt;a href=\&quot;https://blog.cloudflare.com/https-only-for-cloudflare-apis-shutting-the-door-on-cleartext-traffic/\&quot;&gt;&lt;u&gt;API tokens&lt;/u&gt;&lt;/a&gt; and passwords to database encryption keys â may one day be unlocked by a quantum computer.&lt;/p&gt;&lt;p&gt;In fact, today&amp;#39;s encryption in TLS is &lt;i&gt;mostly&lt;/i&gt; PQ secure: &lt;b&gt;what&amp;#39;s at risk is the process by which your browser and a server establish an encryption key&lt;/b&gt;. Today this is usually done with elliptic-curve-based schemes, which are not PQ secure; our goal for this section is to understand how to do key exchange with lattices-based schemes, which are.&lt;/p&gt;&lt;p&gt;We will work through and implement a simplified version of &lt;a href=\&quot;https://csrc.nist.gov/pubs/fips/203/final\&quot;&gt;&lt;u&gt;ML-KEM&lt;/u&gt;&lt;/a&gt;, a.k.a. Kyber, the most widely deployed PQ key exchange in use today. Our code will be less efficient and secure than a &lt;a href=\&quot;https://pkg.go.dev/github.com/cloudflare/circl@v1.6.0/kem/mlkem\&quot;&gt;&lt;u&gt;spec-compliant, production-quality implementation&lt;/u&gt;&lt;/a&gt;, but will be good enough to grasp the main ideas.&lt;/p&gt;&lt;p&gt;Our starting point is a protocol that looks an awful lot like &lt;a href=\&quot;https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange\&quot;&gt;&lt;u&gt;Diffie-Hellman (DH)&lt;/u&gt;&lt;/a&gt; key exchange. For those readers unacquainted with DH, the goal is for Alice and Bob to establish a shared secret over an insecure network. To do so, each picks a random secret number, computes the corresponding &amp;quot;key share&amp;quot;, and sends the key share to the other:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5yWJO1Sem97PfhwqiKZRLm/bfacc44ca4f7187f4212b7b4616dd86d/image7.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1220\&quot; height=\&quot;693\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Alice&amp;#39;s secret number is $s$ and her key share is $g^s$; Bob&amp;#39;s secret number is $r$ and his key share is $g^r$. Then given their secret and their peer&amp;#39;s key share, each can compute $g^{rs}$. The security of this protocol comes from how we choose $g$, $s$, and $r$ and how we do arithmetic. The most efficient instantiation of DH uses elliptic curves.&lt;/p&gt;&lt;p&gt;In ML-KEM we replace operations on elliptic curves with &lt;b&gt;matrix &lt;/b&gt;operations. It&amp;#39;s not quite a drop-in replacement, so we&amp;#39;ll need a little linear algebra to make sense of it. But don&amp;#39;t worry: we&amp;#39;re going to work with Python so we have running code to play with, and we&amp;#39;ll use &lt;a href=\&quot;https://numpy.org/\&quot;&gt;&lt;u&gt;NumPy&lt;/u&gt;&lt;/a&gt; to keep things high level.&lt;/p&gt;&lt;h4&gt;All the math we&amp;#39;ll need&lt;/h4&gt;&lt;p&gt;A matrix is just a two-dimensional array of numbers. In NumPy, we can create a matrix as follows (importing &lt;code&gt;numpy&lt;/code&gt; as &lt;code&gt;np&lt;/code&gt;):&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;A = np.matrix([[1, 2, 3],\n               [4, 5, 6],\n               [7, 8, 9]])&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This defines &lt;code&gt;A&lt;/code&gt; to be the &lt;code&gt;3&lt;/code&gt;-by-&lt;code&gt;3&lt;/code&gt; matrix with entries &lt;code&gt;A[0,0]==1, A[0,1]==2, A[0,2]==3, A[1,0]==4&lt;/code&gt;, and so on.&lt;/p&gt;&lt;p&gt;For the purposes of this post, the entries of our matrices will always be integers. Furthermore, whenever we add, subtract, or multiply two integers, we then &lt;b&gt;reduce&lt;/b&gt; the result, just like we do with hours on a clock, so that we end up with a number in &lt;code&gt;range(Q)&lt;/code&gt; for some positive number &lt;code&gt;Q&lt;/code&gt;, called the modulus. The exact value doesnât really matter now, but for ML-KEM itâs &lt;code&gt;Q=3329&lt;/code&gt;, so let&amp;#39;s go with that for now. (The modulus for a clock would be &lt;code&gt;Q=12&lt;/code&gt;.)&lt;/p&gt;&lt;p&gt;In Python, we write multiplication of integers &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;b&lt;/code&gt; modulo &lt;code&gt;Q&lt;/code&gt; as&lt;code&gt; c = a*b % Q&lt;/code&gt;. Here we compute &lt;code&gt;a*b&lt;/code&gt;, divide the result by &lt;code&gt;Q&lt;/code&gt;, then set &lt;code&gt;c&lt;/code&gt; to the remainder. For example, &lt;code&gt;42*1337&lt;/code&gt; &lt;code&gt;% Q&lt;/code&gt; is equal to &lt;code&gt;2890&lt;/code&gt; rather than &lt;code&gt;56154&lt;/code&gt;. Modular addition and subtraction are done analogously. For the rest of this blog, we will sometimes omit &amp;quot;&lt;code&gt;% Q&lt;/code&gt;&amp;quot; when it&amp;#39;s clear in context that we mean modular arithmetic.&lt;/p&gt;&lt;p&gt;Next, we&amp;#39;ll need three operations on matrices.&lt;/p&gt;&lt;p&gt;The first is &lt;b&gt;matrix transpose&lt;/b&gt;, written &lt;code&gt;A.T &lt;/code&gt;in NumPy. This operation flips the matrix along its diagonal so that &lt;code&gt;A.T[j,i] == A[i,j]&lt;/code&gt; for all rows &lt;code&gt;i&lt;/code&gt; and columns &lt;code&gt;j&lt;/code&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;print(A.T)\n# [[1 4 7]\n#  [2 5 8]\n#  [3 6 9]]&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;To visualize this, imagine writing down a matrix on a translucent piece of paper. Draw a line from the top left corner to the bottom right corner of that paper, then rotate the paper 180Â° around that line:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2x3qNDptBldEKCgQBbmNPr/ad174561910e6c90753024625f16fd68/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1220\&quot; height=\&quot;332\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The second operation we&amp;#39;ll need is &lt;b&gt;matrix multiplication&lt;/b&gt;. Normally, we will multiply a matrix by a &lt;b&gt;column vector&lt;/b&gt;, which is just a matrix with one column. For example, the following &lt;code&gt;3&lt;/code&gt;-by-&lt;code&gt;1&lt;/code&gt; matrix is a column vector:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;s = np.matrix([[0],\n               [1],\n               [0]])&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We can also write &lt;code&gt;s &lt;/code&gt;more concisely as &lt;code&gt;np.matrix([[0,1,0]]).T&lt;/code&gt;.Â  To multiply a square matrix &lt;code&gt;A&lt;/code&gt; by a column vector &lt;code&gt;s&lt;/code&gt;, we compute the &lt;b&gt;dot product&lt;/b&gt; of each row of &lt;code&gt;A&lt;/code&gt; with &lt;code&gt;s&lt;/code&gt;. That is, if &lt;code&gt;t = A*s % Q&lt;/code&gt;, then &lt;code&gt;t[i] == (A[i,0]*s[0,0] + A[i,1]*s[1,0] + A[i,2]*s[2,0]) % Q &lt;/code&gt;for each row &lt;code&gt;i&lt;/code&gt;. The output will always be a column vector:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;print(A*s % Q)\n# [[2]\n#  [5]\n#  [8]]&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The number of rows of this column vector is equal to the number of rows of the matrix on the left hand side. In particular, if we take our column vector &lt;code&gt;s&lt;/code&gt;, transpose it into a &lt;code&gt;1&lt;/code&gt;-by-&lt;code&gt;3&lt;/code&gt; matrix, and multiply it by a &lt;code&gt;3&lt;/code&gt;-by-&lt;code&gt;1&lt;/code&gt; matrix &lt;code&gt;r&lt;/code&gt;, then we end up with a &lt;code&gt;1&lt;/code&gt;-by-&lt;code&gt;1 &lt;/code&gt;matrix:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;r = np.matrix([[1,2,3]]).T\nprint(s.T*r % Q)\n# [[2]]&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The final matrix operation we&amp;#39;ll need is &lt;b&gt;matrix addition&lt;/b&gt;. If &lt;code&gt;A&lt;/code&gt; and &lt;code&gt;B&lt;/code&gt; are both &lt;code&gt;N&lt;/code&gt;-by-&lt;code&gt;M&lt;/code&gt; matrices, then &lt;code&gt;C = (A+B) % Q&lt;/code&gt; is the &lt;code&gt;N&lt;/code&gt;-by-&lt;code&gt;M&lt;/code&gt; matrix for which &lt;code&gt;C[i,j] == (A[i,j]+B[i,j]) % Q&lt;/code&gt;. Of course, this only works if the matrices we&amp;#39;re adding have the same dimensions.&lt;/p&gt;&lt;h4&gt;Warm up&lt;/h4&gt;&lt;p&gt;Enough maths â let&amp;#39;s get to exchanging some keys. We start with the DH diagram from before and swap out the computations with matrix operations. Note that this protocol is not secure, but will be the basis of a secure key exchange mechanism we&amp;#39;ll develop in the next section:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3qRFXuCjStyX8IdRgHogJi/0ea04a675e6b8b52fc74a2375827890c/image6.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1220\&quot; height=\&quot;693\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Alice and Bob agree on a public, &lt;code&gt;N&lt;/code&gt;-by-&lt;code&gt;N&lt;/code&gt; matrix &lt;code&gt;A&lt;/code&gt;. This is analogous to the number $g$ that Alice and Bob agree on in the DH diagram.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Alice chooses a random length&lt;code&gt;-N&lt;/code&gt; vector &lt;code&gt;s&lt;/code&gt; and sends &lt;code&gt;t = A*s % Q&lt;/code&gt; to Bob.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Bob chooses a random length&lt;code&gt;-N&lt;/code&gt;  vector &lt;code&gt;r&lt;/code&gt; and sends &lt;code&gt;u = r.T*A % Q&lt;/code&gt; to Alice. You can also compute this as &lt;code&gt;(A.T*r).T % Q.&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The vectors &lt;code&gt;t&lt;/code&gt; and &lt;code&gt;u&lt;/code&gt; are analogous to DH key shares. After the exchange of these key shares, Alice and Bob can compute a shared secret. Alice computes the shared secret as &lt;code&gt;u*s % Q&lt;/code&gt; and Bob computes the shared secret as &lt;code&gt;r.T*t % Q&lt;/code&gt;. To see why they compute the same key, notice that &lt;code&gt;u*s == (r.T*A)*s == r.T*(A*s) == r.T*t.&lt;/code&gt;&lt;/p&gt;&lt;p&gt;In fact, this key exchange is essentially what happens in ML-KEM. However, we don&amp;#39;t use this directly, but rather as part of a &lt;b&gt;public key encryption scheme&lt;/b&gt;. Public key encryption involves three algorithms:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;key_gen():&lt;/code&gt; The key generation algorithm that outputs a public encryption key &lt;code&gt;pk&lt;/code&gt; and the corresponding secret decryption key &lt;code&gt;sk&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;encrypt()&lt;/code&gt;: The encryption algorithm that takes the public key and a plaintext and outputs a ciphertext.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;decrypt()&lt;/code&gt;: The decryption algorithm that takes the secret key and a ciphertext and outputs the underlying plaintext. That is, &lt;code&gt;decrypt(sk, encrypt(pk, ptxt)) == ptxt&lt;/code&gt; for any plaintext &lt;code&gt;ptxt&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;We&amp;#39;ll say the scheme is secure if, given a ciphertext and the public key used to encrypt it, no attacker can discern any information about the underlying plaintext without knowledge of the secret key. Once we have this encryption scheme, we then transform it into a &lt;b&gt;key-encapsulation mechanism&lt;/b&gt; (the &amp;quot;KEM&amp;quot; in &amp;quot;ML-KEM&amp;quot;) in the last step. A KEM is very similar to encryption except that the plaintext is always a randomly generated key.&lt;/p&gt;&lt;p&gt;Our encryption scheme is as follows:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;key_gen()&lt;/code&gt;: To generate a key pair, we choose a random, square matrix &lt;code&gt;A&lt;/code&gt; and a random column vector &lt;code&gt;s&lt;/code&gt;. We set our public key to &lt;code&gt;(A,t=A*s % Q)&lt;/code&gt; and our secret key to &lt;code&gt;s&lt;/code&gt;. Notice that &lt;code&gt;t &lt;/code&gt;is Alice&amp;#39;sÂ  key share from the key exchange protocol above.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;encrypt()&lt;/code&gt;: Suppose our plaintext &lt;code&gt;ptxt &lt;/code&gt;is an integer in &lt;code&gt;range(Q)&lt;/code&gt;. To encrypt &lt;code&gt;ptxt&lt;/code&gt;, Bob generates his key share &lt;code&gt;u&lt;/code&gt;. He then derives the shared secret and adds it to &lt;code&gt;ptxt&lt;/code&gt;. The ciphertext has two components:&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;&lt;code&gt;u = r.T*A % Q&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;v = (r.T*t + m) % Q&lt;/code&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Here &lt;code&gt;m &lt;/code&gt;is a &lt;code&gt;1&lt;/code&gt;-by-&lt;code&gt;1 &lt;/code&gt;matrix containing the plaintext, i.e., &lt;code&gt;m = np.matrix([[ptxt]])&lt;/code&gt;, and &lt;code&gt;r&lt;/code&gt; is a random column vector.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;decrypt()&lt;/code&gt;: To decrypt, Alice computes the shared secret and subtracts it from &lt;code&gt;v&lt;/code&gt;:&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;&lt;code&gt;m = (v - u*s) % Q&lt;/code&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Some readers will notice that this looks an awful lot like &lt;a href=\&quot;https://en.wikipedia.org/wiki/ElGamal_encryption\&quot;&gt;&lt;u&gt;El Gamal&lt;/u&gt;&lt;/a&gt; encryption. This isn&amp;#39;t a coincidence. Good cryptographers roll their own crypto; great cryptographers steal from good cryptographers.&lt;/p&gt;&lt;p&gt;Let&amp;#39;s now put this together into code. The last thing we&amp;#39;ll need is a method of generating random matrices and column vectors. We call this function &lt;code&gt;gen_mat() &lt;/code&gt;below. Take a crack at implementing this yourself. Our scheme has two parameters: the modulus &lt;code&gt;Q&lt;/code&gt;; and the dimension of &lt;code&gt;N&lt;/code&gt; of the matrix and column vectors. The choice of &lt;code&gt;N&lt;/code&gt; matters for security, but for now feel free to pick whatever value you want.&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;def key_gen():\n    # Here `gen_mat()` returns an N-by-N matrix with entries\n    # randomly chosen from `range(0, Q)`.\n    A = gen_mat(N, N, 0, Q)\n    # Like above except the matrix is N-by-1.\n    s = gen_mat(N, 1, 0, Q)\n    t = A*s % Q\n    return ((A, t), s)\n\ndef encrypt(pk, ptxt):\n    (A, t) = pk\n    m = np.matrix([[ptxt]])\n    r = gen_mat(N, 1, 0, Q)\n    u = r.T*A % Q\n    v = (r.T*t + m) % Q\n    return (u, v)\n\ndef decrypt(sk, ctxt):\n    s = sk\n    (u, v) = ctxt\n    m = (v - u*s) % Q\n    return m[0,0]\n\n# Test\nassert decrypt(sk, encrypt(pk, 1)) == 1&lt;/pre&gt;&lt;/code&gt;\n            &lt;h4&gt;Making the scheme secure (or &amp;quot;What is a lattice?&amp;quot;)&lt;/h4&gt;&lt;p&gt;By now, you might be wondering what on Earth a lattice even is. We promise we&amp;#39;ll define it, but before we do, it&amp;#39;ll help to understand why our warm-up scheme is insecure and what it&amp;#39;ll take to fix it.&lt;/p&gt;&lt;p&gt;Readers familiar with linear algebra may already see the problem: in order for this scheme to be secure, it should be impossible for the attacker to recover the secret key &lt;code&gt;s&lt;/code&gt;; but given the public &lt;code&gt;(A,t)&lt;/code&gt;, we can immediately solve for &lt;code&gt;s&lt;/code&gt; using &lt;a href=\&quot;https://en.wikipedia.org/wiki/Gaussian_elimination\&quot;&gt;&lt;u&gt;Gaussian elimination&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;In more detail, if &lt;code&gt;A&lt;/code&gt; is invertible, we can write the secret key as &lt;code&gt;A&lt;/code&gt;&lt;code&gt;&lt;sup&gt;-1&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;*t == A&lt;/code&gt;&lt;code&gt;&lt;sup&gt;-1&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;*(A*s) == (A&lt;/code&gt;&lt;code&gt;&lt;sup&gt;-1&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;*A)*s == s,&lt;/code&gt; where &lt;code&gt;A&lt;/code&gt;&lt;code&gt;&lt;sup&gt;-1&lt;/sup&gt;&lt;/code&gt; is the inverse of &lt;code&gt;A&lt;/code&gt;. (When you multiply a matrix by its inverse, you get the identity matrix &lt;code&gt;I&lt;/code&gt;, which simply takes a column vector to itself, i.e., &lt;code&gt;I*s == s.&lt;/code&gt;) We can use Gaussian elimination to compute this matrix. Intuitively, all we&amp;#39;re doing is solving a set of linear equations, where the entries of &lt;code&gt;s&lt;/code&gt; are the unknown variables. (Note that this is possible even if &lt;code&gt;A&lt;/code&gt; is not invertible.)&lt;/p&gt;&lt;p&gt;In order to make this encryption scheme secure, we need to make it a little... âmessierâ.&lt;/p&gt;&lt;h5&gt;Let&amp;#39;s get messy&lt;/h5&gt;&lt;p&gt;For starters, we need to make it hard to recover the secret key from the public key. Let&amp;#39;s try the following: generate another random vector &lt;code&gt;e&lt;/code&gt; and add it into &lt;code&gt;A*&lt;/code&gt;s. Our key generation algorithm becomes:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;def key_gen():\n    A = gen_mat(N, N, 0, Q)\n    s = gen_mat(N, 1, 0, Q)\n    e = gen_mat(N, 1, 0, Q)\n    t = (A*s + e) % Q\n    return ((A, t), s)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Our formula for the column vector component of the public key, &lt;code&gt;t&lt;/code&gt;, now includes an additive term &lt;code&gt;e&lt;/code&gt;, which we&amp;#39;ll call the &lt;b&gt;error&lt;/b&gt;. Like the secret key, the error is just a random vector.Â &lt;/p&gt;&lt;p&gt;Notice that the previous attack no longer works: since &lt;code&gt;A&lt;/code&gt;&lt;code&gt;&lt;sup&gt;-1&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;*t == A&lt;/code&gt;&lt;code&gt;&lt;sup&gt;-1&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;*(A*s + e) == A&lt;/code&gt;&lt;code&gt;&lt;sup&gt;-1&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;*(A*s) + A&lt;/code&gt;&lt;code&gt;&lt;sup&gt;-1&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;*e == s + A&lt;/code&gt;&lt;code&gt;&lt;sup&gt;-1&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;*e&lt;/code&gt;, we need to know &lt;code&gt;e&lt;/code&gt; in order to compute &lt;code&gt;s&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Great, but this patch creates another problem. Take a second to plug in this new key generation algorithm into your implementation and test it out. What happens?&lt;/p&gt;&lt;p&gt;You should see that &lt;code&gt;decrypt()&lt;/code&gt; now outputs garbage. We can see why using a little algebra:&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;\t&lt;code&gt;(v - u*s) == (r.T*t + m) - (r.T*A)*s&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â == r.T*(A*s + e) + m - (r.T*A)*s&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â == r.T*(A*s) + r.T*e + m - r.T*(A*s)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â == r.T*e + m&lt;/code&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;The entries of &lt;code&gt;r&lt;/code&gt; and &lt;code&gt;e&lt;/code&gt; are sampled randomly, so &lt;code&gt;r.T*e&lt;/code&gt; is also uniformly random. It&amp;#39;s as if we encrypted &lt;code&gt;m&lt;/code&gt; with a &lt;a href=\&quot;https://en.wikipedia.org/wiki/One-time_pad\&quot;&gt;&lt;u&gt;one-time pad&lt;/u&gt;&lt;/a&gt;, then threw away the one-time pad!&lt;/p&gt;&lt;h6&gt;Handling decryption errors&lt;/h6&gt;&lt;p&gt;What can we do about this? First, it would help if &lt;code&gt;r.T*e&lt;/code&gt; were small so that decryption yields something that&amp;#39;s close to the plaintext. Imagine we could generate &lt;code&gt;r&lt;/code&gt; and&lt;code&gt; e&lt;/code&gt; in such a way that &lt;code&gt;r.T*e&lt;/code&gt; were in &lt;code&gt;range(-epsilon, epsilon+1)&lt;/code&gt; for some small &lt;code&gt;epsilon&lt;/code&gt;. Then &lt;code&gt;decrypt&lt;/code&gt; would output a number in &lt;code&gt;range(ptxt-epsilon, ptxt+epsilon+1)&lt;/code&gt;, which would be pretty close to the actual plaintext.&lt;/p&gt;&lt;p&gt;However, we need to do better than get close. Imagine your browser failing to load your favorite website one-third of the time because of a decryption error. Nobody has time for that.&lt;/p&gt;&lt;p&gt;ML-KEM reduces the probability of decryption errors by being clever about how we encode the plaintext. Suppose all we want to do is encrypt a single bit, i.e., &lt;code&gt;ptxt &lt;/code&gt;is either &lt;code&gt;0&lt;/code&gt; or &lt;code&gt;1&lt;/code&gt;. Consider the numbers in &lt;code&gt;range(Q)&lt;/code&gt;, and split the number line into four chunks of roughly equal length:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3xojaMtl881io3pH4BdXNe/d47aede96c751942b82fedf0ca396450/image2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1220\&quot; height=\&quot;333\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Here we&amp;#39;ve labeled the region around zero (&lt;code&gt;-Q/4&lt;/code&gt; to &lt;code&gt;Q/4&lt;/code&gt; modulo &lt;code&gt;Q&lt;/code&gt;) with &lt;code&gt;ptxt=0&lt;/code&gt; and the region far away from zero with &lt;code&gt;ptxt=1&lt;/code&gt;. To encode the bit, we set it to the integer corresponding to the middle of its range, i.e., &lt;code&gt;m = np.matrix([[ptxt * Q//2]])&lt;/code&gt;. (Note the double &amp;quot;&lt;code&gt;//&lt;/code&gt;&amp;quot; â this denotes integer division in Python.) To decode, we choose the &lt;code&gt;ptxt&lt;/code&gt; corresponding to whatever range&lt;code&gt; m[0,0] &lt;/code&gt;is in. That way if the decryption error is small, then we&amp;#39;re highly likely to end up in the correct range.&lt;/p&gt;&lt;p&gt;Now all that&amp;#39;s left is to ensure the decryption error, &lt;code&gt;r.T*e&lt;/code&gt;, is small. We do this by sampling &lt;b&gt;short vectors &lt;/b&gt;&lt;code&gt;r&lt;/code&gt; and &lt;code&gt;e&lt;/code&gt;. By &amp;quot;short&amp;quot; we mean the entries of these vectors are sampled from a range that is much smaller than &lt;code&gt;range(Q)&lt;/code&gt;. In particular, we&amp;#39;ll pick some small positive integer &lt;code&gt;beta&lt;/code&gt; and sample entries &lt;code&gt;range(-beta,beta+1)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;How do we choose &lt;code&gt;beta&lt;/code&gt;? Well, it should be small enough that decryption succeeds with overwhelming probability, but not so small that &lt;code&gt;r&lt;/code&gt; and &lt;code&gt;e&lt;/code&gt; are easy to guess and our scheme is broken. Take a minute or two to play with this. The parameters we can vary are:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;the modulus &lt;code&gt;Q&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;the dimension of the column vectors &lt;code&gt;N&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;the shortness parameter &lt;code&gt;beta&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;For what ranges of these parameters is the decryption error low but the secret vectors are hard to guess? For what ranges is our scheme most efficient, in terms of runtime and communication cost (size of the public key plus the ciphertext)? We&amp;#39;ll give a concrete answer at the end of this section, but in the meantime, we encourage you to play with this a bit.&lt;/p&gt;&lt;h6&gt;Gauss strikes back&lt;/h6&gt;&lt;p&gt;At this point, we have a working encryption scheme that mitigates at least one key-recovery attack. We&amp;#39;ve come pretty far, but we have at least one more problem.&lt;/p&gt;&lt;p&gt;Take another look at our formula for the ciphertextÂ  &lt;code&gt;ctxt = (u,v)&lt;/code&gt;. What would happen if we managed to recover the random vector &lt;code&gt;r&lt;/code&gt;? That would be catastrophic, since &lt;code&gt;v == r.T*t + m&lt;/code&gt;, and we already know &lt;code&gt;t&lt;/code&gt; (part of the public key) and&lt;code&gt; v &lt;/code&gt;(part of the ciphertext).&lt;/p&gt;&lt;p&gt;Just as we were able to compute the secret key from the public key in our initial scheme, we can recover the encryption randomness &lt;code&gt;r&lt;/code&gt; from the ciphertext component &lt;code&gt;u&lt;/code&gt; using Gaussian elimination. Again, this is just because &lt;code&gt;r&lt;/code&gt; is the solution to a system of linear equations.&lt;/p&gt;&lt;p&gt;We can mitigate this plaintext-recovery attack just as before, by adding some noise. In particular, we&amp;#39;ll generate a short vector according to &lt;code&gt;gen_mat(N,1,-beta,beta+1)&lt;/code&gt; and add it into &lt;code&gt;u&lt;/code&gt;. We also need to add noise to &lt;code&gt;v&lt;/code&gt; in the same way, for reasons that we&amp;#39;ll discuss in the next section.&lt;/p&gt;&lt;p&gt;Once again, adding noise increases the probability of a decryption error, but this time the magnitude of the error also depends on the secret key &lt;code&gt;s&lt;/code&gt;. To see this, recall that during decryption, we multiply &lt;code&gt;u&lt;/code&gt; by &lt;code&gt;s&lt;/code&gt; (to compute the shared secret), and the error vector is an additive term. We&amp;#39;ll therefore need &lt;code&gt;s&lt;/code&gt; to be a short vector as well.&lt;/p&gt;&lt;p&gt;Let&amp;#39;s now put together everything we&amp;#39;ve learned into an updated encryption scheme. Our scheme now has three parameters, &lt;code&gt;Q&lt;/code&gt;, &lt;code&gt;N&lt;/code&gt;, and &lt;code&gt;beta&lt;/code&gt;, and can be used to encrypt a single bit:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;def key_gen():\n    A = gen_mat(N, N, 0, Q)\n    s = gen_mat(N, 1, -beta, beta+1)\n    e1 = gen_mat(N, 1, -beta, beta+1)\n    t = (A*s + e1) % Q\n    return ((A, t), s)\n\ndef encrypt(pk, ptxt):\n    (A, t) = pk\n    m = np.matrix([[ptxt*(Q//2) % Q]])\n    r = gen_mat(N, 1, -beta, beta+1)\n    e2 = gen_mat(N, 1, -beta, beta+1)\n    e3 = gen_mat(1, 1, -beta, beta+1)\n    u = (r.T*A + e2) % Q\n    v = (r.T*t + e3 + m) % Q\n    return (u, v)\n\ndef decrypt(sk, ctxt):\n    s = sk\n    (u, v) = ctxt\n    m = (v - u*s) % Q\n    if m[0,0] in range(Q//4, 3*Q//4):\n        return 1\n    return 0\n\n# Test\nassert decrypt(sk, encrypt(pk, 0)) == 0\nassert decrypt(sk, encrypt(pk, 1)) == 1&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Before moving on, try to find parameters for which the scheme works and for which the secret and error vectors seem hard to guess.&lt;/p&gt;&lt;h5&gt;Learning with errors&lt;/h5&gt;&lt;p&gt;So far we have a functioning encryption scheme for which we&amp;#39;ve mitigated two attacks, one a key-recovery attack and the other a plaintext-recovery attack. There seems to be no other obvious way of breaking our scheme, unless we choose parameters that are so weak that an attacker can easily guess the secret key s or ciphertext randomness r. Again, these vectors need to be short in order to prevent decryption errors, but not so short that they are easy to guess. (Likewise for the error terms.)&lt;/p&gt;&lt;p&gt;Still, there may be other attacks that require a little more sophistication to pull off. For instance, there might be some mathematical analysis we can do to recover, or at least make a good guess of, a portion of the ciphertext randomness. This raises a more fundamental question: in general, how do we establish that cryptosystems like this are actually secure?&lt;/p&gt;&lt;p&gt;As a first step, cryptographers like to try and reduce the attack surface. &lt;b&gt;Modern cryptosystems are designed so that the problem of attacking the scheme reduces to solving some other problem that is easier to reason about.&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Our public key encryption scheme is an excellent illustration of this idea. Think back to the key- and plaintext-recovery attacks from the previous section. What do these attacks have in common?&lt;/p&gt;&lt;p&gt;In both instances, the attacker knows some public vector that allowed it to recover a secret vector:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;In the key-recovery attack, the attacker knew &lt;code&gt;t&lt;/code&gt; for which &lt;code&gt;A*s == t.&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;In the plaintext-recovery attack, the attacker knew &lt;code&gt;u&lt;/code&gt; for which &lt;code&gt;r.T*A == u &lt;/code&gt;(or, equivalently,&lt;code&gt; A.T*r == u.T&lt;/code&gt;).&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The fix in both cases was to construct the public vector in such a manner that it is hard to solve for the secret, namely, by adding an error term. However, ideally the public vector would reveal no information about the secret whatsoever. This ideal is formalized by the &lt;b&gt;Learning With Errors (LWE)&lt;/b&gt; problem.&lt;/p&gt;&lt;p&gt;The LWE problem asks the attacker to distinguish between two distributions. Concretely, imagine we flip a coin, and if it comes up heads, we sample from the first distribution and give the sample to the attacker; and if the coin comes up tails, we sample from the second distribution and give the sample to the attacker. The distributions are as follows:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;(A,t=A*s + e&lt;/code&gt;) where &lt;code&gt;A&lt;/code&gt; is a random matrix generated with &lt;code&gt;gen_mat(N,N,0,Q)&lt;/code&gt; and &lt;code&gt;s&lt;/code&gt; and &lt;code&gt;e&lt;/code&gt; are short vectors generated with &lt;code&gt;gen_mat(N,1,-beta,beta+1)&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;(A,t) &lt;/code&gt;where &lt;code&gt;A&lt;/code&gt; is a random matrix generated with &lt;code&gt;gen_mat(N,N,0,Q)&lt;/code&gt; and &lt;code&gt;t&lt;/code&gt; is a random vector generated with &lt;code&gt;gen_mat(N,1,0,Q)&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The first distribution corresponds to what we actually do in the encryption scheme; in the second, &lt;code&gt;t&lt;/code&gt; is just a random vector, and no longer a secret vector at all. We say that the LWE problem is &amp;quot;hard&amp;quot; if no attacker is able to guess the coin flip with probability significantly better than one-half.&lt;/p&gt;&lt;p&gt;Our encryption is &lt;i&gt;passively &lt;/i&gt;secure â meaning the ciphertext doesn&amp;#39;t leak any information about the plaintext â if the LWE problem is hard for the parameters we chose. To see why, notice that both the public key and ciphertext look like LWE instances; if we can replace each instance with an instance of the random distribution, then the ciphertext would be completely independent of the plaintext and therefore leak no information about it at all. Note that, for this argument to go through, we also have to add the error term &lt;code&gt;e3&lt;/code&gt; to the ciphertext component &lt;code&gt;v&lt;/code&gt;.&lt;/p&gt;&lt;h5&gt;Choosing the parameters&lt;/h5&gt;&lt;p&gt;We&amp;#39;ve established that if solving the LWE problem is hard for parameters &lt;code&gt;N&lt;/code&gt;, &lt;code&gt;Q&lt;/code&gt;, and &lt;code&gt;beta&lt;/code&gt;, then so is breaking our public key encryption scheme. What&amp;#39;s left for us to do is tune the parameters so that solving LWE is beyond the reach of any attacker we can think of. This is where lattices come in.&lt;/p&gt;&lt;h6&gt;Lattices&lt;/h6&gt;&lt;p&gt;A &lt;b&gt;lattice &lt;/b&gt;is an infinite grid of points in high-dimensional space. A two-dimensional lattice might look something like this:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5Js1SkG7bWyCNwPxKaYf3i/277a665f0e44ec7594e7e11b35958bc8/image4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;640\&quot; height=\&quot;480\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The points always follow a clear pattern that resembles &amp;quot;lattice work&amp;quot; you might see in a garden:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5kOimwlM1guY2YMj9Gn9xu/62ee11ddde1e18ba0cf3151a0b87092e/image5.jpg\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;640\&quot; height=\&quot;480\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;(Source: https://picryl.com/media/texture-wood-vintage-backgrounds-textures-8395bb)&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;For cryptography, we care about a special class of lattices, those defined by a matrix &lt;code&gt;P&lt;/code&gt; that &amp;quot;recognizes&amp;quot; points in the lattice. That is, the lattice recognized by &lt;code&gt;P&lt;/code&gt; is the set of vectors &lt;code&gt;v&lt;/code&gt; for which &lt;code&gt;P*v == 0&lt;/code&gt;, where &amp;quot;&lt;code&gt;0&lt;/code&gt;&amp;quot; denotes the all-zero vector. The all-zero vector is &lt;code&gt;np.zeros((N,1), dtype=int)&lt;/code&gt; in NumPy.&lt;/p&gt;&lt;p&gt;Readers familiar with linear algebra may have a different definition of lattices in mind: in general, a lattice is the set of points obtained by taking linear combinations of some basis. Our lattices can also be formulated in this way, i.e., for a matrix &lt;code&gt;P&lt;/code&gt; that recognizes a lattice, we can compute the basis vectors that generate the lattice. However, we don&amp;#39;t much care about this representation here.&lt;/p&gt;&lt;p&gt;The LWE problem boils down to distinguishing a set of points that are &amp;quot;close to&amp;quot; the lattice from a set of points that are &amp;quot;far away from&amp;quot; the lattice. We construct these points from an LWE instance and a random &lt;code&gt;(A,t)&lt;/code&gt; respectively. Here we have an LWE sample (left) and a sample from the random distribution (right):&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/45bmYu3jdn8g7cI1i7WC3t/c82617991463169ecd83b1b944aa879a/image10.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;640\&quot; height=\&quot;480\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;What this shows is that the points of the LWE instance are much closer to the lattice than the random instance. This is indeed the case on average. However, while distinguishing LWE instances from random is easy in two dimensions, it gets harder in higher dimensions.&lt;/p&gt;&lt;p&gt;Let&amp;#39;s take a look at how we construct these points. First, let&amp;#39;s take an LWE instance &lt;code&gt;(A,t=(A*s + e) % Q&lt;/code&gt;) and consider the lattice recognized by the matrix &lt;code&gt;P&lt;/code&gt; we get by concatenating &lt;code&gt;A&lt;/code&gt; with the identity matrix &lt;code&gt;I&lt;/code&gt;. This might look something like this (&lt;code&gt;N=3&lt;/code&gt;):&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;A = gen_mat(N, N, 0, Q)\nP = np.concatenate((A, np.identity(N, dtype=int)), axis=1)\nprint(P)\n# [[1570  634  161\t1\t0\t0]\n#  [1522 1215  861\t0\t1\t0]\n#  [ 344 2651 1889\t0\t0\t1]]&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Notice that we can compute &lt;code&gt;t&lt;/code&gt; by multiplying &lt;code&gt;P&lt;/code&gt; by the vector we get by concatenating &lt;code&gt;s&lt;/code&gt; and &lt;code&gt;e&lt;/code&gt; (&lt;code&gt;beta=2&lt;/code&gt;):&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;s = gen_mat(N, 1, -beta, beta+1)\ne = gen_mat(N, 1, -beta, beta+1)\nt = (A*s + e) % Q\nz = np.concatenate((s, e))\nprint(z)\n# [[-2]\n#  [ 0]\n#  [-2]\n#  [ 0]\n#  [-1]\n#  [ 2]]\nassert np.array_equal(t, P*z % Q)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Let &lt;code&gt;z&lt;/code&gt; denote this vector and consider the set of points &lt;code&gt;v&lt;/code&gt; for which &lt;code&gt;P*v == t&lt;/code&gt;. By definition, we say this set of points is &amp;quot;close to&amp;quot; the lattice because &lt;code&gt;z&lt;/code&gt; is a short vector. (Remember: by &amp;quot;short&amp;quot; we mean its entries are bounded around &lt;code&gt;0&lt;/code&gt; by &lt;code&gt;beta&lt;/code&gt;.)&lt;/p&gt;&lt;p&gt;Now consider a random&lt;code&gt; (A,t)&lt;/code&gt; and consider the set of points &lt;code&gt;v&lt;/code&gt; for which &lt;code&gt;P*v == t&lt;/code&gt;. We won&amp;#39;t prove it, but it is a fact that this set of points is likely to be &amp;quot;far away from&amp;quot; the lattice in the sense that there is no short vector &lt;code&gt;z&lt;/code&gt; for which&lt;code&gt; P*z == t.&lt;/code&gt;&lt;/p&gt;&lt;p&gt;Intuitively, solving LWE gets harder as &lt;code&gt;z&lt;/code&gt; gets longer. Indeed, increasing the average length of &lt;code&gt;z&lt;/code&gt; (by making &lt;code&gt;beta&lt;/code&gt; larger) increases the average distance to the lattice, making it look more like a random instance:Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4oN8fydfP54b6EDLIOTYjI/85813f716b48164077b8f6d27586f768/unnamed__1_.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;640\&quot; height=\&quot;480\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;On the other hand, making &lt;code&gt;z&lt;/code&gt; too long creates another problem.&lt;/p&gt;&lt;h6&gt;Breaking lattice cryptography by finding short vectors&lt;/h6&gt;&lt;p&gt;Given a random matrix &lt;code&gt;A&lt;/code&gt;, the &lt;b&gt;Short Integer Solution (SIS)&lt;/b&gt; problem is to find short vectors (i.e., whose entries are bounded by &lt;code&gt;beta&lt;/code&gt;) &lt;code&gt;z1&lt;/code&gt; and &lt;code&gt;z2&lt;/code&gt; for which &lt;code&gt;(A*z1 + z2) % Q&lt;/code&gt; is zero. Notice that this is equivalent to finding a short vector &lt;code&gt;z&lt;/code&gt; in the lattice recognized by &lt;code&gt;P&lt;/code&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;z = np.concatenate((z1, z2))\nassert np.array_equal((A*z1 + z2) % Q, P*z % Q)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;If we had a (quantum) computer program for solving SIS, then we could use this program to solve LWE as well: if &lt;code&gt;(A,t) &lt;/code&gt;is an LWE instance, then &lt;code&gt;z1.T*t &lt;/code&gt;will be small; otherwise, if &lt;code&gt;(A,t)&lt;/code&gt; is random, then &lt;code&gt;z1.T*t &lt;/code&gt;will be uniformly random. (You can convince yourself of this using a little algebra.) Therefore, in order for our encryption scheme to be secure, it must be hard to find short vectors in the lattice defined by those parameters.&lt;/p&gt;&lt;p&gt;Intuitively, finding long vectors in the lattice is easier than finding short ones, which means that solving the SIS problem gets easier as &lt;code&gt;beta &lt;/code&gt;gets closer to &lt;code&gt;Q&lt;/code&gt;. On the other hand, as &lt;code&gt;beta &lt;/code&gt; gets closer to &lt;code&gt;0&lt;/code&gt;, it gets easier to distinguish LWE instances from random!&lt;/p&gt;&lt;p&gt;&lt;b&gt;This suggests a kind of Goldilocks zone for LWE-based encryption&lt;/b&gt;: if the secret and noise vectors are too short, then LWE is easy; but if the secret and noise vectors are too long, then SIS is easy. The optimal choice is somewhere in the middle.&lt;/p&gt;&lt;h6&gt;Enough math, just give me my parameters!&lt;/h6&gt;&lt;p&gt;To tune our encryption scheme, we want to choose parameters for which the most efficient known algorithms (quantum or classical) for solving LWE are out of reach for any attacker with as many resources as we can imagine (and then some, in case new algorithms are discovered). But how do we know which attacks to look out for?&lt;/p&gt;&lt;p&gt;Fortunately, the community of expert lattice cryptographers and cryptanalysts maintains a tool called &lt;a href=\&quot;https://github.com/malb/lattice-estimator\&quot;&gt;&lt;u&gt;lattice-estimator&lt;/u&gt;&lt;/a&gt; that estimates the complexity of the best known (quantum) algorithms for lattice problems relevant to cryptography. Here&amp;#39;s what we get when we run this tool for ML-KEM (this requires &lt;a href=\&quot;https://www.sagemath.org/\&quot;&gt;&lt;u&gt;Sage&lt;/u&gt;&lt;/a&gt; to run):&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;sage: from estimator import *\nsage: res = LWE.estimate.rough(schemes.Kyber768)\nusvp        :: rop: â2^182.2, red: â2^182.2, Î´: 1.002902, Î²: 624, d: 1427, tag: usvp\ndual_hybrid :: rop: â2^174.3, red: â2^174.3, guess: â2^162.5, Î²: 597, p: 4, Î¶: 10, t: 60, Î²&amp;#039;: 597, N: â2^122.7, m: 768&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The number that we&amp;#39;re most interested in is &amp;quot;&lt;code&gt;rop&lt;/code&gt;&amp;quot;, which estimates the amount of computation the attack would consume. Playing with this tool a bit, we eventually find some parameters for our scheme for which the &amp;quot;&lt;code&gt;usvp&lt;/code&gt;&amp;quot; and &amp;quot;&lt;code&gt;dual_hybrid&lt;/code&gt;&amp;quot; attacks have comparable complexity. However, lattice-estimator identifies an attack it calls &amp;quot;&lt;code&gt;arora-gb&lt;/code&gt;&amp;quot; that applies to our scheme, but not to ML-KEM, that has much lower complexity.Â  (&lt;code&gt;N=600&lt;/code&gt;, &lt;code&gt;Q=3329&lt;/code&gt;, and &lt;code&gt;beta=4&lt;/code&gt;):&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;sage: res = LWE.estimate.rough(LWE.Parameters(n=600, q=3329, Xs=ND.Uniform(-4,4), Xe=ND.Uniform(-4,4)))\nusvp        :: rop: â2^180.2, red: â2^180.2, Î´: 1.002926, Î²: 617, d: 1246, tag: usvp\ndual_hybrid :: rop: â2^226.2, red: â2^225.4, guess: â2^224.9, Î²: 599, p: 3, Î¶: 10, t: 0, Î²&amp;#039;: 599, N: â2^174.8, m: 600\narora-gb    :: rop: â2^129.4, dreg: 9, mem: â2^129.4, t: 4, m: â2^64.7&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We&amp;#39;d have to bump the parameters even further to the scheme to a regime that has comparable security to ML-KEM.&lt;/p&gt;&lt;p&gt;Finally, a word of warning: when designing lattice cryptography, determining whether our scheme is secure requires a lot more than estimating the cost of generic attacks on our LWE parameters. In the absence of a mathematical proof of security in a realistic adversarial model, we can&amp;#39;t rule out other ways of breaking our scheme. Tread lightly, fair traveler, and bring a friend along for the journey.&lt;/p&gt;&lt;h4&gt;Making the scheme efficient&lt;/h4&gt;&lt;p&gt;Now that we understand how to encrypt with LWE, let&amp;#39;s take a quick look at how to make our scheme efficient.&lt;/p&gt;&lt;p&gt;The main problem with our scheme is that we can only encrypt a bit at a time. This is because we had to split the  &lt;code&gt;range(Q)&lt;/code&gt; into two chunks, one that encodes &lt;code&gt;1&lt;/code&gt; and another that encodes &lt;code&gt;0&lt;/code&gt;. We could improve the bit rate by splitting the range into more chunks, but this would make decryption errors more likely.&lt;/p&gt;&lt;p&gt;Another problem with our scheme is that the runtime depends heavily on our security parameters. Encryption requires &lt;code&gt;O(N&lt;/code&gt;&lt;code&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;)&lt;/code&gt; multiplications (multiplication is the most expensive part of a secure implementation of modular arithmetic), and in order for our scheme to be secure, we need to make &lt;code&gt;N&lt;/code&gt; quite large.&lt;/p&gt;&lt;p&gt;ML-KEM solves both of these problems by replacing modular arithmetic with arithmetic over a &lt;a href=\&quot;https://en.wikipedia.org/wiki/Polynomial_ring\&quot;&gt;&lt;b&gt;&lt;u&gt;polynomial ring&lt;/u&gt;&lt;/b&gt;&lt;/a&gt;. This means the entries of our matrices will be polynomials rather than integers. We need to define what it means to add, subtract, and multiply polynomials, but once we&amp;#39;ve done that, everything else about the encryption scheme is the same.&lt;/p&gt;&lt;p&gt;In fact, you probably learned polynomial arithmetic in grade school. The only thing you might not be familiar with is polynomial modular reduction. To multiply two polynomials $f(X)$ and $g(X)$, we start by multiplying $f(X)\\cdot g(X)$ as usual. Then we&amp;#39;re going to &lt;b&gt;divide &lt;/b&gt;$f(X)\\cdot g(X)$ by some special polynomial â ML-KEM uses $X^{256}+1$ â and take the remainder. We won&amp;#39;t try to explain this algorithm, but the takeaway is that the result is a polynomial with $256$ coefficients, each of which is an integer in &lt;code&gt;range(Q)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;The main advantage of using a polynomial ring for arithmetic is that we can pack more bits into the ciphertext. Our formula for the ciphertext is exactly the same (&lt;code&gt;u=r.T*A + e2, v=r.T*t + e3 + m&lt;/code&gt;), but this time the plaintext &lt;code&gt;m &lt;/code&gt;encodes a polynomial. Each coefficient of the polynomial encodes a bit, and we&amp;#39;ll handle decryption errors just as we did before, by splitting &lt;code&gt;range(Q)&lt;/code&gt; into two chunks, one that encodes &lt;code&gt;1&lt;/code&gt; and another that encodes &lt;code&gt;0&lt;/code&gt;. This allows us to reliably encrypt 256 bits (32 bytes) per ciphertext.&lt;/p&gt;&lt;p&gt;Another advantage of using polynomials is that it significantly reduces the dimension of the matrix without impacting security. Concretely, the most widely used variant of ML-KEM, ML-KEM-768, uses a &lt;code&gt;3&lt;/code&gt;-by-&lt;code&gt;3&lt;/code&gt; matrix &lt;code&gt;A&lt;/code&gt;, so just &lt;code&gt;9 &lt;/code&gt;polynomials in total. (Note that $256 \\cdot 3 = 768$, hence the name &amp;quot;ML-KEM-768&amp;quot;.) However, note that we have to be careful in how we choose the modulus: $X^{256}+1$ is special in that it does not exhibit any algebraic structure that is known to permit attacks.&lt;/p&gt;&lt;p&gt;The choices of &lt;code&gt;Q=3329&lt;/code&gt; for the coefficient modulus and $X^{256}+1$ for the polynomial modulus have one more benefit. They allow polynomial multiplication to be carried out using the &lt;a href=\&quot;https://eprint.iacr.org/2024/585\&quot;&gt;&lt;u&gt;NTT algorithm&lt;/u&gt;&lt;/a&gt;, which massively reduces the number of multiplications and additions we have to perform. In fact, this optimization is a major reason why ML-KEM is sometimes faster in terms of CPU time than key exchange with elliptic curves.&lt;/p&gt;&lt;p&gt;We won&amp;#39;t get into how NTT works here, except to say that the algorithm will look familiar to you if you&amp;#39;ve ever implemented RSA. In both cases we use the &lt;a href=\&quot;https://en.wikipedia.org/wiki/Chinese_remainder_theorem\&quot;&gt;&lt;u&gt;Chinese Remainder Theorem&lt;/u&gt;&lt;/a&gt; to split multiplication up into multiple, cheaper multiplications with smaller moduli.&lt;/p&gt;&lt;h4&gt;From public key encryption to ML-KEM&lt;/h4&gt;&lt;p&gt;The last step to build ML-KEM is to make the scheme secure against chosen ciphertext attacks (CCA). Currently, it&amp;#39;s only secure against chosen plaintext attacks (CPA), which basically means that the ciphertext leaks no information about the plaintext, regardless of the distribution of plaintexts. CCA security is stronger in that it gives the attacker access to &lt;a href=\&quot;https://en.wikipedia.org/wiki/Adaptive_chosen-ciphertext_attack#Practical_attacks\&quot;&gt;&lt;u&gt;decryptions of ciphertexts of its choosing&lt;/u&gt;&lt;/a&gt;. (Of course, it&amp;#39;s not allowed to decrypt the target ciphertext itself.) The specific transform used in ML-KEM results in a CCA-secure KEM (&amp;quot;Key-Encapsulation Mechanism&amp;quot;).&lt;/p&gt;&lt;p&gt;Chosen ciphertext attacks might seem a bit abstract, but in fact they formalize a realistic threat model for many applications of KEMs (and public key encryption for that matter). For example, suppose we use the scheme in a protocol in which the server authenticates itself to a client by proving it was able to decrypt a ciphertext generated by the client. In this kind of protocol, the server acts as a sort of &amp;quot;decryption oracle&amp;quot; in which its responses to clients depend on the secret key. Unless the scheme is CCA secure, this oracle can be abused by an attacker to leak information about the secret key over time, allowing it to eventually impersonate the server.&lt;/p&gt;&lt;p&gt;ML-KEM incorporates several more optimizations to make it as fast and as compact as possible. For example, instead of generating a random matrix &lt;code&gt;A&lt;/code&gt;, we can derive it from a random, 32-byte string (called a &amp;quot;seed&amp;quot;) using a hash-based primitive called a XOF (&amp;quot;eXtendable Output Function&amp;quot;), in the case of ML-KEM this XOF is &lt;a href=\&quot;https://pycryptodome.readthedocs.io/en/latest/src/hash/shake128.html\&quot;&gt;&lt;u&gt;SHAKE128&lt;/u&gt;&lt;/a&gt;. This significantly reduces the size of the public key.&lt;/p&gt;&lt;p&gt;Another interesting optimization is that the polynomial coefficients (integers in &lt;code&gt;range(Q)&lt;/code&gt;) in the ciphertext are compressed by rounding off the least significant bits of each coefficient, thereby reducing the overall size of the ciphertext.&lt;/p&gt;&lt;p&gt;All told, for the most widely deployed parameters (ML-KEM-768), the public key is 1184 bytes and the ciphertext is 1088 bytes. There&amp;#39;s no obvious way to reduce this, except by reducing the size of the encapsulated key or the size of the public matrix &lt;code&gt;A&lt;/code&gt;. The former would make ML-KEM useful for fewer applications, and the latter would reduce the security margin.&lt;/p&gt;&lt;p&gt;Note that there are &lt;a href=\&quot;https://eprint.iacr.org/2022/031\&quot;&gt;&lt;u&gt;other lattice schemes&lt;/u&gt;&lt;/a&gt; that are smaller, but they are based on different hardness assumptions and are still undergoing analysis.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;authentication\&quot;&gt;Authentication&lt;/h3&gt;\n            &lt;a href=\&quot;#authentication\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In the previous section, we learned about ML-KEM, the algorithm already in use to make encryption PQ-secure. However, encryption is only one piece of the puzzle: establishing a secure connection also requires &lt;b&gt;authenticating&lt;/b&gt; the server â and sometimes the client, depending on the application.&lt;/p&gt;&lt;p&gt;Authentication is usually provided by a &lt;b&gt;digital signature scheme&lt;/b&gt;, which uses a secret key to sign a message and a public key to verify the signature. The signature schemes used today aren&amp;#39;t PQ-secure: a quantum computer can be used to compute the secret key corresponding to a server&amp;#39;s public key, then use this key to impersonate the server.&lt;/p&gt;&lt;p&gt;While this threat is less urgent than the threat to encryption, mitigating it is going to be more complicated. Over the years, we&amp;#39;ve bolted a number of signatures onto the TLS handshake in order to meet the evolving requirements of the web &lt;a href=\&quot;https://en.wikipedia.org/wiki/Public_key_infrastructure\&quot;&gt;&lt;u&gt;PKI&lt;/u&gt;&lt;/a&gt;. We have PQ alternatives for these signatures, one of which we&amp;#39;ll study in this section, but so far these signatures and their public keys are too large (i.e., take up too many bytes) to make comfortable replacements for today&amp;#39;s schemes. Barring some breakthrough in &lt;a href=\&quot;https://blog.cloudflare.com/another-look-at-pq-signatures/\&quot;&gt;&lt;u&gt;NIST&amp;#39;s ongoing standardization effort&lt;/u&gt;&lt;/a&gt;, we will have to re-engineer TLS and the web PKI to use fewer signatures.&lt;/p&gt;&lt;p&gt;For now, let&amp;#39;s dive into the PQ signature scheme we&amp;#39;re likely to see deployed first: &lt;a href=\&quot;https://csrc.nist.gov/pubs/fips/204/final\&quot;&gt;&lt;u&gt;ML-DSA&lt;/u&gt;&lt;/a&gt;, a.k.a. Dillithium. The design of ML-DSA follows a similar template as ML-KEM. We start by building some intermediate primitive, then we transform that primitive into the primitive we want, in this case a signature scheme.&lt;/p&gt;&lt;p&gt;ML-DSA is quite a bit more involved than ML-KEM, so we&amp;#39;re going to try to boil it down even further and just try to get across the main ideas.&lt;/p&gt;&lt;h4&gt;Warm up&lt;/h4&gt;&lt;p&gt;Whereas ML-KEM is basically El Gamal encryption with elliptic curves replaced with lattices, ML-DSA is basically the &lt;a href=\&quot;https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr/\&quot;&gt;&lt;u&gt;Schnorr identification protocol&lt;/u&gt;&lt;/a&gt; with elliptic curves replaced with lattices. Schnorr&amp;#39;s protocol is used by a &lt;b&gt;prover &lt;/b&gt;to convince a &lt;b&gt;verifier&lt;/b&gt; that it knows the secret key associated with its public key without revealing the secret key itself. The protocol has three moves and is executed with four algorithms:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7lV5fU3j9rRQ2j2Y4lpW8r/a12908c078ec46e0fa35ef674fcfdb07/image8.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1220\&quot; height=\&quot;536\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;initialize()&lt;/code&gt;: The prover initializes the protocol and sends a &lt;b&gt;commitment&lt;/b&gt; to the verifier&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;challenge()&lt;/code&gt;:Â  The verifier receives the commitment and sends the prover a &lt;b&gt;challenge&lt;/b&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;finish()&lt;/code&gt;: The prover receives the challenge and sends the verifier the &lt;b&gt;proof&lt;/b&gt;Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;verify()&lt;/code&gt;:Â  Finally, the verifier uses the proof to decide whether the prover knows the secret key&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We get the high-level structure of ML-DSA by making this protocol non-interactive. In particular, the prover derives the challenge itself by hashing the commitment together with the message to be signed. The signature consists of the commitment and proof: to verify the signature, the verifier recomputes the challenge from the commitment and message and runs &lt;code&gt;verify()&lt;/code&gt;as usual.&lt;/p&gt;&lt;p&gt;Let&amp;#39;s jump right in to building Schnorr&amp;#39;s identification protocol from lattices. If you&amp;#39;ve never seen this protocol before, then this will look a little like black magic at first. We&amp;#39;ll go through it slowly enough to see how and why it works.&lt;/p&gt;&lt;p&gt;Just like for ML-KEM, our public key is an LWE instance &lt;code&gt;(A,t=A*s1 + s2)&lt;/code&gt;. However, this time our secret key is the &lt;i&gt;pair&lt;/i&gt; of short vectors &lt;code&gt;(s1,s2)&lt;/code&gt;, i.e., it includes the error term. Otherwise, key generation is exactly the same:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;def key_gen():\n    A = gen_mat(N, N, 0, Q)\n    s1 = gen_mat(N, 1, -beta, beta+1)\n    s2 = gen_mat(N, 1, -beta, beta+1)\n    t = (A*s1 + s2) % Q\n    return ((A, t), (s1, s2))&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;To initialize the protocol, the prover generates another LWE instance &lt;code&gt;(A,w=A*y1 + y2)&lt;/code&gt;. You&amp;#39;ll see why in just a moment. The prover sends the &lt;i&gt;hash&lt;/i&gt; of &lt;code&gt;w&lt;/code&gt; as its commitment:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;def initialize(A):\n    y1 = gen_mat(N, 1, -beta, beta+1)\n    y2 = gen_mat(N, 1, -beta, beta+1)\n    w = (A*y1 + y2) % Q\n    return (H(w), (y1, y2))&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Here &lt;code&gt;H &lt;/code&gt;is some cryptographic hash function, like &lt;a href=\&quot;https://en.wikipedia.org/wiki/SHA-3\&quot;&gt;&lt;u&gt;SHA-3&lt;/u&gt;&lt;/a&gt;. The prover stores the secret vectors&lt;code&gt; (y1,y2)&lt;/code&gt; for use in its next move.&lt;/p&gt;&lt;p&gt;Now it&amp;#39;s time for the verifier&amp;#39;s challenge. The challenge is just an integer, but we need to be careful about how we choose it. For now let&amp;#39;s just pick it at random:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;def challenge():\n    return random.randrange(0, Q)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Remember: when we turn this protocol into a digital signature, the challenge is derived from the commitment, &lt;code&gt;H(w)&lt;/code&gt;, and the message. The range of this hash function must be the same as the set of outputs of &lt;code&gt;challenge()&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Now comes the fun part. The proof is a pair of vectors&lt;code&gt; (z1,z2)&lt;/code&gt; satisfying &lt;code&gt;A*z1 + z2 == c*t + w&lt;/code&gt;. We can easily produce this proof if we know the secret key:&lt;/p&gt;&lt;p&gt;\t&lt;code&gt;z1 = (c*s1 + y1) % Q&lt;/code&gt;&lt;/p&gt;&lt;p&gt;        &lt;code&gt;z2 = (c*s2 + y2) % Q&lt;/code&gt;&lt;/p&gt;&lt;p&gt;Then &lt;code&gt;A*z1 + z2 == A*(c*s1 + y1) + (c*s2 + y2) == c*(A*s1 + s2) + (A*y1 + y2) == c*t + w&lt;/code&gt;. Our goal is to design the protocol such that it&amp;#39;s hard to come up with &lt;code&gt;(z1,z2)&lt;/code&gt; without knowing &lt;code&gt;(s1,s2)&lt;/code&gt;, even after observing many executions of the protocol.&lt;/p&gt;&lt;p&gt;Here are the &lt;code&gt;finish() &lt;/code&gt;and &lt;code&gt;verify() &lt;/code&gt;algorithms for completeness:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;def finish(s1, s2, y1, y2, c):\n    z1 = (c*s1 + y1) % Q\n    z2 = (c*s2 + y2) % Q\n    return (z1, z2)\n\ndef verify(A, t, hw, c, z1, z2):\n\treturn H((A*z1 + z2 - c*t) % Q) == hw\n\n# Test\n((A, t), (s1, s2)) = key_gen()\n(hw, (y1, y2)) = initialize(A)        # hw: prover -&amp;gt; verifier\nc = challenge()                       # c: verifier -&amp;gt; prover\n(z1, z2) = finish(s1, s2, y1, y2, c)  # (z1, z2): prover -&amp;gt; verifier\nassert verify(A, t, hw, c, z1, z2)    # verifier&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Notice that the verifier doesn&amp;#39;t actually check &lt;code&gt;A*z1 + z2 == c*t + w&lt;/code&gt; directly; we have to rearrange the equation so that we can set the commitment to &lt;code&gt;H(w)&lt;/code&gt; rather than &lt;code&gt;w&lt;/code&gt;. We&amp;#39;ll explain the need for hashing in the next section.&lt;/p&gt;&lt;h4&gt;Making this scheme secure&lt;/h4&gt;&lt;p&gt;The question of whether this protocol is secure boils down to whether it&amp;#39;s possible to impersonate the prover without knowledge of the secret key. Let&amp;#39;s put our attacker hat on and poke around.&lt;/p&gt;&lt;p&gt;Perhaps there&amp;#39;s a way to compute the secret key, either from the public key directly or by eavesdropping on executions of the protocol with the honest prover. If LWE is hard, then clearly there&amp;#39;s no way we&amp;#39;re going to extract the secret key from the public key &lt;code&gt;t&lt;/code&gt;. Likewise, the commitment &lt;code&gt;H(w)&lt;/code&gt;doesn&amp;#39;t leak any information that would help us extract the secret key from the proof&lt;code&gt; (z1,z2)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Let&amp;#39;s take a closer look at the proof. Notice that the vectors &lt;code&gt;(y1,y2)&lt;/code&gt; &amp;quot;mask&amp;quot; the secret key vectors, sort of how the shared secret masks the plaintext in ML-KEM. However, there&amp;#39;s one big exception: we also scale the secret key vectors by the challenge &lt;code&gt;c&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;What&amp;#39;s the effect of scaling these vectors? If we squint at a few proofs, we start to see a pattern emerge. Let&amp;#39;s look at &lt;code&gt;z1&lt;/code&gt; first (&lt;code&gt;N=3, Q=3329, beta=4&lt;/code&gt;):&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;((A, t), (s1, s2)) = key_gen()\nprint(&amp;#039;s1={}&amp;#039;.format(s1.T % Q))\nfor _ in range(10):\n    (w, (y1, y2)) = initialize(A)\n    c = challenge()\n    (z1, z2) = finish(s1, s2, y1, y2, c)\n    print(&amp;#039;c={}, z1={}&amp;#039;.format(c, z1.T))\n# s1=[[   1\t0 3326]]\n# c=1123, z1=[[1121 3327 3287]]\n# c=1064, z1=[[1060\t4  137]]\n# c=1885, z1=[[1884 3327  999]]\n# c=269, z1=[[ 270 3325 2524]]\n# c=1506, z1=[[1510 3325 2141]]\n# c=3147, z1=[[3149\t4  547]]\n# c=703, z1=[[ 700\t4 1219]]\n# c=1518, z1=[[1518 3327 2104]]\n# c=1726, z1=[[1726\t0 1478]]\n# c=2591, z1=[[2589\t4 2217]]&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Indeed, with enough proof samples, we should be able to make a pretty good guess of the value of &lt;code&gt;s1&lt;/code&gt;. In fact, for these parameters, there is a simple statistical analysis we can do to compute &lt;code&gt;s1&lt;/code&gt; exactly. (Hint: &lt;code&gt;Q&lt;/code&gt; is a prime number, which means &lt;code&gt;c*pow(c,-1,Q)==1 &lt;/code&gt;whenever &lt;code&gt;c&amp;gt;0&lt;/code&gt;.) We can also apply this analysis to &lt;code&gt;s2&lt;/code&gt;, or compute it directly from &lt;code&gt;t&lt;/code&gt;, &lt;code&gt;s1&lt;/code&gt;, and &lt;code&gt;A&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;The main flaw in our protocol is that, although our secret vectors are short, scaling them makes them so long that they&amp;#39;re not completely masked by&lt;code&gt; (y1,y2)&lt;/code&gt;. Since &lt;code&gt;c&lt;/code&gt; spans the entire &lt;code&gt;range(Q)&lt;/code&gt;, so do the entries of &lt;code&gt;c*s1.&lt;/code&gt; and &lt;code&gt;c*s2,&lt;/code&gt; which means in order to mask these entries, we need the entries of &lt;code&gt;(y1,y2) &lt;/code&gt;to span &lt;code&gt;range(Q)&lt;/code&gt; as well. However, doing this would make solving LWE for &lt;code&gt;(A,w)&lt;/code&gt; easy, by solving SIS. We somehow need to strike a balance between the length of the vectors of our LWE instances and the leakage induced by the challenge.&lt;/p&gt;&lt;p&gt;Here&amp;#39;s where things get tricky. Let&amp;#39;s refer to the set of possible outputs of &lt;code&gt;challenge() &lt;/code&gt;as the &lt;b&gt;challenge space. &lt;/b&gt;We need the challenge space to be fairly large, large enough that the probability of outputting the same challenge twice is negligible.&lt;/p&gt;&lt;p&gt;Why would such a collision be a problem? It&amp;#39;s a little easier to see in the context of digital signatures. Let&amp;#39;s say an attacker knows a valid signature for a message &lt;code&gt;m&lt;/code&gt;. The signature includes the commitment &lt;code&gt;H(m)&lt;/code&gt;, so the attacker also knows the challenge is &lt;code&gt;c == H(H(w),m)&lt;/code&gt;. Suppose it manages to find a different message &lt;code&gt;m&lt;/code&gt;&lt;code&gt;&lt;sup&gt;*&lt;/sup&gt;&lt;/code&gt; for which &lt;code&gt;c == H(H(w),m&lt;/code&gt;&lt;code&gt;&lt;sup&gt;*&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;)&lt;/code&gt;. Then the signature is also valid for m! And this attack is easy to pull off if the challenge space, that is, the set of possible outputs of &lt;code&gt;H&lt;/code&gt;, is too small.&lt;/p&gt;&lt;p&gt;Unfortunately, we can&amp;#39;t make the challenge space larger simply by increasing the size of the modulus &lt;code&gt;Q&lt;/code&gt;: the larger the challenge might be, the more information we&amp;#39;d leak about the secret key. We need a new idea.&lt;/p&gt;&lt;h5&gt;The best of both worlds&lt;/h5&gt;&lt;p&gt;Remember that the hardness of LWE depends on the ratio between &lt;code&gt;beta&lt;/code&gt; and &lt;code&gt;Q&lt;/code&gt;. This means that &lt;code&gt;y1&lt;/code&gt; and &lt;code&gt;y2&lt;/code&gt; don&amp;#39;t need to be short in absolute terms, but short relative to random vectors.&lt;/p&gt;&lt;p&gt;With that in mind, consider the following idea. Let&amp;#39;s take a larger modulus, say &lt;code&gt;Q=2**31 - 1&lt;/code&gt;, and we&amp;#39;ll continue to sample from the same challenge space, &lt;code&gt;range(2**16)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;First, notice that &lt;code&gt;z1&lt;/code&gt; is now &amp;quot;relatively&amp;quot; short, since its entries are now in &lt;code&gt;range(-gamma, gamma+1)&lt;/code&gt;, where &lt;code&gt;gamma = beta*(2**16-1),&lt;/code&gt; rather than uniform over &lt;code&gt;range(Q)&lt;/code&gt;. Let&amp;#39;s also modify &lt;code&gt;initialize()&lt;/code&gt; to sample the entries of &lt;code&gt;(y1,y2)&lt;/code&gt; from the same range and see what happens:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;def initialize(A):\n\ty1 = gen_mat(N, 1, -gamma, gamma+1)\n\ty2 = gen_mat(N, 1, -gamma, gamma+1)\n\tw = (A*y1 + y2) % Q\n\treturn (H(w), (y1, y2))\n\n((A, t), (s1, s2)) = key_gen()\nprint(&amp;#039;s1={}&amp;#039;.format(s1.T % Q))\nfor _ in range(10):\n    (w, (y1, y2)) = initialize(A)\n    c = challenge()\n    (z1, z2) = finish(s1, s2, y1, y2, c)\n    print(&amp;#039;c={}, z1={}&amp;#039;.format(c, z1.T))\n# s1=[[3 0 1]]\n# c=31476, z1=[[175933 141954  93186]]\n# c=27360, z1=[[    136404 2147438807     283758]]\n# c=33536, z1=[[2147430945 2147377022     190671]]\n# c=23283, z1=[[186516  73400   4955]]\n# c=24756, z1=[[    328377 2147438906 2147388768]]\n# c=12428, z1=[[2147340715     188675      90282]]\n# c=24266, z1=[[    175498 2147261581 2147301553]]\n# c=45331, z1=[[357595 185269 177155]]\n# c=45641, z1=[[     21592 2147249191 2147446200]]\n# c=57893, z1=[[297750 113335 144894]]&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This is definitely going in the right direction, since there are no obvious correlations between &lt;code&gt;z1&lt;/code&gt; and &lt;code&gt;s1&lt;/code&gt;. (Likewise for &lt;code&gt;z2&lt;/code&gt; and &lt;code&gt;s2&lt;/code&gt;.) However, we&amp;#39;re not quite there.&lt;/p&gt;&lt;p&gt;One problem is that the challenge space is still quite small. With only &lt;code&gt;2**16 &lt;/code&gt;challenges to choose from, we&amp;#39;re likely to see a collision even after only a handful of protocol executions. We need the challenge space to be much, much larger, say around &lt;code&gt;2**256&lt;/code&gt;. But then &lt;code&gt;Q&lt;/code&gt; has to be an insanely large number in order for the &lt;code&gt;beta&lt;/code&gt; to &lt;code&gt;Q&lt;/code&gt; ratio to be secure.&lt;/p&gt;&lt;p&gt;ML-DSA is able to side step this problem due to its use of arithmetic over polynomial rings. It uses the same modulus polynomial as ML-KEM, so the challenge is a polynomial with 256 coefficients. The coefficients are chosen carefully so that the challenge space is large, but multiplication by the challenge scales the secret vector by a small amount. Note that we still end up using a slightly larger modulus (&lt;code&gt;Q=8380417&lt;/code&gt;) for ML-DSA than for ML-KEM, but only by about twelve bits.&lt;/p&gt;&lt;p&gt;However, there is a more fundamental problem here, which is that we haven&amp;#39;t completely ruled out that signatures may leak information about the secret key.&lt;/p&gt;&lt;h5&gt;Cause and effect&lt;/h5&gt;&lt;p&gt;Suppose we run the protocol a number of times, and in each run, we happen to choose a relatively small value for some entry of &lt;code&gt;y1&lt;/code&gt;. After enough runs, this would eventually allow us to reconstruct the corresponding entry of &lt;code&gt;s1&lt;/code&gt;. To rule this out as a possibility, we need to make &lt;code&gt;y1 &lt;/code&gt;even longer. (Likewise for &lt;code&gt;y2&lt;/code&gt;.) But how long?&lt;/p&gt;&lt;p&gt;Suppose we know that the entries of &lt;code&gt;z1&lt;/code&gt; and &lt;code&gt;z2&lt;/code&gt; are always in &lt;code&gt;range(-beta_loose,beta_loose+1) &lt;/code&gt;for some &lt;code&gt;beta_loose &amp;gt; beta&lt;/code&gt;. Then we can &lt;b&gt;simulate &lt;/b&gt;an honest run of the protocol as follows:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;def simulate(A, t):\n    z1 = gen_mat(N, 1, -beta_loose, beta_loose+1)\n    z2 = gen_mat(N, 1, -beta_loose, beta_loose+1)\n    c = challenge()\n    w = (A*z1 + z2 - c*t) % Q\n    return (H(w), c, (z1, z2))\n\n# Test\n((A, t), (s1, s2)) = key_gen()\n(hw, c, (z1, z2)) = simulate(A, t)\nassert verify(A, t, hw, c, z1, z2)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This procedure perfectly simulates honest runs of the protocol, in the sense that the output of &lt;code&gt;simulate() &lt;/code&gt;is indistinguishable from the transcript of a real run of the protocol with the honest prover. To see this, notice that the &lt;code&gt;w&lt;/code&gt;,&lt;code&gt; c&lt;/code&gt;, &lt;code&gt;z1&lt;/code&gt;, and &lt;code&gt;z2 &lt;/code&gt;all have the same mathematical relationship (the verification equation still holds) and have the same distribution.&lt;/p&gt;&lt;p&gt;And here&amp;#39;s the punch line: since this procedure doesn&amp;#39;t use the secret key, it follows that the attacker learns nothing from eavesdropping on the honest prover that it can&amp;#39;t compute from the public key itself. Pretty neat!&lt;/p&gt;&lt;p&gt;What&amp;#39;s left to do is arrange for &lt;code&gt;z1&lt;/code&gt; and &lt;code&gt;z2&lt;/code&gt; to fall in this range. First, we modify &lt;code&gt;initialize() &lt;/code&gt;by increasing the range of &lt;code&gt;y1 &lt;/code&gt;and&lt;code&gt; y2 &lt;/code&gt;by&lt;code&gt; beta_loose&lt;/code&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;def initialize(A):\n    y1 = gen_mat(N, 1, -gamma+beta_loose, gamma+beta_loose+1)\n    y2 = gen_mat(N, 1, -gamma+beta_loose, gamma+beta_loose+1)\n    w = (A*y1 + y2) % Q\n    return (H(w), (y1, y2))&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This ensures the proof vectors &lt;code&gt;z1&lt;/code&gt; and &lt;code&gt;z2 &lt;/code&gt;are roughly uniform over r&lt;code&gt;ange(-beta_loose, beta_loose+1)&lt;/code&gt;. However, they may fall slightly outside of this range, so need to modify &lt;code&gt;finalize() &lt;/code&gt;to &lt;b&gt;abort &lt;/b&gt;if not. Correspondingly, &lt;code&gt;verify() &lt;/code&gt;should reject proof vectors that are out of range:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;def finish(s1, s2, y1, y2, c):\n    z1 = (c*s1 + y1) % Q\n    z2 = (c*s2 + y2) % Q\n    if not in_range(z1, beta_loose) or not in_range(z2, beta_loose):\n        return (None, None)\n    return (z1, z2)\n\ndef verify(A, t, hw, c, z1, z2):\n    if not in_range(z1, beta_loose) or not in_range(z2, beta_loose):\n        return False\n    return H((A*z1 + z2 - c*t) % Q) == hw&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;If &lt;code&gt;finish()&lt;/code&gt; returns &lt;code&gt;(None,None)&lt;/code&gt;, then the prover and verifier are meant to abort the protocol and retry until the protocol succeeds:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;((A, t), (s1, s2)) = key_gen()\nwhile True:\n    (hw, (y1, y2)) = initialize(A)        # hw: prover -&amp;gt; verifier\n    c = challenge()                       # c: verifier -&amp;gt; prover\n    (z1, z2) = finish(s1, s2, y1, y2, c)  # (z1, z2): prover -&amp;gt; verifier\n    if z1 is not None and z2 is not None:\n        break\nassert verify(A, t, hw, c, z1, z2)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Interestingly, we should expect aborts to be quite common. The parameters of ML-DSA are tuned so that the protocol runs five times on average before it succeeds.&lt;/p&gt;&lt;p&gt;Another interesting point is that the security proof requires us to simulate not only successful protocol runs, but aborted protocol runs as well. More specifically, the protocol simulator must abort with the same probability as the real protocol, which implies that the rejection probability is &lt;i&gt;independent &lt;/i&gt;of the secret key.&lt;/p&gt;&lt;p&gt;The simulator also needs to be able to produce realistic looking commitments for aborted transcripts. This is exactly why the prover commits to the &lt;i&gt;hash&lt;/i&gt; of &lt;code&gt;w &lt;/code&gt;rather than &lt;code&gt;w &lt;/code&gt; itself: in the security proof, we can easily simulate hashes of random inputs.&lt;/p&gt;&lt;h4&gt;Making this scheme efficient&lt;/h4&gt;&lt;p&gt;ML-DSA benefits from many of the same optimizations as ML-KEM, including using polynomial rings, NTT for polynomial multiplication, and encoding polynomials with a fixed number of bits. However, ML-DSA has a few more tricks to make things smaller.&lt;/p&gt;&lt;p&gt;First, in ML-DSA, instead of the pair of short vectors &lt;code&gt;z1 &lt;/code&gt;and &lt;code&gt;z2&lt;/code&gt;, the proof consists of a single vector &lt;code&gt;z=c*s1 + y,&lt;/code&gt; where &lt;code&gt;y&lt;/code&gt; was committed to in the previous step. In turn, we only end up with a single proof vector &lt;code&gt;z&lt;/code&gt; rather than two as before. Getting this to work requires a special encoding of the commitment so that we can&amp;#39;t compute &lt;code&gt;y&lt;/code&gt; from it. ML-DSA uses a related trick to reduce the size of the &lt;code&gt;t&lt;/code&gt; vector of the public key, but the details are more complicated.&lt;/p&gt;&lt;p&gt;For the parameters we expect to deploy first (ML-DSA-44), the public key is 1312 bytes long and the signature is a whopping 2420 bytes. In contrast to ML-KEM, it is possible to shave off some more bytes. This does not come for free and requires complicating the scheme. An example is &lt;a href=\&quot;https://eprint.iacr.org/2023/624.pdf\&quot;&gt;&lt;u&gt;HAETAE&lt;/u&gt;&lt;/a&gt;, which changes the distributions used. &lt;a href=\&quot;https://github.com/pornin/rust-fn-dsa\&quot;&gt;&lt;u&gt;Falcon&lt;/u&gt;&lt;/a&gt; takes it a step further with even smaller signatures, using a completely different approach, which although elegant is also more complex to implement.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;wrap-up\&quot;&gt;Wrap up&lt;/h3&gt;\n            &lt;a href=\&quot;#wrap-up\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Lattice cryptography underpins the first generation of PQ algorithms to get widely deployed on the Internet. ML-KEM is already widely used today to protect encryption from quantum computers, and in the coming years we expect to see ML-DSA deployed to get ahead of the threat of quantum computers to authentication.&lt;/p&gt;&lt;p&gt;Lattices are also the basis of a new frontier for cryptography: computing on encrypted data.&lt;/p&gt;&lt;p&gt;Suppose you wanted to aggregate some metrics submitted by clients without learning the metrics themselves. &lt;a href=\&quot;https://eprint.iacr.org/2024/936\&quot;&gt;&lt;u&gt;With LWE-based encryption&lt;/u&gt;&lt;/a&gt;, you can arrange for each client to encrypt their metrics before submission, aggregate the ciphertexts, then decrypt to get the aggregate.&lt;/p&gt;&lt;p&gt;Suppose instead that a server has a database that it wants to provide clients access to without revealing to the server which rows of the database the client wants to query. &lt;a href=\&quot;https://eprint.iacr.org/2022/949\&quot;&gt;&lt;u&gt;LWE-based encryption&lt;/u&gt;&lt;/a&gt; allows the database to be encoded in a manner that permits encrypted queries.&lt;/p&gt;&lt;p&gt;These applications are special cases of a paradigm known as &lt;a href=\&quot;https://en.wikipedia.org/wiki/Homomorphic_encryption\&quot;&gt;&lt;u&gt;FHE&lt;/u&gt;&lt;/a&gt; (&amp;quot;Fully Homomorphic Encryption&amp;quot;), which allows for arbitrary computations on encrypted data. FHE is an extremely powerful primitive, and the only way we know how to build it today is with lattices. However, for most applications, FHE is far less practical than a special-purpose protocol would be (lattice-based or not). Still, over the years we&amp;#39;ve seen FHE get better and better, and for many applications it is already a decent option. Perhaps we&amp;#39;ll dig into this and other lattice schemes in a future blog post.&lt;/p&gt;&lt;p&gt;We hope you enjoyed this whirlwind tour of lattices. Thanks for reading!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-21T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-21T13:00:02.907Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1mRVILukccbpDXUHoFlnL9/a1d7b3ab969e4bdc685579280fdd1f25/image1.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;1QsJUMpv0QBSLiVZLLQJ3V&quot;],&quot;name&quot;:[0,&quot;Cryptography&quot;],&quot;slug&quot;:[0,&quot;cryptography&quot;]}],[0,{&quot;id&quot;:[0,&quot;6bIo7ayy56Fzdrtf9z2EWy&quot;],&quot;name&quot;:[0,&quot;Post-Quantum&quot;],&quot;slug&quot;:[0,&quot;post-quantum&quot;]}],[0,{&quot;id&quot;:[0,&quot;1x7tpPmKIUCt19EDgM1Tsl&quot;],&quot;name&quot;:[0,&quot;Research&quot;],&quot;slug&quot;:[0,&quot;research&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Christopher Patton&quot;],&quot;slug&quot;:[0,&quot;christopher-patton&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4sRmXhNpfDUovdIUpP9Keq/8dfd4dfc04f8f6d45b0a69121edfa0e2/christopher-patton.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Peter Schwabe (Guest Author)&quot;],&quot;slug&quot;:[0,&quot;peter-schwabe-guest-author&quot;],&quot;bio&quot;:[0,&quot;Max Planck Institute for Security and Privacy and Radboud University&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4MndFw1QKvbEOL1MY9ZxIL/d2a06518a52fca474ce6ee8aa98fc7dc/peter__1_.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}]]],&quot;meta_description&quot;:[0,&quot;This post is a beginner&#39;s guide to lattices, the math at the heart of the transition to post-quantum (PQ) cryptography. It explains how to do lattice-based encryption and authentication from scratch.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/lattice-crypto-primer&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Prepping for post-quantum: a beginnerâs guide to lattice cryptography&quot;],&quot;description&quot;:[0,&quot;This post is a beginner&#39;s guide to lattices, the math at the heart of the transition to post-quantum (PQ) cryptography. It explains how to do lattice-based encryption and authentication from scratch.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2j4AtvLRTPrcNrSyFo4zwi/31f3751fd2df1a0d26f51cf4c00ad263/OG_Share_2024__3_.png&quot;]}]}]]],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}],&quot;localesAvailable&quot;:[1,[]],&quot;footerBlurb&quot;:[0,&quot;Cloudflare&#39;s connectivity cloud protects &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/network-services/&#39; rel=&#39;noreferrer&#39;&gt;entire corporate networks&lt;/a&gt;, helps customers build &lt;a target=&#39;_blank&#39; href=&#39;https://workers.cloudflare.com/&#39; rel=&#39;noreferrer&#39;&gt;Internet-scale applications efficiently&lt;/a&gt;, accelerates any &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/performance/accelerate-internet-applications/&#39; rel=&#39;noreferrer&#39;&gt;website or Internet application&lt;/a&gt;, &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/ddos/&#39; rel=&#39;noreferrer&#39;&gt;wards off DDoS attacks&lt;/a&gt;, keeps &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/application-security/&#39; rel=&#39;noreferrer&#39;&gt;hackers at bay&lt;/a&gt;, and can help you on &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/products/zero-trust/&#39; rel=&#39;noreferrer&#39;&gt;your journey to Zero Trust&lt;/a&gt;.&lt;br/&gt;&lt;br/&gt;Visit &lt;a target=&#39;_blank&#39; href=&#39;https://one.one.one.one/&#39; rel=&#39;noreferrer&#39;&gt;1.1.1.1&lt;/a&gt; from any device to get started with our free app that makes your Internet faster and safer.&lt;br/&gt;&lt;br/&gt;To learn more about our mission to help build a better Internet, &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/learning/what-is-cloudflare/&#39; rel=&#39;noreferrer&#39;&gt;start here&lt;/a&gt;. If you&amp;apos;re looking for a new career direction, check out &lt;a target=&#39;_blank&#39; href=&#39;http://www.cloudflare.com/careers&#39; rel=&#39;noreferrer&#39;&gt;our open positions&lt;/a&gt;.&quot;]}" ssr client="load" opts="{&quot;name&quot;:&quot;Post&quot;,&quot;value&quot;:true}" await-children><main id="post" class="flex flex-row flex-wrap items-center justify-center pt2 pt4-l"><article class="post-full mw-100 ph3 ph0-l fs-20px"><h1 class="f6 f7-l fw4 gray1 pt1 pt3-l mb1">Improved Bot Management flexibility and visibility with new high-precision heuristics</h1><p class="f3 fw5 gray5 db di-l mt2">2025-03-19</p><ul class="author-lists flex pl0 mt4"><li class="list flex items-center pr2 mb1-ns"><a href="/author/curtis-lowder/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7nRYvsW2SrtTZfr9JeX3pL/cf30e6b9652d7d4e1c589cbed3961d60/Curtis_Lowder.png" alt="Curtis Lowder" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/curtis-lowder/" class="fw4 f3 no-underline black mr3">Curtis Lowder</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/brian-mitchell/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6TRFlHnVIfXX2cQhjt7wuc/86f2173516450dfa1e035b04cd4671c6/Screenshot_2024-12-21_at_17.56.35.png" alt="Brian Mitchell" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/brian-mitchell/" class="fw4 f3 no-underline black mr3">Brian Mitchell</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/adam-martinetti/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3sL65Jw7yfClw41pjnBfKp/75bfcc0615d0f01e0631ab0139900cd2/adam-martinetti.jpg" alt="Adam Martinetti" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/adam-martinetti/" class="fw4 f3 no-underline black mr3">Adam Martinetti</a></div></li></ul><section class="post-full-content"><div class="mb2 gray5">7 min read</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5dT9qTVfruhhuHXbJ2N880/792486605cb75cc693f4a64fd3675961/BLOG_1398.png" alt=""/><div class="post-content lh-copy gray1"><p>Within the Cloudflare Application Security team, every <a href="https://www.cloudflare.com/learning/ai/what-is-machine-learning/"><u>machine learning</u></a> model we use is underpinned by a rich set of static rules that serve as a ground truth and a baseline comparison for how our models are performing. These are called heuristics. Our Bot Management heuristics engine has served as an important part of eight global <a href="https://developers.cloudflare.com/bots/concepts/bot-score/#machine-learning"><u>machine learning (ML) models</u></a>, but we needed a more expressive engine to increase our accuracy. In this post, weâll review how we solved this by moving our heuristics to the Cloudflare <a href="https://developers.cloudflare.com/ruleset-engine/"><u>Ruleset Engine</u></a>. Not only did this provide the platform we needed to write more nuanced rules, it made our platform simpler and safer, and provided <a href="https://www.cloudflare.com/application-services/products/bot-management/"><u>Bot Management</u></a> customers more flexibility and visibility into their bot traffic.Â Â Â </p>
          <div class="flex anchor relative">
            <h3 id="bot-detection-via-simple-heuristics">Bot detection via simple heuristics</h3>
            <a href="#bot-detection-via-simple-heuristics" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>In Cloudflareâs bot detection, we build heuristics from attributes like software library fingerprints, HTTP request characteristics, and internal threat intelligence. Heuristics serve three separate purposes for bot detection:Â </p><ol><li><p>Bot identification: If traffic matches a heuristic, we can identify the traffic as definitely automated traffic (with a <a href="https://developers.cloudflare.com/bots/concepts/bot-score/"><u>bot score</u></a> of 1) without the need of a machine learning model.Â </p></li><li><p>Train ML models: When traffic matches our heuristics, we create labelled datasets of bot traffic to train new models. Weâll use many different sources of labelled bot traffic to train a new model, but our heuristics datasets are one of the highest confidence datasets available to us.Â Â Â </p></li><li><p>Validate models: We benchmark any new model candidateâs performance against our heuristic detections (among many other checks) to make sure it meets a required level of accuracy.</p></li></ol><p>While the existing heuristics engine has worked very well for us, as bots evolved we needed the flexibility to write increasingly complex rules. Unfortunately, such rules were not easily supported in the old engine. Customers have also been asking for more details about which specific heuristic caught a request, and for the flexibility to enforce different policies per heuristic ID.Â  We found that by building a new heuristics framework integrated into the Cloudflare Ruleset Engine, we could build a more flexible system to write rules and give Bot Management customers the granular explainability and control they were asking for.Â </p>
          <div class="flex anchor relative">
            <h3 id="the-need-for-more-efficient-precise-rules">The need for more efficient, precise rules</h3>
            <a href="#the-need-for-more-efficient-precise-rules" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>In our previous heuristics engine, we wrote rules in <a href="https://www.lua.org/"><u>Lua</u></a> as part of our <a href="https://openresty.org/"><u>openresty</u></a>-based reverse proxy. The Lua-based engine was limited to a very small number of characteristics in a rule because of the high engineering cost we observed with adding more complexity.</p><p>With Lua, we would write fairly simple logic to match on specific characteristics of a request (i.e. user agent). Creating new heuristics of an existing class was fairly straight forward. All weâd need to do is define another instance of the existing class in our database. However, if we observed malicious traffic that required more than two characteristics (as a simple example, user-agent and <a href="https://en.wikipedia.org/wiki/Autonomous_system_(Internet)"><u>ASN</u></a>) to identify, weâd need to create bespoke logic for detections. Because our Lua heuristics engine was bundled with the code that ran ML models and other important logic, all changes had to go through the same review and release process. If we identified malicious traffic that needed a new heuristic class, and we were also blocked by pending changes in the codebase, weâd be forced to either wait or rollback the changes. If weâre writing a new rule for an âunder attackâ scenario, every extra minute it takes to deploy a new rule can mean an unacceptable impact to our customerâs business.Â </p><p>More critical than time to deploy is the complexity that the heuristics engine supports. The old heuristics engine only supported using specific request attributes when creating a new rule. As bots became more sophisticated, we found we had to reject an increasing number of new heuristic candidates because we werenât able to write precise enough rules. For example, we found a <a href="https://go.dev/"><u>Golang</u></a> TLS fingerprint frequently used by bots and by a small number of corporate VPNs. We couldnât block the bots without also stopping the legitimate VPN usage as well, because the old heuristics platform lacked the flexibility to quickly compile sufficiently nuanced rules. Luckily, we already had the perfect solution with Cloudflare Ruleset Engine.Â </p>
          <div class="flex anchor relative">
            <h3 id="our-new-heuristics-engine">Our new heuristics engine</h3>
            <a href="#our-new-heuristics-engine" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>The Ruleset Engine is familiar to anyone who has written a WAF rule, Load Balancing rule, or Transform rule, <a href="https://blog.cloudflare.com/announcing-firewall-rules/"><u>just to name a few</u></a>. For Bot Management, the Wireshark-inspired syntax allows us to quickly write heuristics with much greater flexibility to vastly improve accuracy. We can write a rule in <a href="https://yaml.org/"><u>YAML</u></a> that includes arbitrary sub-conditions and inherit the same framework the WAF team uses to both ensure any new rule undergoes a rigorous testing process with the ability to rapidly release new rules to stop attacks in real-time.Â </p><p>Writing heuristics on the Cloudflare Ruleset Engine allows our engineers and analysts to write new rules in an easy to understand YAML syntax. This is critical to supporting a rapid response in under attack scenarios, especially as we support greater rule complexity. Hereâs a simple rule using the new engine, to detect empty user-agents restricted to a specific JA4 fingerprint (right), compared to the empty user-agent detection in the old Lua based system (left):Â </p><table><tr><td><p><b>Old</b></p></td><td><p><b>New</b></p></td></tr><tr><td><p><code>local _M = {}</code></p><p><code>local EmptyUserAgentHeuristic = {</code></p><p><code>Â Â Â heuristic = {},</code></p><p><code>}</code></p><p><code>EmptyUserAgentHeuristic.__index = EmptyUserAgentHeuristic</code></p><p><code>--- Creates and returns empty user agent heuristic</code></p><p><code>-- @param params table contains parameters injected into EmptyUserAgentHeuristic</code></p><p><code>-- @return EmptyUserAgentHeuristic table</code></p><p><code>function _M.new(params)</code></p><p><code>Â Â Â return setmetatable(params, EmptyUserAgentHeuristic)</code></p><p><code>end</code></p><p><code>--- Adds heuristic to be used for inference in `detect` method</code></p><p><code>-- @param heuristic schema.Heuristic table</code></p><p><code>function EmptyUserAgentHeuristic:add(heuristic)</code></p><p><code>Â Â Â self.heuristic = heuristic</code></p><p><code>end</code></p><p><code>--- Detect runs empty user agent heuristic detection</code></p><p><code>-- @param ctx context of request</code></p><p><code>-- @return schema.Heuristic table on successful detection or nil otherwise</code></p><p><code>function EmptyUserAgentHeuristic:detect(ctx)</code></p><p><code>Â Â Â local ua = ctx.user_agent</code></p><p><code>Â Â Â if not ua or ua == &#39;&#39; then</code></p><p><code>Â Â Â Â Â Â return self.heuristic</code></p><p><code>Â Â Â end</code></p><p><code>end</code></p><p><code>return _M</code></p></td><td><p><code>ref: empty-user-agent</code></p><p><code>Â Â Â Â Â Â description: Empty or missing </code></p><p><code>User-Agent header</code></p><p><code>Â Â Â Â Â Â action: add_bot_detection</code></p><p><code>Â Â Â Â Â Â action_parameters:</code></p><p><code>Â Â Â Â Â Â Â Â active_mode: false</code></p><p><code>Â Â Â Â Â Â expression: http.user_agent eq </code></p><p><code>&quot;&quot; and cf.bot_management.ja4 = &quot;t13d1516h2_8daaf6152771_b186095e22b6&quot;</code></p></td></tr></table><p>The Golang heuristic that captured corporate proxy traffic as well (mentioned above) was one of the first to migrate to the new Ruleset engine. Before the migration, traffic matching on this heuristic had a false positive rate of 0.01%. While that sounds like a very small number, this means for every million bots we block, 100 real users saw a Cloudflare challenge page unnecessarily. At Cloudflare scale, even small issues can have real, negative impact.</p><p>When we analyzed the traffic caught by this heuristic rule in depth, we saw the vast majority of attack traffic came from a small number of abusive networks. After narrowing the definition of the heuristic to flag the Golang fingerprint only when itâs sourced by the abusive networks, the rule now has a false positive rate of 0.0001% (One out of 1 million).Â  Updating the heuristic to include the network context improved our accuracy, while still blocking millions of bots every week and giving us plenty of training data for our bot detection models. Because this heuristic is now more accurate, newer ML models make more accurate decisions on whatâs a bot and what isnât.</p>
          <div class="flex anchor relative">
            <h3 id="new-visibility-and-flexibility-for-bot-management-customers">New visibility and flexibility for Bot Management customersÂ </h3>
            <a href="#new-visibility-and-flexibility-for-bot-management-customers" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>While the new heuristics engine provides more accurate detections for all customers and a better experience for our analysts, moving to the Cloudflare Ruleset Engine also allows us to deliver new functionality for Enterprise Bot Management customers, specifically by offering more visibility. This new visibility is via a new field for Bot Management customers called Bot Detection IDs. Every heuristic we use includes a unique Bot Detection ID. These are visible to Bot Management customers in analytics, logs, and firewall events, and they can be used in the firewall to write precise rules for individual bots.Â </p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3cYXHw8tFUjdJQGm93gFcE/0a3f6ab89a70410ebb7dd2c6f4f3a677/1.png" alt="" class="kg-image" width="1043" height="292" loading="lazy"/>
          </figure>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/9d7L1r7yN9AEhO26H7SgQ/434f0f934dd4f4498a8d13e85a7660ae/2.png" alt="Bot Detection IDs can be selected in HTTP Request LogPush job configurations" class="kg-image" width="1291" height="485" loading="lazy"/>
          </figure><p>Detections also include a specific tag describing the class of heuristic. Customers see these plotted over time in their analytics. </p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2UlkGQ070UWsmU76IXYqDd/6bca8f28959a8fe8f3013792a17b348a/image4.png" alt="Bot Detection tags plotted over time in customer analytics" class="kg-image" width="881" height="509" loading="lazy"/>
          </figure><p>To illustrate how this data can help give customers visibility into why we blocked a request, hereâs an example request flagged by Bot Management (with the IP address, ASN, and country changed):</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3i6k9ejsBVwlbXUrZFIFJG/4c9cddd11d9f7a8ddf10eb5ff30a027b/4.png" alt=" A Firewall Event from a request with an empty user-agent" class="kg-image" width="1574" height="580" loading="lazy"/>
          </figure><p>Before, just seeing that our heuristics gave the request a score of 1 was not very helpful in understanding why it was flagged as a bot. Adding our Detection IDs to Firewall Events helps to paint a better picture for customers that weâve identified this request as a bot because that traffic used an empty user-agent. </p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5UQd20VnXCnIav1skHiX6i/18e0cf01106601ae7faf18be50d43365/5.png" alt="A Firewall Event from a request with an empty user-agent that now receives a detection ID described as âempty_ua"" class="kg-image" width="1528" height="938" loading="lazy"/>
          </figure><p>In addition to Analytics and Firewall Events, Bot Detection IDs are now available for Bot Management customers to use in Custom Rules, Rate Limiting Rules, Transform Rules, and Workers.Â </p><h4>Account takeover detection IDs</h4><p>One way weâre focused on improving Bot Management for our customers is by surfacing more attack-specific detections. During Birthday Week, we <a href="https://blog.cloudflare.com/a-safer-internet-with-cloudflare/"><u>launched Leaked Credentials Check</u></a> for all customers so that security teams could help <a href="https://www.cloudflare.com/zero-trust/solutions/account-takeover-prevention/"><u>prevent account takeover (ATO) attacks</u></a> by identifying accounts at risk due to leaked credentials. Weâve now added two more detections that can help Bot Management enterprise customers identify suspicious login activity via specific <a href="https://developers.cloudflare.com/bots/concepts/detection-ids/#account-takeover-detections"><u>detection IDs</u></a> that monitor login attempts and failures on the zone. These detection IDs are not currently affecting the bot score, but will begin to later in 2025. Already, they can help many customers detect more account takeover events now.</p><p>Detection ID <b>201326592 </b>monitors traffic on a customer website and looks for an anomalous rise in login failures (usually associated with brute force attacks), and ID <b>201326593 </b>looks for an anomalous rise in login attempts (usually associated with credential stuffing).Â </p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4a2LGgB1bXGwFgHQEKFSI9/ff4194a6a470e466274f7b7c51e9dc18/6.png" alt="A new Account Abuse Insights Panel in Security Analytics provides quick filters for Detection IDs measuring suspicious login attempts and failures. These detection IDs can also be combined with other Account Abuse signals like Leaked Credentials.  " class="kg-image" width="1999" height="714" loading="lazy"/>
          </figure>
          <div class="flex anchor relative">
            <h3 id="protect-your-applications">Protect your applications</h3>
            <a href="#protect-your-applications" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>If you are a Bot Management customer, log in and head over to the Cloudflare dashboard and take a look in Security Analytics for bot detection IDs <code>201326592</code> and <code>201326593</code>.</p><p>These will highlight ATO attempts targeting your site. If you spot anything suspicious, or would like to be protected against future attacks, create a rule that uses these detections to keep your application safe.</p></div></section><section class="post-full-content flex flex-row flex-wrap mw7 center mb4"><div class="post-content lh-copy w-100 gray1 bt b--gray8 pt4">Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href="https://www.cloudflare.com/careers" rel='noreferrer'>our open positions</a>.</div></section><div class="pv2 ph0-l mw7 center" id="social-buttons"><div class="mt5-l mt2 mb4 f2 flex flex-row-ns flex-column flex-wrap"><a id="social-button-hn" title="Discuss on Hacker News" href="https://news.ycombinator.com/submitlink?u=https://blog.cloudflare.com/bots-heuristics" target="_blank" rel="noreferrer" class="mr2-ns mb0-l white link b pv3 ph3 mb3 " style="background-color:#0055DC"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 512 512" class="mr2"><g><path d="M31,31v450h450V31H31z M270.1,287.6v94.9h-28.1v-94.9L165,143.5h31.9L256,254.3l59.1-110.8H347
C347,143.5,270.1,287.6,270.1,287.6z"></path></g></svg><span class="v-mid">Discuss on Hacker News</span></a></div></div><iframe sandbox="allow-scripts allow-popups allow-popups-to-escape-sandbox" title="cloudflare-tv-live-link" id="cloudflare-tv-embed" src="https://cloudflare.tv/embed/live.html" loading="lazy"></iframe><a href="/tag/security-week/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Security Week</a><a href="/tag/bots/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Bots</a><a href="/tag/bot-management/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Bot Management</a><a href="/tag/application-security/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Application Security</a><a href="/tag/machine-learning/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Machine Learning</a><a href="/tag/heuristics/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Heuristics</a><a href="/tag/edge-rules/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Edge Rules</a><a href="/tag/security/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Security</a></article></main><div class="ph3 pv3"><div class=" flex flex-row flex-wrap mw7 center"><div class="w-100 bt b--gray8"><p class="black fw5 f4 mt4">Follow on X</p></div><div class="w-100 pb2"><span>Adam Martinetti</span><span class="ph1">|</span><a href="https://x.com/@adamemcf" class="no-underline">@adamemcf</a></div><div class="w-100 pb2"><span>Cloudflare</span><span class="ph2">|</span><a href="https://x.com/@cloudflare" class="no-underline">@cloudflare</a></div></div></div><div data-testid="related-posts-section" class="pv4 ph3 ph0-l flex flex-row flex-wrap mw7 center"><div class="w-100 bt b--gray8"><p class="orange fw5 f4 mt4 ttu">Related posts</p></div><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-03-21T13:00+00:00">March 21, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/scan-cloud-dlp-with-casb/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Detecting sensitive data and misconfigurations in AWS and GCP with Cloudflare One</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">Using Cloudflareâs CASB, integrate, scan, and detect sensitive data and misconfigurations in your cloud storage accounts.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/alex-dunbrack/" class="fw5 f2 black no-underline">Alex Dunbrack</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/michael-leslie/" class="fw5 f2 black no-underline">Michael Leslie </a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/security-week/" class="no-underline f1 fw2 blue3 underline-hover">Security Week<!-- -->,</a>Â </span><span><a href="/tag/cloudflare-one/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare One<!-- -->,</a>Â </span><span><a href="/tag/casb/" class="no-underline f1 fw2 blue3 underline-hover">CASB<!-- -->,</a>Â </span><span><a href="/tag/dlp/" class="no-underline f1 fw2 blue3 underline-hover">DLP<!-- -->,</a>Â </span><span><a href="/tag/aws/" class="no-underline f1 fw2 blue3 underline-hover">AWS<!-- -->,</a>Â </span><span><a href="/tag/google-cloud/" class="no-underline f1 fw2 blue3 underline-hover">Google Cloud<!-- -->,</a>Â </span><span><a href="/tag/zero-trust/" class="no-underline f1 fw2 blue3 underline-hover">Zero Trust</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-03-21T13:00+00:00">March 21, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/browser-based-rdp/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">RDP without the risk: Cloudflare&#x27;s browser-based solution for secure third-party access</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">Cloudflare now provides clientless, browser-based support for the Remote Desktop Protocol (RDP). It enables secure, remote Windows server access without VPNs or RDP clients.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/ann-ming-samborski/" class="fw5 f2 black no-underline">Ann Ming Samborski</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/gabriel-bauman/" class="fw5 f2 black no-underline">Gabriel Bauman</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/athanasios-filippidis/" class="fw5 f2 black no-underline">Athanasios Filippidis</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/michael-borkenstein/" class="fw5 f2 black no-underline">Mike Borkenstein</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/security-week/" class="no-underline f1 fw2 blue3 underline-hover">Security Week<!-- -->,</a>Â </span><span><a href="/tag/zero-trust/" class="no-underline f1 fw2 blue3 underline-hover">Zero Trust<!-- -->,</a>Â </span><span><a href="/tag/cloudflare-zero-trust/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Zero Trust<!-- -->,</a>Â </span><span><a href="/tag/acquisitions/" class="no-underline f1 fw2 blue3 underline-hover">Acquisitions<!-- -->,</a>Â </span><span><a href="/tag/cloudflare-access/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Access<!-- -->,</a>Â </span><span><a href="/tag/cloudflare-one/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare One<!-- -->,</a>Â </span><span><a href="/tag/clientless/" class="no-underline f1 fw2 blue3 underline-hover">Clientless<!-- -->,</a>Â </span><span><a href="/tag/remote-work/" class="no-underline f1 fw2 blue3 underline-hover">Remote Work<!-- -->,</a>Â </span><span><a href="/tag/vdi/" class="no-underline f1 fw2 blue3 underline-hover">VDI<!-- -->,</a>Â </span><span><a href="/tag/remote-desktop-protocol/" class="no-underline f1 fw2 blue3 underline-hover">Remote Desktop Protocol </a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-03-21T13:00+00:00">March 21, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/improving-data-loss-prevention-accuracy-with-ai-context-analysis/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Improving Data Loss Prevention accuracy with AI-powered context analysis</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">Cloudflareâs Data Loss Prevention is reducing false positives by using a self-improving AI-powered algorithm, built on Cloudflareâs Developer Platform.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/warnessa-weaver/" class="fw5 f2 black no-underline">Warnessa Weaver</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/tom-shen/" class="fw5 f2 black no-underline">Tom Shen</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/joshua-johnson/" class="fw5 f2 black no-underline">Joshua Johnson</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/security-week/" class="no-underline f1 fw2 blue3 underline-hover">Security Week<!-- -->,</a>Â </span><span><a href="/tag/zero-trust/" class="no-underline f1 fw2 blue3 underline-hover">Zero Trust<!-- -->,</a>Â </span><span><a href="/tag/dlp/" class="no-underline f1 fw2 blue3 underline-hover">DLP<!-- -->,</a>Â </span><span><a href="/tag/sase/" class="no-underline f1 fw2 blue3 underline-hover">SASE<!-- -->,</a>Â </span><span><a href="/tag/data-protection/" class="no-underline f1 fw2 blue3 underline-hover">Data Protection<!-- -->,</a>Â </span><span><a href="/tag/cloudflare-one/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare One<!-- -->,</a>Â </span><span><a href="/tag/workers-ai/" class="no-underline f1 fw2 blue3 underline-hover">Workers AI</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-03-21T13:00+00:00">March 21, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/lattice-crypto-primer/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Prepping for post-quantum: a beginnerâs guide to lattice cryptography</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">This post is a beginner&#x27;s guide to lattices, the math at the heart of the transition to post-quantum (PQ) cryptography. It explains how to do lattice-based encryption and authentication from scratch.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/christopher-patton/" class="fw5 f2 black no-underline">Christopher Patton</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/peter-schwabe-guest-author/" class="fw5 f2 black no-underline">Peter Schwabe (Guest Author)</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/security-week/" class="no-underline f1 fw2 blue3 underline-hover">Security Week<!-- -->,</a>Â </span><span><a href="/tag/cryptography/" class="no-underline f1 fw2 blue3 underline-hover">Cryptography<!-- -->,</a>Â </span><span><a href="/tag/post-quantum/" class="no-underline f1 fw2 blue3 underline-hover">Post-Quantum<!-- -->,</a>Â </span><span><a href="/tag/research/" class="no-underline f1 fw2 blue3 underline-hover">Research</a>Â </span></div></article></div><!--astro:end--></astro-island><footer class="pt4 pb4 pl1 pr1 main-footer"><div class="mw8 center dn db-l ph3"><div class="flex flex-row justify-between"><div class="main-footer__menu-group"><ul id="getting-started-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="getting-started-menu">Getting Started<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/free/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="free-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Free plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/enterprise/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="enterprise" class="f1 blue3 no-underline underline-hover" rel="noreferrer">For enterprises</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compare-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compare plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-your-website/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="get-a-recommendation" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Get a recommendation</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/demo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="request-a-demo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Request a demo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/contact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="contact-sales" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Contact Sales</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1" data-submenu="company-menu">Resources<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/learning/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="learning-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Learning Center</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/analysts/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="analysts-report" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Analyst reports</a></li><li class="pt1 pb1"><a href="https://radar.cloudflare.com/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Radar</a></li><li class="pt1 pb1"><a href="https://cloudflare.tv/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="tv" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare TV</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/case-studies/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="case-studies" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Case Studies</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Webinar" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="webinars" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Webinars</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Whitepaper" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="white-papers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">White Papers</a></li><li class="pt1 pb1"><a href="https://developers.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-docs" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer docs</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/the-net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="theNet" class="f1 blue3 no-underline underline-hover" rel="noreferrer">theNet</a></li></ul></div><div class="main-footer__menu-group"><ul id="sales-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="sales-menu">Solutions<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connectivity-cloud/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connectivity-cloud" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connectivity cloud</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/zero-trust/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="zero-trust" class="f1 blue3 no-underline underline-hover" rel="noreferrer">SSE and SASE services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/application-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="application-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Application services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/developer-platform/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer services</a></li></ul></div><div class="main-footer__menu-group"><ul id="community-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="community-menu">Community<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://community.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="community_hub" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Community Hub</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/galileo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="galileo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Project Galileo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/athenian/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="athenian" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Athenian Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/campaigns/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="cloudflare-for-campaigns" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare for Campaigns</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/technology-partners/cidp/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="critical-infrastructure-defense-project" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Critical Infrastructure Defense Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connect2024/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connect-2024" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connect 2024</a></li></ul></div><div class="main-footer__menu-group"><ul id="support-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="support-menu">Support<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://support.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="help-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Help center</a></li><li class="pt1 pb1"><a href="https://www.cloudflarestatus.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="status" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Status</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/compliance/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compliance" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compliance</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/gdpr/introduction/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="gdpr" class="f1 blue3 no-underline underline-hover" rel="noreferrer">GDPR</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/trust-hub/abuse-approach/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="trust-and-safety" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Trust &amp; Safety</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="company-menu">Company<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-overview/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">About Cloudflare</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/people/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="our_team" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Our team</a></li><li class="pt1 pb1"><a href="https://cloudflare.net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="investor-relations" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Investor relations</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Press</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/careers/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="careers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Careers</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/diversity-equity-and-inclusion/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="diversity-equity-inclusion" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Diversity, equity &amp; inclusion</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/impact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="impact-ESG" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Impact/ESG</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network_map" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network Map</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press-kit/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press-kit" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Logos &amp; press kit</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="partners" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Become a partner</a></li></ul></div></div></div><div class="mw8 center ph3"><div class="flex flex-row flex-wrap justify-center md:justify-between items-center pt4"><div class="flex flex-row space-x-4 items-start w-25-l pb4 pb0-l"><a target="_blank" rel="noreferrer" href="https://www.facebook.com/Cloudflare/" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/facebook.svg" alt="facebook"/></a><a target=" _blank" rel="noreferrer" href="https://x.com/Cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/twitter.svg" alt="X"/></a><a target="_blank" rel="noreferrer" href="https://www.linkedin.com/company/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/linkedin.svg" alt="linkedin"/></a><a target="_blank" rel="noreferrer" href="https://www.youtube.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/youtube.svg" alt="youtube"/></a><a target="_blank" rel="noreferrer" href="https://www.instagram.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/instagram.svg" alt="instagram"/></a></div><div class="w-70-l tr-l tl-ns"><div><span class="main-footer__copyright f1">Â© <!-- -->2025<!-- --> Cloudflare, Inc.<!-- --> </span><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/privacypolicy/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Privacy Policy<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/website-terms/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Terms of Use<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/disclosure/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Report Security Issues<!-- --> </a><span class="main-footer__copyright f1">|</span><img class="mw2 ph1" src="/images/privacy-options.svg" alt="Privacy Options"/><a href="#cookie-settings" id="ot-sdk-btn" class="ot-sdk-show-settings main-footer__copyright f1 no-underline underline-hover"><span class="brandGray5">Cookie Preferences</span> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/trademark/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Trademark<!-- --> </a></div></div></div></div></footer></html><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"92416ec97d23eaca","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"2bc156e5f250476cb274d269511ffb57","b":1}' crossorigin="anonymous"></script>
