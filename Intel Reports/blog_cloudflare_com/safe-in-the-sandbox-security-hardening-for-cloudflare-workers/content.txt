<!DOCTYPE html><script type="module" src="/_astro/index.astro_astro_type_script_index_0_lang.CoXd8L9s.js"></script> <html lang="en-us" dir="ltr"> <head><script async src="https://ot.www.cloudflare.com/public/vendor/onetrust/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" data-domain-script="b1e05d49-f072-4bae-9116-bdb78af15448"></script><script type="text/javascript">
    window.loadScript = (url, { charset = 'UTF-8', ...attributes } = {}, location = 'head') => {
      const existingScript = document.querySelector('script[src="' + url + '"]');
      if (existingScript) {
        return;
      }

      const script = document.createElement('script');
      script.src = url;
      script.type = 'text/javascript';

      script.async = true;
      script.charset = charset;

      if (attributes) {
        Object.entries(attributes).forEach(([key, value]) => {
          script.setAttribute(key, value);
        });
      }

      if (location === 'head') {
        document.head.appendChild(script);
      } else {
        document.body.appendChild(script);
      }

      return script;
    };
  </script><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="KeThzeyMOr"><meta name="baidu-site-verification" content="code-NIlrS7gNhx"><meta charset="UTF-8"><meta name="description" content="Cloudflare Workers are constantly being updated to be as secure and efficient as possible. We are further hardening Workers by making use of the latest software and hardware features. We use defense-in-depth, including V8 sandboxes and the CPU's memory protection keys, to keep your data safe."><title>Safe in the sandbox: security hardening for Cloudflare Workers</title><meta name="title" content="Safe in the sandbox: security hardening for Cloudflare Workers"><meta name="msvalidate.01" content="CF295E1604697F9CAD18B5A232E871F6"><meta class="swiftype" name="language" data-type="string" content="en"><script type="text/javascript">
    function OptanonWrapper() {
      if (!window.zarazTagManager.loaded && window.OnetrustActiveGroups.includes('C0004')) {
        window.zarazTagManager.loadZaraz();
      }

      if (window.zaraz && !window.OnetrustActiveGroups.includes('C0004')) {
        window.zaraz = undefined;
        window.zarazData = undefined;
        window.zarazTagManager.loaded = false;
      }

      if (!window.isCfCookieEventAttached) {
        window.isCfCookieEventAttached = true;
        window.addEventListener('consent.onetrust', async () => {
          await fetch('/', { method: 'HEAD' });
        });
      }
    }
    window.zarazTagManager = {
      loaded: false,
      getEndPoint() {
        return '/static/z/i.js';
      },
      loadZaraz() {
        window.loadScript(window.zarazTagManager.getEndPoint());
        window.zarazTagManager.loaded = true;
      },
    };
  </script><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-32x32.png"><link rel="mask-icon" href="/images/favicon-32x32.png" color="#f78100"><link rel="stylesheet" href="/themes/ashes.min.css"><link rel="sitemap" href="/sitemap.xml"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link rel="canonical" href="https://blog.cloudflare.com/safe-in-the-sandbox-security-hardening-for-cloudflare-workers/"><link rel="alternate" hreflang="en-us" href="https://blog.cloudflare.com/safe-in-the-sandbox-security-hardening-for-cloudflare-workers/"><!-- General Meta Tags --><meta property="article:published_time" content="2025-09-25T14:00+00:00"><meta property="article:modified_time" content="2025-09-25T13:27:51.318Z"><meta property="article:tag" content="Cloudflare Workers"><meta property="article:tag" content="Birthday Week"><meta property="article:tag" content="Attacks"><meta property="article:tag" content="Engineering"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Malicious JavaScript"><meta property="article:tag" content="Security"><meta property="article:tag" content="Vulnerabilities"><meta property="article:publisher" content="https://www.facebook.com/cloudflare"><!-- Facebook Meta Tags --><meta property="og:site_name" content="The Cloudflare Blog"><meta property="og:type" content="article"><meta property="og:title" content="Safe in the sandbox: security hardening for Cloudflare Workers"><meta property="og:description" content="Cloudflare Workers are constantly being updated to be as secure and efficient as possible. We are further hardening Workers by making use of the latest software and hardware features. We use defense-in-depth, including V8 sandboxes and the CPU's memory protection keys, to keep your data safe."><meta property="og:url" content="https://blog.cloudflare.com/safe-in-the-sandbox-security-hardening-for-cloudflare-workers/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="628"><!-- Twitter/X Meta Tags --><meta name="twitter:title" content="Safe in the sandbox: security hardening for Cloudflare Workers"><meta name="twitter:description" content="Cloudflare Workers are constantly being updated to be as secure and efficient as possible. We are further hardening Workers by making use of the latest software and hardware features. We use defense-in-depth, including V8 sandboxes and the CPU's memory protection keys, to keep your data safe."><meta name="twitter:url" content="https://blog.cloudflare.com/safe-in-the-sandbox-security-hardening-for-cloudflare-workers/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label1" content="Written by"><meta name="twitter:data1" content="Erik Corry"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="Cloudflare Workers,Birthday Week,Attacks,Engineering,Linux,Malicious JavaScript,Security,Vulnerabilities"><meta name="twitter:site" content="@cloudflare"><meta property="og:image" content="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1vtdPfgEPYHJkjJfX8KN3b/7b13fffc98ce48628ebf3a5b68272ac2/OG_Share_2024_-_2025-09-25T120447.574.png"><meta name="twitter:image" content="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1vtdPfgEPYHJkjJfX8KN3b/7b13fffc98ce48628ebf3a5b68272ac2/OG_Share_2024_-_2025-09-25T120447.574.png"><link rel="stylesheet" href="/_astro/index.D82Gkzoe.css">
<style>@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
</style></head><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z1A8lat" component-url="/_astro/GoogleAnalytics.O41kpLbs.js" component-export="GoogleAnalytics" renderer-url="/_astro/client.CI64Qvmy.js" props="{&quot;title&quot;:[0,&quot;Safe in the sandbox: security hardening for Cloudflare Workers&quot;],&quot;canonical&quot;:[0,&quot;https://blog.cloudflare.com/safe-in-the-sandbox-security-hardening-for-cloudflare-workers&quot;],&quot;info&quot;:[0,{&quot;id&quot;:[0,&quot;7bZyPF4nBnr5gisZW2crax&quot;],&quot;title&quot;:[0,&quot;Safe in the sandbox: security hardening for Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;safe-in-the-sandbox-security-hardening-for-cloudflare-workers&quot;],&quot;excerpt&quot;:[0,&quot;We are further hardening Cloudflare Workers with the latest software and hardware features. We use defense-in-depth, including V8 sandboxes and the CPU&#39;s memory protection keys to keep your data safe.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;As a &lt;a href=\&quot;https://www.cloudflare.com/learning/serverless/what-is-serverless/\&quot;&gt;&lt;u&gt;serverless&lt;/u&gt;&lt;/a&gt; cloud provider, we run your code on our globally distributed infrastructure. Being able to run customer code on our network means that anyone can take advantage of our global presence and low latency. Workers isnât just efficient though, we also make it simple for our users. In short: &lt;a href=\&quot;https://workers.cloudflare.com/\&quot;&gt;&lt;u&gt;You write code. We handle the rest&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Part of &amp;#39;handling the rest&amp;#39; is making Workers as secure as possible. We have previously written about our &lt;a href=\&quot;https://blog.cloudflare.com/mitigating-spectre-and-other-security-threats-the-cloudflare-workers-security-model/\&quot;&gt;&lt;u&gt;security architecture&lt;/u&gt;&lt;/a&gt;. Making Workers secure is an interesting problem because the whole point of Workers is that we are running third party code on our hardware. This is one of the hardest security problems there is: any attacker has the full power available of a programming language running on the victim&amp;#39;s system when they are crafting their attacks.&lt;/p&gt;&lt;p&gt;This is why we are constantly updating and improving the Workers Runtime to take advantage of the latest improvements in both hardware and software. This post shares some of the latest work we have been doing to keep Workers secure.&lt;/p&gt;&lt;p&gt;Some background first: &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/workers/\&quot;&gt;&lt;u&gt;Workers&lt;/u&gt;&lt;/a&gt; is built around the &lt;a href=\&quot;https://v8.dev/\&quot;&gt;&lt;u&gt;V8&lt;/u&gt;&lt;/a&gt; JavaScript runtime, originally developed for Chromium-based browsers like Chrome. This gives us a head start, because V8 was forged in an adversarial environment, where it has always been under intense attack and &lt;a href=\&quot;https://github.blog/security/vulnerability-research/getting-rce-in-chrome-with-incorrect-side-effect-in-the-jit-compiler/\&quot;&gt;&lt;u&gt;scrutiny&lt;/u&gt;&lt;/a&gt;. Like Workers, Chromium is built to run adversarial code safely. That&amp;#39;s why V8 is constantly being tested against the best fuzzers and sanitizers, and over the years, it has been hardened with new technologies like &lt;a href=\&quot;https://v8.dev/blog/oilpan-library\&quot;&gt;&lt;u&gt;Oilpan/cppgc&lt;/u&gt;&lt;/a&gt; and improved static analysis.&lt;/p&gt;&lt;p&gt;We use V8 in a slightly different way, though, so we will be describing in this post how we have been making some changes to V8 to improve security in our use case.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;hardware-assisted-security-improvements-from-memory-protection-keys\&quot;&gt;Hardware-assisted security improvements from Memory Protection Keys&lt;/h2&gt;\n      &lt;a href=\&quot;#hardware-assisted-security-improvements-from-memory-protection-keys\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Modern CPUs from Intel, AMD, and ARM have support for &lt;a href=\&quot;https://man7.org/linux/man-pages/man7/pkeys.7.html\&quot;&gt;&lt;u&gt;memory protection keys&lt;/u&gt;&lt;/a&gt;, sometimes called &lt;i&gt;PKU&lt;/i&gt;, Protection Keys for Userspace. This is a great security feature which increases the power of virtual memory and memory protection.&lt;/p&gt;&lt;p&gt;Traditionally, the memory protection features of the CPU in your PC or phone were mainly used to protect the kernel and to protect different processes from each other. Within each process, all threads had access to the same memory. Memory protection keys allow us to prevent specific threads from accessing memory regions they shouldn&amp;#39;t have access to.&lt;/p&gt;&lt;p&gt;V8 already &lt;a href=\&quot;https://issues.chromium.org/issues/41480375\&quot;&gt;&lt;u&gt;uses memory protection keys&lt;/u&gt;&lt;/a&gt; for the &lt;a href=\&quot;https://en.wikipedia.org/wiki/Just-in-time_compilation\&quot;&gt;&lt;u&gt;JIT compilers&lt;/u&gt;&lt;/a&gt;. The JIT compilers for a language like JavaScript generate optimized, specialized versions of your code as it runs. Typically, the compiler is running on its own thread, and needs to be able to write data to the code area in order to install its optimized code. However, the compiler thread doesn&amp;#39;t need to be able to run this code. The regular execution thread, on the other hand, needs to be able to run, but not modify, the optimized code. Memory protection keys offer a way to give each thread the permissions it needs, but &lt;a href=\&quot;https://en.wikipedia.org/wiki/W%5EX\&quot;&gt;&lt;u&gt;no more&lt;/u&gt;&lt;/a&gt;. And the V8 team in the Chromium project certainly aren&amp;#39;t standing still. They describe some of their future plans for memory protection keys &lt;a href=\&quot;https://docs.google.com/document/d/1l3urJdk1M3JCLpT9HDvFQKOxuKxwINcXoYoFuKkfKcc/edit?tab=t.0#heading=h.gpz70vgxo7uc\&quot;&gt;&lt;u&gt;here&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;In Workers, we have some different requirements than Chromium. &lt;a href=\&quot;https://developers.cloudflare.com/workers/reference/security-model/\&quot;&gt;&lt;u&gt;The security architecture for Workers&lt;/u&gt;&lt;/a&gt; uses V8 isolates to separate different scripts that are running on our servers. (In addition, we have &lt;a href=\&quot;https://blog.cloudflare.com/spectre-research-with-tu-graz/\&quot;&gt;&lt;u&gt;extra mitigations&lt;/u&gt;&lt;/a&gt; to harden the system against &lt;a href=\&quot;https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)\&quot;&gt;&lt;u&gt;Spectre&lt;/u&gt;&lt;/a&gt; attacks). If V8 is working as intended, this should be enough, but we believe in &lt;i&gt;defense in depth&lt;/i&gt;: multiple, overlapping layers of security controls.&lt;/p&gt;&lt;p&gt;That&amp;#39;s why we have deployed internal modifications to V8 to use memory protection keys to isolate the isolates from each other. There are up to 15 different keys available on a modern x64 CPU and a few are used for other purposes in V8, so we have about 12 to work with. We give each isolate a random key which is used to protect its V8 &lt;i&gt;heap data&lt;/i&gt;, the memory area containing the JavaScript objects a script creates as it runs. This means security bugs that might previously have allowed an attacker to read data from a different isolate would now hit a hardware trap in 92% of cases. (Assuming 12 keys, 92% is about 11/12.)&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4cHaaZrAhQf759og04S63G/59ff1974dc878ec8ad7d40f1f079be37/image9.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1466\&quot; height=\&quot;606\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The illustration shows an attacker attempting to read from a different isolate. Most of the time this is detected by the mismatched memory protection key, which kills their script and notifies us, so we can investigate and remediate. The red arrow represents the case where the attacker got lucky by hitting an isolate with the same memory protection key, represented by the isolates having the same colors.&lt;/p&gt;&lt;p&gt;However, we can further improve on a 92% protection rate. In the last part of this blog post we&amp;#39;ll explain how we can lift that to 100% for a particular common scenario. But first, let&amp;#39;s look at a software hardening feature in V8 that we are taking advantage of.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;the-v8-sandbox-a-software-based-security-boundary\&quot;&gt;The V8 sandbox, a software-based security boundary&lt;/h2&gt;\n      &lt;a href=\&quot;#the-v8-sandbox-a-software-based-security-boundary\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Over the past few years, V8 has been gaining another defense in depth feature: the V8 sandbox. (Not to be confused with the &lt;a href=\&quot;https://blog.cloudflare.com/sandboxing-in-linux-with-zero-lines-of-code/\&quot;&gt;&lt;u&gt;layer 2 sandbox&lt;/u&gt;&lt;/a&gt; which Workers have been using since the beginning.) The V8 sandbox has been a multi-year project that has been gaining &lt;a href=\&quot;https://v8.dev/blog/sandbox\&quot;&gt;&lt;u&gt;maturity&lt;/u&gt;&lt;/a&gt; for a while. The sandbox project stems from the observation that many V8 security vulnerabilities start by corrupting objects in the V8 heap memory. Attackers then leverage this corruption to reach other parts of the process, giving them the opportunity to escalate and gain more access to the victim&amp;#39;s browser, or even the entire system.&lt;/p&gt;&lt;p&gt;V8&amp;#39;s sandbox project is an ambitious software security mitigation that aims to thwart that escalation: to make it impossible for the attacker to progress from a corruption on the V8 heap to a compromise of the rest of the process. This means, among other things, removing all pointers from the heap. But first, let&amp;#39;s explain in as simple terms as possible, what a memory corruption attack is.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;memory-corruption-attacks\&quot;&gt;Memory corruption attacks&lt;/h3&gt;\n      &lt;a href=\&quot;#memory-corruption-attacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;A memory corruption attack tricks a program into misusing its own memory. Computer memory is just a store of integers, where each integer is stored in a location. The locations each have an &lt;i&gt;address&lt;/i&gt;, which is also just a number. Programs interpret the data in these locations in different ways, such as text, pixels, or &lt;i&gt;pointers&lt;/i&gt;. Pointers are addresses that identify a different memory location, so they act as a sort of arrow that points to some other piece of data.&lt;/p&gt;&lt;p&gt;Here&amp;#39;s a concrete example, which uses a buffer overflow. This is a form of attack that was historically common and relatively simple to understand: Imagine a program has a small buffer (like a 16-character text field) followed immediately by an 8-byte pointer to some ordinary data. An attacker might send the program a 24-character string, causing a &amp;quot;buffer overflow.&amp;quot; Because of a vulnerability in the program, the first 16 characters fill the intended buffer, but the remaining 8 characters spill over and overwrite the adjacent pointer.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5VlcKOYtfRHwWZVDb6GOPm/517ae1987c89273e1f33eb6ca11d752d/image5.png\&quot; alt=\&quot;See below for how such an attack would now be thwarted.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;831\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;See below for how such an attack would now be thwarted.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;Now the pointer has been redirected to point at sensitive data of the attacker&amp;#39;s choosing, rather than the normal data it was originally meant to access. When the program tries to use what it believes is its normal pointer, it&amp;#39;s actually accessing sensitive data chosen by the attacker.&lt;/p&gt;&lt;p&gt;This type of attack works in steps: first create a small confusion (like the buffer overflow), then use that confusion to create bigger problems, eventually gaining access to data or capabilities the attacker shouldn&amp;#39;t have.Â  The attacker can eventually use the misdirection to either steal information or plant malicious data that the program will treat as legitimate.&lt;/p&gt;&lt;p&gt;This was a somewhat abstract description of memory corruption attacks using a buffer overflow, one of the simpler techniques. For some much more detailed and recent examples, see &lt;a href=\&quot;https://googleprojectzero.blogspot.com/2015/06/what-is-good-memory-corruption.html\&quot;&gt;&lt;u&gt;this description from Google&lt;/u&gt;&lt;/a&gt;, or this &lt;a href=\&quot;https://medium.com/@INTfinitySG/miscellaneous-series-2-a-script-kiddie-diary-in-v8-exploit-research-part-1-5b0bab211f5a\&quot;&gt;&lt;u&gt;breakdown of a V8 vulnerability&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;compressed-pointers-in-v8\&quot;&gt;Compressed pointers in V8&lt;/h3&gt;\n      &lt;a href=\&quot;#compressed-pointers-in-v8\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Many attacks are based on corrupting pointers, so ideally we would remove all pointers from the memory of the program.Â  Since an object-oriented language&amp;#39;s heap is absolutely full of pointers, that would seem, on its face, to be a hopeless task, but it is enabled by an earlier development. Starting in 2020, V8 has offered the option of saving memory by using &lt;a href=\&quot;https://v8.dev/blog/pointer-compression\&quot;&gt;&lt;u&gt;compressed pointers&lt;/u&gt;&lt;/a&gt;. This means that, on a 64-bit system, the heap uses only 32 bit offsets, relative to a base address. This limits the total heap to maximally 4 GiB, a limitation that is acceptable for a browser, and also fine for individual scripts running in a V8 isolate on Cloudflare Workers.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/sO5ByQzR62UcxZiaxwcaq/2f2f0c04af57bb492e9ecaa321935112/image1.png\&quot; alt=\&quot;An artificial object with various fields, showing how the layout differs in a compressed vs. an uncompressed heap. The boxes are 64 bits wide.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;453\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;An artificial object with various fields, showing how the layout differs in a compressed vs. an uncompressed heap. The boxes are 64 bits wide.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;If the whole of the heap is in a single 4 GiB area then the first 32 bits of all pointers will be the same, and we don&amp;#39;t need to store them in every pointer field in every object. In the diagram we can see that the object pointers all start with 0x12345678, which is therefore redundant and doesn&amp;#39;t need to be stored. This means that object pointer fields and integer fields can be reduced from 64 to 32 bits.&lt;/p&gt;&lt;p&gt;We still need 64 bit fields for some fields like double precision floats and for the sandbox offsets of buffers, which are typically used by the script for input and output data. See below for details.&lt;/p&gt;&lt;p&gt;Integers in an uncompressed heap are stored in the high 32 bits of a 64 bit field. In the compressed heap, the top 31 bits of a 32 bit field are used. In both cases the lowest bit is set to 0 to indicate integers (as opposed to pointers or offsets).&lt;/p&gt;&lt;p&gt;Conceptually, we have two methods for compressing and decompressing, using a base address that is divisible by 4 GiB:&lt;/p&gt;\n            &lt;pre class=\&quot;language-C++\&quot;&gt;&lt;code class=\&quot;language-C++\&quot;&gt;// Decompress a 32 bit offset to a 64 bit pointer by adding a base address.\nvoid* Decompress(uint32_t offset) { return base + offset; }\n// Compress a 64 bit pointer to a 32 bit offset by discarding the high bits.\nuint32_t Compress(void* pointer) { return (intptr_t)pointer &amp;amp; 0xffffffff; }&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This pointer compression feature, originally primarily designed to save memory, can be used as the basis of a sandbox.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;from-compressed-pointers-to-the-sandbox\&quot;&gt;From compressed pointers to the sandbox&lt;/h3&gt;\n      &lt;a href=\&quot;#from-compressed-pointers-to-the-sandbox\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;The biggest 32-bit unsigned integer is about 4 billion, so the &lt;code&gt;Decompress()&lt;/code&gt; function cannot generate any pointer that is outside the range [base, base + 4Â GiB]. You could say the pointers are trapped in this area, so it is sometimes called the &lt;i&gt;pointer cage&lt;/i&gt;. V8 can reserve 4 GiB of virtual address space for the pointer cage so that only V8 objects appear in this range. By eliminating &lt;i&gt;all&lt;/i&gt; pointers from this range, and following some other strict rules, V8 can contain any memory corruption by an attacker to this cage. Even if an attacker corrupts a 32 bit offset within the cage, it is still only a 32 bit offset and can only be used to create new pointers that are still trapped within the pointer cage.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3r5H81eDvHgaPIBFw5gG6B/65ffa220f9141a81af893183a09321ac/image7.png\&quot; alt=\&quot;The buffer overflow attack from earlier no longer works because only the attacker&#39;s own data is available in the pointer cage.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;861\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;The buffer overflow attack from earlier no longer works because only the attacker&amp;#39;s own data is available in the pointer cage.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;To construct the sandbox, we take the 4 GiB pointer cage and add another 4 GiB for buffers and other data structures to make the 8 GiB sandbox. This is why the buffer offsets above are 33 bits, so they can reach buffers in the second half of the sandbox (40 bits in Chromium with larger sandboxes). V8 stores these buffer offsets in the high 33 bits and shifts down by 31 bits before use, in case an attacker corrupted the low bits.&lt;/p&gt;&lt;p&gt;Cloudflare Workers have made use of compressed pointers in V8 for a while, but for us to get the full power of the sandbox we had to make some changes. Until recently, all isolates in a process had to be one single sandbox if you were using the sandboxed configuration of V8. This would have limited the total size of all V8 heaps to be less than 4 GiB, far too little for our architecture, which relies on serving 1000s of scripts at once.&lt;/p&gt;&lt;p&gt;That&amp;#39;s why we commissioned &lt;a href=\&quot;https://www.igalia.com/\&quot;&gt;&lt;u&gt;Igalia&lt;/u&gt;&lt;/a&gt; to add&lt;a href=\&quot;https://dbezhetskov.dev/multi-sandboxes/\&quot;&gt;&lt;u&gt; isolate groups&lt;/u&gt;&lt;/a&gt; to V8. Each isolate group has its own sandbox and can have 1 or more isolates within it. Building on this change we have been able to start using the sandbox, eliminating a whole class of potential security issues in one stroke. Although we can place multiple isolates in the same sandbox, we are currently only putting a single isolate in each sandbox.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3jwaGI8xIAC6755vw2BWfE/d8b0cd5b36dbe8b5e628c62ef7f3d474/image2.png\&quot; alt=\&quot;The layout of the sandbox. In the sandbox there can be more than one isolate, but all their heap pages must be in the pointer cage: the first 4 GiB of the sandbox. Instead of pointers between the objects, we use 32 bit offsets. The offsets for the buffers are 33 bits, so they can reach the whole sandbox, but not outside it.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1094\&quot; height=\&quot;774\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;The layout of the sandbox. In the sandbox there can be more than one isolate, but all their heap pages must be in the pointer cage: the first 4 GiB of the sandbox. Instead of pointers between the objects, we use 32 bit offsets. The offsets for the buffers are 33 bits, so they can reach the whole sandbox, but not outside it.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;virtual-memory-isnt-infinite-theres-a-lot-going-on-in-a-linux-process\&quot;&gt;Virtual memory isn&amp;#39;t infinite, there&amp;#39;s a lot going on in a Linux process&lt;/h2&gt;\n      &lt;a href=\&quot;#virtual-memory-isnt-infinite-theres-a-lot-going-on-in-a-linux-process\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;At this point, we were not quite done, though. Each sandbox reserves 8 GiB of space in the virtual memory map of the process, and it must be 4 GiB aligned &lt;a href=\&quot;https://v8.dev/blog/pointer-compression\&quot;&gt;&lt;u&gt;for efficiency&lt;/u&gt;&lt;/a&gt;. It uses much less physical memory, but the sandbox mechanism requires this much virtual space for its security properties. This presents us with a problem, since a Linux process &amp;#39;only&amp;#39; has 128 TiB of virtual address space in a 4-level page table (another 128 TiB are reserved for the kernel, not available to user space).&lt;/p&gt;&lt;p&gt;At Cloudflare, we want to run Workers as efficiently as possible to keep costs and prices down, and to offer a generous free tier. That means that on each machine we have so many isolates running (one per sandbox) that it becomes hard to place them all in a 128 TiB space.&lt;/p&gt;&lt;p&gt;Knowing this, we have to place the sandboxes carefully in memory. Unfortunately, the Linux syscall, &lt;a href=\&quot;https://man7.org/linux/man-pages/man2/mmap.2.html\&quot;&gt;&lt;u&gt;mmap&lt;/u&gt;&lt;/a&gt;, does not allow us to specify the alignment of an allocation unless you can guess a free location to request. To get an 8 GiB area that is 4 GiB aligned, we have to ask for 12 GiB, then find the aligned 8 GiB area that must exist within that, and return the unused (hatched) edges to the OS:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7Dqey3y5ZsPugD3pyRpQUY/cdadceeb96dbb01a2062dc98c7c554bc/image6.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;266\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;If we allow the Linux kernel to place sandboxes randomly, we end up with a layout like this with gaps. Especially after running for a while, there can be both 8 GiB and 4 GiB gaps between sandboxes:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6oaIPZnjaJrLYoFK6v03oI/6c53895f1151d70f71511d8cdfa35f00/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;417\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Sadly, because of our 12 GiB alignment trick, we can&amp;#39;t even make use of the 8 GiB gaps. If we ask the OS for 12 GiB, it will never give us a gap like the 8 GiB gap between the green and blue sandboxes above. In addition, there are a host of other things going on in the virtual address space of a Linux process: the malloc implementation may want to grab pages at particular addresses, the executable and libraries are mapped at a random location by ASLR, and V8 has allocations outside the sandbox.&lt;/p&gt;&lt;p&gt;The latest generation of x64 CPUs supports a much bigger address space, which solves both problems, and Linux kernels are able to make use of the extra bits with &lt;a href=\&quot;https://en.wikipedia.org/wiki/Intel_5-level_paging\&quot;&gt;&lt;u&gt;five level page tables&lt;/u&gt;&lt;/a&gt;. A process has to &lt;a href=\&quot;https://lwn.net/Articles/717293/\&quot;&gt;&lt;u&gt;opt into this&lt;/u&gt;&lt;/a&gt;, which is done by a single mmap call suggesting an address outside the 47 bit area. The reason this needs an opt-in is that some programs can&amp;#39;t cope with such high addresses. Curiously, V8 is one of them.&lt;/p&gt;&lt;p&gt;This isn&amp;#39;t hard to fix in V8, but not all of our fleet has been upgraded yet to have the necessary hardware. So for now, we need a solution that works with the existing hardware. We have modified V8 to be able to grab huge memory areas and then use &lt;a href=\&quot;https://man7.org/linux/man-pages/man2/mprotect.2.html\&quot;&gt;&lt;u&gt;mprotect syscalls&lt;/u&gt;&lt;/a&gt; to create tightly packed 8 GiB spaces for sandboxes, bypassing the inflexible mmap API.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7kPgAWxoR7nDsZHUOBsNMp/15e7b2a1aac827acfce8b0d614e44cde/image8.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;612\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;putting-it-all-together\&quot;&gt;Putting it all together&lt;/h2&gt;\n      &lt;a href=\&quot;#putting-it-all-together\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Taking control of the sandbox placement like this actually gives us a security benefit, but first we need to describe a particular threat model.&lt;/p&gt;&lt;p&gt;We assume for the purposes of this threat model that an attacker has an arbitrary way to corrupt data within the sandbox. This is historically the first step in many V8 exploits. So much so that there is a &lt;a href=\&quot;https://bughunters.google.com/about/rules/chrome-friends/5745167867576320/chrome-vulnerability-reward-program-rules#v8-sandbox-bypass-rewards\&quot;&gt;&lt;u&gt;special tier&lt;/u&gt;&lt;/a&gt; in Google&amp;#39;s V8 bug bounty program where you may &lt;i&gt;assume&lt;/i&gt; you have this ability to corrupt memory, and they will pay out if you can leverage that to a more serious exploit.&lt;/p&gt;&lt;p&gt;However, we assume that the attacker does not have the ability to execute arbitrary machine code. If they did, they could &lt;a href=\&quot;https://www.usenix.org/system/files/sec20fall_connor_prepub.pdf\&quot;&gt;&lt;u&gt;disable memory protection keys&lt;/u&gt;&lt;/a&gt;. Having access to the in-sandbox memory only gives the attacker access to their own data. So the attacker must attempt to escalate, by corrupting data inside the sandbox to access data outside the sandbox.&lt;/p&gt;&lt;p&gt;You will recall that the compressed, sandboxed V8 heap only contains 32 bit offsets. Therefore, no corruption there can reach outside the pointer cage. But there are also arrays in the sandbox â vectors of data with a given size that can be accessed with an index. In our threat model, the attacker can modify the sizes recorded for those arrays and the indexes used to access elements in the arrays. That means an attacker could potentially turn an array in the sandbox into a tool for accessing memory incorrectly. For this reason, the V8 sandbox normally has &lt;i&gt;guard regions&lt;/i&gt; around it: These are 32 GiB virtual address ranges that have no virtual-to-physical address mappings. This helps guard against the worst case scenario: Indexing an array where the elements are 8 bytes in size (e.g. an array of double precision floats) using a maximal 32 bit index. Such an access could reach a distance of up to 32 GiB outside the sandbox: 8 times the maximal 32 bit index of four billion.&lt;/p&gt;&lt;p&gt;We want such accesses to trigger an alarm, rather than letting an attacker access nearby memory.Â  This happens automatically with guard regions, but we don&amp;#39;t have space for conventional 32 GiB guard regions around every sandbox.&lt;/p&gt;&lt;p&gt;Instead of using conventional guard regions, we can make use of memory protection keys. By carefully controlling which isolate group uses which key, we can ensure that no sandbox within 32 GiB has the same protection key. Essentially, the sandboxes are acting as each other&amp;#39;s guard regions, protected by memory protection keys. Now we only need a wasted 32 GiB guard region at the start and end of the huge packed sandbox areas.\n&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/53MPs8P84ayqEiTXh7gV5O/88104f74f1d51dbdda8d987e1c7df3aa/image10.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;493\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;With the new sandbox layout, we use strictly rotating memory protection keys. Because we are not using randomly chosen memory protection keys, for this threat model the 92% problem described above disappears. Any in-sandbox security issue is unable to reach a sandbox with the same memory protection key. In the diagram, we show that there is no memory within 32 GiB of a given sandbox that has the same memory protection key. Any attempt to access memory within 32 GiB of a sandbox will trigger an alarm, just like it would with unmapped guard regions.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;the-future\&quot;&gt;The future&lt;/h2&gt;\n      &lt;a href=\&quot;#the-future\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;In a way, this whole blog post is about things our customers &lt;i&gt;don&amp;#39;t&lt;/i&gt; need to do. They don&amp;#39;t need to upgrade their server software to get the latest patches, we do that for them. They don&amp;#39;t need to worry whether they are using the most secure or efficient configuration. So there&amp;#39;s no call to action here, except perhaps to sleep easy.&lt;/p&gt;&lt;p&gt;However, if you find work like this interesting, and especially if you have experience with the implementation of V8 or similar language runtimes, then you should consider coming to work for us. &lt;a href=\&quot;https://job-boards.greenhouse.io/cloudflare/jobs/6718312?gh_jid=6718312\&quot;&gt;&lt;u&gt;We are recruiting both in the US and in Europe&lt;/u&gt;&lt;/a&gt;. It&amp;#39;s a great place to work, and Cloudflare is going from strength to strength.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-09-25T14:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-09-25T13:27:51.318Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7sgyEKfivxzLgwks0Yjraq/90d3c84bbff05e49a5b2c3564ab7bec7/Hero.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;1Cv5JjXzKWKEA10JdYbXu1&quot;],&quot;name&quot;:[0,&quot;Birthday Week&quot;],&quot;slug&quot;:[0,&quot;birthday-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;5kIxDMJCg3PXQxVINDL0Cw&quot;],&quot;name&quot;:[0,&quot;Attacks&quot;],&quot;slug&quot;:[0,&quot;attacks&quot;]}],[0,{&quot;id&quot;:[0,&quot;4ggKJG4JUzqG9FpAPIxwij&quot;],&quot;name&quot;:[0,&quot;Engineering&quot;],&quot;slug&quot;:[0,&quot;engineering&quot;]}],[0,{&quot;id&quot;:[0,&quot;383iv0UQ6Lp0GZwOAxGq2p&quot;],&quot;name&quot;:[0,&quot;Linux&quot;],&quot;slug&quot;:[0,&quot;linux&quot;]}],[0,{&quot;id&quot;:[0,&quot;7BhREQYSSCo9INFzIXH0G0&quot;],&quot;name&quot;:[0,&quot;Malicious JavaScript&quot;],&quot;slug&quot;:[0,&quot;malicious-javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}],[0,{&quot;id&quot;:[0,&quot;2pFyOCtANFB5qS6nbtQbVp&quot;],&quot;name&quot;:[0,&quot;Vulnerabilities&quot;],&quot;slug&quot;:[0,&quot;vulnerabilities&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Erik Corry&quot;],&quot;slug&quot;:[0,&quot;erik-corry&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6gfuhEABjcBkfIQUrIjdkD/7233fd2150ea5d3107e6e8e725405ac2/Erik_Corry&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Ketan Gupta&quot;],&quot;slug&quot;:[0,&quot;ketan-gupta&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4HNGL8tqmoWI8yZJEEynzY/4dc4778dc00d47cc7da853c61c224fd7/Ketan_Gupta.webp&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflare Workers are constantly being updated to be as secure and efficient as possible. We are further hardening Workers by making use of the latest software and hardware features. We use defense-in-depth, including V8 sandboxes and the CPU&#39;s memory protection keys, to keep your data safe.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/safe-in-the-sandbox-security-hardening-for-cloudflare-workers&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Safe in the sandbox: security hardening for Cloudflare Workers&quot;],&quot;description&quot;:[0,&quot;Cloudflare Workers are constantly being updated to be as secure and efficient as possible. We are further hardening Workers by making use of the latest software and hardware features. We use defense-in-depth, including V8 sandboxes and the CPU&#39;s memory protection keys, to keep your data safe.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1vtdPfgEPYHJkjJfX8KN3b/7b13fffc98ce48628ebf3a5b68272ac2/OG_Share_2024_-_2025-09-25T120447.574.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;tagInfo&quot;:[0],&quot;authorInfo&quot;:[0],&quot;translatedPosts&quot;:[1,[]]}" ssr client="only" opts="{&quot;name&quot;:&quot;GoogleAnalytics&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island><script>(()=>{var l=(n,t)=>{let i=async()=>{await(await n())()},e=typeof t.value=="object"?t.value:void 0,s={timeout:e==null?void 0:e.timeout};"requestIdleCallback"in window?window.requestIdleCallback(i,s):setTimeout(i,s.timeout||200)};(self.Astro||(self.Astro={})).idle=l;window.dispatchEvent(new Event("astro:idle"));})();</script><astro-island uid="wAoLK" prefix="r7" component-url="/_astro/Navigation.BG9ngiam.js" component-export="Navigation" renderer-url="/_astro/client.CI64Qvmy.js" props="{&quot;title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;logo&quot;:[0,&quot;//images.ctfassets.net/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png&quot;],&quot;pagesStore&quot;:[0,{&quot;page&quot;:[0,&quot;Post&quot;],&quot;slug&quot;:[0,&quot;safe-in-the-sandbox-security-hardening-for-cloudflare-workers&quot;],&quot;translationsAvailable&quot;:[1,[]],&quot;navData&quot;:[1,[[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T22:44:28.803Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-09-26T17:03:14.058Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,235],&quot;revision&quot;:[0,64],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;AI&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:21.536Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-09-15T05:03:06.668Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,157],&quot;revision&quot;:[0,53],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Developers&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;5kZtWqjqa7aOUoZr8NFGwI&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:26.040Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-09-17T01:18:22.180Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,215],&quot;revision&quot;:[0,52],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;name&quot;:[0,&quot;Radar&quot;],&quot;slug&quot;:[0,&quot;cloudflare-radar&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:20.198Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-09T11:02:56.665Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,68],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Product News&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:42:46.231Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-09-24T05:27:16.563Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,169],&quot;revision&quot;:[0,50],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Security&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;16yk8DVbNNifxov5cWvAov&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:56:23.848Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-09-24T14:06:06.935Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,73],&quot;revision&quot;:[0,31],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;name&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;slug&quot;:[0,&quot;policy&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;J61Eszqn98amrYHq4IhTx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:46.068Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-08-22T01:01:37.998Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,141],&quot;revision&quot;:[0,45],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Zero Trust&quot;],&quot;name&quot;:[0,&quot;Zero Trust&quot;],&quot;slug&quot;:[0,&quot;zero-trust&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;48r7QV00gLMWOIcM1CSDRy&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:54:22.790Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-07T23:03:52.422Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,66],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;name&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;slug&quot;:[0,&quot;speed-and-reliability&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4g8tPriKOAUwdUT4jNPebe&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:40.927Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-09-19T22:57:38.748Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,79],&quot;revision&quot;:[0,30],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;name&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;slug&quot;:[0,&quot;life-at-cloudflare&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;V86khSc459Yi1AhTlvtY7&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:53.657Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-02-04T17:12:59.473Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,57],&quot;revision&quot;:[0,21],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Partners&quot;],&quot;name&quot;:[0,&quot;Partners&quot;],&quot;slug&quot;:[0,&quot;partners&quot;],&quot;featured&quot;:[0,true]}]}]]]}],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="idle" opts="{&quot;name&quot;:&quot;NavigationComponent&quot;,&quot;value&quot;:true}" await-children><header class="flex flex-row flex-wrap justify-between items-flex-end mw8 center mv3 pl3 pr1"><div class="w-100 flex items-flex-end justify-between justify-start-l"><div class="w-100 tr flex justify-end"><div class="flex justify-between items-center"><span class="dn di-l pr1"><a href="https://dash.cloudflare.com/sign-up" class="f1 blue1 dn di-l b no-underline underline-hover" target="_blank" rel="noreferrer">Get Started Free</a></span><span class="f1 gray4 dn di-l pr1">|</span><span class="dn di-l"><a target="_blank" href="https://www.cloudflare.com/plans/enterprise/contact/" class="f1 gray4 no-underline underline-hover pr1" rel="noreferrer">Contact Sales</a></span></div></div></div><div class="w-100 w-50-l flex items-end nb5 nb1-l"><a href="/" class="header-logo mr4 dn db-l"><img class="header-logo" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png" alt="The Cloudflare Blog" width="170" height="57"/></a><h2 class="mt0 mb1 dn di-l"><a href="/" class="fw5 f5 gray3 no-underline"><span class="dn di-l">The Cloudflare Blog</span></a></h2></div><div class="w-100 w-50-l dn db-l"><div class="w-100 tr mkto-sub-message"><p class="f2">Subscribe to receive notifications of new posts:</p></div><div class="w-100 tr"><div class="marketo-form-container"><form id="mktoForm_1653"><div class="top-subscribe-form-container"><div class="top-subscribe-form-field"><input placeholder="Email Address" class="top-subscribe-form-input" name="email" type="email" title="Must be valid email."/></div><button class="top-subscribe-form-button" type="button">Subscribe</button></div></form></div></div></div></header><nav dir="ltr" class="bb b--black-10 db dn-l w-100 ph3 "><div class=" flex justify-between items-center" style="height:44px"><a href="/search/"><img class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a><button type="button" style="background:transparent;border:none"><img src="/images/hamburger.svg" alt="hamburger menu"/></button></div><div class="js-mobile-nav-container dn"><div class="flex flex-column flex-wrap bg-gray9 o-95 absolute ph3 z-1 left-0 right-0 mx-4"><div class="pv3 ph2 tl"><a href="/tag/ai/" class="no-underline gray1 f4 fw7">AI</a></div><div class="pv3 ph2 tl"><a href="/tag/developers/" class="no-underline gray1 f4 fw7">Developers</a></div><div class="pv3 ph2 tl"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f4 fw7">Radar</a></div><div class="pv3 ph2 tl"><a href="/tag/product-news/" class="no-underline gray1 f4 fw7">Product News</a></div><div class="pv3 ph2 tl"><a href="/tag/security/" class="no-underline gray1 f4 fw7">Security</a></div><div class="pv3 ph2 tl"><a href="/tag/policy/" class="no-underline gray1 f4 fw7">Policy &amp; Legal</a></div><div class="pv3 ph2 tl"><a href="/tag/zero-trust/" class="no-underline gray1 f4 fw7">Zero Trust</a></div><div class="pv3 ph2 tl"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f4 fw7">Speed &amp; Reliability</a></div><div class="pv3 ph2 tl"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f4 fw7">Life at Cloudflare</a></div><div class="pv3 ph2 tl"><a href="/tag/partners/" class="no-underline gray1 f4 fw7">Partners</a></div></div></div></nav><nav id="nav" class="w-100 bb-0 bb-l b--black-10 z-1"><div id="desktop-nav-items-container" class="flex flex-wrap justify-between items-center mw8 center mv3 mv0-l"><div data-tag="ai" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/ai/" class="no-underline gray1 f2 fw5 pv3">AI</a></div><div data-tag="developers" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/developers/" class="no-underline gray1 f2 fw5 pv3">Developers</a></div><div data-tag="cloudflare-radar" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f2 fw5 pv3">Radar</a></div><div data-tag="product-news" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/product-news/" class="no-underline gray1 f2 fw5 pv3">Product News</a></div><div data-tag="security" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/security/" class="no-underline gray1 f2 fw5 pv3">Security</a></div><div data-tag="policy" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/policy/" class="no-underline gray1 f2 fw5 pv3">Policy &amp; Legal</a></div><div data-tag="zero-trust" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/zero-trust/" class="no-underline gray1 f2 fw5 pv3">Zero Trust</a></div><div data-tag="speed-and-reliability" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f2 fw5 pv3">Speed &amp; Reliability</a></div><div data-tag="life-at-cloudflare" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f2 fw5 pv3">Life at Cloudflare</a></div><div data-tag="partners" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/partners/" class="no-underline gray1 f2 fw5 pv3">Partners</a></div><div class="nav-item ml2 mr3 dn db-l pv3" data-tag="search icon"><a href="/search/"><img id="search-icon" class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a></div></div></nav><!--astro:end--></astro-island><progress class="reading-progress" value="0" max="100" aria-label="Reading progress"></progress><script> async function replaceServerIsland(id, r) { let s = document.querySelector(`script[data-island-id="${id}"]`); if (!s || r.status !== 200 || r.headers.get('content-type')?.split(';')[0].trim() !== 'text/html') return; let html = await r.text(); while (s.previousSibling && s.previousSibling.nodeType !== 8 && s.previousSibling.data !== '[if astro]>server-island-start<![endif]') s.previousSibling.remove(); s.previousSibling?.remove(); s.before(document.createRange().createContextualFragment(html)); s.remove(); } </script><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="Z1fu7VC" prefix="r3" component-url="/_astro/Post.CrIniNkB.js" component-export="Post" renderer-url="/_astro/client.CI64Qvmy.js" props="{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;7bZyPF4nBnr5gisZW2crax&quot;],&quot;title&quot;:[0,&quot;Safe in the sandbox: security hardening for Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;safe-in-the-sandbox-security-hardening-for-cloudflare-workers&quot;],&quot;excerpt&quot;:[0,&quot;We are further hardening Cloudflare Workers with the latest software and hardware features. We use defense-in-depth, including V8 sandboxes and the CPU&#39;s memory protection keys to keep your data safe.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;As a &lt;a href=\&quot;https://www.cloudflare.com/learning/serverless/what-is-serverless/\&quot;&gt;&lt;u&gt;serverless&lt;/u&gt;&lt;/a&gt; cloud provider, we run your code on our globally distributed infrastructure. Being able to run customer code on our network means that anyone can take advantage of our global presence and low latency. Workers isnât just efficient though, we also make it simple for our users. In short: &lt;a href=\&quot;https://workers.cloudflare.com/\&quot;&gt;&lt;u&gt;You write code. We handle the rest&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Part of &amp;#39;handling the rest&amp;#39; is making Workers as secure as possible. We have previously written about our &lt;a href=\&quot;https://blog.cloudflare.com/mitigating-spectre-and-other-security-threats-the-cloudflare-workers-security-model/\&quot;&gt;&lt;u&gt;security architecture&lt;/u&gt;&lt;/a&gt;. Making Workers secure is an interesting problem because the whole point of Workers is that we are running third party code on our hardware. This is one of the hardest security problems there is: any attacker has the full power available of a programming language running on the victim&amp;#39;s system when they are crafting their attacks.&lt;/p&gt;&lt;p&gt;This is why we are constantly updating and improving the Workers Runtime to take advantage of the latest improvements in both hardware and software. This post shares some of the latest work we have been doing to keep Workers secure.&lt;/p&gt;&lt;p&gt;Some background first: &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/workers/\&quot;&gt;&lt;u&gt;Workers&lt;/u&gt;&lt;/a&gt; is built around the &lt;a href=\&quot;https://v8.dev/\&quot;&gt;&lt;u&gt;V8&lt;/u&gt;&lt;/a&gt; JavaScript runtime, originally developed for Chromium-based browsers like Chrome. This gives us a head start, because V8 was forged in an adversarial environment, where it has always been under intense attack and &lt;a href=\&quot;https://github.blog/security/vulnerability-research/getting-rce-in-chrome-with-incorrect-side-effect-in-the-jit-compiler/\&quot;&gt;&lt;u&gt;scrutiny&lt;/u&gt;&lt;/a&gt;. Like Workers, Chromium is built to run adversarial code safely. That&amp;#39;s why V8 is constantly being tested against the best fuzzers and sanitizers, and over the years, it has been hardened with new technologies like &lt;a href=\&quot;https://v8.dev/blog/oilpan-library\&quot;&gt;&lt;u&gt;Oilpan/cppgc&lt;/u&gt;&lt;/a&gt; and improved static analysis.&lt;/p&gt;&lt;p&gt;We use V8 in a slightly different way, though, so we will be describing in this post how we have been making some changes to V8 to improve security in our use case.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;hardware-assisted-security-improvements-from-memory-protection-keys\&quot;&gt;Hardware-assisted security improvements from Memory Protection Keys&lt;/h2&gt;\n      &lt;a href=\&quot;#hardware-assisted-security-improvements-from-memory-protection-keys\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Modern CPUs from Intel, AMD, and ARM have support for &lt;a href=\&quot;https://man7.org/linux/man-pages/man7/pkeys.7.html\&quot;&gt;&lt;u&gt;memory protection keys&lt;/u&gt;&lt;/a&gt;, sometimes called &lt;i&gt;PKU&lt;/i&gt;, Protection Keys for Userspace. This is a great security feature which increases the power of virtual memory and memory protection.&lt;/p&gt;&lt;p&gt;Traditionally, the memory protection features of the CPU in your PC or phone were mainly used to protect the kernel and to protect different processes from each other. Within each process, all threads had access to the same memory. Memory protection keys allow us to prevent specific threads from accessing memory regions they shouldn&amp;#39;t have access to.&lt;/p&gt;&lt;p&gt;V8 already &lt;a href=\&quot;https://issues.chromium.org/issues/41480375\&quot;&gt;&lt;u&gt;uses memory protection keys&lt;/u&gt;&lt;/a&gt; for the &lt;a href=\&quot;https://en.wikipedia.org/wiki/Just-in-time_compilation\&quot;&gt;&lt;u&gt;JIT compilers&lt;/u&gt;&lt;/a&gt;. The JIT compilers for a language like JavaScript generate optimized, specialized versions of your code as it runs. Typically, the compiler is running on its own thread, and needs to be able to write data to the code area in order to install its optimized code. However, the compiler thread doesn&amp;#39;t need to be able to run this code. The regular execution thread, on the other hand, needs to be able to run, but not modify, the optimized code. Memory protection keys offer a way to give each thread the permissions it needs, but &lt;a href=\&quot;https://en.wikipedia.org/wiki/W%5EX\&quot;&gt;&lt;u&gt;no more&lt;/u&gt;&lt;/a&gt;. And the V8 team in the Chromium project certainly aren&amp;#39;t standing still. They describe some of their future plans for memory protection keys &lt;a href=\&quot;https://docs.google.com/document/d/1l3urJdk1M3JCLpT9HDvFQKOxuKxwINcXoYoFuKkfKcc/edit?tab=t.0#heading=h.gpz70vgxo7uc\&quot;&gt;&lt;u&gt;here&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;In Workers, we have some different requirements than Chromium. &lt;a href=\&quot;https://developers.cloudflare.com/workers/reference/security-model/\&quot;&gt;&lt;u&gt;The security architecture for Workers&lt;/u&gt;&lt;/a&gt; uses V8 isolates to separate different scripts that are running on our servers. (In addition, we have &lt;a href=\&quot;https://blog.cloudflare.com/spectre-research-with-tu-graz/\&quot;&gt;&lt;u&gt;extra mitigations&lt;/u&gt;&lt;/a&gt; to harden the system against &lt;a href=\&quot;https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)\&quot;&gt;&lt;u&gt;Spectre&lt;/u&gt;&lt;/a&gt; attacks). If V8 is working as intended, this should be enough, but we believe in &lt;i&gt;defense in depth&lt;/i&gt;: multiple, overlapping layers of security controls.&lt;/p&gt;&lt;p&gt;That&amp;#39;s why we have deployed internal modifications to V8 to use memory protection keys to isolate the isolates from each other. There are up to 15 different keys available on a modern x64 CPU and a few are used for other purposes in V8, so we have about 12 to work with. We give each isolate a random key which is used to protect its V8 &lt;i&gt;heap data&lt;/i&gt;, the memory area containing the JavaScript objects a script creates as it runs. This means security bugs that might previously have allowed an attacker to read data from a different isolate would now hit a hardware trap in 92% of cases. (Assuming 12 keys, 92% is about 11/12.)&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4cHaaZrAhQf759og04S63G/59ff1974dc878ec8ad7d40f1f079be37/image9.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1466\&quot; height=\&quot;606\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The illustration shows an attacker attempting to read from a different isolate. Most of the time this is detected by the mismatched memory protection key, which kills their script and notifies us, so we can investigate and remediate. The red arrow represents the case where the attacker got lucky by hitting an isolate with the same memory protection key, represented by the isolates having the same colors.&lt;/p&gt;&lt;p&gt;However, we can further improve on a 92% protection rate. In the last part of this blog post we&amp;#39;ll explain how we can lift that to 100% for a particular common scenario. But first, let&amp;#39;s look at a software hardening feature in V8 that we are taking advantage of.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;the-v8-sandbox-a-software-based-security-boundary\&quot;&gt;The V8 sandbox, a software-based security boundary&lt;/h2&gt;\n      &lt;a href=\&quot;#the-v8-sandbox-a-software-based-security-boundary\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Over the past few years, V8 has been gaining another defense in depth feature: the V8 sandbox. (Not to be confused with the &lt;a href=\&quot;https://blog.cloudflare.com/sandboxing-in-linux-with-zero-lines-of-code/\&quot;&gt;&lt;u&gt;layer 2 sandbox&lt;/u&gt;&lt;/a&gt; which Workers have been using since the beginning.) The V8 sandbox has been a multi-year project that has been gaining &lt;a href=\&quot;https://v8.dev/blog/sandbox\&quot;&gt;&lt;u&gt;maturity&lt;/u&gt;&lt;/a&gt; for a while. The sandbox project stems from the observation that many V8 security vulnerabilities start by corrupting objects in the V8 heap memory. Attackers then leverage this corruption to reach other parts of the process, giving them the opportunity to escalate and gain more access to the victim&amp;#39;s browser, or even the entire system.&lt;/p&gt;&lt;p&gt;V8&amp;#39;s sandbox project is an ambitious software security mitigation that aims to thwart that escalation: to make it impossible for the attacker to progress from a corruption on the V8 heap to a compromise of the rest of the process. This means, among other things, removing all pointers from the heap. But first, let&amp;#39;s explain in as simple terms as possible, what a memory corruption attack is.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;memory-corruption-attacks\&quot;&gt;Memory corruption attacks&lt;/h3&gt;\n      &lt;a href=\&quot;#memory-corruption-attacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;A memory corruption attack tricks a program into misusing its own memory. Computer memory is just a store of integers, where each integer is stored in a location. The locations each have an &lt;i&gt;address&lt;/i&gt;, which is also just a number. Programs interpret the data in these locations in different ways, such as text, pixels, or &lt;i&gt;pointers&lt;/i&gt;. Pointers are addresses that identify a different memory location, so they act as a sort of arrow that points to some other piece of data.&lt;/p&gt;&lt;p&gt;Here&amp;#39;s a concrete example, which uses a buffer overflow. This is a form of attack that was historically common and relatively simple to understand: Imagine a program has a small buffer (like a 16-character text field) followed immediately by an 8-byte pointer to some ordinary data. An attacker might send the program a 24-character string, causing a &amp;quot;buffer overflow.&amp;quot; Because of a vulnerability in the program, the first 16 characters fill the intended buffer, but the remaining 8 characters spill over and overwrite the adjacent pointer.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5VlcKOYtfRHwWZVDb6GOPm/517ae1987c89273e1f33eb6ca11d752d/image5.png\&quot; alt=\&quot;See below for how such an attack would now be thwarted.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;831\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;See below for how such an attack would now be thwarted.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;Now the pointer has been redirected to point at sensitive data of the attacker&amp;#39;s choosing, rather than the normal data it was originally meant to access. When the program tries to use what it believes is its normal pointer, it&amp;#39;s actually accessing sensitive data chosen by the attacker.&lt;/p&gt;&lt;p&gt;This type of attack works in steps: first create a small confusion (like the buffer overflow), then use that confusion to create bigger problems, eventually gaining access to data or capabilities the attacker shouldn&amp;#39;t have.Â  The attacker can eventually use the misdirection to either steal information or plant malicious data that the program will treat as legitimate.&lt;/p&gt;&lt;p&gt;This was a somewhat abstract description of memory corruption attacks using a buffer overflow, one of the simpler techniques. For some much more detailed and recent examples, see &lt;a href=\&quot;https://googleprojectzero.blogspot.com/2015/06/what-is-good-memory-corruption.html\&quot;&gt;&lt;u&gt;this description from Google&lt;/u&gt;&lt;/a&gt;, or this &lt;a href=\&quot;https://medium.com/@INTfinitySG/miscellaneous-series-2-a-script-kiddie-diary-in-v8-exploit-research-part-1-5b0bab211f5a\&quot;&gt;&lt;u&gt;breakdown of a V8 vulnerability&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;compressed-pointers-in-v8\&quot;&gt;Compressed pointers in V8&lt;/h3&gt;\n      &lt;a href=\&quot;#compressed-pointers-in-v8\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Many attacks are based on corrupting pointers, so ideally we would remove all pointers from the memory of the program.Â  Since an object-oriented language&amp;#39;s heap is absolutely full of pointers, that would seem, on its face, to be a hopeless task, but it is enabled by an earlier development. Starting in 2020, V8 has offered the option of saving memory by using &lt;a href=\&quot;https://v8.dev/blog/pointer-compression\&quot;&gt;&lt;u&gt;compressed pointers&lt;/u&gt;&lt;/a&gt;. This means that, on a 64-bit system, the heap uses only 32 bit offsets, relative to a base address. This limits the total heap to maximally 4 GiB, a limitation that is acceptable for a browser, and also fine for individual scripts running in a V8 isolate on Cloudflare Workers.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/sO5ByQzR62UcxZiaxwcaq/2f2f0c04af57bb492e9ecaa321935112/image1.png\&quot; alt=\&quot;An artificial object with various fields, showing how the layout differs in a compressed vs. an uncompressed heap. The boxes are 64 bits wide.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;453\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;An artificial object with various fields, showing how the layout differs in a compressed vs. an uncompressed heap. The boxes are 64 bits wide.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;If the whole of the heap is in a single 4 GiB area then the first 32 bits of all pointers will be the same, and we don&amp;#39;t need to store them in every pointer field in every object. In the diagram we can see that the object pointers all start with 0x12345678, which is therefore redundant and doesn&amp;#39;t need to be stored. This means that object pointer fields and integer fields can be reduced from 64 to 32 bits.&lt;/p&gt;&lt;p&gt;We still need 64 bit fields for some fields like double precision floats and for the sandbox offsets of buffers, which are typically used by the script for input and output data. See below for details.&lt;/p&gt;&lt;p&gt;Integers in an uncompressed heap are stored in the high 32 bits of a 64 bit field. In the compressed heap, the top 31 bits of a 32 bit field are used. In both cases the lowest bit is set to 0 to indicate integers (as opposed to pointers or offsets).&lt;/p&gt;&lt;p&gt;Conceptually, we have two methods for compressing and decompressing, using a base address that is divisible by 4 GiB:&lt;/p&gt;\n            &lt;pre class=\&quot;language-C++\&quot;&gt;&lt;code class=\&quot;language-C++\&quot;&gt;// Decompress a 32 bit offset to a 64 bit pointer by adding a base address.\nvoid* Decompress(uint32_t offset) { return base + offset; }\n// Compress a 64 bit pointer to a 32 bit offset by discarding the high bits.\nuint32_t Compress(void* pointer) { return (intptr_t)pointer &amp;amp; 0xffffffff; }&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This pointer compression feature, originally primarily designed to save memory, can be used as the basis of a sandbox.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;from-compressed-pointers-to-the-sandbox\&quot;&gt;From compressed pointers to the sandbox&lt;/h3&gt;\n      &lt;a href=\&quot;#from-compressed-pointers-to-the-sandbox\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;The biggest 32-bit unsigned integer is about 4 billion, so the &lt;code&gt;Decompress()&lt;/code&gt; function cannot generate any pointer that is outside the range [base, base + 4Â GiB]. You could say the pointers are trapped in this area, so it is sometimes called the &lt;i&gt;pointer cage&lt;/i&gt;. V8 can reserve 4 GiB of virtual address space for the pointer cage so that only V8 objects appear in this range. By eliminating &lt;i&gt;all&lt;/i&gt; pointers from this range, and following some other strict rules, V8 can contain any memory corruption by an attacker to this cage. Even if an attacker corrupts a 32 bit offset within the cage, it is still only a 32 bit offset and can only be used to create new pointers that are still trapped within the pointer cage.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3r5H81eDvHgaPIBFw5gG6B/65ffa220f9141a81af893183a09321ac/image7.png\&quot; alt=\&quot;The buffer overflow attack from earlier no longer works because only the attacker&#39;s own data is available in the pointer cage.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;861\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;The buffer overflow attack from earlier no longer works because only the attacker&amp;#39;s own data is available in the pointer cage.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;To construct the sandbox, we take the 4 GiB pointer cage and add another 4 GiB for buffers and other data structures to make the 8 GiB sandbox. This is why the buffer offsets above are 33 bits, so they can reach buffers in the second half of the sandbox (40 bits in Chromium with larger sandboxes). V8 stores these buffer offsets in the high 33 bits and shifts down by 31 bits before use, in case an attacker corrupted the low bits.&lt;/p&gt;&lt;p&gt;Cloudflare Workers have made use of compressed pointers in V8 for a while, but for us to get the full power of the sandbox we had to make some changes. Until recently, all isolates in a process had to be one single sandbox if you were using the sandboxed configuration of V8. This would have limited the total size of all V8 heaps to be less than 4 GiB, far too little for our architecture, which relies on serving 1000s of scripts at once.&lt;/p&gt;&lt;p&gt;That&amp;#39;s why we commissioned &lt;a href=\&quot;https://www.igalia.com/\&quot;&gt;&lt;u&gt;Igalia&lt;/u&gt;&lt;/a&gt; to add&lt;a href=\&quot;https://dbezhetskov.dev/multi-sandboxes/\&quot;&gt;&lt;u&gt; isolate groups&lt;/u&gt;&lt;/a&gt; to V8. Each isolate group has its own sandbox and can have 1 or more isolates within it. Building on this change we have been able to start using the sandbox, eliminating a whole class of potential security issues in one stroke. Although we can place multiple isolates in the same sandbox, we are currently only putting a single isolate in each sandbox.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3jwaGI8xIAC6755vw2BWfE/d8b0cd5b36dbe8b5e628c62ef7f3d474/image2.png\&quot; alt=\&quot;The layout of the sandbox. In the sandbox there can be more than one isolate, but all their heap pages must be in the pointer cage: the first 4 GiB of the sandbox. Instead of pointers between the objects, we use 32 bit offsets. The offsets for the buffers are 33 bits, so they can reach the whole sandbox, but not outside it.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1094\&quot; height=\&quot;774\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;The layout of the sandbox. In the sandbox there can be more than one isolate, but all their heap pages must be in the pointer cage: the first 4 GiB of the sandbox. Instead of pointers between the objects, we use 32 bit offsets. The offsets for the buffers are 33 bits, so they can reach the whole sandbox, but not outside it.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;virtual-memory-isnt-infinite-theres-a-lot-going-on-in-a-linux-process\&quot;&gt;Virtual memory isn&amp;#39;t infinite, there&amp;#39;s a lot going on in a Linux process&lt;/h2&gt;\n      &lt;a href=\&quot;#virtual-memory-isnt-infinite-theres-a-lot-going-on-in-a-linux-process\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;At this point, we were not quite done, though. Each sandbox reserves 8 GiB of space in the virtual memory map of the process, and it must be 4 GiB aligned &lt;a href=\&quot;https://v8.dev/blog/pointer-compression\&quot;&gt;&lt;u&gt;for efficiency&lt;/u&gt;&lt;/a&gt;. It uses much less physical memory, but the sandbox mechanism requires this much virtual space for its security properties. This presents us with a problem, since a Linux process &amp;#39;only&amp;#39; has 128 TiB of virtual address space in a 4-level page table (another 128 TiB are reserved for the kernel, not available to user space).&lt;/p&gt;&lt;p&gt;At Cloudflare, we want to run Workers as efficiently as possible to keep costs and prices down, and to offer a generous free tier. That means that on each machine we have so many isolates running (one per sandbox) that it becomes hard to place them all in a 128 TiB space.&lt;/p&gt;&lt;p&gt;Knowing this, we have to place the sandboxes carefully in memory. Unfortunately, the Linux syscall, &lt;a href=\&quot;https://man7.org/linux/man-pages/man2/mmap.2.html\&quot;&gt;&lt;u&gt;mmap&lt;/u&gt;&lt;/a&gt;, does not allow us to specify the alignment of an allocation unless you can guess a free location to request. To get an 8 GiB area that is 4 GiB aligned, we have to ask for 12 GiB, then find the aligned 8 GiB area that must exist within that, and return the unused (hatched) edges to the OS:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7Dqey3y5ZsPugD3pyRpQUY/cdadceeb96dbb01a2062dc98c7c554bc/image6.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;266\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;If we allow the Linux kernel to place sandboxes randomly, we end up with a layout like this with gaps. Especially after running for a while, there can be both 8 GiB and 4 GiB gaps between sandboxes:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6oaIPZnjaJrLYoFK6v03oI/6c53895f1151d70f71511d8cdfa35f00/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;417\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Sadly, because of our 12 GiB alignment trick, we can&amp;#39;t even make use of the 8 GiB gaps. If we ask the OS for 12 GiB, it will never give us a gap like the 8 GiB gap between the green and blue sandboxes above. In addition, there are a host of other things going on in the virtual address space of a Linux process: the malloc implementation may want to grab pages at particular addresses, the executable and libraries are mapped at a random location by ASLR, and V8 has allocations outside the sandbox.&lt;/p&gt;&lt;p&gt;The latest generation of x64 CPUs supports a much bigger address space, which solves both problems, and Linux kernels are able to make use of the extra bits with &lt;a href=\&quot;https://en.wikipedia.org/wiki/Intel_5-level_paging\&quot;&gt;&lt;u&gt;five level page tables&lt;/u&gt;&lt;/a&gt;. A process has to &lt;a href=\&quot;https://lwn.net/Articles/717293/\&quot;&gt;&lt;u&gt;opt into this&lt;/u&gt;&lt;/a&gt;, which is done by a single mmap call suggesting an address outside the 47 bit area. The reason this needs an opt-in is that some programs can&amp;#39;t cope with such high addresses. Curiously, V8 is one of them.&lt;/p&gt;&lt;p&gt;This isn&amp;#39;t hard to fix in V8, but not all of our fleet has been upgraded yet to have the necessary hardware. So for now, we need a solution that works with the existing hardware. We have modified V8 to be able to grab huge memory areas and then use &lt;a href=\&quot;https://man7.org/linux/man-pages/man2/mprotect.2.html\&quot;&gt;&lt;u&gt;mprotect syscalls&lt;/u&gt;&lt;/a&gt; to create tightly packed 8 GiB spaces for sandboxes, bypassing the inflexible mmap API.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7kPgAWxoR7nDsZHUOBsNMp/15e7b2a1aac827acfce8b0d614e44cde/image8.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;612\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;putting-it-all-together\&quot;&gt;Putting it all together&lt;/h2&gt;\n      &lt;a href=\&quot;#putting-it-all-together\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Taking control of the sandbox placement like this actually gives us a security benefit, but first we need to describe a particular threat model.&lt;/p&gt;&lt;p&gt;We assume for the purposes of this threat model that an attacker has an arbitrary way to corrupt data within the sandbox. This is historically the first step in many V8 exploits. So much so that there is a &lt;a href=\&quot;https://bughunters.google.com/about/rules/chrome-friends/5745167867576320/chrome-vulnerability-reward-program-rules#v8-sandbox-bypass-rewards\&quot;&gt;&lt;u&gt;special tier&lt;/u&gt;&lt;/a&gt; in Google&amp;#39;s V8 bug bounty program where you may &lt;i&gt;assume&lt;/i&gt; you have this ability to corrupt memory, and they will pay out if you can leverage that to a more serious exploit.&lt;/p&gt;&lt;p&gt;However, we assume that the attacker does not have the ability to execute arbitrary machine code. If they did, they could &lt;a href=\&quot;https://www.usenix.org/system/files/sec20fall_connor_prepub.pdf\&quot;&gt;&lt;u&gt;disable memory protection keys&lt;/u&gt;&lt;/a&gt;. Having access to the in-sandbox memory only gives the attacker access to their own data. So the attacker must attempt to escalate, by corrupting data inside the sandbox to access data outside the sandbox.&lt;/p&gt;&lt;p&gt;You will recall that the compressed, sandboxed V8 heap only contains 32 bit offsets. Therefore, no corruption there can reach outside the pointer cage. But there are also arrays in the sandbox â vectors of data with a given size that can be accessed with an index. In our threat model, the attacker can modify the sizes recorded for those arrays and the indexes used to access elements in the arrays. That means an attacker could potentially turn an array in the sandbox into a tool for accessing memory incorrectly. For this reason, the V8 sandbox normally has &lt;i&gt;guard regions&lt;/i&gt; around it: These are 32 GiB virtual address ranges that have no virtual-to-physical address mappings. This helps guard against the worst case scenario: Indexing an array where the elements are 8 bytes in size (e.g. an array of double precision floats) using a maximal 32 bit index. Such an access could reach a distance of up to 32 GiB outside the sandbox: 8 times the maximal 32 bit index of four billion.&lt;/p&gt;&lt;p&gt;We want such accesses to trigger an alarm, rather than letting an attacker access nearby memory.Â  This happens automatically with guard regions, but we don&amp;#39;t have space for conventional 32 GiB guard regions around every sandbox.&lt;/p&gt;&lt;p&gt;Instead of using conventional guard regions, we can make use of memory protection keys. By carefully controlling which isolate group uses which key, we can ensure that no sandbox within 32 GiB has the same protection key. Essentially, the sandboxes are acting as each other&amp;#39;s guard regions, protected by memory protection keys. Now we only need a wasted 32 GiB guard region at the start and end of the huge packed sandbox areas.\n&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/53MPs8P84ayqEiTXh7gV5O/88104f74f1d51dbdda8d987e1c7df3aa/image10.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;493\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;With the new sandbox layout, we use strictly rotating memory protection keys. Because we are not using randomly chosen memory protection keys, for this threat model the 92% problem described above disappears. Any in-sandbox security issue is unable to reach a sandbox with the same memory protection key. In the diagram, we show that there is no memory within 32 GiB of a given sandbox that has the same memory protection key. Any attempt to access memory within 32 GiB of a sandbox will trigger an alarm, just like it would with unmapped guard regions.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;the-future\&quot;&gt;The future&lt;/h2&gt;\n      &lt;a href=\&quot;#the-future\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;In a way, this whole blog post is about things our customers &lt;i&gt;don&amp;#39;t&lt;/i&gt; need to do. They don&amp;#39;t need to upgrade their server software to get the latest patches, we do that for them. They don&amp;#39;t need to worry whether they are using the most secure or efficient configuration. So there&amp;#39;s no call to action here, except perhaps to sleep easy.&lt;/p&gt;&lt;p&gt;However, if you find work like this interesting, and especially if you have experience with the implementation of V8 or similar language runtimes, then you should consider coming to work for us. &lt;a href=\&quot;https://job-boards.greenhouse.io/cloudflare/jobs/6718312?gh_jid=6718312\&quot;&gt;&lt;u&gt;We are recruiting both in the US and in Europe&lt;/u&gt;&lt;/a&gt;. It&amp;#39;s a great place to work, and Cloudflare is going from strength to strength.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-09-25T14:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-09-25T13:27:51.318Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7sgyEKfivxzLgwks0Yjraq/90d3c84bbff05e49a5b2c3564ab7bec7/Hero.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;1Cv5JjXzKWKEA10JdYbXu1&quot;],&quot;name&quot;:[0,&quot;Birthday Week&quot;],&quot;slug&quot;:[0,&quot;birthday-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;5kIxDMJCg3PXQxVINDL0Cw&quot;],&quot;name&quot;:[0,&quot;Attacks&quot;],&quot;slug&quot;:[0,&quot;attacks&quot;]}],[0,{&quot;id&quot;:[0,&quot;4ggKJG4JUzqG9FpAPIxwij&quot;],&quot;name&quot;:[0,&quot;Engineering&quot;],&quot;slug&quot;:[0,&quot;engineering&quot;]}],[0,{&quot;id&quot;:[0,&quot;383iv0UQ6Lp0GZwOAxGq2p&quot;],&quot;name&quot;:[0,&quot;Linux&quot;],&quot;slug&quot;:[0,&quot;linux&quot;]}],[0,{&quot;id&quot;:[0,&quot;7BhREQYSSCo9INFzIXH0G0&quot;],&quot;name&quot;:[0,&quot;Malicious JavaScript&quot;],&quot;slug&quot;:[0,&quot;malicious-javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}],[0,{&quot;id&quot;:[0,&quot;2pFyOCtANFB5qS6nbtQbVp&quot;],&quot;name&quot;:[0,&quot;Vulnerabilities&quot;],&quot;slug&quot;:[0,&quot;vulnerabilities&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Erik Corry&quot;],&quot;slug&quot;:[0,&quot;erik-corry&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6gfuhEABjcBkfIQUrIjdkD/7233fd2150ea5d3107e6e8e725405ac2/Erik_Corry&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Ketan Gupta&quot;],&quot;slug&quot;:[0,&quot;ketan-gupta&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4HNGL8tqmoWI8yZJEEynzY/4dc4778dc00d47cc7da853c61c224fd7/Ketan_Gupta.webp&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflare Workers are constantly being updated to be as secure and efficient as possible. We are further hardening Workers by making use of the latest software and hardware features. We use defense-in-depth, including V8 sandboxes and the CPU&#39;s memory protection keys, to keep your data safe.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/safe-in-the-sandbox-security-hardening-for-cloudflare-workers&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Safe in the sandbox: security hardening for Cloudflare Workers&quot;],&quot;description&quot;:[0,&quot;Cloudflare Workers are constantly being updated to be as secure and efficient as possible. We are further hardening Workers by making use of the latest software and hardware features. We use defense-in-depth, including V8 sandboxes and the CPU&#39;s memory protection keys, to keep your data safe.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1vtdPfgEPYHJkjJfX8KN3b/7b13fffc98ce48628ebf3a5b68272ac2/OG_Share_2024_-_2025-09-25T120447.574.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;initialReadingTime&quot;:[0,&quot;13&quot;],&quot;relatedPosts&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;7d41Nh5ZiG8DbEjjwhJF3H&quot;],&quot;title&quot;:[0,&quot;Cloudflare just got faster and more secure, powered by Rust&quot;],&quot;slug&quot;:[0,&quot;20-percent-internet-upgrade&quot;],&quot;excerpt&quot;:[0,&quot;Weâve replaced the original core system in Cloudflare with a new modular Rust-based proxy, replacing NGINX. &quot;],&quot;featured&quot;:[0,true],&quot;html&quot;:[0,&quot;&lt;p&gt;Cloudflare is relentless about building and running the worldâs fastest network. We have been &lt;a href=\&quot;https://blog.cloudflare.com/tag/network-performance-update/\&quot;&gt;&lt;u&gt;tracking and reporting on our network performance since 2021&lt;/u&gt;&lt;/a&gt;: you can see the latest update &lt;a href=\&quot;https://blog.cloudflare.com/tag/network-performance-update/\&quot;&gt;&lt;u&gt;here&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Building the fastest network requires work in many areas. We invest a lot of time in our hardware, to have efficient and fast machines. We invest in peering arrangements, to make sure we can talk to every part of the Internet with minimal delay. On top of this, we also have to invest in the software we run our network on, especially as each new product can otherwise add more processing delay.&lt;/p&gt;&lt;p&gt;No matter how fast messages arrive, we introduce a bottleneck if that software takes too long to think about how to process and respond to requests. Today we are excited to share a significant upgrade to our software that cuts the median time we take to respond by 10ms and delivers a 25% performance boost, as measured by third-party CDN performance tests.&lt;/p&gt;&lt;p&gt;We&amp;#39;ve spent the last year rebuilding major components of our system, and we&amp;#39;ve just slashed the latency of traffic passing through our network for millions of our customers. At the same time, we&amp;#39;ve made our system more secure, and we&amp;#39;ve reduced the time it takes for us to build and release new products.Â &lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;where-did-we-start\&quot;&gt;Where did we start?&lt;/h2&gt;\n      &lt;a href=\&quot;#where-did-we-start\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Every request that hits Cloudflare starts a journey through our network. It might come from a browser loading a webpage, a mobile app calling an API, or automated traffic from another service. These requests first terminate at our HTTP and TLS layer, then pass into a system we call FL, and finally through &lt;a href=\&quot;https://blog.cloudflare.com/pingora-open-source/\&quot;&gt;&lt;u&gt;Pingora&lt;/u&gt;&lt;/a&gt;, which performs cache lookups or fetches data from the origin if needed.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/CKW3jrB9vw4UhXx6OYJpt/928b9e9c1c794f7622fc4ad469d66b60/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;846\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;FL is the brain of Cloudflare. Once a request reaches FL, we then run the various security and performance features in our network. It applies each customerâs unique configuration and settings, from enforcing &lt;a href=\&quot;https://developers.cloudflare.com/waf/managed-rules/\&quot;&gt;&lt;u&gt;WAF rules &lt;/u&gt;&lt;/a&gt;and &lt;a href=\&quot;https://www.cloudflare.com/ddos/\&quot;&gt;&lt;u&gt;DDoS protection&lt;/u&gt;&lt;/a&gt; to routing traffic to the &lt;a href=\&quot;https://developers.cloudflare.com/learning-paths/workers/devplat/intro-to-devplat/\&quot;&gt;&lt;u&gt;Developer Platform &lt;/u&gt;&lt;/a&gt;and &lt;a href=\&quot;https://developers.cloudflare.com/r2/\&quot;&gt;&lt;u&gt;R2&lt;/u&gt;&lt;/a&gt;.Â &lt;/p&gt;&lt;p&gt;Built more than 15 years ago, FL has been at the core of Cloudflareâs network. It enables us to deliver a broad range of features, but over time that flexibility became a challenge. As we added more products, FL grew harder to maintain, slower to process requests, and more difficult to extend. Each new feature required careful checks across existing logic, and every addition introduced a little more latency, making it increasingly difficult to sustain the performance we wanted.&lt;/p&gt;&lt;p&gt;You can see how FL is key to our system â weâve often called it the âbrainâ of Cloudflare. Itâs also one of the oldest parts of our system: the first commit to the codebase was made by one of our founders, Lee Holloway, well before our initial launch. Weâre celebrating our 15th Birthday this week - this system started 9 months before that!&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;commit 39c72e5edc1f05ae4c04929eda4e4d125f86c5ce\nAuthor: Lee Holloway &amp;lt;q@t60.(none)&amp;gt;\nDate:   Wed Jan 6 09:57:55 2010 -0800\n\n    nginx-fl initial configuration&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;As the commit implies, the first version of FL was implemented based on the NGINX webserver, with product logic implemented in PHP.Â  After 3 years, the system became too complex to manage effectively, and too slow to respond, and an almost complete rewrite of the running system was performed. This led to another significant commit, this time made by Dane Knecht, who is now our CTO.&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;commit bedf6e7080391683e46ab698aacdfa9b3126a75f\nAuthor: Dane Knecht\nDate:   Thu Sep 19 19:31:15 2013 -0700\n\n    remove PHP.&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;From this point on, FL was implemented using NGINX, the &lt;a href=\&quot;https://openresty.org/en/\&quot;&gt;&lt;u&gt;OpenResty&lt;/u&gt;&lt;/a&gt; framework, and &lt;a href=\&quot;https://luajit.org/\&quot;&gt;&lt;u&gt;LuaJIT&lt;/u&gt;&lt;/a&gt;.Â  While this was great for a long time, over the last few years it started to show its age. We had to spend increasing amounts of time fixing or working around obscure bugs in LuaJIT. The highly dynamic and unstructured nature of our Lua code, which was a blessing when first trying to implement logic quickly, became a source of errors and delay when trying to integrate large amounts of complex product logic. Each time a new product was introduced, we had to go through all the other existing products to check if they might be affected by the new logic.&lt;/p&gt;&lt;p&gt;It was clear that we needed a rethink. So, in July 2024, we cut an initial commit for a brand new, and radically different, implementation. To save time agreeing on a new name for this, we just called it âFL2â, and started, of course, referring to the original FL as âFL1â.&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;commit a72698fc7404a353a09a3b20ab92797ab4744ea8\nAuthor: Maciej Lechowski\nDate:   Wed Jul 10 15:19:28 2024 +0100\n\n    Create fl2 project&lt;/pre&gt;&lt;/code&gt;\n            \n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;rust-and-rigid-modularization\&quot;&gt;Rust and rigid modularization&lt;/h2&gt;\n      &lt;a href=\&quot;#rust-and-rigid-modularization\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;We werenât starting from scratch. Weâve &lt;a href=\&quot;https://blog.cloudflare.com/how-we-built-pingora-the-proxy-that-connects-cloudflare-to-the-internet/\&quot;&gt;&lt;u&gt;previously blogged&lt;/u&gt;&lt;/a&gt; about how we replaced another one of our legacy systems with Pingora, which is built in the &lt;a href=\&quot;https://www.rust-lang.org/\&quot;&gt;&lt;u&gt;Rust&lt;/u&gt;&lt;/a&gt; programming language, using the &lt;a href=\&quot;https://tokio.rs/\&quot;&gt;&lt;u&gt;Tokio&lt;/u&gt;&lt;/a&gt; runtime. Weâve also &lt;a href=\&quot;https://blog.cloudflare.com/introducing-oxy/\&quot;&gt;&lt;u&gt;blogged about Oxy&lt;/u&gt;&lt;/a&gt;, our internal framework for building proxies in Rust. We write a lot of Rust, and weâve gotten pretty good at it.&lt;/p&gt;&lt;p&gt;We built FL2 in Rust, on Oxy, and built a strict module framework to structure all the logic in FL2.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;why-oxy\&quot;&gt;Why Oxy?&lt;/h2&gt;\n      &lt;a href=\&quot;#why-oxy\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;When we set out to build FL2, we knew we werenât just replacing an old system; we were rebuilding the foundations of Cloudflare. That meant we needed more than just a proxy; we needed a framework that could evolve with us, handle the immense scale of our network, and let teams move quickly without sacrificing safety or performance.Â &lt;/p&gt;&lt;p&gt;Oxy gives us a powerful combination of performance, safety, and flexibility. Built in Rust, it eliminates entire classes of bugs that plagued our Nginx/LuaJIT-based FL1, like memory safety issues and data races, while delivering C-level performance. At Cloudflareâs scale, those guarantees arenât nice-to-haves, theyâre essential. Every microsecond saved per request translates into tangible improvements in user experience, and every crash or edge case avoided keeps the Internet running smoothly. Rustâs strict compile-time guarantees also pair perfectly with FL2âs modular architecture, where we enforce clear contracts between product modules and their inputs and outputs.&lt;/p&gt;&lt;p&gt;But the choice wasnât just about language. Oxy is the culmination of years of experience building high-performance proxies. It already powers several major Cloudflare services, from our &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/\&quot;&gt;&lt;u&gt;Zero Trust&lt;/u&gt;&lt;/a&gt; Gateway to &lt;a href=\&quot;https://blog.cloudflare.com/icloud-private-relay/\&quot;&gt;&lt;u&gt;Appleâs iCloud Private Relay&lt;/u&gt;&lt;/a&gt;, so we knew it could handle the diverse traffic patterns and protocol combinations that FL2 would see. Its extensibility model lets us intercept, analyze, and manipulate traffic from&lt;a href=\&quot;https://www.cloudflare.com/en-gb/learning/ddos/glossary/open-systems-interconnection-model-osi/\&quot;&gt;&lt;u&gt; layer 3 up to layer 7&lt;/u&gt;&lt;/a&gt;, and even decapsulate and reprocess traffic at different layers. That flexibility is key to FL2âs design because it means we can treat everything from HTTP to raw IP traffic consistently and evolve the platform to support new protocols and features without rewriting fundamental pieces.&lt;/p&gt;&lt;p&gt;Oxy also comes with a rich set of built-in capabilities that previously required large amounts of bespoke code. Things like monitoring, soft reloads, dynamic configuration loading and swapping are all part of the framework. That lets product teams focus on the unique business logic of their module rather than reinventing the plumbing every time. This solid foundation means we can make changes with confidence, ship them quickly, and trust theyâll behave as expected once deployed.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;smooth-restarts-keeping-the-internet-flowing\&quot;&gt;Smooth restarts - keeping the Internet flowing&lt;/h2&gt;\n      &lt;a href=\&quot;#smooth-restarts-keeping-the-internet-flowing\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;One of the most impactful improvements Oxy brings is handling of restarts. Any software under continuous development and improvement will eventually need to be updated. In desktop software, this is easy: you close the program, install the update, and reopen it. On the web, things are much harder. Our software is in constant use and cannot simply stop. A dropped HTTP request can cause a page to fail to load, and a broken connection can kick you out of a video call. Reliability is not optional.&lt;/p&gt;&lt;p&gt;In FL1, upgrades meant restarts of the proxy process. Restarting a proxy meant terminating the process entirely, which immediately broke any active connections. That was particularly painful for long-lived connections such as WebSockets, streaming sessions, and real-time APIs. Even planned upgrades could cause user-visible interruptions, and unplanned restarts during incidents could be even worse.&lt;/p&gt;&lt;p&gt;Oxy changes that. It includes a built-in mechanism for &lt;a href=\&quot;https://blog.cloudflare.com/oxy-the-journey-of-graceful-restarts/\&quot;&gt;&lt;u&gt;graceful restarts&lt;/u&gt;&lt;/a&gt; that lets us roll out new versions without dropping connections whenever possible. When a new instance of an Oxy-based service starts up, the old one stops accepting new connections but continues to serve existing ones, allowing those sessions to continue uninterrupted until they end naturally.&lt;/p&gt;&lt;p&gt;This means that if you have an ongoing WebSocket session when we deploy a new version, that session can continue uninterrupted until it ends naturally, rather than being torn down by the restart. Across Cloudflareâs fleet, deployments are orchestrated over several hours, so the aggregate rollout is smooth and nearly invisible to end users.&lt;/p&gt;&lt;p&gt;We take this a step further by using systemd socket activation. Instead of letting each proxy manage its own sockets, we let systemd create and own them. This decouples the lifetime of sockets from the lifetime of the Oxy application itself. If an Oxy process restarts or crashes, the sockets remain open and ready to accept new connections, which will be served as soon as the new process is running. That eliminates the âconnection refusedâ errors that could happen during restarts in FL1 and improves overall availability during upgrades.&lt;/p&gt;&lt;p&gt;We also built our own coordination mechanisms in Rust to replace Go libraries like &lt;a href=\&quot;https://github.com/cloudflare/tableflip\&quot;&gt;&lt;u&gt;tableflip&lt;/u&gt;&lt;/a&gt; with &lt;a href=\&quot;https://github.com/cloudflare/shellflip\&quot;&gt;&lt;u&gt;shellflip&lt;/u&gt;&lt;/a&gt;. This uses a restart coordination socket that validates configuration, spawns new instances, and ensures the new version is healthy before the old one shuts down. This improves feedback loops and lets our automation tools detect and react to failures immediately, rather than relying on blind signal-based restarts.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;composing-fl2-from-modules\&quot;&gt;Composing FL2 from Modules&lt;/h2&gt;\n      &lt;a href=\&quot;#composing-fl2-from-modules\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;To avoid the problems we had in FL1, we wanted a design where all interactions between product logic were explicit and easy to understand.Â &lt;/p&gt;&lt;p&gt;So, on top of the foundations provided by Oxy, we built a platform which separates all the logic built for our products into well-defined modules. After some experimentation and research, we designed a module system which enforces some strict rules:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;No IO (input or output) can be performed by the module.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The module provides a list of &lt;b&gt;phases&lt;/b&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Phases are evaluated in a strictly defined order, which is the same for every request.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Each phase defines a set of inputs which the platform provides to it, and a set of outputs which it may emit.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Hereâs an example of what a module phase definition looks like:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;Phase {\n    name: phases::SERVE_ERROR_PAGE,\n    request_types_enabled: PHASE_ENABLED_FOR_REQUEST_TYPE,\n    inputs: vec![\n        InputKind::IPInfo,\n        InputKind::ModuleValue(\n            MODULE_VALUE_CUSTOM_ERRORS_FETCH_WORKER_RESPONSE.as_str(),\n        ),\n        InputKind::ModuleValue(MODULE_VALUE_ORIGINAL_SERVE_RESPONSE.as_str()),\n        InputKind::ModuleValue(MODULE_VALUE_RULESETS_CUSTOM_ERRORS_OUTPUT.as_str()),\n        InputKind::ModuleValue(MODULE_VALUE_RULESETS_UPSTREAM_ERROR_DETAILS.as_str()),\n        InputKind::RayId,\n        InputKind::StatusCode,\n        InputKind::Visitor,\n    ],\n    outputs: vec![OutputValue::ServeResponse],\n    filters: vec![],\n    func: phase_serve_error_page::callback,\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This phase is for our custom error page product.Â  It takes a few things as input â information about the IP of the visitor, some header and other HTTP information, and some âmodule values.â Module values allow one module to pass information to another, and theyâre key to making the strict properties of the module system workable. For example, this module needs some information that is produced by the output of our rulesets-based custom errors product (the â&lt;code&gt;MODULE_VALUE_RULESETS_CUSTOM_ERRORS_OUTPUT&lt;/code&gt;â input). These input and output definitions are enforced at compile time.&lt;/p&gt;&lt;p&gt;While these rules are strict, weâve found that we can implement all our product logic within this framework. The benefit of doing so is that we can immediately tell which other products might affect each other.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;how-to-replace-a-running-system\&quot;&gt;How to replace a running system&lt;/h2&gt;\n      &lt;a href=\&quot;#how-to-replace-a-running-system\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Building a framework is one thing. Building all the product logic and getting it right, so that customers donât notice anything other than a performance improvement, is another.&lt;/p&gt;&lt;p&gt;The FL code base supports 15 years of Cloudflare products, and itâs changing all the time. We couldnât stop development. So, one of our first tasks was to find ways to make the migration easier and safer.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;step-1-rust-modules-in-openresty\&quot;&gt;Step 1 - Rust modules in OpenResty&lt;/h3&gt;\n      &lt;a href=\&quot;#step-1-rust-modules-in-openresty\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Itâs a big enough distraction from shipping products to customers to rebuild product logic in Rust. Asking all our teams to maintain two versions of their product logic, and reimplement every change a second time until we finished our migration was too much.&lt;/p&gt;&lt;p&gt;So, we implemented a layer in our old NGINX and OpenResty based FL which allowed the new modules to be run. Instead of maintaining a parallel implementation, teams could implement their logic in Rust, and replace their old Lua logic with that, without waiting for the full replacement of the old system.&lt;/p&gt;&lt;p&gt;For example, hereâs part of the implementation for the custom error page module phase defined earlier (weâve cut out some of the more boring details, so this doesnât quite compile as-written):&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;pub(crate) fn callback(_services: &amp;amp;mut Services, input: &amp;amp;Input&amp;lt;&amp;#039;_&amp;gt;) -&amp;gt; Output {\n    // Rulesets produced a response to serve - this can either come from a special\n    // Cloudflare worker for serving custom errors, or be directly embedded in the rule.\n    if let Some(rulesets_params) = input\n        .get_module_value(MODULE_VALUE_RULESETS_CUSTOM_ERRORS_OUTPUT)\n        .cloned()\n    {\n        // Select either the result from the special worker, or the parameters embedded\n        // in the rule.\n        let body = input\n            .get_module_value(MODULE_VALUE_CUSTOM_ERRORS_FETCH_WORKER_RESPONSE)\n            .and_then(|response| {\n                handle_custom_errors_fetch_response(&amp;quot;rulesets&amp;quot;, response.to_owned())\n            })\n            .or(rulesets_params.body);\n\n        // If we were able to load a body, serve it, otherwise let the next bit of logic\n        // handle the response\n        if let Some(body) = body {\n            let final_body = replace_custom_error_tokens(input, &amp;amp;body);\n\n            // Increment a metric recording number of custom error pages served\n            custom_pages::pages_served(&amp;quot;rulesets&amp;quot;).inc();\n\n            // Return a phase output with one final action, causing an HTTP response to be served.\n            return Output::from(TerminalAction::ServeResponse(ResponseAction::OriginError {\n                rulesets_params.status,\n                source: &amp;quot;rulesets http_custom_errors&amp;quot;,\n                headers: rulesets_params.headers,\n                body: Some(Bytes::from(final_body)),\n            }));\n        }\n    }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The internal logic in each module is quite cleanly separated from the handling of data, with very clear and explicit error handling encouraged by the design of the Rust language.&lt;/p&gt;&lt;p&gt;Many of our most actively developed modules were handled this way, allowing the teams to maintain their change velocity during our migration.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;step-2-testing-and-automated-rollouts\&quot;&gt;Step 2 - Testing and automated rollouts&lt;/h3&gt;\n      &lt;a href=\&quot;#step-2-testing-and-automated-rollouts\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    \n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6OElHIMjnkIQmsbx92ZOYc/545a26ba623a253ea1a5c6b13279301d/image4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;743\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Itâs essential to have a seriously powerful test framework to cover such a migration.Â  We built a system, internally named Flamingo, which allows us to run thousands of full end-to-end test requests concurrently against our production and pre-production systems. The same tests run against FL1 and FL2, giving us confidence that weâre not changing behaviours.&lt;/p&gt;&lt;p&gt;Whenever we deploy a change, that change is rolled out gradually across many stages, with increasing amounts of traffic. Each stage is automatically evaluated, and only passes when the full set of tests have been successfully run against it - as well as overall performance and resource usage metrics being within acceptable bounds. This system is fully automated, and pauses or rolls back changes if the tests fail.\n&lt;/p&gt;&lt;p&gt;The benefit is that weâre able to build and ship new product features in FL2 within 48 hours - where it would have taken weeks in FL1. In fact, at least one of the announcements this week involved such a change!&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;step-3-fallbacks\&quot;&gt;Step 3 - Fallbacks&lt;/h3&gt;\n      &lt;a href=\&quot;#step-3-fallbacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Over 100 engineers have worked on FL2, and we have over 130 modules. And weâre not quite done yet. We&amp;#39;re still putting the final touches on the system, to make sure it replicates all the behaviours of FL1.&lt;/p&gt;&lt;p&gt;So how do we send traffic to FL2 without it being able to handle everything? If FL2 receives a request, or a piece of configuration for a request, that it doesnât know how to handle, it gives up and does what weâve called a &lt;b&gt;fallback&lt;/b&gt; - it passes the whole thing over to FL1. It does this at the network level - it just passes the bytes on to FL1.&lt;/p&gt;&lt;p&gt;As well as making it possible for us to send traffic to FL2 without it being fully complete, this has another massive benefit. When we have implemented a piece of new functionality in FL2, but want to double check that it is working the same as in FL1, we can evaluate the functionality in FL2, and then trigger a fallback. We are able to compare the behaviour of the two systems, allowing us to get a high confidence that our implementation was correct.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;step-4-rollout\&quot;&gt;Step 4 - Rollout&lt;/h3&gt;\n      &lt;a href=\&quot;#step-4-rollout\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;We started running customer traffic through FL2 early in 2025, and have been progressively increasing the amount of traffic served throughout the year. Essentially, weâve been watching two graphs: one with the proportion of traffic routed to FL2 going up, and another with the proportion of traffic failing to be served by FL2 and falling back to FL1 going down.&lt;/p&gt;&lt;p&gt;We started this process by passing traffic for our free customers through the system. We were able to prove that the system worked correctly, and drive the fallback rates down for our major modules. Our &lt;a href=\&quot;https://community.cloudflare.com/\&quot;&gt;&lt;u&gt;Cloudflare Community&lt;/u&gt;&lt;/a&gt; MVPs acted as an early warning system, smoke testing and flagging when they suspected the new platform might be the cause of a new reported problem. Crucially their support allowed our team to investigate quickly, apply targeted fixes, or confirm the move to FL2 was not to blame.&lt;/p&gt;&lt;p&gt;\nWe then advanced to our paying customers, gradually increasing the amount of customers using the system. We also worked closely with some of our largest customers, who wanted the performance benefits of FL2, and onboarded them early in exchange for lots of feedback on the system.&lt;/p&gt;&lt;p&gt;Right now, most of our customers are using FL2. We still have a few features to complete, and are not quite ready to onboard everyone, but our target is to turn off FL1 within a few more months.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;impact-of-fl2\&quot;&gt;Impact of FL2&lt;/h2&gt;\n      &lt;a href=\&quot;#impact-of-fl2\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;As we described at the start of this post, FL2 is substantially faster than FL1. The biggest reason for this is simply that FL2 performs less work. You might have noticed in the module definition example a line&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;    filters: vec![],&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Every module is able to provide a set of filters, which control whether they run or not. This means that we donât run logic for every product for every request â we can very easily select just the required set of modules. The incremental cost for each new product we develop has gone away.&lt;/p&gt;&lt;p&gt;Another huge reason for better performance is that FL2 is a single codebase, implemented in a performance focussed language. In comparison, FL1 was based on NGINX (which is written in C), combined with LuaJIT (Lua, and C interface layers), and also contained plenty of Rust modules.Â  In FL1, we spent a lot of time and memory converting data from the representation needed by one language, to the representation needed by another.&lt;/p&gt;&lt;p&gt;As a result, our internal measures show that FL2 uses less than half the CPU of FL1, and much less than half the memory. Thatâs a huge bonus â we can spend the CPU on delivering more and more features for our customers!&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;how-do-we-measure-if-we-are-getting-better\&quot;&gt;How do we measure if we are getting better?&lt;/h2&gt;\n      &lt;a href=\&quot;#how-do-we-measure-if-we-are-getting-better\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Using our own tools and independent benchmarks like &lt;a href=\&quot;https://www.cdnperf.com/\&quot;&gt;&lt;u&gt;CDNPerf&lt;/u&gt;&lt;/a&gt;, we measured the impact of FL2 as we rolled it out across the network. The results are clear: websites are responding 10 ms faster at the median, a 25% performance boost.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/eDqQvbAfrQoSXPZed0fd7/d7fe0d28e33a3f2e8dfcd27cf79c900f/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1092\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;security\&quot;&gt;Security&lt;/h2&gt;\n      &lt;a href=\&quot;#security\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;FL2 is also more secure by design than FL1. No software system is perfect, but the Rust language brings us huge benefits over LuaJIT. Rust has strong compile-time memory checks and a type system that avoids large classes of errors. Combine that with our rigid module system, and we can make most changes with high confidence.&lt;/p&gt;&lt;p&gt;Of course, no system is secure if used badly. Itâs easy to write code in Rust, which causes memory corruption. To reduce risk, we maintain strong compile time linting and checking, together with strict coding standards, testing and review processes.&lt;/p&gt;&lt;p&gt;We have long followed a policy that any unexplained crash of our systems needs to be &lt;a href=\&quot;https://blog.cloudflare.com/however-improbable-the-story-of-a-processor-bug/\&quot;&gt;&lt;u&gt;investigated as a high priority&lt;/u&gt;&lt;/a&gt;. We wonât be relaxing that policy, though the main cause of novel crashes in FL2 so far has been due to hardware failure. The massively reduced rates of such crashes will give us time to do a good job of such investigations.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;whats-next\&quot;&gt;Whatâs next?&lt;/h2&gt;\n      &lt;a href=\&quot;#whats-next\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Weâre spending the rest of 2025 completing the migration from FL1 to FL2, and will turn off FL1 in early 2026. Weâre already seeing the benefits in terms of customer performance and speed of development, and weâre looking forward to giving these to all our customers.&lt;/p&gt;&lt;p&gt;We have one last service to completely migrate. The âHTTP &amp;amp; TLS Terminationâ box from the diagram way back at the top is also an NGINX service, and weâre midway through a rewrite in Rust. Weâre making good progress on this migration, and expect to complete it early next year.&lt;/p&gt;&lt;p&gt;After that, when everything is modular, in Rust and tested and scaled, we can really start to optimize! Weâll reorganize and simplify how the modules connect to each other, expand support for non-HTTP traffic like RPC and streams, and much more.Â &lt;/p&gt;&lt;p&gt;If youâre interested in being part of this journey, check out our &lt;a href=\&quot;https://www.cloudflare.com/careers/\&quot;&gt;&lt;u&gt;careers page&lt;/u&gt;&lt;/a&gt; for open roles - weâre always looking for new talent to help us to help build a better Internet.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-09-26T14:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-09-26T16:08:25.239Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2GUKNR9jGUpLX1qjIFcV2h/f4706e05785de7f027f9bd4a2a7161cc/image2.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;1Cv5JjXzKWKEA10JdYbXu1&quot;],&quot;name&quot;:[0,&quot;Birthday Week&quot;],&quot;slug&quot;:[0,&quot;birthday-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;w4e8pkoz9c8xNDVhy9eNe&quot;],&quot;name&quot;:[0,&quot;Rust&quot;],&quot;slug&quot;:[0,&quot;rust&quot;]}],[0,{&quot;id&quot;:[0,&quot;3FBpuRfF7HUFga2Z5jgAFf&quot;],&quot;name&quot;:[0,&quot;NGINX&quot;],&quot;slug&quot;:[0,&quot;nginx&quot;]}],[0,{&quot;id&quot;:[0,&quot;2UVIYusJwlvsmPYl2AvSuR&quot;],&quot;name&quot;:[0,&quot;Deep Dive&quot;],&quot;slug&quot;:[0,&quot;deep-dive&quot;]}],[0,{&quot;id&quot;:[0,&quot;4ggKJG4JUzqG9FpAPIxwij&quot;],&quot;name&quot;:[0,&quot;Engineering&quot;],&quot;slug&quot;:[0,&quot;engineering&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Richard Boulton&quot;],&quot;slug&quot;:[0,&quot;richard&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1txFE2DMbnjFPes7HcHdLj/2446d6393523994a68cc872fbdb7a44c/richard.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Steve Goldsmith&quot;],&quot;slug&quot;:[0,&quot;steve-goldsmith&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/KqdGpozSazI55A5VgXSdl/7f90d8fdfccd5c923ae51f9e8561e53e/Steve_Goldsmith.png&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Maurizio Abba&quot;],&quot;slug&quot;:[0,&quot;maurizio-abba&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3390iTcZ01ixqSvPU9BMwJ/2f2c5096fb5dc1dade811ebbe306801a/Maurizio_Abba.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Matthew Bullock&quot;],&quot;slug&quot;:[0,&quot;matthew-bullock&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6glr6c3xSYZVYVEOrV8vOj/f98c7dc32bee1845224820a5f9964c9e/Matthew_Bullock.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Weâve replaced the original core system in Cloudflare with a new modular Rust-based proxy, replacing NGINX. Itâs not only substantially faster for all our customers, itâs also more secure, and lets us ship new products quicker than ever before.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/20-percent-internet-upgrade&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Cloudflare just got faster and more secure, powered by Rust&quot;],&quot;description&quot;:[0,&quot;Weâve replaced the original core system in Cloudflare with a new modular Rust-based proxy, replacing NGINX. Itâs not only substantially faster for all our customers, itâs also more secure, and lets us ship new products quicker than ever before.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7CuDYmnhcjbOyk4aLYEjBT/1c43939f2750244917d664560232183f/OG_Share_2024_-_2025-09-26T153125.900.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;7rcW6x4j6v7O6ZEHir5fmK&quot;],&quot;title&quot;:[0,&quot;An AI Index for all our customers&quot;],&quot;slug&quot;:[0,&quot;an-ai-index-for-all-our-customers&quot;],&quot;excerpt&quot;:[0,&quot;Cloudflare will soon automatically create an AI-optimized search index for your domain, and expose a set of ready-to-use standard APIs and tools including an MCP server, LLMs.txt, and a search API.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Today, weâre announcing the &lt;b&gt;private beta&lt;/b&gt; of &lt;b&gt;AI Index &lt;/b&gt;for domains on Cloudflare, a new type of web index that gives content creators the tools to make their data discoverable by AI, and gives AI builders access to better data for fair compensation.&lt;/p&gt;&lt;p&gt;With AI Index enabled on your domain, we will automatically create an AI-optimized search index for your website, and expose a set of ready-to-use standard APIs and tools including an MCP server, LLMs.txt, and a search API. Our customers will own and control that index and how itâs used, and you will have the ability to monetize access through &lt;a href=\&quot;https://developers.cloudflare.com/ai-crawl-control/features/pay-per-crawl/what-is-pay-per-crawl/\&quot;&gt;&lt;u&gt;Pay per crawl&lt;/u&gt;&lt;/a&gt; and the new &lt;a href=\&quot;https://blog.cloudflare.com/x402/\&quot;&gt;&lt;u&gt;x402 integrations&lt;/u&gt;&lt;/a&gt;. You will be able to use it to build modern search experiences on your own site, and more importantly, interact with external AI and Agentic providers to make your content more discoverable while being fairly compensated.&lt;/p&gt;&lt;p&gt;For AI buildersâwhether developers creating agentic applications, or AI platform companies providing foundational LLM modelsâCloudflare will offer a new way to discover and retrieve web content: direct &lt;b&gt;pub/sub connections&lt;/b&gt; to individual websites with AI Index. Instead of indiscriminate crawling, builders will be able to subscribe to specific sites that have opted in for discovery, receive structured updates as soon as content changes, and pay fairly for each access. Access is always at the discretion of the site owner.&lt;/p&gt;&lt;p&gt;From the individual indexes, Cloudflare will also build an aggregated layer, the &lt;b&gt;Open Index&lt;/b&gt;, that bundles together participating sites. Builders get a single place to search across collections or the broader web, while every site still retains control and can earn from participation.Â &lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;why-build-an-ai-index\&quot;&gt;Why build an AI Index?&lt;/h3&gt;\n      &lt;a href=\&quot;#why-build-an-ai-index\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;AI platforms are quickly becoming one of the main ways people discover information online. Whether asking a chatbot to summarize a news article or find a product recommendation, the path to that answer almost always starts with crawling original content and indexing or using that data for training. However, today, that process is largely controlled by platforms: what gets crawled, how often, and whether the site owner has any input in the matter.&lt;/p&gt;&lt;p&gt;Although Cloudflare now offers to monitor and control how AI services respect your access policies and how they access your content, it&amp;#39;s still challenging to make new content visible. Content creators have no efficient way to signal to AI builders when a page is published or updated. On the other hand, for AI builders, crawling and recrawling unstructured content is costly, wastes resources, especially when you donât know the quality and cost in advance.&lt;/p&gt;&lt;p&gt;We need a fairer and healthier ecosystem for content discovery and usage that bridges the gap between content creators and AI builders.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;how-ai-index-will-work\&quot;&gt;How AI Index will work&lt;/h3&gt;\n      &lt;a href=\&quot;#how-ai-index-will-work\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;When you onboard a domain to Cloudflare, or if you have an existing domain on Cloudflare, you will have the choice to enable an AI Index. If enabled, we will automatically create an AI-optimized search index for your domain that you own and control.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3kV7Oru6D5jPWeGeWDQDsi/7d738250f24250cf98db2e96222319ec/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1648\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;As your site updates and grows, the index will evolve with it. New or updated pages will be processed in real-time using the same technology that powers Cloudflare &lt;a href=\&quot;https://developers.cloudflare.com/ai-search/\&quot;&gt;&lt;u&gt;AI Search (formerly AutoRAG)&lt;/u&gt;&lt;/a&gt; and its &lt;a href=\&quot;https://developers.cloudflare.com/ai-search/configuration/data-source/website/\&quot;&gt;&lt;u&gt;Website&lt;/u&gt;&lt;/a&gt; as a data source. Best of all, we will manage everything; you won&amp;#39;t have to worry about each individual component of compute, storage resources, databases, embeddings, chunking, or AI models. Everything will happen behind the scenes, automatically.&lt;/p&gt;&lt;p&gt;Importantly, you will have control over what content to &lt;b&gt;include or exclude &lt;/b&gt;from your website&amp;#39;s index, and &lt;b&gt;who&lt;/b&gt; can get access to your content via &lt;b&gt;AI&lt;/b&gt; &lt;b&gt;Crawl Control&lt;/b&gt;, ensuring that only the data you want to expose is made searchable and accessible. You also will be able to opt out of the AI Index completely; it will all be up to you.&lt;/p&gt;&lt;p&gt;When your AI Index is set up, you will get a set of ready-to-use APIs: Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;An MCP Server: &lt;/b&gt;Agentic applications will be able to connect directly to your site using the &lt;a href=\&quot;https://www.cloudflare.com/learning/ai/what-is-model-context-protocol-mcp/\&quot;&gt;&lt;u&gt;Model Context Protocol (MCP)&lt;/u&gt;&lt;/a&gt;, making your content discoverable to agents in a standardized way. This includes support for &lt;a href=\&quot;https://developers.cloudflare.com/ai-search/how-to/nlweb/\&quot;&gt;&lt;u&gt;NLWeb&lt;/u&gt;&lt;/a&gt; tools, an open project developed by Microsoft that defines a standard protocol for natural language queries on websites.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;A flexible search API: &lt;/b&gt;This endpoint will&lt;b&gt; &lt;/b&gt;return relevant results in structured JSON.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;LLMs.txt and LLMs-full.txt: &lt;/b&gt;Standard files that provide LLMs with a machine-readable map of your site, following &lt;a href=\&quot;https://github.com/AnswerDotAI/llms-txt\&quot;&gt;&lt;u&gt;emerging open standards&lt;/u&gt;&lt;/a&gt;. These will help models understand how to use your siteâs content at inference time. An example of &lt;a href=\&quot;https://developers.cloudflare.com/llms.txt\&quot;&gt;&lt;u&gt;llms.txt&lt;/u&gt;&lt;/a&gt; exists in the Cloudflare Developer Documentation.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;A bulk data API: &lt;/b&gt;An endpoint&lt;b&gt; &lt;/b&gt;for transferring large amounts of content efficiently, available under the rules you set. Instead of querying for every document, AI providers will be able to ingest in one shot.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Pub-sub subscriptions: &lt;/b&gt;AI platforms will be able to subscribe to your siteâs index and receive events and content updates directly from Cloudflare in a structured format in real-time, making it easy for them to stay current without re-crawling.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Discoverability directives:&lt;/b&gt; In robots.txt and well-known URIs to allow AI agents and crawlers visiting your site to discover and use the available API automatically.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4Hr3EhsMBH0oVwMVKywwre/2a01efbe03d67a8154123b63c05c000f/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1668\&quot; height=\&quot;1270\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The index will integrate directly with &lt;a href=\&quot;https://developers.cloudflare.com/ai-crawl-control/\&quot;&gt;&lt;u&gt;AI Crawl Control&lt;/u&gt;&lt;/a&gt;, so you will be able to see whoâs accessing your content, set rules, and manage permissions. And with &lt;a href=\&quot;https://developers.cloudflare.com/ai-crawl-control/features/pay-per-crawl/what-is-pay-per-crawl/\&quot;&gt;&lt;u&gt;Pay per crawl&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://blog.cloudflare.com/x402/\&quot;&gt;&lt;u&gt;x402 integrations&lt;/u&gt;&lt;/a&gt;, you can choose to directly monetize access to your content.Â &lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;a-feed-of-the-web-for-ai-builders\&quot;&gt;A feed of the web for AI builders&lt;/h3&gt;\n      &lt;a href=\&quot;#a-feed-of-the-web-for-ai-builders\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;As an AI builder, you will be able to discover and subscribe to high-quality, permissioned web data through individual siteâs AI indexes. Instead of sending crawlers blindly across the open Internet, you will connect via a pub/sub model: participating websites will expose structured updates whenever their content changes, and you will be able to subscribe to receive those updates in real-time. With this model, your new workflow may look something like this:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Discover websites that have opted in: &lt;/b&gt;Browse and filter through a directory of websites that make their indexes available through Cloudflare.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Evaluate content with metadata and metrics: &lt;/b&gt;Get content metadata information on various metrics (e.g., uniqueness, depth, contextual relevance, popularity) before accessing it.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Pay fairly for access:&lt;/b&gt; When content is valuable, platforms can compensate creators directly through Pay per crawl. These payments not only enable access but also support the continued creation of original content, helping to sustain a healthier ecosystem for discovery.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Subscribe to updates: &lt;/b&gt;Use pub-sub subscriptions to receive events about changes made by the website, so you know when to retrieve or crawl for new content without wasting resources on constant re-crawling.Â &lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;By shifting from blind crawling to a permissioned pub/sub system for the web, AI builders save time, cut costs, and gain access to cleaner, high-quality data while content creators remain in control and are fairly compensated.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;the-aggregated-open-index\&quot;&gt;The aggregated Open Index&lt;/h3&gt;\n      &lt;a href=\&quot;#the-aggregated-open-index\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Individual indexes provide AI platforms with the ability to access data directly from specific sites, allowing them to subscribe for updates, evaluate value, and pay for full content access on a per-site basis. But when builders need to work at a larger scale, managing dozens or hundreds of separate subscriptions can become complex. The &lt;b&gt;Open Index &lt;/b&gt;will provide an additional option: a bundled, opt-in collection of those indexes, featuring sophisticated features such as quality, uniqueness, originality, and depth of content filters, all accessible in one place.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6rjkK5UCh9BLSqceUuG0RI/92413aed318baced0ee8812bec511cfb/image2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1428\&quot; height=\&quot;1428\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The Open Index is designed to make content discovery at scale easier:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Get unified access: &lt;/b&gt;Query and retrieve data across many participating sites simultaneously. This reduces integration overhead and enables builders to plug into a curated collection of data, or use it as a ready-made web search layer that can be accessed at query time.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Discover broader scopes: &lt;/b&gt;Work with topic-specific bundles (e.g., news, documentation, scientific research) or a general discovery index covering the broader web. This makes it simple to explore new content sources you may not have identified individually.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Bottom-up monetization: &lt;/b&gt;Results still originate from an individual siteâs AI index, with monetization flowing back to that site through Pay per crawl, helping preserve fairness and sustainability at scale.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Together, per-site AI indexes and the Open Index will provide flexibility and precise control when you want full content from individual sites (i.e., for training, AI agents, or search experiences), and broad search coverage when you need a unified search across the web.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;how-you-can-participate-in-the-shift\&quot;&gt;How you can participate in the shift&lt;/h3&gt;\n      &lt;a href=\&quot;#how-you-can-participate-in-the-shift\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;With AI Index and the Cloudflare Open Index, weâre creating a model where websites decide how their content is accessed, and AI builders receive structured, reliable data at scale to build a fairer and healthier ecosystem for content discovery and usage on the Internet.&lt;/p&gt;&lt;p&gt;Weâre starting with a &lt;b&gt;private beta&lt;/b&gt;. If you want to enroll your website into the AI Index or access the pub/sub web feed as an AI builder, you can &lt;a href=\&quot;https://www.cloudflare.com/aiindex-signup/\&quot;&gt;&lt;b&gt;&lt;u&gt;sign up today&lt;/u&gt;&lt;/b&gt;&lt;/a&gt;.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-09-26T14:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-09-26T17:21:14.339Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6J6lIfWMLcbwO0cxZdPgMK/fef7025e7e1cf152a1ef5336a884e342/image4.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;1Cv5JjXzKWKEA10JdYbXu1&quot;],&quot;name&quot;:[0,&quot;Birthday Week&quot;],&quot;slug&quot;:[0,&quot;birthday-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Op8qyK3Ak9n2ECtnFlecF&quot;],&quot;name&quot;:[0,&quot;Pay Per Crawl&quot;],&quot;slug&quot;:[0,&quot;pay-per-crawl&quot;]}],[0,{&quot;id&quot;:[0,&quot;44uHdXu9o4XHLTESdDESRf&quot;],&quot;name&quot;:[0,&quot;AI Search&quot;],&quot;slug&quot;:[0,&quot;ai-search&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Lfy7VaNvl5G8gOYMKFiux&quot;],&quot;name&quot;:[0,&quot;MCP&quot;],&quot;slug&quot;:[0,&quot;mcp&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Celso Martinho&quot;],&quot;slug&quot;:[0,&quot;celso&quot;],&quot;bio&quot;:[0,&quot;From when Mosaic took over Gopher. Engineering Director at Cloudflare.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2pzgat1zmt1oF1byi7hskH/7b25e8e00117ee44afe36ad27d7d8032/celso.png&quot;],&quot;location&quot;:[0,&quot;Portugal, Lisbon&quot;],&quot;website&quot;:[0,&quot;https://celso.io/&quot;],&quot;twitter&quot;:[0,&quot;@celso&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Anni Wang&quot;],&quot;slug&quot;:[0,&quot;anni&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3RnKI54hxLOIRs0QBSZgxa/e71b8f7a5ccadb45dd553c69f8ffe539/anni.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,&quot;https://www.linkedin.com/in/a248wang/&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflare will soon automatically create an AI-optimized search index for your domain, and expose a set of ready-to-use standard APIs and tools including an MCP server, LLMs.txt, and a search API. For AI builders, Cloudflare will offer a new way to discover and retrieve web content.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/an-ai-index-for-all-our-customers&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;An AI Index for all our customers&quot;],&quot;description&quot;:[0,&quot;Cloudflare will soon automatically create an AI-optimized search index for your domain, and expose a set of ready-to-use standard APIs and tools including an MCP server, LLMs.txt, and a search API. For AI builders, Cloudflare will offer a new way to discover and retrieve web content.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/658z125qCMtvKl5Xcj4Xsk/233002a692e16e327e62f5d27575beb6/OG_Share_2024_-_2025-09-26T160424.251.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;6QVNgwE5ZlVbZcWQHJKsDS&quot;],&quot;title&quot;:[0,&quot;Monitoring AS-SETs and why they matter&quot;],&quot;slug&quot;:[0,&quot;monitoring-as-sets-and-why-they-matter&quot;],&quot;excerpt&quot;:[0,&quot;We will cover some of the reasons why operators need to monitor the AS-SET memberships for their ASN, and now Cloudflare Radar can help. &quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;introduction-to-as-sets\&quot;&gt;Introduction to AS-SETs&lt;/h2&gt;\n      &lt;a href=\&quot;#introduction-to-as-sets\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;An &lt;a href=\&quot;https://www.apnic.net/manage-ip/using-whois/guide/as-set/\&quot;&gt;&lt;u&gt;AS-SET&lt;/u&gt;&lt;/a&gt;, not to be confused with the &lt;a href=\&quot;https://datatracker.ietf.org/doc/rfc9774/\&quot;&gt;&lt;u&gt;recently deprecated BGP AS_SET&lt;/u&gt;&lt;/a&gt;, is an &lt;a href=\&quot;https://irr.net/overview/\&quot;&gt;&lt;u&gt;Internet Routing Registry (IRR)&lt;/u&gt;&lt;/a&gt; object that allows network operators to group related networks together. AS-SETs have been used historically for multiple purposes such as grouping together a list of downstream customers of a particular network provider. For example, Cloudflare uses the &lt;a href=\&quot;https://irrexplorer.nlnog.net/as-set/AS13335:AS-CLOUDFLARE\&quot;&gt;&lt;u&gt;AS13335:AS-CLOUDFLARE&lt;/u&gt;&lt;/a&gt; AS-SET to group together our list of our own &lt;a href=\&quot;https://www.cloudflare.com/learning/network-layer/what-is-an-autonomous-system/\&quot;&gt;&lt;u&gt;Autonomous System Numbers&lt;/u&gt;&lt;/a&gt; (ASNs) and our downstream Bring-Your-Own-IP (BYOIP) customer networks, so we can ultimately &lt;a href=\&quot;https://www.peeringdb.com/net/4224\&quot;&gt;&lt;u&gt;communicate&lt;/u&gt;&lt;/a&gt; to other networks whose prefixes they should accept from us.Â &lt;/p&gt;&lt;p&gt;In other words, an AS-SET is &lt;i&gt;currently&lt;/i&gt; the way on the Internet that allows someone to attest the networks for which they are the provider. This system of provider authorization is completely trust-based, meaning it&amp;#39;s &lt;a href=\&quot;https://www.kentik.com/blog/the-scourge-of-excessive-as-sets/\&quot;&gt;&lt;u&gt;not reliable at all&lt;/u&gt;&lt;/a&gt;, and is best-effort. The future of an RPKI-based provider authorization system is &lt;a href=\&quot;https://datatracker.ietf.org/doc/draft-ietf-sidrops-aspa-verification/\&quot;&gt;&lt;u&gt;coming in the form of ASPA (Autonomous System Provider Authorization),&lt;/u&gt;&lt;/a&gt; but it will take time for standardization and adoption. Until then, we are left with AS-SETs.&lt;/p&gt;&lt;p&gt;Because AS-SETs are so critical for BGP routing on the Internet, network operators need to be able to monitor valid and invalid AS-SET &lt;i&gt;memberships &lt;/i&gt;for their networks. Cloudflare Radar now introduces a transparent, public listing to help network operators in our &lt;a href=\&quot;https://radar.cloudflare.com/routing/as13335\&quot;&gt;&lt;u&gt;routing page&lt;/u&gt;&lt;/a&gt; per ASN.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;as-sets-and-building-bgp-route-filters\&quot;&gt;AS-SETs and building BGP route filters&lt;/h2&gt;\n      &lt;a href=\&quot;#as-sets-and-building-bgp-route-filters\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;AS-SETs are a critical component of BGP policies, and often paired with the expressive &lt;a href=\&quot;https://irr.net/rpsl-guide/\&quot;&gt;&lt;u&gt;Routing Policy Specification Language (RPSL)&lt;/u&gt;&lt;/a&gt; that describes how a particular BGP ASN accepts and propagates routes to other networks. Most often, networks use AS-SET to express what other networks should accept from them, in terms of downstream customers.Â &lt;/p&gt;&lt;p&gt;Back to the AS13335:AS-CLOUDFLARE example AS-SET, this is published clearly on &lt;a href=\&quot;https://www.peeringdb.com/net/4224\&quot;&gt;&lt;u&gt;PeeringDB&lt;/u&gt;&lt;/a&gt; for other peering networks to reference and build filters against.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2590TMppv2h4SAi7uy6xS9/617ec81e2364f470c0efe243a528f695/image6.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;944\&quot; height=\&quot;360\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;When turning up a new transit provider service, we also ask the provider networks to build their route filters using the same AS-SET. Because BGP prefixes are also created in IRR &lt;a href=\&quot;https://irr.net/registry/\&quot;&gt;&lt;u&gt;registries&lt;/u&gt;&lt;/a&gt; using the &lt;i&gt;route&lt;/i&gt; or &lt;i&gt;route6 &lt;/i&gt;&lt;a href=\&quot;https://developers.cloudflare.com/byoip/concepts/irr-entries/best-practices/\&quot;&gt;&lt;u&gt;objects&lt;/u&gt;&lt;/a&gt;, peers and providers now know what BGP prefixes they should accept from us and deny the rest. A popular tool for building prefix-lists based on AS-SETs and IRR databases is &lt;a href=\&quot;https://github.com/bgp/bgpq4\&quot;&gt;&lt;u&gt;bgpq4&lt;/u&gt;&lt;/a&gt;, and itâs one you can easily try out yourself.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7F2QdhcZTLEJjKNtZbBWxR/92efe32dcef67aa6d51c3b1a29218843/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;735\&quot; height=\&quot;691\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;For example, to generate a Juniper routerâs IPv4 prefix-list containing prefixes that AS13335 could propagate for Cloudflare and its customers, you may use:Â &lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;% bgpq4 -4Jl CLOUDFLARE-PREFIXES -m24 AS13335:AS-CLOUDFLARE | head -n 10\npolicy-options {\nreplace:\n prefix-list CLOUDFLARE-PREFIXES {\n    1.0.0.0/24;\n    1.0.4.0/22;\n    1.1.1.0/24;\n    1.1.2.0/24;\n    1.178.32.0/19;\n    1.178.32.0/20;\n    1.178.48.0/20;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;&lt;sup&gt;&lt;i&gt;Restricted to 10 lines, actual output of prefix-list would be much greater&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;This prefix list would be applied within an eBGP import policy by our providers and peers to make sure AS13335 is only able to propagate announcements for ourselves and our customers.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;how-accurate-as-sets-prevent-route-leaks\&quot;&gt;How accurate AS-SETs prevent route leaks&lt;/h2&gt;\n      &lt;a href=\&quot;#how-accurate-as-sets-prevent-route-leaks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Letâs see how accurate AS-SETs can help prevent route leaks with a simple example. In this example, AS64502 has two providers â AS64501 and AS64503. AS64502 has accidentally messed up their BGP export policy configuration toward the AS64503 neighbor, and is exporting &lt;b&gt;all&lt;/b&gt; routes, including those it receives from their AS64501 provider. This is a typical &lt;a href=\&quot;https://datatracker.ietf.org/doc/html/rfc7908#section-3.1\&quot;&gt;&lt;u&gt;Type 1 Hairpin route leak&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/D69Fq0jXg9MaGieS0KqZ2/42fa33a433c875591b85ce9a6db91610/image5.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1146\&quot; height=\&quot;614\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Fortunately, AS64503 has implemented an import policy that they generated using IRR data including AS-SETs and route objects. By doing so, they will only accept the prefixes that originate from the &lt;a href=\&quot;https://www.manrs.org/wp-content/uploads/2021/11/AS-Cones-MANRS.pdf\&quot;&gt;&lt;u&gt;AS Cone&lt;/u&gt;&lt;/a&gt; of AS64502, since they are their customer. Instead of having a major reachability or latency impact for many prefixes on the Internet because of this route leak propagating, it is stopped in its tracks thanks to the responsible filtering by the AS64503 provider network. Again it is worth keeping in mind the success of this strategy is dependent upon data accuracy for the fictional AS64502:AS-CUSTOMERS AS-SET.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;monitoring-as-set-misuse\&quot;&gt;Monitoring AS-SET misuse&lt;/h2&gt;\n      &lt;a href=\&quot;#monitoring-as-set-misuse\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Besides using AS-SETs to group together oneâs downstream customers, AS-SETs can also represent other types of relationships, such as peers, transits, or IXP participations.&lt;/p&gt;&lt;p&gt;For example, there are 76 AS-SETs that directly include one of the Tier-1 networks, Telecom Italia / Sparkle (AS6762). Judging from the names of the AS-SETs, most of them are representing peers and transits of certain ASNs, which includes AS6762. You can view this output yourself at &lt;a href=\&quot;https://radar.cloudflare.com/routing/as6762#irr-as-sets\&quot;&gt;&lt;u&gt;https://radar.cloudflare.com/routing/as6762#irr-as-sets&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/eeAA6iWaAVd6qd2rB93VM/ff37a27156f8229639a6ec377c7eb273/image7.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1410\&quot; height=\&quot;815\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;There is nothing wrong with defining AS-SETs that contain oneâs peers or upstreams as long as those AS-SETs are not submitted upstream for customer-&amp;gt;provider BGP session filtering. In fact, an AS-SET for upstreams or peer-to-peer relationships can be useful for defining a networkâs policies in RPSL.&lt;/p&gt;&lt;p&gt;However, some AS-SETs in the AS6762 membership list such as AS-10099 look to attest customer relationships.Â &lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;% whois -h rr.ntt.net AS-10099 | grep &amp;quot;descr&amp;quot;\ndescr:          CUHK Customer&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We know AS6762 is transit free and this customer membership must be invalid, so it is a prime example of AS-SET misuse that would ideally be cleaned up. Many Internet Service Providers and network operators are more than happy to correct an invalid AS-SET entry when asked to. It is reasonable to look at each AS-SET membership like this as a potential risk of having higher route leak propagation to major networks and the Internet when they happen.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;as-set-information-on-cloudflare-radar\&quot;&gt;AS-SET information on Cloudflare Radar&lt;/h2&gt;\n      &lt;a href=\&quot;#as-set-information-on-cloudflare-radar\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;&lt;a href=\&quot;https://radar.cloudflare.com/\&quot;&gt;&lt;u&gt;Cloudflare Radar&lt;/u&gt;&lt;/a&gt; is a hub that showcases global Internet traffic, attack, and technology trends and insights. Today, we are adding IRR AS-SET information to Radarâs routing section, freely available to the public via both website and API access. To view all AS-SETs an AS is a member of, directly or indirectly via other AS-SETs, a user can visit the corresponding ASâs routing page. For example, the AS-SETs list for Cloudflare (AS13335) is available at &lt;a href=\&quot;https://radar.cloudflare.com/routing/as13335#irr-as-sets\&quot;&gt;&lt;u&gt;https://radar.cloudflare.com/routing/as13335#irr-as-sets&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;The AS-SET data on IRR contains only limited information like the AS members and AS-SET members. Here at Radar, we also enhance the AS-SET table with additional useful information as follows.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;Inferred ASN&lt;/code&gt; shows the AS number that is inferred to be the creator of the AS-SET. We use PeeringDB AS-SET information match if available. Otherwise, we parse the AS-SET name to infer the creator.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;IRR Sources&lt;/code&gt; shows which IRR databases we see the corresponding AS-SET. We are currently using the following databases: &lt;code&gt;AFRINIC&lt;/code&gt;, &lt;code&gt;APNIC&lt;/code&gt;, &lt;code&gt;ARIN&lt;/code&gt;, &lt;code&gt;LACNIC&lt;/code&gt;, &lt;code&gt;RIPE&lt;/code&gt;, &lt;code&gt;RADB&lt;/code&gt;, &lt;code&gt;ALTDB&lt;/code&gt;, &lt;code&gt;NTTCOM&lt;/code&gt;, and &lt;code&gt;TC&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;AS Members&lt;/code&gt; and &lt;code&gt;AS-SET members&lt;/code&gt; show the count of the corresponding types of members.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;AS Cone&lt;/code&gt; is the count of the unique ASNs that are included by the AS-SET directly or indirectly.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;Upstreams&lt;/code&gt; is the count of unique AS-SETs that includes the corresponding AS-SET.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Users can further filter the table by searching for a specific AS-SET name or ASN. A toggle to show only direct or indirect AS-SETs is also available.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/0ssTf7bi6yjT2m0YKWPJE/e20b18a7d3151652fecbe606bbe13346/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1268\&quot; height=\&quot;755\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In addition to listing AS-SETs, we also provide a tree-view to display how an AS-SET includes a given ASN. For example, the following screenshot shows how as-delta indirectly includes AS6762 through 7 additional other AS-SETs. Users can copy or download this tree-view content in the text format, making it easy to share with others.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2hNbh2gdj2F0eLTYrzjrVN/eceb588456067a387e7cb6eb3e1e3c5e/image4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1021\&quot; height=\&quot;593\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;We built this Radar feature using our&lt;a href=\&quot;https://developers.cloudflare.com/api/resources/radar/subresources/entities/subresources/asns/methods/as_set/\&quot;&gt;&lt;u&gt; publicly available API&lt;/u&gt;&lt;/a&gt;, the same way other Radar websites are built. We have also experimented using this API to build additional features like a full AS-SET tree visualization. We encourage developers to give &lt;a href=\&quot;https://developers.cloudflare.com/api/resources/radar/subresources/entities/subresources/asns/methods/as_set/\&quot;&gt;&lt;u&gt;this API&lt;/u&gt;&lt;/a&gt; (and &lt;a href=\&quot;https://developers.cloudflare.com/api/resources/radar/\&quot;&gt;&lt;u&gt;other Radar APIs&lt;/u&gt;&lt;/a&gt;) a try, and tell us what you think!&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4ElaU3M5oe8xRnblrrf67u/3fa35d3a25d797c0b0cbe96f0490fa93/image8.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1424\&quot; height=\&quot;839\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;looking-ahead\&quot;&gt;Looking ahead&lt;/h2&gt;\n      &lt;a href=\&quot;#looking-ahead\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;We know AS-SETs are hard to keep clean of error or misuse, and even though Radar is making them easier to monitor, the mistakes and misuse will continue. Because of this, we as a community need to push forth adoption of &lt;a href=\&quot;https://datatracker.ietf.org/doc/rfc9234/\&quot;&gt;&lt;u&gt;RFC9234&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://blog.apnic.net/2025/09/05/preventing-route-leaks-made-simple-bgp-roleplay-with-junos-rfc-9234/\&quot;&gt;&lt;u&gt;implementations&lt;/u&gt;&lt;/a&gt; of it from the major vendors. RFC9234 embeds roles and an Only-To-Customer (OTC) attribute directly into the BGP protocol itself, helping to detect and prevent route leaks in-line. In addition to BGP misconfiguration protection with RFC9234, Autonomous System Provider Authorization (ASPA) is still making its way &lt;a href=\&quot;https://datatracker.ietf.org/doc/draft-ietf-sidrops-aspa-verification/\&quot;&gt;&lt;u&gt;through the IETF&lt;/u&gt;&lt;/a&gt; and will eventually help offer an authoritative means of attesting who the actual providers are per BGP Autonomous System (AS).&lt;/p&gt;&lt;p&gt;If you are a network operator and manage an AS-SET, you should seriously consider moving to &lt;a href=\&quot;https://manrs.org/2022/12/why-network-operators-should-use-hierarchical-as-sets/\&quot;&gt;&lt;u&gt;hierarchical AS-SETs&lt;/u&gt;&lt;/a&gt; if you have not already. A hierarchical AS-SET looks like AS13335:AS-CLOUDFLARE instead of AS-CLOUDFLARE, but the difference is very important. Only a proper maintainer of the AS13335 ASN can create AS13335:AS-CLOUDFLARE, whereas anyone could create AS-CLOUDFLARE in an IRR database if they wanted to. In other words, using hierarchical AS-SETs helps guarantee ownership and prevent the malicious poisoning of routing information.&lt;/p&gt;&lt;p&gt;While keeping track of AS-SET memberships seems like a chore, it can have significant payoffs in preventing BGP-related &lt;a href=\&quot;https://blog.cloudflare.com/cloudflare-1111-incident-on-june-27-2024/\&quot;&gt;&lt;u&gt;incidents&lt;/u&gt;&lt;/a&gt; such as route leaks. We encourage all network operators to do their part in making sure the AS-SETs you submit to your providers and peers to communicate your downstream customer cone are accurate. Every small adjustment or clean-up effort in AS-SETs could help lessen the impact of a BGP incident later.&lt;/p&gt;&lt;p&gt;Visit &lt;a href=\&quot;https://radar.cloudflare.com/\&quot;&gt;&lt;u&gt;Cloudflare Radar&lt;/u&gt;&lt;/a&gt; for additional insights around (Internet disruptions, routing issues, Internet traffic trends, attacks, Internet quality, etc.). Follow us on social media at &lt;a href=\&quot;https://twitter.com/CloudflareRadar\&quot;&gt;&lt;u&gt;@CloudflareRadar&lt;/u&gt;&lt;/a&gt; (X), &lt;a href=\&quot;https://noc.social/@cloudflareradar\&quot;&gt;&lt;u&gt;https://noc.social/@cloudflareradar&lt;/u&gt;&lt;/a&gt; (Mastodon), and &lt;a href=\&quot;https://bsky.app/profile/radar.cloudflare.com\&quot;&gt;&lt;u&gt;radar.cloudflare.com&lt;/u&gt;&lt;/a&gt; (Bluesky), or contact us via &lt;a href=\&quot;mailto:radar@cloudflare.com\&quot;&gt;&lt;u&gt;e-mail&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-09-26T14:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-09-26T13:00:15.701Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1CdfEPkY98vaZmKrDJeRDE/0ea7ded3821d324e13a90dbd2c076679/image2.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;5O7yCWW0RgXMAc5MVjwcGS&quot;],&quot;name&quot;:[0,&quot;BGP&quot;],&quot;slug&quot;:[0,&quot;bgp&quot;]}],[0,{&quot;id&quot;:[0,&quot;WDGNmuLDEdkUgarnyuP8w&quot;],&quot;name&quot;:[0,&quot;RPKI&quot;],&quot;slug&quot;:[0,&quot;rpki&quot;]}],[0,{&quot;id&quot;:[0,&quot;1Cv5JjXzKWKEA10JdYbXu1&quot;],&quot;name&quot;:[0,&quot;Birthday Week&quot;],&quot;slug&quot;:[0,&quot;birthday-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;3TaNOBp8EhAE6eCfshf1tK&quot;],&quot;name&quot;:[0,&quot;Cloudflare Network&quot;],&quot;slug&quot;:[0,&quot;cloudflare-network&quot;]}],[0,{&quot;id&quot;:[0,&quot;5kZtWqjqa7aOUoZr8NFGwI&quot;],&quot;name&quot;:[0,&quot;Radar&quot;],&quot;slug&quot;:[0,&quot;cloudflare-radar&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Mingwei Zhang&quot;],&quot;slug&quot;:[0,&quot;mingwei&quot;],&quot;bio&quot;:[0,&quot;Senior Systems Engineer&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5QnUBSretQguH6rvS2M2T/d1f5ade5702d47e9b582b700df51b9e4/mingwei.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@heymingwei&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Bryton Herdes&quot;],&quot;slug&quot;:[0,&quot;bryton&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2CtRZInMXDzWbBSlJZq6ob/cc0d484943cf18a7d24debb3d01a3ece/bryton.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,&quot;https://next-hopself.net/&quot;],&quot;twitter&quot;:[0,&quot;@next_hopself&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;AS-SETs, for better or worse, are critical data sources that help build BGP route filters across the Internet. Because these AS-SET objects are based solely on trust, they can be misused. We will cover some of the reasons why operators need to monitor the AS-SET memberships for their ASN, and now Cloudflare Radar can help. &quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/monitoring-as-sets-and-why-they-matter&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Monitoring AS-SETs and why they matter&quot;],&quot;description&quot;:[0,&quot;AS-SETs, for better or worse, are critical data sources that help build BGP route filters across the Internet. Because these AS-SET objects are based solely on trust, they can be misused. We will cover some of the reasons why operators need to monitor the AS-SET memberships for their ASN, and now Cloudflare Radar can help.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2TQDDkuu0xlscJKZiwvBMR/193985535b3b30f2b69175deae5e89b6/OG_Share_2024_-_2025-09-26T162503.502.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;tfg3NnmVPl0IoCJgQYuao&quot;],&quot;title&quot;:[0,&quot;Introducing Observatory and Smart Shield â see how the world sees your website, and make it faster in one click&quot;],&quot;slug&quot;:[0,&quot;introducing-observatory-and-smart-shield&quot;],&quot;excerpt&quot;:[0,&quot;We&#39;re announcing two enhancements to our Application Performance suite that&#39;ll show how the world sees your website, and make it faster with one click - available Cloudflare Dashboard!&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Modern users expect instant, reliable web experiences. When your application is slow, they donât just complain â they leave. Even delays as small as 100 ms have been &lt;a href=\&quot;https://wpostats.com/\&quot;&gt;&lt;u&gt;shown to have a measurable impact on revenue, conversions, bounce rate, engagement and more&lt;/u&gt;&lt;/a&gt;.Â &lt;/p&gt;&lt;p&gt;If youâre responsible for delivering on these expectations to the users of your product, you know there are many monitoring tools that show you how visitors experience your website, and can let you know when things are slow or causing issues. This is essential, but we believe understanding the condition is only half the story. The real value comes from integrating monitoring and remedies in the same view, giving customers the ability to quickly identify and resolve issues.&lt;/p&gt;&lt;p&gt;That&amp;#39;s why today, we&amp;#39;re excited to launch the new and improved &lt;b&gt;Observatory&lt;/b&gt;, now in open beta. This monitoring and observability tool goes beyond charts and graphs, by also telling you exactly how to improve your application&amp;#39;s performance and resilience, and immediately showing you the impact of those changes. And weâre releasing it to all subscription tiers (including Free!), available today. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/T6HhZL51aLEhzD3lQPxCq/f9b03f05cf4db0b2e61c8e861df4ecdf/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;977\&quot; height=\&quot;1224\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;But wait, thereâs more! To make your usersâ experience in Cloudflare even faster, weâre launching Smart Shield, available today for all subscription tiers. Using Observatory, you can pinpoint performance bottlenecks, and for many of the most common issues, you can now apply the fix in just a few clicks with our &lt;b&gt;Smart Shield&lt;/b&gt; product. Double the fun!&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;our-unique-perspective-leveraging-data-from-20-of-the-web\&quot;&gt;Our unique perspective: leveraging data from 20% of the web&lt;/h2&gt;\n      &lt;a href=\&quot;#our-unique-perspective-leveraging-data-from-20-of-the-web\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Every day, Cloudflare handles traffic for over 20% of the web, giving us a unique vantage point into what makes websites faster and more resilient. We built Observatory to take advantage of this position, uniting data that is normally scattered across different tools â including real-user data, synthetic testing, error rates, and backend telemetry â into a single platform. This gives you a complete, cohesive picture of your application&amp;#39;s health end-to-end, in one spot, and enables you to easily identify and resolve performance issues.&lt;/p&gt;&lt;p&gt;For this launch, we&amp;#39;re bringing together:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Real-user data:&lt;/b&gt; See how your application performs for real people, in the real world.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Back-end telemetry:&lt;/b&gt; Break down the lifecycle of a request to pinpoint areas for improvement.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Error rates:&lt;/b&gt; Understand the stability of your application at both the edge and origin.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Cache hit ratios:&lt;/b&gt; Ensure you&amp;#39;re maximizing the performance of your configuration.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Synthetic testing:&lt;/b&gt; Proactively test and monitor key endpoints with powerful, accurate simulations.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Let&amp;#39;s take a quick look at each data set to see how we use them in Observatory.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;real-user-data\&quot;&gt;Real-user data&lt;/h2&gt;\n      &lt;a href=\&quot;#real-user-data\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;There are two primary forms of data collection: real-user data and synthetic data. Real-user data are performance metrics collected from real traffic, from real visitors, to your application. Itâs how users are &lt;i&gt;actually&lt;/i&gt; seeing your application perform in the real world. Itâs unpredictable, and covers every scenario.&lt;/p&gt;&lt;p&gt;Synthetic data is data collected using some sort of simulated test (loading a site in a headless browser, making network requests from a testing system to an endpoint, etc.). Tests are run under a predefined set of characteristics â location, network speed, etc. â to provide a consistent baseline.&lt;/p&gt;&lt;p&gt;Both forms of data have their uses, and companies with a strongly established culture of operational excellence tend to use both.&lt;/p&gt;&lt;p&gt;The first data youâll see when you visit Observatory is real-user data collected with &lt;a href=\&quot;https://www.cloudflare.com/web-analytics/\&quot;&gt;&lt;u&gt;Real User Monitoring (RUM)&lt;/u&gt;&lt;/a&gt;, with a particular focus on the &lt;a href=\&quot;https://www.cloudflare.com/learning/performance/what-are-core-web-vitals/\&quot;&gt;&lt;u&gt;Core Web Vital&lt;/u&gt;&lt;/a&gt; metrics.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/400NHp7OBcSXNmLi5AxXb8/641f6436574e040bfbc14b56c7bfcd70/1.5.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1305\&quot; height=\&quot;276\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;This is very intentional.&lt;/p&gt;&lt;p&gt;Real-user data should be the source of truth when it comes to measuring performance and resiliency of your application. Even the best of synthetic data sources are always going to be an approximation. They cannot cover every possible scenario, and because they are being run from a lab environment, they will not always reveal issues that may be more sporadic and unpredictable.&lt;/p&gt;&lt;p&gt;Theyâre also the best representation of what your users are experiencing when they access your site and, at the end of the day, thatâs why we focus on improving performance, resiliency,Â  and security for our users.&lt;/p&gt;&lt;p&gt;We believe so strongly in the importance of every company having access to accurate, detailed RUM data that we are providing it for free, to all accounts. In fact, weâre about to make our &lt;a href=\&quot;https://www.cloudflare.com/web-analytics/#:~:text=Privacy%20First\&quot;&gt;&lt;u&gt;privacy-first analytics&lt;/u&gt;&lt;/a&gt; â which doesnât track individual users for analytics â &lt;a href=\&quot;https://blog.cloudflare.com/the-rum-diaries-enabling-web-analytics-by-default/\&quot;&gt;&lt;u&gt;available by default for all free zones&lt;/u&gt;&lt;/a&gt; (&lt;b&gt;excluding data from EU or UK visitors&lt;/b&gt;), no setup necessary. We believe the right thing is arming everyone with detailed, actionable, real-user data, and we want to make it easy.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;backend-telemetry\&quot;&gt;Backend telemetry&lt;/h2&gt;\n      &lt;a href=\&quot;#backend-telemetry\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Front-end performance metrics are our best proxy for understanding the actual user experience of an application and as a result, they work great as key performance indicators (KPIâs).&lt;/p&gt;&lt;p&gt;But theyâre not enough. Every primary metric should have some level of supporting diagnostic metrics that help us understand &lt;i&gt;why&lt;/i&gt; our user metrics are performing like they are â so that we can quickly identify issues, bottlenecks, and areas of improvement.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2Un8yQdUf9DZw05gfS5WVs/187901b7e636cec35655ff954b1f38c4/2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1282\&quot; height=\&quot;312\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;While the industry has largely, and rightfully, moved on from Time to First Byte (TTFB) as a primary metric of focus, it still has value as a diagnostic metric. In fact, we analyzed our RUM data and found a very strong connection between &lt;a href=\&quot;https://developers.cloudflare.com/speed/observatory/test-results/#synthetic-tests-and-real-user-monitoring-metrics\&quot;&gt;&lt;u&gt;Time to First Byte and Largest Contentful Paint&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Googleâs recommended thresholds for Time to First Byte are:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Good: &amp;lt;= 800ms&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Needs Improvement: &amp;gt; 800ms and &amp;lt;= 1800ms&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Poor: &amp;gt; 1800ms&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Similarly, their official thresholds for Largest Contentful Paint are:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Good: &amp;lt;= 2500ms&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Needs Improvement &amp;gt; 2500ms and &amp;lt;= 4000ms&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Poor: &amp;gt; 4000ms&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Looking across over 9 billion events, we found that when compared to the average site, sites with a âpoorâ (&amp;gt;1800ms) TTFB are:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;70.1 percentage points less likely to have a âgoodâ LCP&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;21.9 percentage points more likely to have a âneeds improvementâ LCP&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;48.2 percentage points more likely to have a âpoorâ LCP&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;TTFB is an ill-defined blackbox, so weâre making a point to break that down into its various subparts so you can quickly pinpoint if the issue is with the connection establishment, the server response time, the network itself, and more. Weâll be working to break this down even further in the coming months as we expose the complete lifecycle of a request so youâre able to pinpoint &lt;i&gt;exactly&lt;/i&gt; where the bottlenecks lie.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;errors-cache-ratios\&quot;&gt;Errors &amp;amp; cache ratios&lt;/h2&gt;\n      &lt;a href=\&quot;#errors-cache-ratios\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Degradation in stability and performance are frequently directly connected to configuration changes or an increase in errors. Clear visibility into these characteristics can often cut right to the heart of the issue at hand, as well as point to opportunities for improvement of the overall efficiency and effectiveness of your application.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6j89m6ONeXh9v6XL35YJjn/1d65ac83476971fc42fccc2980bc79ff/3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1287\&quot; height=\&quot;359\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Observatory prominently surfaces cache hit ratio and error rates for &lt;i&gt;both&lt;/i&gt; the edge and origin. This compliments the backend telemetry nicely, and helps to further breakdown the backend metrics you are seeing to help pinpoint areas of improvement.&lt;/p&gt;&lt;p&gt;Take cache hit ratio for example. Intuitively, we know that when content is served from cache on an edge server, it should be faster than when the request has to go all the way back to the origin server. Based on our data, again, thatâs exactly what we see.&lt;/p&gt;&lt;p&gt;If we consider our Time To First Byte thresholds again (good is &amp;lt;= 800ms; needs improvement is &amp;gt; 800ms and less than 1800ms; poor is anything over 1800ms), when looking across 9 billion data points as collected by our RUM solution, we see that a whopping &lt;b&gt;91.7% of all pages served from Cloudflareâs cache have a âgoodâ TTFB compared to 79.7% when the request has to be served from the origin server&lt;/b&gt;.&lt;/p&gt;&lt;p&gt;In other words, optimizing origin performance (more on that in a bit) and moving more content to the edge are sure-fire ways to give you a much stronger performance baseline.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;accurate-and-detailed-synthetic-testing\&quot;&gt;Accurate and detailed synthetic testing&lt;/h2&gt;\n      &lt;a href=\&quot;#accurate-and-detailed-synthetic-testing\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;While real-user data is our source of truth, synthetic testing and monitoring is important as well. Because tests are run in a more controlled environment (test from this location, at this time, with this criteria, etc.), the resulting data is a lot less noisy and variable. In addition, because there is not a user involved and we donât have to worry about any observer effect, synthetic tests are able to grab a lot more information about the request and page lifecycle.&lt;/p&gt;&lt;p&gt;As a result, synthetic data tends to work very well for arming engineers with debugging information, as well as providing a cleaner set of data for comparing and contrasting results across different platforms, releases, and other situations.&lt;/p&gt;&lt;p&gt;Observatory provides two different types of synthetic tests.&lt;/p&gt;&lt;p&gt;The first synthetic test is a browser test. A browser test will load the requested page in a headless browser, run &lt;a href=\&quot;https://developer.chrome.com/docs/lighthouse\&quot;&gt;&lt;u&gt;Googleâs Lighthouse&lt;/u&gt;&lt;/a&gt; on it to report on key performance metrics, and provide some light suggestions for improvement.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3cvDSWqtBTMibgYysDgEoI/43cd0c684d3705fe021f588674a91cf6/4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;954\&quot; height=\&quot;905\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The second type of synthetic test Observatory provides is a network test. This is a brand new test type in Cloudflare, and is focused on giving you a better breakdown of the network and back-end performance of an endpoint.&lt;/p&gt;&lt;p&gt;Each network test will hit the provided endpoint for the test and record the wait time, server response time, connect time, SSL negotiation time, and total load time for the endpoint response. Because these tests are much more targeted, a single test in itself is not as valuable and can be prone to variation. That variation isnât necessarily a bad thingâin fact, variability in these results can actually give you a better understanding of the breadth of results when real users hit that same endpoint.&lt;/p&gt;&lt;p&gt;For that reason, network tests trigger a series of individual runs against the provided endpoint spread out over a short period of time. The data for each response is recorded, and then presented as a histogram on the test results page, letting you see not just a single datapoint, but the long and short-tail of each metric. This gives you a much more accurate representation of reality than what a single test run can provide.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3gCWSp0HCTd4iJ0rTKpEpk/a610e47596eedd6b8cedf73dfcde09ca/5.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1306\&quot; height=\&quot;936\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;You are also able to compare network tests in Observatory, by selecting two network tests that have been completed. Again, all the data points for each test will be provided in a histogram, where you can easily compare the results of the two.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6mG2bRanAGzltvkucJImue/11f56a4d3c3af4cd2a65dab834a0f0af/6.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1314\&quot; height=\&quot;961\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;We are working on improving both synthetic test types in Q4 2025, focusing on making them more powerful and diagnostic.&lt;/p&gt;&lt;p&gt;As we mentioned before, even at its best, synthetic data is an approximation of what is actually happening. Accuracy is critical. Inaccurate data can distract teams with variability and faulty measurements.&lt;/p&gt;&lt;p&gt;Itâs important that these tools are as accurate and true to the real world as possible. Itâs also important to us that we give back to the community, both because itâs the right thing to do, and because we believe the best way to have the highest level of confidence in the measurement tools and frameworks weâre using is the rigor and scrutiny that open-source provides.&lt;/p&gt;&lt;p&gt;For those reasons, weâll be working on open-sourcing many of the testing agents weâre using to power Observatory. Weâll share more on that soon, as well as more details about how weâve built each different testing tool, and why.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;doing-something-about-it-smart-suggestions\&quot;&gt;Doing something about it: Smart Suggestions&lt;/h2&gt;\n      &lt;a href=\&quot;#doing-something-about-it-smart-suggestions\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;People donât measure for the sake of having data and pretty charts. They measure because they want to be able to stay on top of the health of their application and find ways to improve it. Data is easy. Understanding what to do about the data youâre presented is both the hardest, and most important, part.&lt;/p&gt;&lt;p&gt;Monitoring without action is useless.&lt;/p&gt;&lt;p&gt;Weâre building Observatory to have a &lt;i&gt;relentless&lt;/i&gt; focus on actionability. Before any new metric is presented, we take some time to explore why that metric matters, when itâs something worth addressing, and what actions you should take if those metrics need improvement.&lt;/p&gt;&lt;p&gt;All of that leads us to our new Smart Suggestions. Wherever possible, we want to pair each metric with a set of opinionated, data-driven suggestions for how to make things better. We want to avoid vague hand-wavy advice and instead be prescriptive and specific and precise.&lt;/p&gt;&lt;p&gt;For example, letâs look at one particular recommendation we provide around improving Largest Contentful Paint.&lt;/p&gt;&lt;p&gt;Largest Contentful Paint is a core web vital metric that measures when the largest piece of content is displayed on the screen. That piece of content could be an image, video or text.&lt;/p&gt;&lt;p&gt;Much like TTFB, Largest Contentful Paint is a bit of a black box by itself. While it tells us how long it takes for that content to get on screen, there are a large number of potential bottlenecks that could be causing the delay. Perhaps the server response time was very slow. Or maybe there was something blocking the content from being displayed on the page. If the object was an image or video, perhaps the filesize was large and the resulting download was slow. LCP by itself doesnât give us that level of granularity, so itâs hard to give more than hand wavy guidance on how to address it.&lt;/p&gt;&lt;p&gt;Thankfully, just like we can break TTFB into subparts, we can break LCP into its subparts as well. Specifically we can look at:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Time to First Byte: how quickly the server responds to the request for HTML&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Resource Load Delay: How long it takes after TTFB for the browser to discover the LCP resource&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Resource Load Duration: How long it takes for the browser to download the LCP resource&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Render Delay: How long it takes the browser to render the content, after it has the resource in hand.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Breaking it down into these subparts, we can be much more diagnostic about what to do.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7qfKPLaTGTjJjhawTVoWAi/10ce739e376cabd7c468adfa280246dd/7.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1390\&quot; height=\&quot;595\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In the example above, our recommendation engine analyzes the site&amp;#39;s real-user data and notices that Resource Load Delay accounts for over 10% of total LCP time. As a result, thereâs a high likelihood that the resource triggering LCP is large and could potentially be compressed to reduce file size. So we make a recommendation to enable compression using &lt;a href=\&quot;https://developers.cloudflare.com/images/polish/\&quot;&gt;&lt;u&gt;Polish&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Weâre very excited about the impact these suggestions will have on helping everyone quickly zero in on meaningful solutions for improving performance and resiliency, without having to wade through mountains of data to get there. As we analyze data, weâll find more and more patterns of problems and the solutions they can map to. Expanding on our Smart Suggestions will be a constant and ongoing focus as we move forward, and we are working on adding much more content about those patterns and what we find in Q4.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;fixing-the-biggest-pain-point-smart-shield\&quot;&gt;Fixing the biggest pain point: Smart Shield&lt;/h2&gt;\n      &lt;a href=\&quot;#fixing-the-biggest-pain-point-smart-shield\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Observatory gives you unprecedented insight into your application&amp;#39;s health, but insights are only half the battle. The next challenge is acting on them, which brings us to another layer of complexity: protecting your origin. For many of our customers, proper management of origin routes and connections is one of the largest drivers of aggregate overall performance. As we mentioned before, we see a clear negative impact on user-facing performance metrics when we have to go back to the origin, and we want to make it as easy as possible for our customers to improve those experiences. Achieving this requires protecting against unnecessary load while ensuring only trusted traffic reaches your servers.&lt;/p&gt;&lt;p&gt;Today&amp;#39;s customers have powerful tools to protect their origins, but achieving basic use cases remains frustratingly complex:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Making applications faster&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Reducing origin load&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Understanding origin health issues&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Restricting IP address access to origin servers&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;These fundamental needs currently require navigating multiple APIs and dashboard settings. You shouldn&amp;#39;t need to become an expert in each feature â we should analyze your traffic patterns and provide clear, actionable solutions.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;smart-shield-the-future-of-origin-shielding\&quot;&gt;Smart Shield: the future of origin shielding&lt;/h2&gt;\n      &lt;a href=\&quot;#smart-shield-the-future-of-origin-shielding\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Smart Shield transforms origin protection from a complex, multi-tool challenge into a streamlined, intelligent solution that works on your behalf. Our unified API and UI combines all origin protection essentials â dynamic traffic acceleration, intelligent caching, health monitoring, and dedicated egress IPs â into one place that enables single-click configuration.&lt;/p&gt;&lt;p&gt;But we didn&amp;#39;t stop at simplification. Smart Shield integrates with &lt;b&gt;Observatory&lt;/b&gt; to provide both the &lt;b&gt;âwhatâ &lt;/b&gt;â identifying performance bottlenecks and health issues â and the &lt;b&gt;âhowâ &lt;/b&gt;â delivering capabilities that increase performance, availability, and security.&lt;/p&gt;&lt;p&gt;This creates a continuous feedback loop: Observatory identifies problems, Smart Shield provides solutions, and real-time analytics verify the impact. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2OI8AZzHo5kW4mesYsqM7Z/e08a5961deda6246a8d4fb906f2f5483/8.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1550\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6blpvetS2fS0CNAvu1lnp2/c16e1a330c2c260df4920f85b1650917/9.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1633\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;But what does this mean for you?Â &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Reduce total cost of ownership (TCO)&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Reduce the time-to-value (TTV) for performance, availability, and security issues pertaining to customer origins&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Enable new features without guesswork and validate effectiveness in the data&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Your time stays focused on building incredible user experiences, not becoming a configuration expert. We are excited to give you back time for your customers and your engineers, while paving the way for how you make sure your origin infrastructure is easily optimized to delight your customers.Â &lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;protecting-and-accelerating-origins-with-smart-connection-reuse\&quot;&gt;Protecting and accelerating origins with smart Connection Reuse&lt;/h2&gt;\n      &lt;a href=\&quot;#protecting-and-accelerating-origins-with-smart-connection-reuse\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Keeping your origins fast and stable is a big part of what we do at Cloudflare. When you experience a traffic surge, the last thing you want is for a flood of &lt;a href=\&quot;https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/\&quot;&gt;&lt;u&gt;TLS handshakes&lt;/u&gt;&lt;/a&gt; to knock your origin down, or for those new connections to stall your requests, leaving your users to wait for slow pages to load.&lt;/p&gt;&lt;p&gt;This is why weâve made significant changes to how Cloudflareâs network talks to your origins to dramatically improve the performance of our origin connections.Â &lt;/p&gt;&lt;p&gt;When Cloudflare makes a request to your origins, we make them from a subset of the available machines in every Cloudflare data center so that we can improve your connection reuse. Until now, this pool would be sized the same by default for every application within a data center, and changes to the sizing of the pool for a particular customer would need to be made manually. This often led to suboptimal connection reuse for our customers, as we might be making requests from way more machines than were actually needed, resulting in fewer warm connection pools than we otherwise could have had. This also caused issues at our data centers from time to time, as larger applications might have more traffic than the default pool size was capable of serving, resulting in production incidents where engineers are paged and had to manually increase the fanout factor for specific customers.&lt;/p&gt;&lt;p&gt;Now, these pool sizes are determined automatically and dynamically. By tracking domain-level traffic volume within a datacenter, we can automatically scale up and scale down the number of machines that serve traffic destined for customer origin servers for any particular customer, improving both the performance of customer websites and the reliability of our network. A massive, high-volume website with a considerable amount of API traffic will no longer be processed by the same number of machines as a smaller and more typical website. Our systems can respond to changes in customer traffic patterns within seconds, allowing us to quickly ramp up and respond to surges in origin traffic.&lt;/p&gt;&lt;p&gt;Thanks to these improvements, Cloudflare now uses over 30% fewer connections across the board to talk to origins. To put this into a more understandable perspective, this translates to saving approximately 402 years of handshake time every day across our global traffic, or 12,060 years of handshake time saved per month! This means just by proxying your traffic through Cloudflare, youâll see a 30% on average reduction in the amount of connections to your origin, keeping it more available while serving the same traffic volume and in turn lowering your egress fees. But, in many cases, the results observed can be far greater than 30%. For example, in one data center which is particularly heavy in API traffic, we saw a reduction in origin connections of ~60%!Â &lt;/p&gt;&lt;p&gt;Many donât realize that making more connections to an origin requires more compute and time for systems to create TCP and SSL handshakes. This takes time away from serving content requested by your end-users and can act as a hidden tax on your performance and overall to your application.&lt;b&gt; We are proud to reduce the Internet&amp;#39;s hidden tax &lt;/b&gt;by finding intelligent, innovative ways to reduce the amount of connections needed while supporting the same traffic volume.&lt;/p&gt;&lt;p&gt;Watch out for more updates to Smart Shield at the start of 2026 â weâre working on adding self-serve support for dedicated CDN egress IP addresses, along with significant performance, reliability, and resilience improvements!&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;charting-the-course-next-steps-for-observatory-smart-shield\&quot;&gt;Charting the course: next steps for Observatory &amp;amp; Smart Shield&lt;/h2&gt;\n      &lt;a href=\&quot;#charting-the-course-next-steps-for-observatory-smart-shield\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Weâre really excited to share these two products with everyone today. Smart Shield and Observatory combine to provide a powerful one-two punch of insight and easy remediation.&lt;/p&gt;&lt;p&gt;As we navigate the beta launch of Observatory, we know this is just the start.&lt;/p&gt;&lt;p&gt;Our vision for Observatory is to be the single source of truth for your applicationâs health. We know that making the right decisions requires robust, accurate data, and we want to arm our customers with the most comprehensive picture available.&lt;/p&gt;&lt;p&gt;In the coming months, we plan to continue driving forward with our goal of providing comprehensive data, backed by a clear path to action.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Deeper, more diagnostic data. &lt;/b&gt;Weâll continue to break down data silos, bringing in more metrics to make sure you have a truly comprehensive view of your applicationâs health. Weâll be focused on going deeper and being more diagnostic, breaking down every aspect of both the request and page lifecycle to give you more granular data.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;More paths to solutions. &lt;/b&gt;People donât measure for the sake of looking at data, they measure to solve problems. Weâre going to continue to expand our suggestions, arming you with more precise, data-driven solutions to a wider range of issues, letting you fix problems with a single click through Smart Shield and bringing a tighter feedback loop to validate the impact of your configuration updates.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Benchmarking against other products.&lt;/b&gt; Some of our customers split traffic between different CDNs due to regulatory or compliance requirements. Naturally, this brings up a whole series of questions about comparing the performance of the split traffic. In Observatory, you can compare these today, but we have a lot of things planned to make this even easier.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Try out &lt;a href=\&quot;https://dash.cloudflare.com/?to=/:account/:zone/speed/overview\&quot;&gt;&lt;u&gt;Observatory&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://www.cloudflare.com/application-services/products/smart-shield/\&quot;&gt;&lt;u&gt;Smart Shield&lt;/u&gt;&lt;/a&gt; yourself today. And if you have ideas or suggestions for making Observatory and Smart Shield better, &lt;a href=\&quot;https://docs.google.com/forms/d/e/1FAIpQLScRMJVR7SmkiloMjPciaTdLzvHzKE9v3L0c418l02a1sMRj_g/viewform?usp=sharing&amp;ouid=115763007691250405767\&quot;&gt;&lt;u&gt;weâre all ears and would love to talk&lt;/u&gt;&lt;/a&gt;!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-09-26T14:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-09-26T13:00:09.392Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5tw3v1F3vOU0YXkH4MzLD5/7d1d39cf4bdc39eb522bfbe18dd512aa/0.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;1OAcGRrbAS8T2hKb2tqB7N&quot;],&quot;name&quot;:[0,&quot;Speed&quot;],&quot;slug&quot;:[0,&quot;speed&quot;]}],[0,{&quot;id&quot;:[0,&quot;4gN0ARax0fHxjtZL07THOe&quot;],&quot;name&quot;:[0,&quot;Performance&quot;],&quot;slug&quot;:[0,&quot;performance&quot;]}],[0,{&quot;id&quot;:[0,&quot;1Cv5JjXzKWKEA10JdYbXu1&quot;],&quot;name&quot;:[0,&quot;Birthday Week&quot;],&quot;slug&quot;:[0,&quot;birthday-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;7sWsPeqjyqJtFrjqs8jgYQ&quot;],&quot;name&quot;:[0,&quot;Aegis&quot;],&quot;slug&quot;:[0,&quot;aegis&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Tim Kadlec&quot;],&quot;slug&quot;:[0,&quot;tim-kadlec&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/22oYvFergGmn2051FonJTn/4b724458679059390ce2d8d698b35c1a/Screenshot_2024-10-22_at_12.56.36a%C3%8C__%C3%82_PM.png&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Brian Batraski&quot;],&quot;slug&quot;:[0,&quot;brian&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/73UTTrB82BqzOm0zV18vPn/33a3cc72452c29174cd774645793c2ef/Brian_Batraski.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Noah Maxwell Kennedy&quot;],&quot;slug&quot;:[0,&quot;noah&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3O2rGDZFRnJK4ERkQKcWjj/d8899fe5f904a0caa05f15539b652b8e/noah.jpg&quot;],&quot;location&quot;:[0,&quot;Milwaukee, Wisconsin&quot;],&quot;website&quot;:[0,&quot;https://github.com/Noah-Kennedy&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Today, weâre announcing two enhancements to our Application Performance suite. Observatory and Smart Shield allow you to see how the world sees your website, and make it faster with one click. Available inside the Cloudflare Dashboard today!&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/introducing-observatory-and-smart-shield&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Introducing Observatory and Smart Shield â see how the world sees your website, and make it faster in one click&quot;],&quot;description&quot;:[0,&quot;Today, weâre announcing two enhancements to our Application Performance suite. Observatory and Smart Shield allow you to see how the world sees your website, and make it faster with one click. Available inside the Cloudflare Dashboard today!&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/66OPl3d5FYxQr2DTCl1shO/e514feae3fb85dc2386e510eee96fd31/image1.png&quot;]}],&quot;publicly_index&quot;:[0,true]}]]],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}],&quot;localesAvailable&quot;:[1,[]],&quot;footerBlurb&quot;:[0,&quot;Cloudflare&#39;s connectivity cloud protects &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/network-services/&#39; rel=&#39;noreferrer&#39;&gt;entire corporate networks&lt;/a&gt;, helps customers build &lt;a target=&#39;_blank&#39; href=&#39;https://workers.cloudflare.com/&#39; rel=&#39;noreferrer&#39;&gt;Internet-scale applications efficiently&lt;/a&gt;, accelerates any &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/performance/accelerate-internet-applications/&#39; rel=&#39;noreferrer&#39;&gt;website or Internet application&lt;/a&gt;, &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/ddos/&#39; rel=&#39;noreferrer&#39;&gt;wards off DDoS attacks&lt;/a&gt;, keeps &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/application-security/&#39; rel=&#39;noreferrer&#39;&gt;hackers at bay&lt;/a&gt;, and can help you on &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/products/zero-trust/&#39; rel=&#39;noreferrer&#39;&gt;your journey to Zero Trust&lt;/a&gt;.&lt;br/&gt;&lt;br/&gt;Visit &lt;a target=&#39;_blank&#39; href=&#39;https://one.one.one.one/&#39; rel=&#39;noreferrer&#39;&gt;1.1.1.1&lt;/a&gt; from any device to get started with our free app that makes your Internet faster and safer.&lt;br/&gt;&lt;br/&gt;To learn more about our mission to help build a better Internet, &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/learning/what-is-cloudflare/&#39; rel=&#39;noreferrer&#39;&gt;start here&lt;/a&gt;. If you&amp;apos;re looking for a new career direction, check out &lt;a target=&#39;_blank&#39; href=&#39;http://www.cloudflare.com/careers&#39; rel=&#39;noreferrer&#39;&gt;our open positions&lt;/a&gt;.&quot;]}" ssr client="load" opts="{&quot;name&quot;:&quot;Post&quot;,&quot;value&quot;:true}" await-children><main id="post" class="flex flex-row flex-wrap items-center justify-center pt2 pt4-l"><article class="post-full mw-100 ph3 ph0-l fs-20px"><h1 class="f6 f7-l fw4 gray1 pt1 pt3-l mb1">Safe in the sandbox: security hardening for Cloudflare Workers</h1><p class="f3 fw5 gray5 db di-l mt2">2025-09-25</p><ul class="author-lists flex pl0 mt4"><li class="list flex items-center pr2 mb1-ns"><a href="/author/erik-corry/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6gfuhEABjcBkfIQUrIjdkD/7233fd2150ea5d3107e6e8e725405ac2/Erik_Corry" alt="Erik Corry" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/erik-corry/" class="fw4 f3 no-underline black mr3">Erik Corry</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/ketan-gupta/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4HNGL8tqmoWI8yZJEEynzY/4dc4778dc00d47cc7da853c61c224fd7/Ketan_Gupta.webp" alt="Ketan Gupta" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/ketan-gupta/" class="fw4 f3 no-underline black mr3">Ketan Gupta</a></div></li></ul><section class="post-full-content"><div class="mb2 gray5">13 min read</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7sgyEKfivxzLgwks0Yjraq/90d3c84bbff05e49a5b2c3564ab7bec7/Hero.png" alt=""/><div class="post-content lh-copy gray1"><p>As a <a href="https://www.cloudflare.com/learning/serverless/what-is-serverless/"><u>serverless</u></a> cloud provider, we run your code on our globally distributed infrastructure. Being able to run customer code on our network means that anyone can take advantage of our global presence and low latency. Workers isnât just efficient though, we also make it simple for our users. In short: <a href="https://workers.cloudflare.com/"><u>You write code. We handle the rest</u></a>.</p><p>Part of &#39;handling the rest&#39; is making Workers as secure as possible. We have previously written about our <a href="https://blog.cloudflare.com/mitigating-spectre-and-other-security-threats-the-cloudflare-workers-security-model/"><u>security architecture</u></a>. Making Workers secure is an interesting problem because the whole point of Workers is that we are running third party code on our hardware. This is one of the hardest security problems there is: any attacker has the full power available of a programming language running on the victim&#39;s system when they are crafting their attacks.</p><p>This is why we are constantly updating and improving the Workers Runtime to take advantage of the latest improvements in both hardware and software. This post shares some of the latest work we have been doing to keep Workers secure.</p><p>Some background first: <a href="https://www.cloudflare.com/developer-platform/products/workers/"><u>Workers</u></a> is built around the <a href="https://v8.dev/"><u>V8</u></a> JavaScript runtime, originally developed for Chromium-based browsers like Chrome. This gives us a head start, because V8 was forged in an adversarial environment, where it has always been under intense attack and <a href="https://github.blog/security/vulnerability-research/getting-rce-in-chrome-with-incorrect-side-effect-in-the-jit-compiler/"><u>scrutiny</u></a>. Like Workers, Chromium is built to run adversarial code safely. That&#39;s why V8 is constantly being tested against the best fuzzers and sanitizers, and over the years, it has been hardened with new technologies like <a href="https://v8.dev/blog/oilpan-library"><u>Oilpan/cppgc</u></a> and improved static analysis.</p><p>We use V8 in a slightly different way, though, so we will be describing in this post how we have been making some changes to V8 to improve security in our use case.</p>
    <div class="flex anchor relative">
      <h2 id="hardware-assisted-security-improvements-from-memory-protection-keys">Hardware-assisted security improvements from Memory Protection Keys</h2>
      <a href="#hardware-assisted-security-improvements-from-memory-protection-keys" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>Modern CPUs from Intel, AMD, and ARM have support for <a href="https://man7.org/linux/man-pages/man7/pkeys.7.html"><u>memory protection keys</u></a>, sometimes called <i>PKU</i>, Protection Keys for Userspace. This is a great security feature which increases the power of virtual memory and memory protection.</p><p>Traditionally, the memory protection features of the CPU in your PC or phone were mainly used to protect the kernel and to protect different processes from each other. Within each process, all threads had access to the same memory. Memory protection keys allow us to prevent specific threads from accessing memory regions they shouldn&#39;t have access to.</p><p>V8 already <a href="https://issues.chromium.org/issues/41480375"><u>uses memory protection keys</u></a> for the <a href="https://en.wikipedia.org/wiki/Just-in-time_compilation"><u>JIT compilers</u></a>. The JIT compilers for a language like JavaScript generate optimized, specialized versions of your code as it runs. Typically, the compiler is running on its own thread, and needs to be able to write data to the code area in order to install its optimized code. However, the compiler thread doesn&#39;t need to be able to run this code. The regular execution thread, on the other hand, needs to be able to run, but not modify, the optimized code. Memory protection keys offer a way to give each thread the permissions it needs, but <a href="https://en.wikipedia.org/wiki/W%5EX"><u>no more</u></a>. And the V8 team in the Chromium project certainly aren&#39;t standing still. They describe some of their future plans for memory protection keys <a href="https://docs.google.com/document/d/1l3urJdk1M3JCLpT9HDvFQKOxuKxwINcXoYoFuKkfKcc/edit?tab=t.0#heading=h.gpz70vgxo7uc"><u>here</u></a>.</p><p>In Workers, we have some different requirements than Chromium. <a href="https://developers.cloudflare.com/workers/reference/security-model/"><u>The security architecture for Workers</u></a> uses V8 isolates to separate different scripts that are running on our servers. (In addition, we have <a href="https://blog.cloudflare.com/spectre-research-with-tu-graz/"><u>extra mitigations</u></a> to harden the system against <a href="https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)"><u>Spectre</u></a> attacks). If V8 is working as intended, this should be enough, but we believe in <i>defense in depth</i>: multiple, overlapping layers of security controls.</p><p>That&#39;s why we have deployed internal modifications to V8 to use memory protection keys to isolate the isolates from each other. There are up to 15 different keys available on a modern x64 CPU and a few are used for other purposes in V8, so we have about 12 to work with. We give each isolate a random key which is used to protect its V8 <i>heap data</i>, the memory area containing the JavaScript objects a script creates as it runs. This means security bugs that might previously have allowed an attacker to read data from a different isolate would now hit a hardware trap in 92% of cases. (Assuming 12 keys, 92% is about 11/12.)</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4cHaaZrAhQf759og04S63G/59ff1974dc878ec8ad7d40f1f079be37/image9.png" alt="" class="kg-image" width="1466" height="606" loading="lazy"/>
          </figure><p>The illustration shows an attacker attempting to read from a different isolate. Most of the time this is detected by the mismatched memory protection key, which kills their script and notifies us, so we can investigate and remediate. The red arrow represents the case where the attacker got lucky by hitting an isolate with the same memory protection key, represented by the isolates having the same colors.</p><p>However, we can further improve on a 92% protection rate. In the last part of this blog post we&#39;ll explain how we can lift that to 100% for a particular common scenario. But first, let&#39;s look at a software hardening feature in V8 that we are taking advantage of.</p>
    <div class="flex anchor relative">
      <h2 id="the-v8-sandbox-a-software-based-security-boundary">The V8 sandbox, a software-based security boundary</h2>
      <a href="#the-v8-sandbox-a-software-based-security-boundary" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>Over the past few years, V8 has been gaining another defense in depth feature: the V8 sandbox. (Not to be confused with the <a href="https://blog.cloudflare.com/sandboxing-in-linux-with-zero-lines-of-code/"><u>layer 2 sandbox</u></a> which Workers have been using since the beginning.) The V8 sandbox has been a multi-year project that has been gaining <a href="https://v8.dev/blog/sandbox"><u>maturity</u></a> for a while. The sandbox project stems from the observation that many V8 security vulnerabilities start by corrupting objects in the V8 heap memory. Attackers then leverage this corruption to reach other parts of the process, giving them the opportunity to escalate and gain more access to the victim&#39;s browser, or even the entire system.</p><p>V8&#39;s sandbox project is an ambitious software security mitigation that aims to thwart that escalation: to make it impossible for the attacker to progress from a corruption on the V8 heap to a compromise of the rest of the process. This means, among other things, removing all pointers from the heap. But first, let&#39;s explain in as simple terms as possible, what a memory corruption attack is.</p>
    <div class="flex anchor relative">
      <h3 id="memory-corruption-attacks">Memory corruption attacks</h3>
      <a href="#memory-corruption-attacks" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>A memory corruption attack tricks a program into misusing its own memory. Computer memory is just a store of integers, where each integer is stored in a location. The locations each have an <i>address</i>, which is also just a number. Programs interpret the data in these locations in different ways, such as text, pixels, or <i>pointers</i>. Pointers are addresses that identify a different memory location, so they act as a sort of arrow that points to some other piece of data.</p><p>Here&#39;s a concrete example, which uses a buffer overflow. This is a form of attack that was historically common and relatively simple to understand: Imagine a program has a small buffer (like a 16-character text field) followed immediately by an 8-byte pointer to some ordinary data. An attacker might send the program a 24-character string, causing a &quot;buffer overflow.&quot; Because of a vulnerability in the program, the first 16 characters fill the intended buffer, but the remaining 8 characters spill over and overwrite the adjacent pointer.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5VlcKOYtfRHwWZVDb6GOPm/517ae1987c89273e1f33eb6ca11d752d/image5.png" alt="See below for how such an attack would now be thwarted." class="kg-image" width="1999" height="831" loading="lazy"/>
          </figure><p><sup><i>See below for how such an attack would now be thwarted.</i></sup></p><p>Now the pointer has been redirected to point at sensitive data of the attacker&#39;s choosing, rather than the normal data it was originally meant to access. When the program tries to use what it believes is its normal pointer, it&#39;s actually accessing sensitive data chosen by the attacker.</p><p>This type of attack works in steps: first create a small confusion (like the buffer overflow), then use that confusion to create bigger problems, eventually gaining access to data or capabilities the attacker shouldn&#39;t have.Â  The attacker can eventually use the misdirection to either steal information or plant malicious data that the program will treat as legitimate.</p><p>This was a somewhat abstract description of memory corruption attacks using a buffer overflow, one of the simpler techniques. For some much more detailed and recent examples, see <a href="https://googleprojectzero.blogspot.com/2015/06/what-is-good-memory-corruption.html"><u>this description from Google</u></a>, or this <a href="https://medium.com/@INTfinitySG/miscellaneous-series-2-a-script-kiddie-diary-in-v8-exploit-research-part-1-5b0bab211f5a"><u>breakdown of a V8 vulnerability</u></a>.</p>
    <div class="flex anchor relative">
      <h3 id="compressed-pointers-in-v8">Compressed pointers in V8</h3>
      <a href="#compressed-pointers-in-v8" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>Many attacks are based on corrupting pointers, so ideally we would remove all pointers from the memory of the program.Â  Since an object-oriented language&#39;s heap is absolutely full of pointers, that would seem, on its face, to be a hopeless task, but it is enabled by an earlier development. Starting in 2020, V8 has offered the option of saving memory by using <a href="https://v8.dev/blog/pointer-compression"><u>compressed pointers</u></a>. This means that, on a 64-bit system, the heap uses only 32 bit offsets, relative to a base address. This limits the total heap to maximally 4 GiB, a limitation that is acceptable for a browser, and also fine for individual scripts running in a V8 isolate on Cloudflare Workers.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/sO5ByQzR62UcxZiaxwcaq/2f2f0c04af57bb492e9ecaa321935112/image1.png" alt="An artificial object with various fields, showing how the layout differs in a compressed vs. an uncompressed heap. The boxes are 64 bits wide." class="kg-image" width="1999" height="453" loading="lazy"/>
          </figure><p><sup><i>An artificial object with various fields, showing how the layout differs in a compressed vs. an uncompressed heap. The boxes are 64 bits wide.</i></sup></p><p>If the whole of the heap is in a single 4 GiB area then the first 32 bits of all pointers will be the same, and we don&#39;t need to store them in every pointer field in every object. In the diagram we can see that the object pointers all start with 0x12345678, which is therefore redundant and doesn&#39;t need to be stored. This means that object pointer fields and integer fields can be reduced from 64 to 32 bits.</p><p>We still need 64 bit fields for some fields like double precision floats and for the sandbox offsets of buffers, which are typically used by the script for input and output data. See below for details.</p><p>Integers in an uncompressed heap are stored in the high 32 bits of a 64 bit field. In the compressed heap, the top 31 bits of a 32 bit field are used. In both cases the lowest bit is set to 0 to indicate integers (as opposed to pointers or offsets).</p><p>Conceptually, we have two methods for compressing and decompressing, using a base address that is divisible by 4 GiB:</p>
            <pre class="language-C++"><code class="language-C++">// Decompress a 32 bit offset to a 64 bit pointer by adding a base address.
void* Decompress(uint32_t offset) { return base + offset; }
// Compress a 64 bit pointer to a 32 bit offset by discarding the high bits.
uint32_t Compress(void* pointer) { return (intptr_t)pointer &amp; 0xffffffff; }</pre></code>
            <p>This pointer compression feature, originally primarily designed to save memory, can be used as the basis of a sandbox.</p>
    <div class="flex anchor relative">
      <h3 id="from-compressed-pointers-to-the-sandbox">From compressed pointers to the sandbox</h3>
      <a href="#from-compressed-pointers-to-the-sandbox" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>The biggest 32-bit unsigned integer is about 4 billion, so the <code>Decompress()</code> function cannot generate any pointer that is outside the range [base, base + 4Â GiB]. You could say the pointers are trapped in this area, so it is sometimes called the <i>pointer cage</i>. V8 can reserve 4 GiB of virtual address space for the pointer cage so that only V8 objects appear in this range. By eliminating <i>all</i> pointers from this range, and following some other strict rules, V8 can contain any memory corruption by an attacker to this cage. Even if an attacker corrupts a 32 bit offset within the cage, it is still only a 32 bit offset and can only be used to create new pointers that are still trapped within the pointer cage.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3r5H81eDvHgaPIBFw5gG6B/65ffa220f9141a81af893183a09321ac/image7.png" alt="The buffer overflow attack from earlier no longer works because only the attacker's own data is available in the pointer cage." class="kg-image" width="1999" height="861" loading="lazy"/>
          </figure><p><sup><i>The buffer overflow attack from earlier no longer works because only the attacker&#39;s own data is available in the pointer cage.</i></sup></p><p>To construct the sandbox, we take the 4 GiB pointer cage and add another 4 GiB for buffers and other data structures to make the 8 GiB sandbox. This is why the buffer offsets above are 33 bits, so they can reach buffers in the second half of the sandbox (40 bits in Chromium with larger sandboxes). V8 stores these buffer offsets in the high 33 bits and shifts down by 31 bits before use, in case an attacker corrupted the low bits.</p><p>Cloudflare Workers have made use of compressed pointers in V8 for a while, but for us to get the full power of the sandbox we had to make some changes. Until recently, all isolates in a process had to be one single sandbox if you were using the sandboxed configuration of V8. This would have limited the total size of all V8 heaps to be less than 4 GiB, far too little for our architecture, which relies on serving 1000s of scripts at once.</p><p>That&#39;s why we commissioned <a href="https://www.igalia.com/"><u>Igalia</u></a> to add<a href="https://dbezhetskov.dev/multi-sandboxes/"><u> isolate groups</u></a> to V8. Each isolate group has its own sandbox and can have 1 or more isolates within it. Building on this change we have been able to start using the sandbox, eliminating a whole class of potential security issues in one stroke. Although we can place multiple isolates in the same sandbox, we are currently only putting a single isolate in each sandbox.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3jwaGI8xIAC6755vw2BWfE/d8b0cd5b36dbe8b5e628c62ef7f3d474/image2.png" alt="The layout of the sandbox. In the sandbox there can be more than one isolate, but all their heap pages must be in the pointer cage: the first 4 GiB of the sandbox. Instead of pointers between the objects, we use 32 bit offsets. The offsets for the buffers are 33 bits, so they can reach the whole sandbox, but not outside it." class="kg-image" width="1094" height="774" loading="lazy"/>
          </figure><p><sup><i>The layout of the sandbox. In the sandbox there can be more than one isolate, but all their heap pages must be in the pointer cage: the first 4 GiB of the sandbox. Instead of pointers between the objects, we use 32 bit offsets. The offsets for the buffers are 33 bits, so they can reach the whole sandbox, but not outside it.</i></sup></p>
    <div class="flex anchor relative">
      <h2 id="virtual-memory-isnt-infinite-theres-a-lot-going-on-in-a-linux-process">Virtual memory isn&#39;t infinite, there&#39;s a lot going on in a Linux process</h2>
      <a href="#virtual-memory-isnt-infinite-theres-a-lot-going-on-in-a-linux-process" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>At this point, we were not quite done, though. Each sandbox reserves 8 GiB of space in the virtual memory map of the process, and it must be 4 GiB aligned <a href="https://v8.dev/blog/pointer-compression"><u>for efficiency</u></a>. It uses much less physical memory, but the sandbox mechanism requires this much virtual space for its security properties. This presents us with a problem, since a Linux process &#39;only&#39; has 128 TiB of virtual address space in a 4-level page table (another 128 TiB are reserved for the kernel, not available to user space).</p><p>At Cloudflare, we want to run Workers as efficiently as possible to keep costs and prices down, and to offer a generous free tier. That means that on each machine we have so many isolates running (one per sandbox) that it becomes hard to place them all in a 128 TiB space.</p><p>Knowing this, we have to place the sandboxes carefully in memory. Unfortunately, the Linux syscall, <a href="https://man7.org/linux/man-pages/man2/mmap.2.html"><u>mmap</u></a>, does not allow us to specify the alignment of an allocation unless you can guess a free location to request. To get an 8 GiB area that is 4 GiB aligned, we have to ask for 12 GiB, then find the aligned 8 GiB area that must exist within that, and return the unused (hatched) edges to the OS:</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7Dqey3y5ZsPugD3pyRpQUY/cdadceeb96dbb01a2062dc98c7c554bc/image6.png" alt="" class="kg-image" width="1999" height="266" loading="lazy"/>
          </figure><p>If we allow the Linux kernel to place sandboxes randomly, we end up with a layout like this with gaps. Especially after running for a while, there can be both 8 GiB and 4 GiB gaps between sandboxes:</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6oaIPZnjaJrLYoFK6v03oI/6c53895f1151d70f71511d8cdfa35f00/image3.png" alt="" class="kg-image" width="1999" height="417" loading="lazy"/>
          </figure><p>Sadly, because of our 12 GiB alignment trick, we can&#39;t even make use of the 8 GiB gaps. If we ask the OS for 12 GiB, it will never give us a gap like the 8 GiB gap between the green and blue sandboxes above. In addition, there are a host of other things going on in the virtual address space of a Linux process: the malloc implementation may want to grab pages at particular addresses, the executable and libraries are mapped at a random location by ASLR, and V8 has allocations outside the sandbox.</p><p>The latest generation of x64 CPUs supports a much bigger address space, which solves both problems, and Linux kernels are able to make use of the extra bits with <a href="https://en.wikipedia.org/wiki/Intel_5-level_paging"><u>five level page tables</u></a>. A process has to <a href="https://lwn.net/Articles/717293/"><u>opt into this</u></a>, which is done by a single mmap call suggesting an address outside the 47 bit area. The reason this needs an opt-in is that some programs can&#39;t cope with such high addresses. Curiously, V8 is one of them.</p><p>This isn&#39;t hard to fix in V8, but not all of our fleet has been upgraded yet to have the necessary hardware. So for now, we need a solution that works with the existing hardware. We have modified V8 to be able to grab huge memory areas and then use <a href="https://man7.org/linux/man-pages/man2/mprotect.2.html"><u>mprotect syscalls</u></a> to create tightly packed 8 GiB spaces for sandboxes, bypassing the inflexible mmap API.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7kPgAWxoR7nDsZHUOBsNMp/15e7b2a1aac827acfce8b0d614e44cde/image8.png" alt="" class="kg-image" width="1999" height="612" loading="lazy"/>
          </figure>
    <div class="flex anchor relative">
      <h2 id="putting-it-all-together">Putting it all together</h2>
      <a href="#putting-it-all-together" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>Taking control of the sandbox placement like this actually gives us a security benefit, but first we need to describe a particular threat model.</p><p>We assume for the purposes of this threat model that an attacker has an arbitrary way to corrupt data within the sandbox. This is historically the first step in many V8 exploits. So much so that there is a <a href="https://bughunters.google.com/about/rules/chrome-friends/5745167867576320/chrome-vulnerability-reward-program-rules#v8-sandbox-bypass-rewards"><u>special tier</u></a> in Google&#39;s V8 bug bounty program where you may <i>assume</i> you have this ability to corrupt memory, and they will pay out if you can leverage that to a more serious exploit.</p><p>However, we assume that the attacker does not have the ability to execute arbitrary machine code. If they did, they could <a href="https://www.usenix.org/system/files/sec20fall_connor_prepub.pdf"><u>disable memory protection keys</u></a>. Having access to the in-sandbox memory only gives the attacker access to their own data. So the attacker must attempt to escalate, by corrupting data inside the sandbox to access data outside the sandbox.</p><p>You will recall that the compressed, sandboxed V8 heap only contains 32 bit offsets. Therefore, no corruption there can reach outside the pointer cage. But there are also arrays in the sandbox â vectors of data with a given size that can be accessed with an index. In our threat model, the attacker can modify the sizes recorded for those arrays and the indexes used to access elements in the arrays. That means an attacker could potentially turn an array in the sandbox into a tool for accessing memory incorrectly. For this reason, the V8 sandbox normally has <i>guard regions</i> around it: These are 32 GiB virtual address ranges that have no virtual-to-physical address mappings. This helps guard against the worst case scenario: Indexing an array where the elements are 8 bytes in size (e.g. an array of double precision floats) using a maximal 32 bit index. Such an access could reach a distance of up to 32 GiB outside the sandbox: 8 times the maximal 32 bit index of four billion.</p><p>We want such accesses to trigger an alarm, rather than letting an attacker access nearby memory.Â  This happens automatically with guard regions, but we don&#39;t have space for conventional 32 GiB guard regions around every sandbox.</p><p>Instead of using conventional guard regions, we can make use of memory protection keys. By carefully controlling which isolate group uses which key, we can ensure that no sandbox within 32 GiB has the same protection key. Essentially, the sandboxes are acting as each other&#39;s guard regions, protected by memory protection keys. Now we only need a wasted 32 GiB guard region at the start and end of the huge packed sandbox areas.
</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/53MPs8P84ayqEiTXh7gV5O/88104f74f1d51dbdda8d987e1c7df3aa/image10.png" alt="" class="kg-image" width="1999" height="493" loading="lazy"/>
          </figure><p>With the new sandbox layout, we use strictly rotating memory protection keys. Because we are not using randomly chosen memory protection keys, for this threat model the 92% problem described above disappears. Any in-sandbox security issue is unable to reach a sandbox with the same memory protection key. In the diagram, we show that there is no memory within 32 GiB of a given sandbox that has the same memory protection key. Any attempt to access memory within 32 GiB of a sandbox will trigger an alarm, just like it would with unmapped guard regions.</p>
    <div class="flex anchor relative">
      <h2 id="the-future">The future</h2>
      <a href="#the-future" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>In a way, this whole blog post is about things our customers <i>don&#39;t</i> need to do. They don&#39;t need to upgrade their server software to get the latest patches, we do that for them. They don&#39;t need to worry whether they are using the most secure or efficient configuration. So there&#39;s no call to action here, except perhaps to sleep easy.</p><p>However, if you find work like this interesting, and especially if you have experience with the implementation of V8 or similar language runtimes, then you should consider coming to work for us. <a href="https://job-boards.greenhouse.io/cloudflare/jobs/6718312?gh_jid=6718312"><u>We are recruiting both in the US and in Europe</u></a>. It&#39;s a great place to work, and Cloudflare is going from strength to strength.</p></div></section><section class="post-full-content flex flex-row flex-wrap mw7 center mb4"><div class="post-content lh-copy w-100 gray1 bt b--gray8 pt4">Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href="https://www.cloudflare.com/careers" rel='noreferrer'>our open positions</a>.</div></section><astro-slot> <!--[if astro]>server-island-start<![endif]--><link rel="preload" as="fetch" href="/_server-islands/SocialLinks?e=default&p=&s=%7B%22default%22%3A%22+%3Csvg+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+viewBox%3D%5C%220+0+232px+52px%5C%22+fill%3D%5C%22none%5C%22+xmlns%3D%5C%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%5C%22%3E+%3Cdefs%3E+%3CclipPath+id%3D%5C%22skelly-clip%5C%22%3E+%3Crect+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+x%3D%5C%220%5C%22+y%3D%5C%220%5C%22+rx%3D%5C%228%5C%22%3E%3C%2Frect%3E+%3C%2FclipPath%3E+%3ClinearGradient+id%3D%5C%22gradient%5C%22%3E+%3Cstop+offset%3D%5C%220%25%5C%22+stop-color%3D%5C%22%23F6F6F6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%22-2%3B+-2%3B+1%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3Cstop+offset%3D%5C%2250%25%5C%22+stop-color%3D%5C%22%23E8E6E6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%22-1%3B+-1%3B+2%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3Cstop+offset%3D%5C%22100%25%5C%22+stop-color%3D%5C%22%23F6F6F6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%220%3B+0%3B+3%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3C%2FlinearGradient%3E+%3C%2Fdefs%3E+%3Crect+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+fill%3D%5C%22url%28%23gradient%29%5C%22+x%3D%5C%220%5C%22+y%3D%5C%220%5C%22+clip-path%3D%5C%22url%28%23skelly-clip%29%5C%22%3E%3C%2Frect%3E+%3C%2Fsvg%3E+%22%7D" crossorigin="anonymous"><script type="module" data-astro-rerun data-island-id="0e3e3cdb-5f4c-4fb4-9824-8b5bda9a7b38">let response = await fetch('/_server-islands/SocialLinks?e=default&p=&s=%7B%22default%22%3A%22+%3Csvg+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+viewBox%3D%5C%220+0+232px+52px%5C%22+fill%3D%5C%22none%5C%22+xmlns%3D%5C%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%5C%22%3E+%3Cdefs%3E+%3CclipPath+id%3D%5C%22skelly-clip%5C%22%3E+%3Crect+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+x%3D%5C%220%5C%22+y%3D%5C%220%5C%22+rx%3D%5C%228%5C%22%3E%3C%2Frect%3E+%3C%2FclipPath%3E+%3ClinearGradient+id%3D%5C%22gradient%5C%22%3E+%3Cstop+offset%3D%5C%220%25%5C%22+stop-color%3D%5C%22%23F6F6F6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%22-2%3B+-2%3B+1%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3Cstop+offset%3D%5C%2250%25%5C%22+stop-color%3D%5C%22%23E8E6E6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%22-1%3B+-1%3B+2%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3Cstop+offset%3D%5C%22100%25%5C%22+stop-color%3D%5C%22%23F6F6F6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%220%3B+0%3B+3%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3C%2FlinearGradient%3E+%3C%2Fdefs%3E+%3Crect+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+fill%3D%5C%22url%28%23gradient%29%5C%22+x%3D%5C%220%5C%22+y%3D%5C%220%5C%22+clip-path%3D%5C%22url%28%23skelly-clip%29%5C%22%3E%3C%2Frect%3E+%3C%2Fsvg%3E+%22%7D');
replaceServerIsland('0e3e3cdb-5f4c-4fb4-9824-8b5bda9a7b38', response);</script> </astro-slot><iframe sandbox="allow-scripts allow-popups allow-popups-to-escape-sandbox" title="cloudflare-tv-live-link" id="cloudflare-tv-embed" src="https://cloudflare.tv/embed/live.html" loading="lazy"></iframe><a href="/tag/workers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Cloudflare Workers</a><a href="/tag/birthday-week/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Birthday Week</a><a href="/tag/attacks/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Attacks</a><a href="/tag/engineering/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Engineering</a><a href="/tag/linux/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Linux</a><a href="/tag/malicious-javascript/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Malicious JavaScript</a><a href="/tag/security/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Security</a><a href="/tag/vulnerabilities/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Vulnerabilities</a></article></main><div class="ph3 pv3"><div class=" flex flex-row flex-wrap mw7 center"><div class="w-100 bt b--gray8"><p class="black fw5 f4 mt4">Follow on X</p></div><div class="w-100 pb2"><span>Cloudflare</span><span class="ph2">|</span><a href="https://x.com/@cloudflare" class="no-underline">@cloudflare</a></div></div></div><div data-testid="related-posts-section" class="pv4 ph3 ph0-l flex flex-row flex-wrap mw7 center"><div class="w-100 bt b--gray8"><p class="orange fw5 f4 mt4 ttu">Related posts</p></div><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-09-26T14:00+00:00">September 26, 2025  2:00 PM</p><a data-testid="related-posts-article-title" href="/20-percent-internet-upgrade/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Cloudflare just got faster and more secure, powered by Rust</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">Weâve replaced the original core system in Cloudflare with a new modular Rust-based proxy, replacing NGINX. <!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/richard/" class="fw5 f2 black no-underline">Richard Boulton</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/steve-goldsmith/" class="fw5 f2 black no-underline">Steve Goldsmith</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/maurizio-abba/" class="fw5 f2 black no-underline">Maurizio Abba</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/matthew-bullock/" class="fw5 f2 black no-underline">Matthew Bullock</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/birthday-week/" class="no-underline f1 fw2 blue3 underline-hover">Birthday Week<!-- -->,</a>Â </span><span><a href="/tag/rust/" class="no-underline f1 fw2 blue3 underline-hover">Rust<!-- -->,</a>Â </span><span><a href="/tag/nginx/" class="no-underline f1 fw2 blue3 underline-hover">NGINX<!-- -->,</a>Â </span><span><a href="/tag/deep-dive/" class="no-underline f1 fw2 blue3 underline-hover">Deep Dive<!-- -->,</a>Â </span><span><a href="/tag/engineering/" class="no-underline f1 fw2 blue3 underline-hover">Engineering</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-09-26T14:00+00:00">September 26, 2025  2:00 PM</p><a data-testid="related-posts-article-title" href="/an-ai-index-for-all-our-customers/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">An AI Index for all our customers</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">Cloudflare will soon automatically create an AI-optimized search index for your domain, and expose a set of ready-to-use standard APIs and tools including an MCP server, LLMs.txt, and a search API.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/celso/" class="fw5 f2 black no-underline">Celso Martinho</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/anni/" class="fw5 f2 black no-underline">Anni Wang</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/ai/" class="no-underline f1 fw2 blue3 underline-hover">AI<!-- -->,</a>Â </span><span><a href="/tag/birthday-week/" class="no-underline f1 fw2 blue3 underline-hover">Birthday Week<!-- -->,</a>Â </span><span><a href="/tag/pay-per-crawl/" class="no-underline f1 fw2 blue3 underline-hover">Pay Per Crawl<!-- -->,</a>Â </span><span><a href="/tag/ai-search/" class="no-underline f1 fw2 blue3 underline-hover">AI Search<!-- -->,</a>Â </span><span><a href="/tag/mcp/" class="no-underline f1 fw2 blue3 underline-hover">MCP</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-09-26T14:00+00:00">September 26, 2025  2:00 PM</p><a data-testid="related-posts-article-title" href="/monitoring-as-sets-and-why-they-matter/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Monitoring AS-SETs and why they matter</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">We will cover some of the reasons why operators need to monitor the AS-SET memberships for their ASN, and now Cloudflare Radar can help. <!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/mingwei/" class="fw5 f2 black no-underline">Mingwei Zhang</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/bryton/" class="fw5 f2 black no-underline">Bryton Herdes</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/bgp/" class="no-underline f1 fw2 blue3 underline-hover">BGP<!-- -->,</a>Â </span><span><a href="/tag/rpki/" class="no-underline f1 fw2 blue3 underline-hover">RPKI<!-- -->,</a>Â </span><span><a href="/tag/birthday-week/" class="no-underline f1 fw2 blue3 underline-hover">Birthday Week<!-- -->,</a>Â </span><span><a href="/tag/cloudflare-network/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Network<!-- -->,</a>Â </span><span><a href="/tag/cloudflare-radar/" class="no-underline f1 fw2 blue3 underline-hover">Radar</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-09-26T14:00+00:00">September 26, 2025  2:00 PM</p><a data-testid="related-posts-article-title" href="/introducing-observatory-and-smart-shield/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Introducing Observatory and Smart Shield â see how the world sees your website, and make it faster in one click</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">We&#x27;re announcing two enhancements to our Application Performance suite that&#x27;ll show how the world sees your website, and make it faster with one click - available Cloudflare Dashboard!<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/tim-kadlec/" class="fw5 f2 black no-underline">Tim Kadlec</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/brian/" class="fw5 f2 black no-underline">Brian Batraski</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/noah/" class="fw5 f2 black no-underline">Noah Maxwell Kennedy</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/speed/" class="no-underline f1 fw2 blue3 underline-hover">Speed<!-- -->,</a>Â </span><span><a href="/tag/performance/" class="no-underline f1 fw2 blue3 underline-hover">Performance<!-- -->,</a>Â </span><span><a href="/tag/birthday-week/" class="no-underline f1 fw2 blue3 underline-hover">Birthday Week<!-- -->,</a>Â </span><span><a href="/tag/aegis/" class="no-underline f1 fw2 blue3 underline-hover">Aegis</a>Â </span></div></article></div><!--astro:end--></astro-island><footer class="pt4 pb4 pl1 pr1 main-footer"><div class="mw8 center dn db-l ph3"><div class="flex flex-row justify-between"><div class="main-footer__menu-group"><ul id="getting-started-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="getting-started-menu">Getting Started<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/free/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="free-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Free plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/enterprise/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="enterprise" class="f1 blue3 no-underline underline-hover" rel="noreferrer">For enterprises</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compare-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compare plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-your-website/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="get-a-recommendation" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Get a recommendation</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/demo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="request-a-demo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Request a demo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/contact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="contact-sales" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Contact Sales</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1" data-submenu="company-menu">Resources<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/learning/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="learning-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Learning Center</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/analysts/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="analysts-report" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Analyst reports</a></li><li class="pt1 pb1"><a href="https://radar.cloudflare.com/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Radar</a></li><li class="pt1 pb1"><a href="https://cloudflare.tv/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="tv" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare TV</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/case-studies/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="case-studies" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Case Studies</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Webinar" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="webinars" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Webinars</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Whitepaper" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="white-papers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">White Papers</a></li><li class="pt1 pb1"><a href="https://developers.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-docs" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer docs</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/the-net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="theNet" class="f1 blue3 no-underline underline-hover" rel="noreferrer">theNet</a></li></ul></div><div class="main-footer__menu-group"><ul id="sales-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="sales-menu">Solutions<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connectivity-cloud/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connectivity-cloud" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connectivity cloud</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/zero-trust/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="zero-trust" class="f1 blue3 no-underline underline-hover" rel="noreferrer">SSE and SASE services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/application-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="application-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Application services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/developer-platform/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer services</a></li></ul></div><div class="main-footer__menu-group"><ul id="community-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="community-menu">Community<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://community.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="community_hub" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Community Hub</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/galileo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="galileo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Project Galileo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/athenian/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="athenian" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Athenian Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/campaigns/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="cloudflare-for-campaigns" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare for Campaigns</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/technology-partners/cidp/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="critical-infrastructure-defense-project" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Critical Infrastructure Defense Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connect2024/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connect-2024" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connect 2024</a></li></ul></div><div class="main-footer__menu-group"><ul id="support-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="support-menu">Support<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://support.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="help-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Help center</a></li><li class="pt1 pb1"><a href="https://www.cloudflarestatus.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="status" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Status</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/compliance/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compliance" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compliance</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/gdpr/introduction/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="gdpr" class="f1 blue3 no-underline underline-hover" rel="noreferrer">GDPR</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/trust-hub/abuse-approach/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="trust-and-safety" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Trust &amp; Safety</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="company-menu">Company<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-overview/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">About Cloudflare</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/people/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="our_team" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Our team</a></li><li class="pt1 pb1"><a href="https://cloudflare.net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="investor-relations" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Investor relations</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Press</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/careers/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="careers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Careers</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/diversity-equity-and-inclusion/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="diversity-equity-inclusion" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Diversity, equity &amp; inclusion</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/impact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="impact-ESG" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Impact/ESG</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network_map" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network Map</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press-kit/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press-kit" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Logos &amp; press kit</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="partners" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Become a partner</a></li></ul></div></div></div><div class="mw8 center ph3"><div class="flex flex-row flex-wrap justify-center md:justify-between items-center pt4"><div class="flex flex-row space-x-4 items-start w-25-l pb4 pb0-l"><a target="_blank" rel="noreferrer" href="https://www.facebook.com/Cloudflare/" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/facebook.svg" alt="facebook"/></a><a target=" _blank" rel="noreferrer" href="https://x.com/Cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/twitter.svg" alt="X"/></a><a target="_blank" rel="noreferrer" href="https://www.linkedin.com/company/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/linkedin.svg" alt="linkedin"/></a><a target="_blank" rel="noreferrer" href="https://www.youtube.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/youtube.svg" alt="youtube"/></a><a target="_blank" rel="noreferrer" href="https://www.instagram.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/instagram.svg" alt="instagram"/></a></div><div class="w-70-l tr-l tl-ns"><div><span class="main-footer__copyright f1">Â© <!-- -->2025<!-- --> Cloudflare, Inc.<!-- --> </span><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/privacypolicy/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Privacy Policy<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/website-terms/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Terms of Use<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/disclosure/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Report Security Issues<!-- --> </a><span class="main-footer__copyright f1">|</span><img class="mw2 ph1" src="/images/privacy-options.svg" alt="Privacy Options"/><a href="#cookie-settings" id="ot-sdk-btn" class="ot-sdk-show-settings main-footer__copyright f1 no-underline underline-hover"><span class="brandGray5">Cookie Preferences</span> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/trademark/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Trademark<!-- --> </a></div></div></div></div></footer></html><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"985efde77c96e5c9","version":"2025.9.1","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"2bc156e5f250476cb274d269511ffb57","b":1}' crossorigin="anonymous"></script>
