<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Karlo Zanki">
    <meta name="description" content="Relying on legacy functionalities comes with inherent security risks">
    <meta name="generator" content="HubSpot">
    <title>Spotting malicious Excel4 macros</title>
    <link rel="shortcut icon" href="https://www.reversinglabs.com/hubfs/favicons/RL.svg">
    
<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="Relying on legacy functionalities comes with inherent security risks">
    <meta property="og:title" content="Spotting malicious Excel4 macros">
    <meta name="twitter:description" content="Relying on legacy functionalities comes with inherent security risks">
    <meta name="twitter:title" content="Spotting malicious Excel4 macros">

    

    

    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.reversinglabs.com/hs-fs/hub/3375217/hub_generated/template_assets/11708570900/1729507044480/Redesign_2023/css/blog/tag-list.min.css">

    


    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MKL9P8B');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<meta name="google-site-verification" content="s4v_9FTp-yOMSOIG-AncB-m4uIke9tNd3uRdYtnJlic">
<meta name="google-site-verification" content="kKomAs_6Qe6aWHn_7A2Q-cdioJZZAlhGUMHYC-BTuqs">
<link rel="shortcut icon" href="https://www.reversinglabs.com/hubfs/favicons/favicon.ico?v=XBJLaGAQax">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.reversinglabs.com/hubfs/favicons/apple-touch-icon.png?v=XBJLaGAQax">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.reversinglabs.com/hubfs/favicons/favicon-32x32.png?v=XBJLaGAQax">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.reversinglabs.com/hubfs/favicons/favicon-16x16.png?v=XBJLaGAQax">
<link rel="manifest" href="https://www.reversinglabs.com/hubfs/favicons/site.webmanifest?v=XBJLaGAQax">
<link rel="mask-icon" href="https://www.reversinglabs.com/hubfs/favicons/safari-pinned-tab.svg?v=XBJLaGAQax" color="#f6143f">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta property="og:site_name" content="ReversingLabs">
<meta property="og:url" content="https://www.reversinglabs.com/blog/spotting-malicious-excel4-macros">
<meta name="twitter:site" content="@ReversingLabs">
<meta name="twitter:creator" content="@ReversingLabs">
<!-- preload -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,300&amp;display=swap" as="style">
<link rel="preload" href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,100;9..40,200;9..40,300;9..40,400;9..40,500;9..40,600&amp;display=swap" as="style">
<link rel="preload" href="//3375217.fs1.hubspotusercontent-na1.net/hubfs/3375217/raw_assets/public/Redesign_2023/icons/fonts/reversinglabs.woff" as="font" type="font/woff" crossorigin>

<link rel="preload" href="https://www.reversinglabs.com/hs-fs/hubfs/hub_generated/template_assets/1/137900387987/1741006753019/template_main.min.css" as="style" onload="this.rel='stylesheet'">
<link rel="preload" href="https://cdn2.hubspot.net/hub/7052064/hub_generated/template_assets/1727366005552/hubspot/hubspot_default/shared/responsive/layout.min.css" as="style" onload="this.rel='stylesheet'">

<!-- end preload -->


<!--PF tracking cocde-->
<script type="text/javascript">
    (function(j,u,k,e,b,o,x){j["pfObject"]=b;j[b]=j[b]||function(){
    (j[b].q=j[b].q||[]).push(arguments)},j[b].l=1*new Date();o=u.createElement(k),
    x=u.getElementsByTagName(k)[0];o.async=1;o.src=e;x.parentNode.insertBefore(o,x)
    })(window,document,'script', 'https://cdn-app.pathfactory.com/production/jukebox-lite/current/jukebox.js' ,"pf");
      pf('create', 'LB-316DB6E2-11084');
      
  </script>
<!--End PF tracking cocde-->
<meta property="og:image" content="https://www.reversinglabs.com/hubfs/Blog/Spotting-malicious-Excel4-macros.jpg">
<meta property="og:image:width" content="1400">
<meta property="og:image:height" content="732">
<meta property="og:image:alt" content="Spotting malicious Excel4 macros">
<meta name="twitter:image" content="https://www.reversinglabs.com/hubfs/Blog/Spotting-malicious-Excel4-macros.jpg">
<meta name="twitter:image:alt" content="Spotting malicious Excel4 macros">

<meta property="og:url" content="https://www.reversinglabs.com/blog/spotting-malicious-excel4-macros">
<meta name="twitter:card" content="summary_large_image">

<link rel="canonical" href="https://www.reversinglabs.com/blog/spotting-malicious-excel4-macros">
<style id="HideElements" type="text/plain">

body.hs-blog-post, body.hs-site-page {
    padding-top: 0px !important;
}

.hs-blog-post .header-container-wrapper, .hs-site-page .header-container-wrapper {
    display: none;
}

div#hs-web-interactives-bottom-anchor {
    display: none;
}

div#hs-web-interactives-top-anchor {
    display: none;
}

div.span3.widget-span.widget-type-cell {
    display: none;
}

.row-fluid .span9 {
    width: 100% !important;
}

.row-fluid .span3 {
    width: 0px !important;
}

.span9.widget-span.widget-type-cell {
    padding-right: 0px;
    border-right: 0px;
}

.blog__post-topic-date, .blog-author__short, ul.blog-post__social-list, ul.tag-list-inline,  {
    display: none;
}

div.blog__post-content div, div.blog-post h2 {
    display: none !important;
}

.blog__listing-item.blog__listing-item--more {
    display: none;
}

.footer-container-wrapper {
    display: none;
}

</style>

<script>
    var windowURL = window.location.search;
  console.log(windowURL);
  if (windowURL.indexOf('menu=hide') > -1){                          
    document.getElementById('HideElements').type = 'text/css'
}
</script>
<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.reversinglabs.com/blog/rss.xml">
<meta name="twitter:domain" content="www.reversinglabs.com">
<meta name="twitter:site" content="@ReversingLabs">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//7052064.fs1.hubspotusercontent-na1.net/hubfs/7052064/hub_generated/template_assets/DEFAULT_ASSET/1741371048388/template_layout.min.css">

<link rel="stylesheet" href="https://www.reversinglabs.com/hs-fs/hub/3375217/hub_generated/template_assets/5951651806/1720439988722/Reversinglabs_July2018_Theme/Coded_Files/RL-custom.min.css">
<link rel="stylesheet" href="https://www.reversinglabs.com/hs-fs/hubfs/hub_generated/template_assets/1/137900387987/1741006753019/template_main.min.css">


    


  
  
   

    

</head>
<body class="   hs-content-id-45964042507 hs-blog-post hs-blog-id-5901382633" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MKL9P8B" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-global_group " style="" data-widget-type="global_group" data-x="0" data-w="12">
<div class="" data-global-widget-path="generated_global_groups/137874121636.html"><div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="stickybar__wrap stickybar__on">
  
<div class="span12 widget-span widget-type-cell header" style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_169642168632599" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">








  <div class="stickybar" style="opacity: 0;" data-slider-speed="6000" data-cookie-exp="1" data-init-slider="true">
    <div class="stickybar__inner-container">
      
      <div class="stickybar__item" style="background-color: #BCBAFF">
        <div class="stickybar__text" style="color: #000000"><span style="font-size: 16px;"><strong><span style="color: #000000;">Looking for an alternative to VirusTotal? We've got you covered.</span></strong></span></div>
        <a class="cta cta--gradient cta--small" style="background-color: #ffffff; color: #ffffff" href="https://www.reversinglabs.com/reversinglabs-vs-virustotal" target="_blank">
          Learn More
        </a>
      </div>
      
      <div class="stickybar__item" style="background-color: #BCBAFF">
        <div class="stickybar__text" style="color: #000000"><span style="font-size: 16px;"><span style="font-size: 16px;"><strong><span style="color: #171d38;">Detect, analyze, and stop advanced malware—faster.<br data-start="54" data-end="57"></span></strong></span></span></div>
        <a class="cta cta--gradient cta--small" style="background-color: #ffffff; color: #ffffff" href="https://www.reversinglabs.com/webinar/hugging-face-ml-malware-nullifai" target="_blank">
          See how
        </a>
      </div>
      
      <div class="stickybar__item" style="background-color: #BCBAFF">
        <div class="stickybar__text" style="color: #000000"><span style="font-size: 16px;"><strong><span style="color: #000000;">AI’s Impact on the Software Supply Chain – Get the Insights</span></strong></span></div>
        <a class="cta cta--gradient cta--small" style="background-color: #ffffff; color: #ffffff" href="https://www.reversinglabs.com/ai-is-the-supply-chain" target="_blank">
          Download Now
        </a>
      </div>
      
    </div>
    
      <div class="stickybar__close-btn"><span class="ico close"></span></div>
    
  </div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1707391924810159" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="main-menu">
  <div class="main-menu__container main-menu__container-wide">
  <div class="main-menu__logo">
    <a href="https://www.reversinglabs.com">
      <img src="https://www.reversinglabs.com/hubfs/RL%20Logo/rl-logo-long.svg" alt="rl-logo-long" width="233" height="47">
    </a>
  </div>
  <nav class="main-menu__inner">
    <div class="main-menu__controls">
      <span class="ico menu-burger"></span>
      <span class="ico close"></span>
    </div>
    <div class="main-menu__items-container">
      <div class="main-menu__items main-menu__items--main">
      
        
        <div class="main-menu__item main-menu__item--solutions
            
            ">
            <span class="main-menu__item-inner-container">
              <span class="main-menu__item-text">Solutions</span>
              <span class="main-menu__item-chevron"></span>
            </span>  
            
              
              
              <div class="main-menu__sub-items-container">
                <div class="main-menu__sub-items">
                
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">Software Supply Chain Security </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/solutions/manage-3rd-party-software-risks" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Assess and Manage Third-Party Software</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/solutions/secure-software-release-processes" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Secure Build and Release</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/solutions/secure-virtual-machine-images" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Protect Virtual Machines</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/solutions/open-source-software-security" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Secure Open-Source Software</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/solutions/software-bill-of-materials-sbom" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Go Beyond the SBOM</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                  </div>
                
            
              
              
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">File Security </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/solutions/email-threat-scanning" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Increase Email Threat Resilience</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/solutions/secure-file-collaboration" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Detect Malware in File Shares and Storage</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/solutions/advanced-malware-analysis" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Advanced Malware Analysis Suite</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                  </div>
                
            
              
              
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">Security Operations </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/solutions/scalable-file-analysis" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Scalable File Analysis</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/solutions/cyber-threat-intelligence" class="main-menu__sub-item">
                            <span class="main-menu__item-text">High-Fidelity Threat Intelligence</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/solutions/ransomware-feed" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Curated Ransomware Feed</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/solutions/malware-analysis" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Automate Malware Analysis Workflows</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                  </div>
                
                </div>
              </div>
              
            
        </div>
        
      
        
        <div class="main-menu__item main-menu__item--product-and-technology
            
            ">
            <span class="main-menu__item-inner-container">
              <span class="main-menu__item-text">Product &amp; Technology</span>
              <span class="main-menu__item-chevron"></span>
            </span>  
            
              
              
              <div class="main-menu__sub-items-container">
                <div class="main-menu__sub-items">
                
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">Products </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/products/software-supply-chain-security" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Spectra Assure</span>
                            <span class="main-menu__item-description">Software Supply Chain Security</span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/products/spectra-detect" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Spectra Detect</span>
                            <span class="main-menu__item-description">High-Speed, High-Volume, Large File Analysis</span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/products/spectra-analyze" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Spectra Analyze</span>
                            <span class="main-menu__item-description">In-Depth Malware Analysis &amp; Hunting for the SOC</span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/products/spectra-intelligence" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Spectra Intelligence</span>
                            <span class="main-menu__item-description">Authoritative Reputation Data &amp; Intelligence</span>
                          </a>
                       
                     
                  </div>
                
            
              
              
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">Technology </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/products/spectra-core" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Spectra Core</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/integrations" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Integrations</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                  </div>
                
                </div>
              </div>
              
            
        </div>
        
      
        
        <div class="main-menu__item main-menu__item--partners
            
            ">
            <span class="main-menu__item-inner-container">
              <span class="main-menu__item-text">Partners</span>
              <span class="main-menu__item-chevron"></span>
            </span>  
            
              
              
              <div class="main-menu__sub-items-container">
                <div class="main-menu__sub-items">
                
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">Partners </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/become-a-partner" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Become A Partner</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/value-added-partners" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Value Added Partners</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/integrations" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Technology Partners</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/marketplaces" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Marketplaces</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                  </div>
                
            
              
              
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">Alliances </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/alliances" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Alliances</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                  </div>
                
                </div>
              </div>
              
            
        </div>
        
      
        
        <div class="main-menu__item main-menu__item--resources
            
            ">
            <span class="main-menu__item-inner-container">
              <span class="main-menu__item-text">Resources</span>
              <span class="main-menu__item-chevron"></span>
            </span>  
            
              
              
              <div class="main-menu__sub-items-container">
                <div class="main-menu__sub-items">
                
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">Resources </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/blog" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Blog</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/resources" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Content Library</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/conversinglabs" class="main-menu__sub-item">
                            <span class="main-menu__item-text">ConversingLabs Podcast</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/customers" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Customer Stories</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/demo-videos" class="main-menu__sub-item">
                            <span class="main-menu__item-text">DEMO Videos</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://support.reversinglabs.com/hc/en-us?_gl=1" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Documentation</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/from-the-labs" class="main-menu__sub-item">
                            <span class="main-menu__item-text">From the Labs: YARA Rules</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/learning-with-reversinglabs" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Learning with ReversingLabs</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/open-source-yara-rules" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Open Source YARA Rules</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/public-sector" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Public Sector Solutions</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/software-package-deconstruction-series" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Software Deconstruction Demo Series</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/webinars" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Webinars</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                  </div>
                
                </div>
              </div>
              
            
        </div>
        
      
        
        <div class="main-menu__item main-menu__item--company
            
            ">
            <span class="main-menu__item-inner-container">
              <span class="main-menu__item-text">Company</span>
              <span class="main-menu__item-chevron"></span>
            </span>  
            
              
              
              <div class="main-menu__sub-items-container">
                <div class="main-menu__sub-items">
                
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">Company </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/company/about-us" class="main-menu__sub-item">
                            <span class="main-menu__item-text">About Us</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/company/leadership" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Leadership</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/company/careers" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Careers</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/crosspoint-capital-leads-investment-in-software-security-pioneer-reversinglabs" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Series B Investment</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/blog/tag/company-events" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Company News</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                  </div>
                
            
              
              
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">Events </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/events" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Events</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                  </div>
                
            
              
              
               
                  <div class="main-menu__sub-items-section"> 
                     <h4 class="text-color--colored-gradient">Press </h4>
                      
                        
                          <a href="https://www.reversinglabs.com/newsroom/press-releases" class="main-menu__sub-item">
                            <span class="main-menu__item-text">Press Releases</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                        
                          <a href="https://www.reversinglabs.com/newsroom/news" class="main-menu__sub-item">
                            <span class="main-menu__item-text">In the News</span>
                            <span class="main-menu__item-description"></span>
                          </a>
                       
                     
                  </div>
                
                </div>
              </div>
              
            
        </div>
        
      
        
        <a href="https://register.reversinglabs.com/demo" class="main-menu__item main-menu__item--request-a-demo
            cta cta--small cta--green
            ">
          <span class="main-menu__item-text">Request a Demo</span>
        </a>
        
      
      </div>
      <div class="main-menu__items main-menu__items--top">
        
        
        <a href="https://www.reversinglabs.com/contact-us" class="main-menu__item 
            main-menu__item--highlight
            ">
          <span class="main-menu__item-text">Contact Us</span>
        </a>
        
        
        
        <a href="https://support.reversinglabs.com/hc/en-us" class="main-menu__item 
            
            rd-site-menu__item--search">
          <span class="main-menu__item-text">Support</span>
        </a>
        
        
        
        <a href="https://rli.reversinglabs.com/accounts/login/" class="main-menu__item 
            
            rd-site-menu__item--search">
          <span class="main-menu__item-text">Login</span>
        </a>
        
        
        
        <a href="https://www.reversinglabs.com/blog" class="main-menu__item 
            
            ">
          <span class="main-menu__item-text">Blog</span>
        </a>
        
        
        
        <a href="https://www.secure.software/" class="main-menu__item 
            
            rd-site-menu__item--search">
          <span class="main-menu__item-text">Developer Portal</span>
        </a>
        
        
        
        <span class="main-menu__item 
            main-menu__item--search ico search">
          <span class="main-menu__item-text">Search</span>
        </span>
        
        
      </div>
    </div>
  </nav>
</div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_169770816757927" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">

<div class="modal modal--search-only micromodal-slide" id="modal-site-search" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
      <span class="modal__close" aria-label="Close modal" data-micromodal-close><span class="ico close"></span></span>    
      <main class="modal__content" id="modal-1-content">
        <form action="/hs-search-results" class="modal__form">
          <input type="text" class="hs-search-field__input hs-search-field__input--modal" name="term" autocomplete="off" aria-label="Search" placeholder="Search reversinglabs.com">
          
          
            <input type="hidden" name="type" value="SITE_PAGE">
          
          
            <input type="hidden" name="type" value="LANDING_PAGE">
          
          
            <input type="hidden" name="type" value="BLOG_POST">
          
          
             <input type="hidden" name="limit" value="500">
          
            <button aria-label="Search" class="modal__search-button"><span class="ico search"></span></button>
          
        </form>
      </main>
    </div>
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
 
</div>
</div><!--end row-->
</div><!--end row-wrapper -->
</div>
</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_169971693721085" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="title-banner module background-color--blue" ">
   <div class="title-banner__container module__container">
     
        <strong class="title-banner__title">RL Blog</strong>
     
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="blog__container">
<div class="span12 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span9 widget-span widget-type-cell sidebar--on" style="" data-widget-type="cell" data-x="0" data-w="9">

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1523032069834331" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_content" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
    <div class="blog__post">
<div id="hs_cos_wrapper_module_1729596670845328" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"></div>
<div class="blog__post-topic-date">  
<span class="blog__post-topic"><div id="hs_cos_wrapper_module_165901111278147" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<!--Threat Research sorted tags -->
<a class="topic-link" href="https://www.reversinglabs.com/blog/tag/threat-research">Threat Research</a>
<!--Research sorted tags -->
</div></span> | 
<time class="blog__post-date" datetime="2021-04-28">April 28, 2021 </time>
</div>
<div class="blog__post-headings">
<h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Spotting malicious Excel4 macros</span></h1>
<div id="hs_cos_wrapper_module_1577203992502740" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<h2 class="post-header__secondary-head blog__post-secondary-h2">Relying on legacy functionalities comes with inherent security risks</h2>
</div>
</div>
<div class="blog-author__short">
<div class="blog-author__short-info">
<div class="blog-author__short-info__image-container">
<img class="blog-author__short-info__image" src="https://www.reversinglabs.com/hubfs/Imported_Blog_Media/authors/karlo_zanki.jpg" alt="Karlo Zanki">
</div>
<div class="blog-author__short-info__text-container">
<span class="blog-author__short-info__text-label">Blog Author</span>
<p class="blog-author__short-info__name-bio">
Karlo Zanki, Reverse Engineer at ReversingLabs.&nbsp;<a href="https://www.reversinglabs.com/blog/author/karlo-zanki">Read More...</a>
</p>
</div>
</div>
</div>
<ul class="share-post">
<!-- Begin partial -->
<li><a class="share_facebook" href="javascript:;" title="Facebook" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https://www.reversinglabs.com/blog/spotting-malicious-excel4-macros','Facebook Share','width=600,height=600')"><span class="ico facebook"></span></a></li>
<li><a class="share_x" href="javascript:;" title="X" onclick="window.open('https://twitter.com/intent/tweet?url=https://www.reversinglabs.com/blog/spotting-malicious-excel4-macros&amp;text=Spotting+malicious+Excel4+macros','Twitter Share','width=600,height=600')"><span class="ico x"></span></a></li>
<li><a class="share_linkedin" href="javascript:;" title="Linkedin" target="popup" onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.reversinglabs.com/blog/spotting-malicious-excel4-macros','LinkedIn Share','width=600,height=600')"><span class="ico linkedin"></span></a></li>
<li><a class="share_bsky" href="javascript:;" title="Bluesky" onclick="window.open('https://bsky.app/intent/compose?text=Spotting+malicious+Excel4+macros%20https%3A%2F%2Fwww.reversinglabs.com%2Fblog%2Fspotting-malicious-excel4-macros','Bluesky Share','width=600,height=600')"><span class="ico bluesky"></span></a>
</li><li><a class="share_email" href="mailto:?body=https://www.reversinglabs.com/blog/spotting-malicious-excel4-macros" title="Email"><span class="ico mail"></span></a></li>
<!-- End partial -->
</ul>
<div id="hs_cos_wrapper_module_1705062190107298" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"></div>
<div class="blog__post-content html-content">
<span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><h2><img src="https://www.reversinglabs.com/hs-fs/hubfs/Blog/Spotting-malicious-Excel4-macros.jpg?width=1400&amp;name=Spotting-malicious-Excel4-macros.jpg" alt="Spotting malicious Excel4 macros" style="width: 1400px;" width="1400" srcset="https://www.reversinglabs.com/hs-fs/hubfs/Blog/Spotting-malicious-Excel4-macros.jpg?width=700&amp;name=Spotting-malicious-Excel4-macros.jpg 700w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/Spotting-malicious-Excel4-macros.jpg?width=1400&amp;name=Spotting-malicious-Excel4-macros.jpg 1400w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/Spotting-malicious-Excel4-macros.jpg?width=2100&amp;name=Spotting-malicious-Excel4-macros.jpg 2100w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/Spotting-malicious-Excel4-macros.jpg?width=2800&amp;name=Spotting-malicious-Excel4-macros.jpg 2800w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/Spotting-malicious-Excel4-macros.jpg?width=3500&amp;name=Spotting-malicious-Excel4-macros.jpg 3500w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/Spotting-malicious-Excel4-macros.jpg?width=4200&amp;name=Spotting-malicious-Excel4-macros.jpg 4200w" sizes="(max-width: 1400px) 100vw, 1400px"><br>Introduction</h2>
<p>Excel4 (XLM) macros are a legacy scripting language introduced in 1992. They are a predecessor to the more advanced VBA scripting language introduced the following year. Because of the backward compatibility issues, modern Microsoft Office versions kept the support for this type of macros. <br><br>The reason why this old and rudimentary technology is interesting to malicious actors is because it still provides ways to access powerful functionalities such as interaction with the operating system. Additionally, security solutions have a lot of problems detecting threats that use this almost forgotten technology and, since a lot of companies still have some procedures depending on such XLM macro documents, blocking them completely isn’t an option. <br><br>Due to recent spikes in malicious Excel 4.0 macro use, security research has become focused on the detection of such threats. <a href="/blog/excel-4.0-macros" rel="noopener" target="_blank">One of our previous blog posts</a> goes to describe how to recognize the presence of these macros in Excel documents by using YARA rules. Since that blog was published, we’ve made a lot of improvements to our Titanium Platform that enable automated identification and extraction of Excel 4.0 macros. The latest static analysis engine also defines 327 new human-readable static behavior indicators focused on these macros. They help describe the intent behind the code of the analyzed document, and serve as a base for the improvements in our Explainable Machine Learning detection capabilities. The goal of this blog is to showcase the benefits of these improvements with respect to detecting the latest Excel malware macro threats.</p>
<!--more-->
<h2>Statistical data</h2>
<p>For the purposes of this blog, we collected all Excel documents that appeared for the first time in our TitaniumCloud since November 2020. These documents were then processed with our static analysis engine which identified that almost 160,000 of them use Excel 4.0 (XLM) macros. <br><br>Among these 160,000 Excel 4.0 documents, more than 90% were classified by TitaniumCloud as malicious or suspicious. Staggering numbers that show that, if you encounter a document that contains XLM macros, it is almost certain that its macro will be malicious. It makes sense given that XLM macros are a legacy Office option at this point, and there is just a small chance that new documents would use them instead of more “modern” VBA macros.</p>
<p style="text-align: center;"><img src="https://www.reversinglabs.com/hubfs/Blog/documents%20containing%20XLM%20macros.svg" alt="documents containing XLM macros" loading="lazy" style="width: 1400px;" width="1400"><br><span style="font-weight: bold; font-size: 16px;">Classification distribution of documents containing XLM macros</span></p>
<p>We also looked at the distribution of malicious documents over time to determine if malicious activities spike during some certain dates. For this research, we only count unique samples to prevent mass malware mailing campaigns from tilting the scales too much. That gives us a more realistic view of malicious actor activities during this period.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Time-distribution-of-documents-containing-XLM-macros.png" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Time-distribution-of-documents-containing-XLM-macros.png" alt="Time distribution of documents containing XLM macros" style="width: 1100px;"></a>
<p style="font-weight: bold; font-size: 16px; text-align: center;">Time distribution of documents containing XLM macros</p>
<p>The graph shows that there was a significant increase in the number of encountered malicious samples at the end of November 2020. The largest peak on the graph is just around November 27th, and coincides with last year's Black Friday event. This is somewhat expected, as such events are a good opportunity for malicious actors to lure their targets into opening malicious content.<br><br>One, perhaps unexpected, anomaly is that there was next to no activity around Christmas and New Year. Perhaps malicious actors took some time off during the holidays, as the volume of malicious Excel 4.0 macros picked up in January, just in time for Valentine's day shopping spike. Malware, as most human activity, appears to be seasonal.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Top-10-Malware-Families.png" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Top-10-Malware-Families.png" alt="Malware family distribution" style="width: 1100px;"></a>
<p style="font-weight: bold; font-size: 16px; text-align: center;">Malware family distribution</p>
<p>Looking at the malware families detected in the sample set shows that ZLoader and Quakbot are the dominant malware families in the Excel 4.0 malware ecosystem, as they comprise more than half of our dataset. Next, we will cover how new Titanium Platform features can help you recognize these threats.</p>
<h2>Quakbot sample</h2>
<p>Sample with the c1977f91f6b30995432bc2f757934ba6bfab5438 SHA1 hash was analyzed using Titanium Platform. The analysis report shows that we are dealing with a malicious sample from the Quakbot family.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Samples-classification-summary.png" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Samples-classification-summary.png" alt="Sample’s classification summary" style="width: 1056px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Sample’s classification summary</span></p>
<p>Actors behind Quakbot often distribute their payloads in the form of an Excel document. They try to mask these documents to look like they are encrypted using the DocuSign software, and they try to convince their targets to enable macros in order to decrypt the content. Such messages can look quite convincing. This is the image that Titanium Platform extracted from the analyzed sample during static analysis.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/docu-sign.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/docu-sign.jpg" alt="Message used to lure targets into enabling macros" style="width: 1400px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Message used to lure targets into enabling macros</span></p>
<p>The Titanium Platform’s report shows that 5 embedded files with indicators have been extracted from this document. Even by just looking at this short summary, it is evident that this document calls a procedure from another DLL, or a similar code resource, and that it executes another application. Such behaviour can often be quite dangerous, and should immediately attract analyst attention.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Embedded-files-with-indicators.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Embedded-files-with-indicators.jpg" alt="Embedded files with indicators" style="width: 1100px;"></a>
<p style="text-align: center;"><span style="font-weight: bold; font-size: 16px;">Embedded files with indicators</span></p>
<p>The detailed list of the extracted files shows that 3 files with Excel 4.0 macros in them have been extracted from this sample. And, as our statistics show, there is a great chance that these are used for malicious purposes. That warrants a deeper look.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Extracted-files.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Extracted-files.jpg" alt="Extracted files" style="width: 930px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Extracted files</span></p>
<p>The metadata extracted from the document shows where to start looking. This document has a cell defined as <em>Auto_Open</em>. This is a typical way for documents with Excel 4.0 macros to automatically start their execution from a specific cell upon opening, and is similar to an entry point in PE executables. So, the execution starts in the extracted file <em>Files1</em>, from cell <em>A40</em>.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Document-metadata-with-Auto_Open-cell.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Document-metadata-with-Auto_Open-cell.jpg" alt="Document metadata with Auto_Open cell" style="width: 880px;"></a>
<p style="font-weight: bold; font-size: 16px; text-align: center;">Document metadata with Auto_Open cell</p>
<p>When using Titanium Platform to check if some file is malicious, usually the first thing to check are indicators extracted during static analysis. Indicators represent a human-readable summary of interesting capabilities discovered in the analyzed sample. In order to provide threat analysts with explainable detection, each indicator includes a textual description and pinpoints the part of the file that triggered it. In this case, looking at the indicators for the extracted file, <em>Files1</em> suggests that it runs another macro using the <em>RUN XLM</em> macro function.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/files1_indicators.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/files1_indicators.jpg" alt="Files1 indicators" style="width: 820px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Files1 indicators</span></p>
<p>Excel files are usually displayed like tables, and malware authors use that to visually hide some content by placing it into cells outside the default screen view. These can only be found with a lot of scrolling. Titanium Platform has a preview feature that, in the case of Excel documents, shows only the textual content of the file. It enables quick access to the interesting bits of content.<br><br>Cell <em>A40</em> was defined as the <em>Auto_Open</em> cell, but there is no macro content in that cell. This is because Excel 4.0 macros, when executed, automatically skip empty cells and proceed the execution to the first following cell which has actual content. Which is in this case found at <em>A51</em>. That cell redirects to another, <em>R59</em>, inside the same sheet, which in turn references the <em>“Files3”</em> sheet and redirects execution to it. Below these two cells is another one containing a suspicious looking URL. Performing this quick analysis already revealed behaviour that can’t be expected from any legitimate document.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Preview-of-the-Files1-extracted-file-contents.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Preview-of-the-Files1-extracted-file-contents.jpg" alt="Preview of the “Files1” extracted file contents" style="width: 1400px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Preview of the “Files1” extracted file contents</span></p>
<p>Since the execution is now redirected to the <em>"Files3"</em> sheet, the next step is to look at its static behavior indicators. Besides executing other macros, this sheet also uses the CALL function, which is often used to call Windows APIs. Such powerful features are one of the reasons malicious actors like XLM macros. Indicators also show that the CONCATENATE function is used, which is often weaponized by some obfuscation techniques.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Files3-indicators.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Files3-indicators.jpg" alt="Files3 indicators" style="width: 700px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Files3 indicators</span></p>
<p>Looking at the preview shows the raw content, revealing that the data inside this sheet is obfuscated. CALL functions parameters are concatenated from letters and cell values from a different sheet named <em>lbuyf</em>, which serves as some kind of a dictionary.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Preview-of-the-Files3-extracted-file-contents.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Preview-of-the-Files3-extracted-file-contents.jpg" alt="Preview of the “Files3” extracted file contents" style="width: 920px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Preview of the “Files3” extracted file contents</span></p>
<p>Values in the <em>lbuyf</em> sheet are calculated at runtime using basic mathematical functions to get ASCII values of characters, and then concatenated into literals used from other XLM macro functions.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Part-of-the-lbuyf-extracted-file-contents.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Part-of-the-lbuyf-extracted-file-contents.jpg" alt="Part of the lbuyf extracted file contents" style="width: 840px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Part of the lbuyf extracted file contents</span></p>
<p>After deobfuscating the <em>Files3</em> sheet, it becomes visible that it calls the <em>CreateDirectoryA</em> function from <em>kernel32.dll</em>, and then redirects execution to the <em>Files2</em> sheet. Again, going back to its indicators, besides the already seen CALL and RUN functions, it also executes another application using the EXEC macro.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Files2_indicators.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Files2_indicators.jpg" alt="Files2 indicators" style="width: 700px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Files2 indicators</span></p>
<p>File preview shows code sequences similar to the ones seen in the <em>Files2</em> sheet. Deobfuscating the strings shows that, after calling the function <em>URLDownloadToFileA</em> from <em>URLMon library</em> and downloading the file from the suspicious URL seen in the <em>Files1</em> sheet, it finally executes that second stage payload. Not something uncommon for these malicious XLM documents.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/Preview-of-file-contents-extracted-from-Files2.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/Preview-of-file-contents-extracted-from-Files2.jpg" alt="Preview of file contents extracted from Files2" style="width: 800px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Preview of file contents extracted from Files2 </span></p>
<p>But what to do when a larger file is encountered and when manual inspection is impractical? Going back through the process, it is obvious that all these major steps in file behaviour are visible by merely looking at the indicators and without going into detailed inspection. This is where our <a href="https://www.reversinglabs.com/products/explainable-machine-learning" rel="noopener" target="_blank">Explainable Machine Learning</a> comes to aid.</p>
<h2>Explainable Machine Learning</h2>
<p>Titanium Platform’s machine learning classification is based entirely on human readable indicators. Created to identify which of these static behavior indicators contribute to the final threat detection verdict. Furthermore, each of these indicators is also linked to a MITRE ATT&amp;CK framework category, thus helping SOC analysts understand the type of threat they are dealing with and its impact on the organization. As mentioned earlier, the latest Titanium Platform update defined 327 new human-readable Excel 4.0 static behavior indicators. They describe various categories of behaviour. Including defense evasion, network communication, execution and file manipulation.<br><br>The capabilities of Titanium Platform’s machine learning classification will be demonstrated on a real-world sample with the bbcd9e57ef75c56ea57ba6f3b83a7f82128dff8e SHA1 hash. None of Titanium Platform’s cloud scanners classified this sample as malicious during the analysis, but our new machine learning model did.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/ML-classification-of-the-sample.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/ML-classification-of-the-sample.jpg" alt="ML classification of the bbcd9e57ef75c56ea57ba6f3b83a7f82128dff8e sample" style="width: 1400px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">ML classification of the bbcd9e57ef75c56ea57ba6f3b83a7f82128dff8e sample</span></p>
<p>As visible from the above image, the classification was based on propagation from an extracted file with the 5fe7587cebbd400dbb8e05501987784d4ea3028e SHA1 hash. Looking at the list of the extracted files shows that this file, named <em>Sheet6</em>, contains Excel 4.0 macros. The <em>Auto_Open</em> cell in the container document also points to this file <span style="font-weight: bold;">(Auto_Open: Sheet6!A2)</span>.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/extracted_files.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/extracted_files.jpg" alt="Extracted files" style="width: 1000px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Extracted files</span></p>
<p>Even though there aren’t many extracted indicators in this relatively small file, there were enough of them for the machine learning model to classify it as malicious. The file obviously calls procedures from some library and delays the macro execution. These two indicators combined should always attract threat analyst attention.</p>
<a href="https://blog.reversinglabs.com/hubfs/Blog/extracted-indicators.jpg" class="lightbox-image" data-mce-disabled-user-modify="true"><img src="https://www.reversinglabs.com/hubfs/Blog/extracted-indicators.jpg" alt="Extracted indicators" style="width: 1050px;"></a>
<p style="text-align: center;"><br><span style="font-weight: bold; font-size: 16px;">Indicators extracted from the 5fe7587cebbd400dbb8e05501987784d4ea3028e sample</span></p>
<p>Still, to fully understand the malicious functionality, file contents need to be previewed and macro logic needs to be followed through documents. To achieve all of its capabilities, <em>Sheet6</em> references other sheets in the document.</p>
<p style="text-align: center;"><img src="https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet6.jpg?width=524&amp;name=sheet6.jpg" alt="sheet6" loading="lazy" style="width: 524px; margin-left: auto; margin-right: auto; display: block;" width="524" srcset="https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet6.jpg?width=262&amp;name=sheet6.jpg 262w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet6.jpg?width=524&amp;name=sheet6.jpg 524w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet6.jpg?width=786&amp;name=sheet6.jpg 786w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet6.jpg?width=1048&amp;name=sheet6.jpg 1048w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet6.jpg?width=1310&amp;name=sheet6.jpg 1310w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet6.jpg?width=1572&amp;name=sheet6.jpg 1572w" sizes="(max-width: 524px) 100vw, 524px"><span style="font-weight: bold; font-size: 16px;">Preview of the Sheet6 content</span></p>
<p>For example, <em>Sheet3</em> contains the Base64-encoded payload. <em>Sheet2</em> serves as a dictionary and contains obfuscated string literals used to construct the CALL functions. The following image shows some of the obfuscated string literals, most of which can be recognized with little effort.</p>
<p style="text-align: center;"><img src="https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet2.jpg?width=524&amp;name=sheet2.jpg" alt="sheet2" loading="lazy" style="width: 524px; margin-left: auto; margin-right: auto; display: block;" width="524" srcset="https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet2.jpg?width=262&amp;name=sheet2.jpg 262w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet2.jpg?width=524&amp;name=sheet2.jpg 524w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet2.jpg?width=786&amp;name=sheet2.jpg 786w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet2.jpg?width=1048&amp;name=sheet2.jpg 1048w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet2.jpg?width=1310&amp;name=sheet2.jpg 1310w, https://www.reversinglabs.com/hs-fs/hubfs/Blog/sheet2.jpg?width=1572&amp;name=sheet2.jpg 1572w" sizes="(max-width: 524px) 100vw, 524px"><span style="font-weight: bold; font-size: 16px;">Part of the Sheet2 content</span></p>
<p>This dropper lives off the land by using the certutil binary to decode its Base64-encoded payload, and to convert it from HEX to binary representation. Finally, it executes the payload using<em> rundll32</em>. The binary payload is a <em>DLL</em> file with the 78c01aa4f88d35acfbc3d7142232cd1aa7682a6e SHA1 hash. It exports a function named <span style="font-weight: bold;">D</span>, which tries to download the next payload stage from the following location: <em>“hxxp://207[.]154.235[.]218/campo/z/z”</em>. Unfortunately, this second layer payload can no longer be downloaded from this URL for a more detailed analysis.</p>
<h2>Conclusion</h2>
<p>Statistics show that the malicious actors have adopted Excel 4.0 documents as a way of distributing their malware. This method has been here for more than a year and the number of newly seen samples isn’t dropping. The share of malicious samples in the total number of Excel 4.0 documents exceeds 90%, and, since a lot of well known malware families like Quakbot, ZLoader and Trickbot have been seen using them, we can expect these numbers to keep growing as more malware families pivot to this initial stage vector. The biggest risk for the targeted companies and individuals is the fact that security solutions still have a lot of problems with detecting malicious Excel 4.0 documents, making most of these slip by conventional signature based detections and analyst written YARA rules. <br><br>ReversingLabs continuously improves its detection mechanisms to keep up to date with malware trends. Latest improvements to Titanium Platform tackled the threats related to XLM macros and provided a way to reliably identify and extract such content. With the upcoming additions to our Explainable Machine Learning models based on the extracted Excel 4.0 indicators, Titanium Platform is now fully capable to successfully detect such threats in a quick and scalable way with static analysis. This can help block malicious documents before they enter your organizational network. <br><br>As a final thought regarding Excel 4.0 threats, even though backward compatibility is very important, some things should have a life expectancy and, from a security perspective, it would probably be best if they were deprecated at some point in time. Cost of maintaining 30 year old macros should be weighed against the security risks using such outdated technology brings.</p>
<h2>IOC list</h2>
<p>c1977f91f6b30995432bc2f757934ba6bfab5438<br>bbcd9e57ef75c56ea57ba6f3b83a7f82128dff8e<br>78c01aa4f88d35acfbc3d7142232cd1aa7682a6e</p>
<h6>Read other Related Blogs:</h6>
<ul>
<li><a href="/blog/excel-4.0-macros" rel="noopener">Excel 4.0 Macros</a></li>
</ul></span>
<div id="hs_cos_wrapper_module_172950521527438" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="blog-ctas module">
<div class="blog-ctas__container module__container">
</div>
</div></div>
<div id="hs_cos_wrapper_module_16770726333806" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
</div>
<div id="hs_cos_wrapper_module_1665507034702351" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
</div>
</div>      
<div class="blog__listing-item blog__listing-item--more">
<ul class="tag-list-inline">
<li class="tag-list-inline__item--text">Tags: </li>  
<li class="tag-list-inline__item"><a class="tag-list-inline__item-link" href="https://www.reversinglabs.com/blog/tag/research">Research</a></li>
<li class="tag-list-inline__item"><a class="tag-list-inline__item-link" href="https://www.reversinglabs.com/blog/tag/threat-research">Threat Research</a></li>
</ul>
</div>       
<div class="blog__listing-item blog__listing-item--more"><h2>More Blog Posts</h2></div>
<div class="blog__listing-item blog__listing-item--more"> 
<article class="blog__item">
<a href="https://www.reversinglabs.com/blog/cybersecurity-fog-of-war-data-science" class="blog__item-image">
<img src="https://3375217.fs1.hubspotusercontent-na1.net/hub/3375217/hubfs/fog-of-war-cyber-incident.jpg?width=480&amp;name=fog-of-war-cyber-incident.jpg" alt="How&nbsp;data science in cybersecurity can cut through the fog of war">
</a>
<div class="blog__item-content">
<h3><a href="https://www.reversinglabs.com/blog/cybersecurity-fog-of-war-data-science">How&nbsp;data science in cybersecurity can cut through the fog of war</a></h3>
<div class="blog__item-desc">
Orchestrating the heavy lifting of data management and analytics is easier said than done. Here are four key pillars for improving security outcomes.
</div>
<a class="blog__item-read-more" href="https://www.reversinglabs.com/blog/cybersecurity-fog-of-war-data-science">Read More</a>
</div>
</article>
<article class="blog__item">
<a href="https://www.reversinglabs.com/blog/7-container-security-best-practices" class="blog__item-image">
<img src="https://3375217.fs1.hubspotusercontent-na1.net/hub/3375217/hubfs/container-security-best-practices-1.jpg?width=480&amp;name=container-security-best-practices-1.jpg" alt="7 container security best practices">
</a>
<div class="blog__item-content">
<h3><a href="https://www.reversinglabs.com/blog/7-container-security-best-practices">7 container security best practices</a></h3>
<div class="blog__item-desc">
With the rise of attacks on the supply chain and threats from AI, a modern strategy for securing containers is required. Here are key considerations.
</div>
<a class="blog__item-read-more" href="https://www.reversinglabs.com/blog/7-container-security-best-practices">Read More</a>
</div>
</article>
<article class="blog__item">
<a href="https://www.reversinglabs.com/blog/software-development-security-challenges-ai" class="blog__item-image">
<img src="https://3375217.fs1.hubspotusercontent-na1.net/hub/3375217/hubfs/worry-ai-development.jpg?width=480&amp;name=worry-ai-development.jpg" alt="The top software development security challenges: The AI's have it">
</a>
<div class="blog__item-content">
<h3><a href="https://www.reversinglabs.com/blog/software-development-security-challenges-ai">The top software development security challenges: The AI's have it</a></h3>
<div class="blog__item-desc">
From the AppSec testing gap to data privacy, AI is increasing security worries. Here are key takeaways from a new survey of software development leaders.
</div>
<a class="blog__item-read-more" href="https://www.reversinglabs.com/blog/software-development-security-challenges-ai">Read More</a>
</div>
</article>
</div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
 
<div class="span3 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="9" data-w="3">

<div class="row-fluid-wrapper row-depth-1 row-number-5 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_170411393043375" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<div class="module module--side">
<div class="hs-search-field module__container">
    <div class="hs-search-field__bar"> 
      <form action="/hs-search-results" class="hs-search-field__bar-form">
        
        <input type="text" class="hs-search-field__input hs-search-field__input--results" name="term" autocomplete="off" aria-label="Search" placeholder="Search">
        
        
          <input type="hidden" name="type" value="SITE_PAGE">
        
        
        
          <input type="hidden" name="type" value="BLOG_POST">
          <!--<input type="hidden" name="type" value="LISTING_PAGE">-->
        
        
          <input type="hidden" name="limit" value="500">
        
          <button aria-label="Search" class="hs-search-field__button cta cta--default cta--red"><span class="ico search ico--24"></span></button>
        
      </form>
    </div>
    <ul class="hs-search-field__suggestions"></ul>
</div> 
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-6 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1703953719683100" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="module module--side categories-block">
<h2>Topics</h2>
  <ul>
  
    <li><a href="https://www.reversinglabs.com/blog"><span class="ico dynamic-analysis"></span> All Blog Posts</a></li>
  
    <li><a href="https://www.reversinglabs.com/blog/tag/software-supply-chain-security"><span class="ico decomposition"></span> AppSec &amp; Supply Chain Security</a></li>
  
    <li><a href="https://www.reversinglabs.com/blog/tag/dev-devsecops"><span class="ico system-power"></span> Dev &amp; DevSecOps</a></li>
  
    <li><a href="https://www.reversinglabs.com/blog/tag/threat-research"><span class="ico malware"></span> Threat Research</a></li>
  
    <li><a href="https://www.reversinglabs.com/blog/tag/security-operations"><span class="ico wheel"></span> Security Operations</a></li>
  
    <li><a href="https://www.reversinglabs.com/blog/tag/products-technology"><span class="ico monitor-dev"></span> Products &amp; Technology</a></li>
  
    <li><a href="https://www.reversinglabs.com/blog/tag/company-events"><span class="ico calendar"></span> Company &amp; Events</a></li>
  
  </ul>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-7 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1704023979676166" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="module module--side social-block">
  <h2>Follow us</h2>
  <ul>
    
      <li><a class="ico x" href="https://x.com/reversinglabs" target="_blank" rel="nofollow"><span>X</span></a></li>
    
      <li><a class="ico youtube" href="https://www.youtube.com/user/reversinglabs" target="_blank" rel="nofollow"><span>YouTube</span></a></li>
    
      <li><a class="ico linkedin" href="https://www.linkedin.com/company/reversinglabs" target="_blank" rel="nofollow"><span>LinkedIn</span></a></li>
    
      <li><a class="ico bluesky" href="https://bsky.app/profile/reversinglabs.com"><span>Bluesky</span></a></li>
    
  </ul>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-8 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1704025192341206" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="module module--side subscribe-block background-color--blue-gradient">
  <h2>Subscribe</h2>
  <p>Get the best of RL Blog delivered to your in-box weekly to stay up to date on key trends, analysis and best practices across threat intelligence and software supply chain security.</p>
   <div class="subscribe-block__form">
      <span id="hs_cos_wrapper_module_1704025192341206_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_form" style="" data-hs-cos-general-type="widget" data-hs-cos-type="form"><h3 id="hs_cos_wrapper_form_516376731_title" class="hs_cos_wrapper form-title" data-hs-cos-general-type="widget_field" data-hs-cos-type="text"></h3>

<div id="hs_form_target_form_516376731"></div>









</span>
    </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-9 ">
<div class="row-fluid ">


 

<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1704026912146250" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="module module--side favorite-post-block">
  <h2>Special Reports</h2>
    
      <div class="favorite-post-block__item">
          <a href="https://www.reversinglabs.com/sscs-report-2024" class="favorite-post-block__item-img"><img src="https://www.reversinglabs.com/hubfs/images/SSCS-Report-2024.webp" alt="The State of Software Supply Chain Security 2024"></a>
          <div>
            <h2 style="margin-top:0;"><a href="https://www.reversinglabs.com/sscs-report-2024">The State of Software Supply Chain Security 2024</a> </h2>
             
             <span class="favorite-post-block__item-date"> June 10, 2024  </span>
          </div>
      </div>
</div></div>

</div><!--end widget-span -->
    

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-10 ">
<div class="row-fluid ">


 

<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1704027775852284" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="module module--side latest-post-block">
  
  
  
    
      
        <h2><a href="https://www.reversinglabs.com/webinars">Upcoming Webinars</a></h2>
      
       <div class="latest-post-block__item" style="margin-bottom: 20px;">
         
          <a href="https://www.reversinglabs.com/webinars/six-critical-risks-to-identify-in-your-supply-chain"><img src="https://www.reversinglabs.com/hubfs/6%20Critical%20Risks%201400x732%20-%20HubSpot%20Featured%20image.png" alt="Webinar: 6 Critical Risks to identify in Your SSC"></a>
          <a href="https://www.reversinglabs.com/webinars/six-critical-risks-to-identify-in-your-supply-chain">Webinar: 6 Critical Risks to identify in Your SSC</a>
           
         
       </div>
      
    
      
       <div class="latest-post-block__item" style="margin-bottom: 20px;">
         
          <a href="https://www.reversinglabs.com/webinars/securing-jfrog-artifactory-find-risky-software-in-your-repos"><img src="https://www.reversinglabs.com/hubfs/Artifact%20Repos%201400x732%20-%20HubSpot%20Featured%20image.png" alt="Webinar: Jfrog Artifcactory"></a>
          <a href="https://www.reversinglabs.com/webinars/securing-jfrog-artifactory-find-risky-software-in-your-repos">Webinar: Jfrog Artifcactory</a>
           
         
           <a href="https://www.reversinglabs.com/webinars" style="font-size:1.6rem; margin-top: 10px; display:block">See more Webinars</a>
         
       </div>
      
    
  
  
  
    
      
        <h2><a href="https://www.reversinglabs.com/conversinglabs">ConversingLabs</a></h2>
      
       <div class="latest-post-block__item" style="margin-bottom: 20px;">
         
          <a href="https://www.reversinglabs.com/conversinglabs/hackers-hacking-hackers"><img src="https://www.reversinglabs.com/hubfs/ConversingLabs/ConversingLabs%20S7E2%20Sam%20Curry%201400x732.webp" alt="Hackers Hacking Hackers"></a>
          <a href="https://www.reversinglabs.com/conversinglabs/hackers-hacking-hackers">Hackers Hacking Hackers</a>
           
         
       </div>
      
    
      
       <div class="latest-post-block__item" style="margin-bottom: 20px;">
         
          <a href="https://www.reversinglabs.com/conversinglabs/past-present-future-of-sboms"><img src="https://www.reversinglabs.com/hubfs/ConversingLabs/ConversingLabs-S7E1-HubSpot.png" alt="The Past, Present &amp; Future of Software Bills of Materials"></a>
          <a href="https://www.reversinglabs.com/conversinglabs/past-present-future-of-sboms">The Past, Present &amp; Future of Software Bills of Materials</a>
           
         
           <a href="https://www.reversinglabs.com/conversinglabs" style="font-size:1.6rem; margin-top: 10px; display:block">See more ConversingLabs</a>
         
       </div>
      
    
  
</div></div>

</div><!--end widget-span -->
    

</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
 
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
  </div>
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_170367796202877" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><footer class="footer">

  <div class="footer__container footer__container-wide">
    <span class="footer__to-top-button"><span class="ico arrow-up-bold"></span></span>
    <div class="footer__content-container">
     
      <div class="footer__article">
         <h2><a href="https://www.reversinglabs.com/software-supply-chain-incident-response-assistance">Spectra Assure Free Trial</a></h2>
         <p>Get your 14-day free trial of Spectra Assure™</p>
         <a class="footer-cta cta cta--lg cta--gradient" href="https://www.reversinglabs.com/software-supply-chain-security-free-trial?utm_source=google&amp;utm_medium=cpc&amp;utm_campaign=sitelink_extension&amp;utm_term=search&amp;utm_source=google&amp;utm_medium=cpc&amp;utm_campaign=sitelinkext&amp;utm_term=search&amp;utm_term=threat%20intelligence%20software&amp;utm_campaign=Search_MATH&amp;utm_source=google&amp;utm_medium=cpc&amp;hsa_acc=9845575402&amp;hsa_cam=20716113481&amp;hsa_grp=155824974958&amp;hsa_ad=712565435977&amp;hsa_src=g&amp;hsa_tgt=kwd-307465796787&amp;hsa_kw=threat%20intelligence%20software&amp;hsa_mt=b&amp;hsa_net=adwords&amp;hsa_ver=3&amp;gad_source=1&amp;gclid=Cj0KCQjwrp-3BhDgARIsAEWJ6SxK92OA8BlO4LPf8uaQaiVh_nAF2AiGWmLzR4CbMT8Jr9W0Gr-Es0kaAk7yEALw_wcB">Get Free Trial</a>
      </div>
        
          <div class="footer__links-container">
            
            <ul class="footer__links">
              
            
              <li class="footer__links-item"><a href="https://www.reversinglabs.com/blog">Blog</a></li>
            
              <li class="footer__links-item"><a href="https://www.reversinglabs.com/webinars">Webinars</a></li>
            
              <li class="footer__links-item"><a href="https://www.reversinglabs.com/demo-videos">Demo Videos</a></li>
            
            </ul>
            
            <ul class="footer__links">
              
            
              <li class="footer__links-item"><a href="https://www.reversinglabs.com/events">Events</a></li>
            
              <li class="footer__links-item"><a href="https://www.reversinglabs.com/newsroom/news">In the News</a></li>
            
              <li class="footer__links-item"><a href="https://www.reversinglabs.com/glossary">Glossary</a></li>
            
            </ul>
            
            <ul class="footer__links">
              
            
              <li class="footer__links-item"><a href="https://www.reversinglabs.com/company/about-us">About Us</a></li>
            
              <li class="footer__links-item"><a href="https://www.reversinglabs.com/company/careers">Careers</a></li>
            
              <li class="footer__links-item"><a href="https://www.reversinglabs.com/contact-us">Contact Us</a></li>
            
            </ul>
            
          </div>
        </div>
    </div> 

  
  <div class="footer__bottom">
    <div class="footer__bottom-container footer__container-wide">
      <div class="footer__copy">
         <div class="footer__copy-logo">
           <svg xmlns="https://www.w3.org/2000/svg" width="45" height="46" viewbox="0 0 45 46" fill="none">
            <path d="M45 0H0V46H45V0Z" fill="white" />
            <path d="M27 33V15H30.2263V30.1406H38V33H27Z" fill="black" />
            <path d="M8 32.9994L12.5123 25.7081C10.474 24.8923 9.21087 23.4713 9.21087 20.7523V20.5832C9.21087 15.8657 13.0251 15 17.6389 15C19.5722 15 21.3018 15.0488 23 15.1203V32.9994H19.4956V26.407H17.7173C17.1225 26.407 16.5563 26.407 16.0428 26.3826L11.8178 33H8V32.9994ZM12.7426 20.7755C12.7426 23.085 14.2111 23.7356 17.5101 23.7356C18.1802 23.7356 18.8249 23.7356 19.4956 23.7101V17.8387C14.8034 17.8387 12.7426 17.8642 12.7426 20.6309V20.7755Z" fill="black" />
          </svg>
        </div>
         <div class="footer__copy-text">
          <a href="https://www.reversinglabs.com/privacy-policy">Privacy Policy</a> | 
          <a href="https://www.reversinglabs.com/cookie-policy">Cookies</a>
          <div>All rights reserved ReversingLabs © 2025</div>
        </div>  
      </div>
      <ul class="footer__social">    
          <li><a href="https://twitter.com/reversinglabs"><span class="ico x"></span></a></li>
          <li><a href="https://www.linkedin.com/company/reversinglabs"><span class="ico linkedin"></span></a></li>       
          <li><a href="https://www.facebook.com/reversinglabs"><span class="ico facebook"></span></a></li>
          <li><a href="https://www.instagram.com/reversinglabs"><span class="ico instagram"></span></a></li>        
          <li><a href="https://www.youtube.com/user/reversinglabs"><span class="ico youtube"></span></a></li>
          <li><a href="https://blog.reversinglabs.com/blog/rss.xml"><span class="ico rss"></span></a></li>
          <li><a href="https://bsky.app/profile/reversinglabs.com"><span class="ico bluesky"></span></a></li>
      </ul> 
    </div>  
  </div>
</footer>

<!-- jQuery -->






      



  
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
      


<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.5/js.cookie.min.js" integrity="sha512-nlp9/l96/EpjYBx7EP7pGASVXNe80hGhYAUrjeXnu/fyF5Py0/RXav4BBNs7n5Hx1WFhOEOWSAVjGeC3oKxDVQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tiny-slider/2.9.4/min/tiny-slider.js" integrity="sha512-j+F4W//4Pu39at5I8HC8q2l1BNz4OF3ju39HyWeqKQagW6ww3ZF9gFcu8rzUbyTDY7gEo/vqqzGte0UPpo65QQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/simplelightbox/2.14.2/simple-lightbox.jquery.min.js" integrity="sha512-xhM9zDEG1U2/XOmfyPkyZnvvztrpgV4SVflYGGSXQwQ9BeXxYgRIPhzrd6lPp33cNQWZJlbvIKlwkFjry/8GhQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simplelightbox/2.14.2/simple-lightbox.min.css" integrity="sha512-FaAQujRxLMvw+BkmGN3w7u9EdQQr1t0vQoY8KDh09+6SFaWSTe+KrT8oCWg25X91hytm5c5BTmiSGQejkraaZg==" crossorigin="anonymous" referrerpolicy="no-referrer">

<script type="text/javascript" src="https://play.vidyard.com/embed/v4.js" defer></script>
<script type="text/javascript" src="https://www.reversinglabs.com/hs-fs/hub/3375217/hub_generated/template_assets/139051314810/1729069607377/Redesign_2023/js/functions.min.js"></script></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="/hs/hsstatic/content-cwv-embed/static-1.1293/embed.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://www.reversinglabs.com/hs-fs/hub/3375217/hub_generated/module_assets/149435964191/1712214122331/module_149435964191_Site_Search_Input_-_stage.min.js"></script>

    <!--[if lte IE 8]>
    <script charset="utf-8" src="https://js.hsforms.net/forms/v2-legacy.js"></script>
    <![endif]-->

<script data-hs-allowed="true" src="/_hcms/forms/v2.js"></script>

    <script data-hs-allowed="true">
        var options = {
            portalId: '3375217',
            formId: 'e23cfb45-bf85-4928-8983-102133f2cc3a',
            formInstanceId: '5322',
            
            pageId: '45964042507',
            
            region: 'na1',
            
            
            
            
            pageName: "Spotting malicious Excel4 macros",
            
            
            
            inlineMessage: "<p>Thanks for signing up! You can expect our weekly newsletter every Thursday with the latest RL blogs, security news, and more!<\/p>",
            
            
            rawInlineMessage: "<p>Thanks for signing up! You can expect our weekly newsletter every Thursday with the latest RL blogs, security news, and more!<\/p>",
            
            
            hsFormKey: "14253f6ab1a5255c60e0b4c69eac1568",
            
            
            css: '',
            target: '#hs_form_target_form_516376731',
            
            
            
            
            
            
            
            contentType: "blog-post",
            
            
            
            formsBaseUrl: '/_hcms/forms/',
            
            
            
            formData: {
                cssClass: 'hs-form stacked hs-custom-form'
            }
        };

        options.getExtraMetaDataBeforeSubmit = function() {
            var metadata = {};
            

            if (hbspt.targetedContentMetadata) {
                var count = hbspt.targetedContentMetadata.length;
                var targetedContentData = [];
                for (var i = 0; i < count; i++) {
                    var tc = hbspt.targetedContentMetadata[i];
                     if ( tc.length !== 3) {
                        continue;
                     }
                     targetedContentData.push({
                        definitionId: tc[0],
                        criterionId: tc[1],
                        smartTypeId: tc[2]
                     });
                }
                metadata["targetedContentMetadata"] = JSON.stringify(targetedContentData);
            }

            return metadata;
        };

        hbspt.forms.create(options);
    </script>



<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.reversinglabs.com\/blog\/spotting-malicious-excel4-macros"]);
_hsq.push(["setPageId", "45964042507"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 45964042507,
    "legacyPageId": "45964042507",
    "contentFolderId": null,
    "contentGroupId": 5901382633,
    "abTestId": null,
    "languageVariantId": 45964042507,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3375217.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "befd7216-39c9-4d4b-b26c-99a2ad68c68e",
    ticks: 1741448051215,
    page_id: 45964042507,
    
    content_group_id: 5901382633,
    portal_id: 3375217,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    
    analytics_page_id: "45964042507",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.432/js/index.js"></script>

<script>
  (function () {
    var zi = document.createElement('script');
    zi.type = 'text/javascript';
    zi.async = true;
    zi.src = 'https://ws.zoominfo.com/pixel/JrRu3vUM8j33QSR7Bwxw';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(zi, s);
  })();
</script>
<noscript>
  <img src="https://ws.zoominfo.com/pixel/JrRu3vUM8j33QSR7Bwxw" width="1" height="1" style="display: none;">
</noscript>
<script>
(function(w, d, c) {w['techtargetic'] = w['techtargetic'] || {};w['techtargetic'].client = c;var s = d.createElement("script");s.type = "text/javascript";s.async = !0;s.crossorigin = "anonymous";var rd = new Date();rd=rd.getFullYear()+''+rd.getMonth()+rd.getDate();s.src = "https://trk.techtarget.com/tracking.js";var n = d.getElementsByTagName("script")[0];n.parentNode.insertBefore(s, n);})(window, document, '4981423');
</script>  

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

</body></html>