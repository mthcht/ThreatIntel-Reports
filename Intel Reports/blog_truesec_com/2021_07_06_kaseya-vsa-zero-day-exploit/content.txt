<!DOCTYPE html>

<html lang="en-GB" class="wp-singular post-template-default single single-post postid-3923 single-format-standard wp-theme-truesec no-js">

	<head>

		<script src="https://www.truesec.com/wp-admin/admin-ajax.php?action=pll_xdata_check&#038;redirect=https%3A%2F%2Fwww.truesec.com%2Fhub%2Fblog%2Fkaseya-vsa-zero-day-exploit&#038;nonce=bf178b5e2b" async></script>	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script>document.documentElement.classList.replace('no-js', 'js');</script><meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v26.1.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>How the Kaseya VSA Zero Day Exploit Worked - Truesec</title>
	<meta name="description" content="Learn about the pre-auth remote code execution exploit against Kaseya VSA Server that was used in the mass Revil ransomware attack on July 2, 2021." />
	<link rel="canonical" href="https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit" />
	<meta property="og:locale" content="en_GB" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="How the Kaseya VSA Zero Day Exploit Worked - Trulysuper" />
	<meta property="og:description" content="Learn about the pre-auth remote code execution exploit against Kaseya VSA Server that was used in the mass Revil ransomware attack on July 2, 2021." />
	<meta property="og:url" content="https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit" />
	<meta property="og:site_name" content="Truesec" />
	<meta property="article:publisher" content="https://www.facebook.com/Truesec/" />
	<meta property="article:published_time" content="2021-07-06T11:14:00+00:00" />
	<meta property="og:image" content="https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059.jpg" />
	<meta property="og:image:width" content="2309" />
	<meta property="og:image:height" content="1299" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="siteadmin" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:title" content="How the Kaseya VSA Zero Day Exploit Worked - Trulysuper" />
	<meta name="twitter:creator" content="@Truesec" />
	<meta name="twitter:site" content="@Truesec" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="siteadmin" />
	<meta name="twitter:label2" content="Estimated reading time" />
	<meta name="twitter:data2" content="7 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"TechArticle","@id":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit#article","isPartOf":{"@id":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit"},"author":{"name":"siteadmin","@id":"https://www.truesec.com/#/schema/person/41ddf857e816a27eb8f378782f7ffaaa"},"headline":"How the Kaseya VSA Zero-Day Exploit Worked","datePublished":"2021-07-06T11:14:00+00:00","mainEntityOfPage":{"@id":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit"},"wordCount":1368,"commentCount":0,"publisher":{"@id":"https://www.truesec.com/#organization"},"image":{"@id":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit#primaryimage"},"thumbnailUrl":"https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059.jpg","articleSection":["Cybersecurity","Threat Intelligence"],"inLanguage":"en-GB","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit#respond"]}]},{"@type":"WebPage","@id":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit","url":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit","name":"How the Kaseya VSA Zero Day Exploit Worked - Truesec","isPartOf":{"@id":"https://www.truesec.com/#website"},"primaryImageOfPage":{"@id":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit#primaryimage"},"image":{"@id":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit#primaryimage"},"thumbnailUrl":"https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059.jpg","datePublished":"2021-07-06T11:14:00+00:00","description":"Learn about the pre-auth remote code execution exploit against Kaseya VSA Server that was used in the mass Revil ransomware attack on July 2, 2021.","breadcrumb":{"@id":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit#breadcrumb"},"inLanguage":"en-GB","potentialAction":[{"@type":"ReadAction","target":["https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit"]}]},{"@type":"ImageObject","inLanguage":"en-GB","@id":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit#primaryimage","url":"https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059.jpg","contentUrl":"https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059.jpg","width":2309,"height":1299},{"@type":"BreadcrumbList","@id":"https://www.truesec.com/hub/blog/kaseya-vsa-zero-day-exploit#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.truesec.com/"},{"@type":"ListItem","position":2,"name":"Insights","item":"https://www.truesec.com/hub/blog"},{"@type":"ListItem","position":3,"name":"How the Kaseya VSA Zero-Day Exploit Worked"}]},{"@type":"WebSite","@id":"https://www.truesec.com/#website","url":"https://www.truesec.com/","name":"Truesec","description":"Experts in cybersecurity","publisher":{"@id":"https://www.truesec.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.truesec.com/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-GB"},{"@type":"Organization","@id":"https://www.truesec.com/#organization","name":"Truesec AB","url":"https://www.truesec.com/","logo":{"@type":"ImageObject","inLanguage":"en-GB","@id":"https://www.truesec.com/#/schema/logo/image/","url":"https://www.truesec.com/wp-content/uploads/2023/09/site-logo.svg","contentUrl":"https://www.truesec.com/wp-content/uploads/2023/09/site-logo.svg","width":171,"height":26,"caption":"Truesec AB"},"image":{"@id":"https://www.truesec.com/#/schema/logo/image/"},"sameAs":["https://www.facebook.com/Truesec/","https://x.com/Truesec","https://www.linkedin.com/company/truesec/","https://www.youtube.com/channel/UCIAtgUfBYGSWoUvgG3293Ug"]},{"@type":"Person","@id":"https://www.truesec.com/#/schema/person/41ddf857e816a27eb8f378782f7ffaaa","name":"siteadmin","image":{"@type":"ImageObject","inLanguage":"en-GB","@id":"https://www.truesec.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/98bda5fdef9a986d58cba3cdad57f4850c1212a96b90eb9cadaf558fe3b1e4d9?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/98bda5fdef9a986d58cba3cdad57f4850c1212a96b90eb9cadaf558fe3b1e4d9?s=96&d=mm&r=g","caption":"siteadmin"},"sameAs":["https://www.truesec.com"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='stylesheet' id='wp-block-library-css' href='https://www.truesec.com/wp-includes/css/dist/block-library/style.min.css?ver=6.8.2' media='all' />
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='sleek-css' href='https://www.truesec.com/wp-content/themes/truesec/dist/app.css?ver=1757927528' media='all' />

		<!-- Google Tag Manager -->
		<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s);j.async=true;j.src="https://gtm.truesec.com/lniqiqybn.js?"+i;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','lfB=aWQ9R1RNLUsyVk1GOEQ%3D&amp;cgm=nmB');</script>
		<!-- End Google Tag Manager -->
		<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://gtm.truesec.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-K2VMF8D');</script>
<!-- End Google Tag Manager --><script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/26747823.js"></script><link rel="icon" href="https://www.truesec.com/wp-content/uploads/2023/09/favicon.svg" sizes="32x32" />
<link rel="icon" href="https://www.truesec.com/wp-content/uploads/2023/09/favicon.svg" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.truesec.com/wp-content/uploads/2023/09/favicon.svg" />
<meta name="msapplication-TileImage" content="https://www.truesec.com/wp-content/uploads/2023/09/favicon.svg" />
		<style id="wp-custom-css">
			.page-id-136651 {
background-color: black;
}		</style>
		
	</head>

	<body>

		<header id="site-header">

	<a href="https://www.truesec.com/" class="site-logo"><svg xmlns="http://www.w3.org/2000/svg" fill="#1C1D1D" viewBox="0 0 171 26">
	<title>Truesec</title>
	<path d="M40.2934 25.5623h8.3259l-4.5648-8.9297.1902-.0904c1.3504-.6562 4.4887-2.7008 4.4887-7.54131 0-5.92465-4.5124-8.573156-8.9821-8.573156H26.3281V25.5623h7.3179v-8.0358h3.1382l3.5092 8.0358ZM33.646 6.75656h4.9118c1.6595 0 2.7341.8654 2.7341 2.19678 0 1.65476-1.474 2.23956-2.7341 2.23956H33.646V6.75656ZM63.4876 25.9998c4.018 0 7.0374-1.0271 8.9679-3.0527 1.726-1.8069 2.6009-4.4126 2.6009-7.7363V.408691h-7.4415V15.0016c0 1.9781-.4279 4.6028-4.132 4.6028-2.8625 0-4.3793-1.5929-4.3793-4.6028V.408691h-7.4415V15.2489c0 3.2904.9177 5.8818 2.7246 7.7077 2.0066 2.0209 5.0688 3.0432 9.1009 3.0432Zm58.6814-8.6918c0-6.1434-6.196-7.32261-10.294-8.10242l-.1-.01902c-2.306-.46123-3.833-.76554-3.833-1.72128 0-.91295.709-1.35516 2.159-1.35516 2.587 0 5.359.91295 7.461 2.44879l3.889-5.14484c-2.796-2.22531-6.438-3.395027-10.546-3.395027-5.012 0-10.399 2.586687-10.399 8.264077 0 6.52378 6.205 7.64118 10.308 8.37818l.167.0286c2.187.3708 3.766.6419 3.766 1.6214 0 .989-1.137 1.5834-3.044 1.5834-3.024 0-6-1.1555-8.207-3.1811l-3.7274 5.3874c2.9624 2.6057 6.7564 3.8752 11.5874 3.8752 6.771.0048 10.813-3.2381 10.813-8.6682Zm48.723 1.5406-6.267-2.9005c-.689 1.8449-2.596 3.6422-5.054 3.6422-3.719 0-6.415-2.7768-6.415-6.5998 0-3.82298 2.696-6.59986 6.415-6.59986 2.434 0 4.346 1.79736 5.05 3.64226l6.271-2.92427C169.656 4.37454 166.584 0 159.571 0c-3.871 0-7.385 1.27432-9.895 3.59473-2.587 2.38698-3.956 5.64411-3.956 9.41957 0 3.7041 1.407 7.0373 3.956 9.391 2.515 2.3204 6.029 3.5995 9.895 3.5995 6.956-.0048 10.061-4.3984 11.321-7.1562ZM97.4331.427734H78.4609V25.5623h18.9722v-6.3288H85.7978v-3.2096h9.9093V9.98516h-9.9093v-3.2286h11.6353V.427734ZM143.656.394531h-19.019V25.5957h19.019v-6.3478h-11.663v-3.2144h9.933V9.97573h-9.933V6.74237h11.663V.394531ZM22.8665.418457H0V6.77581h1.00329l7.03731.02377V25.5721h7.3274V6.79958l7.4985-.02377h.504V.418457h-.504Z"/>
</svg></a>
			<nav>
							<ul class="menu menu-primary menu-site-header-primary"><li><a href="https://www.truesec.com/cybersecurity-platform">AI Platform</a></li>
<li class="dropdown"><a href="https://www.truesec.com/service">Services</a><ul class="sub-menu has-dropdown"><li class="intro"><strong>Services</strong><span>We offer cyber breach management services across all affected areas. Connect with a cybersecurity consultant for further details.</span><a href="https://www.truesec.com/service" class="button">Services</a></li>	<li class="dropdown"><a href="https://www.truesec.com/service/managed-detection-and-response">Managed Detection and Response (MDR)</a><ul class="sub-menu">		<li><a href="https://www.truesec.com/service/mdr-core">MDR Core</a></li>
		<li><a href="https://www.truesec.com/service/mdr-enterprise">MDR Enterprise</a></li>
		<li><a href="https://www.truesec.com/service/mdr-black">MDR Black</a></li>
	</ul>
</li>
	<li class="dropdown"><a href="https://www.truesec.com/digital-forensics-and-incident-response-dfir">Digital Forensics and Incident Response</a><ul class="sub-menu">		<li><a href="https://www.truesec.com/service/incident-response">Incident Response</a></li>
		<li><a href="https://www.truesec.com/service/security-incident-preparedness">Incident Preparedness</a></li>
		<li><a href="https://www.truesec.com/service/incident-response-exercises">Incident Response Exercise</a></li>
		<li><a href="https://www.truesec.com/service/incident-response-retain">Priority (IR) Retainer</a></li>
	</ul>
</li>
	<li class="dropdown"><a href="https://www.truesec.com/service/offensive-security">Offensive Security</a><ul class="sub-menu">		<li><a href="https://www.truesec.com/service/penetration-testing">Penetration Test</a></li>
		<li><a href="https://www.truesec.com/service/red-team-testing">Red Team</a></li>
		<li><a href="https://www.truesec.com/service/vulnerability-scanning">Vulnerability and Posture Management</a></li>
	</ul>
</li>
	<li class="dropdown"><a href="https://www.truesec.com/service/managed-threat-exposure">Threat Exposure Management</a><ul class="sub-menu">		<li><a href="https://www.truesec.com/service/mte-core">MTE Core</a></li>
		<li><a href="https://www.truesec.com/service/mte-enterprise">MTE Enterprise</a></li>
		<li><a href="https://www.truesec.com/service/mte-enterprise-plus">MTE Enterprise+</a></li>
	</ul>
</li>
	<li class="dropdown"><a href="https://www.truesec.com/service/cyber-intelligence">Cyber Intelligence</a><ul class="sub-menu">		<li><a href="https://www.truesec.com/service/human-threat">Insider Threats</a></li>
	</ul>
</li>
	<li class="dropdown"><a href="https://www.truesec.com/advisory-and-workshops">Cybersecurity Advisory &amp; Strategy</a><ul class="sub-menu">		<li><a href="https://www.truesec.com/cybersecurity-advisory-partnership">Advisory &#038; Partnership</a></li>
		<li><a href="https://www.truesec.com/cybersecurity-strategy-workshops">Strategy Workshops</a></li>
		<li><a href="https://www.truesec.com/service/grc">GRC (Governance, Risk, and Compliance)</a></li>
		<li><a href="https://www.truesec.com/service/improvements-mitigations">Security Improvements &#038; Mitigations</a></li>
	</ul>
</li>
	<li class="dropdown"><a href="https://www.truesec.com/service/cloud-security">Modern Cloud &#038; Application Security</a><ul class="sub-menu">		<li><a href="https://www.truesec.com/service/secure-identities-and-access">Secure Identities &amp; Access</a></li>
		<li><a href="https://www.truesec.com/service/protect-endpoints-and-devices">Protect Endpoints &amp; Devices</a></li>
		<li><a href="https://www.truesec.com/service/review-and-improve-cloud-posture">Review &#038; Improve Cloud Posture</a></li>
		<li><a href="https://www.truesec.com/service/secure-applications">Secure Applications</a></li>
	</ul>
</li>
	<li class="dropdown"><a href="https://www.truesec.com/service/iam-identity-management">Identity &#038; Access Management (IAM)</a><ul class="sub-menu">		<li><a href="https://www.truesec.com/service/iam-deployment">IAM Deployment</a></li>
	</ul>
</li>
</ul>
</li>
<li class="dropdown"><a href="https://www.truesec.com/solutions">Solutions</a><ul class="sub-menu"><li class="intro"><strong>Solutions</strong><span>Our solutions help security and IT teams address specific challenges.</span><a href="https://www.truesec.com/solutions" class="button">Read more</a></li>	<li class="has-desc"><a href="https://www.truesec.com/solutions/ot-security">Operation Technology (OT)<span>Complete solution for threat detection &#038; proactive OT risk mitigation</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/solutions/csam">CSAM<span>Detect and prevent Child Sexual Abuse Material (CSAM) and other illicit content effectively.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/solutions/vmware-security">VMware Security<span>Close critical gaps in visibility and protection for your on-prem systems.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/solutions/cyber-due-diligence">Cyber Due Diligence<span>Cybersecurity support for M&#038;A, from Cyber Due Diligence to Post-Merger Integration.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/solutions/stop-cyber-attacks-24-7">Stop Cyber Attacks 24/7<span>End-to-end threat detection and response with one trusted partner.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/solutions/reduce-your-attack-surface">Reduce Your Attack Surface<span>We help security teams identify and prioritize risks to protect critical assets.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/solutions/third-party-risk-management">Third Party Risk Management<span>Get full visibility into your supplier ecosystem, prioritize critical risks, and secure your supply chain.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/solutions/zero-trust">Zero Trust<span>Build your foundation with Zero Trust. Shift from a network-based to an identity-based security model.</span></a></li>
</ul>
</li>
<li class="dropdown active-ancestor"><a href="/security">Resources</a><ul class="sub-menu"><li class="intro"><strong>Resources</strong><span>Cybersecurity is becoming increasingly important in today’s world. Truesec providing explanations of a variety of cybersecurity topics.</span><a href="/security" class="button">Explore cyber topics</a></li>	<li class="active-parent has-desc"><a href="https://www.truesec.com/hub/blog">Insights<span>Discover the latest cybersecurity insights.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/webinars-and-events">Events and Webinars<span>Cybersecurity webinars and events for tech professionals and business leaders</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/cases">Cyber Stories<span>Explore unique cybersecurity stories shared by specially invited guests and customers.</span></a></li>
	<li class="has-desc"><a href="/m365-security-boost">Trainings<span>Expand your knowledge with hands-on sessions in cybersecurity.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/hub/guide">Guides<span>Check out our guides for valuable insights and effective strategies.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/hub/report">Reports<span>Get insights into the latest trends and observations in the security landscape.</span></a></li>
</ul>
</li>
<li class="dropdown"><a href="/contact/">Company</a><ul class="sub-menu"><li class="intro"><strong>Company</strong><span>We stay ahead of cybercriminals and find the best possible solution for you. We prevent breach and minimize impact.</span><a href="/contact/" class="button">Contact us</a></li>	<li class="has-desc"><a href="https://www.truesec.com/who-we-are">Who We Are<span>One partner for all cybersecurity solutions.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/experts">Our Experts<span>Industry-leading professionals with extensive experience and a passion for defending against cyber threats.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/news">Newsroom<span>Stay current with the latest Truesec news.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/career">Career<span>Join a highly skilled team of cybersecurity professionals.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/partner/technology-partners">Technology Partners<span>Together, we build a safer digital future.</span></a></li>
	<li class="has-desc"><a href="https://www.truesec.com/cybersecurity-center">Cybersecurity Center<span>A collaborative hub for innovation, sharing knowledge, and protecting society against digital threats.</span></a></li>
</ul>
</li>
</ul>			
							<ul class="menu menu-ctas menu-site-header-ctas"><li><a href="https://www.truesec.com/contact">Talk to us!</a></li>
<li><a href="https://www.truesec.com/incident">Under Attack?</a></li>
</ul>					</nav>
	
			<ul class="menu menu-secondary menu-site-header-secondary"><li><a href="https://soc.truesec.app">Login</a></li>
<li class="dropdown"><a href="#pll_switcher">English</a>
<ul class="sub-menu">
	<li class="lang-item lang-item-136 lang-item-de no-translation lang-item-first"><a href="https://de.truesec.com/" hreflang="de-DE" lang="de-DE">Deutsch</a></li>
	<li class="lang-item lang-item-80 lang-item-fi no-translation"><a href="https://www.truesec.fi/" hreflang="fi" lang="fi">Suomi</a></li>
	<li class="lang-item lang-item-169 lang-item-sv no-translation"><a href="https://www.truesec.se/" hreflang="sv-SE" lang="sv-SE">Svenska</a></li>
</ul>
</li>
</ul>	
	<a href="#site-header" aria-label="Open menu" data-toggle-hash></a>

</header>

<main>

		<section id="single-post" class="container--medium site-header--spacing">

		<header class="text--center">
							<p class="text--kicker ">Detailed description of the exploit in four steps</p>
			

			<h1>How the Kaseya VSA Zero-Day Exploit Worked</h1>

							<div class="wysiwyg"><p>This article explains the pre-auth remote code execution exploit against Kaseya VSA Server that was used in the mass Revil ransomware attack on July 2, 2021.</p>
</div>
			
			<ul class="meta">

																								<li>
							<ul class="experts">
																	<li>
																					<figure class="ratio--1-1">
												<a href="https://www.truesec.com/experts/alexander-andersson">
													<img width="480" height="480" src="https://www.truesec.com/wp-content/uploads/2024/03/Alexander-Andersson-Truesec-Expert-480x480.jpg" class="attachment-square_thumbnail size-square_thumbnail wp-post-image" alt="" decoding="async" fetchpriority="high" srcset="https://www.truesec.com/wp-content/uploads/2024/03/Alexander-Andersson-Truesec-Expert-480x480.jpg 480w, https://www.truesec.com/wp-content/uploads/2024/03/Alexander-Andersson-Truesec-Expert-960x960.jpg 960w, https://www.truesec.com/wp-content/uploads/2024/03/Alexander-Andersson-Truesec-Expert-1440x1440.jpg 1440w" sizes="(max-width: 480px) 100vw, 480px" />												</a>
											</figure>
										
										<a href="https://www.truesec.com/experts/alexander-andersson">Alexander Andersson</a>
									</li>
															</ul>
						</li>
									
				<li>
					<time datetime="2021-07-06">
						2021-07-06					</time>
				</li>

									<li>Insight</li>
							</ul>
		</header>

					<figure class="ratio--16-9">
				<img width="1920" height="1080" src="https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059-1920x1080.jpg" class="attachment-large size-large wp-post-image" alt="" decoding="async" srcset="https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059-1920x1080.jpg 1920w, https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059-960x540.jpg 960w, https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059-480x270.jpg 480w, https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059-1440x810.jpg 1440w, https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059-1536x864.jpg 1536w, https://www.truesec.com/wp-content/uploads/2023/11/iStock-1225230059-2048x1152.jpg 2048w" sizes="(max-width: 1920px) 100vw, 1920px" />			</figure>
		
			<nav id="share-page">

					<h2>Share</h2>
		
			<ul class="social-links">
					<li>
				<a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.truesec.comhub%2Fblog%2Fkaseya-vsa-zero-day-exploit" target="_blank" rel="noopener">
					Facebook				</a>
			</li>
					<li>
				<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.truesec.comhub%2Fblog%2Fkaseya-vsa-zero-day-exploit&text=How+the+Kaseya+VSA+Zero+Day+Exploit+Worked+-+TruesecTruesec" target="_blank" rel="noopener">
					Twitter				</a>
			</li>
					<li>
				<a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.truesec.comhub%2Fblog%2Fkaseya-vsa-zero-day-exploit&title=How+the+Kaseya+VSA+Zero+Day+Exploit+Worked+-+TruesecTruesec" target="_blank" rel="noopener">
					LinkedIn				</a>
			</li>
					<li>
				<a href="mailto:?subject=How the Kaseya VSA Zero Day Exploit Worked - TruesecTruesec&body=https://www.truesec.comhub/blog/kaseya-vsa-zero-day-exploit">
					Email				</a>
			</li>
			</ul>

	</nav>

		<div>

			<div class="wysiwyg"><p>On July 5, after an initial investigation of affected organizations, Truesec contacted Kaseya and provided a detailed technical write-up of these vulnerabilities along with forensic evidence of exploitation. Kaseya released the patch 9.5.7a (9.5.7.2994) that addresses the security issues on July 11.</p>
<p>We strongly believe this information will help the security community in their response to the attack and from a larger perspective it will help the industry understand what happened so we can address the underlying issues, and ultimately increase our capabilities to prevent future breaches.</p>
<h3>Overview</h3>
<p>The exploit abused four vulnerabilities in the Kaseya application that were chained as visualized in the figure below.</p>
<figure><img decoding="async" src="https://optimise2.assets-servd.host/jealous-emu/production/Blog/kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware-chain-4-1536x836.png?w=1536&#038;auto=compress%2Cformat&#038;fit=crop&#038;dm=1633331388&#038;s=60cda7da845659754f2beb0a84e0c6ca" alt="The exploit abused four vulnerabilities in the Kaseya application that were chained as visualized here" /></figure>
<h2>The High-Level Steps of the Exploit</h2>
<ol>
<li>Obtained an authenticated session by abusing a flaw in the authentication logic [<a href="http://cwe.mitre.org/data/definitions/304.html">CWE-304</a>] in /dl.asp.</li>
<li>Uploaded the revil ransomware (agent.crt) through an unrestricted upload vulnerability [<a href="http://cwe.mitre.org/data/definitions/434.html">CWE-434</a>] while also bypassing the request forgery protection [<a href="http://cwe.mitre.org/data/definitions/352.html">CWE-352</a>] in /cgi-bin/KUpload.dll.</li>
<li>Uploaded the ASP payload (screenshot.jpg) in the same fashion as described in 2.</li>
<li>Invoked the payload in screenshot.jpg through a local code injection vulnerability [<a href="http://cwe.mitre.org/data/definitions/94.html">CWE-94</a>] in userFilterTableRpt.asp.</li>
<li>Created Kaseya procedures to copy files and execute the ransomware.</li>
<li>Executed the procedures.</li>
<li>Removed logs and other forensic evidence.</li>
</ol>
<p>Here we will focus on the exploit and describe steps 1 through 4 in detail. <br />The payloads are not in scope for this article.</p>
<h2>Step 1 – Bypassing Authentication [CWE-304]</h2>
<p>The threat actor first sent a POST request to the resource /dl.asp with the POST data userAgentGuid=<em>guid</em>.</p>
<figure><img decoding="async" src="https://optimise2.assets-servd.host/jealous-emu/production/Blog/kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware-exploit-1.png?w=417&#038;auto=compress%2Cformat&#038;fit=crop&#038;dm=1633331388&#038;s=8f9a7034a598b5553f440b161e54aefa" alt="kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware-exploit-1-1" /><figcaption>First request of the exploit: authentication bypass</figcaption></figure>
<p>In dl.asp, userAgentGuid is used in a SELECT query to lookup the database row of the agent. The agentGuid must exist due to the subsequent <em>if</em> statement. The threat actor used the agentGuid of the agent on the VSA server itself (more on this below).</p>
<p>After the lookup, dl.asp tries to see if the provided password matches the values stored in the database for that agent. The provided password is then compared in several different ways. The login flow is illustrated in the <strong>pseudo code </strong>below:</p>
<p>if password == hash(row[nextAgentPassword] + row[agentGuidStr]) <br /> login ok <br />elseif password == hash(row[curAgentPassword] + row[agentGuidStr])<br /> login ok<br />elseif password == hash(row[nextAgentPassword] + row[displayName])<br /> login ok<br />elseif password == hash(row[curAgentPassword] + row[displayName])<br /> login ok<br />elseif password == row[password]<br /> login failed <br />else <br /> login ok</p>
<p>The last two statements are where the interesting thing happens. In case the password equals row[password] the login will fail. <strong>However, in the case that all checks failed</strong>, it would default to an <em>else</em> clause that sets “loginOK” to <em>true</em>.</p>
<p>Because no password was provided in the request, the “password” variable would be NULL and loginOK would end up being <em>true</em>. When loginOK is set to <em>true</em>, the application sends the login session cookie and will eventually (if no other parameters are provided like in the attacker’s request) end up in an <em>if </em>clause that returns 302 redirect to the userPortal.</p>
<figure><img decoding="async" src="https://optimise2.assets-servd.host/jealous-emu/production/Blog/image-14-768x308.png?w=768&#038;auto=compress%2Cformat&#038;fit=crop&#038;dm=1633331400&#038;s=0d721937aa7cd434dd9f18fe4521b4d2" alt="Response to authentication bypass request" /><figcaption>Response to authentication bypass request</figcaption></figure>
<h3>How Did the Actor Obtain the AgentGuid?</h3>
<p>The outstanding question is how the threat actor obtained around 60 (estimated number of VSA victims) unique valid agentGuids. It appears they simply knew the agentGuids before launching the attack.</p>
<p>Truesec has discovered several methods the attack could have been performed without prior knowledge of a valid agentGuid. An example that was also fixed in 9.5.7a is that the userAgentGuid parameter could have been &lt;vsa_server_hostname&gt;.root.kserver instead of an actual agentGuid. Due to what was described as legacy code, in case agentGuid is not a number, it will lookup the agentGuid automatically from the table <em>machNameTab</em>.</p>
<p>Truesec has not found and is not aware of any public evidence that shows exactly how these agentGuids were obtained. Possibly, these random agentGuids might have been what limited the impact of the attack to under 60 out of around 35 000 Kaseya VSA customers.</p>
<h2>Steps 2 and 3 – Uploading Files [CWE-434] [CWE-352]</h2>
<p>All requests from this point on used the authenticated session obtained in step one.</p>
<p>The threat actor started the upload by sending a GET request to /done.asp without any parameters. When receiving the request, the application creates a row in the tempData table, stages an upload folder, and finally returns a so-called <em>loadKey </em>value. A valid loadkey is required to perform the file upload.</p>
<figure><img decoding="async" src="https://optimise2.assets-servd.host/jealous-emu/production/Blog/kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware-exploit-2.png?w=531&#038;auto=compress%2Cformat&#038;fit=crop&#038;dm=1633331388&#038;s=efee7b6ad8577c4e7f6a60d6d1be95b3" alt="kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware-exploit-2" /><figcaption>Request and response to obtain a valid loadKey</figcaption></figure>
<p>To upload files the threat actor sent a multiform-data POST request to the resource /cgi-bin/KUpload.dll. The request contained the following parameters:</p>
<ul>
<li>FileName (name of the file)</li>
<li>FileData (content of the file to upload)</li>
<li>LoadKey (the value obtained by GETting done.asp)</li>
<li>RedirectPath (path that the application will redirect to after successful upload)</li>
<li>PathData (folder the file will be saved in)</li>
<li>__RequestValidationToken (bypassable CSRF token)</li>
</ul>
<h3>Bypassing the CSRF Protection</h3>
<p>The __RequestValidationToken was not properly validated. For example, the value “xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx” was accepted as a valid token.</p>
<h3>Uploading the Ransomware (Agent.crt)</h3>
<p>The first upload performed by the threat actor was a file named agent.crt. This file was an encoded version of the ransomware that was later pushed to all agents from the compromised VSA server.</p>
<figure><img decoding="async" src="https://optimise2.assets-servd.host/jealous-emu/production/Blog/upload-of-agent.png?w=1536&#038;auto=compress%2Cformat&#038;fit=crop&#038;dm=1633331381&#038;s=3dc9d9fbbf4888b6a1eb05385f62b84a" alt="upload of agent" /><figcaption>Upload of agent.crt.</figcaption></figure>
<p>Upon successful upload, the server returns HTTP 200 OK with a body containing a link pointing to /&lt;redirectPath&gt;?FileName=&lt;filename&gt;&amp;PathData=&lt;relative path&gt;&amp;originalName=&lt;filename&gt;&amp;FileSize=&lt;size&gt;&amp;TimeElapsed=&lt;time&gt;.</p>
<p>In this case, as the file upload was successful, the returned link was /done.asp?FileName=agent.crt&amp;PathData=WebPagesManagedFilesVSATicketFiles&amp;originalName=agent.crt&amp;FileSize=1221630&amp;TimeElapsed=00:00:00.828</p>
<h3>Uploading the ASP Payload (Screenshot.jpg)</h3>
<p>The threat actor uploaded another file named Screenshot.jpg. This was not a jpg file but rather a text file containing ASP code. After obtaining another loadKey value from /done.asp the threat actor uploaded the file. Partial contents of the request can be seen in the figure below (unfortunately only a partial capture was obtained and the middle part of screenshot.jpg was missing).</p>
<figure><img decoding="async" src="https://optimise2.assets-servd.host/jealous-emu/production/Blog/kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware-exploit-3.png?w=732&#038;auto=compress%2Cformat&#038;fit=crop&#038;dm=1633331388&#038;s=c2e896e2dc6ca31907cca346b194795f" alt="kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware-exploit-3" /><figcaption>First part of uploaded screenshot.jpg.</figcaption></figure>
<figure><img decoding="async" src="https://optimise2.assets-servd.host/jealous-emu/production/Blog/image-5-1536x874.png?w=1536&#038;auto=compress%2Cformat&#038;fit=crop&#038;dm=1633331403&#038;s=88249d36e911202cc24f6c6efc358918" alt="Last part of uploaded screenshot.jpg." /><figcaption>Last part of uploaded screenshot.jpg.</figcaption></figure>
<p>The response body link in this case was /done.asp?FileName=Screenshot.jpg&amp;PathData=WebPagesManagedFilesVSATicketFiles&amp;originalName=Screenshot.jpg&amp;FileSize=6188&amp;TimeElapsed=00:00:00.016 which indicates that the file was successfully uploaded.</p>
<h2>Step 4 – Executing the Payload on the Server [CWE-94]</h2>
<p>Finally, the threat actor sent a POST request to /userFilterTableRpt.asp with the pageFilterSQLFile argument.</p>
<figure><img decoding="async" src="https://optimise2.assets-servd.host/jealous-emu/production/Blog/kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware-exploit-4.png?w=560&#038;auto=compress%2Cformat&#038;fit=crop&#038;dm=1633331388&#038;s=eacb311f7191c0b95a4714363e57cd40" alt="kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware-exploit-4 (1)" /><figcaption>Exploiting the code injection vulnerability.</figcaption></figure>
<p>Due to a flaw in userFilterTableRpt.asp, the contents of the specified file would be interpreted as ASP code as it was passed to the function <em>eval.</em> In this case, ManagedFiles/VSATicketFiles/Screenshot.jpg, the ASP code text file the threat actor just uploaded.</p>
<p>First, userFilterTableRpt.asp sets a variable from the POST parameter. Then it reads the contents of the specified file and passes it to eval, which will by definition interpret the value of the argument as code. The flow is illustrated in the <strong>pseudo code</strong> below:</p>
<p>f = open (pageFilterSQLFile) <br />c = read (f) <br />eval (c)</p>
<p>And that is it. The ASP payload was executed and started pushing out the ransomware, and we all know the story from there.</p>
<h2>Final Words</h2>
<p>After a patch has been made available to customers of Kaseya VSA, and after we have validated the patch to verify that the attack vector is no longer present, we believe it is time to share these details for the benefit of the community. </p>
<p>We strongly believe this information will help the security community in their response to the attack and from a larger perspective it will help the industry understand what happened so we can address the underlying issues, and ultimately increase our capabilities to prevent future breaches.</p>
<p><strong>Finally, a big thanks to everyone in the security community </strong>who shared their findings throughout this incident. We truly appreciate the collaborative spirit that ultimately benefits everyone.</p>
<h2>Timeline</h2>
<p>[2021-07-02] Threat actor exploited vulnerabilities in the wild to mass-deploy ransomware.<br />[2021-07-04] Truesec obtained evidence that was helpful to understand the exploit.<br />[2021-07-05] Truesec sent a detailed write-up of the vulnerabilities along with supporting forensic evidence to Kaseya.<br />[2021-07-11] Kaseya released a security patch.<br />[2021-07-12] Truesec validated the patch.<br />[2021-07-13] Truesec published this article.</p>
</div>

									
					</div>

					<footer class="term-list">
				<a class="text--term" href="https://www.truesec.com/hub/blog/category/cybersecurity">Cybersecurity</a>, <a class="text--term" href="https://www.truesec.com/hub/blog/category/threat-intelligence">Threat Intelligence</a>			</footer>
		
	</section>

	<section id="form" class="section bg--dark">

			<header class="module-header">

							<p class="text--kicker ">Stay ahead with cyber insights</p>
			
							<h2 class="text--mega">Newsletter</h2>
			
							<div class="wysiwyg">
					<p>Stay ahead in cybersecurity! Sign up for Truesec’s newsletter to receive the latest insights, expert tips, and industry news directly to your inbox. Join our community of professionals and stay informed about emerging threats, best practices, and exclusive updates from Truesec.</p>
				</div>
						
		</header>
	
	<div class="form">

		

	
			<div data-hs-form data-hs-form-portal-id="26747823" data-hs-form-form-id="58734250-c1e9-437d-aee6-0fea95037c3c" data-hs-form-redirect-url=""></div>
	
	</div>

</section>

						
</main>

		<footer id="site-footer" class="section bg--dark">

	<a href="https://www.truesec.com/" class="site-logo"><svg xmlns="http://www.w3.org/2000/svg" fill="#1C1D1D" viewBox="0 0 171 26">
	<title>Truesec</title>
	<path d="M40.2934 25.5623h8.3259l-4.5648-8.9297.1902-.0904c1.3504-.6562 4.4887-2.7008 4.4887-7.54131 0-5.92465-4.5124-8.573156-8.9821-8.573156H26.3281V25.5623h7.3179v-8.0358h3.1382l3.5092 8.0358ZM33.646 6.75656h4.9118c1.6595 0 2.7341.8654 2.7341 2.19678 0 1.65476-1.474 2.23956-2.7341 2.23956H33.646V6.75656ZM63.4876 25.9998c4.018 0 7.0374-1.0271 8.9679-3.0527 1.726-1.8069 2.6009-4.4126 2.6009-7.7363V.408691h-7.4415V15.0016c0 1.9781-.4279 4.6028-4.132 4.6028-2.8625 0-4.3793-1.5929-4.3793-4.6028V.408691h-7.4415V15.2489c0 3.2904.9177 5.8818 2.7246 7.7077 2.0066 2.0209 5.0688 3.0432 9.1009 3.0432Zm58.6814-8.6918c0-6.1434-6.196-7.32261-10.294-8.10242l-.1-.01902c-2.306-.46123-3.833-.76554-3.833-1.72128 0-.91295.709-1.35516 2.159-1.35516 2.587 0 5.359.91295 7.461 2.44879l3.889-5.14484c-2.796-2.22531-6.438-3.395027-10.546-3.395027-5.012 0-10.399 2.586687-10.399 8.264077 0 6.52378 6.205 7.64118 10.308 8.37818l.167.0286c2.187.3708 3.766.6419 3.766 1.6214 0 .989-1.137 1.5834-3.044 1.5834-3.024 0-6-1.1555-8.207-3.1811l-3.7274 5.3874c2.9624 2.6057 6.7564 3.8752 11.5874 3.8752 6.771.0048 10.813-3.2381 10.813-8.6682Zm48.723 1.5406-6.267-2.9005c-.689 1.8449-2.596 3.6422-5.054 3.6422-3.719 0-6.415-2.7768-6.415-6.5998 0-3.82298 2.696-6.59986 6.415-6.59986 2.434 0 4.346 1.79736 5.05 3.64226l6.271-2.92427C169.656 4.37454 166.584 0 159.571 0c-3.871 0-7.385 1.27432-9.895 3.59473-2.587 2.38698-3.956 5.64411-3.956 9.41957 0 3.7041 1.407 7.0373 3.956 9.391 2.515 2.3204 6.029 3.5995 9.895 3.5995 6.956-.0048 10.061-4.3984 11.321-7.1562ZM97.4331.427734H78.4609V25.5623h18.9722v-6.3288H85.7978v-3.2096h9.9093V9.98516h-9.9093v-3.2286h11.6353V.427734ZM143.656.394531h-19.019V25.5957h19.019v-6.3478h-11.663v-3.2144h9.933V9.97573h-9.933V6.74237h11.663V.394531ZM22.8665.418457H0V6.77581h1.00329l7.03731.02377V25.5721h7.3274V6.79958l7.4985-.02377h.504V.418457h-.504Z"/>
</svg></a>
	<div class="modules">
		<nav id="menu">

			<h2 class="h6">Truesec</h2>
	
	<ul class="menu menu-footer-menu"><li><a href="https://www.truesec.com/who-we-are">Who We Are</a></li>
<li><a href="https://www.truesec.com/experts">Our experts</a></li>
<li><a href="https://www.truesec.com/news">Newsroom</a></li>
<li><a href="https://www.truesec.com/business-policy">Business Policy</a></li>
</ul>
</nav>
<nav id="menu">

			<h2 class="h6">Career</h2>
	
	<ul class="menu menu-footer-menu-2"><li><a target="_blank" href="https://www.truesec.com/career">Career</a></li>
<li><a target="_blank" href="https://career.truesec.com/jobs">Job Openings</a></li>
<li><a target="_blank" href="https://career.truesec.com/departments">Departments</a></li>
</ul>
</nav>
<nav id="menu">

			<h2 class="h6">Knowledge</h2>
	
	<ul class="menu menu-footer-menu-3"><li><a href="https://www.truesec.com/threat-intelligence-report-2025">Download 2025 Threat Report</a></li>
<li><a href="https://insights.truesec.com/newsletter-signup">Sign up for newsletter</a></li>
<li><a href="https://www.truesec.com/hub/report">Reports</a></li>
<li><a href="https://www.truesec.com/hub/guide">Guides</a></li>
</ul>
</nav>
	</div>

			<h2 class="h6">Contact us</h2>
	
			<section class="locations">
			
				<div>
					<p><strong>Phone:</strong><br />
Sweden: <a href="tel:+468100010">+46 8 10 00 10</a><br />
Denmark: <a href="+45 28 88 28 87">+45 28 88 28 87</a></p>
<p><strong>E-mail:</strong><br />
<a href="mailto:hello@truesec.com">hello@truesec.com</a></p>
				</div>

			
				<div>
					<h3 class="h6">Sweden</h3>
<p><strong>Headquarters Stockholm</strong><br />
Luntmakargatan 18<br />
111 37 Stockholm</p>
				</div>

			
				<div>
					<p><strong>Malmö</strong><br />
Torggatan 4<br />
Seventh floor<br />
211 40 Malmö</p>
				</div>

			
				<div>
					<h3 class="h6">Finland</h3>
<p><strong>Truesec Oy</strong><br />
Keilaniementie 1<br />
02150 Espoo</p>
				</div>

			
				<div>
					<h3 class="h6">Denmark</h3>
<p><strong>Headquarters Copenhagen</strong><br />
Glentevej 69, 1.<br />
2400 Copenhagen</p>
				</div>

			
				<div>
					<p><strong>Aarhus</strong><br />
Truesec A/S<br />
Åbogade 13-15<br />
8200 Aarhus N</p>
				</div>

			
				<div>
					<h3 class="h6">Germany</h3>
<p><strong>Truesec GmbH</strong><br />
Rosenheimer Str. 143c<br />
81671 München</p>
				</div>

					</section>
	
	<div class="modules">
			<nav id="social-links">

					<header>
				<h2 class="h6">Follow us</h2>
			</header>
		
		<ul>
							<li>
					<a href="https://www.facebook.com/Truesec/" target="_blank" rel="noopener">
						Facebook					</a>
				</li>
							<li>
					<a href="https://twitter.com/Truesec" target="_blank" rel="noopener">
						X					</a>
				</li>
							<li>
					<a href="https://www.linkedin.com/company/truesec/" target="_blank" rel="noopener">
						LinkedIn					</a>
				</li>
							<li>
					<a href="https://www.youtube.com/channel/UCIAtgUfBYGSWoUvgG3293Ug" target="_blank" rel="noopener">
						YouTube					</a>
				</li>
					</ul>

	</nav>
<nav id="menu">

	
	<ul class="menu menu-footer-menu-4"><li><a rel="privacy-policy" href="https://www.truesec.com/privacy-and-terms">Truesec Group’s Web Privacy Notice</a></li>
<li><a href="https://www.truesec.com/cancellation-policy-truesec-events">Cancellation Policy for Events</a></li>
<li><a target="_blank" href="https://www.truesec.com/reporting-misconduct">Reporting Misconduct</a></li>
<li><a href="https://www.truesec.com/sitemap_index.xml">Sitemap</a></li>
</ul>
</nav>
	</div>

			<div class="footer-text">
			<p>© Truesec</p>
		</div>
	
</footer>
		<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/truesec\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K2VMF8D"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->			<script>
				if (window.navigator.userAgent.indexOf('MSIE') > 0 || window.navigator.userAgent.indexOf('Trident/') > 0) {
					var el = document.createElement('aside');

					el.id = 'outdated-browser-warning';
					el.innerHTML = '<strong>Oops!</strong> Your browser is not supported. For a richer browsing experience, please consider upgrading to a better, modern browser like <a href=\"https://www.google.com/chrome/\">Google Chrome</a>, <a href=\"https://www.mozilla.org/en-US/firefox/new/\">Mozilla Firefox</a>, <a href=\"https://support.apple.com/downloads/safari\">Safari</a>, <a href=\"https://www.opera.com/\">Opera</a> or <a href=\"https://www.microsoft.com/en-us/windows/microsoft-edge\">Microsoft Edge</a>.';

					document.body.appendChild(el);
				}
			</script>
			<script data-cookieconsent="ignore" src="https://www.truesec.com/wp-content/themes/truesec/dist/app.js?ver=1757927528" id="sleek-js"></script>
<script>
(function() {
				var expirationDate = new Date();
				expirationDate.setTime( expirationDate.getTime() + 31536000 * 1000 );
				document.cookie = "pll_language=en; expires=" + expirationDate.toUTCString() + "; path=/; secure; SameSite=None";
			}());

</script>

	</body>

</html>
