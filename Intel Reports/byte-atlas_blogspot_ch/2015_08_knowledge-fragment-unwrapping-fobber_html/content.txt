<!DOCTYPE html>
<html class='v2' dir='ltr' lang='de'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://byte-atlas.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://byte-atlas.blogspot.com/2015/08/knowledge-fragment-unwrapping-fobber.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="The Byte Atlas - Atom" href="https://byte-atlas.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="The Byte Atlas - RSS" href="https://byte-atlas.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="The Byte Atlas - Atom" href="https://www.blogger.com/feeds/1115086431737620172/posts/default" />

<link rel="alternate" type="application/atom+xml" title="The Byte Atlas - Atom" href="https://byte-atlas.blogspot.com/feeds/6682285486026942497/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrDD2TlS4skHblJuhEO5s9ZATE614gHglB0jm65E6V8SVz6buJmeG7nDXE_QCb1gIMj3COFL2dOtvCtQZsBmwJlpwUrdAhqnzra1AJdEqhRhKaE8XxpVWiMNgwqYriub7UpgICaO6FJ6_p/s640/fobber_ida_before.png' rel='image_src'/>
<meta content='http://byte-atlas.blogspot.com/2015/08/knowledge-fragment-unwrapping-fobber.html' property='og:url'/>
<meta content='Knowledge Fragment: Unwrapping Fobber' property='og:title'/>
<meta content='About two weeks ago I came across an interesting sample using an interesting anti-analysis pattern.  The anti-analysis technique can be best...' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrDD2TlS4skHblJuhEO5s9ZATE614gHglB0jm65E6V8SVz6buJmeG7nDXE_QCb1gIMj3COFL2dOtvCtQZsBmwJlpwUrdAhqnzra1AJdEqhRhKaE8XxpVWiMNgwqYriub7UpgICaO6FJ6_p/w1200-h630-p-k-no-nu/fobber_ida_before.png' property='og:image'/>
<title>The Byte Atlas: Knowledge Fragment: Unwrapping Fobber</title>
<style type='text/css'>@font-face{font-family:'Consolas';font-style:normal;font-weight:400;font-display:swap;src:url(//fonts.gstatic.com/l/font?kit=X7nm4bA-A_-9jbjWaza9xMk&skey=3d1eb1871fcc58a1&v=v19)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}</style>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Consolas;
color: #cccccc;
background: #292929 none repeat scroll top left;
padding: 0 40px 40px 40px;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #64dd00;
}
a:visited {
text-decoration:none;
color: #65cc00;
}
a:hover {
text-decoration:underline;
color: #65cc00;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 40px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 10px #333333;
box-shadow: 0 0 40px rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 10px;
}
.content-inner {
background-color: #333333;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 60px Consolas;
color: #ffffff;
text-shadow: -1px -1px 1px rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #ffffff;
}
.Header .description {
font-size: 140%;
color: #aaaaaa;
}
.header-inner .Header .titlewrapper {
padding: 22px 30px;
}
.header-inner .Header .descriptionwrapper {
padding: 0 30px;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 1px solid #404040;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #404040;
border-left: 0 solid #404040;
border-right: 0 solid #404040;
}
.tabs-inner .widget ul {
background: #222222 none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #404040;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #999999;
border-left: 1px solid #333333;
border-right: 0 solid #404040;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #ffffff;
background-color: #000000;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid #404040;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid #404040;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid #404040;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: transparent;
color: #e6f4db;
padding: inherit;
letter-spacing: inherit;
margin: inherit;
}
.main-inner {
padding-top: 30px;
padding-bottom: 30px;
}
.main-inner .column-center-inner {
padding: 0 15px;
}
.main-inner .column-center-inner .section {
margin: 0 15px;
}
.post {
margin: 0 0 25px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 0;
background: #111111;
border: 1px solid #111111;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 1px;
}
.post-body .tr-caption-container {
color: #cccccc;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #888888;
background-color: #303030;
border-bottom: 1px solid #444444;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid #404040;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #111111;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #303030;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid #404040;
}
.blog-pager {
background: transparent none no-repeat scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #333333;
padding: 5px;
}
.footer-outer {
border-top: 0 dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #333333;
}
.mobile-index-contents {
color: #cccccc;
}
.mobile-link-button {
background-color: #64dd00;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #000000;
color: #ffffff;
border-top: 1px solid #404040;
border-bottom: 1px solid #404040;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #404040;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1300px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1300px;
max-width: 1300px;
_width: 1300px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 300px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 300px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("300px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 300px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 300px;
margin-right: -300px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=1115086431737620172&amp;zx=a30f9b9b-d2ee-44d2-989d-2b5cc74ba5e4' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=1115086431737620172&amp;zx=a30f9b9b-d2ee-44d2-989d-2b5cc74ba5e4' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading variant-dark'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar/1115086431737620172?po\x3d6682285486026942497\x26origin\x3dhttps://byte-atlas.blogspot.com',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<a href='https://byte-atlas.blogspot.com/' style='display: block'>
<img alt='The Byte Atlas' height='143px; ' id='Header1_headerimg' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgULYb9qrOdiS74XgcvGlpHYDjhb35671j0-FtY7d1vgCguWsfW6LjPKp_hwTeOgHpuOl86-vOrFFGwYYcItv4c4j0tghCUgOFC_sWFqdgiHDNDm_QBeL__4rSfnbRn88NROhvqYh6q_bHq/s1600/blogger_long.png' style='display: block' width='650px; '/>
</a>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Spaltenübergreifend'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Hauptbereich'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>18.08.2015</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrDD2TlS4skHblJuhEO5s9ZATE614gHglB0jm65E6V8SVz6buJmeG7nDXE_QCb1gIMj3COFL2dOtvCtQZsBmwJlpwUrdAhqnzra1AJdEqhRhKaE8XxpVWiMNgwqYriub7UpgICaO6FJ6_p/s640/fobber_ida_before.png' itemprop='image_url'/>
<meta content='1115086431737620172' itemprop='blogId'/>
<meta content='6682285486026942497' itemprop='postId'/>
<a name='6682285486026942497'></a>
<h3 class='post-title entry-title' itemprop='name'>
Knowledge Fragment: Unwrapping Fobber
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-6682285486026942497' itemprop='description articleBody'>
About two weeks ago I came across an interesting sample using an interesting anti-analysis pattern.<br />
The anti-analysis technique can be best described as "runtime-only code decryption". This means prior to execution of a function, the code is decrypted, then executed and finally encrypted again, but with a different key.<br />
Malwarebytes has already published an <a href="https://blog.malwarebytes.org/intelligence/2015/06/elusive-hanjuan-ek-caught-in-new-malvertising-campaign/" target="_blank">analysis</a> on this family they called "Fobber".<br />
However, in this blog post I wanted to share how to "unwrap" the sample's encrypted functions for easier analysis. There is also another blog post detailing how to work around the string encryption. <br />
<br />
The sample and code related to this blog post can be found on <a href="https://bitbucket.org/byte_atlas/fobber_decryption" target="_blank">bitbucket</a>.<br />
<br />
<h3>
Fobber's Function Encryption Scheme</h3>
<br />
First off, let's have a look how Fobber looks in memory, visualized by IDA's function analysis:<br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrDD2TlS4skHblJuhEO5s9ZATE614gHglB0jm65E6V8SVz6buJmeG7nDXE_QCb1gIMj3COFL2dOtvCtQZsBmwJlpwUrdAhqnzra1AJdEqhRhKaE8XxpVWiMNgwqYriub7UpgICaO6FJ6_p/s1600/fobber_ida_before.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrDD2TlS4skHblJuhEO5s9ZATE614gHglB0jm65E6V8SVz6buJmeG7nDXE_QCb1gIMj3COFL2dOtvCtQZsBmwJlpwUrdAhqnzra1AJdEqhRhKaE8XxpVWiMNgwqYriub7UpgICaO6FJ6_p/s640/fobber_ida_before.png" width="404" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">IDA's first view on Fobber.</td></tr>
</tbody></table>
<br />
<br />
IDA only recognizes a handful of functions. Among these is the actual code decryption routine, as well as some code handling translating relevant addresses of the position independent code into absolute offsets.<br />
<br />
Next, a closer look at how the on-demand decryption/encryption of functions works:<br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgOJ7TmBqx9UTN1cRojzdHwpTJt9o-RqhfQeJPM2zp02DdB9fHnxkVVPWprlrAqDvucd6NoCrRvH15nZCY4mBrmN-pesV8hXa7a7THG9VhYR8Rhyphenhyphen1fi_SoaXALAFYmaf_UwrR-NU6I3SqM-/s1600/fobber_call_to_decryption.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="358" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgOJ7TmBqx9UTN1cRojzdHwpTJt9o-RqhfQeJPM2zp02DdB9fHnxkVVPWprlrAqDvucd6NoCrRvH15nZCY4mBrmN-pesV8hXa7a7THG9VhYR8Rhyphenhyphen1fi_SoaXALAFYmaf_UwrR-NU6I3SqM-/s640/fobber_call_to_decryption.png" width="640" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">The Fobber-encrypted function sub_95112A, starting with call to decryptFunctionCode.</td></tr>
</tbody></table>
<br />
We can see that function sub_95112A starts with a call to what I renamed "decryptFunctionCode":<br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhRoBqUKPXBLV00bKyLvqr0c6FLJEfOvLO2Kc4GnTtKrVrHIPGMoxXxUV8_RkUvePr4gwGth7oPhx8og_6rTaPWfmm6JyEI0wFsYW5VyYL9pwxZyDrzfN8rLaRzJf-GKpkfWimU0PrbiSZk/s1600/fobber_decrypt_code.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhRoBqUKPXBLV00bKyLvqr0c6FLJEfOvLO2Kc4GnTtKrVrHIPGMoxXxUV8_RkUvePr4gwGth7oPhx8og_6rTaPWfmm6JyEI0wFsYW5VyYL9pwxZyDrzfN8rLaRzJf-GKpkfWimU0PrbiSZk/s640/fobber_decrypt_code.png" width="576" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">Fobber's on-demand decryption code for functions, revealing the parameter offsets neccessary for decryption.</td></tr>
</tbody></table>
<br />
<br />
This function does not make use of the stack, thus it is surrounded by a simple pushad/popad prologue/epilogue. We can see that some references are made relative to the return address (initially put into esi by copying from [esp+20h]):<br />
<ul>
<li>Field [esi-7] contains a flag indicating whether or not the function is already decrypted.&nbsp;</li>
<li>Field [esi-8h] contains the single byte key for encryption, while&nbsp;</li>
<li>field [esi-Ah] contains the length of the encrypted function, stored xor'ed with 0x461F.</li>
</ul>
<br />
The actual cryptXorCode takes those values as parameters and then loops over the encrypted function body, xor'ing with the current key and then updating the key by rotating 3bit and adding 0x53.<br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg6B8wwguxufjQeIPoZOOgpSXB7-AlXZQVfnapCjvgVc4tmIhkU9wyIKEM_2A9_LYEEiXxqPvavDwtJ6gVZCmYquFbpdD107wdZuAJnKY43SDzC4nLYU6quI6e0DG0nscLMpvGFaO97_1uB/s1600/fobber_xor_function.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="602" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg6B8wwguxufjQeIPoZOOgpSXB7-AlXZQVfnapCjvgVc4tmIhkU9wyIKEM_2A9_LYEEiXxqPvavDwtJ6gVZCmYquFbpdD107wdZuAJnKY43SDzC4nLYU6quI6e0DG0nscLMpvGFaO97_1uB/s640/fobber_xor_function.png" width="640" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">Function for decrypting one function, given the neccessary parameters.</td></tr>
</tbody></table>
<br />
<br />
After decryption, our function makes a lot more sense and we can see the default function prologue (push ebp; mov ebp, esp) among other things. <br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgl0tR9UuzqwlTjuSSzUxJhBhWAJWjv622FXEMV4Nr6kEG35D-V0JffEcWREQouf1Afyr1a9pghyussSuycL1Fw5T86_QzbILlJJq9HP3OwO4NQ9uCnWYMALRPVoByIYJBg_6b9iziYsPzK/s1600/fobber_call_after_decryption.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="358" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgl0tR9UuzqwlTjuSSzUxJhBhWAJWjv622FXEMV4Nr6kEG35D-V0JffEcWREQouf1Afyr1a9pghyussSuycL1Fw5T86_QzbILlJJq9HP3OwO4NQ9uCnWYMALRPVoByIYJBg_6b9iziYsPzK/s640/fobber_call_after_decryption.png" width="640" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">The decrypted equivalent of function sub_95112A, revealing some "real" code.</td></tr>
</tbody></table>
<br />
<br />
Also note the parameters:<br />
<ul>
<li>0x951125 - key: 0x7B </li>
<li>0x951126 - length: 0x4629^0x461F -&gt; 0x36 bytes</li>
<li>0x951128 - encryption flag: 0x01 </li>
</ul>
<br />
So far so good. Now let's decrypt all of those functions automatically.<br />
<br />
<h3>
Decrypt All The Things </h3>
<br />
First, we want to find our decryption function. For all Fobber samples I looked at, the regex r"\x60\x8B.\x24\x20\x66" was delivering unique results for locating the decryption function.<br />
<br />
Next, we want to find all calls to this decryption function. For this we can use the regex r"\xE8" to find all potential "call rel_offset" instructions.<br />
Then we just need to do some address math and check if the call destination (calculated as: image_base + call_origin + relative_call_offset + 5) is equal to the address of our decryption function.<br />
Should this be the case, we can extract the parameters as described above and decrypt the code.<br />
<br />
We then only need to exchange the respective bytes in our binary with the decrypted bytes. In the following code I also set the decryption flag and fix the function ending with a "retn" (0xC3) instruction to ease IDA's job of identifying functions afterwards. Otherwise, rinse/repeat until all functions are decrypted.<br />
<br />
Code:<br />
<br />
<div style="background: #000;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: small;">#!/usr/bin/env python</span><br />
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: small;">import re<br />import struct<br /><br />def decrypt(buf, key):<br />&nbsp;&nbsp;&nbsp; decrypted = ""<br />&nbsp;&nbsp;&nbsp; for char in buf:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; decrypted += chr(ord(char) ^ key)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # rotate 3 bits<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key = ((key &gt;&gt; 3) | (key &lt;&lt; (8 - 3))) &amp; 0xFF<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key = (key + 0x53) &amp; 0xFF<br />&nbsp;&nbsp;&nbsp; return decrypted<br /><br />def replace_bytes(buf, offset, bytes):<br />&nbsp;&nbsp;&nbsp; return buf[:offset] + bytes + buf[offset + len(bytes):]<br /><br />def decrypt_all(binary, image_base):</span><br />
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: small;"><span style="color: cyan;">&nbsp;&nbsp;&nbsp; # locate decryption function<br />&nbsp;&nbsp;&nbsp; decrypt_function_offset = re.search(r"\x60\x8B.\x24\x20\x66", binary).start()</span><br /><span style="color: lime;">&nbsp;&nbsp;&nbsp; # locate all calls to decryption function</span></span><br />
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: small;"><span style="color: lime;">&nbsp;&nbsp;&nbsp; regex_call = r"\xe8(?P&lt;rel_call&gt;.{4})"<br />&nbsp;&nbsp;&nbsp; for match in re.finditer(regex_call, binary):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call_origin = match.start()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; packed_call = binary[call_origin + 1:call_origin + 1 + 4]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rel_call = struct.unpack("I", packed_call)[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call_destination = (image_base + call_origin + rel_call + 5) &amp; 0xFFFFFFFF<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if call_destination == image_base + decrypt_function_offset:</span><br /><span style="color: orange;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # decrypt function and replace/fix</span></span><br />
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: small;"><span style="color: orange;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; decrypted_flag = ord(binary[call_origin - 0x2])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if decrypted_flag == 0x0:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key = ord(binary[call_origin - 0x3])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size = struct.unpack("H", binary[call_origin - 0x5:call_origin - 0x3])[0] ^ 0x461F<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; buf = binary[call_origin + 0x5:call_origin + 0x5 + size]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; decrypted_function = decrypt(buf, key)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binary = replace_bytes(binary, call_origin + 0x5, decrypted_function)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binary = replace_bytes(binary, call_origin + len(decrypted_function), "\xC3")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binary = replace_bytes(binary, call_origin - 0x2, "\x01")</span><br />&nbsp;&nbsp;&nbsp; return binary</span><br />
<br />
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: small;">[...] </span><br />
<span style="font-size: small;"><br /></span>
</div>
IDA likes this this already better:<br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjnzZDgBniD4o58JDOrjzfkUGRHgXANQ4gf1zGzkpjPAiltRIpDXRyyUERhogsk2s4mvNj7cUKLuL0z1j5vA-gcR6RqZ4PElAnAmbyGhSBF8qJ15WKsoPD1pIymhlGu1P3tu0NwuQk2_4Ed/s1600/fobber_ida_after.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjnzZDgBniD4o58JDOrjzfkUGRHgXANQ4gf1zGzkpjPAiltRIpDXRyyUERhogsk2s4mvNj7cUKLuL0z1j5vA-gcR6RqZ4PElAnAmbyGhSBF8qJ15WKsoPD1pIymhlGu1P3tu0NwuQk2_4Ed/s640/fobber_ida_after.png" width="404" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">IDA's view on a code-decrypted Fobber sample.</td></tr>
</tbody></table>
<br />
<br />
However, we are not quite done yet, as IDA still barfs on a couple of functions. <br />
<h3>
Conclusion</h3>
After decrypting all functions, we can already start analyzing the sample effectively.<br />
But we are not quite done yet, and the <a href="http://byte-atlas.blogspot.com/2015/08/knowledge-fragment-fobber-inline-string.html">second post</a> looks closer at the inline usage of encrypted strings. <br />
<br />
<br />
sample used:<br />
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp; md5: 49974f869f8f5d32620685bc1818c957</span><br />
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp; sha256: 93508580e84d3291f55a1f2cb15f27666238add9831fd20736a3c5e6a73a2cb4</span><br />
<br />
<a href="https://bitbucket.org/byte_atlas/fobber_decryption" target="_blank">Repository with memdump + extraction code</a>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
</span>
<span class='post-timestamp'>
@
<meta content='http://byte-atlas.blogspot.com/2015/08/knowledge-fragment-unwrapping-fobber.html' itemprop='url'/>
<a class='timestamp-link' href='https://byte-atlas.blogspot.com/2015/08/knowledge-fragment-unwrapping-fobber.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2015-08-18T08:39:00-07:00'>08:39</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=1115086431737620172&postID=6682285486026942497&target=email' target='_blank' title='Diesen Post per E-Mail versenden'><span class='share-button-link-text'>Diesen Post per E-Mail versenden</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=1115086431737620172&postID=6682285486026942497&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=1115086431737620172&postID=6682285486026942497&target=twitter' target='_blank' title='Auf X teilen'><span class='share-button-link-text'>Auf X teilen</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=1115086431737620172&postID=6682285486026942497&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='In Facebook freigeben'><span class='share-button-link-text'>In Facebook freigeben</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=1115086431737620172&postID=6682285486026942497&target=pinterest' target='_blank' title='Auf Pinterest teilen'><span class='share-button-link-text'>Auf Pinterest teilen</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Labels:
<a href='https://byte-atlas.blogspot.com/search/label/decryption' rel='tag'>decryption</a>,
<a href='https://byte-atlas.blogspot.com/search/label/fobber' rel='tag'>fobber</a>,
<a href='https://byte-atlas.blogspot.com/search/label/reverse%20engineering' rel='tag'>reverse engineering</a>,
<a href='https://byte-atlas.blogspot.com/search/label/tinybanker' rel='tag'>tinybanker</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>1 Kommentar:</h4>
<div class='comments-content'>
<script async='async' src='' type='text/javascript'></script>
<script type='text/javascript'>
    (function() {
      var items = null;
      var msgs = null;
      var config = {};

// <![CDATA[
      var cursor = null;
      if (items && items.length > 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        var text = (entry &&
                    ((entry.content && entry.content.$t) ||
                     (entry.summary && entry.summary.$t))) ||
            '';
        if (entry && entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '<span class="deleted-comment">' + text + '</span>';
            }
          }
        }
        return text;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data && data.feed && data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author && entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid && pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&v=2&orderby=published&reverse=false&max-results=50';
          if (cursor) {
            url += '&published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length < 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              && comment.author.name == config.authorName
              && comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/comment/delete/'
               + config.blogId + '/' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox && (commentId !== replyParent)) {
          replybox.src = '';
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog && window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog && window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]>
  </script>
<div id='comment-holder'>
<div class="comment-thread toplevel-thread"><ol id="top-ra"><li class="comment" id="c3239301785811806972"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/02589518377434744671" rel="nofollow">VnSpl0it</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://byte-atlas.blogspot.com/2015/08/knowledge-fragment-unwrapping-fobber.html?showComment=1440005748036#c3239301785811806972">19. August 2015 um 10:35</a></span></div><p class="comment-content">Great, Thanks !</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="3239301785811806972">Antworten</a><span class="item-control blog-admin blog-admin pid-53692274"><a target="_self" href="https://www.blogger.com/comment/delete/1115086431737620172/3239301785811806972">Löschen</a></span></span></div><div class="comment-replies"><div id="c3239301785811806972-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Antworten</a></span></span><ol id="c3239301785811806972-ra" class="thread-chrome thread-expanded"><div></div><div id="c3239301785811806972-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="3239301785811806972">Antworten</a></div></ol></div></div><div class="comment-replybox-single" id="c3239301785811806972-ce"></div></li></ol><div id="top-continue" class="continue"><a class="comment-reply" target="_self">Kommentar hinzufügen</a></div><div class="comment-replybox-thread" id="top-ce"></div><div class="loadmore hidden" data-post-id="6682285486026942497"><a target="_self">Weitere laden...</a></div></div>
</div>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<p>
</p>
<a href='https://www.blogger.com/comment/frame/1115086431737620172?po=6682285486026942497&hl=de' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/681870030-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
<div id='backlinks-container'>
<div id='Blog1_backlinks-container'>
</div>
</div>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://byte-atlas.blogspot.com/2015/08/knowledge-fragment-fobber-inline-string.html' id='Blog1_blog-pager-newer-link' title='Neuerer Post'>Neuerer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://byte-atlas.blogspot.com/2015/04/kf-andromeda-bruteforcing.html' id='Blog1_blog-pager-older-link' title='Älterer Post'>Älterer Post</a>
</span>
<a class='home-link' href='https://byte-atlas.blogspot.com/'>Startseite</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Abonnieren
<a class='feed-link' href='https://byte-atlas.blogspot.com/feeds/6682285486026942497/comments/default' target='_blank' type='application/atom+xml'>Kommentare zum Post (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget Profile' data-version='1' id='Profile1'>
<h2>Über mich</h2>
<div class='widget-content'>
<a href='https://www.blogger.com/profile/03618704969898603993'><img alt='Mein Bild' class='profile-img' height='80' src='//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgp36G_Mlx8OBxSq4oQ4EDYKtPzcL9IlgN5DUi2KnLFKsPHm__gwCEZcNuY--e1Ir_Pk55QW3I5awobNMVouyjhIP9DehrGRKiSEeYS7mWQSvzmsqgGxxc9TzB5PWwbNM4/s1600/*' width='80'/></a>
<dl class='profile-datablock'>
<dt class='profile-data'>
<a class='profile-name-link g-profile' href='https://www.blogger.com/profile/03618704969898603993' rel='author' style='background-image: url(//www.blogger.com/img/logo-16.png);'>
ByteAtlas
</a>
</dt>
</dl>
<a class='profile-link' href='https://www.blogger.com/profile/03618704969898603993' rel='author'>Mein Profil vollständig anzeigen</a>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog-Archiv</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2018/'>
2018
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2018/05/'>
Mai
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2018/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2018/01/'>
Januar
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2017/'>
2017
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2017/05/'>
Mai
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2017/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2017/02/'>
Februar
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2015/'>
2015
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2015/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='posts'>
<li><a href='https://byte-atlas.blogspot.com/2015/08/knowledge-fragment-fobber-inline-string.html'>Knowledge Fragment: Fobber Inline String Decryption</a></li>
<li><a href='https://byte-atlas.blogspot.com/2015/08/knowledge-fragment-unwrapping-fobber.html'>Knowledge Fragment: Unwrapping Fobber</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2015/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2014/'>
2014
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://byte-atlas.blogspot.com/2014/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-1'></div>
</td>
<td class='columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-2'></div>
</td>
</tr>
</tbody>
</table>
<div class='sidebar no-items section' id='sidebar-right-3'></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Design "Einfach". Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/2074308869-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY6RaZQJtUW3ALslNDpc4KPncC7Xkg:1742863918234';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d1115086431737620172','//byte-atlas.blogspot.com/2015/08/knowledge-fragment-unwrapping-fobber.html','1115086431737620172');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '1115086431737620172', 'title': 'The Byte Atlas', 'url': 'https://byte-atlas.blogspot.com/2015/08/knowledge-fragment-unwrapping-fobber.html', 'canonicalUrl': 'http://byte-atlas.blogspot.com/2015/08/knowledge-fragment-unwrapping-fobber.html', 'homepageUrl': 'https://byte-atlas.blogspot.com/', 'searchUrl': 'https://byte-atlas.blogspot.com/search', 'canonicalHomepageUrl': 'http://byte-atlas.blogspot.com/', 'blogspotFaviconUrl': 'https://byte-atlas.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'de', 'localeUnderscoreDelimited': 'de', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The Byte Atlas - Atom\x22 href\x3d\x22https://byte-atlas.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22The Byte Atlas - RSS\x22 href\x3d\x22https://byte-atlas.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The Byte Atlas - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/1115086431737620172/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The Byte Atlas - Atom\x22 href\x3d\x22https://byte-atlas.blogspot.com/feeds/6682285486026942497/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/cbe0cd4e6298c445', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Link abrufen', 'key': 'link', 'shareMessage': 'Link abrufen', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': '\xdcber Facebook teilen', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': '\xdcber X teilen', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': '\xdcber Pinterest teilen', 'target': 'pinterest'}, {'name': 'E-Mail', 'key': 'email', 'shareMessage': 'E-Mail', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27de\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Mehr anzeigen', 'pageType': 'item', 'postId': '6682285486026942497', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrDD2TlS4skHblJuhEO5s9ZATE614gHglB0jm65E6V8SVz6buJmeG7nDXE_QCb1gIMj3COFL2dOtvCtQZsBmwJlpwUrdAhqnzra1AJdEqhRhKaE8XxpVWiMNgwqYriub7UpgICaO6FJ6_p/s72-c/fobber_ida_before.png', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrDD2TlS4skHblJuhEO5s9ZATE614gHglB0jm65E6V8SVz6buJmeG7nDXE_QCb1gIMj3COFL2dOtvCtQZsBmwJlpwUrdAhqnzra1AJdEqhRhKaE8XxpVWiMNgwqYriub7UpgICaO6FJ6_p/s640/fobber_ida_before.png', 'pageName': 'Knowledge Fragment: Unwrapping Fobber', 'pageTitle': 'The Byte Atlas: Knowledge Fragment: Unwrapping Fobber'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Bearbeiten', 'linkCopiedToClipboard': 'Link in Zwischenablage kopiert.', 'ok': 'Ok', 'postLink': 'Link zum Post'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Einfach', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'dark', 'variantId': 'dark'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Knowledge Fragment: Unwrapping Fobber', 'description': 'About two weeks ago I came across an interesting sample using an interesting anti-analysis pattern.  The anti-analysis technique can be best...', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrDD2TlS4skHblJuhEO5s9ZATE614gHglB0jm65E6V8SVz6buJmeG7nDXE_QCb1gIMj3COFL2dOtvCtQZsBmwJlpwUrdAhqnzra1AJdEqhRhKaE8XxpVWiMNgwqYriub7UpgICaO6FJ6_p/s640/fobber_ida_before.png', 'url': 'https://byte-atlas.blogspot.com/2015/08/knowledge-fragment-unwrapping-fobber.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 6682285486026942497}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/4022133125-lbx__de.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar-right-1', document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Wird geladen\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>