<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="initial-scale=1.0"/>
    <title>    Dissecting Smoke Loader | CERT Polska
</title>
    <link rel="canonical" href="https://cert.pl/en/posts/2018/07/dissecting-smoke-loader/">

    <link rel="icon" href="/theme/assets/img/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/theme/assets/css/fonts.css">

        <link rel="stylesheet" href="/theme/assets/css/style.min.css?fce8d152">

    <link rel="stylesheet" href="/theme/assets/css/pygment.css">
    <link rel="stylesheet" href="/theme/assets/css/legacy.css">
    <meta property="og:description" content="Smoke Loader (also known as Dofoil) is a relatively small, modular bot that is mainly used to drop various malware families. Even though itâs designed to drop other malware, it has some pretty hefty malware-like capabilities on its own. Despite being quite old, itâs still going strong, recently â¦">
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Dissecting Smoke Loader" />
    <meta property="og:image" content="https://cert.pl/uploads/2018/07/smoke-24.jpg" />

    <link rel="alternate" type="application/atom+xml" title="CERT Polska - Atom" href="/en/atom.xml">
    <link rel="alternate" type="application/rss+xml" title="CERT Polska - RSS" href="/en/rss.xml">

</head>
<body>

<script src="/theme/assets/js/jquery.js"></script>
<script src="/theme/assets/js/foundation.min.js"></script>

<script>
    $body = $('body');

    function changed_mobile(media) {
        if (media.matches) {
            window.mobile = true;
            window.desktop = false;
            $body.removeClass('desktop');
            $body.addClass('mobile');
        } else {
            window.mobile = false;
            window.desktop = true;
            $body.removeClass('mobile');
            $body.addClass('desktop');
        }
    }

    let media = window.matchMedia('(max-width: 800px)');
    media.addEventListener('change', changed_mobile);
    changed_mobile(media);
</script>

<style>
    @media (max-width: 800px) {
        .mobile-header { display: inherit; }
        .desktop-header { display: none; }
        
        .mobile-slider { display: inherit; }
        .desktop-slider { display: none; }
        .hide-mobile { display: none; }
        
        body {
            padding-top: 232px;
        }
    }

    @media (min-width: 800px) {
        .mobile-header { display: none; }
        .desktop-header { display: inherit; }
        
        .mobile-slider { display: none; }
        .desktop-slider { display: inherit; }
        .hide-desktop { display: none; }
    }

    .cta {
        border-radius: 8px;
        min-height: 44px;
        display: inline-block;
        padding: 10px 25px;
        transition: background-color ease-out 0.2s;
    }

    .cta > span {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        width: 100%;
    }

    .cta.primary {
        color: #FCFDFD !important;
        background-color: #155C25;
    }

    .cta.primary:hover {
        color: #FCFDFD !important;
        background-color: #1B7730;
    }

    .card.important {
        background-color: #121f28;
        color: #FCFDFD;
    }

    .card.important a {
        color: #ccfdcd !important;
    }

    .x-logo {
        background: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIiB0ZXh0LXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIiBpbWFnZS1yZW5kZXJpbmc9Im9wdGltaXplUXVhbGl0eSIgZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIHZpZXdCb3g9IjAgMCA1MTIgNTA5LjY0Ij48cmVjdCB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUwOS42NCIgcng9IjExNS42MSIgcnk9IjExNS42MSIvPjxwYXRoIGZpbGw9IiNmZmYiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTMyMy43NCAxNDguMzVoMzYuMTJsLTc4LjkxIDkwLjIgOTIuODMgMTIyLjczaC03Mi42OWwtNTYuOTMtNzQuNDMtNjUuMTUgNzQuNDNoLTM2LjE0bDg0LjQtOTYuNDctODkuMDUtMTE2LjQ2aDc0LjUzbDUxLjQ2IDY4LjA0IDU5LjUzLTY4LjA0em0tMTIuNjggMTkxLjMxaDIwLjAybC0xMjkuMi0xNzAuODJIMTgwLjRsMTMwLjY2IDE3MC44MnoiLz48L3N2Zz4=") no-repeat center center;
        width: 21px;
        height: 21px;
    }

    .linkedin-logo {
        background: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZGF0YS1zdXBwb3J0ZWQtZHBzPSIyNHgyNCIgZmlsbD0icmdiKDEwLCAxMDIsIDE5NCkiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZm9jdXNhYmxlPSJmYWxzZSI+CiAgICAgIDxwYXRoIGQ9Ik0yMC41IDJoLTE3QTEuNSAxLjUgMCAwMDIgMy41djE3QTEuNSAxLjUgMCAwMDMuNSAyMmgxN2ExLjUgMS41IDAgMDAxLjUtMS41di0xN0ExLjUgMS41IDAgMDAyMC41IDJ6TTggMTlINXYtOWgzek02LjUgOC4yNUExLjc1IDEuNzUgMCAxMTguMyA2LjVhMS43OCAxLjc4IDAgMDEtMS44IDEuNzV6TTE5IDE5aC0zdi00Ljc0YzAtMS40Mi0uNi0xLjkzLTEuMzgtMS45M0ExLjc0IDEuNzQgMCAwMDEzIDE0LjE5YS42Ni42NiAwIDAwMCAuMTRWMTloLTN2LTloMi45djEuM2EzLjExIDMuMTEgMCAwMTIuNy0xLjRjMS41NSAwIDMuMzYuODYgMy4zNiAzLjY2eiI+PC9wYXRoPgogICAgPC9zdmc+") no-repeat center center;
        width: 21px;
        height: 21px;
    }
</style>

<style>
    .mobile-header {
        top: 0;
        width: 100%;
        color: #FCFDFD;
        background-color: #212E3B;
        position: fixed;
        font-size: 130%;
        transition: background-color ease-out 0.2s;
        z-index: 10000;
    }
    
    .mobile-header .top {
        display: flex;
        flex-direction: column;
    }

    .mobile-header .logo {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTczIiBoZWlnaHQ9IjYwIiB2aWV3Qm94PSIwIDAgMTczIDYwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTA5LjMyOCAzOS40NTczSDExMy42MTdMMTE3LjQxIDQ0LjU4MDNMMTE3LjQ2MiA0NC41NTQ5VjM5LjQ1NzNIMTIwLjAzM1Y0Ni4zMTU0SDExNS45MjVMMTEyLjA4IDQxLjA3ODRIMTEyLjA0MVY0Ni4zMTU0SDEwOS4zMjJWMzkuNDU3M0gxMDkuMzI4Wk0xMjQuNDE4IDM5LjQ1NzNIMTI4LjA3TDEzMi4zNDYgNDYuMzE1NEgxMjguOTY0TDEyOC4yNDQgNDUuMDA0NkgxMjMuODc4TDEyMy4xNTggNDYuMzE1NEgxMjAuMTNMMTI0LjQxOCAzOS40NTczWk0xMjcuNTI0IDQzLjY2ODRMMTI2LjEyOSA0MC44MTg4SDEyNi4wODRMMTI0LjY1IDQzLjY2ODRIMTI3LjUzSDEyNy41MjRaTTEzMS4zOTQgNDQuMTgxM0gxMzQuNDIzQzEzNC40MjMgNDQuNDM0NiAxMzQuNTE5IDQ0LjYzNzMgMTM0Ljc4OSA0NC44Mzk5QzEzNS4wMDggNDUuMDEwOSAxMzUuNDEzIDQ1LjEyNDkgMTM2LjAwNCA0NS4xNTAyQzEzNi41NTEgNDUuMTUwMiAxMzYuOTU2IDQ1LjA5MzIgMTM3LjI2NSA0NC45NTM5QzEzNy41OCA0NC44Mzk5IDEzNy43NjYgNDQuNjY4OSAxMzcuNzY2IDQ0LjQ3MjZDMTM3Ljc2NiA0NC4zMjcgMTM3LjY4MyA0NC4xODc3IDEzNy41NDggNDQuMTA1M0MxMzcuNDEyIDQzLjk5MTQgMTM3LjIzMiA0My45MDkgMTM3LjAwNyA0My44NTJDMTM2LjgxNSA0My43OTUxIDEzNi41NTcgNDMuNzM4MSAxMzYuMzI2IDQzLjcwNjRDMTM2LjA1NiA0My42NDk0IDEzNS44MjQgNDMuNjI0MSAxMzUuNjA2IDQzLjU5MjRDMTM0Ljc1MSA0My40NTMxIDEzNC4wMjQgNDMuMzMyOCAxMzMuNDg0IDQzLjE5MzVDMTMyLjk4MyA0My4wNzk1IDEzMi41MzIgNDIuODgzMiAxMzIuMTM0IDQyLjYyMzVDMTMxLjc2NyA0Mi4zMzg2IDEzMS41ODcgNDEuOTk2NiAxMzEuNTg3IDQxLjU0MDdDMTMxLjU4NyA0MS4wMjc4IDEzMS43NjcgNDAuNjI4OCAxMzIuMTcyIDQwLjMxODVDMTMyLjU3NyA0MC4wMDE5IDEzMy4xMjQgMzkuNzQ4NiAxMzMuODM4IDM5LjYwM0MxMzQuNTE5IDM5LjQ2MzcgMTM1LjMyOSAzOS4zNzUgMTM2LjIzNiAzOS4zNzVDMTM3LjY4MyAzOS4zNzUgMTM4LjgwOCAzOS41NzEzIDEzOS40ODMgMzkuOTEzM0MxNDAuMjA5IDQwLjI1NTIgMTQwLjU2MyA0MC43NDI4IDE0MC41NjMgNDEuMzM4MVY0MS41NDA3SDEzNy41NDhDMTM3LjU0OCA0MS4yODExIDEzNy40NTEgNDEuMDg0OCAxMzcuMTgxIDQwLjk0NTVDMTM2LjkxMSA0MC43NzQ1IDEzNi41NTcgNDAuNzE3NSAxMzYuMTAxIDQwLjcxNzVDMTM1LjY5NiA0MC43MTc1IDEzNS4zODEgNDAuNzc0NSAxMzUuMTQ5IDQwLjkyMDFDMTM0Ljg3OSA0MS4wMzQxIDEzNC43NDQgNDEuMjA1MSAxMzQuNzQ0IDQxLjM3NjFDMTM0Ljc0NCA0MS43MTggMTM1LjMyOSA0MS45NzEzIDEzNi41NTcgNDIuMTQyM0MxMzcuMzY3IDQyLjI1NjMgMTM3Ljk1MyA0Mi4zMzg2IDEzOC4zNTggNDIuNDAxOUMxMzguNzYzIDQyLjQ4NDIgMTM5LjE2OCA0Mi41NzI5IDEzOS41NzMgNDIuNzEyMkMxMzkuOTkxIDQyLjg1MTUgMTQwLjMwNiA0My4wNTQyIDE0MC41NjMgNDMuMzA3NUMxNDAuNzk0IDQzLjUzNTQgMTQwLjkyOSA0My44Nzc0IDE0MC45NzQgNDQuMjQ0N0MxNDAuOTc0IDQ0Ljc1NzYgMTQwLjc0OSA0NS4xNTY1IDE0MC4zMzggNDUuNDk4NUMxMzkuODg4IDQ1Ljg0MDQgMTM5LjMwOSA0Ni4wNjg0IDEzOC41NzYgNDYuMjM5NEMxMzcuODYzIDQ2LjM3ODcgMTM3LjA0NiA0Ni40NTQ3IDEzNi4xODQgNDYuNDU0N0MxMzUuMTA0IDQ2LjQ1NDcgMTM0LjE5OCA0Ni4zNzg3IDEzMy41MjMgNDYuMjM5NEMxMzIuODQxIDQ2LjA2ODQgMTMyLjMwMSA0NS44MTUxIDEzMS45NDEgNDUuNDczMkMxMzEuNTc0IDQ1LjEzMTIgMTMxLjM5NCA0NC43MDY5IDEzMS4zOTQgNDQuMTk0TTE0MS4zMDIgMzkuNDdIMTQ0LjMxOFY0Mi40ODQySDE0NC4zNjlMMTQ3Ljc5NiAzOS40N0gxNTEuMjc1TDE0Ny41NzggNDIuNDg0MkwxNTEuNTk2IDQ2LjMyOEgxNDcuODg2TDE0NC4zNjkgNDIuNjgwNUgxNDQuMzE4VjQ2LjMyOEgxNDEuMzAyVjM5LjQ3WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEyOC41NTkgMTQuMzgwOEMxMjguNDA1IDE0LjIyODggMTI4LjE0NyAxMy45ODE5IDEyOCAxMy44Mjk5TDEyNy42MiAxMy40NTYzQzEyNy40NjYgMTMuMzA0MyAxMjcuMjE1IDEzLjMwNDMgMTI3LjA2MSAxMy40NTYzTDEyNS43MzYgMTQuNzYwOEMxMjUuNTgyIDE0LjkxMjcgMTI1LjU4MiAxNS4xNjYgMTI1LjczNiAxNS4zMThMMTI2LjExNiAxNS42OTE2QzEyNi4yNyAxNS44NDM2IDEyNi41MjcgMTYuMDk2OSAxMjYuNjgxIDE2LjI0ODlMMTMzLjM4MSAyMi44NDczQzEzMy41MzUgMjIuOTk5MyAxMzMuNTM1IDIzLjI0NjIgMTMzLjM4MSAyMy4zOTgyTDEyNi42ODEgMjkuOTk2NkMxMjYuNTI3IDMwLjE0ODYgMTI2LjI3NiAzMC4zOTU2IDEyNi4xMTYgMzAuNTUzOUwxMjUuNzM2IDMwLjkyNzVDMTI1LjU4MiAzMS4wNzk1IDEyNS41ODIgMzEuMzI2NSAxMjUuNzM2IDMxLjQ3ODRMMTI3LjA2MSAzMi43ODI5QzEyNy4yMTUgMzIuOTM0OSAxMjcuNDY2IDMyLjkzNDkgMTI3LjYyIDMyLjc4MjlMMTI4IDMyLjQwOTNDMTI4LjE1NCAzMi4yNTczIDEyOC40MTEgMzIuMDEwNCAxMjguNTU5IDMxLjg1ODRMMTM2LjIwNCAyNC4zMjkxQzEzNi4zNTggMjQuMTc3MSAxMzYuNDg3IDIzLjg3MzIgMTM2LjQ4NyAyMy42NTc5VjIyLjU4MTNDMTM2LjQ4NyAyMi4zNjYgMTM2LjM1OCAyMi4wNjIxIDEzNi4yMDQgMjEuOTEwMUwxMjguNTU5IDE0LjM4MDhaIiBmaWxsPSIjMjhBNzQ1Ii8+CjxwYXRoIGQ9Ik0xNTEuMTkxIDI5Ljg4MjhIMTM3LjcyN0MxMzcuNTA5IDI5Ljg4MjggMTM3LjMyOSAzMC4wNjAxIDEzNy4zMjkgMzAuMjc1NFYzMi4xMTgyQzEzNy4zMjkgMzIuMzMzNSAxMzcuNTA5IDMyLjUxMDggMTM3LjcyNyAzMi41MTA4SDE1MS4xOTFDMTUxLjQxIDMyLjUxMDggMTUxLjU5IDMyLjMzMzUgMTUxLjU5IDMyLjExODJWMzAuMjc1NEMxNTEuNTkgMzAuMDYwMSAxNTEuNDEgMjkuODgyOCAxNTEuMTkxIDI5Ljg4MjhaIiBmaWxsPSIjMjhBNzQ1Ii8+CjxwYXRoIGQ9Ik0zNS45Mjg0IDEzLjcxNThIMzAuOTc3N0MzMC43NTkxIDEzLjcxNTggMzAuNDExOSAxMy43ODU1IDMwLjIxMjUgMTMuODY3OEwzMC4wMDA0IDEzLjk1MDFDMjkuNzk0NiAxNC4wMzI0IDI5LjUwNTMgMTQuMjIyNCAyOS4zNTEgMTQuMzc0NEwyMS43MDYyIDIxLjkwMzdDMjEuNTUxOSAyMi4wNTU3IDIxLjQyMzMgMjIuMzU5NiAyMS40MjMzIDIyLjU3NDlWMjMuNjUxNEMyMS40MjMzIDIzLjg2NjcgMjEuNTUxOSAyNC4xNzA3IDIxLjcwNjIgMjQuMzIyN0wyOS4zNTEgMzEuODUyQzI5LjUwNTMgMzIuMDAzOSAyOS43OTQ2IDMyLjE5MzkgMzAuMDAwNCAzMi4yNzYyTDMwLjIxMjUgMzIuMzU4NkMzMC40MTE5IDMyLjQ0MDkgMzAuNzU5MSAzMi41MTA1IDMwLjk3NzcgMzIuNTEwNUgzNS45Mjg0QzM2LjE0NyAzMi41MTA1IDM2LjMyNyAzMi4zMzMyIDM2LjMyNyAzMi4xMTc5VjMwLjI3NTJDMzYuMzI3IDMwLjA1OTkgMzYuMTQ3IDI5Ljg4MjYgMzUuOTI4NCAyOS44ODI2SDMxLjUzMDZDMzEuMzEyIDI5Ljg4MjYgMzEuMDAzNCAyOS43NTU5IDMwLjg0OTEgMjkuNjAzOUwyNC41NDE3IDIzLjM5MThDMjQuMzg3NCAyMy4yMzk4IDI0LjM4NzQgMjIuOTkyOSAyNC41NDE3IDIyLjgzNDZMMzAuODQ5MSAxNi42MjI0QzMxLjAwMzQgMTYuNDcwNCAzMS4zMTIgMTYuMzQzOCAzMS41MzA2IDE2LjM0MzhIMzUuOTI4NEMzNi4xNDcgMTYuMzQzOCAzNi4zMjcgMTYuMTY2NSAzNi4zMjcgMTUuOTUxMlYxNC4xMDg0QzM2LjMyNyAxMy44OTMxIDM2LjE0NyAxMy43MTU4IDM1LjkyODQgMTMuNzE1OFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik01Mi40MjAyIDEzLjcxNThINDEuNTI4NUM0MS4zMDk5IDEzLjcxNTggNDEuMDAxMyAxMy44NDI1IDQwLjg1MzQgMTMuOTk0NEw0MC4wODgzIDE0Ljc1NDNDMzkuOTM0IDE0LjkwNjMgMzkuODA1NCAxNS4yMTAzIDM5LjgwNTQgMTUuNDI1NlYyMS40MTYxQzM5LjgwNTQgMjEuNjMxNCAzOS44MDU0IDIxLjgwODcgMzkuODA1NCAyMS44MDg3VjI0LjAzNzdDMzkuODA1NCAyNC4yNTMgMzkuODA1NCAyNC40MzAzIDM5LjgwNTQgMjQuNDMwM1YzMC44MTM0QzM5LjgwNTQgMzEuMDI4NyAzOS45MzQgMzEuMzMyNyA0MC4wODE5IDMxLjQ4NDdMNDAuODUzNCAzMi4yNDQ2QzQxLjAwNzcgMzIuMzk2NiA0MS4zMDk5IDMyLjUyMzIgNDEuNTI4NSAzMi41MjMySDUyLjQyMDJDNTIuNjM4OCAzMi41MjMyIDUyLjgxODggMzIuMzQ1OSA1Mi44MTg4IDMyLjEzMDZWMzAuMjg3OUM1Mi44MTg4IDMwLjA3MjUgNTIuNjM4OCAyOS44OTUyIDUyLjQyMDIgMjkuODk1Mkg0Mi44NTk1QzQyLjY0MDkgMjkuODk1MiA0Mi40NjA4IDI5LjcxNzkgNDIuNDYwOCAyOS41MDI2VjI0LjgyOTNDNDIuNDYwOCAyNC42MTQgNDIuNjQwOSAyNC40MzY3IDQyLjg1OTUgMjQuNDM2N0g0OS45MTkxQzUwLjEzNzcgMjQuNDM2NyA1MC4zMTc3IDI0LjI1OTQgNTAuMzE3NyAyNC4wNDQxVjIyLjIwNzZDNTAuMzE3NyAyMS45OTIzIDUwLjEzNzcgMjEuODE1IDQ5LjkxOTEgMjEuODE1SDQyLjg1OTVDNDIuNjQwOSAyMS44MTUgNDIuNDYwOCAyMS42Mzc3IDQyLjQ2MDggMjEuNDIyNFYxNi43NDkxQzQyLjQ2MDggMTYuNTMzOCA0Mi42NDA5IDE2LjM1NjUgNDIuODU5NSAxNi4zNTY1SDUyLjQyMDJDNTIuNjM4OCAxNi4zNTY1IDUyLjgxODggMTYuMTc5MSA1Mi44MTg4IDE1Ljk2MzhWMTQuMTIxMUM1Mi44MTg4IDEzLjkwNTggNTIuNjM4OCAxMy43Mjg1IDUyLjQyMDIgMTMuNzI4NSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTg1LjcwNTkgMTUuOTUxMlYxNC4xMDg0Qzg1LjcwNTkgMTMuODkzMSA4NS41MjU5IDEzLjcxNTggODUuMzA3MyAxMy43MTU4SDcyLjMzMjVDNzIuMTEzOSAxMy43MTU4IDcxLjkzMzggMTMuODkzMSA3MS45MzM4IDE0LjEwODRWMTUuOTUxMkM3MS45MzM4IDE2LjE2NjUgNzIuMTEzOSAxNi4zNDM4IDcyLjMzMjUgMTYuMzQzOEg3Ny4wOTAzQzc3LjMwODkgMTYuMzQzOCA3Ny40ODkgMTYuNTIxMSA3Ny40ODkgMTYuNzM2NFYzMi4xMTc5Qzc3LjQ4OSAzMi4zMzMyIDc3LjY2OSAzMi41MTA1IDc3Ljg4NzYgMzIuNTEwNUg3OS43NTg2Qzc5Ljk3NzIgMzIuNTEwNSA4MC4xNTcyIDMyLjMzMzIgODAuMTU3MiAzMi4xMTc5VjE2LjczNjRDODAuMTU3MiAxNi41MjExIDgwLjMzNzMgMTYuMzQzOCA4MC41NTU5IDE2LjM0MzhIODUuMzEzN0M4NS41MzIzIDE2LjM0MzggODUuNzEyNCAxNi4xNjY1IDg1LjcxMjQgMTUuOTUxMiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTY0LjIzNzggMjQuNzIxNkM2NC4wOTY0IDI0LjU1NyA2NC4xNTQyIDI0LjQyNCA2NC4zNzkzIDI0LjQyNEg2Ny42NTE5QzY3Ljg3MDUgMjQuNDI0IDY4LjE3OTEgMjQuMjk3NCA2OC4zMjcgMjQuMTQ1NEw2OS4wOTg2IDIzLjM3MjhDNjkuMjUyOSAyMy4yMjA4IDY5LjM3NSAyMi45MTY5IDY5LjM2ODYgMjIuNzAxNlYxNS41Mzk2QzY5LjM2ODYgMTUuMzI0MyA2OS4yNCAxNS4wMjY3IDY5LjA4NTcgMTQuODc0N0w2OC4xNzkxIDEzLjk5NDVDNjguMDI0OCAxMy44NDI1IDY3LjcxNjIgMTMuNzIyMiA2Ny40OTc2IDEzLjcyMjJINTcuNTcwNEM1Ny4zNTE4IDEzLjcyMjIgNTcuMDQzMSAxMy44NDg4IDU2Ljg4ODggMTQuMDAwOEw1Ni4xMTczIDE0Ljc2MDdDNTUuOTYzIDE0LjkxMjcgNTUuODQwOCAxNS4yMTY2IDU1Ljg0MDggMTUuNDMxOVYzMi4xMTc5QzU1Ljg0MDggMzIuMzMzMyA1Ni4wMjA4IDMyLjUxMDYgNTYuMjM5NSAzMi41MTA2SDU4LjEwNEM1OC4zMjI2IDMyLjUxMDYgNTguNTAyNyAzMi4zMzMzIDU4LjUwMjcgMzIuMTE3OVYxNi43MzY0QzU4LjUwMjcgMTYuNTIxMSA1OC42ODI3IDE2LjM0MzggNTguOTAxMyAxNi4zNDM4SDY2LjI1NjdDNjYuNDc1MyAxNi4zNDM4IDY2LjY1NTMgMTYuNTIxMSA2Ni42NjE4IDE2LjczNjRMNjYuNjc0NiAyMS40MDk4QzY2LjY3NDYgMjEuNjI1MSA2Ni41MDEgMjEuODAyNCA2Ni4yODI0IDIxLjgwMjRINjEuODEzOUM2MS41OTUzIDIxLjgwMjQgNjEuMzM4MSAyMS45NjA3IDYxLjI0ODEgMjIuMTU3TDYwLjU3MyAyMy42MTM1QzYwLjQ4MyAyMy44MDk4IDYwLjUyMTUgMjQuMTAxMSA2MC42Njk0IDI0LjI2NTdMNjcuMjY2MSAzMi4yMTI5QzY3LjQwNzYgMzIuMzc3NiA2Ny43MDMzIDMyLjUxMDYgNjcuOTIyIDMyLjUxMDZINzAuNjQxN0M3MC44NjAzIDMyLjUxMDYgNzAuOTI0NiAzMi4zNzc2IDcwLjc3NjcgMzIuMjEyOUw2NC4yMTg1IDI0LjcyMTZINjQuMjM3OFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMTkuOTI0IDI5Ljg4MjZIMTEyLjM5NUMxMTIuMTc3IDI5Ljg4MjYgMTExLjk5NyAyOS43MDUzIDExMS45OTcgMjkuNDlWMTQuMTE0OEMxMTEuOTk3IDEzLjg5OTUgMTExLjgxNyAxMy43MjIyIDExMS41OTggMTMuNzIyMkgxMDkuNzMzQzEwOS41MTUgMTMuNzIyMiAxMDkuMzM1IDEzLjg5OTUgMTA5LjMzNSAxNC4xMTQ4VjMwLjgwNzFDMTA5LjMzNSAzMS4wMjI0IDEwOS40NjMgMzEuMzI2NCAxMDkuNjE4IDMxLjQ3ODRMMTEwLjM4OSAzMi4yMzgzQzExMC41NDMgMzIuMzkwMiAxMTAuODQ2IDMyLjUxNjkgMTExLjA2NCAzMi41MTY5SDExOS45MjRDMTIwLjE0MyAzMi41MTY5IDEyMC4zMjMgMzIuMzM5NiAxMjAuMzIzIDMyLjEyNDNWMzAuMjgxNUMxMjAuMzIzIDMwLjA2NjIgMTIwLjE0MyAyOS44ODg5IDExOS45MjQgMjkuODg4OSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwNS4wNTkgMTMuOTk0NEMxMDQuOTA1IDEzLjg0MjUgMTA0LjU5NiAxMy43MTU4IDEwNC4zNzcgMTMuNzE1OEg5NC42NTU5Qzk0LjQzNzMgMTMuNzE1OCA5NC4xMjg3IDEzLjg0MjUgOTMuOTc0NCAxMy45OTQ0TDkzLjIwMjggMTQuNzU0M0M5My4wNDg1IDE0LjkwNjMgOTIuOTE5OSAxNS4yMTAzIDkyLjkxOTkgMTUuNDI1NlYzMi4xMTE2QzkyLjkxOTkgMzIuMzI2OSA5My4wOTk5IDMyLjUwNDIgOTMuMzE4NiAzMi41MDQySDk1LjE4MzFDOTUuNDAxNyAzMi41MDQyIDk1LjU4MTggMzIuMzI2OSA5NS41ODE4IDMyLjExMTZWMTYuNzQyN0M5NS41ODE4IDE2LjUyNzQgOTUuNzYxOCAxNi4zNTAxIDk1Ljk4MDQgMTYuMzUwMUgxMDMuMTExQzEwMy4zMjkgMTYuMzUwMSAxMDMuNTA5IDE2LjUyNzQgMTAzLjUxNiAxNi43NDI3VjIxLjQwOThDMTAzLjUxNiAyMS42MjUxIDEwMy4zNDIgMjEuODAyNCAxMDMuMTI0IDIxLjgwMjRIOTcuNDA3N0M5Ny4xODkxIDIxLjgwMjQgOTcuMDA5MSAyMS45Nzk3IDk3LjAwOTEgMjIuMTk1VjI0LjAzNzdDOTcuMDA5MSAyNC4yNTMgOTcuMTg5MSAyNC40MzAzIDk3LjQwNzcgMjQuNDMwM0gxMDQuNTEyQzEwNC43MzEgMjQuNDMwMyAxMDUuMDMzIDI0LjMwMzcgMTA1LjE4OCAyNC4xNTE3TDEwNS45NTkgMjMuMzc5MUMxMDYuMTEzIDIzLjIyNzIgMTA2LjIzNiAyMi45MjMyIDEwNi4yMjkgMjIuNzA3OVYxNS40MDY2QzEwNi4yMjkgMTUuMTkxMyAxMDYuMDk0IDE0Ljg5MzcgMTA1Ljk0IDE0Ljc0MTdMMTA1LjA0NiAxNC4wMDA4TDEwNS4wNTkgMTMuOTk0NFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik04Ny40NTQ5IDI5LjUwMjlIODUuMzY1M0M4NS4xMjA5IDI5LjUwMjkgODQuOTIxNiAyOS42OTkyIDg0LjkyMTYgMjkuOTM5OVYzMi4wNjc2Qzg0LjkyMTYgMzIuMzA4MiA4NS4xMjA5IDMyLjUwNDUgODUuMzY1MyAzMi41MDQ1SDg3LjQ1NDlDODcuNjk5MiAzMi41MDQ1IDg3Ljg5ODUgMzIuMzA4MiA4Ny44OTg1IDMyLjA2NzZWMjkuOTM5OUM4Ny44OTg1IDI5LjY5OTIgODcuNjk5MiAyOS41MDI5IDg3LjQ1NDkgMjkuNTAyOVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=);
        width: 173px;
        height: 47px;
        margin: 10px auto 10px 0;
    }

    .mobile-header .report-incident {
        margin: 5px 20px 5px 20px;
    }

    .mobile-header .visit-notifications {
        margin: 5px 20px 5px 20px;
        color: #000;
        background-color: #fcc33e;
    }

    .mobile-header .visit-notifications:hover {
        background-color: #ffe4ae;
    }

    .mobile-header .menu-bar {
        display: flex;
        padding: 0 15px;
    }

    .mobile-header .menu-bar .language {
        height: 50px;
        width: 50px;
        background-repeat: no-repeat;
        background-position: center;
        margin-left: auto;
        display: inline-block;
    }
    
    .mobile-header .menu-bar .language.pl {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzcyNF8xMDM2MCkiPgo8cGF0aCBkPSJNMTkuNTU1NiAzLjA1NTY2SDIuNDQ0NDRDMS43OTYxNCAzLjA1NTY2IDEuMTc0MzggMy4zMTMyIDAuNzE1OTYxIDMuNzcxNjNDMC4yNTc1MzkgNC4yMzAwNSAwIDQuODUxOCAwIDUuNTAwMTFMMCAxMS4wMDAxSDIyVjUuNTAwMTFDMjIgNC44NTE4IDIxLjc0MjUgNC4yMzAwNSAyMS4yODQgMy43NzE2M0MyMC44MjU2IDMuMzEzMiAyMC4yMDM5IDMuMDU1NjYgMTkuNTU1NiAzLjA1NTY2WiIgZmlsbD0iI0VFRUVFRSIvPgo8cGF0aCBkPSJNMCAxNi41QzAgMTcuMTQ4MyAwLjI1NzUzOSAxNy43NzAxIDAuNzE1OTYxIDE4LjIyODVDMS4xNzQzOCAxOC42ODY5IDEuNzk2MTQgMTguOTQ0NCAyLjQ0NDQ0IDE4Ljk0NDRIMTkuNTU1NkMyMC4yMDM5IDE4Ljk0NDQgMjAuODI1NiAxOC42ODY5IDIxLjI4NCAxOC4yMjg1QzIxLjc0MjUgMTcuNzcwMSAyMiAxNy4xNDgzIDIyIDE2LjVWMTFIMFYxNi41WiIgZmlsbD0iI0RDMTQzQyIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzcyNF8xMDM2MCI+CjxyZWN0IHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K");
    }
    
    .mobile-header .menu-bar .language.en {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzc4MV8xMDkzNSkiPgo8cGF0aCBkPSJNMTMuMDYyNSAxOC41NjI1SDE4LjU2MjVDMTkuMjQyMSAxOC41NjI1IDE5LjgxOTYgMTguNDA5MiAyMC4yOTkyIDE4LjE0MjFMMTMuMDYyNSAxMy44MjUzVjE4LjU2MjVaTTIxLjg4MzIgMTUuODg0N0MyMS45NjE1IDE1LjUzNTEgMjIuMDAxNCAxNS4xNjQ5IDIyLjAwMTQgMTQuNzgwOVYxMy4wNjIySDE3LjE1MTFMMjEuODgxOCAxNS44ODQ3TTAuMTIwMzUzIDYuMTA0NjZDMC4wMzg4ODU4IDYuNDcwMzggLTAuMDAxNDY4NjMgNi44NDQwNiA0LjA4MjMyZS0wNSA3LjIxODc1VjguOTM3NUg0Ljg2ODkyTDAuMTIwMzUzIDYuMTA0NjZaTTguOTM3NTQgMy40Mzc1SDMuNDM3NTRDMi43NjI3NiAzLjQzNzUgMi4xODkwNCAzLjU4ODc1IDEuNzExNTcgMy44NTIwNkw4LjkzNzU0IDguMTYyNjlWMy40Mzc1Wk0xLjczMzU3IDE4LjE1ODlDMi4yMDY1NyAxOC40MTQ3IDIuNzcyNzMgMTguNTYyNSAzLjQzNzU0IDE4LjU2MjVIOC45Mzc1NFYxMy44NjE0TDEuNzMzNTcgMTguMTU4OVpNNC4wODIzMmUtMDUgMTMuMDYyNVYxNC43ODEyQzQuMDgyMzJlLTA1IDE1LjE3NjkgMC4wNDE5NzgzIDE1LjU1ODEgMC4xMjQ4MjIgMTUuOTE2N0w0LjkwOTQ4IDEzLjA2MjVINC4wODIzMmUtMDVaTTIwLjMyMDggMy44Njg5MUMxOS44Mzc1IDMuNTk0NTkgMTkuMjUyMSAzLjQzNzUgMTguNTYyNSAzLjQzNzVIMTMuMDYyNVY4LjE5ODc4TDIwLjMyMDggMy44Njg5MVpNMjIgOC45Mzc1VjcuMjE4NzVDMjIgNi44NDI2OSAyMS45NjEyIDYuNDgwMDMgMjEuODg1OSA2LjEzNjk3TDE3LjE5MTcgOC45Mzc1SDIyWiIgZmlsbD0iIzJFMzE5MiIvPgo8cGF0aCBkPSJNMTcuMTkxNiA4LjkzNzVMMjEuODg1OSA2LjEzNjk3QzIxLjY3MDcgNS4xNTI0NyAyMS4xNDY4IDQuMzM3NDQgMjAuMzIwOCAzLjg2ODkxTDEzLjA2MjUgOC4xOTg3OFYzLjQzNzVIMTIuMzc1VjkuNjI1SDIyVjguOTM3NUgxNy4xOTE2Wk0wIDEyLjM3NVYxMy4wNjI1SDQuOTA5NDRMMC4xMjQ3ODEgMTUuOTE2N0MwLjM1MiAxNi44OTgxIDAuODkxNjg4IDE3LjcwMzggMS43MzM1MyAxOC4xNTg5TDguOTM3NSAxMy44NjE0VjE4LjU2MjVIOS42MjVWMTIuMzc1SDBaTTIyIDEyLjM3NUgxMi4zNzVWMTguNTYyNUgxMy4wNjI1VjEzLjgyNTNMMjAuMjk5MSAxOC4xNDI0QzIxLjEzMTMgMTcuNjc5MSAyMS42NjE3IDE2Ljg2ODUgMjEuODgxOCAxNS44ODU0TDE3LjE1MTEgMTMuMDYyNUgyMlYxMi4zNzVaTTguOTM3NSAzLjQzNzVWOC4xNjI2OUwxLjcxMTUzIDMuODUyMDZDMC44NzYyMTkgNC4zMTI2OSAwLjM0MjM3NSA1LjEyMTg4IDAuMTE5OTY5IDYuMTA0NjZMNC44Njg4OCA4LjkzNzVIMFY5LjYyNUg5LjYyNVYzLjQzNzVIOC45Mzc1WiIgZmlsbD0iI0U2RTdFOCIvPgo8cGF0aCBkPSJNMTIuMzc1IDkuNjI1VjMuNDM3NUg5LjYyNVY5LjYyNUgwVjEyLjM3NUg5LjYyNVYxOC41NjI1SDEyLjM3NVYxMi4zNzVIMjJWOS42MjVIMTIuMzc1WiIgZmlsbD0iI0JFMUUyRCIvPgo8cGF0aCBkPSJNNy41NDA4IDguOTM3ODZMMC42NDg2MDkgNC44MjM1MkMwLjUwMDQ1MyA1LjA0MzUyIDAuMzgxNTE2IDUuMjg1NTIgMC4yODMyMDMgNS41NDMzM0w1Ljk3MTIzIDguOTM3ODZINy41Mzk3N00yMS42ODY4IDE2LjUzMTNMMTUuOTA3MyAxMy4wNjI5SDE0LjMwNjhMMjEuMjg5NCAxNy4yNjMxQzIxLjQ1MTMgMTcuMDM2OSAyMS41ODQ4IDE2Ljc5MTUgMjEuNjg2OCAxNi41MzI3TTIwLjg3MTggNC4yNTk3N0wxMy4wNTE1IDguOTM3ODZMMTQuNjM5MiA4LjkzODg5TDIxLjM4NzQgNC44OTg4QzIxLjIzNjggNC42MjQ4MyAyMS4wNzggNC40NDgxNCAyMC44NzE4IDQuMjU5NzdaTTAuNjIyODI4IDE3LjE0NDlDMC43Nzc0NTggMTcuMzgwNCAwLjk2MzU0NCAxNy41OTM3IDEuMTc1OTIgMTcuNzc4OEw4Ljk1ODc3IDEzLjA2MjlINy4zOTAyM0wwLjYyMjgyOCAxNy4xNDQ5WiIgZmlsbD0iI0JFMUUyRCIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzc4MV8xMDkzNSI+CjxyZWN0IHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K");
    }
    
    .mobile-header .menu-bar .search {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMjM0NyIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTIzNDcpIj4KPHBhdGggZD0iTTIzLjczMTUgMjUuMzMzN0wxNy4yNzE5IDE4Ljg4MjlDMTYuNzYzMyAxOS4yNzIzIDE2LjE3ODMgMTkuNTg1NSAxNS41MTcxIDE5LjgyMjVDMTQuODU1OSAyMC4wNTk2IDE0LjE1MjMgMjAuMTc4MSAxMy40MDYzIDIwLjE3ODFDMTEuNTI0NCAyMC4xNzgxIDkuOTMwNjkgMTkuNTIxOCA4LjYyNTIxIDE4LjIwOTNDNy4zMTk3MyAxNi44OTc1IDYuNjY2OTkgMTUuMzAxOSA2LjY2Njk5IDEzLjQyMjVDNi42NjY5OSAxMS41NDMyIDcuMzE5NzMgOS45NDcyNSA4LjYyNTIxIDguNjM0NzRDOS45MzA2OSA3LjMyMjkxIDExLjUyNDQgNi42NjY5OSAxMy40MDYzIDYuNjY2OTlDMTUuMjg4MiA2LjY2Njk5IDE2Ljg4NjQgNy4zMjI5MSAxOC4yMDA3IDguNjM0NzRDMTkuNTE0MyA5Ljk0NzI1IDIwLjE3MTEgMTEuNTQzMiAyMC4xNzExIDEzLjQyMjVDMjAuMTcxMSAxNC4xNjc1IDIwLjA1NjggMTQuODcwMiAxOS44MjgzIDE1LjUzMDVDMTkuNTk5IDE2LjE5MDggMTkuMjg5NSAxNi43NjY1IDE4Ljg5OTUgMTcuMjU3NUwyNS4zMzM3IDIzLjcwODNMMjMuNzMxNSAyNS4zMzM3Wk0xMy40MDYzIDE3Ljg0MTZDMTQuNjQ0IDE3Ljg0MTYgMTUuNjk1MSAxNy40MTM5IDE2LjU1OTggMTYuNTU4NUMxNy40MjQ1IDE1LjcwMzkgMTcuODU2OCAxNC42NTg1IDE3Ljg1NjggMTMuNDIyNUMxNy44NTY4IDEyLjE4NjYgMTcuNDI0NSAxMS4xNDA5IDE2LjU1OTggMTAuMjg1NUMxNS42OTUxIDkuNDMwODQgMTQuNjQ0IDkuMDAzNSAxMy40MDYzIDkuMDAzNUMxMi4xNjg3IDkuMDAzNSAxMS4xMjE5IDkuNDMwODQgMTAuMjY2IDEwLjI4NTVDOS40MDk1MiAxMS4xNDA5IDguOTgxMjUgMTIuMTg2NiA4Ljk4MTI1IDEzLjQyMjVDOC45ODEyNSAxNC42NTg1IDkuNDA5NTIgMTUuNzAzOSAxMC4yNjYgMTYuNTU4NUMxMS4xMjE5IDE3LjQxMzkgMTIuMTY4NyAxNy44NDE2IDEzLjQwNjMgMTcuODQxNloiIGZpbGw9IiNGQ0ZERkQiLz4KPC9nPgo8L3N2Zz4K");
        height: 50px;
        width: 50px;
        background-repeat: no-repeat;
        background-position: center;
        display: inline-block;
        margin-left: 20px;
    }
    
    .mobile-header .menu-bar .burger {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMzI0OSIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTMyNDkpIj4KPHBhdGggZD0iTTEyLjAwMDMgMjRWMjEuMDc2M0gyNS4zMzQyVjI0SDEyLjAwMDNaTTYuNjY2OTkgMTcuMzMzM1YxNC42NjY3TDI1LjMzNDIgMTQuNTIyMVYxNy40Nzc5TDYuNjY2OTkgMTcuMzMzM1pNOS4zMzQyMSAxMC45MjM3VjhIMjUuMzM0MlYxMC45MjM3SDkuMzM0MjFaIiBmaWxsPSIjRkNGREZEIi8+CjwvZz4KPC9zdmc+Cg==");
        width: 50px;
        height: 50px;
        background-repeat: no-repeat;
        background-position: center;
        margin-left: 20px;
    }
    
    .mobile-header .menu-bar .burger.active {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMzQzNCIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTM0MzQpIj4KPHBhdGggZD0iTTIxLjY1NjYgMjMuODI1M0wxNS45OTk3IDE4LjE2ODVMMTAuMzQyOSAyMy44MjUzTDguMTc0NDMgMjEuNjU2OUwxMy44MzEzIDE2TDguMTc0NDMgMTAuMzQzMUwxMC4zNDI5IDguMTc0NjlMMTUuOTk5NyAxMy44MzE1TDIxLjY1NjYgOC4xNzQ2OUwyMy44MjUxIDEwLjM0MzFMMTguMTY4MiAxNkwyMy44MjUxIDIxLjY1NjlMMjEuNjU2NiAyMy44MjUzWiIgZmlsbD0iI0ZDRkRGRCIvPgo8L2c+Cjwvc3ZnPgo=");
    }

    .mobile-header .menu-bar .return {
        display: none;
        align-items: center;
    }

    .mobile-header .menu-bar .return i {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMzQ2NyIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KPHJlY3QgeD0iMzIiIHk9IjMyIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHRyYW5zZm9ybT0icm90YXRlKC0xODAgMzIgMzIpIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTM0NjcpIj4KPHBhdGggZD0iTTE5LjQ2NjMgNy43MzMyN0wyMS41OTk2IDkuODY2NkwxNS40NjYzIDE1Ljk5OTlMMjEuNTk5NiAyMi4xMzMzTDE5LjQ2NjMgMjQuMjY2NkwxMS4xOTk2IDE1Ljk5OTlMMTkuNDY2MyA3LjczMzI3WiIgZmlsbD0iI0ZDRkRGRCIvPgo8L2c+Cjwvc3ZnPgo=");
        width: 32px;
        height: 32px;
    }

    .mobile-header .menu-overlay {
        position: absolute;
        width: 100%;
        background-color: #121F29;
        display: none;
    }

    .mobile-header .menu-overlay .menu-container {
        width: 100%;
        height: 100%;
        overflow-x: hidden;
        position: relative;
        padding: 20px;
    }

    .mobile-header .menu-overlay .menu-container ul,
    .mobile-header .menu-overlay .menu-container li {
        margin: 0;
        padding: 0;
    }
    
    .mobile-header .menu-overlay .menu-container li:not(.menu-header) {
        padding: 10px 0;
        font-weight: bold;
        font-size: 1.3rem;
        cursor: pointer;
    }
    
    .mobile-header .menu-overlay .menu-container .menu-root > li:not(.menu-header) {
        font-size: 2rem;
    }

    .mobile-header .menu-overlay .menu-container ul {
        list-style: none;
    }

    .mobile-header .menu-overlay .menu-container ul {
        display: block;
        width: 100%;
    }

    .mobile-header .menu-overlay .menu-container li > ul {
        position: absolute;
        top: 0;
        left: 100vw;
        float: left;
    }

    .mobile-header .menu-overlay .menu-container .menu-root {
        position: relative;
        transition: transform 0.2s ease-out;
    }

    .mobile-header .menu-overlay .menu-container ul:not(.menu-active) {
        display: none;
    }
    
    .mobile-header .menu-button {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMzIzMyIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI4IiBoZWlnaHQ9IjI4Ij4KPHJlY3Qgd2lkdGg9IjI4IiBoZWlnaHQ9IjI4IiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTMyMzMpIj4KPHBhdGggZD0iTTEwLjk2NjMgMjEuMjMzM0w5LjA5OTYxIDE5LjM2NjZMMTQuNDY2MyAxMy45OTk5TDkuMDk5NjEgOC42MzMyN0wxMC45NjYzIDYuNzY2NkwxOC4xOTk2IDEzLjk5OTlMMTAuOTY2MyAyMS4yMzMzWiIgZmlsbD0iI0ZDRkRGRCIvPgo8L2c+Cjwvc3ZnPgo=");
        background-repeat: no-repeat;
        background-position: right center;
        background-size: 2.5rem;
    }
    
    .mobile-header .menu-header {
        color: #858889;
        font-size: 1.2rem;
        padding-top: 1.5rem !important;
        padding-bottom: 0.3rem !important;
    }
    
    .mobile-header .menu-container a {
        display: block;
        width: 100%;
        color: #FCFDFD;
    }
</style>

<script>
    $(function() {
        let $mobile_header = $('.mobile-header');
        let $burger = $('.mobile-header .burger');
        let $menu_overlay = $('.mobile-header .menu-overlay');
        let $return = $('.mobile-header .return');

        let active = false;
        let level = 0;
        let $menu_root = $('.mobile-header .menu-root');

        let overlay_height = window.innerHeight - $('.mobile-header .top')[0].scrollHeight
            - $('.mobile-header .menu-bar')[0].scrollHeight;
        $('.mobile-header .menu-overlay').css({'height': overlay_height});

        $burger.on('click', function() {
            if (active) {
                active = false;
                $menu_overlay.fadeOut(200);
                $return.css({'opacity': 0});
                $mobile_header.css({'background-color': '#212E3B'});
                $burger.removeClass('active');
                $('body').css({'overflow': 'inherit'});
            } else {
                active = true;
                $menu_overlay.fadeIn(200);
                $return.css({'opacity': 1});
                $mobile_header.css({'background-color': '#121F29'});
                $burger.addClass('active');
                $('body').css({'overflow': 'hidden'});
            }
        });
        
        $return.on('click', function () {
            if (level < 1) return;

            $menu_root.find('> li > ul '.repeat(level)).removeClass('menu-active');
            level -= 1;
            $menu_root.css({'transform': 'translateX(' + (-level * 100) + 'vw)'});
            
            if (level === 0) {
                $return.css({'display': 'none'});
            }
        });
    
        $menu_root.on('click', function (event) {
            let $target = $(event.target);
            if ($target.hasClass('menu-button')) {
                level += 1;
                $menu_root.find('> li > ul '.repeat(level)).removeClass('menu-active');
                $target.children('ul').first().addClass('menu-active');
                $menu_root.css({'transform': 'translateX(' + (-level * 100) + 'vw)'});
                $return.css({'display': 'flex'});
            }
        });
        
        let last_scroll = window.scrollY, top = 0, max = $mobile_header.outerHeight();
        $(window).on('scroll', function() {
            top += last_scroll - window.scrollY;

            if (top < -max) top = -max;
            if (top > 0) top = 0;

            $mobile_header.css({'top': top + 'px'});
            last_scroll = window.scrollY;
        });
    });
</script>

<header class="mobile-header">
    <div class="top">
        <a href="/en/" class="logo"></a>

            <a href="https://incydent.cert.pl/#!/lang=en" class="cta primary report-incident">Report an incident</a>
    </div>
    <div class="menu-bar">
        <div class="return"><i></i>Back</div>


        <a href="../../../../../posts/2018/07/analiza-smoke-loader/" class="language pl"></a>
        <a href="/en/search" class="search"></a>
        <div class="burger"></div>
    </div>
    <div class="menu-overlay">
        <div class="menu-container">
            <ul class="menu-root menu-active">
                <li class="menu-header">You're in the menu</li>
                <li class="menu-button">About us
                    <ul>
                        <li class="menu-header">About us</li>
                        <li><a href="../../../../about-us/">About our team</a></li>
                        <li><a href="../../../../contact/">Contact</a></li>
                    </ul>
                </li>
                <li class="menu-button">For experts
                    <ul>
                        <li class="menu-header">For experts</li>
                        <li><a href="../../../../news/">News</a></li>
                        <li><a href="../../../../publications/">Publications</a></li>
                        <li><a href="../../../../warning-list/">The Warning List</a></li>
                        
                        <li class="menu-header">Projects</li>
                        <li><a href="../../../../n6/">n6</a></li>
                        <li><a href="/en/posts/2024/01/artemis-security-scanner/">Artemis</a></li>
                        <li><a href="https://mwdb.cert.pl/">MWDB</a></li>
                    
                        <li class="menu-header">CVD program</li>
                        <li><a href="../../../../cvd">CVD policy</a></li>
                        <li><a href="../../../../cve">Advisories</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</header><style>
    .desktop-header {
        width: 100%;
        background-color: #212E3B;
        color: #FCFDFD;
        z-index: 99999999;
        transition: background-color 0.2s ease-out;
    }
    
    .desktop-header.active {
        background-color: #121F29;
    }
    
    .desktop-header .top {
        display: flex;
        align-items: center;
        max-width: 1110px;
        margin: 0 auto;
    }
    
    .desktop-header .logo {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTczIiBoZWlnaHQ9IjYwIiB2aWV3Qm94PSIwIDAgMTczIDYwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTA5LjMyOCAzOS40NTczSDExMy42MTdMMTE3LjQxIDQ0LjU4MDNMMTE3LjQ2MiA0NC41NTQ5VjM5LjQ1NzNIMTIwLjAzM1Y0Ni4zMTU0SDExNS45MjVMMTEyLjA4IDQxLjA3ODRIMTEyLjA0MVY0Ni4zMTU0SDEwOS4zMjJWMzkuNDU3M0gxMDkuMzI4Wk0xMjQuNDE4IDM5LjQ1NzNIMTI4LjA3TDEzMi4zNDYgNDYuMzE1NEgxMjguOTY0TDEyOC4yNDQgNDUuMDA0NkgxMjMuODc4TDEyMy4xNTggNDYuMzE1NEgxMjAuMTNMMTI0LjQxOCAzOS40NTczWk0xMjcuNTI0IDQzLjY2ODRMMTI2LjEyOSA0MC44MTg4SDEyNi4wODRMMTI0LjY1IDQzLjY2ODRIMTI3LjUzSDEyNy41MjRaTTEzMS4zOTQgNDQuMTgxM0gxMzQuNDIzQzEzNC40MjMgNDQuNDM0NiAxMzQuNTE5IDQ0LjYzNzMgMTM0Ljc4OSA0NC44Mzk5QzEzNS4wMDggNDUuMDEwOSAxMzUuNDEzIDQ1LjEyNDkgMTM2LjAwNCA0NS4xNTAyQzEzNi41NTEgNDUuMTUwMiAxMzYuOTU2IDQ1LjA5MzIgMTM3LjI2NSA0NC45NTM5QzEzNy41OCA0NC44Mzk5IDEzNy43NjYgNDQuNjY4OSAxMzcuNzY2IDQ0LjQ3MjZDMTM3Ljc2NiA0NC4zMjcgMTM3LjY4MyA0NC4xODc3IDEzNy41NDggNDQuMTA1M0MxMzcuNDEyIDQzLjk5MTQgMTM3LjIzMiA0My45MDkgMTM3LjAwNyA0My44NTJDMTM2LjgxNSA0My43OTUxIDEzNi41NTcgNDMuNzM4MSAxMzYuMzI2IDQzLjcwNjRDMTM2LjA1NiA0My42NDk0IDEzNS44MjQgNDMuNjI0MSAxMzUuNjA2IDQzLjU5MjRDMTM0Ljc1MSA0My40NTMxIDEzNC4wMjQgNDMuMzMyOCAxMzMuNDg0IDQzLjE5MzVDMTMyLjk4MyA0My4wNzk1IDEzMi41MzIgNDIuODgzMiAxMzIuMTM0IDQyLjYyMzVDMTMxLjc2NyA0Mi4zMzg2IDEzMS41ODcgNDEuOTk2NiAxMzEuNTg3IDQxLjU0MDdDMTMxLjU4NyA0MS4wMjc4IDEzMS43NjcgNDAuNjI4OCAxMzIuMTcyIDQwLjMxODVDMTMyLjU3NyA0MC4wMDE5IDEzMy4xMjQgMzkuNzQ4NiAxMzMuODM4IDM5LjYwM0MxMzQuNTE5IDM5LjQ2MzcgMTM1LjMyOSAzOS4zNzUgMTM2LjIzNiAzOS4zNzVDMTM3LjY4MyAzOS4zNzUgMTM4LjgwOCAzOS41NzEzIDEzOS40ODMgMzkuOTEzM0MxNDAuMjA5IDQwLjI1NTIgMTQwLjU2MyA0MC43NDI4IDE0MC41NjMgNDEuMzM4MVY0MS41NDA3SDEzNy41NDhDMTM3LjU0OCA0MS4yODExIDEzNy40NTEgNDEuMDg0OCAxMzcuMTgxIDQwLjk0NTVDMTM2LjkxMSA0MC43NzQ1IDEzNi41NTcgNDAuNzE3NSAxMzYuMTAxIDQwLjcxNzVDMTM1LjY5NiA0MC43MTc1IDEzNS4zODEgNDAuNzc0NSAxMzUuMTQ5IDQwLjkyMDFDMTM0Ljg3OSA0MS4wMzQxIDEzNC43NDQgNDEuMjA1MSAxMzQuNzQ0IDQxLjM3NjFDMTM0Ljc0NCA0MS43MTggMTM1LjMyOSA0MS45NzEzIDEzNi41NTcgNDIuMTQyM0MxMzcuMzY3IDQyLjI1NjMgMTM3Ljk1MyA0Mi4zMzg2IDEzOC4zNTggNDIuNDAxOUMxMzguNzYzIDQyLjQ4NDIgMTM5LjE2OCA0Mi41NzI5IDEzOS41NzMgNDIuNzEyMkMxMzkuOTkxIDQyLjg1MTUgMTQwLjMwNiA0My4wNTQyIDE0MC41NjMgNDMuMzA3NUMxNDAuNzk0IDQzLjUzNTQgMTQwLjkyOSA0My44Nzc0IDE0MC45NzQgNDQuMjQ0N0MxNDAuOTc0IDQ0Ljc1NzYgMTQwLjc0OSA0NS4xNTY1IDE0MC4zMzggNDUuNDk4NUMxMzkuODg4IDQ1Ljg0MDQgMTM5LjMwOSA0Ni4wNjg0IDEzOC41NzYgNDYuMjM5NEMxMzcuODYzIDQ2LjM3ODcgMTM3LjA0NiA0Ni40NTQ3IDEzNi4xODQgNDYuNDU0N0MxMzUuMTA0IDQ2LjQ1NDcgMTM0LjE5OCA0Ni4zNzg3IDEzMy41MjMgNDYuMjM5NEMxMzIuODQxIDQ2LjA2ODQgMTMyLjMwMSA0NS44MTUxIDEzMS45NDEgNDUuNDczMkMxMzEuNTc0IDQ1LjEzMTIgMTMxLjM5NCA0NC43MDY5IDEzMS4zOTQgNDQuMTk0TTE0MS4zMDIgMzkuNDdIMTQ0LjMxOFY0Mi40ODQySDE0NC4zNjlMMTQ3Ljc5NiAzOS40N0gxNTEuMjc1TDE0Ny41NzggNDIuNDg0MkwxNTEuNTk2IDQ2LjMyOEgxNDcuODg2TDE0NC4zNjkgNDIuNjgwNUgxNDQuMzE4VjQ2LjMyOEgxNDEuMzAyVjM5LjQ3WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEyOC41NTkgMTQuMzgwOEMxMjguNDA1IDE0LjIyODggMTI4LjE0NyAxMy45ODE5IDEyOCAxMy44Mjk5TDEyNy42MiAxMy40NTYzQzEyNy40NjYgMTMuMzA0MyAxMjcuMjE1IDEzLjMwNDMgMTI3LjA2MSAxMy40NTYzTDEyNS43MzYgMTQuNzYwOEMxMjUuNTgyIDE0LjkxMjcgMTI1LjU4MiAxNS4xNjYgMTI1LjczNiAxNS4zMThMMTI2LjExNiAxNS42OTE2QzEyNi4yNyAxNS44NDM2IDEyNi41MjcgMTYuMDk2OSAxMjYuNjgxIDE2LjI0ODlMMTMzLjM4MSAyMi44NDczQzEzMy41MzUgMjIuOTk5MyAxMzMuNTM1IDIzLjI0NjIgMTMzLjM4MSAyMy4zOTgyTDEyNi42ODEgMjkuOTk2NkMxMjYuNTI3IDMwLjE0ODYgMTI2LjI3NiAzMC4zOTU2IDEyNi4xMTYgMzAuNTUzOUwxMjUuNzM2IDMwLjkyNzVDMTI1LjU4MiAzMS4wNzk1IDEyNS41ODIgMzEuMzI2NSAxMjUuNzM2IDMxLjQ3ODRMMTI3LjA2MSAzMi43ODI5QzEyNy4yMTUgMzIuOTM0OSAxMjcuNDY2IDMyLjkzNDkgMTI3LjYyIDMyLjc4MjlMMTI4IDMyLjQwOTNDMTI4LjE1NCAzMi4yNTczIDEyOC40MTEgMzIuMDEwNCAxMjguNTU5IDMxLjg1ODRMMTM2LjIwNCAyNC4zMjkxQzEzNi4zNTggMjQuMTc3MSAxMzYuNDg3IDIzLjg3MzIgMTM2LjQ4NyAyMy42NTc5VjIyLjU4MTNDMTM2LjQ4NyAyMi4zNjYgMTM2LjM1OCAyMi4wNjIxIDEzNi4yMDQgMjEuOTEwMUwxMjguNTU5IDE0LjM4MDhaIiBmaWxsPSIjMjhBNzQ1Ii8+CjxwYXRoIGQ9Ik0xNTEuMTkxIDI5Ljg4MjhIMTM3LjcyN0MxMzcuNTA5IDI5Ljg4MjggMTM3LjMyOSAzMC4wNjAxIDEzNy4zMjkgMzAuMjc1NFYzMi4xMTgyQzEzNy4zMjkgMzIuMzMzNSAxMzcuNTA5IDMyLjUxMDggMTM3LjcyNyAzMi41MTA4SDE1MS4xOTFDMTUxLjQxIDMyLjUxMDggMTUxLjU5IDMyLjMzMzUgMTUxLjU5IDMyLjExODJWMzAuMjc1NEMxNTEuNTkgMzAuMDYwMSAxNTEuNDEgMjkuODgyOCAxNTEuMTkxIDI5Ljg4MjhaIiBmaWxsPSIjMjhBNzQ1Ii8+CjxwYXRoIGQ9Ik0zNS45Mjg0IDEzLjcxNThIMzAuOTc3N0MzMC43NTkxIDEzLjcxNTggMzAuNDExOSAxMy43ODU1IDMwLjIxMjUgMTMuODY3OEwzMC4wMDA0IDEzLjk1MDFDMjkuNzk0NiAxNC4wMzI0IDI5LjUwNTMgMTQuMjIyNCAyOS4zNTEgMTQuMzc0NEwyMS43MDYyIDIxLjkwMzdDMjEuNTUxOSAyMi4wNTU3IDIxLjQyMzMgMjIuMzU5NiAyMS40MjMzIDIyLjU3NDlWMjMuNjUxNEMyMS40MjMzIDIzLjg2NjcgMjEuNTUxOSAyNC4xNzA3IDIxLjcwNjIgMjQuMzIyN0wyOS4zNTEgMzEuODUyQzI5LjUwNTMgMzIuMDAzOSAyOS43OTQ2IDMyLjE5MzkgMzAuMDAwNCAzMi4yNzYyTDMwLjIxMjUgMzIuMzU4NkMzMC40MTE5IDMyLjQ0MDkgMzAuNzU5MSAzMi41MTA1IDMwLjk3NzcgMzIuNTEwNUgzNS45Mjg0QzM2LjE0NyAzMi41MTA1IDM2LjMyNyAzMi4zMzMyIDM2LjMyNyAzMi4xMTc5VjMwLjI3NTJDMzYuMzI3IDMwLjA1OTkgMzYuMTQ3IDI5Ljg4MjYgMzUuOTI4NCAyOS44ODI2SDMxLjUzMDZDMzEuMzEyIDI5Ljg4MjYgMzEuMDAzNCAyOS43NTU5IDMwLjg0OTEgMjkuNjAzOUwyNC41NDE3IDIzLjM5MThDMjQuMzg3NCAyMy4yMzk4IDI0LjM4NzQgMjIuOTkyOSAyNC41NDE3IDIyLjgzNDZMMzAuODQ5MSAxNi42MjI0QzMxLjAwMzQgMTYuNDcwNCAzMS4zMTIgMTYuMzQzOCAzMS41MzA2IDE2LjM0MzhIMzUuOTI4NEMzNi4xNDcgMTYuMzQzOCAzNi4zMjcgMTYuMTY2NSAzNi4zMjcgMTUuOTUxMlYxNC4xMDg0QzM2LjMyNyAxMy44OTMxIDM2LjE0NyAxMy43MTU4IDM1LjkyODQgMTMuNzE1OFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik01Mi40MjAyIDEzLjcxNThINDEuNTI4NUM0MS4zMDk5IDEzLjcxNTggNDEuMDAxMyAxMy44NDI1IDQwLjg1MzQgMTMuOTk0NEw0MC4wODgzIDE0Ljc1NDNDMzkuOTM0IDE0LjkwNjMgMzkuODA1NCAxNS4yMTAzIDM5LjgwNTQgMTUuNDI1NlYyMS40MTYxQzM5LjgwNTQgMjEuNjMxNCAzOS44MDU0IDIxLjgwODcgMzkuODA1NCAyMS44MDg3VjI0LjAzNzdDMzkuODA1NCAyNC4yNTMgMzkuODA1NCAyNC40MzAzIDM5LjgwNTQgMjQuNDMwM1YzMC44MTM0QzM5LjgwNTQgMzEuMDI4NyAzOS45MzQgMzEuMzMyNyA0MC4wODE5IDMxLjQ4NDdMNDAuODUzNCAzMi4yNDQ2QzQxLjAwNzcgMzIuMzk2NiA0MS4zMDk5IDMyLjUyMzIgNDEuNTI4NSAzMi41MjMySDUyLjQyMDJDNTIuNjM4OCAzMi41MjMyIDUyLjgxODggMzIuMzQ1OSA1Mi44MTg4IDMyLjEzMDZWMzAuMjg3OUM1Mi44MTg4IDMwLjA3MjUgNTIuNjM4OCAyOS44OTUyIDUyLjQyMDIgMjkuODk1Mkg0Mi44NTk1QzQyLjY0MDkgMjkuODk1MiA0Mi40NjA4IDI5LjcxNzkgNDIuNDYwOCAyOS41MDI2VjI0LjgyOTNDNDIuNDYwOCAyNC42MTQgNDIuNjQwOSAyNC40MzY3IDQyLjg1OTUgMjQuNDM2N0g0OS45MTkxQzUwLjEzNzcgMjQuNDM2NyA1MC4zMTc3IDI0LjI1OTQgNTAuMzE3NyAyNC4wNDQxVjIyLjIwNzZDNTAuMzE3NyAyMS45OTIzIDUwLjEzNzcgMjEuODE1IDQ5LjkxOTEgMjEuODE1SDQyLjg1OTVDNDIuNjQwOSAyMS44MTUgNDIuNDYwOCAyMS42Mzc3IDQyLjQ2MDggMjEuNDIyNFYxNi43NDkxQzQyLjQ2MDggMTYuNTMzOCA0Mi42NDA5IDE2LjM1NjUgNDIuODU5NSAxNi4zNTY1SDUyLjQyMDJDNTIuNjM4OCAxNi4zNTY1IDUyLjgxODggMTYuMTc5MSA1Mi44MTg4IDE1Ljk2MzhWMTQuMTIxMUM1Mi44MTg4IDEzLjkwNTggNTIuNjM4OCAxMy43Mjg1IDUyLjQyMDIgMTMuNzI4NSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTg1LjcwNTkgMTUuOTUxMlYxNC4xMDg0Qzg1LjcwNTkgMTMuODkzMSA4NS41MjU5IDEzLjcxNTggODUuMzA3MyAxMy43MTU4SDcyLjMzMjVDNzIuMTEzOSAxMy43MTU4IDcxLjkzMzggMTMuODkzMSA3MS45MzM4IDE0LjEwODRWMTUuOTUxMkM3MS45MzM4IDE2LjE2NjUgNzIuMTEzOSAxNi4zNDM4IDcyLjMzMjUgMTYuMzQzOEg3Ny4wOTAzQzc3LjMwODkgMTYuMzQzOCA3Ny40ODkgMTYuNTIxMSA3Ny40ODkgMTYuNzM2NFYzMi4xMTc5Qzc3LjQ4OSAzMi4zMzMyIDc3LjY2OSAzMi41MTA1IDc3Ljg4NzYgMzIuNTEwNUg3OS43NTg2Qzc5Ljk3NzIgMzIuNTEwNSA4MC4xNTcyIDMyLjMzMzIgODAuMTU3MiAzMi4xMTc5VjE2LjczNjRDODAuMTU3MiAxNi41MjExIDgwLjMzNzMgMTYuMzQzOCA4MC41NTU5IDE2LjM0MzhIODUuMzEzN0M4NS41MzIzIDE2LjM0MzggODUuNzEyNCAxNi4xNjY1IDg1LjcxMjQgMTUuOTUxMiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTY0LjIzNzggMjQuNzIxNkM2NC4wOTY0IDI0LjU1NyA2NC4xNTQyIDI0LjQyNCA2NC4zNzkzIDI0LjQyNEg2Ny42NTE5QzY3Ljg3MDUgMjQuNDI0IDY4LjE3OTEgMjQuMjk3NCA2OC4zMjcgMjQuMTQ1NEw2OS4wOTg2IDIzLjM3MjhDNjkuMjUyOSAyMy4yMjA4IDY5LjM3NSAyMi45MTY5IDY5LjM2ODYgMjIuNzAxNlYxNS41Mzk2QzY5LjM2ODYgMTUuMzI0MyA2OS4yNCAxNS4wMjY3IDY5LjA4NTcgMTQuODc0N0w2OC4xNzkxIDEzLjk5NDVDNjguMDI0OCAxMy44NDI1IDY3LjcxNjIgMTMuNzIyMiA2Ny40OTc2IDEzLjcyMjJINTcuNTcwNEM1Ny4zNTE4IDEzLjcyMjIgNTcuMDQzMSAxMy44NDg4IDU2Ljg4ODggMTQuMDAwOEw1Ni4xMTczIDE0Ljc2MDdDNTUuOTYzIDE0LjkxMjcgNTUuODQwOCAxNS4yMTY2IDU1Ljg0MDggMTUuNDMxOVYzMi4xMTc5QzU1Ljg0MDggMzIuMzMzMyA1Ni4wMjA4IDMyLjUxMDYgNTYuMjM5NSAzMi41MTA2SDU4LjEwNEM1OC4zMjI2IDMyLjUxMDYgNTguNTAyNyAzMi4zMzMzIDU4LjUwMjcgMzIuMTE3OVYxNi43MzY0QzU4LjUwMjcgMTYuNTIxMSA1OC42ODI3IDE2LjM0MzggNTguOTAxMyAxNi4zNDM4SDY2LjI1NjdDNjYuNDc1MyAxNi4zNDM4IDY2LjY1NTMgMTYuNTIxMSA2Ni42NjE4IDE2LjczNjRMNjYuNjc0NiAyMS40MDk4QzY2LjY3NDYgMjEuNjI1MSA2Ni41MDEgMjEuODAyNCA2Ni4yODI0IDIxLjgwMjRINjEuODEzOUM2MS41OTUzIDIxLjgwMjQgNjEuMzM4MSAyMS45NjA3IDYxLjI0ODEgMjIuMTU3TDYwLjU3MyAyMy42MTM1QzYwLjQ4MyAyMy44MDk4IDYwLjUyMTUgMjQuMTAxMSA2MC42Njk0IDI0LjI2NTdMNjcuMjY2MSAzMi4yMTI5QzY3LjQwNzYgMzIuMzc3NiA2Ny43MDMzIDMyLjUxMDYgNjcuOTIyIDMyLjUxMDZINzAuNjQxN0M3MC44NjAzIDMyLjUxMDYgNzAuOTI0NiAzMi4zNzc2IDcwLjc3NjcgMzIuMjEyOUw2NC4yMTg1IDI0LjcyMTZINjQuMjM3OFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMTkuOTI0IDI5Ljg4MjZIMTEyLjM5NUMxMTIuMTc3IDI5Ljg4MjYgMTExLjk5NyAyOS43MDUzIDExMS45OTcgMjkuNDlWMTQuMTE0OEMxMTEuOTk3IDEzLjg5OTUgMTExLjgxNyAxMy43MjIyIDExMS41OTggMTMuNzIyMkgxMDkuNzMzQzEwOS41MTUgMTMuNzIyMiAxMDkuMzM1IDEzLjg5OTUgMTA5LjMzNSAxNC4xMTQ4VjMwLjgwNzFDMTA5LjMzNSAzMS4wMjI0IDEwOS40NjMgMzEuMzI2NCAxMDkuNjE4IDMxLjQ3ODRMMTEwLjM4OSAzMi4yMzgzQzExMC41NDMgMzIuMzkwMiAxMTAuODQ2IDMyLjUxNjkgMTExLjA2NCAzMi41MTY5SDExOS45MjRDMTIwLjE0MyAzMi41MTY5IDEyMC4zMjMgMzIuMzM5NiAxMjAuMzIzIDMyLjEyNDNWMzAuMjgxNUMxMjAuMzIzIDMwLjA2NjIgMTIwLjE0MyAyOS44ODg5IDExOS45MjQgMjkuODg4OSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwNS4wNTkgMTMuOTk0NEMxMDQuOTA1IDEzLjg0MjUgMTA0LjU5NiAxMy43MTU4IDEwNC4zNzcgMTMuNzE1OEg5NC42NTU5Qzk0LjQzNzMgMTMuNzE1OCA5NC4xMjg3IDEzLjg0MjUgOTMuOTc0NCAxMy45OTQ0TDkzLjIwMjggMTQuNzU0M0M5My4wNDg1IDE0LjkwNjMgOTIuOTE5OSAxNS4yMTAzIDkyLjkxOTkgMTUuNDI1NlYzMi4xMTE2QzkyLjkxOTkgMzIuMzI2OSA5My4wOTk5IDMyLjUwNDIgOTMuMzE4NiAzMi41MDQySDk1LjE4MzFDOTUuNDAxNyAzMi41MDQyIDk1LjU4MTggMzIuMzI2OSA5NS41ODE4IDMyLjExMTZWMTYuNzQyN0M5NS41ODE4IDE2LjUyNzQgOTUuNzYxOCAxNi4zNTAxIDk1Ljk4MDQgMTYuMzUwMUgxMDMuMTExQzEwMy4zMjkgMTYuMzUwMSAxMDMuNTA5IDE2LjUyNzQgMTAzLjUxNiAxNi43NDI3VjIxLjQwOThDMTAzLjUxNiAyMS42MjUxIDEwMy4zNDIgMjEuODAyNCAxMDMuMTI0IDIxLjgwMjRIOTcuNDA3N0M5Ny4xODkxIDIxLjgwMjQgOTcuMDA5MSAyMS45Nzk3IDk3LjAwOTEgMjIuMTk1VjI0LjAzNzdDOTcuMDA5MSAyNC4yNTMgOTcuMTg5MSAyNC40MzAzIDk3LjQwNzcgMjQuNDMwM0gxMDQuNTEyQzEwNC43MzEgMjQuNDMwMyAxMDUuMDMzIDI0LjMwMzcgMTA1LjE4OCAyNC4xNTE3TDEwNS45NTkgMjMuMzc5MUMxMDYuMTEzIDIzLjIyNzIgMTA2LjIzNiAyMi45MjMyIDEwNi4yMjkgMjIuNzA3OVYxNS40MDY2QzEwNi4yMjkgMTUuMTkxMyAxMDYuMDk0IDE0Ljg5MzcgMTA1Ljk0IDE0Ljc0MTdMMTA1LjA0NiAxNC4wMDA4TDEwNS4wNTkgMTMuOTk0NFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik04Ny40NTQ5IDI5LjUwMjlIODUuMzY1M0M4NS4xMjA5IDI5LjUwMjkgODQuOTIxNiAyOS42OTkyIDg0LjkyMTYgMjkuOTM5OVYzMi4wNjc2Qzg0LjkyMTYgMzIuMzA4MiA4NS4xMjA5IDMyLjUwNDUgODUuMzY1MyAzMi41MDQ1SDg3LjQ1NDlDODcuNjk5MiAzMi41MDQ1IDg3Ljg5ODUgMzIuMzA4MiA4Ny44OTg1IDMyLjA2NzZWMjkuOTM5OUM4Ny44OTg1IDI5LjY5OTIgODcuNjk5MiAyOS41MDI5IDg3LjQ1NDkgMjkuNTAyOVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=");
        width: 173px;
        height: 60px;
        margin: 10px 10px 10px 10px;
    }
    
    .desktop-header .menu-root a {
        color: #C8CCCE;
    }
    
    .desktop-header .menu-root a:hover {
        color: #FCFDFD;
    }
    
    .desktop-header .menu-root {
        color: #C8CCCE;
    }
    
    .desktop-header .menu-root ul,
    .desktop-header .menu-root li {
        margin: 0;
        padding: 0;
    }
    
    .desktop-header .menu-root ul {
        list-style: none;
        display: flex;
        gap: 15px;
    }
    
    .desktop-header .menu-root li {
        display: flex;
        align-items: center;
    }
    
    .desktop-header .menu-root li.menu-button {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY0MF83OTgyIiBzdHlsZT0ibWFzay10eXBlOmFscGhhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiPgo8cmVjdCB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIGZpbGw9IiNEOUQ5RDkiLz4KPC9tYXNrPgo8ZyBtYXNrPSJ1cmwoI21hc2swXzY0MF83OTgyKSI+CjxwYXRoIGQ9Ik0xMC4xNjY3IDEzLjI5NjlMNSA4LjI5MTY3TDYuMzMzMzMgN0wxMC4xNjY3IDEwLjcxMzVMMTQgN0wxNS4zMzMzIDguMjkxNjdMMTAuMTY2NyAxMy4yOTY5WiIgZmlsbD0iI0M4Q0NDRSIvPgo8L2c+Cjwvc3ZnPgo=");
        background-repeat: no-repeat;
        background-position: right center;
        padding-right: 25px;
    }
    
    .desktop-header .menu-root li.menu-button.active {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY0MF83OTg4IiBzdHlsZT0ibWFzay10eXBlOmFscGhhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiPgo8cmVjdCB4PSIyMCIgeT0iMjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdHJhbnNmb3JtPSJyb3RhdGUoLTE4MCAyMCAyMCkiIGZpbGw9IiNEOUQ5RDkiLz4KPC9tYXNrPgo8ZyBtYXNrPSJ1cmwoI21hc2swXzY0MF83OTg4KSI+CjxwYXRoIGQ9Ik05LjgzMzU4IDYuNzAzMTJMMTUuMDAwMiAxMS43MDgzTDEzLjY2NjkgMTNMOS44MzM1OCA5LjI4NjQ2TDYuMDAwMjQgMTNMNC42NjY5MSAxMS43MDgzTDkuODMzNTggNi43MDMxMloiIGZpbGw9IiNGQ0ZERkQiLz4KPC9nPgo8L3N2Zz4K");
        color: #FCFDFD;
    }
    
    .desktop-header .language {
        height: 50px;
        width: 50px;
        background-repeat: no-repeat;
        background-position: center;
        margin-left: auto;
        display: inline-block;
    }
    
    .desktop-header .language.pl {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzcyNF8xMDM2MCkiPgo8cGF0aCBkPSJNMTkuNTU1NiAzLjA1NTY2SDIuNDQ0NDRDMS43OTYxNCAzLjA1NTY2IDEuMTc0MzggMy4zMTMyIDAuNzE1OTYxIDMuNzcxNjNDMC4yNTc1MzkgNC4yMzAwNSAwIDQuODUxOCAwIDUuNTAwMTFMMCAxMS4wMDAxSDIyVjUuNTAwMTFDMjIgNC44NTE4IDIxLjc0MjUgNC4yMzAwNSAyMS4yODQgMy43NzE2M0MyMC44MjU2IDMuMzEzMiAyMC4yMDM5IDMuMDU1NjYgMTkuNTU1NiAzLjA1NTY2WiIgZmlsbD0iI0VFRUVFRSIvPgo8cGF0aCBkPSJNMCAxNi41QzAgMTcuMTQ4MyAwLjI1NzUzOSAxNy43NzAxIDAuNzE1OTYxIDE4LjIyODVDMS4xNzQzOCAxOC42ODY5IDEuNzk2MTQgMTguOTQ0NCAyLjQ0NDQ0IDE4Ljk0NDRIMTkuNTU1NkMyMC4yMDM5IDE4Ljk0NDQgMjAuODI1NiAxOC42ODY5IDIxLjI4NCAxOC4yMjg1QzIxLjc0MjUgMTcuNzcwMSAyMiAxNy4xNDgzIDIyIDE2LjVWMTFIMFYxNi41WiIgZmlsbD0iI0RDMTQzQyIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzcyNF8xMDM2MCI+CjxyZWN0IHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K");
    }
    
    .desktop-header .language.en {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzc4MV8xMDkzNSkiPgo8cGF0aCBkPSJNMTMuMDYyNSAxOC41NjI1SDE4LjU2MjVDMTkuMjQyMSAxOC41NjI1IDE5LjgxOTYgMTguNDA5MiAyMC4yOTkyIDE4LjE0MjFMMTMuMDYyNSAxMy44MjUzVjE4LjU2MjVaTTIxLjg4MzIgMTUuODg0N0MyMS45NjE1IDE1LjUzNTEgMjIuMDAxNCAxNS4xNjQ5IDIyLjAwMTQgMTQuNzgwOVYxMy4wNjIySDE3LjE1MTFMMjEuODgxOCAxNS44ODQ3TTAuMTIwMzUzIDYuMTA0NjZDMC4wMzg4ODU4IDYuNDcwMzggLTAuMDAxNDY4NjMgNi44NDQwNiA0LjA4MjMyZS0wNSA3LjIxODc1VjguOTM3NUg0Ljg2ODkyTDAuMTIwMzUzIDYuMTA0NjZaTTguOTM3NTQgMy40Mzc1SDMuNDM3NTRDMi43NjI3NiAzLjQzNzUgMi4xODkwNCAzLjU4ODc1IDEuNzExNTcgMy44NTIwNkw4LjkzNzU0IDguMTYyNjlWMy40Mzc1Wk0xLjczMzU3IDE4LjE1ODlDMi4yMDY1NyAxOC40MTQ3IDIuNzcyNzMgMTguNTYyNSAzLjQzNzU0IDE4LjU2MjVIOC45Mzc1NFYxMy44NjE0TDEuNzMzNTcgMTguMTU4OVpNNC4wODIzMmUtMDUgMTMuMDYyNVYxNC43ODEyQzQuMDgyMzJlLTA1IDE1LjE3NjkgMC4wNDE5NzgzIDE1LjU1ODEgMC4xMjQ4MjIgMTUuOTE2N0w0LjkwOTQ4IDEzLjA2MjVINC4wODIzMmUtMDVaTTIwLjMyMDggMy44Njg5MUMxOS44Mzc1IDMuNTk0NTkgMTkuMjUyMSAzLjQzNzUgMTguNTYyNSAzLjQzNzVIMTMuMDYyNVY4LjE5ODc4TDIwLjMyMDggMy44Njg5MVpNMjIgOC45Mzc1VjcuMjE4NzVDMjIgNi44NDI2OSAyMS45NjEyIDYuNDgwMDMgMjEuODg1OSA2LjEzNjk3TDE3LjE5MTcgOC45Mzc1SDIyWiIgZmlsbD0iIzJFMzE5MiIvPgo8cGF0aCBkPSJNMTcuMTkxNiA4LjkzNzVMMjEuODg1OSA2LjEzNjk3QzIxLjY3MDcgNS4xNTI0NyAyMS4xNDY4IDQuMzM3NDQgMjAuMzIwOCAzLjg2ODkxTDEzLjA2MjUgOC4xOTg3OFYzLjQzNzVIMTIuMzc1VjkuNjI1SDIyVjguOTM3NUgxNy4xOTE2Wk0wIDEyLjM3NVYxMy4wNjI1SDQuOTA5NDRMMC4xMjQ3ODEgMTUuOTE2N0MwLjM1MiAxNi44OTgxIDAuODkxNjg4IDE3LjcwMzggMS43MzM1MyAxOC4xNTg5TDguOTM3NSAxMy44NjE0VjE4LjU2MjVIOS42MjVWMTIuMzc1SDBaTTIyIDEyLjM3NUgxMi4zNzVWMTguNTYyNUgxMy4wNjI1VjEzLjgyNTNMMjAuMjk5MSAxOC4xNDI0QzIxLjEzMTMgMTcuNjc5MSAyMS42NjE3IDE2Ljg2ODUgMjEuODgxOCAxNS44ODU0TDE3LjE1MTEgMTMuMDYyNUgyMlYxMi4zNzVaTTguOTM3NSAzLjQzNzVWOC4xNjI2OUwxLjcxMTUzIDMuODUyMDZDMC44NzYyMTkgNC4zMTI2OSAwLjM0MjM3NSA1LjEyMTg4IDAuMTE5OTY5IDYuMTA0NjZMNC44Njg4OCA4LjkzNzVIMFY5LjYyNUg5LjYyNVYzLjQzNzVIOC45Mzc1WiIgZmlsbD0iI0U2RTdFOCIvPgo8cGF0aCBkPSJNMTIuMzc1IDkuNjI1VjMuNDM3NUg5LjYyNVY5LjYyNUgwVjEyLjM3NUg5LjYyNVYxOC41NjI1SDEyLjM3NVYxMi4zNzVIMjJWOS42MjVIMTIuMzc1WiIgZmlsbD0iI0JFMUUyRCIvPgo8cGF0aCBkPSJNNy41NDA4IDguOTM3ODZMMC42NDg2MDkgNC44MjM1MkMwLjUwMDQ1MyA1LjA0MzUyIDAuMzgxNTE2IDUuMjg1NTIgMC4yODMyMDMgNS41NDMzM0w1Ljk3MTIzIDguOTM3ODZINy41Mzk3N00yMS42ODY4IDE2LjUzMTNMMTUuOTA3MyAxMy4wNjI5SDE0LjMwNjhMMjEuMjg5NCAxNy4yNjMxQzIxLjQ1MTMgMTcuMDM2OSAyMS41ODQ4IDE2Ljc5MTUgMjEuNjg2OCAxNi41MzI3TTIwLjg3MTggNC4yNTk3N0wxMy4wNTE1IDguOTM3ODZMMTQuNjM5MiA4LjkzODg5TDIxLjM4NzQgNC44OTg4QzIxLjIzNjggNC42MjQ4MyAyMS4wNzggNC40NDgxNCAyMC44NzE4IDQuMjU5NzdaTTAuNjIyODI4IDE3LjE0NDlDMC43Nzc0NTggMTcuMzgwNCAwLjk2MzU0NCAxNy41OTM3IDEuMTc1OTIgMTcuNzc4OEw4Ljk1ODc3IDEzLjA2MjlINy4zOTAyM0wwLjYyMjgyOCAxNy4xNDQ5WiIgZmlsbD0iI0JFMUUyRCIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzc4MV8xMDkzNSI+CjxyZWN0IHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K");
    }
    
    .desktop-header .search {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMjM0NyIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTIzNDcpIj4KPHBhdGggZD0iTTIzLjczMTUgMjUuMzMzN0wxNy4yNzE5IDE4Ljg4MjlDMTYuNzYzMyAxOS4yNzIzIDE2LjE3ODMgMTkuNTg1NSAxNS41MTcxIDE5LjgyMjVDMTQuODU1OSAyMC4wNTk2IDE0LjE1MjMgMjAuMTc4MSAxMy40MDYzIDIwLjE3ODFDMTEuNTI0NCAyMC4xNzgxIDkuOTMwNjkgMTkuNTIxOCA4LjYyNTIxIDE4LjIwOTNDNy4zMTk3MyAxNi44OTc1IDYuNjY2OTkgMTUuMzAxOSA2LjY2Njk5IDEzLjQyMjVDNi42NjY5OSAxMS41NDMyIDcuMzE5NzMgOS45NDcyNSA4LjYyNTIxIDguNjM0NzRDOS45MzA2OSA3LjMyMjkxIDExLjUyNDQgNi42NjY5OSAxMy40MDYzIDYuNjY2OTlDMTUuMjg4MiA2LjY2Njk5IDE2Ljg4NjQgNy4zMjI5MSAxOC4yMDA3IDguNjM0NzRDMTkuNTE0MyA5Ljk0NzI1IDIwLjE3MTEgMTEuNTQzMiAyMC4xNzExIDEzLjQyMjVDMjAuMTcxMSAxNC4xNjc1IDIwLjA1NjggMTQuODcwMiAxOS44MjgzIDE1LjUzMDVDMTkuNTk5IDE2LjE5MDggMTkuMjg5NSAxNi43NjY1IDE4Ljg5OTUgMTcuMjU3NUwyNS4zMzM3IDIzLjcwODNMMjMuNzMxNSAyNS4zMzM3Wk0xMy40MDYzIDE3Ljg0MTZDMTQuNjQ0IDE3Ljg0MTYgMTUuNjk1MSAxNy40MTM5IDE2LjU1OTggMTYuNTU4NUMxNy40MjQ1IDE1LjcwMzkgMTcuODU2OCAxNC42NTg1IDE3Ljg1NjggMTMuNDIyNUMxNy44NTY4IDEyLjE4NjYgMTcuNDI0NSAxMS4xNDA5IDE2LjU1OTggMTAuMjg1NUMxNS42OTUxIDkuNDMwODQgMTQuNjQ0IDkuMDAzNSAxMy40MDYzIDkuMDAzNUMxMi4xNjg3IDkuMDAzNSAxMS4xMjE5IDkuNDMwODQgMTAuMjY2IDEwLjI4NTVDOS40MDk1MiAxMS4xNDA5IDguOTgxMjUgMTIuMTg2NiA4Ljk4MTI1IDEzLjQyMjVDOC45ODEyNSAxNC42NTg1IDkuNDA5NTIgMTUuNzAzOSAxMC4yNjYgMTYuNTU4NUMxMS4xMjE5IDE3LjQxMzkgMTIuMTY4NyAxNy44NDE2IDEzLjQwNjMgMTcuODQxNloiIGZpbGw9IiNGQ0ZERkQiLz4KPC9nPgo8L3N2Zz4K");
        height: 50px;
        width: 50px;
        background-repeat: no-repeat;
        background-position: center;
        display: inline-block;
    }
    
    .desktop-header .report-incident {
        margin: 0 10px 0 10px;
    }

    .desktop-header .visit-notifications {
        color: #000;
        background-color: #fcc33e;
    }

    .desktop-header .visit-notifications:hover {
        background-color: #ffe4ae;
    }
    
    .desktop-header .slide-menu-overlay {
        width: 100%;
        position: absolute;
        background-color: #212E3B;
        display: none;
        transition: height 0.2s ease-out, background-color 0.2s ease-out;
        overflow: hidden;
        z-index: 99999999;
    }
    
    .desktop-header.active .slide-menu-overlay {
        background-color: #121F29;
    }
    
    @media (max-width: 1160px) {
        .desktop-header .slide-menu-overlay {
            padding: 0 15px;
        }
    }
    
    .desktop-header .slide-menu-container {
        position: relative;
        max-width: 1110px;
        margin: 0 auto;
    }
    
    .desktop-header .slide-menu {
        display: none;
        padding-bottom: 2rem;
    }
    
    .desktop-header .slide-menu .menu-header {
        color: #858889;
        font-size: 1.2rem;
        padding-top: 1rem;
        padding-bottom: 1.3rem;
    }
    
    .desktop-header .slide-menu .links {
        display: flex;
        flex-wrap: wrap;
        font-size: 1.4rem;
    }
    
    .desktop-header .slide-menu-about .links,
    .desktop-header .slide-menu-expert .links
    {
        flex-direction: column;
    }
    
    .desktop-header .slide-menu-expert-container {
        display: flex;
        flex-wrap: wrap;
    }
    
    .desktop-header .slide-menu-expert-container > div {
        width: 50%;
    }
    
    .desktop-header .slide-menu .links a {
        color: #C8CCCE;
        width: 50%;
        padding-bottom: 15px;
    }
    
    .desktop-header .slide-menu .links a:hover {
        color: #FCFDFD;
    }
</style>

<script>
    $(function() {
        let open = false;
        let active = null;
        let closeTimer = null;
        
        $('.desktop-header .menu-root .menu-button').on('mouseover', function() {
            let new_active = $(this).data('menu');
            
            if (active && active !== new_active) {
                $('.desktop-header .slide-menu-' + active).css({'display': 'none'});
                $('.desktop-header .menu-button').removeClass('active');
            }
            
            $('.desktop-header .slide-menu-' + new_active).css({'display': 'inherit'});
            $(this).addClass('active');
            active = new_active;
            
            let height = $('.desktop-header .slide-menu-' + active)[0].scrollHeight + 'px';
            $('.desktop-header .slide-menu-overlay').css({'height': height});
            
            if (!open) {
                open = true;
                $('.desktop-header').addClass('active');
                $('.desktop-header .slide-menu-overlay').css({'display': 'inherit'});
                
                if (height === '0px') {
                    height = $('.desktop-header .slide-menu-' + active)[0].scrollHeight + 'px';
                    $('.desktop-header .slide-menu-overlay').css({'height': height});
                }
            }
        });
        
        $('.desktop-header').on('mouseover', function() {
           clearTimeout(closeTimer);
        });
        
        $('.desktop-header').on('mouseout', function() {
            if (open) {
                closeTimer = setTimeout(function() {
                    $('.desktop-header').removeClass('active');
                    $('.desktop-header .menu-button').removeClass('active');
                    
                    $('.desktop-header .slide-menu-overlay').css({'height': '0'});

                    let _active = active;
                    setTimeout(function() {
                        $('.desktop-header .slide-menu-' + _active).css({'display': 'none'});
                    }, 250);
                    
                    active = null;
                    open = false;
                }, 400);
            }
        });
    });
</script>

<header class="desktop-header">
    <div class="top">
        <a href="/en/" class="logo"></a>

        <div class="menu-root">
            <ul>
                <li class="menu-button" data-menu="about">About us</li>
                <li class="menu-button" data-menu="expert">For experts</li>
            </ul>
        </div>
    
        
        <a href="../../../../../posts/2018/07/analiza-smoke-loader/" class="language pl" alt="switch language"></a>
        <a href="/en/search" class="search" alt="search"></a>
        
            <a href="https://incydent.cert.pl/#!/lang=en" class="cta primary report-incident"><span>Report an incident</span></a>
    </div>
    <div class="slide-menu-overlay">
        <div class="slide-menu-container">
            <div class="slide-menu slide-menu-about">
                <div class="menu-header">About us</div>
                <div class="links">
                    <a href="../../../../about-us/">About our team</a>
                    <a href="../../../../contact/">Contact</a>
                </div>
            </div>
            <div class="slide-menu slide-menu-kb">
                <div class="menu-header">Baza wiedzy</div>
                <div class="links">
                    <a href="/falszywe-inwestycje">FaÅszywe inwestycje</a>
                    <a href="/falszywe-sklepy">UwaÅ¼aj na faÅszywe sklepy online</a>
                    <a href="/baza-wiedzy/niebezpieczne-platnosci">(Nie)bezpieczne pÅatnoÅci</a>
                    <a href="/baza-wiedzy/falszywi-konsultanci">FaÅszywi konsultanci</a>
                    <a href="/bezpieczne-hasla">Zadbaj o bezpieczne hasÅa i logowanie</a>
                    <a href="/falszywe-zalaczniki">FaÅszywe zaÅÄczniki w mailach</a>
                    <a href="/szybkie-przelewy">FaÅszywe proÅby o szybki przelew</a>
                    <a href="/baza-wiedzy/falszywe-smsy">FaÅszywe SMSy - plaga ostatnich miesiÄcy</a>
                </div>
                
                <div class="menu-header">Biuletyn OUCH!</div>
                <div class="links">
                    <a href="/ouch">Porady bezpieczeÅstwa OUCH!</a>
                </div>
            </div>
            <div class="slide-menu slide-menu-expert">
                <div class="slide-menu-expert-container">
                    <div>
                        <div class="menu-header">For experts</div>
                        <div class="links">
                            <a href="../../../../publications/">Publications</a>
                            <a href="../../../../warning-list/">The Warning List</a>
                        </div>
                    </div>
                    <div>
                        <div class="menu-header">Projects</div>
                        <div class="links">
                            <a href="../../../../n6/">n6</a>
                            <a href="/en/posts/2024/01/artemis-security-scanner/">Artemis</a>
                            <a href="https://mwdb.cert.pl/">MWDB</a>
                        </div>
                    </div>
                    <div>
                        <div class="menu-header">CVD program</div>
                        <div class="links">
                            <a href="../../../../cvd">CVD policy</a>
                            <a href="../../../../cve">Advisories</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br />
    </div>
</header>
        <div class="current-page">
            <div class="grid-container content">
                <div class="cert-title">
    Dissecting Smoke Loader
                </div>
                <div class="cert-subtitle">
    18 July 2018
 |         <a href="../../../../author/michal-praszmo/">MichaÅ Praszmo</a> |         <a href="../../../../tag/analysis/">#analysis</a>,         <a href="../../../../tag/malware/">#malware</a>,         <a href="../../../../tag/smokeloader/">#smokeloader</a>                </div>
            </div>
        </div>

    <div class="content grid-container">
        <div class="grid-x grid-padding-x">
            <div class="main cell entry">
                <div class="article">
                    
	    
	<div class="container">
		<div class="row">
			<div>
				
				<section class="content">
                    
						<article>
														
							<figure class="content">
                                <div class="s-p-co-l">
								    <p><a href="../../../../uploads/2018/07/smoke-24.jpg"><img loading="lazy" class="alignleft size-medium wp-image-14664" src="../../../../uploads/2018/07/smoke-24.jpg" alt="" width="200" height="200" /></a></p>
<p>Smoke Loader (also known as Dofoil) is a relatively small, modular bot that is mainly used to drop various malware families.</p>
<p>Even though it&#8217;s designed to drop other malware, it has some pretty hefty malware-like capabilities on its own.</p>
<p>Despite being quite old, it&#8217;s still going strong, recently being dropped from RigEK and MalSpam campaigns.</p>
<p>In this article we&#8217;ll see how Smoke Loader unpacks itself and interacts with the C2 server.</p>
<p>&nbsp;</p>
<p><span id="more-14604"></span></p>
<p>Smoke Loader first surfaced in June 2011 when it was advertiesed for sale on grabberz.com<a href="#note-1"><sup>1</sup></a> and xaker.name<a href="#note-2"><sup>2</sup></a> by a user called <span style="font-family: monospace;">SmokeLdr</span>.</p>
<p><a href="../../../../uploads/2018/07/forum.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/forum.png" alt="forum.png" /></a></p>
<p style="text-align: center;"><em>Smoke Loader being sold on grabberz.com </em></p>
<p>What&#8217;s interesting is that Smoke Loader is sold only to Russian-language speakers<a href="#note-3"><sup>3</sup></a>.</p>
<p>Since all functionalities are clearly described in the mentioned forum posts up to 2016 there is no point in listing them all here.</p>
<p>The sample we&#8217;ll be analysing is <a href="https://www.virustotal.com/en/file/20dce650c10545ae85005b3fe159df250c4f1275edfe4439e2d5a2d0515029de/analysis/1524764893/">d32834d4b087ead2e7a2817db67ba8ca</a>.</p>
<p><a href="../../../../uploads/2018/07/layers.png"><br />
<img class="aligncenter" style="max-width: 800px;" src="../../../../uploads/2018/07/layers.png" alt="layers.png" /></a></p>
<p style="text-align: center;"><em>Diagram presenting the unpacking timeline</em></p>
<p>If you&#8217;re only interested in the final payload you can take a quick glance at the diagram above and skip to <a href="#layer-iv-final">the final layer</a>.</p>
<h1 id="table of contents">Table of contents</h1>
<ul class="cert_li_before"></p>
<ul>
<li><a href="#layer-i">Layer I</a></li>
<li><a href="#layer-ii">Layer II</a>
<ul>
<li><a href="#debugger-checks">Debugger checks:</a></li>
<li><a href="#lots-of-garbage-code">Lots of garbage code</a></li>
<li><a href="#rc4-encrypted-imports">RC4-encrypted imports:</a></li>
<li><a href="#unpacking">Unpacking</a></li>
</ul>
</li>
<li><a href="#layer-iii">Layer III</a>
<ul>
<li><a href="#jump-chains">Jump chains</a>
<ul>
<li><a href="#defeating">Defeating</a>
<ul>
<li><a href="#attempt-i">Attempt I</a></li>
<li><a href="#attempt-ii">Attempt II</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#debugging-checks">Debugging checks</a></li>
<li><a href="#virtualization-checks">Virtualization checks</a></li>
<li><a href="#function-body-encryption">Function body encryption</a></li>
<li><a href="#assembly-tricks">Assembly tricks</a>
<ul>
<li><a href="#assembly-trick-i">Assembly Trick I</a></li>
<li><a href="#assembly-trick-ii">Assembly Trick II</a></li>
<li><a href="#assembly-trick-iii">Assembly Trick III</a></li>
</ul>
</li>
<li><a href="#custom-imports">Custom imports</a></li>
<li><a href="#unpacking-1">Unpacking</a></li>
</ul>
</li>
<li><a href="#layer-iv-final">Layer IV (final)</a>
<ul>
<li><a href="#string-encryption">String encryption</a></li>
<li><a href="#c2-urls">C2 URLs</a></li>
<li><a href="#packet-structure">Packet structure</a></li>
<li><a href="#program-routine">Program routine</a></li>
</ul>
</li>
<li><a href="#general-iocs">General IOCs</a></li>
<li><a href="#collected-iocs">Collected IOCs</a></li>
<li><a href="#references">References</a></li>
</ul>
<p></ul>
<h1 id="layer-i">Layer I</h1>
<p>The first thing Smoke Loader hits us with is a simple PECompact2 or UPX compression.</p>
<p><script src="https://gist.github.com/78493c906a9dbb5885abd9847e97e5e6.js"></script></p>
<p>As with many executable compressions, both are pretty easy do decompress using publicly-accessible software:</p>
<p><a href="../../../../uploads/2018/07/pecompact.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/pecompact.png" alt="pecompact.png" /></a></p>
<p style="text-align: center;"><em>PECompact being used to decompress the first layer </em></p>
<p><script src="https://gist.github.com/909345e42314de961c0cb1db714fbd8d.js"></script></p>
<p style="text-align: center;"><em> Decompressing UPX-packed sample </em></p>
<p>That wasn&#8217;t hard, let&#8217;s move on.</p>
<h1 id="layer-ii">Layer II</h1>
<p><a href="../../../../uploads/2018/07/function_first.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/function_first.png" alt="function_first.png" /></a></p>
<p style="text-align: center;"><em>Entry function, which handles the debugging check and performs some useless api calls as a disguise</em></p>
<p>&nbsp;</p>
<h2 id="debugger-checks">Debugger checks</h2>
<p>The PEB structure is checked against some debugging challenges:</p>
<p><script src="https://gist.github.com/31efcb82a5295a3a6664b6a27bab76d7.js"></script></p>
<h2 id="lots-of-garbage-code">Lots of garbage code</h2>
<p>Almost every function is injected with pointless instructions in order to make the disassembly more complicated than it really is.</p>
<p><a href="../../../../uploads/2018/07/trash.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/trash.png" alt="trash.png" /></a></p>
<p style="text-align: center;"><em>A part of RC4 function, which contains a lot of useless code</em></p>
<p>&nbsp;</p>
<h2 id="rc4-encrypted-imports">RC4-encrypted imports</h2>
<p>In this stage, almost all imports and library names are encrypted with RC4 before being passed to <span style="font-family: monospace;">LoadLibraryA</span> and then to <span style="font-family: monospace;">GetProcAddress.</span></p>
<p>The encrypted imports are first placed on stack:</p>
<p><script src="https://gist.github.com/d6daf264fcd410a16aa8f1915c248ae8.js"></script></p>
<p>Then they are decrypted using RC4 with the hardcoded key:</p>
<p><script src="https://gist.github.com/d5b116cf49d2f59d401a612c5e1ccd7d.js"></script></p>
<p>Finally, the library name is passed to <span style="font-family: monospace;">LoadLibrary</span> and the function name to <span style="font-family: monospace;">GetProcAddress:</span></p>
<p><script src="https://gist.github.com/bb85a96d98da534a9403d511cef015aa.js"></script></p>
<p>A custom import table is populated this way and used further in execution.</p>
<p>&nbsp;</p>
<h2 id="unpacking">Unpacking</h2>
<p>Finally, a new process is created and two calls to <span style="font-family: monospace;">WriteProcessMemory</span> are performed:</p>
<p><script src="https://gist.github.com/c37465feb7ab68642c90f6a5bedd255f.js"></script></p>
<p style="text-align: center;"><em> The writes are pretty characteristic and can be easily noticed in the Cuckoo report </em></p>
<p>One of them writes the MZ header and the other rest of the binary. If we concatenate these two writes we&#8217;ll get the next layer.</p>
<p>&nbsp;</p>
<h1 id="layer-iii">Layer III</h1>
<p>We&#8217;re welcomed with:</p>
<p><a href="../../../../uploads/2018/07/woops.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/woops.png" alt="woops.png" /><br />
</a></p>
<p style="text-align: center;"><em> The exported start address </em></p>
<p>Well, that&#8217;s not good.</p>
<p>What we see is a result of several obfuscation methods and tricks, We&#8217;ll look at each one and try to understand how it works.</p>
<p>&nbsp;</p>
<h2 id="jump-chains">Jump chains</h2>
<p>Almost all early-executed functions adapt a <a href="https://thisissecurity.stormshield.com/2018/03/20/de-obfuscating-jump-chains-with-binary-ninja/">chained jumps obfuscation technique</a>.</p>
<p>Instead of placing the instructions in a normal, linear manner, instructions are mixed within the functions with jump instructions connecting consecutive instructions.</p>
<p><a href="../../../../uploads/2018/07/arrows.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/arrows.png" alt="arrows.png" /></a></p>
<p style="text-align: center;"><em>The control flow is all over the place </em></p>
<p>If we were to write a script to follow the program&#8217;s flow and graph instructions we&#8217;d probably get something like this:</p>
<p><a href="../../../../uploads/2018/07/jumps.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/jumps.png" alt="jumps.png" /></a></p>
<p style="text-align: center;"><em>Partially deobufscated start function </em></p>
<p>One can almost immediately see that a vast majority of instructions are used only to divert the natural program flow.</p>
<p>&nbsp;</p>
<h3 id="defeating">Defeating</h3>
<p>&nbsp;</p>
<h4 id="attempt-i">Attempt I</h4>
<p>We tried creating an idaapi script that looks through all instruction blocks within a function and tries to concat blocks that are connected with each other via a 1:1 jump (jump from one possible address to one possible location).</p>
<p>The author had probably thought about that and implemented <span style="font-family: monospace;">jmp</span> instructions using consecutive <span style="font-family: monospace;">jnz</span> and <span style="font-family: monospace;">jz</span> instructions. This doesn&#8217;t complicate our solution too much though.</p>
<p><script src="https://gist.github.com/4b4f149741e08e114f3219eed324b860.js"></script></p>
<p style="text-align: center;"><em> A very naive Python script implementing the mentioned approach </em></p>
<p>If we run it on the start function and strip the jumps we get:</p>
<p><script src="https://gist.github.com/02c85aca543fcaa3a6627d85fbebea97.js"></script></p>
<p>A lot better! But we can actually do even better by letting IDA do most of the work for us.</p>
<p>&nbsp;</p>
<h4 id="attempt-ii">Attempt II</h4>
<p>The only thing we need to do in order to make IDA recognize these blocks as a valid function is to make sure that all of the jumps are marked as a definitive change of flow control.</p>
<p>While <span style="font-family: monospace;">jmp</span> instructions are marked as such by default, the <span style="font-family: monospace;">jz</span>/<span style="font-family: monospace;">jnz</span> instructions need to by patched to jmp instructions:</p>
<p><a href="../../../../uploads/2018/07/patched_jump.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/patched_jump.png" alt="patched_jump.png" /></a></p>
<p style="text-align: center;"><em>Notice the newly-created dotted line that denotes an end of function code </em></p>
<p>This trick allows IDA to recognize function bodies and even attempt to decompile them:</p>
<p><script src="https://gist.github.com/dceedfce91e3630c6d5665347ba6489a.js"></script></p>
<p style="text-align: center;"><em> Decompiled start function after patching all <span style="font-family: monospace;">jn</span>/<span style="font-family: monospace;">jnz</span> instructions </em></p>
<p>While (as almost always) the decompilation isn&#8217;t 100% correct, it gives us a good basic idea what the function does.</p>
<p>This function, for example, loads the PEB structure and then accessess the OSMajorVersion and BeingDebugged fields.</p>
<p>&nbsp;</p>
<h2 id="debugging-checks">Debugging checks</h2>
<p>In this layer, we&#8217;ve noticed 2 debugging checks, conveniently located right at the beginning of execution. While they are the same as in the previous stage the approach differs slightly.</p>
<p>What is interesting is that the debugging checks values are used in calculating the next functions addresses:</p>
<p><script src="https://gist.github.com/0bd593d5bef57ed17fee43725e81067a.js"></script></p>
<p style="text-align: center;"><em> Reading the BeingDebugged field from PEB </em></p>
<p><script src="https://gist.github.com/d7f47fe4b70d966b82d7b961b91bd264.js"></script></p>
<p style="text-align: center;"><em> Reading the NtGlobalFlag field from PEB </em></p>
<p>The code calculates the next jump address based on the values of <span style="font-family: monospace;">BeingDebugged</span> and <span style="font-family: monospace;">NtGlobalFlag</span> fields, if either one is not equal to 0 the execution jumps to a random invalid place in memory, <strong>harsh</strong>.</p>
<p>Normally patching the binary or changing the values mid-debugging works though.</p>
<p>&nbsp;</p>
<h2 id="virtualization-checks">Virtualization checks</h2>
<p>Binary tries to get the module handle of <span style="font-family: monospace;">&#8220;sbiedll&#8221;</span> (a library that is used in sandboxing processes in Sandboxie) using <span style="font-family: monospace;">GetModuleHandleA</span>, if it succeds and thus Sandboxie is installed on the system, the program exits.</p>
<p>A registry key <span style="font-family: monospace;">System\CurrentControlSet\Services\Disk\Enum</span> is checked and if any of the following values are found within the string, the program exits.</p>
<ul class="cert_li_before"></p>
<ul>
<li><span style="font-family: monospace;">qemu</span></li>
<li><span style="font-family: monospace;">virtio</span></li>
<li><span style="font-family: monospace;">vmware</span></li>
<li><span style="font-family: monospace;">vbox</span></li>
<li><span style="font-family: monospace;">xen</span></li>
</ul>
<p></ul>
<h2 id="function-body-encryption">Function body encryption</h2>
<p>A vast majority of functions are encrypted:</p>
<p><script src="https://gist.github.com/bc2b3cc914196a8ea78cb28f390758c8.js"></script></p>
<p style="text-align: center;"><em> A function that is partially encrypted </em></p>
<p>After deobufscation the encryption function turns out to be pretty simple:</p>
<p><script src="https://gist.github.com/f45f00adc7f330f1be9b0abce43cfb63.js"></script></p>
<p style="text-align: center;"><em> Decompiled code decryption method </em></p>
<p>It accepts an address and number of bytes in eax and ecx registers respectively and xors all bytes in that range with a hardcoded byte.</p>
<p>What&#8217;s also interesting is that the binary tries to keep as little code unencrypted at a time as possible:</p>
<p><script src="https://gist.github.com/f4866461f0a53f4c9dee1111d2d88b4b.js"></script></p>
<p style="text-align: center;"><em> Example of keeping the code encrypted </em></p>
<p>We&#8217;re able to decrypt the chunks using an idaapi patching script:</p>
<p><script src="https://gist.github.com/d735072fc54803cfac0c4f24a63ae67d.js"></script></p>
<p style="text-align: center;"><em> Simple idaapi script that xors a given region with a byte </em></p>
<p>&nbsp;</p>
<h2 id="assembly-tricks">Assembly tricks</h2>
<p>This layer employs a few neat position-independent-code assembly tricks.</p>
<p>&nbsp;</p>
<h3 id="assembly-trick-i">Assembly Trick I</h3>
<p><a href="../../../../uploads/2018/07/string_call.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/string_call.png" alt="string_call.png" /><br />
</a></p>
<ul class="cert_li_before"></p>
<ul>
<li><span style="font-family: monospace;">call loc_4024A7</span> puts the next instructions (in this case string <span style="font-family: monospace;">&#8220;kernel32&#8221;</span>) address onto stack and jumps over the data to the code</li>
<li><span style="font-family: monospace;">pop esi</span> puts the string&#8217;s address into esi register</li>
<li><span style="font-family: monospace;">cmp byte ptr [esi], 0</span> the pointer can be now used as a normal rdata string</li>
</ul>
<p></ul>
<p>&nbsp;</p>
<h3 id="assembly-trick-ii">Assembly Trick II</h3>
<p><a href="../../../../uploads/2018/07/jump_return.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/jump_return.png" alt="jump_return.png" /><br />
</a></p>
<p>Instead of executingÂ <span style="font-family: monospace;">jmp eax</span>, <span style="font-family: monospace;">eax</span> is firstly pushed onto stack and then <span style="font-family: monospace;">retn</span> is executed.</p>
<p>&nbsp;</p>
<h3 id="assembly-trick-iii">Assembly Trick III</h3>
<p><a href="../../../../uploads/2018/07/call_next.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/call_next.png" alt="call_next.png" /><br />
</a></p>
<p><span style="font-family: monospace;">call $+5</span> jumps to the next instruction (as <span style="font-family: monospace;">call $+5</span> instruction lengths is 5) but because it&#8217;s a call it also pushes the address onto stack.</p>
<p>In this case this is used to calculate the program&#8217;s base address (<span style="font-family: monospace;">0x004023AA</span> &#8211; <span style="font-family: monospace;">0x23AA</span>)</p>
<p>&nbsp;</p>
<h2 id="custom-imports">Custom imports</h2>
<p>This stage uses a custom import table using a <a href="https://gist.github.com/lmas/664afa94f922c1e58d5c3d73aed98f3f">djb2</a> hash lookup.</p>
<p>It first iterates over 4 hardcoded library names, loads each one using LdrLoadDll and stores the handle.</p>
<p><a href="../../../../uploads/2018/07/load_libraries.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/load_libraries.png" alt="load_libraries.png" /><br />
</a></p>
<p>Next, it iterates over 4 corresponding import hashes arrays and looks for matching values.</p>
<p>When a match is found, it grabs the functions address from the library thunk and stores it in an api table that is stored on the stack.</p>
<p><a href="../../../../uploads/2018/07/home_imports.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/home_imports.png" alt="home_imports.png" /></a></p>
<p style="text-align: center;"><em>Hashes of functions to be imported </em></p>
<p><a href="../../../../uploads/2018/07/api_table.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/api_table.png" alt="api_table.png" /></a></p>
<p style="text-align: center;"><em>Constructed api function table </em></p>
<p>&nbsp;</p>
<h2 id="unpacking-1">Unpacking</h2>
<p>Finally, the program uses RtlDecompressBuffer with COMPRESSION_FORMAT_LZNT1 to decompress the buffer and execute the final payload using PROPagate injection<a href="#note-4"><sup>4</sup></a>.</p>
<p><script src="https://gist.github.com/45324bf3b4e5d07494f166300c4d7e83.js"></script></p>
<p>&nbsp;</p>
<h1 id="layer-iv-final">Layer IV (final)</h1>
<p>&nbsp;</p>
<h2 id="string-encryption">String encryption</h2>
<p>All strings are encrypted using RC4 with a hardcoded key:</p>
<p><script src="https://gist.github.com/47064b1da96286ed1c17d2ddfeb544ac.js"></script></p>
<p style="text-align: center;"><em> Function used to get a decrypted string from a specific index in the encrypted blob </em></p>
<p><a href="../../../../uploads/2018/07/string_packet.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/string_packet.png" alt="string_packet.png" /></a></p>
<p style="text-align: center;"><em>Structure of encrypted strings blob </em></p>
<p>In this sample, the buffer decrypts to:</p>
<p><script src="https://gist.github.com/4bc1f0ee45eafb964b537572d39ed86d.js"></script></p>
<p style="text-align: center;"><em> Decrypted strings </em></p>
<p>&nbsp;</p>
<h2 id="c2-urls">C2 URLs</h2>
<p>C2 URLs are stored encrypted in the data section:</p>
<p><a href="../../../../uploads/2018/07/cncs.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/cncs.png" alt="cncs.png" /></a></p>
<p style="text-align: center;"><em>Part of data section that contains the encrypted URLs </em></p>
<p>The encrypted URL structure can be represented as:<br />
<a href="../../../../uploads/2018/07/c2_packet.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/c2_packet.png" alt="c2_packet.png" /></a></p>
<p style="text-align: center;"><em>Encrypted C2 URL structure </em></p>
<p>The encryption method is a simple xor routine with the byte key being derived from the dword key:</p>
<p><script src="https://gist.github.com/1551aa83e3c5fc7983deca9ed8b5a791.js"></script></p>
<p style="text-align: center;"><em> Decompiled function used to decrypt C2 URLs </em></p>
<p>Which can be rewritten to Python as:</p>
<p><script src="https://gist.github.com/50fc35b50dd058ebb4a8f71e05e50b60.js"></script></p>
<p><script src="https://gist.github.com/1e6512f02f7031c617add4706fab9782.js"></script></p>
<p style="text-align: center;"><em> Output example </em></p>
<p>&nbsp;</p>
<h2 id="packet-structure">Packet structure</h2>
<p><script src="https://gist.github.com/1bace2830f201c9e47df5073a166d9ad.js"></script></p>
<p style="text-align: center;"><em> Decompiled function used to pack and send command packets </em></p>
<p>Which can be represented as a C structure:</p>
<p><script src="https://gist.github.com/9302d81b4a692134400eb78810c92cda.js"></script></p>
<p style="text-align: center;"><em> A struct representing the structure of command packet </em></p>
<p>Packet encryption is done using RC4 yet again. It&#8217;s worth nothing, however, that different keys are used for encrypting the outbound packets and decrypting the inbound ones:</p>
<p><a href="../../../../uploads/2018/07/encrypt_packet.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/encrypt_packet.png" alt="encrypt_packet.png" /></a></p>
<p style="text-align: center;"><em>A part of decompiled function responsible for encrypting packets before sending them to the C2 </em></p>
<p><a href="../../../../uploads/2018/07/decrypt_packet.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/decrypt_packet.png" alt="decrypt_packet.png" /></a></p>
<p style="text-align: center;"><em>A part of decompiled function responsible for decrypting packets before parsing them </em></p>
<p>&nbsp;</p>
<h2 id="program-routine">Program routine</h2>
<ul class="cert_li_before"></p>
<ul>
<li>The binary starts by obtaining a User Agent for IE version acquired by querying registry key <span style="font-family: monospace;">Software\Microsoft\Internet Explorer</span> and values <span style="font-family: monospace;">svcVersion</span> and <span style="font-family: monospace;">Version</span>. The obtained User Agent is used in later HTTP requests.</li>
<li>Next, it tries to connect continuously to <span style="font-family: monospace;">http://www.msftncsi.com/ncsi.txt</span> until it gets a response, this way it makes sure that the machine is connected to the internet.</li>
<li>Finallly, Smoke Loader begins its communication routine by sending a <span style="font-family: monospace;">10001</span> packet to the C&amp;C. It gets a response with a list of plugins to be installed and a number of tasks to be fetched.</li>
<li>The bot iterates over the task range and tries to get each task by sending a <span style="font-family: monospace;">10002</span> packet with the task number as an argument.</li>
<li>The tasks payload is often not hosted on the C&amp;C server but on a different host and a <span style="font-family: monospace;">Location</span> header with the real binary URL is returned instead.</li>
<li>Upon execution of the task, a <span style="font-family: monospace;">10003</span> packet is sent back with arg_1 equal to task number and arg_2 equal to 1 if the task executed succesfully.</li>
</ul>
<p></ul>
<p><a href="../../../../uploads/2018/07/communication.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/communication.png" alt="communnication.png" /></a></p>
<p style="text-align: center;"><em>Graph representation of the communication between bot and C2 </em></p>
<p>&nbsp;</p>
<h2 id="general-iocs">General IOCs</h2>
<ul class="cert_li_before"></p>
<ul>
<li>Program dumps itself to <span style="font-family: monospace;">%APPDATA%\Microsoft\Windows\[a-z]{8}\[a-z]{8}.exe</span></li>
<li>Program creates a shortcut to itself in <span style="font-family: monospace;">%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\[a-z]{8}.lnk</span></li>
<li>Performs a <span style="font-family: monospace;">System\CurrentControlSet\Services\Disk\Enum\0</span> registry query</li>
<li>GET requests to <span style="font-family: monospace;">http://www.msftncsi.com/ncsi.txt</span></li>
<li>POST requests with HTTP 404 responses that include data</li>
</ul>
<p></ul>
<p>Example request and response:</p>
<p><a href="../../../../uploads/2018/07/packet_sample.png"><br />
<img class="aligncenter" style="max-width: 700px;" src="../../../../uploads/2018/07/packet_sample.png" alt="packet_sample.png" /><br />
</a></p>
<p>Yara rule:</p>
<p><script src="https://gist.github.com/61ab19d723da8a5692b54392c61d58ac.js"></script></p>
<p>&nbsp;</p>
<h2 id="collected-iocs">Collected IOCs</h2>
<p>Malware configs:<br />
<script src="https://gist.github.com/ba896aa64e0b9e9213f55057f809c134.js"></script></p>
<p>Hashes:<br />
<script src="https://gist.github.com/nazywam/0685fb14da57db2a48b0708ff93140b7.js"></script></p>
<p>&nbsp;</p>
<h2 id="references">References</h2>
<p id="note-1"><sup>1</sup> <a href="https://grabberz.com/showthread.php?t=29680">https://grabberz.com/showthread.php?t=29680</a></p>
<p id="note-2"><sup>2</sup> <a href="https://web.archive.org/web/20160419010008/http://xaker.name/threads/22008/">https://web.archive.org/web/20160419010008/http://xaker.name/threads/22008/</a></p>
<p id="note-3"><sup>3</sup> <a href="http://stopmalvertising.com/rootkits/analysis-of-smoke-loader.html">http://stopmalvertising.com/rootkits/analysis-of-smoke-loader.html</a></p>
<p id="note-4"><sup>4</sup> <a href="http://www.hexacorn.com/blog/2017/10/26/propagate-a-new-code-injection-trick/">http://www.hexacorn.com/blog/2017/10/26/propagate-a-new-code-injection-trick/</a></p>
<p><a href="https://blog.malwarebytes.com/threat-analysis/2016/08/smoke-loader-downloader-with-a-smokescreen-still-alive/">https://blog.malwarebytes.com/threat-analysis/2016/08/smoke-loader-downloader-with-a-smokescreen-still-alive/</a></p>
                                </div>
								<div class="clearfix"></div>
								                                    
                                                                
                                							</figure>
							<div class="clearfix"></div>
						</article>
				</section>
			</div>
			<div>
							</div>
		</div>
	</div>		

        <style>
            .cert_li_before {
                padding-left: 0;
            }
        </style>
    
                </div>

                    <div class="sharebox">
                            Share:

                            <a class="reddit" href="https://www.reddit.com/submit?url=https%3A//cert.pl/en/posts/2018/07/dissecting-smoke-loader/&title=Dissecting%20Smoke%20Loader"><img class="sprite-reddit-share-icon" src="/theme/assets/img/img.gif"/></a>
                        <a class="twitter" href="https://twitter.com/intent/tweet?text=Dissecting%20Smoke%20Loader&url=https%3A//cert.pl/en/posts/2018/07/dissecting-smoke-loader/&hashtags=analysis,malware,smokeloader"><img class="sprite-twitter-share-icon" src="/theme/assets/img/img.gif"/></a>
                        <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A//cert.pl/en/posts/2018/07/dissecting-smoke-loader/"><img class="sprite-facebook-share-icon" src="/theme/assets/img/img.gif"/></a>
                        <a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//cert.pl/en/posts/2018/07/dissecting-smoke-loader/&title=Dissecting%20Smoke%20Loader&summary=Smoke%20Loader%20%28also%20known%20as%20Dofoil%29%20is%20a%20relatively%20small%2C%20modular%20bot%20that%20is%20mainly%20used%20to%20drop%20various%20malware%20families.%20Even%20though%20it%E2%80%99s%20designed%20to%20drop%20other%20malware%2C%20it%20has%20some%20pretty%20hefty%20malware-like%20capabilities%20on%20its%20own.%20Despite%20being%20quite...&source=https%3A//cert.pl/en/posts/2018/07/dissecting-smoke-loader/"><img class="sprite-linkedin-share-icon" src="/theme/assets/img/img.gif"/></a>
                    </div>
            </div>
        </div>
    </div>

<footer>
        <div class="footer-main">
            <div class="footer-main-wrapper">
                <div class="grid-x grid-padding-x">
                    <div class="large-4 medium-4 small-12 cell">
                        <div class="small-logo"></div>
                        <p>CERT Polska is a team operating within the structures of NASK - National Research Institute,
                            established in 1996 to respond to computer security incidents. It carries out the role of
                            CSIRT NASK, one of three such teams operating at the national level within the Polish national
                            cybersecurity system.</p>
                    </div>
                    <div class="socialmedia large-3 medium-3 small-12 cell">
                        <h1>Social media</h1>
                        <a href="https://www.facebook.com/CERT.Polska/"><img class="sprite-facebook-icon"
                                                                             src="/theme/assets/img/img.gif"
                                                                             aria-hidden="true"/>Facebook</a>
                        <a href="https://x.com/CERT_Polska_en"><img class="x-logo"
                                                                          src="/theme/assets/img/img.gif"
                                                                          aria-hidden="true"/>X</a>
                        <a href="https://www.linkedin.com/showcase/cert-polska"><img class="linkedin-logo"
                                                                          src="/theme/assets/img/img.gif"
                                                                          aria-hidden="true"/>LinkedIn</a>
                        <a href="https://github.com/CERT-Polska"><img class="sprite-github-icon"
                                                                      src="/theme/assets/img/img.gif"
                                                                      aria-hidden="true"/>GitHub</a>
                    </div>
                    <div class="contact large-5 medium-5 small-12 cell text-right">
                        <h1>Contact</h1>
                        <p>
                            Address: Kolska 12, 01-045 Warsaw, Poland<br/>
                            ePUAP: /NASK-Instytut/SkrytkaESP<br/>
                            e-DorÄczenia: AE:PL-60057-61611-BCEGR-11<br/>
                            <br/>
                            E-mail: <a href="/cdn-cgi/l/email-protection#5c35323a331c3f392e28722c30"><span class="__cf_email__" data-cfemail="b3daddd5dcf3d0d6c1c79dc3df">[email&#160;protected]</span></a><br/>
                            Incident reporting: <a href="https://incydent.cert.pl/#!/lang=en">incydent.cert.pl</a><br/>
                            <a href="/cdn-cgi/l/email-protection#94f7f1e6e0d4f7f1e6e0bae4f8"><span class="__cf_email__" data-cfemail="402325323400232532346e302c">[email&#160;protected]</span></a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="footer-bottom-wrapper">
                <div class="float-left">
                    <img src="/theme/assets/img/ue-en.png"
                         alt="Co-financed by the Connecting Europe Facility of The European Union"/>
                </div>
                <div class="footer-bottom-right float-right">
                    <ul class="menu">
                        <li>Â© 2025 <a href="https://nask.pl/">NASK</a></li>
                        <li><a href="/uploads/misc/privacy-policy-en.pdf">Privacy policy</a></li>
                        <li><a href="https://csirt.gov.pl/">CSIRT GOV</a></li>
                        <li><a href="https://csirt-mon.wp.mil.pl/">CSIRT MON</a></li>
                    </ul>
                </div>
            </div>
        </div>
</footer>


<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>