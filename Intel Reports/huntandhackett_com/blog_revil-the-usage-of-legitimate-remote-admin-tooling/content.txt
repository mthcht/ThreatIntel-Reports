<!doctype html><html lang="en"><head><script type="application/javascript" id="hs-cookie-banner-scan" data-hs-allowed="true" src="/_hcms/cookie-banner/auto-blocking.js?portalId=8272645&amp;domain=www.huntandhackett.com"></script>
    <meta charset="utf-8">
    <title>REvil: the usage of legitimate remote admin tooling</title>
    <link rel="shortcut icon" href="https://www.huntandhackett.com/hubfs/HH_Icon.png">
    <meta name="description" content="In this blog post, we will look into the traces left behind by the usage of ScreenConnect.">
    
    
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Lato:regular|Playfair+Display:regular&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link href="https://fonts.googleapis.com/css?family=Lato:regular|Playfair+Display:regular&amp;display=swap" rel="stylesheet" type="text/css">
    </noscript>

    
		
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="In this blog post, we will look into the traces left behind by the usage of ScreenConnect.">
    <meta property="og:title" content="REvil: the usage of legitimate remote admin tooling">
    <meta name="twitter:description" content="In this blog post, we will look into the traces left behind by the usage of ScreenConnect.">
    <meta name="twitter:title" content="REvil: the usage of legitimate remote admin tooling">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'â€º';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.huntandhackett.com/hs-fs/hubfs/hub_generated/template_assets/1/33930362451/1740732728209/template_main.css">
<link rel="stylesheet" href="https://www.huntandhackett.com/hs-fs/hub/8272645/hub_generated/module_assets/33930691666/1655726214089/module_33930691666_Atomic_-_Header.min.css">
<link class="hs-async-css" rel="preload" href="https://www.huntandhackett.com/hs-fs/hub/8272645/hub_generated/template_assets/33924883556/1655728453972/Hunt_and_Hackett/css/_header_row_01_01.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.huntandhackett.com/hs-fs/hub/8272645/hub_generated/template_assets/33924883556/1655728453972/Hunt_and_Hackett/css/_header_row_01_01.min.css"></noscript>

		<style>
			.atmc-header {
				
				  position: absolute;
				
			}
			.atmc-header.sticky {
				background-color: #FFFFFF;
			}
			.atmc-header-default {
				background-color: #FFFFFF;
			}
			@media (max-width: 991px) {
				.atmc-header {
					background-color: #FFFFFF;
				}
				.atmc-header-transparent {
					
					  position: absolute;
					
				}
			}
		</style>
	
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick-theme.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hamburgers/1.1.3/hamburgers.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.0/animate.min.css">
<style>
  @font-face {
    font-family: "Lato";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Lato/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Lato/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Playfair Display";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Playfair_Display/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Playfair_Display/regular.woff") format("woff");
  }
</style>

    <script type="application/ld+json">
{
  "mainEntityOfPage" : {
    "@type" : "WebPage",
    "@id" : "https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling"
  },
  "author" : {
    "name" : "Krijn de Mik",
    "url" : "https://www.huntandhackett.com/blog/author/krijn-de-mik",
    "@type" : "Person"
  },
  "headline" : "REvil: the usage of legitimate remote admin tooling",
  "datePublished" : "2021-06-10T10:42:03.000Z",
  "dateModified" : "2022-06-13T10:11:28.528Z",
  "publisher" : {
    "name" : "Hunt & Hackett",
    "logo" : {
      "url" : "https://f.hubspotusercontent40.net/hubfs/8272645/HH_Logo_OnWhite.svg",
      "@type" : "ImageObject"
    },
    "@type" : "Organization"
  },
  "@context" : "https://schema.org",
  "@type" : "BlogPosting",
  "image" : [ "https://8272645.fs1.hubspotusercontent-na1.net/hubfs/8272645/REvil-blog.webp" ]
}
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-migrate/3.3.2/jquery-migrate.min.js"></script>

    
<!--  Added by GoogleAnalytics4 integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;


if (!window._hsGoogleConsentRunOnce) {
  window._hsGoogleConsentRunOnce = true;

  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'wait_for_update': waitForUpdateMillis
  });

  if (useGoogleConsentModeV2) {
    _hsp.push(['useGoogleConsentModeV2'])
  } else {
    _hsp.push(['addPrivacyConsentListener', function(consent){
      var hasAnalyticsConsent = consent && (consent.allowed || (consent.categories && consent.categories.analytics));
      var hasAdsConsent = consent && (consent.allowed || (consent.categories && consent.categories.advertisement));

      gtag('consent', 'update', {
        'ad_storage': hasAdsConsent ? 'granted' : 'denied',
        'analytics_storage': hasAnalyticsConsent ? 'granted' : 'denied',
        'ad_user_data': hasAdsConsent ? 'granted' : 'denied',
        'ad_personalization': hasAdsConsent ? 'granted' : 'denied'
      });
    }]);
  }
}

gtag('js', new Date());
gtag('set', 'developer_id.dZTQ1Zm', true);
gtag('config', 'G-LNLGEXPMWF');
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LNLGEXPMWF"></script>

<!-- /Added by GoogleAnalytics4 integration -->


<!-- Hotjar Tracking Code for https://www.huntandhackett.com/ -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:3872078,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<meta property="og:image" content="https://www.huntandhackett.com/hubfs/REvil-blog.webp">
<meta property="og:image:width" content="2560">
<meta property="og:image:height" content="1707">

<meta name="twitter:image" content="https://www.huntandhackett.com/hubfs/REvil-blog.webp">


<meta property="og:url" content="https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling">
<meta name="twitter:card" content="summary_large_image">

<link rel="canonical" href="https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling">
<meta name="twitter:card" content="summary_large_image">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism.min.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-core.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/autoloader/prism-autoloader.min.js"></script>
<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.huntandhackett.com/blog/rss.xml">
<meta name="twitter:domain" content="www.huntandhackett.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">






    
  <meta name="generator" content="HubSpot"></head>
	
	
	
	
  
	
		

		

		
			
		
	
	
	
	
	
	
		
  <body style="margin: 0; padding: 0;" class="atmc-body-header-transparent">
    
    <div class="body-wrapper   hs-content-id-48520580023 hs-blog-post hs-blog-id-33584457015">
		
			<div data-global-resource-path="Hunt and Hackett/templates/partials/header.html">

  
  







  

  
	<header class="atmc-header atmc-header_static atmc-header-transparent atmc-header-dark">
		<div class="atmc-header_container">		

			
			<div class="atmc-header_logo">
				
				<a href="https://www.huntandhackett.com" class="atmc-header_logo_white">
					
					  
					  
					  <img src="https://www.huntandhackett.com/hubfs/HH_Logo_OnDark.svg" alt="Logo Hunt &amp; Hackett" width="200" height="64">
					
				</a>
				
				<a href="https://www.huntandhackett.com" class="atmc-header_logo_dark">
					
					  
					
					  <img src="https://www.huntandhackett.com/hubfs/HH_Logo_OnWhite.svg" alt="Logo Hunt &amp; Hackett" width="150" height="48">
					
				</a>
			</div>

			
			
			<div class="atmc-header_menu-wrapper">
				<div class="atmc-header_navigation">
					<div class="atmc-header_menu">
						<div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="default" data-menu-id="33889628180" aria-label="Navigation Menu">
 <ul role="menu" class="active-branch">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.huntandhackett.com/services" aria-haspopup="true" aria-expanded="false" role="menuitem">SERVICES</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/mdr" role="menuitem">Managed Detection &amp; Response (MDR)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/bas" role="menuitem">Breach &amp; Attack Simulation (BAS)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/th" role="menuitem">Threat Hunting (TH)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/ir" role="menuitem">Incident Response (IR)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/spga" role="menuitem">Security Program Gap Assessment (SPGA)</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.huntandhackett.com/threats" aria-haspopup="true" aria-expanded="false" role="menuitem">THREATS</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="javascript:;" role="menuitem">Sector-based threat landscape</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/agriculture" role="menuitem">Agriculture</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/energy" role="menuitem">Energy</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/maritime" role="menuitem">Maritime</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/manufacturing" role="menuitem">Manufacturing</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/technology" role="menuitem">Technology</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/logistics" role="menuitem">Logistics</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/governments" role="menuitem">Governments</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="javascript:;" role="menuitem">Country threat profiles</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/russia" role="menuitem">Russian Federation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/china" role="menuitem">China</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/iran" role="menuitem">Iran</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/north-korea" role="menuitem">North Korea</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/united-states" role="menuitem">United States</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/israel" role="menuitem">Israel</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="javascript:;" role="menuitem">Threat actor profiles</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt28" role="menuitem">Fancy Bear/APT28</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt29" role="menuitem">Cozy Bear/APT29</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt34" role="menuitem">OilRig/APT34</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/charming-kitten" role="menuitem">Charming Kitten/APT35</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt38" role="menuitem">Lazarus/APT38</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt41" role="menuitem">Double Dragon/APT4</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/sandworm" role="menuitem">Sandworm</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/seaturtle" role="menuitem">Seaturtle</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/silent-librarian" role="menuitem">Silent Librarian</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children active-branch" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">RESOURCES</a>
   <ul role="menu" class="hs-menu-children-wrapper active-branch">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/members" role="menuitem">Member portal</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/downloads" role="menuitem">Downloads</a></li>
    <li class="hs-menu-item hs-menu-depth-2 active active-branch" role="none"><a href="https://www.huntandhackett.com/blog" role="menuitem">Blogs</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/cyberconnect" role="menuitem">CyberConnect Roundtables</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/events" role="menuitem">Events</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com/about-us" role="menuitem">ABOUT US</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com/contact" role="menuitem">CONTACT</a></li>
 </ul>
</div>
					</div>
				</div>
			</div>
			

			
			<div class="atmc-header_right">
				<div class="atmc-header_language-switcher-wrapper h-full"></div>
				
				  
				
			</div>
			
			
			
				<div class="atmc-mega-menu">
					
						<div class="atmc-mega-menu_box atmc-mega-menu_box-col atmc-bg-gray700" data-target="0">
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:void(0);" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Managed Services:</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/mdr" role="menuitem" target="_self">Managed Detection &amp; Response (MDR)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/bas" role="menuitem" target="_self">Breach &amp; Attack Simulation (BAS)</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:void(0);" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Professional Services:</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/th" role="menuitem" target="_self">Threat Hunting (TH)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/ir" role="menuitem" target="_self">Incident Response (IR)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/services/spga" role="menuitem" target="_self">Security Program Gap Assessment (SPGA)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="javascript:void(0);" role="menuitem" target="_self">&nbsp;</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
							
								<a href="https://www.huntandhackett.com/services" class="atmc-mega-menu_image" style="background-image:url('https://www.huntandhackett.com/hubfs/pexels-johannes-plenio-1133499.webp');">
									<p class="atmc-btn atmc-btn-outline-white">Our Approach</p>
								</a>
							
						</div>
					
						<div class="atmc-mega-menu_box atmc-mega-menu_box-col atmc-bg-gray700" data-target="1">
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="#" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Sector-based threat landscape</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/agriculture" role="menuitem" target="_self">Agriculture</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/energy" role="menuitem" target="_self">Energy</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/maritime" role="menuitem" target="_self">Maritime</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/manufacturing" role="menuitem" target="_self">Manufacturing</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/technology" role="menuitem" target="_self">Technology</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/logistics" role="menuitem" target="_self">Logistics</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/sectors/governments" role="menuitem" target="_self">Governments</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="#" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Country threat profiles</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/russia" role="menuitem" target="_self">Russian Federation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/china" role="menuitem" target="_self">China</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/north-korea" role="menuitem" target="_self">North Korea</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/iran" role="menuitem" target="_self">Iran</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/united-states" role="menuitem" target="_self">United States</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/countries/israel" role="menuitem" target="_self">Israel</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="#" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Threat actor profiles</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt28" role="menuitem" target="_self">Fancy Bear/APT28</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt29" role="menuitem" target="_self">Cozy Bear/APT29</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt34" role="menuitem" target="_self">OilRig/APT34</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/charming-kitten" role="menuitem" target="_self">Charming Kitten/APT35</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt38" role="menuitem" target="_self">Lazarus/APT38</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/apt41" role="menuitem" target="_self">Double Dragon/APT41</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/sandworm" role="menuitem" target="_self">Sandworm</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/seaturtle" role="menuitem" target="_self">Seaturtle</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/threats/actors/silent-librarian" role="menuitem" target="_self">Silent Librarian</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
							
						</div>
					
						<div class="atmc-mega-menu_box atmc-mega-menu_box-col atmc-bg-gray700" data-target="2">
							
								<div class="atmc-mega-menu_links">
									<span id="hs_cos_wrapper_header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_header_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="#" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Resources</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/members" role="menuitem" target="_self">Member Portal</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/downloads" role="menuitem" target="_self">Downloads</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/blog" role="menuitem" target="_self">Blogs</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/cyberconnect" role="menuitem" target="_self">CyberConnect Roundtables</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.huntandhackett.com/events" role="menuitem" target="_self">Events</a></li>
   </ul></li>
 </ul>
</div></span>
								</div>
							
							
								<a href="https://www.huntandhackett.com/definitive-guide-to-ransomware" class="atmc-mega-menu_image" style="background-image:url('https://www.huntandhackett.com/hubfs/CCS%235%20Header%20Ransomware.jpg');">
									<p class="atmc-btn atmc-btn-outline-white">Definitive Guide to Ransomware</p>
								</a>
							
						</div>
					
				</div>
			

		</div>
	</header>

  
  










  
	
	<div class="atmc-header-hidden hidden">
		
	</div>

	

</div>
			
			

      
<div class="atmc-blog-template-01">
  
  <!-- Hero with Post Image-->
  <div class="atmc-container atmc-container atmc-blog-hero atmc-blog-post_image" style="background-image: url('https://www.huntandhackett.com/hubfs/REvil-blog.webp')"></div>
  <div class="atmc-divider-01-header">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 1920 80"><path fill="#fcaf15" fill-opacity="1" d="M-10,0C960,60,1930,20,1930,20V60S960,20,-10,80Z"></path></svg>
	</div>

	<div class="dnd-section">
    
		<div class="atmc-container atmc-container-m">
			
      <!-- Post Header -->
			<div class="mb-12">
				<h1 class="atmc-headline-03"><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">REvil: the usage of legitimate remote admin tooling</span></h1>

				<div class="atmc-blog-post_meta atmc-cap-07 mb-12">
					
						<a href="https://www.huntandhackett.com/blog/author/krijn-de-mik">
							Krijn de Mik
						</a> @&nbsp; 
					
					<div class="atmc-blog-post_timestamp">
						Jun 10, 2021 12:42:03 PM
					</div>
				</div>
        <div class="atmc-blog-post_intro atmc-intro mb-20">
					<h2 style="text-align: justify;"><span>1. Introduction</span></h2>
<p style="text-align: justify;"><span>Recently, Hunt &amp; Hackett did an incident response engagement involving Sodinokibi (also known as REvil) ransomware. During the incident, the adversary installed a ScreenConnect service on several systems, functioning as a backdoor. This gave the adversary the possibility to connect directly to those systems, without the need of using the Remote Desktop Protocol (RDP), or the need to authenticate (this is required of course for installation of ScreenConnect). This is a rather efficient and effective technique used by more threat actors, next to other types of legitimate Remote Administration Tools like TeamViewer and AnyDesk. Other examples of threat actors that have been using ScreenConnect in the past are the Iranian actor named Static Kitten [<strong>1</strong>] and another targeted ransomware group called Zeppelin [<strong>2</strong>].</span></p>
<p style="text-align: justify;"><span>In this blog post, we will look into the traces left behind by the usage of ScreenConnect remote administration software and how these traces can help defenders with building custom detection.</span></p>
				</div>
			</div>
    </div>
   
			
		<div class="atmc-container atmc-container-m">
      <!-- Post Body -->
			<div class="atmc-blog-post">
			  <div id="" class="atmc-social-links-01 text-left blog-share ">
	
	<div class="inline-flex items-center ds:flex-row">
		
		
			
				<div class="atmc-social-01-wrapper sr-invisible fadeInBottom">
					<a class="atmc-social atmc-social-01 bg-primary fill-primary  atmc-hover-translateY" href="https://www.facebook.com/sharer/sharer.php?u=https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling" rel="noreferrer" target="_blank">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 264 512" aria-hidden="true"><g id="facebook-f1_layer"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229" /></g></svg>
					</a>
				</div>
			
			
				<div class="atmc-social-01-wrapper sr-invisible fadeInBottom">
					<a class="atmc-social atmc-social-01 bg-primary fill-primary  atmc-hover-translateY" href="https://twitter.com/intent/tweet?url=&amp;text=https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling" rel="noreferrer" target="_blank">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" aria-hidden="true"><g id="twitter2_layer"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" /></g></svg>
					</a>
				</div>
			
			
				<div class="atmc-social-01-wrapper sr-invisible fadeInBottom">
					<a class="atmc-social atmc-social-01 bg-primary fill-primary  atmc-hover-translateY" href="https://pinterest.com/pin/create/button/?url=https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling" rel="noreferrer" target="_blank">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 496 512" aria-hidden="true"><g id="pinterest3_layer"><path d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z" /></g></svg>
					</a>
				</div>
			
			
				<div class="atmc-social-01-wrapper sr-invisible fadeInBottom">
					<a class="atmc-social atmc-social-01 bg-primary fill-primary  atmc-hover-translateY" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling" rel="noreferrer" target="_blank">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512" aria-hidden="true"><g id="linkedin-in4_layer"><path d="M100.3 480H7.4V180.9h92.9V480zM53.8 140.1C24.1 140.1 0 115.5 0 85.8 0 56.1 24.1 32 53.8 32c29.7 0 53.8 24.1 53.8 53.8 0 29.7-24.1 54.3-53.8 54.3zM448 480h-92.7V334.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V480h-92.8V180.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V480z" /></g></svg>
					</a>
				</div>
			
		
		
	</div>
	
</div>
				<div class="atmc-blog-post_body mt-8">
					<span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>&nbsp;</p>
<!--more-->
<h2 style="padding-left: 0cm;"><span style="font-size: 56px;">2.</span> <span><span style="font-size: 56px;">ScreenConnect</span> <span style="font-size: 56px;">traces and detection</span></span></h2>
<p><span>This chapter describes the different traces left by ScreenConnect when it is actively used. Furthermore, some rules are provided in order to detect the usage of ScreenConnect on a system, or in an infrastructure.&nbsp;</span></p>
<h3>2.1 ScreenConnect funtionality</h3>
<p>ConnectWise Control [<span style="font-weight: bold;">3</span>] (formerly known as ScreenConnect) is advertised as a solution that "gives your techs full remote access to remotely control, troubleshoot, and update client devices". It should not come as a surprise that ScreenConnect can thus also be used for malicious purposes. <br>Via the web interface, ConnectWise Control (among others) offers functionality to remotely:</p>
<ul>
<li>Execute arbitrary commands;</li>
<li>Terminate processes;</li>
<li>Uninstall software;</li>
<li>View event logs;</li>
<li>Start / Stop services;</li>
<li>Install Windows updates.</li>
</ul>
<p>Additionally, ConnectWise Control allows an operator to take control of a machine's desktop session. During a recent incident response case, the File Transfer functionality was among others used to upload MimiKatz [<span style="font-weight: bold;">4</span>] to a compromised system, as well as to upload other tools like Advanced IP Scanner and the actual ransomware.<br><br></p>
<p><img loading="lazy" src="https://www.huntandhackett.com/hubfs/image-png-2.png" style="margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect Join Machine"></p>
<p style="text-align: center;"><span style="font-size: 16px; color: #fcaf15;"><span style="font-weight: bold;">Figure 1</span>- Machine with status connected in ConnectWise Control.</span></p>
<p>&nbsp;</p>
<p>All events related to ScreenConnect can be found in the Windows event logs and are logged with the provider name '<span style="font-family: 'Courier New', Courier, monospace;">ScreenConnect Client (&lt;hex string&gt;)</span>'. More specifically in the <span style="font-family: 'Courier New', Courier, monospace;">Application.evtx</span> and <span style="font-family: 'Courier New', Courier, monospace;">System.evtx</span> log files, which can generally be found at the following location:</p>
<ul>
<li><span style="font-family: 'Courier New', Courier, monospace;">C:\Windows\System32\winevt\logs\&lt;event log file&gt;.evtx</span></li>
</ul>
<p>In <em>Table 2</em> an overview is given of the different events that are being logged in the Windows event logs, what is being logged, in which log file the event can be found and what the corresponding EventID Is. <br><br></p>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto;">
<table style="width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #99acc2; height: 315px;">
<tbody>
<tr style="height: 38px;">
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;"><strong>Event</strong></td>
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;"><strong>Value</strong></td>
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;"><strong>Log</strong></td>
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;"><strong>EventID</strong></td>
</tr>
<tr style="height: 38px;">
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;"><strong>Service being installed</strong></td>
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;">A service was installed in the system</td>
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;">System</td>
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;">7045</td>
</tr>
<tr style="height: 67px;">
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;"><strong>Start of remote session</strong></td>
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;">Cloud Account Administrator Connected</td>
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;">Application</td>
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;">0</td>
</tr>
<tr style="height: 67px;">
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;"><strong>Closing of remote session</strong></td>
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;">Cloud Account Administrator Disconnected</td>
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;">Application</td>
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;">0</td>
</tr>
<tr style="height: 67px;">
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;"><strong>File upload/ transfer</strong></td>
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;">Transferred files with action 'Transfer': &lt;list of file names&gt;</td>
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;">Application</td>
<td style="width: 25%; padding: 4px; height: 67px; border: 1px solid #000000;">0</td>
</tr>
<tr style="height: 38px;">
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;"><strong>Command execution</strong></td>
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;">Executed command of length: &lt;size&gt;</td>
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;">Application</td>
<td style="width: 25%; padding: 4px; height: 38px; border: 1px solid #000000;">0</td>
</tr>
</tbody>
</table>
</div>
<p style="text-align: center; font-size: 16px;"><span style="color: #fcaf15;"><span style="font-size: 16px;"><span style="font-weight: bold;">Table 2</span>- Win</span>dows <span style="font-size: 16px;">Event</span> log event information and variables.</span></p>
<h2>2.2 ScreenConnect installation of service</h2>
<p>When ScreenConnect is being installed, it installs itself as a service. Services that are being installed show up in the Windows event logs and can therefore be detected. More specifically, these events can be found in the 'System' event log and get the Event ID 7045. An example of such an event is shown in <em>Figure 2</em>.</p>
<p><img loading="lazy" src="https://www.huntandhackett.com/hs-fs/hubfs/image-png-4.png?width=485&amp;name=image-png-4.png" width="485" style="width: 485px; margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect service installation Windows Eventlog." srcset="https://www.huntandhackett.com/hs-fs/hubfs/image-png-4.png?width=243&amp;name=image-png-4.png 243w, https://www.huntandhackett.com/hs-fs/hubfs/image-png-4.png?width=485&amp;name=image-png-4.png 485w, https://www.huntandhackett.com/hs-fs/hubfs/image-png-4.png?width=728&amp;name=image-png-4.png 728w, https://www.huntandhackett.com/hs-fs/hubfs/image-png-4.png?width=970&amp;name=image-png-4.png 970w, https://www.huntandhackett.com/hs-fs/hubfs/image-png-4.png?width=1213&amp;name=image-png-4.png 1213w, https://www.huntandhackett.com/hs-fs/hubfs/image-png-4.png?width=1455&amp;name=image-png-4.png 1455w" sizes="(max-width: 485px) 100vw, 485px"></p>
<p style="text-align: center; font-size: 16px;"><span style="color: #fcaf15;"><span style="font-weight: bold; font-size: 16px;">Figure 2 </span>- ScreenConnect being installed as a service Windows event.</span></p>
<p>&nbsp;</p>
<h3>2.3 ScreenConnect start and ending of a session</h3>
<p>Once a user decides to '<em>Join</em>' an endpoint (as shown in <em>Figure 1</em>) and to interact with it, a new event is being logged in the Windows Application event log. An example of such a recorded event is shown in <em>Figure 3</em>. A session disconnect is recorded as well and an example is shown in<em> Figure 4</em>.</p>
<p><img loading="lazy" src="https://www.huntandhackett.com/hubfs/image-png-Jun-08-2021-08-54-16-77-AM.png" style="margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect admininstrator connected"></p>
<p style="text-align: center; font-size: 16px;"><span style="color: #fcaf15;"><span style="font-size: 16px;"><span style="font-weight: bold;">Figure 3</span> - Cloud Account Administrator Connected event.</span></span></p>
<p>&nbsp;</p>
<p><img loading="lazy" src="https://www.huntandhackett.com/hubfs/image-png-Jun-08-2021-08-55-24-48-AM.png" style="margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect admininstrator disconnected"></p>
<p style="text-align: center; font-size: 16px;"><span style="color: #fcaf15;"><span style="font-weight: bold; font-size: 16px;">Figure 4</span><span style="font-size: 16px;"> - Cloud Account Administrator Disconnected event.</span></span></p>
<p style="text-align: left;">&nbsp;</p>
<h3 style="text-align: left;"><span style="color: #000000;">2.4 ScreenConnect file transfers</span></h3>
<p style="text-align: left;"><span style="color: #000000;">ScreenConnect offers different ways of interacting with the endpoint on which the ScreenConnect agent is installed. File Transferring is one of them. Files can be both send as well as being retrieved from an endpoint as shown in <em>Figure 5</em>.</span></p>
<p style="text-align: left;"><span style="color: #000000;"><img loading="lazy" src="https://www.huntandhackett.com/hubfs/image-png-Jun-08-2021-08-57-04-08-AM.png" style="margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect control panel"></span></p>
<p style="text-align: center; font-size: 10px;"><span style="color: #fcaf15;"><span style="font-weight: bold; font-size: 16px;">Figure 5</span><span style="font-size: 16px;"> - ConnectWise Control file transfer functionality.</span></span></p>
<p style="text-align: left;"><span style="color: #000000;">When files are transferred, the Windows Application event log not only records this as an event, but also registers the file that is being exchanged. In <em>Figure 6</em> the file payload.exe is transferred to the endpoint. Do note that the retrieval of files is not logged in the Windows Application event log.</span></p>
<p style="text-align: left;"><span style="color: #000000;"><img loading="lazy" src="https://www.huntandhackett.com/hubfs/image-png-Jun-08-2021-11-51-50-47-AM.png" style="margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect Filetransfer"></span></p>
<p style="text-align: center;"><span style="font-size: 16px; color: #fcaf15;"><span style="font-weight: bold;">Figure 6</span> - Windows event log event indicating a file has been transferred.</span></p>
<p style="text-align: left;">&nbsp;</p>
<h3 style="text-align: left;">2.5 ScreenConnect command execution</h3>
<p style="text-align: justify;"><span>Another form of interaction with an endpoint is command execution. Via the ConnectWise Control center it's possible to type a command, hit the '<em>Run Command</em>' button, after which the command Is executed. The commands that are allowed to be used are the commands that are generally supported by the Windows Command Prompt. An example of the interface in ConnectWise Control is shown in </span><em><span>Figure 7</span></em><span>.</span></p>
<p style="text-align: justify;"><span style="font-size: 1.1rem; font-family: Lato;"><span><img loading="lazy" src="https://www.huntandhackett.com/hubfs/image-png-Jun-08-2021-11-53-25-98-AM.png" style="margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect command execution."></span></span></p>
<p style="text-align: center; font-size: 16px;"><span style="font-family: Lato; color: #fcaf15;"><span style="font-size: 16px;"><span style="font-weight: bold;">Figure 7</span> - ConnectWise Control command execution functionality.</span></span></p>
<p style="text-align: justify;"><span>Upon execution of an operator invoked task, a Windows Event is generated that indicates a command of a certain length has been executed, as shown in </span><em><span>Figure 8</span></em><span>. The type of executed task cannot be derived from the Windows Event Logs. However, manually-executed shell commands are launched from <span style="font-family: 'Courier New', Courier, monospace;">ScreenConnect.ClientService.exe</span> as command (</span><span style="font-family: 'Courier New', Courier, monospace;">.cmd</span><span>) scripts, whereas tasks like process listing and termination&nbsp;are executed via Powershell (</span><span style="font-family: 'Courier New', Courier, monospace;">.ps1</span><span>) scripts.</span></p>
<p style="text-align: justify;"><span><img loading="lazy" src="https://www.huntandhackett.com/hubfs/image-png-Jun-08-2021-11-55-22-29-AM.png" style="margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect command execution eventlog"></span></p>
<p style="text-align: center; font-size: 16px;"><span style="color: #fcaf15;"><span style="font-size: 16px;"><span style="font-weight: bold;">Figure 8</span> - Windows Eventlog event indicating an executed command.</span></span></p>
<p style="text-align: justify;"><span>The process of a command task being launched by <span style="font-family: 'Courier New', Courier, monospace;">ScreenConnect.ClientService.exe</span>, the actual execution of the command and the result are outlined in a bit more detail as shown in </span><em><span>Table 3</span></em><span>.</span></p>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto;">
<table style="width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #99acc2; height: 114px;">
<tbody>
<tr style="height: 38px;">
<td style="width: 100%; padding: 4px; height: 38px;"><span style="font-family: 'Courier New', Courier, monospace;">C:\Program Files (x86)\ScreenConnect Client (&lt;hex string&gt;)\ScreenConnect.ClientService.exe</span></td>
</tr>
<tr style="height: 38px;">
<td style="width: 100%; padding: 4px 4px 4px 44px; height: 38px;"><span style="font-family: 'Courier New', Courier, monospace;">--&gt; "cmd.exe" /c "C:\Windows\TEMP\ScreenConnect\&lt;version&gt;\&lt;uuid&gt;run.cmd"</span></td>
</tr>
<tr style="height: 38px;">
<td style="width: 100%; padding: 4px 4px 4px 84px; height: 38px;"><span style="font-family: 'Courier New', Courier, monospace;">--&gt; &lt;executed shell command&gt;</span></td>
</tr>
</tbody>
</table>
<span style="font-size: 16px; color: #fcaf15;"><strong>Table 3</strong> - Execution chain of command via the ConnectWise Control interface.</span></div>
<p>&nbsp;</p>
<h3>2.6 ScreenConnect detection and response</h3>
<p>Installation of and interaction with ScreenConnect can be detected. We have developed Carbon Black and YARA-L rules to support detection efforts. These rules can be found in appendix 1, at the bottom of this page. Furthermore, from a forensics perspective, the fact that <span style="font-family: 'Courier New', Courier, monospace;">ScreenConnect.ClientService.exe</span> writes either the command(s) to a <span style="font-family: 'Courier New', Courier, monospace;">.cmd</span>, or a <span style="font-family: 'Courier New', Courier, monospace;">.ps1</span> file before executing the command, might make it possible (hasn't been tested yet by Hunt &amp; Hackett) to carve for these files. This potentially shines a bit more light on the actual commands that have been executed by the adversary.</p>
<h2 style="font-size: 56px;">3. Anti-forensics and robust detection</h2>
<p style="text-align: justify;"><span>ScreenConnect event logs can indicate that an operator has connected to a machine or performed certain actions like executing commands or transferring files.</span></p>
<p style="text-align: justify;"><span>At first glance, it might appear that monitoring for ScreenConnect events might be enough to detect malicious usage of ScreenConnect. This is however not something we can always assume. For robust detection we cannot take for granted that all information is always available. </span></p>
<p style="text-align: justify;"><span>For example, we cannot just rely on the Windows event logs. ScreenConnect events are generated by the application itself, meaning that a determined attacker can prevent any logs from being created. The ScreenConnect client uses the <span style="font-weight: normal; font-family: 'Courier New', Courier, monospace;">TryWriteInformationToEventLog()</span> function to log certain events.</span></p>
<p style="text-align: justify;">&nbsp;</p>
<p style="text-align: justify;"><span><img loading="lazy" src="https://www.huntandhackett.com/hubfs/image-png-Jun-08-2021-12-03-10-45-PM.png" style="margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect event log operation."></span></p>
<p style="text-align: center; font-size: 16px;"><span style="color: #fcaf15;"><span style="font-size: 16px;"><span style="font-weight: bold;">Figure 9</span> - ScreenConnect event log operation.</span></span><span><span style="font-size: 16px;"></span></span></p>
<p style="font-size: 16px; text-align: left;">&nbsp;</p>
<p style="text-align: justify;"><span style="font-family: 'Courier New', Courier, monospace;">TryWriteInformationToEventLog()</span><span> is implemented in the unsigned <span style="font-family: 'Courier New', Courier, monospace;">ScreenConnect.Core.dll</span> module and, below the surface, is merely a wrapper around <span style="font-weight: normal;"><span style="font-family: 'Courier New', Courier, monospace;">EventLog.WriteEntry()</span>.</span> If we can modify the application in such a way that<span style="font-family: 'Courier New', Courier, monospace;"> EventLog.WriteEntry()</span> is no longer ever executed, we can prevent the generation of event logs.</span></p>
<p style="text-align: justify;">&nbsp;</p>
<p style="text-align: justify;"><span><img loading="lazy" src="https://www.huntandhackett.com/hubfs/image-png-Jun-08-2021-12-04-30-21-PM.png" style="margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect eventlog write function."></span></p>
<p style="font-size: 16px; text-align: center;"><span style="color: #fcaf15;"><span style="font-size: 16px;"><span style="font-weight: bold;">Figure 10</span> - ScreenConnect write to EventLog.WriteEntry.</span></span></p>
<p style="font-size: 16px; text-align: left;">&nbsp;</p>
<p style="text-align: justify;"><span>To demonstrate that we can prevent ScreenConnect from logging events, we can patch the bytecode of <span style="font-family: 'Courier New', Courier, monospace;">ScreenConnect.Core.dll</span><em>,</em> using a tool like <em>dnSpy </em>[<span style="font-weight: bold;">5</span>], and overwrite the call to <span style="font-family: 'Courier New', Courier, monospace;">EventLog.WriteEntry() </span>in <span style="font-family: 'Courier New', Courier, monospace;">TryWriteInformationToEventLog()</span>, as shown in </span><em>Figure 11</em><span>. This ensures that ScreenConnect can no longer generate any events and will create less evidence. </span></p>
<p style="text-align: justify;"><span>For this proof-of-concept, we manually patched out the call to <span style="font-family: 'Courier New', Courier, monospace;">EventLog.WriteEntry()</span>. A determined attacker could of course implement this anti-forensics technique in a different way.</span></p>
<p style="text-align: justify;"><img loading="lazy" src="https://www.huntandhackett.com/hubfs/image-png-Jun-08-2021-12-05-45-68-PM.png" style="margin-left: auto; margin-right: auto; display: block;" alt="ScreenConnect eventlog write function patch."></p>
<p style="text-align: center;"><span style="font-size: 16px; color: #fcaf15;"><span style="font-weight: bold;">Figure 11</span> - Patching the write to event log functionality of ScreenConnect.</span></p>
<p style="text-align: justify;">&nbsp;</p>
<p style="text-align: justify;">In case an attacker would use such a modified version of ScreenConnect, we cannot just rely on the Windows event logs. Instead, detection should also focus on the execution of suspicious executables, whether it being ScreenConnect being launched / installed by the attacker or executable files being started via the build-in Run Command functionality.&nbsp;</p>
<p style="text-align: justify;">In Appendix 1, we have included detection rules for Chronicle and Carbon Black that can detect the initialization of ScreenConnect and the execution of tasks via the control panel, so that you can use these in your SOC or <a href="/mdr" rel="noopener">MDR</a> setup. Additionally, a Sigma rule is publicly available that can detect the initialization of ScreenConnect [<span style="font-weight: bold;">6</span>].</p>
<p style="text-align: justify;">Post Incident, carving of <span style="font-family: 'Courier New', Courier, monospace;">.ps1</span>, or <span style="font-family: 'Courier New', Courier, monospace;">.cmd</span> files might the way to go, in case you would like to have an understanding of the command that might have been executed by the adversary.</p>
<p style="text-align: justify;">&nbsp;</p>
<h2 style="text-align: justify; font-size: 56px;">4. Sources</h2>
<p><span>[1] https://www.anomali.com/blog/probable-iranian-cyber-actors-static-kitten-conducting-cyberespionage-campaign-targeting-uae-and-kuwait-government-agencies</span></p>
<p><span>[2] https://blog.morphisec.com/connectwise-control-abused-again-to-deliver-zeppelin-ransomware</span></p>
<p><span>[3] https://www.connectwise.com/platform/unified-management/control</span></p>
<p><span>[4] https://github.com/gentilkiwi/mimikatz </span></p>
<p>[5] https://github.com/dnSpy/dnSpy</p>
<p>[6] https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_screenconnect_access.yml</p>
<p>&nbsp;</p>
<h2 style="font-size: 56px;">Appendix 1 - Detection rules</h2>
<p>This appendix contains an overview of different rules in both Carbon Black as well as Yara-L format. Additionally, you can find an already existing Sigma rule in the Sigma rule repository&nbsp; '<span style="font-family: 'Courier New', Courier, monospace;">SigmaHQ/sigma/rules/windows/process_creation/win_susp_screenconnect_access.yml</span>',&nbsp; For completeness the Sigma rules is listed in this appendix as well.&nbsp;</p>
<h3>Sigma</h3>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto; font-size: 18px;">
<table style="width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="width: 27.6667%; padding: 4px;"><strong>Action</strong></td>
<td style="width: 72.3333%; padding: 4px;"><strong>Sigma rule</strong></td>
</tr>
<tr>
<td style="width: 27.6667%; padding: 4px;"><strong>ScreenConnect Remote Access detection</strong></td>
<td style="width: 72.3333%; padding: 4px;">
<p><span style="font-family: 'Courier New', Courier, monospace;">title: ScreenConnect Remote Access</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">id: 75bfe6e6-cd8e-429e-91d3-03921e1d7962</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">status: experimental</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">description: Detects ScreenConnect program starts that establish a remote access to that system (not meeting, not remote support)</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">references:</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp; - https://www.anomali.com/blog/probable-iranian-cyber-actors-static-kitten-conducting-cyberespionage-campaign-targeting-uae-and-kuwait-government-agencies</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">author: Florian Roth </span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">date: 2021/02/11</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">logsource:</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp; category: process_creation</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp; product: windows</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">detection:</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp; selection:</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CommandLine|contains|all:</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 'e=Access&amp;'</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 'y=Guest&amp;'</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - '&amp;p='</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - '&amp;c='</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - '&amp;k='</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp; condition: selection</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">falsepositives:</span></p>
<p><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp; - Legitimate use by administrative staff</span></p>
<span style="color: #05142f; font-family: 'Courier New', Courier, monospace;">level: high</span></td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<h3>Carbon Black</h3>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto;">
<table style="width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="width: 42.9167%; padding: 4px;"><strong>Action</strong></td>
<td style="width: 57.0833%; padding: 4px;"><strong>Carbon</strong> <strong>Black</strong> <strong>query</strong></td>
</tr>
<tr>
<td style="width: 42.9167%; padding: 4px;"><strong>ScreenConnect initialisation</strong></td>
<td style="width: 57.0833%; padding: 4px;"><span style="font-family: 'Courier New', Courier, monospace;">(process_cmdline:"y=" OR process_cmdline:"?y=") AND (process_cmdline:"h=" OR process_cmdline:"?h=") AND (process_cmdline:"p=" OR process_cmdline:"?p=") AND (process_cmdline:"s=" OR process_cmdline:"?s=") AND (process_cmdline:"k=" OR process_cmdline:"?k=")</span></td>
</tr>
<tr>
<td style="width: 42.9167%; padding: 4px;"><strong>Task execution through ScreenConnect</strong></td>
<td style="width: 57.0833%; padding: 4px;"><span style="font-family: 'Courier New', Courier, monospace;">(process_name:*screenconnect* OR process_publisher:*ConnectWise*) AND childproc_cmdline:*run.ps1</span></td>
</tr>
<tr>
<td style="width: 42.9167%; padding: 4px;"><strong>Cmd command execution through ScreenConnect</strong></td>
<td style="width: 57.0833%; padding: 4px;"><span style="font-family: 'Courier New', Courier, monospace;">(process_name:*screenconnect* OR process_publisher:*ConnectWise*) AND childproc_cmdline:*run.cmd</span></td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<h3>Yara-L&nbsp;</h3>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto; font-size: 18px;">
<table style="width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="width: 20.25%; padding: 4px;"><strong>Action</strong></td>
<td style="width: 79.75%; padding: 4px;"><strong>Rule</strong></td>
</tr>
<tr>
<td style="width: 20.25%; padding: 4px;"><strong>ScreenConnect initialisation</strong></td>
<td style="width: 79.75%; padding: 4px;"><span style="font-family: 'Courier New', Courier, monospace;">rule screenconnect_initialisation {</span><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp;meta:</span><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;author = "Hunt &amp; Hackett"</span><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;description = "Detects ScreenConnect initialisation"</span><br><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp;events: </span><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.metadata.event_type = "PROCESS_LAUNCH"</span><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.principal.process.command_line = /(\?|\&amp;|\;)y=/ nocase</span><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.principal.process.command_line = /(\?|\&amp;|\;)h=/ nocase</span><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.principal.process.command_line = /(\?|\&amp;|\;)p=/ nocase</span><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.principal.process.command_line = /(\?|\&amp;|\;)s=/ nocase</span><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.principal.process.command_line = /(\?|\&amp;|\;)k=/ nocase</span><br><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp;condition: </span><br><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e</span><br><span style="font-family: 'Courier New', Courier, monospace;">}</span></td>
</tr>
<tr>
<td style="width: 20.25%; padding: 4px;"><strong>ScreenConnect task execution</strong></td>
<td style="width: 79.75%; padding: 4px;">
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">rule screenconnect_task_execution {</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;"> &nbsp; &nbsp; &nbsp;meta:</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;author = "Hunt &amp; Hackett"</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;description = "Detects task execution through ScreenConnect"</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;"> &nbsp; &nbsp; &nbsp;events: </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.metadata.event_type = "PROCESS_LAUNCH" </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.principal.process.file.full_path = /ScreenConnect/ nocase and</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.target.process.file.full_path = /powershell.exe/ nocase</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;or </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.principal.process.command_line = /(powershell\.exe)(.*)([a-f0-9-]{36}run\.ps1)/ nocase</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;&nbsp; </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;"> &nbsp; &nbsp; &nbsp;condition: </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e</span></p>
<span style="color: #05142f; font-family: 'Courier New', Courier, monospace;">}</span></td>
</tr>
<tr>
<td style="width: 20.25%; padding: 4px;"><strong>ScreenConnect command execution</strong></td>
<td style="border: 1pt solid #bfbfbf; width: 79.75%; padding: 4px;" width="643">
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">rule screenconnect_cmd_command_execution {</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;"> &nbsp; &nbsp; &nbsp;meta:</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;author = "Hunt &amp; Hackett"</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;description = "Detects cmd command execution through ScreenConnect"</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;"> &nbsp; &nbsp; &nbsp;events: </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.metadata.event_type = "PROCESS_LAUNCH"</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.principal.process.file.full_path = /ScreenConnect/ nocase and</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.target.process.file.full_path = /cmd.exe/ nocase</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;or</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e.principal.process.command_line = /(cmd\.exe)(.*)(\/c)(.*)([a-f0-9-]{36}run\.cmd)/ nocase</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;"> &nbsp; &nbsp; &nbsp;condition: </span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$e</span></p>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0cm; padding-left: 0cm; font-size: 16px;"><span style="font-family: 'Courier New', Courier, monospace;">}</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p style="text-align: justify; font-size: 18px;">&nbsp;</p></span>
				</div>
				
				<div class="atmc-blog-post_tags my-8">
					
  					<a class="atmc-blog-post_tag-link" href="https://www.huntandhackett.com/blog/tag/detection-technology">Detection technology</a>
					
  					<a class="atmc-blog-post_tag-link" href="https://www.huntandhackett.com/blog/tag/detection-logic">Detection logic</a>
					
  					<a class="atmc-blog-post_tag-link" href="https://www.huntandhackett.com/blog/tag/mdr">MDR</a>
					
  					<a class="atmc-blog-post_tag-link" href="https://www.huntandhackett.com/blog/tag/detection-data-sources">Detection data sources</a>
					
  					<a class="atmc-blog-post_tag-link" href="https://www.huntandhackett.com/blog/tag/tactics-techniques-procedures">Tactics, Techniques &amp; Procedures</a>
					
				</div>
				
			</div>
		</div>
	</div>
	
	

	
	

  <div class="atmc-divider-01-prefooter">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 1920 80"><path fill="#EFF1F4" fill-opacity="1" d="M-10,0C960,90,1920,30,1930,30V90S960,30,-10,120Z"></path></svg>
	</div>
  
  <div class="dnd-section text-center" style="background-color: #EFF1F4">
    <h2 class="atmc-headline-03 atmc-headline-03-primary text-center mb-12">
      Keep me informed
    </h2>
    <p>
      <a href="/keep-me-informed/" class="cta_button atmc-btn-secondary atmc-btn-m">Sign up for the newsletter</a>
    </p>    
  </div>
  
  <div class="atmc-divider-01-footer">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 1920 80"><path fill="#fcaf15" fill-opacity="1" d="M-10,0C960,60,1930,20,1930,20V60S960,20,-10,80Z"></path></svg>
	</div>
		
</div>



      <div data-global-resource-path="Hunt and Hackett/templates/partials/footer.html"><footer class="footer atmc-parallax  text-white" style="
					
            background-color:#4a5278;
					
	      ">
    
	 
    <div class="atmc-site-footer">
			<div class="atmc-container">
				<div class="row-fluid">
				
					<div class="span4 mb:mb-8">
						
						
						  <div class="">
								
								
								  
									<p><img src="https://www.huntandhackett.com/hubfs/HH_Logo_OnDark.svg" alt="HH_Logo_OnDark" width="280" style="width: 280px; margin: 0px;" loading="lazy"></p>
<p>&nbsp;</p>
								  
								
						  </div>
						
						
					</div>
				
					<div class="span8 mb:mb-8">
						
						
						  <div class="">
								
								
									
							<div class="atmc-footer_menu_HH">
              <span id="hs_cos_wrapper_footer-module_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer-module_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com/hubfs/20231214_H2_privacy_statement.pdf" role="menuitem" target="_self">Privacy</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com/press" role="menuitem" target="_self">Press</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com/jobs" role="menuitem" target="_self">Jobs</a></li>
 </ul>
</div></span>
									</div>
                								  
								
						  </div>
						
						  <div class="mt-8">
								
								
									
							<div class="atmc-footer_menu_HH">
              <span id="hs_cos_wrapper_footer-module_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer-module_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.linkedin.com/company/huntandhackett/" role="menuitem" target="_blank" rel="noopener">LinkedIn</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://twitter.com/huntandhackett" role="menuitem" target="_blank" rel="noopener">X</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://mastodon.social/@huntandhackett@mastodon.social" role="menuitem" target="_blank" rel="noopener">Mastodon</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://bsky.app/profile/huntandhackett.com" role="menuitem" target="_blank" rel="noopener">Bluesky</a></li>
 </ul>
</div></span>
									</div>
                								  
								
						  </div>
						
						
					</div>
				
			  </div>
			</div>
    </div>
	
		
		<div class="atmc-footer" style="background-color:#4a5278;">
      <div class="atmc-container">
        <div class="row-fluid">
          <div class="span7">
						<div class="footer__copyright">
							MADE IN EUROPE
						</div>
          </div>
					
						<div class="span5">
							<div class="atmc-footer_menu">
								<span id="hs_cos_wrapper_footer-module_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer-module_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.huntandhackett.com" role="menuitem" target="_self">COPYRIGHT 2024 HUNT &amp; HACKETT</a></li>
 </ul>
</div></span>
							</div>
						</div>
					
        </div>
      </div>
    </div>

		
	
</footer></div>
    </div>
    
		
		
    
		
		
		
		
		
		
		
    
		
    
		
		
    
    
    
		
		
		
    

    
<!-- HubSpot performance collection script -->
<script defer src="/hs/hsstatic/content-cwv-embed/static-1.1293/embed.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://www.huntandhackett.com/hs-fs/hub/8272645/hub_generated/module_assets/33930691666/1655726213377/module_33930691666_Atomic_-_Header.min.js"></script>
<script src="/hs/hsstatic/keyboard-accessible-menu-flyouts/static-1.17/bundles/project.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.matchHeight/0.7.2/jquery.matchHeight-min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.js"></script>
<script src="https://unpkg.com/scrollreveal"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://www.huntandhackett.com/hs-fs/hub/8272645/hub_generated/template_assets/33930818457/1713945865808/Hunt_and_Hackett/js/main.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.huntandhackett.com\/blog\/revil-the-usage-of-legitimate-remote-admin-tooling"]);
_hsq.push(["setPageId", "48520580023"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 48520580023,
    "legacyPageId": "48520580023",
    "contentFolderId": null,
    "contentGroupId": 33584457015,
    "abTestId": null,
    "languageVariantId": 48520580023,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/8272645.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "cf03a09f-552b-4c22-897d-783bc21f4037",
    ticks: 1741971601525,
    page_id: 48520580023,
    
    content_group_id: 33584457015,
    portal_id: 8272645,
    app_hs_base_url: "https://app-eu1.hubspot.com",
    cp_hs_base_url: "https://cp-eu1.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    
    analytics_page_id: "48520580023",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.432/js/index.js"></script>






<script type="text/javascript">
_linkedin_partner_id = "3581561";
window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
window._linkedin_data_partner_ids.push(_linkedin_partner_id);
</script><script type="text/javascript">
(function(l) {
if (!l){window.lintrk = function(a,b){window.lintrk.q.push([a,b])};
window.lintrk.q=[]}
var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})(window.lintrk);
</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://px.ads.linkedin.com/collect/?pid=3581561&amp;fmt=gif">
</noscript>

<style>
/* Increase cookie bar font size on mobile */
/* This can only be fixed here */
@media screen and (max-width: 480px) {
	div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner p { font-size: 14px !important; }
}
</style>
<style>
/* Increase cookie bar font size on mobile */
/* This can only be fixed here */
@media screen and (max-width: 480px) {
	div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner p { font-size: 14px !important; }
}
</style>
<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 



    <style>
      #loadOverlay{display: none;}
    </style>
  
</body></html>