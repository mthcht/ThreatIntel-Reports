<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1758ef4667574398807a9dd0b08d4990"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb16a0fc49194ef3a61c385bd0d0f312"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcd0acdb221c84200a837d97a6bac46a7"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffd3a938d7dfc41bdac34c3f46a36afb2"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5638ee75bf42433c81332c153db5cb15"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4dcf43805cea496b92a4b04334297b54"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd8af97b52a364281ae4ae771eac29f60"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5437345f68ab4fecb25e1bf64d596f05"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe0006e0247a84d538abfdb56270b1971"/><script type="text/javascript" async="" defer="" src="/assets/scripts/drift.js"></script><script type="text/javascript" async="" defer="" src="//js.hs-scripts.com/3911692.js"></script><script type="text/javascript" async="" defer="" src="https://fast.wistia.com/embed/medias/lqy5p1741e.jsonp"></script><script type="text/javascript" async="" defer="" src="https://fast.wistia.com/assets/external/E-v1.js"></script><script type="text/javascript" src="https://flackr.github.io/scroll-timeline/dist/scroll-timeline.js" async=""></script><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4951efeb175d46a28d43a56e44f1aaa6"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2c6e56c396984defa968946c3305fd5d"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fad40fb4e0e8f4fc3a283928e18d2cb07"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1a16399f6f94c3da8e42ddbe735c1c1"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdafe6a53f78a407c80691541d7e292b9"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F25165b11288e4ab8ab0dc72832f4eb5e"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F11f54e8f5fb54aadbf4c71effaab65a5"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff0209e5a35e34a25a31075aca24dec96"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff257bebdca1c45cab6259f8436ca7221"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4cc0a301d59343f08fa3fd23661a7726"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fff7b259c7c5c408f9747e8a28989015b"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7f4ca3bd558f425da4f12b81befbb279"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6aa1f0e921a844ed9975b8c477720a6c"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fac02933fbb964cdf9e6c8b3b2280fa5d"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F75378b21898340b6b863c3b68ae0a980"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fabe11db97e084bfeb9d370076781caea"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea18a565ed0e4bdda1f6881a955de34c"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F98c34785dc62414381fe4d25b1d355a9"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5f3ffde6942c41b6885da8bc727a4cc5"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38494b4ddb7a45a78ca20d43a03176bf"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F33845c53ebd4472b9806d7a76b742616"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3a5e883de76c4f5686d64a1dc0dbe7b6"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F107b70abda5841439fca3a13a02929cf"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F80b5a5a31d2245e49c4038e433792c22"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1490131472ce4b94a57df268649354a0"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3324b3cde0b84f3b8749e3f6577c6540"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fccbc23d75b9640b69566b916ea6f832a"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f33356fc04f46a2ac4a68753ba41658"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffe85f84d0b0c4f9f8743167664735836"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F124e49f43fd041659989deffd90e3b7c"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa59264f69adf4a4cb0092faaf95a5669"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a9064f27e10467cae2ee3bd79beead9"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff043c73bb2de45c6b1102fe11ffebedb"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8"/><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><title>Cobalt Strikes Again: An Analysis of Obfuscated Malware | Huntress</title><meta name="description" content="Join us for a threat hunting adventure as we analyze a suspicious run key that leads us to Cobalt Strike malware hidden across nearly 700 registry values."/><meta property="og:title" content="Cobalt Strikes Again: An Analysis of Obfuscated Malware | Huntress"/><meta property="og:description" content="Join us for a threat hunting adventure as we analyze a suspicious run key that leads us to Cobalt Strike malware hidden across nearly 700 registry values."/><meta property="og:image" content="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F960a09d94f2949da8eb1ff1d3096189c"/><meta property="twitter:title" content="Cobalt Strikes Again: An Analysis of Obfuscated Malware | Huntress"/><meta property="twitter:description" content="Join us for a threat hunting adventure as we analyze a suspicious run key that leads us to Cobalt Strike malware hidden across nearly 700 registry values."/><meta property="twitter:image" content="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F960a09d94f2949da8eb1ff1d3096189c"/><link rel="canonical" href="https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware"/><link rel="icon" href="/assets/favicon-96x96-CtLNOBqH.png" type="image/png" sizes="96x96"/><link rel="icon" href="/assets/favicon-29P8YngA.svg" type="image/svg+xml"/><link rel="shortcut icon" href="/assets/favicon-C5x0nhzu.ico"/><link rel="apple-touch-icon" href="/assets/apple-touch-icon-DudXUahm.png" sizes="180x180"/><meta name="google-site-verification" content="QZk47k59WXGOBjZRZodH6wC5rKaX9MnmeBFsV5jchE4"/><link rel="modulepreload" href="/assets/entry.client-Do6PKLu9.js"/><link rel="modulepreload" href="/assets/chunk-D4RADZKF-Db5SQ-1d.js"/><link rel="modulepreload" href="/assets/index-DGl6nBoU.js"/><link rel="modulepreload" href="/assets/root-C_cireyK.js"/><link rel="modulepreload" href="/assets/root-CSqt9jc4.js"/><link rel="modulepreload" href="/assets/with-props-DyHsk88B.js"/><link rel="modulepreload" href="/assets/snowplow.tracker-510wDdN5.js"/><link rel="modulepreload" href="/assets/blocks-exports-DHMt_CX0.js"/><link rel="modulepreload" href="/assets/data-CNtPYaWj.js"/><link rel="modulepreload" href="/assets/blog._slug-CFhuEuuc.js"/><link rel="modulepreload" href="/assets/metadata-B9f9eOHO.js"/><link rel="modulepreload" href="/assets/config-C81qt7ZA.js"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Cobalt Strikes Again: An Analysis of Obfuscated Malware","author":{"@type":"Person","name":"undefined undefined","url":"https://www.huntress.com/authors/matthew-brennan","jobTitle":"Security Researcher & Technical Writer","sameAs":["https://www.linkedin.com/in/matthew-brennan-69b96bb9/"]},"publisher":{"@type":"Organization","name":"huntress.com","logo":{"@type":"ImageObject","url":"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02"}}}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.huntress.com"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://www.huntress.com/blog"},{"@type":"ListItem","position":3,"name":"Cobalt Strikes Again: An Analysis of Obfuscated Malware"}]}</script><script type="text/javascript" src="/assets/scripts/gtm.js"></script><link rel="stylesheet" href="/assets/root-C5LLCb9u.css"/><link rel="stylesheet" href="/assets/snowplow-2NuIrITE.css"/><link rel="stylesheet" href="/assets/blog-post-CbkYeKVf.css"/><link rel="stylesheet" href="/assets/font-TvAYd24d.css"/><link rel="stylesheet" href="/assets/webflow.styles-BxnLMMz1.css"/><link rel="stylesheet" href="/assets/webflow.head.styles-CrJkTSSR.css"/><link rel="stylesheet" href="/assets/webflow.supplimental.styles-CayIQFpN.css"/><link rel="stylesheet" href="/assets/app-mLTzxWxt.css"/><link rel="stylesheet" href="/assets/metadata-Bn7UM7IX.css"/><script src="https://cdn.optimizely.com/js/5179843176824832.js"></script></head><body class="body"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXRTDGW4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="eager" fetchPriority="high" class="builder-image banner-ellipse desktop css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2"/></picture><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="eager" fetchPriority="high" class="builder-image banner-ellipse mobile css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff"/></picture></div><header id="main-site-header" class="_header_1yozr_1 header-navigation-override " style="will-change:background"><div class="_navigationContainer_1yozr_26 "><div class="_utilityNavigation_1yozr_55 utility-navigation-animation"><a href="https://huntress.io/" target="_blank" class="_links_1yozr_72">Partner Login</a><div class="_searchContainer_1yozr_86"><span class="_searchFieldLabel_1yozr_90 ">Search</span><form class="_searchForm_1yozr_104 " data-hs-cf-bound="true" action="/search"><input class="" autoComplete="false" maxLength="256" placeholder="Search..." type="search" id="header-search" name="query"/><button value=""></button><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1758ef4667574398807a9dd0b08d4990" loading="eager" alt="searchclose icon" class="_searchClose_1yozr_177 "/></form><div class="_searchOverlay_1yozr_155"></div></div></div><div class="_primaryNavigation_1yozr_185"><a class="_brandLogo_1yozr_191" aria-label="home" href="/" data-discover="true"><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02"/></picture></a><div class="_mobileMenuButton_1yozr_217 " aria-label="menu" role="button" tabindex="0" aria-haspopup="menu" aria-expanded="false"><div class="_topLine_1yozr_241 "></div><div class="_middleLine_1yozr_257 "></div><div class="_bottomLine_1yozr_272 "></div></div><div class="_mobileMenuOverlay_1yozr_289" style="height:0"><nav role="navigation" class="_navigationMenu_1yozr_308"><ul role="list" class="_navigationMenuList_1yozr_323"><li class="_menuListItem_1bn8p_1"><div class="_menuListItemContainer_1bn8p_15"><div class="_menuListItemToggle_1bn8p_49 " aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="_menuListItemToggleText_1bn8p_84">Platform</div><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="_menuListItemToggleIcon_1bn8p_130"/></div><div><div class="_navigationMenuDropdown_1bn8p_141 "><div class="_navigationMenuDropdownBackLink_1bn8p_181">Back</div><div class="_navigationMenuDropdownScrollContainer_1bn8p_237 overflow-y-auto overscroll-y-contain"><div class="_navigationMenuDropdownContainer_1bn8p_261 lg:grid lg:grid-cols-[repeat(3,259px))]"><div class="_navigationMenuDropdown_13hdp_1 " style="grid-column:span 2 / span 2"><div class="_nmdd_SectionTitle_13hdp_20 ">Huntress Managed Security Platform</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-2"><a href="/platform/managed-edr" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:40px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb16a0fc49194ef3a61c385bd0d0f312" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Managed EDR</div><div></div><div class="_nmdd_SectionContentItemSummary_13hdp_46"><p>Get full endpoint visibility, detection, and response.</p></div></a><a href="/platform/security-awareness-training" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:40px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcd0acdb221c84200a837d97a6bac46a7" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Managed Security Awareness Training</div><div></div><div class="_nmdd_SectionContentItemSummary_13hdp_46"><p>Empower your teams with science-backed security awareness training.</p></div></a><a href="/platform/managed-itdr" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:40px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffd3a938d7dfc41bdac34c3f46a36afb2" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Managed ITDR</div><div></div><div class="_nmdd_SectionContentItemSummary_13hdp_46"><p>Protect your Microsoft 365 identities and email environments.</p></div></a><a href="/platform/siem" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:40px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5638ee75bf42433c81332c153db5cb15" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Managed SIEM</div><div></div><div class="_nmdd_SectionContentItemSummary_13hdp_46"><p>Managed threat response and robust compliance support at a predictable price.</p></div></a></div><a href="/platform" class="_nmdd_SectionContentFooterLink_13hdp_281" rel=""><div>Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="eager" alt="right arrow" class="_footerLinkIcon_13hdp_301"/></a></div><div class="_navigationMenuDropdown_13hdp_1 _backgroundGray_13hdp_15"><div class="_nmdd_LinkCardContainer_13hdp_57"><div class="_nmdd_SectionTitle_13hdp_20 max-md:pt-0 max-md:pb-[21px] lg:block">&nbsp;</div><a href="/demo" class="_nmdd_SectionContenLinkCard_13hdp_65" rel=""><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4dcf43805cea496b92a4b04334297b54" loading="eager" alt="Huntress Cybersecurity" class="_linkCardThumbnail_13hdp_80"/><div class="_nmdd_LinkCardContent_13hdp_97"><h6 class="_nmdd_LinkCardContentTitle_13hdp_111">Learn More</h6><div class="_nmdd_LinkCardContentSummary_13hdp_159">Try Huntress for free and deploy in minutes to start fighting threats.</div></div></a><a href="/demo" class="_nmdd_SectionContentFooterLink_13hdp_281" rel="  "><div>Request a Demo</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="eager" alt="right arrow" class="_footerLinkIcon_13hdp_301"/></a></div></div></div></div></div></div></div></li><li class="_menuListItem_1bn8p_1"><div class="_menuListItemContainer_1bn8p_15"><div class="_menuListItemToggle_1bn8p_49 " aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="_menuListItemToggleText_1bn8p_84">Solutions</div><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="_menuListItemToggleIcon_1bn8p_130"/></div><div><div class="_navigationMenuDropdown_1bn8p_141 "><div class="_navigationMenuDropdownBackLink_1bn8p_181">Back</div><div class="_navigationMenuDropdownScrollContainer_1bn8p_237 overflow-y-auto overscroll-y-contain"><div class="_navigationMenuDropdownContainer_1bn8p_261 lg:grid lg:grid-cols-[repeat(3,259px))]"><div class="_navigationMenuDropdown_13hdp_1 " style="grid-column:span 1 / span 1"><div class="_nmdd_SectionTitle_13hdp_20 ">Solutions by Topic</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-1"><a href="/solutions/topics/phishing" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd8af97b52a364281ae4ae771eac29f60" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Phishing</div></a><a href="/solutions/topics/cybersecurity-compliance" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5437345f68ab4fecb25e1bf64d596f05" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Compliance</div></a><a href="/solutions/topics/business-email-compromise" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe0006e0247a84d538abfdb56270b1971" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Business Email Compromise</div></a></div></div><div class="_navigationMenuDropdown_13hdp_1 " style="grid-column:span 1 / span 1"><div class="_nmdd_SectionTitle_13hdp_20 ">Solutions by Industry</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-1"><a href="/industries/education" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4951efeb175d46a28d43a56e44f1aaa6" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Education</div></a><a href="/industries/financial-services" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2c6e56c396984defa968946c3305fd5d" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Finance</div></a><a href="/industries/healthcare" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fad40fb4e0e8f4fc3a283928e18d2cb07" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Healthcare</div></a><a href="/industries/manufacturing" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1a16399f6f94c3da8e42ddbe735c1c1" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Manufacturing</div></a><a href="/industries/state-and-local-government" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdafe6a53f78a407c80691541d7e292b9" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">State &amp; Local Government</div></a></div></div><div class="_navigationMenuDropdown_13hdp_1 _backgroundGray_13hdp_15"><div class="_nmdd_LinkCardContainer_13hdp_57"><div class="_nmdd_SectionTitle_13hdp_20 ">Featured Resource</div><a href="https://www.huntress.com/industries/healthcare/healthcare-resource-kit" class="_nmdd_SectionContenLinkCard_13hdp_65" rel=""><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F25165b11288e4ab8ab0dc72832f4eb5e" loading="eager" alt="Huntress Cybersecurity" class="_linkCardThumbnail_13hdp_80"/><div class="_nmdd_LinkCardContent_13hdp_97"><h6 class="_nmdd_LinkCardContentTitle_13hdp_111">Healthcare Cybersecurity Success Kit</h6><div class="_nmdd_LinkCardContentSummary_13hdp_159"><p>Packed with the information, tools, and guidance you need to keep your organization running smoothly and, most importantly, your patients safe.</p></div></div></a><a href="https://www.huntress.com/industries/healthcare/healthcare-resource-kit" class="_nmdd_SectionContentFooterLink_13hdp_281" rel="  "><div>Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="eager" alt="right arrow" class="_footerLinkIcon_13hdp_301"/></a></div></div></div></div></div></div></div></li><li class="_menuListItem_1bn8p_1"><div class="_menuListItemContainer_1bn8p_15"><div class="_menuListItemToggle_1bn8p_49 " aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="_menuListItemToggleText_1bn8p_84">Why Huntress</div><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="_menuListItemToggleIcon_1bn8p_130"/></div><div><div class="_navigationMenuDropdown_1bn8p_141 "><div class="_navigationMenuDropdownBackLink_1bn8p_181">Back</div><div class="_navigationMenuDropdownScrollContainer_1bn8p_237 overflow-y-auto overscroll-y-contain"><div class="_navigationMenuDropdownContainer_1bn8p_261 lg:grid lg:grid-cols-[repeat(3,259px))]"><div class="_navigationMenuDropdown_13hdp_1 " style="grid-column:span 1 / span 1"><div class="_nmdd_SectionTitle_13hdp_20 ">Who We Serve</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-1"><a href="/why-huntress/managed-service-providers" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F11f54e8f5fb54aadbf4c71effaab65a5" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Managed Service Providers</div></a><a href="/why-huntress/value-added-resellers" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff0209e5a35e34a25a31075aca24dec96" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Value Added Resellers</div></a><a href="/why-huntress/businesses-it-teams" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff257bebdca1c45cab6259f8436ca7221" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Business &amp; IT Teams</div></a></div></div><div class="_navigationMenuDropdown_13hdp_1 " style="grid-column:span 1 / span 1"><div class="_nmdd_SectionTitle_13hdp_20 ">The Huntress Difference</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-1"><a href="/why-huntress/24-7-soc" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4cc0a301d59343f08fa3fd23661a7726" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Huntress SOC</div></a><a href="/success-stories" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fff7b259c7c5c408f9747e8a28989015b" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Case Studies</div></a></div></div><div class="_navigationMenuDropdown_13hdp_1 _backgroundGray_13hdp_15" style="grid-column:span 1 / span 1"><div class="_nmdd_SectionTitle_13hdp_20 ">Compare Huntress</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-1"><a href="/comparison/huntress-vs-bitdefender" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">Bitdefender</div></a><a href="/comparison/huntress-vs-blackpoint" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">Blackpoint</div></a><a href="/comparison/huntress-vs-crowdstrike" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">CrowdStrike</div></a><a href="/comparison/huntress-vs-datto" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">Datto</div></a><a href="/comparison/huntress-vs-sentinelone" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">SentinelOne</div></a><a href="/comparison/huntress-vs-sophos" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">Sophos</div></a><a href="/comparison/huntress-vs-webroot" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">Webroot</div></a></div><a href="/comparison" class="_nmdd_SectionContentFooterLink_13hdp_281" rel=""><div>Compare All</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="eager" alt="right arrow" class="_footerLinkIcon_13hdp_301"/></a></div></div></div></div></div></div></li><li class="_menuListItem_1bn8p_1"><div class="_menuListItemContainer_1bn8p_15"><div class="_menuListItemToggle_1bn8p_49 " aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="_menuListItemToggleText_1bn8p_84">Resources</div><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="_menuListItemToggleIcon_1bn8p_130"/></div><div><div class="_navigationMenuDropdown_1bn8p_141 "><div class="_navigationMenuDropdownBackLink_1bn8p_181">Back</div><div class="_navigationMenuDropdownScrollContainer_1bn8p_237 overflow-y-auto overscroll-y-contain"><div class="_navigationMenuDropdownContainer_1bn8p_261 lg:grid lg:grid-cols-[repeat(3,259px))]"><div class="_navigationMenuDropdown_13hdp_1 " style="grid-column:span 1 / span 1"><div class="_nmdd_SectionTitle_13hdp_20 ">Resource Center</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-1"><a href="/resources?assetTypes=Datasheet" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">Datasheets</div></a><a href="/resources?assetTypes=eBook" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">Ebooks</div></a><a href="/resources?assetTypes=Report" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">Reports</div></a><a href="/resources?assetTypes=On-Demand+Webinar" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">On-Demand Webinars</div></a><a href="/resources?assetTypes=Whitepaper" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">Whitepapers</div></a><a href="/resources?assetTypes=Video" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:0px" rel=""><div class="_nmdd_SectionContentItemTitle_13hdp_193">Videos</div></a></div><a href="/resources" class="_nmdd_SectionContentFooterLink_13hdp_281" rel=""><div>View All Resources</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="eager" alt="right arrow" class="_footerLinkIcon_13hdp_301"/></a></div><div class="_navigationMenuDropdown_13hdp_1 " style="grid-column:span 1 / span 1"><div class="_nmdd_SectionTitle_13hdp_20 hidden lg:block">&nbsp;</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-1"><a href="/blog" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7f4ca3bd558f425da4f12b81befbb279" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Blog</div></a><a href="/upcoming-events" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6aa1f0e921a844ed9975b8c477720a6c" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Upcoming Events</div></a><a href="https://support.huntress.io/hc/en-us" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fac02933fbb964cdf9e6c8b3b2280fa5d" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Support Documentation</div></a><a href="/integrations" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F75378b21898340b6b863c3b68ae0a980" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Integrations</div></a><a href="https://hub.huntress.com/#/page/login" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fabe11db97e084bfeb9d370076781caea" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Huntress Hub</div></a></div></div><div class="_navigationMenuDropdown_13hdp_1 _backgroundGray_13hdp_15" style="grid-column:span 1 / span 1"><div class="_nmdd_SectionTitle_13hdp_20 ">Produced by Huntress</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-1"><a href="/tradecraft-tuesday" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:20px" rel=""><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea18a565ed0e4bdda1f6881a955de34c" alt="Tradecraft Tuesday" class="_nmdd_SectionContentItemImage_13hdp_277"/></a><a href="/firesidechat" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:20px" rel=""><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F98c34785dc62414381fe4d25b1d355a9" alt="Fireside Chat" class="_nmdd_SectionContentItemImage_13hdp_277"/></a><a href="/product-lab-channel" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 _noIcon_13hdp_181" style="margin-bottom:20px" rel=""><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5f3ffde6942c41b6885da8bc727a4cc5" alt="Product Lab Channel" class="_nmdd_SectionContentItemImage_13hdp_277"/></a></div></div></div></div></div></div></div></li><li class="_menuListItem_1bn8p_1"><div class="_menuListItemContainer_1bn8p_15"><a class="_menuListItemToggle_1bn8p_49 " rel="  " href="/pricing" target="_self" data-discover="true"><div class="_menuListItemLinkText_1bn8p_104">Pricing</div><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="_menuListItemToggleIcon_1bn8p_130"/></a></div></li><li class="_menuListItem_1bn8p_1"><div class="_menuListItemContainer_1bn8p_15"><div class="_menuListItemToggle_1bn8p_49 " aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="_menuListItemToggleText_1bn8p_84">About</div><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="_menuListItemToggleIcon_1bn8p_130"/></div><div><div class="_navigationMenuDropdown_1bn8p_141 "><div class="_navigationMenuDropdownBackLink_1bn8p_181">Back</div><div class="_navigationMenuDropdownScrollContainer_1bn8p_237 overflow-y-auto overscroll-y-contain"><div class="_navigationMenuDropdownContainer_1bn8p_261 lg:grid lg:grid-cols-[repeat(3,259px))]"><div class="_navigationMenuDropdown_13hdp_1 " style="grid-column:span 1 / span 1"><div class="_nmdd_SectionTitle_13hdp_20 ">About Huntress</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-1"><a href="/company/our-company" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38494b4ddb7a45a78ca20d43a03176bf" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Our Story</div></a><a href="/company/leadership" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F33845c53ebd4472b9806d7a76b742616" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Leadership</div></a><a href="/company/press" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3a5e883de76c4f5686d64a1dc0dbe7b6" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Latest News</div></a><a href="/awards-and-accolades" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F107b70abda5841439fca3a13a02929cf" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Awards</div></a></div></div><div class="_navigationMenuDropdown_13hdp_1 " style="grid-column:span 1 / span 1"><div class="_nmdd_SectionTitle_13hdp_20 hidden lg:block">&nbsp;</div><div class="_nmdd_SectionContent_13hdp_33 grid grid-cols-1 md:grid-cols-1"><a href="/company/careers" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F80b5a5a31d2245e49c4038e433792c22" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Careers</div></a><a href="/upcoming-events" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1490131472ce4b94a57df268649354a0" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Upcoming Events</div></a><a href="/contact-us" class="_nmdd_SectionContentItemLink_13hdp_170 _nmdd_SectionContentItem_13hdp_42 " style="margin-bottom:20px" rel=""><div class="size-[34px] align-center"><img loading="eager" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3324b3cde0b84f3b8749e3f6577c6540" alt="" class="_icon_13hdp_186"/></div><div class="_nmdd_SectionContentItemTitle_13hdp_193">Contact Us</div></a></div></div><div class="_navigationMenuDropdown_13hdp_1 _backgroundGray_13hdp_15"><div class="_nmdd_LinkCardContainer_13hdp_57"><div class="_nmdd_SectionTitle_13hdp_20 ">Featured Success Story</div><a href="/asset/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F659979229f5449f28c49a65895b9d2ef?alt=media&amp;token=e87850ca-2ec6-4625-a6d9-b2e8a487f1ad&amp;apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" class="_nmdd_SectionContenLinkCard_13hdp_65" target="_blank" rel=""><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fccbc23d75b9640b69566b916ea6f832a" loading="eager" alt="Huntress Cybersecurity" class="_linkCardThumbnail_13hdp_80"/><div class="_nmdd_LinkCardContent_13hdp_97"><h6 class="_nmdd_LinkCardContentTitle_13hdp_111">Key Methods</h6><div class="_nmdd_LinkCardContentSummary_13hdp_159"><p>Key Methods had seen their share of security incidents. But when one of their clients suffered a mass-isolation event, they realized they were flying blind. Attackers had accessed sensitive data, but without clear logs, they were left scrambling.<br></p></div></div></a><a href="/asset/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F659979229f5449f28c49a65895b9d2ef?alt=media&amp;token=e87850ca-2ec6-4625-a6d9-b2e8a487f1ad&amp;apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" class="_nmdd_SectionContentFooterLink_13hdp_281" target="_blank" rel="  "><div>Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="eager" alt="right arrow" class="_footerLinkIcon_13hdp_301"/></a></div></div></div></div></div></div></div></li><li class="_menuNavigationButton_1yozr_350"><a class="_primaryButton_14c1s_1 w-full md:hidden" href="/start-trial"><div class="_buttonText_14c1s_84">Free Trial</div></a><a class="_primaryButton_14c1s_1 _small_14c1s_69 _navigationButton_14c1s_28 hidden md:block" href="/start-trial"><div class="_buttonText_14c1s_84">Free Trial</div></a></li></ul></nav></div></div></div></header><div class="page-wrapper"><div class="builder-component builder-component-65f3299e49a461b4b9c729ba" data-name="page" data-source="Rendered by Builder.io"><div class="builder-content" builder-content-id="65f3299e49a461b4b9c729ba" builder-model="page"><div data-builder-component="page" data-builder-content-id="65f3299e49a461b4b9c729ba"><style data-emotion-css="h47494">.css-h47494{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="builder-blocks css-h47494" builder-type="blocks"><style data-emotion-css="4hp89i">.css-4hp89i.builder-block{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;box-sizing:border-box;}</style><div class="builder-block builder-ddebc027a2b547be8bb340dc4719efa5 builder-has-component css-4hp89i" builder-id="builder-ddebc027a2b547be8bb340dc4719efa5"><section class="blog-banner-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f33356fc04f46a2ac4a68753ba41658" loading="eager" alt="" class="landing-banner-shape-1 blog-listing-landing-banner-shape-1"/><div class="w-layout-blockcontainer container-width-1143 w-container"><div class="blog-listing-banner-wrapper"><div class="blog-listing-banner-main-breadcrumb-wrap"><div class="breadcrumb contained"><a href="/" class="breadcrumb-link level-1">Home</a><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="breadcrumb-icon"/><a href="/blog" class="breadcrumb-link level-2">Blog</a><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="breadcrumb-icon"/><div class="breadcrumb-text">Cobalt Strikes Again: An Analysis of Obfuscated Malware</div></div></div><div class="blog-listing-heading-inner"><div class="landing-banner-heading blog-landing-banner-heading"><div class="breadcrumb blog-date-breadcrumb mobile"><div class="published-text">Published:</div><a href="/" class="breadcrumb-link breadcrumb-link-back">May 25, 2021</a></div><h1 class="landing-banner-heading-h1 blog">Cobalt Strikes Again: An Analysis of Obfuscated Malware</h1><div class="attribution-container"><div class="author-container"><div class="author-wrap-text">By: </div><div class="authors-wrapper"><div role="list" class="authors-list "><div role="listitem" class="author-item "><a href="/authors/matthew-brennan" class="author-link w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F614678645a7f4d4390c95f21d47ba040" loading="lazy" width="40" height="40" alt="" class="author-profile" style="width:40px;height:40px"/><div class="_authorName_1vybw_1">Matthew Brennan</div></a></div></div></div></div></div></div></div><div class="blog-listing-inner-image-wrap"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F960a09d94f2949da8eb1ff1d3096189c" loading="lazy" alt="" class="blog-listing-banner-image"/></div></div></div><div class="social-share-icon-mobile"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe499a4a7ecac4052ab9e5c194b638f16" loading="lazy" alt="Share icon"/></div></section><section class="blog-detail-content-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8" loading="eager" alt="Glitch effect" class="landing-banner-shape-8 blog-detail-landing-banner-shape-8"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8" loading="lazy" alt="Glitch effect" class="landing-banner-shape-8 blog-detail-landing-banner-glitch-2"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0658aac7c84b4f7e9a7c7b2a5b519b28" loading="lazy" alt="Glitch effect" class="landing-banner-shape-8 blog-right-glitch"/><div class="w-layout-blockcontainer container-width-1143 w-container"><div class="blog-detail-content-wrapper"><div class="blog-main-section"><div class="post-wrapper"><div class="blog-post-summary-main"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffe85f84d0b0c4f9f8743167664735836" loading="eager" alt="Glitch banner" class="blog-post-summary-main-glitch-top medium-zoom-image"/><div class="blog-post-summary first w-richtext"><p>How deep can a rabbit hole go? Recently, we discovered a suspicious-looking run key on a victim system. It was clear that the key was likely malicious, but it didn’t seem like anything out of the ordinary.</p><p>Little did we know, we were about to encounter <a href="https://www.cobaltstrike.com/" target="_blank">Cobalt Strike</a> malware hidden across almost 700 registry values and encased within multiple layers of fileless executables.</p><p>This particular malware sample went to great lengths to hide itself, deploying numerous evasion tactics and <a href="/blog/tried-and-true-hacker-technique-dos-obfuscation" data-discover="true">obfuscation techniques</a> in order to evade detection and analysis. And as you&#x27;ll see, it goes to show the great lengths hackers will go to evade detection and compromise their targets. </p><p>Let&#x27;s dive in.</p><h2>What is Cobalt Strike?</h2><p>Cobalt Strike is a commercial threat-emulation and post-exploitation tool commonly used by malicious attackers and penetration testers to compromise and maintain access to networks. The tool uses a modular framework comprising numerous specialized modules, each responsible for a particular function within the attack chain. Some are focused on stealth and evasion, while others are focused on the silent exfiltration of corporate data.</p><p>While the intent of Cobalt Strike is to better equip legitimate red teams and pen testers with the capabilities of sophisticated threat actors, it is often misused when in the wrong hands. You know what they say... with great power comes great responsibility. Cobalt Strike is an undeniably powerful framework, but it&#x27;s easily weaponized by malicious actors as a go-to tool for undercover attacks.</p><h2>Finding Cobalt Strike Malware</h2><p>It all started with a RunOnce key, which is typically found here:</p><p>HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce</p><p>This key is used to automatically execute a program when a user logs into their machine. Since this is a “RunOnce” key, it will automatically be deleted once it has executed. Typically, this is used by legitimate installation and update tools to resume an update after reboot—but not to resume after <em>every</em> reboot.</p><p>There are also “Run” keys, which don’t get removed each time and are used both legitimately and maliciously to <a href="/blog/what-is-a-persistent-foothold" data-discover="true">create persistent footholds</a> between reboots.</p><p>In this particular case, we found multiple commands for legitimate applications contained in the RunOnce key, but there was one that looked awfully suspicious. 👀</p><p>We inspected the command in the suspicious key and found this, which seemed to be executing a PowerShell command stored in one user’s environment variables.</p><p>Looking at the command in further detail, we can note that it does the following:</p><ul><li>loads PowerShell in a hidden window</li><li>loads the environment variables of the current user</li><li>loads a value from the environment with the same name as the current user</li><li>retrieves the data from this value and uses them as arguments for the PowerShell command<br/><br/></li></ul><p>This was starting to look extremely suspicious, and we knew we had to find out what was lurking in that environment variable.</p><p>After extracting that environment variable from the machine, we found a PowerShell command, this time executing a Base64 encoded string. After decoding and cleaning up the Base64 string, it ended up looking like this:</p><h4>What Does This Script Do?</h4><p>If you’re unfamiliar with PowerShell, that script may look a bit intimidating. Ultimately, the PowerShell script achieves four main things:</p><ul><li>Loads an obfuscated string that has been stored in the registry.</li><li>De-obfuscates the string and converts the result into a byte array.</li><li>Loads the byte array into memory as a DLL using PowerShell reflection (this is a common evasion technique that avoids writing a decoded payload to disk).</li><li>Executes the “test” method of that DLL, located in the “Open” object class.<br/><br/></li></ul><p>From a more technical lens, here’s a line-by-line breakdown of the PowerShell script in action:</p><ul><li><strong>Lines 1-9:</strong> This section is used to pull data from some more registry keys (up to 700 of them) and stores this data in a string.</li><li><strong>Lines 10-17:</strong> This defines a function that takes that string and converts it into a byte array. This usually indicates that the string will be used to create an executable file.</li><li><strong>Lines 19-25:</strong> This section is a bit strange. It essentially generates the number 1000 and stores it into the $ko variable. It does this in a way that takes a million loop iterations to generate—which might be an anti-analysis technique.</li><li><strong>Line 27:</strong> Loads the StringToBytes function, but first replaces any instance of the # character with the number in $ko.</li><li><strong>Line 28:</strong> Utilizes reflection to load the byte array into memory as a DLL. This avoids writing the payload to disk and is a common antivirus evasion technique.</li><li><strong>Line 29:</strong> Executes the “test” function of the loaded DLL.<br/><br/></li></ul><p>The <a href="/why-huntress/24-7-soc" data-discover="true">Huntress Security team</a> was able to retrieve the relevant registry values from the victim system and modify the script to dump out the payload as a file instead of loading it into memory. This resulted in our first executable payload.</p><h2>The First Binary File</h2><p>After successfully reversing that first PowerShell script, we were able to recreate the binary file that it was loading into memory. This file was a 6KB 32-bit .NET binary file. </p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1688px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1688px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49"/></picture></div></figure><p>Given the rather small size (only 6KB) of this file, we were suspicious that we might have missed something. The file seemed too small to contain a proper payload. We suspected that this was not the final payload and was likely a stager used to retrieve <em>another</em> payload.</p><p>Since the file was written in .NET, we were able to load it into dnSpy to analyze the source code. This is possible because .NET does not fully compile in the same way that C/C++ code does and instead “compiles” to an intermediary bytecode format that can be converted back into source code by tools like dnSpy.</p><p>So, we loaded the file into the dnSpy tool and were quickly able to find the “Open” class referenced by the PowerShell script—which is where we found the following code.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1318px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1318px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2"/></picture></div></figure><p>What&#x27;s interesting is that this code seemed to be loading <em>even more</em> registry values from a suspicious registry key and resetting the RunOnce registry values that initially triggered the investigation. <strong>This allows the malware to persist across reboots as if it were a regular Run key.</strong></p><p>Our team was then able to retrieve the suspicious registry key that was being loaded from the user’s machine, where we found encoded data that was spread across 662 Registry values. Since the data was pre-formatted in JSON, it was simple to write a regex to dump only the relevant data to a text file. Once this was done, we were able to decode it using a simple Python script—which was essentially just a wrapper around the original code used by the malware.</p><h2>The Second Binary File</h2><p>Using the output of the Python script, we were able to produce another 32-bit .NET binary file. This one was significantly larger than the first file, so we knew we were getting somewhere!</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1796px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1796px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5"/></picture></div></figure><p>Since this was another .NET file, we loaded it up into dnSpy for another round of analysis. This is where we noticed some interesting evasion and anti-analysis techniques.</p><h4>Evasion Techniques: Part One</h4><p>The first thing we noticed was numerous sleep functions scattered across the code, which would cause the program to sleep for 60 seconds between the components of its initial setup.</p><p>This technique is often used to bypass automated scanning tools that don’t have the time to wait for the sleep functions to complete. It can also be used to evade manual dynamic analysis, since an analyst may falsely believe that the malware is not doing anything when it’s actually just taking a quick nap.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1178px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1178px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66"/></picture></div></figure><p><strong>Learn More: </strong>To dive into more defense evasion techniques, <a href="/resources/hack-it-2021" target="_blank" data-discover="true">check out our <em>Intro to Antivirus Evasion</em> session</a> from this year&#x27;s <em>hack_it</em> event!</p><h4>Obfuscation</h4><p>Deeper down in the code, we observed numerous references to functions used to perform process injection. The names of these functions were lightly obfuscated using exclamation marks, which can be seen on the right side of the below screenshot.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1000px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1000px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801"/></picture></div></figure><p>Browsing further, we find the victim process that the malware is targeting for the injection. In this case, it was the genuine (and signed) Windows “Werfault.exe” process.</p><p>This is a legitimate process used by the Windows OS for error reporting—and it was likely targeted for two reasons:</p><ul><li>It&#x27;s a genuine and signed Windows process. These are sometimes ignored or whitelisted by detection systems. (Look up <a href="https://lolbas-project.github.io/#" target="_blank">LOLBAS</a> as to why it’s a terrible idea to whitelist Microsoft binaries.)</li><li>Since the Werfault.exe process performs error reporting, it may have legitimate reasons for making external network connections, meaning any malicious traffic created by the malware will have something to blend in with.</li></ul><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:900px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="900px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be"/></picture></div></figure><p>This is consistent with <a href="https://posts.specterops.io/a-deep-dive-into-cobalt-strike-malleable-c2-6660e33b0e0b" target="_blank">SpecterOps’</a> usage recommendations for Cobalt Strike.</p><p>&quot;Consider choosing a binary that would not look strange making network connections.&quot;</p><p>As we continued browsing, we found that a large string contained the payload to be injected into Werfault.exe. If you look closely, you can see that it is lightly obfuscated with # values, which are later replaced with the number 1000.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:800px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="800px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7"/></picture></div></figure><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:800px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="800px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05"/></picture></div></figure><h2>The Third Binary File</h2><p>Getting closer! But this time, the data we saved as our third binary file was not a .NET, so we can’t peek at the source code using dnSpy.</p><p>We are dealing with a 32-bit Delphi compiled binary, with a fake compiler timestamp dated in 1992. In case you’re not familiar with Delphi, it’s a programming language that allows you to write, package and deploy cross-platform native applications across a number of operating systems.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1696px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1696px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7"/></picture></div></figure><h4>Evasion Techniques: Part Two</h4><p>We initially performed some basic static analysis and found that the strings within the code contained references to VirtualProtect (commonly used in process injection), but this function was not listed in the import table. This indicated that the code was likely resolving some functions at runtime, which is suspicious behavior—and yet another tactic used to evade preventive security tools and thwart analysis.</p><p>We also noted the presence of <a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress" target="_blank">GetProcAddress</a> and <a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" target="_blank">LoadLibrary, which</a> further confirmed our suspicions that the file may be loading functions at runtime.</p><p>If you’re not familiar, GetProcAddress is a Win32 API call often used in reflection techniques that can be used to find the memory address of a given symbol (essentially a function) at runtime. LoadLibrary is another Win32 API that loads a DLL into the context of the currently running process. These two functions combined allow a piece of malware to hide functionality from static analysis and potentially evade some basic forms of detection.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:874px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="874px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b"/></picture></div></figure><p>Loading up the file within the x32dbg debugger, we observed a large number of calls to the sleep function, which would cause the program to sleep 10 seconds between performing suspicious actions. This is yet <em>another</em> anti-analysis tactic.</p><p>After getting through the sleep calls, we finally made it to some suspicious functions—namely some calls to VirtualAlloc and VirtualProtect.</p><p><a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc" target="_blank">VirtualAlloc</a> is a Win32 API call that will allocate a section of memory that can be used later in the program’s runtime. Typically, malware might allocate memory and then move malicious code (such as shellcode) into that section before executing it with another API call like CreateThread.</p><p><a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect" target="_blank">VirtualProtect</a> is an API call that will change the memory protections on a given memory section, this is used to mark a section of memory as readable, writable and/or executable.</p><p>Paying close attention to suspicious functions and newly allocated sections of memory, we eventually hit a breakpoint on CreateThread, which was targeting one of the newly allocated sections of memory created by the VirtualAlloc calls. We inspected that section further and found an MZ header, indicating that we had found our fourth binary file.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1918px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1918px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a"/></picture></div></figure><h2>The Fourth Binary File</h2><p>After dumping the newly discovered section from the debugger, and re-aligning the sections using PE-bear, we were able to retrieve a fourth binary file: a 32-bit DLL, 315KB in size.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1694px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1694px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284"/></picture></div></figure><p>Inspecting the imports of the function, we observed even more references to VirtualAlloc and VirtualProtect, indicating that more process injection was about to take place.</p><p>However, this time we noticed references to MemCpy, indicating that the process may be injecting or overwriting code into itself rather than into a separate process. Note that if this code was executing as intended, then “itself” would refer to the already injected Werfault.exe process.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:800px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="800px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397"/></picture></div></figure><p>A few lines below the memory imports, we see references to <a href="https://docs.microsoft.com/en-us/windows/win32/ipc/named-pipes" target="_blank">named pipe</a> functions being imported by the malware. In most cases, named pipes are legitimately used for inter-process communication. But they are also a key component of Cobalt Strike beacons and a common tactic used to evade automated analysis as they tend to cause issues for emulation tools and automated sandboxes.</p><p>Below, we can see something else interesting: a reference to a named pipe that is highly consistent with the Default Naming Scheme of named pipes used by Cobalt Strike.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1981px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1981px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73"/></picture></div></figure><p>We won’t dive too much into this, but there are a few great write-ups on this topic on the <a href="https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/" target="_blank">Cobalt Strike blog</a> and by <a href="https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/" target="_blank">F-Secure Labs</a>.</p><p>In order to confirm that this was really Cobalt Strike malware, and to try and pull more information, we parsed the file using this <a href="https://github.com/Sentinel-One/CobaltStrikeParser" target="_blank">Cobalt Strike Parser</a>.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1504px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1504px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89"/></picture></div></figure><p>This worked great and confirmed our suspicions that this was Cobalt Strike.</p><p>It also allowed us to view the Cobalt Strike configuration file, which included the communication method (HTTPS POST requests) and the IP of the C2 Server.</p><p>Submitting that IP address to VirusTotal, we observed only 1/82 detections. This indicated that the server may not have been widely used, or that it was potentially still active.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1673px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1673px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139"/></picture></div></figure><h2>The Fifth Binary File</h2><p>We are <em>well</em> beyond the point of necessary analysis, but we decided to continue down this rabbit hole.</p><p>Using a debugger, we tried to monitor the buffers used by the named pipes, as they are often used to move payloads and malicious data used by Cobalt Strike.</p><p>Shortly after monitoring these buffers, we found a new file appearing in memory. Note the MZRE Header, which is part of the default configuration of Cobalt Strike.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1919px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1919px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524"/></picture></div></figure><p>Dumping out that segment, we were able to pull a fifth binary file. This time, it appeared to be the <a href="https://blog.cobaltstrike.com/2016/06/15/what-is-a-stageless-payload-artifact/" target="_blank">Reflective Loader</a> used by the Cobalt Strike Beacon. And as we loaded up the new binary, we can see that it is another 32-bit DLL, about 211KB in size.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2106px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2106px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f"/></picture></div></figure><p>Doing some basic static analysis, we saw that the file is potentially downloading a PowerShell script from localhost, indicating that there may be a tiny web server storing PowerShell commands somewhere else in the code.</p><h2>Manually Finding Indicators of Compromise (IOCs)</h2><p>Eventually, we hit <a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" target="_blank">LoadLibrary</a> again and observed the <a href="https://docs.microsoft.com/en-us/windows/win32/wininet/about-wininet" target="_blank">WinInet.DLL</a> and WS2_32.DLL module being loaded. Since these are Windows libraries used for network and web communication, we knew that the code might be about to reach out to its C2 Server.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:800px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="800px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2"/></picture></div></figure><p>We were able to set breakpoints on web-related functions, which confirmed some of the malicious indicators extracted from the Cobalt Strike parsing tool. And one thing that we noticed was that the beacon references the <a href="https://www.google.com/search?q=avant+browser&amp;oq=Avant+Browser" target="_blank">Avant Browser</a> in the user-agent of its C2 requests. This likely means that the C2 server won’t respond (or will return something benign) unless it sees that header.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2168px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2168px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605"/></picture></div></figure><p>Digging deeper, we also find pieces of the <a href="https://www.cobaltstrike.com/help-malleable-c2" target="_blank">Malleable C2</a> commands used by the beacon, which in this case are embedded into HTTP cookie headers.</p><p>&amp;”Cookie: Jn9f/eO8Xfay/dYKGpmuBIXL6ZpnGtPuLtugLgeU5vsP4K/bMWYy21s2ulMVQjYmUq9ClOYS8XWbLNMwPV3y10tGAbupka2lk+gbRlJntI6gPqBUl</p><p>Although it looked like the data was Base64 encoded, we were unable to extract anything meaningful from using variations of Base64 decoders.</p><p><strong>But wait – are these actually addresses?</strong></p><p>Looking at the cookie data within the dump view, we noticed that there were three valid memory addresses contained within the encoded version of the cookie data.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:858px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="858px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e"/></picture></div></figure><p>One of these referenced the ws2_32.DLL, and the other two referenced a suspicious section of memory.</p><p>Running strings on the memory sections referenced in the red underlines provided some interesting results – namely lots of information about my virtual machine that the malware was likely trying to send to the C2 server.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1200px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1200px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9"/></picture></div></figure><p>Continuing on, we noticed some more references to the C2 server and the communication methods used, as well as a reference to a full URL used by the payload.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1610px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1610px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838"/></picture></div></figure><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2068px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2068px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a"/></picture></div></figure><p>Unfortunately, we didn’t have networking enabled on our test machine; so these requests all failed, causing an infinite loop where the beacon would sleep for a while and try again. If we were to enable networking, the beacon would likely download some additional payload modules and begin to truly compromise our machine. Maybe in a later article we can retrieve one of these payloads and do a deeper technical analysis of what this Cobalt Strike malware is capable of. </p><p>• • •</p><p>That wraps up our analysis of this persistence mechanism and the binary files involved. It was a wild ride, and hopefully you enjoyed reading as much as we enjoyed researching.</p><p>If there&#x27;s one lesson this should leave you with, it&#x27;s that we simply can&#x27;t<a href="/blog/what-is-human-powered-threat-hunting" data-discover="true"> rely on automated tools alone</a> to protect our systems. Through all these layers of obfuscation and evasion tactics, it&#x27;s clear just how many hoops hackers will jump through to execute their malware – and that&#x27;s why you need some type of human element to catch these sneaky threat actors in their tracks. </p><p>We’ll come back to this another day, but for now, this is the end of this rabbit hole.</p><p></p></div></div></div></div><div class="blog-sidebar"><div class="blog-sidebar-inner"><div class="blog-category-list-wrapper"><div class="category-heading">Categories<br/></div><div><div role="list" class="blog-category-sidebar-list "><div role="listitem"><a href="/blog-categories/threat-analysis" class="category-sidebar-item">Threat Analysis</a></div></div></div></div><div class="sidebar-cta"><h4 class="sidebar-cta-heading">See Huntress in action</h4><div class="sidebar-cta-text"><p>Our platform combines a suite of powerful managed detection and response tools for endpoints and Microsoft 365 identities, science-backed security awareness training, and the expertise of our 24/7 Security Operations Center (SOC).</p></div><div><a href="/demo" class="primary-button hero small w-button" rel="  ">Book a Demo</a></div></div><div class="blog-social-icons horizontal"><div class="socials-text">Share</div><div class="social-grid horizontal"><a data-share-facebook="true" href="https://www.facebook.com/sharer/sharer.php?u=https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware" class="social-links-icons facebook w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F124e49f43fd041659989deffd90e3b7c" loading="eager" alt="Facebook icon" class="social-links-icons"/></a><a data-share-twitter="true" href="https://twitter.com/share?url=https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware" class="social-links-icons twitter w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa59264f69adf4a4cb0092faaf95a5669" loading="eager" alt="Twitter X icon" class="social-links-icons"/></a><a data-share-linkedin="true" href="https://www.linkedin.com/shareArticle?mini=true&amp;amp;url=https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware" class="social-links-icons linkedin w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a9064f27e10467cae2ee3bd79beead9" loading="eager" alt="Linkedin icon" class="social-links-icons"/></a><a data-share-reddit="true" href="http://www.reddit.com/submit?url=https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware" class="social-links-icons reddit w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff043c73bb2de45c6b1102fe11ffebedb" loading="eager" alt="Download icon" class="social-links-icons"/></a></div></div></div></div></div></div></section></div><div class="builder-block builder-2b27cff7899944738e3b3d18be93d1f3 builder-has-component css-4hp89i" builder-id="builder-2b27cff7899944738e3b3d18be93d1f3"><section class="related-resources-section blog-related-resources-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F97d1ebf9f67945c9af2c6341e585bc21" loading="lazy" alt="Glitch effect" class="related-glitch-top-right"/><div class="w-layout-blockcontainer container-1304 w-container"><div class="related-resources-div-block"><h2 class="heading-7">You Might Also Like</h2><p class="paragraph-9"></p></div></div><div class="w-layout-blockcontainer container-1304 w-container"><div><div style="grid-area:span 1 / span 1 / span 1 / span 1"><div role="list" class="related-resources-block-box "><div role="listitem" class="flex-column "><a href="/blog/recutting-the-kerberos-diamond-ticket" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F40b868e2890449aaab56b1c0f1aadabb" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">Recutting the Kerberos Diamond Ticket</h4><div class="paragraph-8 resources-paragraph">
<p><br></p></div><div class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div><div role="listitem" class="flex-column "><a href="/blog/inside-bluenoroff-web3-intrusion-analysis" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff93ed5f31fd34924b360c3f6c540efba" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">Feeling Blue(Noroff): Inside a Sophisticated DPRK Web3 Intrusion</h4><div class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div><div role="listitem" class="flex-column "><a href="/blog/advanced-intrusion-targeting-executive-at-critical-marketing-research-company" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6703ac68aa5d46be997e2e15cd64478d" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">“Advanced” Intrusion Targeting Executive at Critical Marketing Research Company</h4><div class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div></div></div></div></div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4c269018ce94700a59e351c5b9edb99" loading="lazy" alt="" class="related-resources-shap-1 desktop blog-related-glitch"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1aa59311842f4ca6bda70300ff181cf9" loading="lazy" alt="" class="related-resources-shap-7"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9ad6bcb77d1842b98142269ef70c4f47" loading="lazy" alt="" class="related-resources-shap-6"/></section></div><div class="builder-block builder-0f50d623022042208a513ab79514b79b builder-has-component css-4hp89i" builder-id="builder-0f50d623022042208a513ab79514b79b"><section style="opacity:1;transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d" class="call-to-action-section"><div class="w-layout-blockcontainer container-width-1286 bg-container-mobile md-px-20 w-container"><div class="gradient-blue-green-2 cta-gradient-blue-green"><div class="latest-resources-feature-post"><div class="latest-resources-feature-post-description lg:pr-10"><h2 class="latest-resources-sub-heading-2 cta-latest-resources-sub-heading">Sign Up for Huntress Updates</h2><p class="paragraph-large margin-bottom-52">Get insider access to Huntress tradecraft, killer events, and the freshest blog updates.</p><div class="w-full "><div id="anchor-blog-signup-form" class="responsive-anchor"></div><div class="_formWrap_1y5cy_25"><div class=""><div class="_form_1y5cy_1 pt-5 pb-0 px-0"><form id="wf-form-Blog-Signup-Form" name="wf-form-Blog-Signup-Form" data-hs-cf-bound="false" data-hubspot-form-id="5198e52f-a296-4d78-935d-fe864d69a67a" class="_formGrid_1y5cy_107"><div class="_formGroup_1y5cy_116 _colspan2_1y5cy_130"><div class="_wrapper_1mbev_1"><input type="email" class="_input_1mbev_7 responsive-anchor" aria-invalid="false" id="email" autoComplete="email" data-snowplow-fieldname="email" data-ignore-nb="true" name="email" value=""/><label class="_label_1mbev_28">Work Email*</label></div></div><div class="_formGroup_1y5cy_116 _colspan2_1y5cy_130"><div class="_submitButtonRow_1y5cy_134"><div class="turnstile-wrapper"><div class="_tempWrapper_1cggk_1"><div class="_tempMainWrapper_1cggk_14"><div id="content" class="_tempContent_1cggk_34" aria-live="polite" aria-atomic="true" style="display:flex"><div id="success" role="alert" style="display:grid;visibility:visible"></div><div id="branding" class="_tempBranding_1cggk_47"><a class="cf-link" target="_blank" href="https://www.cloudflare.com/products/turnstile/?utm_source=turnstile&amp;utm_campaign=widget" rel="noopener noreferrer"><svg role="img" aria-label="Cloudflare" id="logo" class="_tempLogo_1cggk_31" viewBox="0 0 73 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M61.8848 15.7841L62.0632 15.1578C62.2758 14.4126 62.1967 13.7239 61.8401 13.2178C61.5118 12.7517 60.9649 12.4773 60.3007 12.4453L47.7201 12.2836C47.6811 12.2829 47.6428 12.2728 47.6083 12.2542C47.5738 12.2356 47.5442 12.209 47.5217 12.1766C47.4996 12.1431 47.4856 12.1049 47.4807 12.0649C47.4758 12.025 47.4801 11.9844 47.4933 11.9465C47.5149 11.8839 47.5541 11.8291 47.6061 11.7888C47.658 11.7486 47.7204 11.7247 47.7856 11.72L60.4827 11.5566C61.9889 11.4864 63.6196 10.2462 64.1905 8.73372L64.9146 6.81361C64.9443 6.73242 64.951 6.64444 64.9341 6.55957C64.112 2.80652 60.8115 0 56.8652 0C53.2293 0 50.1421 2.38158 49.0347 5.69186C48.2864 5.12186 47.3535 4.85982 46.4228 4.95823C44.6785 5.13401 43.276 6.55928 43.1034 8.32979C43.059 8.77189 43.0915 9.21845 43.1992 9.64918C40.3497 9.73347 38.0645 12.1027 38.0645 15.0151C38.0649 15.2751 38.0838 15.5347 38.1212 15.7919C38.1294 15.8513 38.1584 15.9057 38.2029 15.9452C38.2474 15.9847 38.3044 16.0067 38.3635 16.0071L61.5894 16.0099C61.5916 16.0101 61.5938 16.0101 61.596 16.0099C61.6616 16.0088 61.7252 15.9862 61.7772 15.9455C61.8293 15.9049 61.867 15.8483 61.8848 15.7841Z" fill="#F6821F"></path><path d="M66.0758 6.95285C65.9592 6.95285 65.843 6.95582 65.7274 6.96177C65.7087 6.96312 65.6904 6.96719 65.6729 6.97385C65.6426 6.98437 65.6152 7.00219 65.5931 7.02579C65.5711 7.04939 65.555 7.07806 65.5462 7.10936L65.0515 8.84333C64.8389 9.58847 64.918 10.2766 65.2749 10.7827C65.6029 11.2494 66.1498 11.5233 66.814 11.5552L69.4959 11.7186C69.5336 11.7199 69.5705 11.73 69.6037 11.7483C69.6369 11.7666 69.6654 11.7925 69.687 11.8239C69.7092 11.8576 69.7234 11.896 69.7283 11.9363C69.7332 11.9765 69.7288 12.0173 69.7153 12.0555C69.6937 12.118 69.6546 12.1727 69.6028 12.2129C69.5509 12.2531 69.4887 12.2771 69.4236 12.2819L66.6371 12.4453C65.1241 12.5161 63.4937 13.7558 62.9233 15.2682L62.722 15.8022C62.7136 15.8245 62.7105 15.8486 62.713 15.8724C62.7155 15.8961 62.7236 15.9189 62.7365 15.9389C62.7495 15.9589 62.7669 15.9755 62.7874 15.9873C62.8079 15.9991 62.8309 16.0058 62.8544 16.0068C62.8569 16.0068 62.8592 16.0068 62.8618 16.0068H72.4502C72.506 16.0073 72.5604 15.9893 72.6051 15.9554C72.6498 15.9216 72.6823 15.8739 72.6977 15.8195C72.8677 15.2043 72.9535 14.5684 72.9529 13.9296C72.9517 10.0767 69.8732 6.95285 66.0758 6.95285Z" fill="#FBAD41"></path><path d="M8.11963 18.8904H9.75541V23.4254H12.6139V24.8798H8.11963V18.8904Z" class="_tempLogoText_1cggk_31"></path><path d="M14.3081 21.9023V21.8853C14.3081 20.1655 15.674 18.7704 17.4952 18.7704C19.3164 18.7704 20.6653 20.1482 20.6653 21.8681V21.8853C20.6653 23.6052 19.2991 24.9994 17.4785 24.9994C15.6578 24.9994 14.3081 23.6222 14.3081 21.9023ZM18.9958 21.9023V21.8853C18.9958 21.0222 18.3806 20.2679 17.4785 20.2679C16.5846 20.2679 15.9858 21.0038 15.9858 21.8681V21.8853C15.9858 22.7484 16.6013 23.5025 17.4952 23.5025C18.3973 23.5025 18.9958 22.7666 18.9958 21.9023Z" class="_tempLogoText_1cggk_31"></path><path d="M22.6674 22.253V18.8901H24.3284V22.2191C24.3284 23.0822 24.7584 23.4939 25.4159 23.4939C26.0733 23.4939 26.5034 23.1003 26.5034 22.2617V18.8901H28.1647V22.2093C28.1647 24.1432 27.0772 24.9899 25.3991 24.9899C23.7211 24.9899 22.6674 24.1268 22.6674 22.2522" class="_tempLogoText_1cggk_31"></path><path d="M30.668 18.8907H32.9445C35.0526 18.8907 36.275 20.1226 36.275 21.8508V21.8684C36.275 23.5963 35.0355 24.88 32.911 24.88H30.668V18.8907ZM32.97 23.4076C33.9483 23.4076 34.597 22.8609 34.597 21.8928V21.8759C34.597 20.9178 33.9483 20.3614 32.97 20.3614H32.3038V23.4082L32.97 23.4076Z" class="_tempLogoText_1cggk_31"></path><path d="M38.6525 18.8904H43.3738V20.3453H40.2883V21.3632H43.079V22.7407H40.2883V24.8798H38.6525V18.8904Z" class="_tempLogoText_1cggk_31"></path><path d="M45.65 18.8904H47.2858V23.4254H50.1443V24.8798H45.65V18.8904Z" class="_tempLogoText_1cggk_31"></path><path d="M54.4187 18.8475H55.9949L58.5079 24.8797H56.7541L56.3238 23.8101H54.047L53.6257 24.8797H51.9058L54.4187 18.8475ZM55.8518 22.5183L55.1941 20.8154L54.5278 22.5183H55.8518Z" class="_tempLogoText_1cggk_31"></path><path d="M60.6149 18.8901H63.4056C64.3083 18.8901 64.9317 19.13 65.328 19.5406C65.6742 19.883 65.8511 20.3462 65.8511 20.9357V20.9526C65.8511 21.8678 65.3691 22.4754 64.6369 22.7919L66.045 24.88H64.1558L62.9671 23.0658H62.2507V24.88H60.6149V18.8901ZM63.3299 21.7654C63.8864 21.7654 64.2071 21.4915 64.2071 21.0551V21.0381C64.2071 20.5674 63.8697 20.328 63.3211 20.328H62.2507V21.7665L63.3299 21.7654Z" class="_tempLogoText_1cggk_31"></path><path d="M68.2112 18.8904H72.9578V20.3024H69.8302V21.209H72.6632V22.5183H69.8302V23.4683H73V24.8798H68.2112V18.8904Z" class="_tempLogoText_1cggk_31"></path><path d="M4.53824 22.6043C4.30918 23.13 3.82723 23.5022 3.18681 23.5022C2.29265 23.5022 1.67746 22.7493 1.67746 21.8851V21.8678C1.67746 21.0047 2.27593 20.2676 3.1698 20.2676C3.84367 20.2676 4.35681 20.6882 4.5734 21.2605H6.29764C6.02151 19.8349 4.78716 18.7707 3.18681 18.7707C1.36533 18.7707 0 20.1666 0 21.8851V21.9021C0 23.6219 1.3486 25 3.1698 25C4.72762 25 5.94525 23.9764 6.26645 22.6046L4.53824 22.6043Z" class="_tempLogoText_1cggk_31"></path></svg></a><div id="terms" class="_tempTerms_1cggk_58"><a id="privacy-link" class="_tempTermsLink_1cggk_67" target="_blank" rel="noopener noreferrer" href="https://www.cloudflare.com/privacypolicy/">Privacy</a><span class="_tempLinkSpacer_1cggk_71"> • </span><a id="terms-link" class="_tempTermsLink_1cggk_67" target="_blank" rel="noopener noreferrer" href="https://www.cloudflare.com/website-terms/">Terms</a></div></div></div></div></div> <div></div></div><button class="_primaryButton_14c1s_1 _submitButton_1y5cy_134 " aria-label="Submit" type="submit" id="submitButton"><div class="_buttonText_14c1s_84">Submit</div></button></div></div><div class="_formGroup_1y5cy_116 _colspan2_1y5cy_130"><div class="_privacyPolicy_1y5cy_183">By submitting this form, you accept our<!-- --> <a class="_noWrap_1y5cy_250" href="/terms-of-use" target="_blank" data-discover="true">Terms of Service</a> <!-- -->&amp;<!-- --> <a class="_noWrap_1y5cy_250" href="/privacy-policy" target="_blank" data-discover="true">Privacy Policy</a></div></div><input type="hidden" data-io-platform-fieldname="user[correlation_id]" data-snowplow-fieldname="correlation_id" name="correlation_id" value="2cd30281-f4ac-4ca3-ac77-d30e5120d0d1"/><input type="hidden" data-io-platform-fieldname="user[utm_source]" name="utm_source" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_medium]" name="utm_medium" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_campaign]" name="utm_campaign" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_content]" name="utm_content" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_keyword]" name="utm_keyword" value=""/><input type="hidden" name="page_url" value=""/><input type="hidden" name="pageUri" value=""/><input type="hidden" name="hutk" value=""/></form></div></div><div class="text-pretty md:text-balance subscribe-success-state _successState_1y5cy_198 " tabindex="-1" role="region" aria-label="Schedule a demo success"><div>Thank you! Your submission has been received!</div></div><div class="text-pretty md:text-balance error-message-alt _errorMessage_1y5cy_218 " tabindex="-1" role="region" aria-label="Schedule a demo failure"><div>Oops! Something went wrong while submitting the form.</div></div></div></div></div><div class="latest-resources-feature-post-image-wrapper cta-latest-resources-feature-post-image-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcb5efa5143804ba59d530a903d29fe5f" alt="Huntress at work" class="latest-resources-feature-post-image cta-latest-resources-feature-post-image"/></div></div></div></div></section></div><style data-emotion-css="191e8qc">.css-191e8qc.builder-block{height:0;width:0;display:inline-block;opacity:0;overflow:hidden;pointer-events:none;}</style><img src="https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" aria-hidden="true" alt="" role="presentation" width="0" height="0" class="builder-block builder-pixel-1qfjudefuec css-191e8qc" builder-id="builder-pixel-1qfjudefuec"/></div></div></div></div></div><div><footer id="main-site-footer" class="footer"><div class="w-layout-blockcontainer primary-container w-container"><div class="footer-inner-grid footer-inner-four-grid"><div data-hover="false" data-delay="0" id="w-node-_8db5101a-d165-e0e7-c7a6-e04b30595352-3059534f" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-5" aria-controls="w-dropdown-list-5" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Platform</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-5" aria-labelledby="w-dropdown-toggle-5"><a href="/platform" class="footer-nav-item" tabindex="0">Huntress Managed Security Platform</a><a href="/platform/managed-edr" aria-current="page" class="footer-nav-item w--current" tabindex="0">Managed EDR</a><a href="/platform/managed-edr-for-macos" class="footer-nav-item" tabindex="0">Managed EDR for macOS</a><a href="/platform/managed-itdr" class="footer-nav-item" tabindex="0">Managed ITDR</a><a href="/platform/siem" class="footer-nav-item" tabindex="0">Managed SIEM</a><a href="/platform/security-awareness-training" class="footer-nav-item" tabindex="0">Managed Security Awareness Training</a><a href="/demo" class="footer-nav-item" tabindex="0">Book A Demo</a></nav></div><div data-hover="false" data-delay="0" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-6" aria-controls="w-dropdown-list-6" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Solutions</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-6" aria-labelledby="w-dropdown-toggle-6"><a href="/solutions/topics/phishing" class="footer-nav-item" tabindex="0">Phishing</a><a href="/solutions/topics/cybersecurity-compliance" class="footer-nav-item" tabindex="0">Compliance</a><a href="/solutions/topics/business-email-compromise" class="footer-nav-item" tabindex="0">Business Email Compromise</a><a href="/industries/education" class="footer-nav-item" tabindex="0">Education</a><a href="/industries/financial-services" class="footer-nav-item" tabindex="0">Finance</a><a href="/industries/healthcare" class="footer-nav-item" tabindex="0">Healthcare</a><a href="/industries/manufacturing" class="footer-nav-item" tabindex="0">Manufacturing</a><a href="/industries/state-and-local-government" class="footer-nav-item" tabindex="0">State &amp; Local Government</a></nav></div><div data-hover="false" data-delay="0" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-7" aria-controls="w-dropdown-list-7" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Why Huntress?</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-7" aria-labelledby="w-dropdown-toggle-7"><a href="/why-huntress/managed-service-providers" class="footer-nav-item" tabindex="0">Managed Service Providers</a><a href="/why-huntress/value-added-resellers" class="footer-nav-item" tabindex="0">Value Added Resellers</a><a href="/why-huntress/businesses-it-teams" class="footer-nav-item" tabindex="0">Business &amp; IT Teams</a><a href="/why-huntress/24-7-soc" class="footer-nav-item" tabindex="0">24/7 SOC</a><a href="/success-stories" class="footer-nav-item" tabindex="0">Case Studies</a></nav></div><div data-hover="false" data-delay="0" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-8" aria-controls="w-dropdown-list-8" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Resources</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-8" aria-labelledby="w-dropdown-toggle-8"><a href="/resources" class="footer-nav-item" tabindex="0">Resource Center</a><a href="/blog" class="footer-nav-item" tabindex="0">Blog</a><a href="/upcoming-events" class="footer-nav-item" tabindex="0">Upcoming Events</a><a href="https://support.huntress.io/hc/en-us" target="_blank" class="footer-nav-item" tabindex="0" rel="nofollow">Support Documentation</a></nav></div><div data-hover="false" data-delay="0" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-9" aria-controls="w-dropdown-list-9" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">About</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-9" aria-labelledby="w-dropdown-toggle-9"><a href="/company/our-company" class="footer-nav-item" tabindex="0">Our Company</a><a href="/company/leadership" class="footer-nav-item" tabindex="0">Leadership</a><a href="/company/press" class="footer-nav-item" tabindex="0">News &amp; Press</a><a href="/company/careers" class="footer-nav-item" tabindex="0">Careers</a><a href="/contact-us" class="footer-nav-item" tabindex="0">Contact Us</a></nav></div></div><div class="footer-gradient-line" style="grid-area:span 1 / span 1 / span 1 / span 1"></div><div class="footer-copyright-grid"><div class="fcg-col" style="grid-area:span 1 / span 1 / span 1 / span 1"><a href="/" class="footer-brand w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b2e3c89b5046b89682ef20ccb7218d" loading="lazy" alt="Hunteress white logo"/></a></div><div class="fcg-col md-order-2" style="grid-area:span 1 / span 1 / span 1 / span 1"><div class="extra-small-paragraph">© 2025 Huntress All Rights Reserved.</div><div class="fcg-cta-group"><a href="/privacy-policy" target="_blank" class="fcg-cta">Privacy Policy</a><div class="fcg-seperator">|</div><a href="/cookie-policy" target="_blank" class="fcg-cta">Cookie Policy</a><div class="fcg-seperator">|</div><a href="/terms-of-use" target="_blank" class="fcg-cta">Terms of Use</a></div></div><div class="fcg-col md-order-3" style="grid-area:span 1 / span 1 / span 1 / span 1"><a id="free_trial_footer_button" href="/start-trial" class="primary-button footer-cta w-button">Free Trial</a></div></div></div></footer></div><div id="automation-verification" hidden=""><input id="form-neverbounce-check" type="hidden"/></div><script>((storageKey2, restoreKey) => {
    if (!window.history.state || !window.history.state.key) {
      let key = Math.random().toString(32).slice(2);
      window.history.replaceState({ key }, "");
    }
    try {
      let positions = JSON.parse(sessionStorage.getItem(storageKey2) || "{}");
      let storedY = positions[restoreKey || window.history.state.key];
      if (typeof storedY === "number") {
        window.scrollTo(0, storedY);
      }
    } catch (error) {
      console.error(error);
      sessionStorage.removeItem(storageKey2);
    }
  })("react-router-scroll-positions", null)</script><script>window.__reactRouterContext = {"basename":"/","future":{"unstable_middleware":false,"unstable_optimizeDeps":false,"unstable_splitRouteModules":false,"unstable_subResourceIntegrity":false,"unstable_viteEnvironmentApi":false},"routeDiscovery":{"mode":"lazy","manifestPath":"/__manifest"},"ssr":true,"isSpaMode":false};window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());</script><script type="module" async="">;
import * as route0 from "/assets/root-C_cireyK.js";
import * as route1 from "/assets/blog._slug-CFhuEuuc.js";
  window.__reactRouterManifest = {
  "entry": {
    "module": "/assets/entry.client-Do6PKLu9.js",
    "imports": [
      "/assets/chunk-D4RADZKF-Db5SQ-1d.js",
      "/assets/index-DGl6nBoU.js"
    ],
    "css": []
  },
  "routes": {
    "root": {
      "id": "root",
      "path": "",
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasClientMiddleware": false,
      "hasErrorBoundary": true,
      "module": "/assets/root-C_cireyK.js",
      "imports": [
        "/assets/chunk-D4RADZKF-Db5SQ-1d.js",
        "/assets/index-DGl6nBoU.js",
        "/assets/root-CSqt9jc4.js",
        "/assets/with-props-DyHsk88B.js",
        "/assets/snowplow.tracker-510wDdN5.js",
        "/assets/blocks-exports-DHMt_CX0.js",
        "/assets/data-CNtPYaWj.js"
      ],
      "css": [
        "/assets/root-C5LLCb9u.css",
        "/assets/snowplow-2NuIrITE.css"
      ]
    },
    "routes/blog.$slug": {
      "id": "routes/blog.$slug",
      "parentId": "root",
      "path": "blog/:slug",
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasClientMiddleware": false,
      "hasErrorBoundary": false,
      "module": "/assets/blog._slug-CFhuEuuc.js",
      "imports": [
        "/assets/with-props-DyHsk88B.js",
        "/assets/chunk-D4RADZKF-Db5SQ-1d.js",
        "/assets/snowplow.tracker-510wDdN5.js",
        "/assets/metadata-B9f9eOHO.js",
        "/assets/config-C81qt7ZA.js",
        "/assets/index-DGl6nBoU.js",
        "/assets/blocks-exports-DHMt_CX0.js"
      ],
      "css": [
        "/assets/snowplow-2NuIrITE.css",
        "/assets/metadata-Bn7UM7IX.css"
      ]
    },
    "routes/($slug)._index": {
      "id": "routes/($slug)._index",
      "parentId": "root",
      "path": ":slug?",
      "index": true,
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasClientMiddleware": false,
      "hasErrorBoundary": false,
      "module": "/assets/(_slug)._index-C5shpzQr.js",
      "imports": [
        "/assets/with-props-DyHsk88B.js",
        "/assets/chunk-D4RADZKF-Db5SQ-1d.js",
        "/assets/snowplow.tracker-510wDdN5.js",
        "/assets/blocks-exports-DHMt_CX0.js",
        "/assets/metadata-B9f9eOHO.js",
        "/assets/config-C81qt7ZA.js",
        "/assets/index-DGl6nBoU.js"
      ],
      "css": [
        "/assets/snowplow-2NuIrITE.css",
        "/assets/metadata-Bn7UM7IX.css"
      ]
    },
    "routes/blog._index": {
      "id": "routes/blog._index",
      "parentId": "root",
      "path": "blog",
      "index": true,
      "hasAction": true,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": true,
      "hasClientMiddleware": false,
      "hasErrorBoundary": false,
      "module": "/assets/blog._index-V_RRahGd.js",
      "imports": [
        "/assets/with-props-DyHsk88B.js",
        "/assets/chunk-D4RADZKF-Db5SQ-1d.js",
        "/assets/snowplow.tracker-510wDdN5.js",
        "/assets/blocks-exports-DHMt_CX0.js",
        "/assets/metadata-B9f9eOHO.js",
        "/assets/config-C81qt7ZA.js",
        "/assets/data-CNtPYaWj.js",
        "/assets/index-DGl6nBoU.js"
      ],
      "css": [
        "/assets/snowplow-2NuIrITE.css",
        "/assets/metadata-Bn7UM7IX.css"
      ]
    }
  },
  "url": "/assets/manifest-75b40ac3.js",
  "version": "75b40ac3"
};
  window.__reactRouterRouteModules = {"root":route0,"routes/blog.$slug":route1};

import("/assets/entry.client-Do6PKLu9.js");</script><!--$?--><template id="B:0"></template><!--/$--><div hidden id="S:0"><script>window.__reactRouterContext.streamController.enqueue("[{\"_1\":2,\"_977\":-5,\"_978\":-5},\"loaderData\",{\"_3\":4,\"_7\":8},\"root\",{\"_5\":6},\"preprod\",false,\"routes/blog.$slug\",{\"_9\":10,\"_190\":197,\"_332\":333,\"_353\":354,\"_355\":356,\"_975\":976},\"page\",{\"_11\":12,\"_13\":14,\"_15\":16,\"_17\":18,\"_19\":20,\"_21\":21,\"_22\":23,\"_36\":37,\"_47\":48,\"_49\":50,\"_51\":14,\"_52\":53,\"_54\":55,\"_56\":57,\"_58\":57,\"_59\":60,\"_193\":194,\"_195\":196},\"folders\",[],\"createdDate\",1737878646725,\"id\",\"65f3299e49a461b4b9c729ba\",\"name\",\"Blog Post\",\"modelId\",\"3fa669f9656b425bbe84446dd9c5a7cd\",\"published\",\"meta\",{\"_24\":9,\"_25\":6,\"_26\":27,\"_28\":29},\"kind\",\"hasLinks\",\"lastPreviewUrl\",\"https://prod.huntress.com/blog/(slug)?builder.space=3eb6f92aedf74f109c7b4b0897ec39a8\u0026builder.user.permissions=read%2Ccreate%2Cpublish%2CeditCode%2CeditDesigns%2Cadmin%2CeditLayouts%2CeditLayers%2CeditContentPriority\u0026builder.user.role.name=Admin\u0026builder.user.role.id=admin\u0026builder.cachebust=true\u0026builder.preview=page\u0026builder.noCache=true\u0026builder.allowTextEdit=true\u0026__builder_editing__=true\u0026builder.overrides.page=65f3299e49a461b4b9c729ba\u0026builder.overrides.65f3299e49a461b4b9c729ba=65f3299e49a461b4b9c729ba\u0026builder.options.includeRefs=true\u0026builder.options.enrich=true\",\"breakpoints\",{\"_30\":31,\"_32\":33,\"_34\":35},\"xsmall\",479,\"small\",767,\"medium\",991,\"query\",[38],{\"_39\":40,\"_41\":42,\"_43\":44,\"_45\":46},\"@type\",\"@builder.io/core:Query\",\"property\",\"urlPath\",\"operator\",\"is\",\"value\",\"/blog/(slug)\",\"variations\",{},\"lastUpdated\",1744209521320,\"firstPublished\",\"testRatio\",1,\"screenshot\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbe618a449bd34227a4c9c360a7241568\",\"createdBy\",\"Kz459QsZDzNpORbTSiA9L6WRQc23\",\"lastUpdatedBy\",\"data\",{\"_61\":62,\"_63\":62,\"_64\":62,\"_65\":46,\"_66\":62,\"_67\":62,\"_68\":69,\"_70\":62,\"_71\":62,\"_72\":73,\"_74\":75,\"_90\":91,\"_182\":183},\"titleTag\",\"\",\"openGraphTitle\",\"metaDescription\",\"url\",\"openGraphDescription\",\"description\",\"templateDataModel\",\"blog-posts\",\"title\",\"slug\",\"contentTagCategories\",\"DEPRECATED\",\"contentTags\",{\"_76\":77,\"_78\":79,\"_80\":81,\"_82\":83,\"_84\":85,\"_86\":87,\"_88\":89},\"funnelStageTags\",[],\"regionTags\",[],\"aiGeneratedContentTags\",[],\"audienceTags\",[],\"industryTags\",[],\"productTags\",[],\"repurposedContentTags\",[],\"blocks\",[92,126,135,159],{\"_39\":93,\"_94\":95,\"_15\":96,\"_97\":98,\"_112\":113},\"@builder.io/sdk:Element\",\"@version\",2,\"builder-ddebc027a2b547be8bb340dc4719efa5\",\"component\",{\"_17\":99,\"_100\":101},\"BlogBannerSection\",\"options\",{\"_102\":103,\"_104\":105,\"_106\":107,\"_108\":109,\"_110\":111},\"_data\",\"hunting-for-m365-password-spraying\",\"SidebarCtaHeading\",\"See Huntress in action\",\"SidebarCtaText\",\"\u003cp\u003eOur platform combines a suite of powerful managed detection and response tools for endpoints and Microsoft 365 identities, science-backed security awareness training, and the expertise of our 24/7 Security Operations Center (SOC).\u003c/p\u003e\",\"SidebarCtaButtonText\",\"Book a Demo\",\"SidebarCtaButtonUrl\",\"/demo\",\"responsiveStyles\",{\"_114\":115},\"large\",{\"_116\":117,\"_118\":119,\"_120\":121,\"_122\":123,\"_124\":125},\"display\",\"flex\",\"flexDirection\",\"column\",\"position\",\"relative\",\"flexShrink\",\"0\",\"boxSizing\",\"border-box\",{\"_39\":93,\"_94\":95,\"_15\":127,\"_97\":128,\"_112\":133},\"builder-2b27cff7899944738e3b3d18be93d1f3\",{\"_17\":129,\"_100\":130},\"BlogRelatedResourcesSection\",{\"_131\":132},\"heading\",\"You Might Also Like\",{\"_114\":134},{\"_116\":117,\"_118\":119,\"_120\":121,\"_122\":123,\"_124\":125},{\"_39\":93,\"_94\":95,\"_15\":136,\"_97\":137,\"_112\":157},\"builder-0f50d623022042208a513ab79514b79b\",{\"_17\":138,\"_100\":139},\"BlogSignupSection\",{\"_131\":140,\"_141\":142,\"_143\":144,\"_145\":146},\"Sign Up for Huntress Updates\",\"summary\",\"Get insider access to Huntress tradecraft, killer events, and the freshest blog updates.\",\"image\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcb5efa5143804ba59d530a903d29fe5f\",\"blogSignupForm\",{\"_147\":148,\"_149\":6,\"_150\":151,\"_152\":153,\"_154\":6,\"_155\":6,\"_156\":6},\"formId\",\"wf-form-Blog-Signup-Form\",\"showFormTitle\",\"submitButtonText\",\"Submit\",\"hubspotFormId\",\"5198e52f-a296-4d78-935d-fe864d69a67a\",\"showBlueGreenGradient\",\"showBluePurpleGradient\",\"useNeverBounce\",{\"_114\":158},{\"_116\":117,\"_118\":119,\"_120\":121,\"_122\":123,\"_124\":125},{\"_15\":160,\"_39\":93,\"_161\":162,\"_163\":164,\"_112\":174},\"builder-pixel-1qfjudefuec\",\"tagName\",\"img\",\"properties\",{\"_165\":166,\"_167\":168,\"_169\":62,\"_170\":171,\"_172\":123,\"_173\":123},\"src\",\"https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8\",\"aria-hidden\",\"true\",\"alt\",\"role\",\"presentation\",\"width\",\"height\",{\"_114\":175},{\"_173\":123,\"_172\":123,\"_116\":176,\"_177\":123,\"_178\":179,\"_180\":181},\"inline-block\",\"opacity\",\"overflow\",\"hidden\",\"pointerEvents\",\"none\",\"state\",{\"_184\":114,\"_185\":186},\"deviceSize\",\"location\",{\"_187\":46,\"_188\":189,\"_36\":192},\"pathname\",\"path\",[190,191],\"blog\",\"(slug)\",{},\"rev\",\"nhllfuqpnu8\",\"template\",\"huntress\",{\"_36\":198,\"_11\":199,\"_13\":200,\"_15\":201,\"_17\":202,\"_19\":203,\"_21\":21,\"_22\":204,\"_59\":206,\"_47\":328,\"_49\":329,\"_51\":200,\"_52\":53,\"_56\":330,\"_58\":330,\"_193\":331},[],[],1742717161586,\"65f3299e49a461b4b9c72e1c\",\"Cobalt Strikes Again: An Analysis of Obfuscated Malware\",\"beafe50240af45639f2b59e6aefd89f9\",{\"_28\":205,\"_24\":59,\"_26\":62},{\"_30\":31,\"_32\":33,\"_34\":35},{\"_207\":-5,\"_208\":209,\"_222\":223,\"_224\":225,\"_17\":202,\"_230\":6,\"_231\":232,\"_71\":233,\"_234\":235,\"_305\":306,\"_307\":308,\"_323\":327},\"lastUpdatedDate\",\"tags\",[210],{\"_211\":212},\"tag\",{\"_39\":213,\"_15\":214,\"_215\":208,\"_45\":216},\"@builder.io/core:Reference\",\"65f3299e49a461b4b9c72e5a\",\"model\",{\"_15\":214,\"_17\":217,\"_21\":21,\"_13\":218,\"_19\":219,\"_59\":220,\"_193\":221},\"Threat Analysis\",1741825543263,\"06a1fff4f2d64eed986229acc010c74f\",{\"_17\":217},\"3yv04tmfykn\",\"publishDate\",\"May 25, 2021\",\"metadata\",{\"_226\":6,\"_227\":6,\"_67\":228,\"_70\":229},\"noFollow\",\"noIndex\",\"Join us for a threat hunting adventure as we analyze a suspicious run key that leads us to Cobalt Strike malware hidden across nearly 700 registry values.\",\"Cobalt Strikes Again: An Analysis of Obfuscated Malware | Huntress\",\"featured\",\"content\",\"\u003cp\u003eHow deep can a rabbit hole go? Recently, we discovered a suspicious-looking run key on a victim system. It was clear that the key was likely malicious, but it didn’t seem like anything out of the ordinary.\u003c/p\u003e\u003cp\u003eLittle did we know, we were about to encounter \u003ca href=\\\"https://www.cobaltstrike.com/\\\" target=\\\"_blank\\\"\u003eCobalt Strike\u003c/a\u003e malware hidden across almost 700 registry values and encased within multiple layers of fileless executables.\u003c/p\u003e\u003cp\u003eThis particular malware sample went to great lengths to hide itself, deploying numerous evasion tactics and \u003ca href=\\\"/blog/tried-and-true-hacker-technique-dos-obfuscation\\\"\u003eobfuscation techniques\u003c/a\u003e in order to evade detection and analysis. And as you'll see, it goes to show the great lengths hackers will go to evade detection and compromise their targets.\u0026nbsp;\u003c/p\u003e\u003cp\u003eLet's dive in.\u003c/p\u003e\u003ch2\u003eWhat is Cobalt Strike?\u003c/h2\u003e\u003cp\u003eCobalt Strike is a commercial threat-emulation and post-exploitation tool commonly used by malicious attackers and penetration testers to compromise and maintain access to networks. The tool uses a modular framework comprising numerous specialized modules, each responsible for a particular function within the attack chain. Some are focused on stealth and evasion, while others are focused on the silent exfiltration of corporate data.\u003c/p\u003e\u003cp\u003eWhile the intent of Cobalt Strike is to better equip legitimate red teams and pen testers with the capabilities of sophisticated threat actors, it is often misused when in the wrong hands. You know what they say... with great power comes great responsibility. Cobalt Strike is an undeniably powerful framework, but it's easily weaponized by malicious actors as a go-to tool for undercover attacks.\u003c/p\u003e\u003ch2\u003eFinding Cobalt Strike Malware\u003c/h2\u003e\u003cp\u003eIt all started with a RunOnce key, which is typically found here:\u003c/p\u003e\u003cp\u003eHKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\u003c/p\u003e\u003cp\u003eThis key is used to automatically execute a program when a user logs into their machine. Since this is a “RunOnce” key, it will automatically be deleted once it has executed. Typically, this is used by legitimate installation and update tools to resume an update after reboot—but not to resume after \u003cem\u003eevery\u003c/em\u003e reboot.\u003c/p\u003e\u003cp\u003eThere are also “Run” keys, which don’t get removed each time and are used both legitimately and maliciously to \u003ca href=\\\"/blog/what-is-a-persistent-foothold\\\"\u003ecreate persistent footholds\u003c/a\u003e\u0026nbsp;between reboots.\u003c/p\u003e\u003cp\u003eIn this particular case, we found\u0026nbsp;multiple commands for legitimate applications contained in the RunOnce key, but there was\u0026nbsp;one that looked awfully suspicious. 👀\u003c/p\u003e\u003cp\u003eWe inspected the command in the suspicious key and found this, which seemed to be executing a PowerShell command stored in one user’s environment variables.\u003c/p\u003e\u003cp\u003eLooking at the command in further detail, we can note that it does the following:\u003c/p\u003e\u003cul\u003e\u003cli\u003eloads PowerShell in a hidden window\u003c/li\u003e\u003cli\u003eloads the environment variables of the current user\u003c/li\u003e\u003cli\u003eloads a value from the environment with the same name as the current user\u003c/li\u003e\u003cli\u003eretrieves the data from this value and uses them as arguments for the PowerShell command\u003cbr\u003e\u003cbr\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThis was starting to look extremely suspicious, and we knew we had to find out what was lurking in that environment variable.\u003c/p\u003e\u003cp\u003eAfter extracting that environment variable from the machine, we found a PowerShell command, this time executing a Base64 encoded string. After decoding and cleaning up the Base64 string, it ended up looking like this:\u003c/p\u003e\u003ch4\u003eWhat Does This Script Do?\u003c/h4\u003e\u003cp\u003eIf you’re unfamiliar with PowerShell, that script may look a bit intimidating. Ultimately, the PowerShell script achieves four main things:\u003c/p\u003e\u003cul\u003e\u003cli\u003eLoads an obfuscated string that has been stored in the registry.\u003c/li\u003e\u003cli\u003eDe-obfuscates the string and converts the result into a byte array.\u003c/li\u003e\u003cli\u003eLoads the byte array into memory as a DLL using PowerShell reflection (this is a common evasion technique that avoids writing a decoded payload to disk).\u003c/li\u003e\u003cli\u003eExecutes the “test” method of that DLL, located in the “Open” object class.\u003cbr\u003e\u003cbr\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eFrom a more technical lens, here’s a line-by-line breakdown of the PowerShell script in action:\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cstrong\u003eLines 1-9:\u003c/strong\u003e This section is used to pull data from some more registry keys (up to 700 of them) and stores this data in a string.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLines 10-17:\u003c/strong\u003e This defines a function that takes that string and converts it into a byte array. This usually indicates that the string will be used to create an executable file.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLines 19-25:\u003c/strong\u003e This section is a bit strange. It essentially generates the number 1000 and stores it into the $ko variable. It does this in a way that takes a million loop iterations to generate—which might be an anti-analysis technique.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLine 27:\u003c/strong\u003e Loads the StringToBytes function, but first replaces any instance of the # character with the number in $ko.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLine 28:\u003c/strong\u003e Utilizes reflection to load the byte array into memory as a DLL. This avoids writing the payload to disk and is a common antivirus evasion technique.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLine 29:\u003c/strong\u003e Executes the “test” function of the loaded DLL.\u003cbr\u003e\u003cbr\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe \u003ca href=\\\"/why-huntress/24-7-soc\\\"\u003eHuntress Security team\u003c/a\u003e was able to retrieve the relevant registry values from the victim system and modify the script to dump out the payload as a file instead of loading it into memory. This resulted in our first executable payload.\u003c/p\u003e\u003ch2\u003eThe First Binary File\u003c/h2\u003e\u003cp\u003eAfter successfully reversing that first PowerShell script, we were able to recreate the binary file that it was loading into memory. This file was a 6KB 32-bit .NET binary file.\u0026nbsp;\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1688px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1688px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3b0f5ba64f07493596bb4a752e332c49\\\" alt=\\\"Binary File 1\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eGiven the rather small size (only 6KB) of this file, we were suspicious that we might have missed something. The file seemed too small to contain a proper payload. We suspected that this was not the final payload and was likely a stager used to retrieve \u003cem\u003eanother\u003c/em\u003e payload.\u003c/p\u003e\u003cp\u003eSince the file was written in .NET, we were able to load it into dnSpy to analyze the source code. This is possible because .NET does not fully compile in the same way that C/C++ code does and instead “compiles” to an intermediary bytecode format that can be converted back into source code by tools like dnSpy.\u003c/p\u003e\u003cp\u003eSo, we loaded the file into the dnSpy tool and were quickly able to find the “Open” class referenced by the PowerShell script—which is where we found the following code.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1318px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1318px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F236562d540d34fcc96839684637bd0c2\\\" alt=\\\"Run Key\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eWhat's interesting is that this code seemed to be loading \u003cem\u003eeven more\u003c/em\u003e registry values from a suspicious registry key and resetting the RunOnce registry values that initially triggered the investigation. \u003cstrong\u003eThis allows the malware to persist across reboots as if it were a regular Run key.\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eOur team was then able to retrieve the suspicious registry key that was being loaded from the user’s machine, where we found encoded data that was spread across 662 Registry values. Since the data was pre-formatted in JSON, it was simple to write a regex to dump only the relevant data to a text file. Once this was done, we were able to decode it using a simple Python script—which was essentially just a wrapper around the original code used by the malware.\u003c/p\u003e\u003ch2\u003eThe Second Binary File\u003c/h2\u003e\u003cp\u003eUsing the output of the Python script, we were able to produce another 32-bit .NET binary file. This one was significantly larger than the first file, so we knew we were getting somewhere!\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1796px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1796px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fef38fd8132d346948f0bb5fc37f9b9e5\\\" alt=\\\"Second Binary\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eSince this was another .NET file, we loaded it up into dnSpy for another round of analysis. This is where we noticed some interesting evasion and anti-analysis techniques.\u003c/p\u003e\u003ch4\u003eEvasion Techniques: Part One\u003c/h4\u003e\u003cp\u003eThe first thing we noticed was numerous sleep functions scattered across the code, which would cause the program to sleep for 60 seconds between the components of its initial setup.\u003c/p\u003e\u003cp\u003eThis technique is often used to bypass automated scanning tools that don’t have the time to wait for the sleep functions to complete. It can also be used to evade manual dynamic analysis, since an analyst may falsely believe that the malware is not doing anything when it’s actually just taking a quick nap.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1178px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1178px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fffea772fbc34439bba103db2011d8e66\\\" alt=\\\"Dynamic Analysis\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u003cstrong\u003eLearn More: \u003c/strong\u003eTo dive into more defense evasion techniques, \u003ca href=\\\"/resources/hack-it-2021\\\" target=\\\"_blank\\\"\u003echeck out our \u003cem\u003eIntro to Antivirus Evasion\u003c/em\u003e session\u003c/a\u003e from this year's \u003cem\u003ehack_it\u003c/em\u003e event!\u003c/p\u003e\u003ch4\u003eObfuscation\u003c/h4\u003e\u003cp\u003eDeeper down in the code, we observed numerous references to functions used to perform process injection. The names of these functions were lightly obfuscated using exclamation marks, which can be seen on the right side of the below screenshot.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1000px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1000px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6798e2e10c6e4d2faa285e9560090801\\\" alt=\\\"Obfuscated\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eBrowsing further, we find the victim process that the malware is targeting for the injection. In this case, it was the genuine (and signed) Windows “Werfault.exe” process.\u003c/p\u003e\u003cp\u003eThis is a legitimate process used by the Windows OS for error reporting—and it was likely targeted for two reasons:\u003c/p\u003e\u003cul\u003e\u003cli\u003eIt's a genuine and signed Windows process. These are sometimes ignored or whitelisted by detection systems. (Look up \u003ca href=\\\"https://lolbas-project.github.io/#\\\" target=\\\"_blank\\\"\u003eLOLBAS\u003c/a\u003e as to why it’s a terrible idea to whitelist Microsoft binaries.)\u003c/li\u003e\u003cli\u003eSince the Werfault.exe process performs error reporting, it may have legitimate reasons for making external network connections, meaning any malicious traffic created by the malware will have something to blend in with.\u003c/li\u003e\u003c/ul\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:900px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"900px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd0d4f37987b842208e382735e9d824be\\\" alt=\\\"Traffic\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThis is consistent with \u003ca href=\\\"https://posts.specterops.io/a-deep-dive-into-cobalt-strike-malleable-c2-6660e33b0e0b\\\" target=\\\"_blank\\\"\u003eSpecterOps’\u003c/a\u003e usage recommendations for Cobalt Strike.\u003c/p\u003e\u003cp\u003e\\\"Consider choosing a binary that would not look strange making network connections.\\\"\u003c/p\u003e\u003cp\u003eAs we continued browsing, we\u0026nbsp;found that a\u0026nbsp;large string\u0026nbsp;contained the payload to be injected into Werfault.exe. If you look closely, you can see that it is lightly obfuscated with # values, which are later replaced with the number 1000.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:800px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"800px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7175164fb2a64638b1dfcd1631e6a2b7\\\" alt=\\\"Values\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:800px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"800px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68a131ea9c2047d4a475ad9359a2ad05\\\" alt=\\\"continued browsing\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003ch2\u003eThe Third Binary File\u003c/h2\u003e\u003cp\u003eGetting closer! But this time, the data we saved as our third binary file was not a .NET, so we can’t peek at the source code using dnSpy.\u003c/p\u003e\u003cp\u003eWe are dealing with a 32-bit Delphi compiled binary, with a fake compiler timestamp dated in 1992. In case you’re not familiar with Delphi, it’s a programming language that allows you to write, package and deploy cross-platform native applications across a number of operating systems.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1696px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1696px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc4b4ead3d6a24612a7012c285072cfa7\\\" alt=\\\"Delphi\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003ch4\u003eEvasion Techniques: Part Two\u003c/h4\u003e\u003cp\u003eWe initially performed some basic static analysis and found that the strings within the code contained references to VirtualProtect (commonly used in process injection), but this function was not listed in the import table. This indicated that the code was likely resolving some functions at runtime, which is suspicious behavior—and yet another tactic used to evade preventive security tools\u0026nbsp;and thwart analysis.\u003c/p\u003e\u003cp\u003eWe also noted the presence of \u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress\\\" target=\\\"_blank\\\"\u003eGetProcAddress\u003c/a\u003e and \u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya\\\" target=\\\"_blank\\\"\u003eLoadLibrary, which\u003c/a\u003e further confirmed our suspicions that the file may be loading functions at runtime.\u003c/p\u003e\u003cp\u003eIf you’re not familiar, GetProcAddress is a Win32 API call often used in reflection techniques that can be used to find the memory address of a given symbol (essentially a function) at runtime. LoadLibrary is another Win32 API that loads a DLL into the context of the currently running process. These two functions combined allow a piece of malware to hide functionality from static analysis and potentially evade some basic forms of detection.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:874px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"874px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcfff357430fa442584e3226917a9485b\\\" alt=\\\"Debugger3\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eLoading up the file within the x32dbg debugger, we observed a large number of calls to the sleep function, which would cause the program to sleep 10 seconds between performing suspicious actions. This is yet \u003cem\u003eanother\u003c/em\u003e anti-analysis tactic.\u003c/p\u003e\u003cp\u003eAfter getting through the sleep calls, we finally made it to some suspicious functions—namely some calls to VirtualAlloc and VirtualProtect.\u003c/p\u003e\u003cp\u003e\u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc\\\" target=\\\"_blank\\\"\u003eVirtualAlloc\u003c/a\u003e\u0026nbsp;is a Win32 API call that will allocate a section of memory that can be used later in the program’s runtime. Typically, malware might allocate memory and then move malicious code (such as shellcode) into that section before executing it with another API call like CreateThread.\u003c/p\u003e\u003cp\u003e\u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect\\\" target=\\\"_blank\\\"\u003eVirtualProtect\u003c/a\u003e is an API call that will change the memory protections on a given memory section, this is used to mark a section of memory as readable, writable and/or executable.\u003c/p\u003e\u003cp\u003ePaying close attention to suspicious functions and newly allocated sections of memory, we eventually hit a breakpoint on CreateThread, which was targeting one of the newly allocated sections of memory created by the VirtualAlloc calls. We inspected that section further and found an MZ header, indicating that we had found our fourth\u0026nbsp;binary file.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1918px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1918px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbdbbd1f26ea94942b388f0f5456e878a\\\" alt=\\\"Debugger5\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003ch2\u003eThe Fourth Binary File\u003c/h2\u003e\u003cp\u003eAfter dumping the newly discovered section from the debugger, and re-aligning the sections using PE-bear, we were able to retrieve a fourth binary file: a 32-bit DLL, 315KB in size.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1694px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1694px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F15872155b25c43918b2dacbf83f6f284\\\" alt=\\\"Fourth Binary\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eInspecting the imports of the function, we observed even more references to VirtualAlloc and VirtualProtect, indicating that more process injection was about to take place.\u003c/p\u003e\u003cp\u003eHowever, this time we noticed references to MemCpy, indicating that the process may be injecting or overwriting code into itself rather than into a separate process. Note that if this code was executing as intended, then “itself” would refer to the already injected Werfault.exe process.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:800px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"800px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F57983a0beaa6472a9b425d1095788397\\\" alt=\\\"Binary4_2\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eA few lines below the memory imports, we see references to \u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/ipc/named-pipes\\\" target=\\\"_blank\\\"\u003enamed pipe\u003c/a\u003e functions being imported by the malware. In most cases, named pipes are\u0026nbsp;legitimately\u0026nbsp;used\u0026nbsp;for inter-process communication. But they are also a key component of Cobalt Strike beacons and a common tactic used to evade automated analysis as they tend to cause issues for emulation tools and automated sandboxes.\u003c/p\u003e\u003cp\u003eBelow, we can see something else interesting: a reference to a named pipe that is highly consistent with the Default Naming Scheme of named pipes used by Cobalt Strike.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1981px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1981px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38ab7bf126974c50bfbdda5c60036e73\\\" alt=\\\"Binary 4_4\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eWe won’t dive too much into this, but there are a few great write-ups on this topic on the \u003ca href=\\\"https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/\\\" target=\\\"_blank\\\"\u003eCobalt Strike blog\u003c/a\u003e and by \u003ca href=\\\"https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/\\\" target=\\\"_blank\\\"\u003eF-Secure Labs\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eIn order to confirm that this was really Cobalt Strike malware, and to try and pull more information, we parsed the file using this \u003ca href=\\\"https://github.com/Sentinel-One/CobaltStrikeParser\\\" target=\\\"_blank\\\"\u003eCobalt Strike Parser\u003c/a\u003e.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1504px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1504px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F658460545ba144e0bd78aa01d3fb7d89\\\" alt=\\\"Binary 4_5\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThis worked great and confirmed our suspicions that this was Cobalt Strike.\u003c/p\u003e\u003cp\u003eIt also allowed us to view the Cobalt Strike configuration file, which included the communication method (HTTPS POST requests) and the IP of the C2 Server.\u003c/p\u003e\u003cp\u003eSubmitting that IP address to VirusTotal, we observed only 1/82 detections. This indicated that the server may not have been widely used, or that it was potentially still active.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1673px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1673px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e4ac590539f47e38cb48af4a3f25139\\\" alt=\\\"Binary 4_6\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003ch2\u003eThe Fifth Binary File\u003c/h2\u003e\u003cp\u003eWe are \u003cem\u003ewell\u003c/em\u003e beyond the point of necessary analysis, but we decided to continue down this rabbit hole.\u003c/p\u003e\u003cp\u003eUsing a debugger, we tried to monitor the buffers used by the named pipes, as they are often used to move payloads and malicious data used by Cobalt Strike.\u003c/p\u003e\u003cp\u003eShortly after monitoring these buffers, we found a new file appearing in memory. Note the MZRE Header, which is part of the default configuration of Cobalt Strike.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1919px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1919px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff5a51908980742dbabd88f3b25a74524\\\" alt=\\\"Binary 5_1\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eDumping out that segment, we were able to pull a fifth binary file. This time, it appeared to be the \u003ca href=\\\"https://blog.cobaltstrike.com/2016/06/15/what-is-a-stageless-payload-artifact/\\\" target=\\\"_blank\\\"\u003eReflective Loader\u003c/a\u003e used by the Cobalt Strike Beacon. And as we loaded up the new binary, we can see that it is another 32-bit DLL, about 211KB in size.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2106px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2106px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F846ab2a9ce5045e68fa4cad74bf56e9f\\\" alt=\\\"Binary 5_2\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eDoing some basic static analysis, we saw that the file is potentially downloading a PowerShell script from localhost, indicating that there\u0026nbsp;may be a tiny web server storing PowerShell commands somewhere else in the code.\u003c/p\u003e\u003ch2\u003eManually Finding Indicators of Compromise (IOCs)\u003c/h2\u003e\u003cp\u003eEventually, we hit \u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya\\\" target=\\\"_blank\\\"\u003eLoadLibrary\u003c/a\u003e again and observed the \u003ca href=\\\"https://docs.microsoft.com/en-us/windows/win32/wininet/about-wininet\\\" target=\\\"_blank\\\"\u003eWinInet.DLL\u003c/a\u003e and WS2_32.DLL module being loaded. Since these are Windows libraries used for network and web communication, we knew that the code might be about to reach out to its C2 Server.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:800px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"800px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F43667eb7218c4375b78d33a352187dc2\\\" alt=\\\"looks like code\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eWe were able to set breakpoints on web-related functions, which confirmed some of the malicious indicators extracted from the Cobalt Strike parsing tool. And one thing that we noticed was that the beacon references the \u003ca href=\\\"https://www.google.com/search?q=avant+browser\u0026oq=Avant+Browser\\\" target=\\\"_blank\\\"\u003eAvant Browser\u003c/a\u003e in the user-agent of its C2 requests. This likely means that the C2 server won’t respond (or will return something benign) unless it sees that header.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2168px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2168px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F686aa01d81af469399308b9f413b0605\\\" alt=\\\"IOC_3\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eDigging deeper, we also find pieces of the \u003ca href=\\\"https://www.cobaltstrike.com/help-malleable-c2\\\" target=\\\"_blank\\\"\u003eMalleable C2\u003c/a\u003e commands used by the beacon, which in this case are embedded into HTTP cookie headers.\u003c/p\u003e\u003cp\u003e\u0026amp;”Cookie: Jn9f/eO8Xfay/dYKGpmuBIXL6ZpnGtPuLtugLgeU5vsP4K/bMWYy21s2ulMVQjYmUq9ClOYS8XWbLNMwPV3y10tGAbupka2lk+gbRlJntI6gPqBUl\u003c/p\u003e\u003cp\u003eAlthough it looked like the data was Base64 encoded, we were unable to extract anything meaningful from using variations of Base64 decoders.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eBut wait – are these actually addresses?\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eLooking at the cookie data within the dump view, we noticed that there were three valid memory addresses contained within the encoded version of the cookie data.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:858px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"858px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe27153c86cd945b992483089b6218a5e\\\" alt=\\\"IOC_6\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eOne of these referenced the ws2_32.DLL, and the other two referenced a suspicious section of memory.\u003c/p\u003e\u003cp\u003eRunning strings on the memory sections referenced in the red underlines provided some interesting results – namely lots of information about my virtual machine that the malware was likely trying to send to the C2 server.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1200px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1200px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3980764a371c47c7b921915ee3866cb9\\\" alt=\\\"IOC_7\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eContinuing on, we noticed some more references to the C2 server and the communication methods used, as well as a reference to a full URL used by the payload.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1610px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1610px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc0611bfd9cea48ab9be1aba3fea4c838\\\" alt=\\\"IOC_8\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2068px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2068px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faa37cea1276e435887071c327eeb959a\\\" alt=\\\"IOC_9\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eUnfortunately, we didn’t have networking enabled on our test machine; so these requests all failed, causing an infinite loop where the beacon would sleep for a while and try again. If we were to enable networking, the beacon would likely download some additional payload modules and begin to truly compromise our machine. Maybe in a later article we can retrieve one of these payloads and do a deeper technical analysis of what this Cobalt Strike malware is capable of.\u0026nbsp;\u003c/p\u003e\u003cp\u003e•\u0026nbsp;•\u0026nbsp;•\u003c/p\u003e\u003cp\u003eThat wraps up our analysis of this persistence mechanism and the binary files involved. It was a wild ride, and hopefully you enjoyed reading as much as we enjoyed researching.\u003c/p\u003e\u003cp\u003eIf there's one lesson this should leave you with, it's that we simply can't\u003ca href=\\\"/blog/what-is-human-powered-threat-hunting\\\"\u003e rely on automated tools alone\u003c/a\u003e to protect our systems. Through all these layers of obfuscation and evasion tactics, it's clear just how many hoops hackers will jump through to execute their malware – and that's why you need some type of human element to catch these sneaky threat actors in their tracks. \u003c/p\u003e\u003cp\u003eWe’ll come back to this another day, but for now, this is the end of this rabbit hole.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\",\"cobalt-strike-analysis-of-obfuscated-malware\",\"authors\",[236],{\"_237\":238},\"author\",{\"_39\":213,\"_15\":239,\"_215\":240,\"_45\":241},\"66048bf6ebfd6c83c4752c57\",\"people\",{\"_36\":242,\"_11\":243,\"_13\":244,\"_15\":239,\"_17\":245,\"_19\":246,\"_21\":21,\"_22\":247,\"_59\":249,\"_47\":301,\"_49\":302,\"_51\":244,\"_52\":53,\"_56\":303,\"_58\":303,\"_193\":304},[],[],1742719356233,\"Matthew Brennan\",\"d50b5ec346a64579b280b4104dca236e\",{\"_28\":248,\"_24\":59,\"_26\":62},{\"_30\":31,\"_32\":33,\"_34\":35},{\"_250\":251,\"_252\":-5,\"_17\":245,\"_71\":253,\"_254\":255,\"_256\":257,\"_224\":258,\"_261\":262,\"_263\":264,\"_299\":300},\"linkedInUrl\",\"https://www.linkedin.com/in/matthew-brennan-69b96bb9/\",\"profileImageAltText\",\"matthew-brennan\",\"bioDetail\",\"\u003cp id=\\\"\\\"\u003eMalware Enthusiast. Appreciator of Burritos. Former Detection Engineer at Huntress.\u003c/p\u003e\u003cp id=\\\"\\\"\u003e‍\u003c/p\u003e\",\"companyName\",\"Embee Research\",{\"_70\":259,\"_227\":6,\"_226\":6,\"_67\":260},\"Matthew Brennan | Huntress\",\"Read blog posts from Matthew Brennan on the Huntress Blog.\",\"jobTitle\",\"Security Researcher \u0026 Technical Writer\",\"groups\",[265,284],{\"_266\":267},\"group\",{\"_39\":213,\"_15\":268,\"_215\":263,\"_45\":269},\"00d1d80145b14a6b87c45567b169a8f4\",{\"_36\":270,\"_11\":271,\"_13\":272,\"_15\":268,\"_17\":273,\"_19\":274,\"_21\":21,\"_22\":275,\"_59\":279,\"_47\":280,\"_49\":281,\"_51\":282,\"_52\":53,\"_56\":57,\"_58\":57,\"_193\":283},[],[],1735687100903,\"Authors\",\"8749400659754b178d5088546f7b2f6f\",{\"_28\":276,\"_24\":59,\"_26\":62},{\"_32\":277,\"_34\":278},478,1023,{\"_17\":273},{},1735687106469,1735687106464,\"4oozorok93\",{\"_266\":285},{\"_39\":213,\"_15\":286,\"_215\":263,\"_45\":287},\"babc0d8823f34ab894a4431d5b302dc7\",{\"_36\":288,\"_11\":289,\"_13\":290,\"_15\":286,\"_17\":291,\"_19\":274,\"_21\":21,\"_22\":292,\"_59\":294,\"_47\":295,\"_49\":296,\"_51\":297,\"_52\":53,\"_56\":57,\"_58\":57,\"_193\":298},[],[],1742334085525,\"Speakers\",{\"_28\":293,\"_24\":59,\"_26\":62},{\"_30\":31,\"_32\":33,\"_34\":35},{\"_17\":291},{},1742334347573,1742334347569,\"3yxtqhdbiee\",\"profileImage\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F614678645a7f4d4390c95f21d47ba040\",{},1742758868932,\"XBN8lOXr7QMH6JvQimte3OCtO6c2\",\"5nr9k60xn04\",\"thumbnail\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F960a09d94f2949da8eb1ff1d3096189c\",\"categories\",[309],{\"_310\":311},\"category\",{\"_39\":213,\"_15\":312,\"_215\":313,\"_45\":314},\"65f3299e49a461b4b9c72e31\",\"blog-categories\",{\"_15\":312,\"_17\":217,\"_21\":21,\"_13\":315,\"_19\":316,\"_59\":317,\"_193\":326},1739997400726,\"b7b51689bde4424484bccde4b9ee6d6b\",{\"_17\":217,\"_71\":318,\"_224\":319,\"_322\":320,\"_64\":321,\"_323\":324,\"_67\":325},\"threat-analysis\",{\"_70\":320,\"_67\":321},\"Threat Analysis Blog Posts | Huntress\",\"Read our Threat Analyses in these Huntress blog posts. \",\"metaTitle\",\"canonicalUrl\",\"https://www.huntress.com/blog-categories/threat-analysis\",\"\u003cp\u003eDive in and nerd out with us on current and emerging cybersecurity threats. We cover attack vectors, threat actors, and new vulnerabilities, providing insights to help you understand and counteract these risks.\u003c/p\u003e\",\"mz8hjme8vn\",\"https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware\",{},1744303301576,\"33UidLbmpsgzwkwDasBJX2YwYYW2\",\"h7mgx325y1a\",\"relatedPosts\",[334,341,347],{\"_15\":335,\"_17\":336,\"_59\":337},\"5c2b199e01e2458cbbaec123d582fd0d\",\"Recutting the Kerberos Diamond Ticket\",{\"_71\":338,\"_305\":339,\"_141\":340},\"recutting-the-kerberos-diamond-ticket\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F40b868e2890449aaab56b1c0f1aadabb\",\"\\n\u003cp\u003e\u003cbr\u003e\u003c/p\u003e\",{\"_15\":342,\"_17\":343,\"_59\":344},\"06defac380e84e898b81488c5ddb4644\",\"Feeling Blue(Noroff): Inside a Sophisticated DPRK Web3 Intrusion\",{\"_71\":345,\"_305\":346},\"inside-bluenoroff-web3-intrusion-analysis\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff93ed5f31fd34924b360c3f6c540efba\",{\"_15\":348,\"_17\":349,\"_59\":350},\"9f63eb59e469449bb283a16534f00345\",\"“Advanced” Intrusion Targeting Executive at Critical Marketing Research Company\",{\"_71\":351,\"_305\":352},\"advanced-intrusion-targeting-executive-at-critical-marketing-research-company\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6703ac68aa5d46be997e2e15cd64478d\",\"altRelatedPosts\",[],\"common\",{\"_357\":358,\"_885\":886,\"_951\":952},\"headerContent\",[359,443,552,624,704,721],{\"_11\":360,\"_47\":361,\"_58\":57,\"_59\":362,\"_49\":434,\"_17\":368,\"_13\":435,\"_21\":21,\"_56\":57,\"_51\":436,\"_22\":437,\"_52\":53,\"_19\":439,\"_36\":440,\"_15\":441,\"_193\":442},[],{},{\"_363\":364,\"_365\":366,\"_367\":368,\"_369\":370},\"type\",\"Menu\",\"linkProperties\",{},\"menuText\",\"Platform\",\"columns\",[371,406],{\"_372\":373,\"_377\":95,\"_363\":378,\"_379\":380,\"_70\":381,\"_382\":383},\"footerLink\",{\"_65\":374,\"_375\":376},\"/platform\",\"text\",\"Platform Overview\",\"columnSpan\",\"Link List\",\"showTitle\",true,\"Huntress Managed Security Platform\",\"links\",[384,391,396,401],{\"_65\":385,\"_363\":386,\"_387\":388,\"_141\":389,\"_70\":390},\"/platform/managed-edr\",\"Text Link\",\"icon\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb16a0fc49194ef3a61c385bd0d0f312\",\"\u003cp\u003eGet full endpoint visibility, detection, and response.\u003c/p\u003e\",\"Managed EDR\",{\"_141\":392,\"_387\":393,\"_363\":386,\"_70\":394,\"_65\":395},\"\u003cp\u003eEmpower your teams with science-backed security awareness training.\u003c/p\u003e\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcd0acdb221c84200a837d97a6bac46a7\",\"Managed Security Awareness Training\",\"/platform/security-awareness-training\",{\"_363\":386,\"_141\":397,\"_387\":398,\"_65\":399,\"_70\":400},\"\u003cp\u003eProtect your Microsoft 365 identities and email environments.\u003c/p\u003e\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffd3a938d7dfc41bdac34c3f46a36afb2\",\"/platform/managed-itdr\",\"Managed ITDR\",{\"_70\":402,\"_387\":403,\"_65\":404,\"_141\":405,\"_363\":386},\"Managed SIEM\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5638ee75bf42433c81332c153db5cb15\",\"/platform/siem\",\"\u003cp\u003eManaged threat response and robust compliance support at a predictable price.\u003c/p\u003e\",{\"_379\":6,\"_363\":407,\"_377\":53,\"_230\":380,\"_372\":408,\"_70\":409,\"_410\":411},\"Card\",{},\"Learn More Card\",\"cardContentReference\",{\"_39\":213,\"_15\":412,\"_215\":413,\"_45\":414},\"be5723c7f6674c6db1ebfc79503cb723\",\"custom-cards\",{\"_13\":415,\"_59\":416,\"_36\":425,\"_17\":418,\"_52\":53,\"_47\":426,\"_49\":427,\"_56\":57,\"_11\":428,\"_19\":429,\"_51\":430,\"_58\":57,\"_15\":412,\"_21\":21,\"_22\":431,\"_193\":433},1738695869997,{\"_141\":417,\"_17\":418,\"_419\":111,\"_420\":421,\"_422\":421,\"_423\":111,\"_305\":424},\"Try Huntress for free and deploy in minutes to start fighting threats.\",\"Learn More\",\"linkUrl\",\"linkLabelText\",\"Request a Demo\",\"ctaText\",\"ctaUrl\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4dcf43805cea496b92a4b04334297b54\",[],{},1749580539246,[],\"6debca3e2db24468b466376fc09f0c11\",1738695944669,{\"_28\":432,\"_26\":62,\"_24\":59},{\"_30\":31,\"_32\":33,\"_34\":35},\"rg0hbezb18\",1749740747998,1749525643074,1749565841689,{\"_24\":59,\"_28\":438,\"_26\":62},{\"_32\":33,\"_30\":31,\"_34\":35},\"a8d3d337534a4f77aa8de03d557b7d7c\",[],\"1644f670abc3422fb4ae58c911ab52e0\",\"vbbi1gnccfl\",{\"_15\":444,\"_52\":53,\"_19\":439,\"_36\":445,\"_11\":446,\"_49\":447,\"_17\":448,\"_59\":449,\"_22\":547,\"_51\":549,\"_47\":550,\"_56\":57,\"_58\":57,\"_13\":551,\"_21\":21,\"_193\":442},\"5233b983391e46bea1a73aa4e64e3e1f\",[],[],1749578645008,\"Solutions\",{\"_365\":450,\"_363\":364,\"_367\":448,\"_369\":451},{},[452,468,492],{\"_382\":453,\"_363\":378,\"_70\":466,\"_377\":53,\"_379\":380,\"_372\":467},[454,458,462],{\"_70\":455,\"_65\":456,\"_363\":386,\"_387\":457},\"Phishing\",\"/solutions/topics/phishing\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd8af97b52a364281ae4ae771eac29f60\",{\"_65\":459,\"_70\":460,\"_387\":461,\"_363\":386},\"/solutions/topics/cybersecurity-compliance\",\"Compliance\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5437345f68ab4fecb25e1bf64d596f05\",{\"_70\":463,\"_65\":464,\"_363\":386,\"_387\":465},\"Business Email Compromise\",\"/solutions/topics/business-email-compromise\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe0006e0247a84d538abfdb56270b1971\",\"Solutions by Topic\",{},{\"_70\":469,\"_372\":470,\"_379\":380,\"_377\":53,\"_363\":378,\"_382\":471},\"Solutions by Industry\",{},[472,476,480,484,488],{\"_65\":473,\"_387\":474,\"_363\":386,\"_70\":475},\"/industries/education\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4951efeb175d46a28d43a56e44f1aaa6\",\"Education\",{\"_363\":386,\"_387\":477,\"_65\":478,\"_70\":479},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2c6e56c396984defa968946c3305fd5d\",\"/industries/financial-services\",\"Finance\",{\"_387\":481,\"_363\":386,\"_70\":482,\"_65\":483},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fad40fb4e0e8f4fc3a283928e18d2cb07\",\"Healthcare\",\"/industries/healthcare\",{\"_387\":485,\"_363\":386,\"_70\":486,\"_65\":487},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1a16399f6f94c3da8e42ddbe735c1c1\",\"Manufacturing\",\"/industries/manufacturing\",{\"_387\":489,\"_65\":490,\"_363\":386,\"_70\":491},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdafe6a53f78a407c80691541d7e292b9\",\"/industries/state-and-local-government\",\"State \u0026 Local Government\",{\"_379\":380,\"_372\":493,\"_70\":494,\"_230\":380,\"_363\":407,\"_495\":496,\"_410\":498,\"_377\":53},{\"_65\":62,\"_375\":418},\"Featured Resource\",\"cardContentOverride\",{\"_141\":497},\"\u003cp\u003ePacked with the information, tools, and guidance you need to keep your organization running smoothly and, most importantly, your patients safe.\u003c/p\u003e\",{\"_215\":499,\"_39\":213,\"_15\":500,\"_45\":501},\"resources\",\"66c49e7c03769aca3efd1adf\",{\"_15\":500,\"_17\":502,\"_21\":21,\"_13\":503,\"_19\":504,\"_59\":505,\"_193\":546},\"Healthcare Cybersecurity Success Kit\",1742716627143,\"5c10263d01de417681f67c6df9d9a9d4\",{\"_17\":502,\"_71\":506,\"_222\":507,\"_207\":508,\"_224\":509,\"_323\":512,\"_230\":6,\"_513\":380,\"_305\":514,\"_515\":516,\"_517\":516,\"_208\":518,\"_534\":535,\"_423\":544,\"_422\":545},\"healthcare-cybersecurity-success-kit\",\"2024-08-21T00:00:00.000Z\",\"2024-08-22T14:36:33.220Z\",{\"_70\":510,\"_67\":511,\"_227\":6,\"_226\":6},\"Healthcare Cybersecurity Success Kit | Huntress\",\"This Healthcare Cybersecurity Success Kit is packed with the information, tools, and guidance you need to keep your organization running smoothly and, most importantly, your patients safe.\",\"https://www.huntress.com/resources/healthcare-cybersecurity-success-kit\",\"gated\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F25165b11288e4ab8ab0dc72832f4eb5e\",\"preGateContent\",\"\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-floatleft\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"floatleft\\\"\u003e\u003cdiv\u003e\u003cimg src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2cb3c18ec5c2400b9c39579acd0077c4\\\" loading=\\\"lazy\\\" alt=\\\"__wf_reserved_inherit\\\" width=\\\"auto\\\" height=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eHackers are hitting healthcare hard. From large hospital networks to small rural clinics, nothing’s off-limits anymore.\u003c/p\u003e\u003cp\u003eBut you don't have to take it. This Healthcare Cybersecurity Success Kit is packed with the information, tools, and guidance you need to keep your organization running smoothly and, most importantly, your patients safe.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\",\"postGateContent\",[519,526],{\"_211\":520},{\"_39\":213,\"_15\":521,\"_215\":208,\"_45\":522},\"6619a1966fc1cc2a81065887\",{\"_15\":521,\"_17\":482,\"_21\":21,\"_13\":523,\"_19\":219,\"_59\":524,\"_193\":525},1741825542581,{\"_17\":482},\"pjx7c10sbo\",{\"_211\":527},{\"_39\":213,\"_15\":528,\"_215\":208,\"_45\":529},\"65f3299e49a461b4b9c72e83\",{\"_15\":528,\"_17\":530,\"_21\":21,\"_13\":531,\"_19\":219,\"_59\":532,\"_193\":533},\"Mastering Cybersecurity\",1741825551705,{\"_17\":530},\"2lak8k9j1q\",\"assetType\",{\"_39\":213,\"_15\":536,\"_215\":537,\"_45\":538},\"65f3299e49a461b4b9c72e40\",\"asset-types\",{\"_15\":536,\"_17\":539,\"_21\":21,\"_13\":540,\"_19\":541,\"_59\":542,\"_193\":543},\"Success Kit\",1741790296798,\"50c69b616da14a22b2d7092dd07fd641\",{\"_17\":539},\"5la3jkmp2b3\",\"https://www.huntress.com/industries/healthcare/healthcare-resource-kit\",\"Get the Healthcare Cybersecurity Success Kit\",\"azzfx59fgpd\",{\"_28\":548,\"_26\":62,\"_24\":59},{\"_32\":33,\"_30\":31,\"_34\":35},1749565841905,{},1749530546748,{\"_13\":553,\"_15\":554,\"_17\":555,\"_19\":439,\"_21\":21,\"_22\":556,\"_36\":558,\"_59\":559,\"_47\":620,\"_49\":621,\"_51\":622,\"_52\":53,\"_56\":57,\"_58\":57,\"_11\":623,\"_193\":442},1749560149759,\"94db9c6a65e047acb4ac7d4d2ea0da30\",\"Why Huntress\",{\"_26\":62,\"_24\":59,\"_28\":557},{\"_30\":31,\"_32\":33,\"_34\":35},[],{\"_365\":560,\"_367\":555,\"_369\":561,\"_363\":364},{},[562,580,593],{\"_363\":378,\"_379\":380,\"_70\":563,\"_382\":564,\"_372\":579,\"_377\":53},\"Who We Serve\",[565,569,575],{\"_65\":566,\"_363\":386,\"_387\":567,\"_70\":568},\"/why-huntress/managed-service-providers\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F11f54e8f5fb54aadbf4c71effaab65a5\",\"Managed Service Providers\",{\"_363\":386,\"_387\":570,\"_70\":571,\"_65\":572,\"_573\":574},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff0209e5a35e34a25a31075aca24dec96\",\"Value Added Resellers\",\"/why-huntress/value-added-resellers\",\"altText\",\"Platform Icon\",{\"_363\":386,\"_387\":576,\"_70\":577,\"_65\":578},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff257bebdca1c45cab6259f8436ca7221\",\"Business \u0026 IT Teams\",\"/why-huntress/businesses-it-teams\",{},{\"_377\":53,\"_379\":380,\"_372\":581,\"_70\":582,\"_363\":378,\"_382\":583},{},\"The Huntress Difference\",[584,589],{\"_363\":386,\"_387\":585,\"_65\":586,\"_573\":587,\"_70\":588},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4cc0a301d59343f08fa3fd23661a7726\",\"/why-huntress/24-7-soc\",\"Issue Detected - Alert Icon\",\"Huntress SOC\",{\"_65\":590,\"_387\":591,\"_363\":386,\"_70\":592},\"/success-stories\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fff7b259c7c5c408f9747e8a28989015b\",\"Case Studies\",{\"_363\":378,\"_377\":53,\"_379\":380,\"_372\":594,\"_382\":597,\"_70\":619,\"_230\":380},{\"_375\":595,\"_65\":596},\"Compare All\",\"/comparison\",[598,601,604,607,610,613,616],{\"_70\":599,\"_65\":600,\"_363\":386},\"Bitdefender\",\"/comparison/huntress-vs-bitdefender\",{\"_65\":602,\"_363\":386,\"_70\":603},\"/comparison/huntress-vs-blackpoint\",\"Blackpoint\",{\"_363\":386,\"_70\":605,\"_65\":606},\"CrowdStrike\",\"/comparison/huntress-vs-crowdstrike\",{\"_363\":386,\"_65\":608,\"_70\":609},\"/comparison/huntress-vs-datto\",\"Datto\",{\"_363\":386,\"_65\":611,\"_70\":612},\"/comparison/huntress-vs-sentinelone\",\"SentinelOne\",{\"_70\":614,\"_65\":615,\"_363\":386},\"Sophos\",\"/comparison/huntress-vs-sophos\",{\"_70\":617,\"_65\":618,\"_363\":386},\"Webroot\",\"/comparison/huntress-vs-webroot\",\"Compare Huntress\",{},1749574641163,1749565841954,[],{\"_56\":57,\"_59\":625,\"_15\":695,\"_49\":696,\"_51\":697,\"_22\":698,\"_58\":57,\"_17\":626,\"_47\":700,\"_19\":439,\"_11\":701,\"_21\":21,\"_36\":702,\"_52\":53,\"_13\":703,\"_193\":442},{\"_363\":364,\"_367\":626,\"_365\":627,\"_369\":628},\"Resources\",{},[629,653,677],{\"_379\":380,\"_70\":630,\"_377\":53,\"_382\":631,\"_372\":650,\"_363\":378},\"Resource Center\",[632,635,638,641,644,647],{\"_363\":386,\"_65\":633,\"_70\":634},\"/resources?assetTypes=Datasheet\",\"Datasheets\",{\"_70\":636,\"_65\":637,\"_363\":386},\"Ebooks\",\"/resources?assetTypes=eBook\",{\"_70\":639,\"_363\":386,\"_65\":640},\"Reports\",\"/resources?assetTypes=Report\",{\"_65\":642,\"_363\":386,\"_70\":643},\"/resources?assetTypes=On-Demand+Webinar\",\"On-Demand Webinars\",{\"_65\":645,\"_70\":646,\"_363\":386},\"/resources?assetTypes=Whitepaper\",\"Whitepapers\",{\"_65\":648,\"_70\":649,\"_363\":386},\"/resources?assetTypes=Video\",\"Videos\",{\"_375\":651,\"_65\":652},\"View All Resources\",\"/resources\",{\"_382\":654,\"_372\":675,\"_377\":53,\"_379\":6,\"_70\":676,\"_363\":378},[655,659,663,667,671],{\"_387\":656,\"_363\":386,\"_70\":657,\"_65\":658},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7f4ca3bd558f425da4f12b81befbb279\",\"Blog\",\"/blog\",{\"_65\":660,\"_363\":386,\"_387\":661,\"_70\":662},\"/upcoming-events\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6aa1f0e921a844ed9975b8c477720a6c\",\"Upcoming Events\",{\"_70\":664,\"_65\":665,\"_363\":386,\"_387\":666},\"Support Documentation\",\"https://support.huntress.io/hc/en-us\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fac02933fbb964cdf9e6c8b3b2280fa5d\",{\"_70\":668,\"_363\":386,\"_387\":669,\"_65\":670},\"Integrations\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F75378b21898340b6b863c3b68ae0a980\",\"/integrations\",{\"_70\":672,\"_65\":673,\"_387\":674,\"_363\":386},\"Huntress Hub\",\"https://hub.huntress.com/#/page/login\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fabe11db97e084bfeb9d370076781caea\",{},\"Other Resources\",{\"_70\":678,\"_230\":380,\"_363\":378,\"_382\":679,\"_379\":380,\"_372\":694,\"_377\":53},\"Produced by Huntress\",[680,685,690],{\"_143\":681,\"_65\":682,\"_363\":683,\"_70\":684},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea18a565ed0e4bdda1f6881a955de34c\",\"/tradecraft-tuesday\",\"Image Link\",\"Tradecraft Tuesday\",{\"_70\":686,\"_363\":683,\"_65\":687,\"_573\":688,\"_143\":689},\"Fireside Chat\",\"/firesidechat\",\"Fireside Chat Community Series\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F98c34785dc62414381fe4d25b1d355a9\",{\"_143\":691,\"_70\":692,\"_363\":683,\"_65\":693},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5f3ffde6942c41b6885da8bc727a4cc5\",\"Product Lab Channel\",\"/product-lab-channel\",{},\"e21c3f198af24be5b52f72480500ff2d\",1749676549589,1749565842009,{\"_26\":62,\"_28\":699,\"_24\":59},{\"_30\":31,\"_32\":33,\"_34\":35},{},[],[],1749560786283,{\"_13\":705,\"_15\":706,\"_17\":707,\"_19\":439,\"_21\":21,\"_22\":708,\"_36\":710,\"_59\":711,\"_47\":717,\"_49\":718,\"_51\":719,\"_52\":53,\"_56\":57,\"_58\":57,\"_11\":720,\"_193\":442},1749561737294,\"84190317c5f14f32ae91ba95a125371a\",\"Pricing\",{\"_26\":62,\"_24\":59,\"_28\":709},{\"_30\":31,\"_32\":33,\"_34\":35},[],{\"_365\":712,\"_363\":716,\"_367\":707,\"_419\":713},{\"_65\":713,\"_375\":707,\"_714\":715},\"/pricing\",\"target\",\"_self\",\"Link\",{},1749579606414,1749565842037,[],{\"_22\":722,\"_52\":53,\"_59\":724,\"_17\":876,\"_58\":57,\"_13\":878,\"_36\":879,\"_19\":439,\"_47\":880,\"_56\":57,\"_11\":881,\"_49\":882,\"_15\":883,\"_21\":21,\"_51\":884,\"_193\":442},{\"_26\":62,\"_28\":723,\"_24\":59},{\"_34\":35,\"_30\":31,\"_32\":33},{\"_369\":725,\"_367\":876,\"_365\":877,\"_363\":364},[726,748,763],{\"_363\":378,\"_382\":727,\"_377\":53,\"_372\":746,\"_70\":747,\"_379\":380},[728,732,737,741],{\"_70\":729,\"_65\":730,\"_363\":386,\"_387\":731},\"Our Story\",\"/company/our-company\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F38494b4ddb7a45a78ca20d43a03176bf\",{\"_387\":733,\"_65\":734,\"_70\":735,\"_363\":386,\"_573\":736},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F33845c53ebd4472b9806d7a76b742616\",\"/company/leadership\",\"Leadership\",\"Leadership Icon\",{\"_387\":738,\"_65\":739,\"_70\":740,\"_363\":386},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3a5e883de76c4f5686d64a1dc0dbe7b6\",\"/company/press\",\"Latest News\",{\"_65\":742,\"_387\":743,\"_70\":744,\"_573\":745,\"_363\":386},\"/awards-and-accolades\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F107b70abda5841439fca3a13a02929cf\",\"Awards\",\"Awards Icon\",{},\"About Huntress\",{\"_70\":749,\"_377\":53,\"_372\":750,\"_382\":751,\"_363\":378},\"Careers\",{},[752,756,758],{\"_387\":753,\"_363\":386,\"_573\":754,\"_65\":755,\"_70\":749},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F80b5a5a31d2245e49c4038e433792c22\",\"Verify Icon\",\"/company/careers\",{\"_363\":386,\"_65\":660,\"_70\":662,\"_387\":757},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1490131472ce4b94a57df268649354a0\",{\"_65\":759,\"_387\":760,\"_363\":386,\"_70\":761,\"_573\":762},\"/contact-us\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3324b3cde0b84f3b8749e3f6577c6540\",\"Contact Us\",\"SAT Content Icon\",{\"_363\":407,\"_379\":380,\"_410\":764,\"_230\":380,\"_372\":871,\"_70\":874,\"_495\":875,\"_377\":53},{\"_215\":765,\"_15\":766,\"_39\":213,\"_45\":767},\"success-stories\",\"2d71ea3f63c447d7a361e21502a74e15\",{\"_36\":768,\"_11\":769,\"_13\":770,\"_15\":766,\"_17\":771,\"_19\":772,\"_21\":21,\"_22\":773,\"_59\":775,\"_47\":866,\"_49\":867,\"_51\":868,\"_52\":53,\"_56\":869,\"_58\":869,\"_193\":870},[],[],1743800825454,\"Key Methods\",\"84071192fd6043e68c9d5963be3e722b\",{\"_28\":774,\"_24\":59,\"_26\":62},{\"_30\":31,\"_32\":33,\"_34\":35},{\"_776\":777,\"_778\":779,\"_804\":805,\"_224\":841,\"_847\":848,\"_835\":849,\"_850\":851,\"_852\":853,\"_256\":771,\"_71\":854,\"_855\":380,\"_305\":856,\"_857\":858,\"_573\":845,\"_17\":771,\"_859\":860,\"_861\":862,\"_863\":864,\"_141\":865},\"heroSubhead\",\"How Key Methods Stopped Guessing and Took Control with Huntress Managed SIEM\",\"mainContent\",{\"_780\":781},\"section\",[782,786,788,790,792,795,797,800,802],{\"_783\":784,\"_785\":62},\"columnOne\",\"\u003ch2\u003ePrologue | Key Methods’ history with Huntress\u003cbr\u003e\u003c/h2\u003e\\n\u003cp\u003eKey Methods first tried Huntress in 2022. They rolled out Huntress Managed Endpoint Detection and Response (EDR) across all their clients for a month, but they scaled back when no major security issues popped up. Instead, they took a more selective approach, using it only when they spotted something suspicious or during new client onboarding.\u003cbr\u003e\\n\u003c/p\u003e\",\"columnTwo\",{\"_783\":787,\"_785\":62},\"\u003ch2\u003eIncident one | Managed EDR quickly shuts down a threat\u003c/h2\u003e\u003cp\u003eIn 2023, Huntress Managed EDR came in handy, flagging suspicious activity inside a client’s network. This wasn’t just any client, however. It was a company handling vast sums of money and a treasure trove of personal data. In other words, a prime target for hackers.\u003c/p\u003e\u003cp\u003eHuntress’ Security Operations Center (SOC) stepped in quickly, working hand-in-hand with Key Methods. In no time, endpoints were isolated, access was shut down, and the threat was contained.\u003c/p\u003e\u003cp\u003eCrisis averted.\u0026nbsp;\u003c/p\u003e\u003cp\u003e…or so it seemed.\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\",{\"_785\":62,\"_783\":789},\"\u003ch2\u003ePost-incident | The decision no MSP wants to make\u0026nbsp;\u0026nbsp;\u003cbr\u003e\u003c/h2\u003e\u003cp\u003eThe real challenge started after the immediate threat was handled. Key Methods was left with critical questions that would inform their next steps.\u003c/p\u003e\u003cp\u003e“All we knew was the attackers had possibly seen things they shouldn’t have,” says Dan Paquette, Managing Partner at Key Methods.\u0026nbsp;\u003c/p\u003e\u003cp\u003eThe entire Key Methods team was on edge, haunted by questions like, “How did the hackers get in?” “What data was compromised?” “Could they still be in the system?” \u003cbr\u003e\u003c/p\u003e\u003cp\u003eWith little in terms of logs or data to go on, they had to make the call no MSP ever wants to make—shut everything down.\u003cbr\u003e\u003c/p\u003e\",{\"_783\":791,\"_785\":62},\"\u003ch2\u003eBefore Huntress Managed SIEM | Playing a costly game of guesswork\u0026nbsp;\u003c/h2\u003e\\n\u003cp\u003eThe impact was huge. The client faced over a week of downtime, more than $75,000 on incident response (IR) and legal fees, and uncertainty about their future.\u0026nbsp;\u003c/p\u003e\\n\u003cp\u003e“It felt like forever to get the client back online,” Paquette admits. “There were so many unknowns. We were digging through user logs, piecing together backward forensics, but our records only went back so far.”\u003c/p\u003e\\n\u003cp\u003eIn the end, it turned out the hacker hadn’t actually stolen any data. Using only screenshots and trickery, they’d pulled off a convincing illusion of a full database breach, leaving the client believing the worst. No data was lost, but the financial and operational toll was massive. \u003c/p\u003e\\n\u003cp\u003eThis was a wake-up call for Key Methods. They realized they needed more than just the ability to detect and respond to threats. They needed clear, immediate answers, especially when it mattered most.\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003c/p\u003e\",{\"_785\":793,\"_783\":794},\"\u003ch2\u003eIncident two | Managed SIEM reveals all\u003c/h2\u003e\\n\u003cp\u003e Not long after the incident, Huntress launched Managed Security Information and Event Management (SIEM). Key Methods jumped on board, determined to avoid ever being uncertain again. While still fine-tuning when another mass-isolation event hit, the difference was obvious.\u0026nbsp;\u003c/p\u003e\u003cp\u003eThis time, a hacker exploited a vulnerability in a client’s firewall. In the past, critical decisions had to be made in real time about\u0026nbsp; whether to call in IR teams, consult legal, or notify cyber insurance. Without solid data, every decision felt like a gamble—overreacting meant wasting time and money, but hesitating could spell disaster.\u003c/p\u003e\u003cp\u003eWith Huntress Managed SIEM in place, everything changed. Put simply, there was no more guessing. The system didn’t just flag threats—it connected the dots. Every log, every move, every breadcrumb the attacker left behind was laid out clearly.\u0026nbsp; \u003cbr\u003e\u003c/p\u003e\u003cp\u003eWith new technology and capabilities at their fingertips, Key Methods had complete clarity to act fast and make the right calls.\u003c/p\u003e\u003cp\u003e\u003cbr\u003e\u003c/p\u003e\",\"\u003cblockquote\u003e“Managed SIEM provides us with immediate, actionable insights, so we’re never left guessing during critical moments.”\u003cbr\u003e\u003c/blockquote\u003e\",{\"_783\":796,\"_785\":62},\"\u003ch2\u003eUnraveling the incident | The Huntress SOC paints a clear picture\u0026nbsp;\u003cbr\u003e\u003c/h2\u003e\\n\u003cp\u003eThe Huntress SOC quickly collaborated with Key Methods, providing clarity within hours. Detailed logs revealed the timeline of events and exactly where the attackers had been. \u003cbr\u003e\u003c/p\u003e\u003cp\u003e“Thanks to Managed SIEM, we had critical information fast,” said Paquette. “We reviewed the logs and immediately recognized the severity of the issue, allowing us to involve IR and legal teams quickly” \u003c/p\u003e\\n\u003cp\u003eWith Managed SIEM’s robust logging capabilities, Key Methods easily exported accurate, reliable data to the IR firm. “There was no question about the quality or authenticity of the logs,” Paquette noted. This significantly accelerated the investigation and led to a crucial finding: no data had been exfiltrated. \u003c/p\u003e\\n\u003cp\u003e“Smaller MSPs like us usually don’t have a SOC,” Paquette explained. “With breaches in the past, we had to bring in an external team, install their tools, and wait for results. This time around, Managed SIEM handled it all. We told the SOC what we needed, ran a quick query, and immediately got clear answers like, ‘No, that executable wasn’t run anywhere else in the organization.’” \u003c/p\u003e\\n\u003cp\u003eWith vital insight, Key Methods swiftly shifted their focus to recovery. By isolating affected systems on day one, they could begin restoration efforts right away. \u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003c/p\u003e\",{\"_783\":798,\"_785\":799},\"\u003ch2\u003eIncident three | Managed SIEM wins the race against downtime\u0026nbsp;\u0026nbsp;\u003cbr\u003e\u003c/h2\u003e\u003cp\u003eWeeks later, another mass-isolation event unfolded, this time targeting a bustling factory—a place where assembly lines hum, conveyor belts zip, and products are packaged with non-stop precision. A place where every minute of downtime risked thousands of dollars in lost revenue. \u003c/p\u003e\u003cp\u003eAgain, an attacker exploited a vulnerability in the client’s firewall. But this time, there was no panic. \u003c/p\u003e\u003cp\u003e“We got on the phone with Huntress, and a SOC analyst immediately understood the situation,” recalls Paquette. “Within hours, we identified the issue and had already begun restoring operations. This time, legal or IR teams weren’t even needed.” \u003c/p\u003e\u003cp\u003eArmed with real-time intelligence from the Huntress SOC and Managed SIEM, Key Methods knew the attack’s origin with unparalleled speed. The factory was back online the same day. \u003c/p\u003e\u003cp\u003e“The SOC analyzed every executable across all machines and confidently pinpointed exactly which devices the hackers had compromised,” Paquette explains. “Having access to such precise, actionable information is incredibly powerful.” \u003c/p\u003e\u003cp\u003eWhat could’ve been a financially devastating shutdown was a masterclass in resilience.\u003cbr\u003e\u003cbr\u003e\u003c/p\u003e\",\"\u003cblockquote\u003e“The SOC analyzed every executable across all machines and confidently pinpointed exactly which devices the hackers had compromised. Having access to such precise, actionable information is incredibly powerful.”\u003cbr\u003e\u003c/blockquote\u003e\",{\"_783\":801,\"_785\":62},\"\u003ch2\u003eThe power of Managed SIEM | Achieving true confidence, clarity, and control\u003cbr\u003e\u003c/h2\u003e\\n\u003cp\u003eFor Key Methods, Managed SIEM brought unprecedented clarity, control, and responsiveness to their operations. With Huntress Managed SIEM, they can: \u003c/p\u003e\\n\u003cul\u003e\\n    \u003cli\u003eRespond to incidents in hours instead of days\u003c/li\u003e\\n    \u003cli\u003eMinimize client downtime and significantly cut recovery costs\u003c/li\u003e\\n    \u003cli\u003eProtect clients from escalating threats while avoiding unnecessary legal or forensic complications\u003c/li\u003e\\n    \u003cli\u003eMake decisive, high-stakes calls with confidence because they’re armed with clear insights on what happened, how it happened, and what data was affected\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003e“It’s all about confidence and clarity,” says Paquette. “Managed SIEM provides us with immediate, actionable insights, so we’re never left guessing during critical moments.”\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003c/p\u003e\",{\"_783\":803,\"_785\":62},\"\u003ch2\u003eWhy Key Methods is all-in on Huntress\u003cbr\u003e\u003c/h2\u003e\u003cp\u003eFrom day one, Huntress Managed SIEM proved its worth by helping Key Methods contain threats faster, reduce downtime, and avoid unnecessary third-party headaches. While hackers rely on staying hidden, Managed SIEM gave Key Methods complete clarity into their malicious ways. \u003c/p\u003e\u003cp\u003eWhile Managed EDR wasn’t initially a priority, it didn’t take long for Key Methods to see the power of the entire Huntress platform. Now, they’ve expanded further to make Identity Threat Detection and Response (ITDR) and Security Awareness Training (SAT) part of their offerings. Instead of treating them as optional extras, they’ve baked them into their core service plans.\u0026nbsp; \u003c/p\u003e\u003cp\u003eWhat really sets Huntress apart is the technology, which is purpose-built for the Huntress SOC. This tight integration of proprietary tools and human expertise creates a defense system that radically cuts down on errors, response times, and risks. \u003c/p\u003e\u003cp\u003e“When your primary security layers are all unified in one platform, it’s easier to build depth with a vendor,” says Paquette. “And when everything feeds into the same SOC, it’s even better.”\u003cbr\u003e\u003cbr\u003e\u003c/p\u003e\",\"products\",[806,824],{\"_807\":808},\"product\",{\"_39\":213,\"_15\":809,\"_215\":804,\"_45\":810},\"671c067f6144c945bfc997d2\",{\"_36\":811,\"_11\":812,\"_13\":813,\"_15\":809,\"_17\":402,\"_19\":814,\"_21\":21,\"_22\":815,\"_59\":817,\"_47\":821,\"_49\":822,\"_51\":813,\"_52\":53,\"_56\":57,\"_58\":57,\"_193\":823},[],[],1736141572401,\"017139400da04b248757ac73dd38eaff\",{\"_24\":59,\"_28\":816,\"_26\":62},{\"_30\":31,\"_32\":33,\"_34\":35},{\"_573\":818,\"_305\":819,\"_17\":402,\"_820\":380},\"Overwhelming Data Becoming Simplified with SIEM\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F284f4bc395cf4c38ae88bfc6f9669fe3\",\"active\",{},1742154870710,\"uzv6axcbugk\",{\"_807\":825},{\"_39\":213,\"_15\":826,\"_215\":804,\"_45\":827},\"664a2fe9c12e9dbfd3b4a0b4\",{\"_36\":828,\"_11\":829,\"_13\":830,\"_15\":826,\"_17\":390,\"_19\":814,\"_21\":21,\"_22\":831,\"_59\":833,\"_47\":838,\"_49\":839,\"_51\":830,\"_52\":53,\"_56\":57,\"_58\":57,\"_193\":840},[],[],1736141572469,{\"_26\":62,\"_28\":832,\"_24\":59},{\"_30\":31,\"_32\":33,\"_34\":35},{\"_305\":834,\"_17\":390,\"_835\":836,\"_573\":837,\"_820\":380},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa31d628a29d240dab4e00080df8ffba1\",\"orderDate\",\"2024-06-04T00:00:00.000Z\",\"Man working at a desk with headphones on\",{},1742154876857,\"pkusn24qo4e\",{\"_67\":842,\"_843\":844,\"_573\":845,\"_70\":846},\"Key Methods had seen their share of security incidents. But when one of their clients suffered a mass-isolation event, they realized they were flying blind. Attackers had accessed sensitive data, but without clear logs, they were left scrambling.\",\"openGraphImage\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F92852707f65d412faf9ede9ade8030f1\",\"Key Methods Logo\",\" Key Methods Case Study\",\"introSectionDescription\",\"\u003cp\u003eKey Methods, a top managed service provider (MSP) in Washington state, has earned a solid reputation for keeping security front and center in their business. They manage more than 2,000 endpoints and support nearly 80 clients, providing all with strong solutions to tackle the toughest threats. But as they’ve learned, when it comes to cybersecurity, it’s not just about stopping attacks—it’s also about understanding what’s really going on behind the scenes.\u003c/p\u003e\u003cbr\u003e\",\"Fri Apr 04 2025 00:00:00 GMT-0700 (Pacific Daylight Time)\",\"companyContactName\",\"Dan Paquette\",\"companyAbout\",\"\u003cp\u003eFounded in 1998 as a small IT support company, Key Methods found their niche in providing professional technology services that let their customers focus on core business competencies without worrying about their IT infrastructure. \u003cbr\u003e \u003c/p\u003e\u003cp\u003eIn 2002, they shifted their focus to proactively monitor and maintain their clients’ computer networks. This new approach of focusing on “up-time” instead of waiting for “things to break” helped them grow. Today, their team consists of nearly 20 employees, serving clients around the Pacific Northwest. They look forward to pursuing their goal to be Washington State’s premier IT services company.\u003cbr\u003e\u003c/p\u003e\",\"keymethods-case-study\",\"showPdf\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fccbc23d75b9640b69566b916ea6f832a\",\"caseStudyPdfUrl\",\"https://cdn.builder.io/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F659979229f5449f28c49a65895b9d2ef?alt=media\u0026token=e87850ca-2ec6-4625-a6d9-b2e8a487f1ad\u0026apiKey=3eb6f92aedf74f109c7b4b0897ec39a8\",\"companyLocation\",\"Wenatchee, WA\",\"heroHeadline\",\"The MSP Who Saw It All\",\"fullWidthQuote\",\"\u003cp\u003e“When your primary security layers are all unified in one platform, it’s easier to build depth with a vendor. And when everything feeds into the same SOC, it’s even better.”\u003cbr\u003e\u003c/p\u003e\",\"\u003cp\u003eKey Methods had seen their share of security incidents. But when one of their clients suffered a mass-isolation event, they realized they were flying blind. Attackers had accessed sensitive data, but without clear logs, they were left scrambling.\u003cbr\u003e\u003c/p\u003e\",{},1745506909841,1743803252848,\"wAnY6pD8qneav3wmIkWFzKSZXNM2\",\"iz34rwwxcnj\",{\"_65\":872,\"_375\":418,\"_714\":873},\"/asset/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F659979229f5449f28c49a65895b9d2ef?alt=media\u0026token=e87850ca-2ec6-4625-a6d9-b2e8a487f1ad\u0026apiKey=3eb6f92aedf74f109c7b4b0897ec39a8\",\"_blank\",\"Featured Success Story\",{\"_714\":873,\"_65\":872},\"About\",{},1749561775412,[],{},[],1749580736350,\"2dc5eb1bcc024fcca43b7644cd21d4a1\",1749565842074,\"g2Awards\",[887,906,923,940],{\"_15\":888,\"_17\":889,\"_59\":890},\"b1ef1fa50cc44b4cb964fcd76ce27c47\",\"Managed SAT Awards\",{\"_310\":891,\"_892\":893},\"Managed SAT\",\"images\",[894,897,900,903],{\"_143\":895,\"_573\":896},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe6cc6492c7ad457db8613e2be1b0bf7a\",\"Security Awareness Training Leader Small Business G2 Badges Spring 2025\",{\"_143\":898,\"_573\":899},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa20ef7581ec94548b774ab925b721874\",\"Security Awareness Training Momentum Leader G2 Badges Spring 2025\",{\"_143\":901,\"_573\":902},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb22fd7c3f53744aeaad49a1383a8adf2\",\"Security Awareness Training Regional Leader EMEA G2 Badges Spring 2025\",{\"_573\":904,\"_143\":905},\"Security Awareness Training Regional Leader Europe G2 Badges Spring 2025\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8fc8eb8c2feb400dabbbe15a0e65ebd4\",{\"_15\":907,\"_17\":908,\"_59\":909},\"a15035cbedea4437bf339e54f6573731\",\"Managed ITDR Awards\",{\"_310\":400,\"_892\":910},[911,914,917,920],{\"_143\":912,\"_573\":913},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9710816629b94b46803509bc69c90b6c\",\"Identity Threat Detection and Response (ITDR) Leader G2 Badge Spring 2025\",{\"_573\":915,\"_143\":916},\"Identity Threat Detection and Response (ITDR) High Performer G2 Badge Spring 2025\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffbee1654661a4853b7bdc68eba98a19b\",{\"_573\":918,\"_143\":919},\"Identity Threat Detection and Response (ITDR) Best Estimated ROI G2 Badge Spring 2025\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4c7270fe798448eb893d35ec3a6c5230\",{\"_143\":921,\"_573\":922},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fac3ee471f9be4debbe512f873584df07\",\"Identity Threat Detection and Response (ITDR) Best Support G2 Badge Spring 2025\",{\"_15\":924,\"_17\":925,\"_59\":926},\"f4f2c8064b7e4e92b01a3c95a41dde18\",\"Managed EDR Awards\",{\"_892\":927,\"_310\":390},[928,931,934,937],{\"_573\":929,\"_143\":930},\"Managed Detection and Response(MDR) Grid Leader G2 Badge Spring 2025\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F54010559656e44848d6f2b5e1478bd6f\",{\"_143\":932,\"_573\":933},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F559f64e417b34c02ae35785fa6f44de1\",\"Managed Detection and Response(MDR) High Performer Enterprise G2 Badge Spring 2025\",{\"_143\":935,\"_573\":936},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F64b4e0f5995b44ed95804354224cb723\",\"Managed Detection and Response(MDR) Best Support G2 Badge Spring 2025\",{\"_573\":938,\"_143\":939},\"Managed Detection and Response(MDR) Best Results G2 Badge Spring 2025\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd748e2d9379544119bb9895ec2304877\",{\"_15\":941,\"_17\":942,\"_59\":943},\"9b043f11647d490c8780d9136cf88b34\",\"Default G2 Awards\",{\"_310\":944,\"_892\":945},\"default\",[946,947,948,950],{\"_143\":932,\"_573\":933},{\"_143\":935,\"_573\":936},{\"_143\":949},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4b380ad74f5142e682933db387225c5f\",{\"_143\":939,\"_573\":938},\"assetTypes\",[953,956,959,962,965,966,969,972],{\"_15\":954,\"_17\":955},\"65f3299e49a461b4b9c72e3c\",\"Datasheet\",{\"_15\":957,\"_17\":958},\"65f3299e49a461b4b9c72e3e\",\"Handbook\",{\"_15\":960,\"_17\":961},\"65f3299e49a461b4b9c72e39\",\"On-Demand Webinar\",{\"_15\":963,\"_17\":964},\"65f3299e49a461b4b9c72e38\",\"Report\",{\"_15\":536,\"_17\":539},{\"_15\":967,\"_17\":968},\"65f3299e49a461b4b9c72e3d\",\"Video\",{\"_15\":970,\"_17\":971},\"65f3299e49a461b4b9c72e3b\",\"Whitepaper\",{\"_15\":973,\"_17\":974},\"65f3299e49a461b4b9c72e3a\",\"eBook\",\"builderApiKey\",\"3eb6f92aedf74f109c7b4b0897ec39a8\",\"actionData\",\"errors\"]\n");</script><!--$?--><template id="B:1"></template><!--/$--></div><script>$RC=function(b,c,e){c=document.getElementById(c);c.parentNode.removeChild(c);var a=document.getElementById(b);if(a){b=a.previousSibling;if(e)b.data="$!",a.setAttribute("data-dgst",e);else{e=b.parentNode;a=b.nextSibling;var f=0;do{if(a&&8===a.nodeType){var d=a.data;if("/$"===d)if(0===f)break;else f--;else"$"!==d&&"$?"!==d&&"$!"!==d||f++}d=a.nextSibling;e.removeChild(a);a=d}while(a);for(;c.firstChild;)e.insertBefore(c.firstChild,a);b.data="$"}b._reactRetry&&b._reactRetry()}};$RC("B:0","S:0")</script><div hidden id="S:1"><script>window.__reactRouterContext.streamController.close();</script></div><script>$RC("B:1","S:1")</script></body></html>