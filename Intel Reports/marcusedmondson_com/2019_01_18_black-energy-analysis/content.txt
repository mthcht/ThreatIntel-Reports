<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">

<title>Black Energy &#8211; Analysis &#8211; Marcus Edmondson | Offensive Security | Information Security</title>
<script type="text/javascript">
  WebFontConfig = {"google":{"families":["Source+Sans+Pro:r:latin,latin-ext","Source+Sans+Pro:r,i,b,bi:latin,latin-ext"]},"api_url":"https:\/\/fonts-api.wp.com\/css"};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active body, .wf-active button, .wf-active input, .wf-active select, .wf-active textarea{font-family:"Source Sans Pro",sans-serif}.wf-active h1, .wf-active h2, .wf-active h3, .wf-active h4, .wf-active h5, .wf-active h6{font-family:"Source Sans Pro",sans-serif;font-weight:400;font-style:normal}.wf-active h1{font-style:normal;font-weight:400}.wf-active h2{font-style:normal;font-weight:400}.wf-active h3{font-style:normal;font-weight:400}.wf-active h4{font-style:normal;font-weight:400}.wf-active h5{font-style:normal;font-weight:400}.wf-active h6{font-style:normal;font-weight:400}.wf-active .widget-title{font-weight:400;font-style:normal}.wf-active .site-title{font-family:"Source Sans Pro",sans-serif;font-style:normal;font-weight:400}.wf-active .entry-title, .wf-active .page-title{font-style:normal;font-weight:400}.wf-active .page-title{font-style:normal;font-weight:400}.wf-active .error404 .site-title, .wf-active .search-no-results .site-title, .wf-active .singular .site-title{font-style:normal;font-weight:400}.wf-active .singular .entry-title{font-style:normal;font-weight:400}.wf-active .comment-reply-title, .wf-active .comments-title{font-style:normal;font-weight:400}@media screen and (min-width: 768px){.wf-active h1{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h2{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h3{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h4{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h5{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h6{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .site-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .entry-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .page-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .singular .entry-title{font-style:normal;font-weight:400}}@media screen and (min-width: 1060px){.wf-active h1{font-style:normal;font-weight:400}}@media screen and (min-width: 1060px){.wf-active h2{font-style:normal;font-weight:400}}@media screen and (min-width: 1060px){.wf-active h3{font-style:normal;font-weight:400}}@media screen and (min-width: 1060px){.wf-active h4{font-style:normal;font-weight:400}}@media screen and (min-width: 1060px){.wf-active .site-title{font-style:normal;font-weight:400}}@media screen and (min-width: 1060px){.wf-active .error404 .site-title, .wf-active .search-no-results .site-title, .wf-active .singular .site-title{font-style:normal;font-weight:400}}@media screen and (min-width: 1060px){.wf-active .singular .entry-title{font-style:normal;font-weight:400}}</style>
<meta name='robots' content='max-image-preview:large' />

<!-- Async WordPress.com Remote Login -->
<script id="wpcom_remote_login_js">
var wpcom_remote_login_extra_auth = '';
function wpcom_remote_login_remove_dom_node_id( element_id ) {
	var dom_node = document.getElementById( element_id );
	if ( dom_node ) { dom_node.parentNode.removeChild( dom_node ); }
}
function wpcom_remote_login_remove_dom_node_classes( class_name ) {
	var dom_nodes = document.querySelectorAll( '.' + class_name );
	for ( var i = 0; i < dom_nodes.length; i++ ) {
		dom_nodes[ i ].parentNode.removeChild( dom_nodes[ i ] );
	}
}
function wpcom_remote_login_final_cleanup() {
	wpcom_remote_login_remove_dom_node_classes( "wpcom_remote_login_msg" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_validate" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_js" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_iframe" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_styles" );
}

// Watch for messages back from the remote login
window.addEventListener( "message", function( e ) {
	if ( e.origin === "https://r-login.wordpress.com" ) {
		var data = {};
		try {
			data = JSON.parse( e.data );
		} catch( e ) {
			wpcom_remote_login_final_cleanup();
			return;
		}

		if ( data.msg === 'LOGIN' ) {
			// Clean up the login check iframe
			wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );

			var id_regex = new RegExp( /^[0-9]+$/ );
			var token_regex = new RegExp( /^.*|.*|.*$/ );
			if (
				token_regex.test( data.token )
				&& id_regex.test( data.wpcomid )
			) {
				// We have everything we need to ask for a login
				var script = document.createElement( "script" );
				script.setAttribute( "id", "wpcom_remote_login_validate" );
				script.src = '/remote-login.php?wpcom_remote_login=validate'
					+ '&wpcomid=' + data.wpcomid
					+ '&token=' + encodeURIComponent( data.token )
					+ '&host=' + window.location.protocol
					+ '//' + window.location.hostname
					+ '&postid=141'
					+ '&is_singular=1';
				document.body.appendChild( script );
			}

			return;
		}

		// Safari ITP, not logged in, so redirect
		if ( data.msg === 'LOGIN-REDIRECT' ) {
			window.location = 'https://wordpress.com/log-in?redirect_to=' + window.location.href;
			return;
		}

		// Safari ITP, storage access failed, remove the request
		if ( data.msg === 'LOGIN-REMOVE' ) {
			var css_zap = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } @media screen and ( max-width: 782px ) { html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } }';
			var style_zap = document.createElement( 'style' );
			style_zap.type = 'text/css';
			style_zap.appendChild( document.createTextNode( css_zap ) );
			document.body.appendChild( style_zap );

			var e = document.getElementById( 'wpcom_request_access_iframe' );
			e.parentNode.removeChild( e );

			document.cookie = 'wordpress_com_login_access=denied; path=/; max-age=31536000';

			return;
		}

		// Safari ITP
		if ( data.msg === 'REQUEST_ACCESS' ) {
			console.log( 'request access: safari' );

			// Check ITP iframe enable/disable knob
			if ( wpcom_remote_login_extra_auth !== 'safari_itp_iframe' ) {
				return;
			}

			// If we are in a "private window" there is no ITP.
			var private_window = false;
			try {
				var opendb = window.openDatabase( null, null, null, null );
			} catch( e ) {
				private_window = true;
			}

			if ( private_window ) {
				console.log( 'private window' );
				return;
			}

			var iframe = document.createElement( 'iframe' );
			iframe.id = 'wpcom_request_access_iframe';
			iframe.setAttribute( 'scrolling', 'no' );
			iframe.setAttribute( 'sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-top-navigation-by-user-activation' );
			iframe.src = 'https://r-login.wordpress.com/remote-login.php?wpcom_remote_login=request_access&origin=' + encodeURIComponent( data.origin ) + '&wpcomid=' + encodeURIComponent( data.wpcomid );

			var css = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 46px !important; } * html body { margin-top: 46px !important; } @media screen and ( max-width: 660px ) { html { margin-top: 71px !important; } * html body { margin-top: 71px !important; } #wpcom_request_access_iframe { display: block; height: 71px !important; } } #wpcom_request_access_iframe { border: 0px; height: 46px; position: fixed; top: 0; left: 0; width: 100%; min-width: 100%; z-index: 99999; background: #23282d; } ';

			var style = document.createElement( 'style' );
			style.type = 'text/css';
			style.id = 'wpcom_request_access_styles';
			style.appendChild( document.createTextNode( css ) );
			document.body.appendChild( style );

			document.body.appendChild( iframe );
		}

		if ( data.msg === 'DONE' ) {
			wpcom_remote_login_final_cleanup();
		}
	}
}, false );

// Inject the remote login iframe after the page has had a chance to load
// more critical resources
window.addEventListener( "DOMContentLoaded", function( e ) {
	var iframe = document.createElement( "iframe" );
	iframe.style.display = "none";
	iframe.setAttribute( "scrolling", "no" );
	iframe.setAttribute( "id", "wpcom_remote_login_key" );
	iframe.src = "https://r-login.wordpress.com/remote-login.php"
		+ "?wpcom_remote_login=key"
		+ "&origin=aHR0cHM6Ly9tYXJjdXNlZG1vbmRzb24uY29t"
		+ "&wpcomid=126222267"
		+ "&time=1741727266";
	document.body.appendChild( iframe );
}, false );
</script>
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel='dns-prefetch' href='//wordpress.com' />
<link rel='dns-prefetch' href='//fonts-api.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Marcus Edmondson | Offensive Security | Information Security &raquo; Feed" href="https://marcusedmondson.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Marcus Edmondson | Offensive Security | Information Security &raquo; Comments Feed" href="https://marcusedmondson.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Marcus Edmondson | Offensive Security | Information Security &raquo; Black Energy &#8211;&nbsp;Analysis Comments Feed" href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s2.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1719498190i&ver=6.7.2-RC1-59780"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-1' href='https://s1.wp.com/_static/??-eJxtzFsKgCAQheENZaMg+BStRXQI80oz0vbDCILo5cAHhx/OJlwtjIUhd9FS30Ih2JGbdfEx5FrH+J6Q4MBkGb1olfij2RFN8J9MIeIbvjXua16UUUZLLY3eL2BkNNM=&cssminify=yes' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-2-1' href='https://s2.wp.com/_static/??-eJydzEEOwiAQheELCdMSEtOF8SxAyYSKQGYGDbe37cadC5cvL98P76ZCLRKLQMsdU2HAvk8fCfeHIrzMpCdtwfeUV/C5hofKyZOjASwjRx2YL/AzdCqGLUpzB3ejdlFIaf03QU5SQf7y+/M2X+1slsUYu30AMZRP0A==&cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
.has-text-align-justify{text-align:justify;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-4-1' href='https://s2.wp.com/_static/??-eJzTLy/QzcxLzilNSS3WzyrWz01NyUxMzUnNTc0rQeEU5CRWphbp5qSmJyZX6uVm5uklFxfr6OPTDpRD5sM02efaGpoZmFkYGRuZGmQBAHPvL0Y=&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-8-1' href='https://s1.wp.com/_static/??/wp-content/mu-plugins/core-compat/wp-mediaelement.css,/wp-content/mu-plugins/wpcom-bbpress-premium-themes.css?m=1432920480j&cssminify=yes' type='text/css' media='all' />
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #222222;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333333;--wp--preset--color--light-gray: #cccccc;--wp--preset--color--purple: #81699b;--wp--preset--color--dark-purple: #553a72;--wp--preset--color--dark-green: #557d73;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-10-1' href='https://s1.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/moon/jetpack_vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.css?m=1737738052i&cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='verbum-gutenberg-css-css' href='https://widgets.wp.com/verbum-block-editor/block-editor.css?ver=1738686361' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-12-1' href='https://s1.wp.com/_static/??-eJyVjtEKwjAMRX/IGufQPomfIlsJNWublLVF/HsjExnqi2+5J7k3F27ZOOGKXCE1k2PzxAWcpKTIRAqoqnyQrZINELBUUnd5D8tilVmvmDQhtxFIyeyHODi9NXso9R7xH8MYxYXvF6vaE9Y8uPDSkEQYLsQOPDLOS9Wf4zP0nE6d7e3x0O86Oz0Adr9osQ==&cssminify=yes' type='text/css' media='all' />
<style id='intergalactic-2-style-inline-css'>
.entry-content-wrapper {background-color: #ffffff; }
</style>
<link rel='stylesheet' id='intergalactic-2-lato-css' href='https://fonts-api.wp.com/css?family=Lato%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%26subset%3Dlatin%2Clatin-ext&#038;subset=latin%2Clatin-ext' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-14-1' href='https://s2.wp.com/wp-content/themes/pub/intergalactic-2/inc/style-wpcom.css?m=1493062088i&cssminify=yes' type='text/css' media='all' />
<style id='akismet-widget-style-inline-css'>

			.a-stats {
				--akismet-color-mid-green: #357b49;
				--akismet-color-white: #fff;
				--akismet-color-light-grey: #f6f7f7;

				max-width: 350px;
				width: auto;
			}

			.a-stats * {
				all: unset;
				box-sizing: border-box;
			}

			.a-stats strong {
				font-weight: 600;
			}

			.a-stats a.a-stats__link,
			.a-stats a.a-stats__link:visited,
			.a-stats a.a-stats__link:active {
				background: var(--akismet-color-mid-green);
				border: none;
				box-shadow: none;
				border-radius: 8px;
				color: var(--akismet-color-white);
				cursor: pointer;
				display: block;
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen-Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', sans-serif;
				font-weight: 500;
				padding: 12px;
				text-align: center;
				text-decoration: none;
				transition: all 0.2s ease;
			}

			/* Extra specificity to deal with TwentyTwentyOne focus style */
			.widget .a-stats a.a-stats__link:focus {
				background: var(--akismet-color-mid-green);
				color: var(--akismet-color-white);
				text-decoration: none;
			}

			.a-stats a.a-stats__link:hover {
				filter: brightness(110%);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 0 2px rgba(0, 0, 0, 0.16);
			}

			.a-stats .count {
				color: var(--akismet-color-white);
				display: block;
				font-size: 1.5em;
				line-height: 1.4;
				padding: 0 13px;
				white-space: nowrap;
			}
		
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-16-1' href='https://s1.wp.com/_static/??-eJzTLy/QTc7PK0nNK9HPLdUtyClNz8wr1i9KTcrJTwcy0/WTi5G5ekCujj52Temp+bo5+cmJJZn5eSgc3bScxMwikFb7XFtDE1NLExMLc0OTLACohS2q&cssminify=yes' type='text/css' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='print-css-17-1' href='https://s1.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035i&cssminify=yes' type='text/css' media='print' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-20-1' href='https://s2.wp.com/_static/??-eJyNjcEKwjAQRH/IuA1aehI/ReImJKmb3eAmFP9eW3oRL16GeTC8gaUaFG6BG5RuKvWYWWEOrTp87AxFZA3fKShocs/gnfevrWaOR1Q9wP+mW2YEFcyODEkU/YIfW0uhfH7TGSLJ3dE6uJaLneww2mkYT/MbUOlJHA==&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" id="wpcom-actionbar-placeholder-js-extra">
/* <![CDATA[ */
var actionbardata = {"siteID":"126222267","postID":"141","siteURL":"https:\/\/marcusedmondson.com","xhrURL":"https:\/\/marcusedmondson.com\/wp-admin\/admin-ajax.php","nonce":"1b4647dce4","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/p8xCb1-2h","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/reader\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","shortLinkCopied":"Shortlink copied to clipboard."}};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/s1.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/moon\/jetpack_vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s0.wp.com/_static/??-eJx1jcEKwjAQRH/IdKkBiwfxU6QmS0lMdmOyofbvjRChHjwNwzzewJqUYRIkgVhVCnVxVMCjpNk8eofITHBzZOBeXbCQMcyCViUuUn7bEB0NvhxgJ/aNCaJS5tf23ZosVIvlM/pnxbz12Av+Qiq6JbfTDl/jZZy0nk7H86j9G13UTmI='></script>
<script type="text/javascript" id="rlt-proxy-js-after">
/* <![CDATA[ */
	rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
/* ]]> */
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://marcusedmondson.wordpress.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/" />
<link rel='shortlink' href='https://wp.me/p8xCb1-2h' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fmarcusedmondson.com%2F2019%2F01%2F18%2Fblack-energy-analysis%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fmarcusedmondson.com%2F2019%2F01%2F18%2Fblack-energy-analysis%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Black Energy &#8211; Analysis" />
<meta property="og:url" content="https://marcusedmondson.com/2019/01/18/black-energy-analysis/" />
<meta property="og:description" content="So today I wanted to do a blog post on Black Energy. The sample I will be working with was sourced from hybrid analysis here: This particular piece of malware was used to target the networks used t…" />
<meta property="article:published_time" content="2019-01-18T16:30:26+00:00" />
<meta property="article:modified_time" content="2019-01-18T16:30:26+00:00" />
<meta property="og:site_name" content="Marcus Edmondson | Offensive Security | Information Security" />
<meta property="og:image" content="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png" />
<meta property="og:image:width" content="3360" />
<meta property="og:image:height" content="2100" />
<meta property="og:image:alt" content="Screen Shot 2019-01-18 at 9.45.40 AM.png" />
<meta property="og:locale" content="en_US" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<meta name="twitter:creator" content="@medmondson44" />
<meta name="twitter:site" content="@medmondson44" />
<meta name="twitter:text:title" content="Black Energy &#8211;&nbsp;Analysis" />
<meta name="twitter:image" content="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png?w=640" />
<meta name="twitter:image:alt" content="Screen Shot 2019-01-18 at 9.45.40 AM.png" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="search" type="application/opensearchdescription+xml" href="https://marcusedmondson.com/osd.xml" title="Marcus Edmondson &#124; Offensive Security &#124; Information Security" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<meta name="theme-color" content="#ffffff" />
<link rel="pingback" href="https://marcusedmondson.com/xmlrpc.php"><meta name="description" content="So today I wanted to do a blog post on Black Energy. The sample I will be working with was sourced from hybrid analysis here: https://www.hybrid-analysis.com/sample/39d04828ab0bba42a0e4cdd53fe1c04e4eef6d7b26d0008bd0d88b06cc316a81?environmentId=4. This particular piece of malware was used to target the networks used to control power grids and has been associated to the Sandworm Team, who used it to also&hellip;" />
<style type="text/css" id="custom-colors-css">body { color: #000000;}
mark, ins { color: #000000;}
pre { color: #000000;}
.singular .entry-content th { border-color: #000000;}
.singular .entry-content th { border-color: rgba( 0, 0, 0, 0.2 );}
.entry-tags .heading, .entry-categories .heading { color: #000000;}
.singular .entry-content td, .comment-body { border-color: #aaaaaa;}
.singular .entry-content td, .comment-body { border-color: rgba( 170, 170, 170, 0.2 );}
a.comment-reply-link, a.comment-reply-link:visited, .comment-metadata, .comment-metadata a, .comment-metadata a:visited, .singular .entry-content blockquote, .singular .entry-meta, .entry-meta a, .entry-meta a:visited, .entry-footer a, .entry-footer a:visited, .site-description { color: #6D6D6D;}
.entry-content a.more-link, .entry-content a.more-link:visited { color: #FFFFFF;}
.main-navigation a,
			.main-navigation a:visited { color: #FFFFFF;}
#infinite-handle span { color: #353535;}
button, input[type="button"], input[type="reset"], input[type="submit"] { border-color: #222222;}
.menu-toggle, .menu-toggle:hover, .menu-toggle:focus, .menu-toggle:active { border-color: #222222;}
.menu-toggle:hover, .menu-toggle:focus, .menu-toggle:active { color: #222222;}
.menu-toggle.x.toggle-on .lines:before, .menu-toggle.x.toggle-on .lines:after { background-color: #919191;}
button, input[type="button"], input[type="reset"], input[type="submit"] { color: #222222;}
.lines, .lines:before, .lines:after { background-color: #222222;}
.comment-author .fn a, .comment-author .fn a:visited { color: #222222;}
.search .site-title a, .search .site-title a:visited, .search .site-title a:hover, .archive .site-title a, .archive .site-title a:visited, .archive .site-title a:hover, .blog .site-title a, .blog .site-title a:visited, .blog .site-title a:hover, .page:not(.singular) .site-title a, .page:not(.singular) .site-title a:visited, .page:not(.singular) .site-title a:hover { color: #222222;}
.entry-content a.more-link:hover, .entry-content a.more-link:active, .entry-content a.more-link:focus { color: #222222;}
body, .entry-content-wrapper { background-color: #ffffff;}
.entry-content a,
			.entry-content a:visited { color: #41777B;}
a, a:visited { color: #41777B;}
.entry-author a,
			.entry-author a:visited { color: #71B4B5;}
#infinite-handle span { background-color: #71b4b5;}
.singular .entry-content h1, .singular .entry-content h2, .singular .entry-content h3, .singular .entry-content h4, .singular .entry-content h5, .singular .entry-content h6 { color: #18282A;}
.singular .entry-content a:hover, .singular .entry-content a:active { color: #18282A;}
.widget-title { color: #589AAB;}
</style>
<link rel="icon" href="https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=32" sizes="32x32" />
<link rel="icon" href="https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=180" />
<meta name="msapplication-TileImage" content="https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=270" />
</head>

<body class="post-template-default single single-post postid-141 single-format-standard wp-embed-responsive customizer-styles-applied singular single-thumbnail widgets-hidden jetpack-reblog-enabled custom-colors">
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
	<header id="masthead" class="site-header" role="banner">
		
		<div class="site-branding">
										<p class="site-title"><a href="https://marcusedmondson.com/" rel="home">Marcus Edmondson | Offensive Security | Information Security</a></p>
							<p class="site-description">A blog about threat hunting and information security.</p>
					</div>

		<button class="menu-toggle x">
			<span class="lines"></span>
			Menu		</button>
	</header><!-- #masthead -->
	<div class="slide-menu">
		<nav id="site-navigation" class="main-navigation" role="navigation">
			<div class="menu-primary-container"><ul id="menu-primary" class="menu"><li id="menu-item-8" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8"><a href="/">Home</a></li>
<li id="menu-item-9" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-9"><a href="https://marcusedmondson.com/about/">About</a></li>
<li id="menu-item-10" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10"><a href="https://marcusedmondson.com/contact/">Contact</a></li>
</ul></div>		</nav><!-- #site-navigation -->

		
		
<div id="secondary" class="widget-area" role="complementary">
	<aside id="search-1" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://marcusedmondson.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside><aside id="nav_menu-1" class="widget widget_nav_menu"><h1 class="widget-title">Navigation</h1><div class="menu-primary-container"><ul id="menu-primary-1" class="menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8"><a href="/">Home</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-9"><a href="https://marcusedmondson.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10"><a href="https://marcusedmondson.com/contact/">Contact</a></li>
</ul></div></aside><aside id="archives-1" class="widget widget_archive"><h1 class="widget-title">Archive</h1>
			<ul>
					<li><a href='https://marcusedmondson.com/2024/01/'>January 2024</a></li>
	<li><a href='https://marcusedmondson.com/2023/04/'>April 2023</a></li>
	<li><a href='https://marcusedmondson.com/2022/02/'>February 2022</a></li>
	<li><a href='https://marcusedmondson.com/2022/01/'>January 2022</a></li>
	<li><a href='https://marcusedmondson.com/2021/12/'>December 2021</a></li>
	<li><a href='https://marcusedmondson.com/2021/11/'>November 2021</a></li>
	<li><a href='https://marcusedmondson.com/2021/07/'>July 2021</a></li>
	<li><a href='https://marcusedmondson.com/2021/04/'>April 2021</a></li>
	<li><a href='https://marcusedmondson.com/2021/03/'>March 2021</a></li>
	<li><a href='https://marcusedmondson.com/2021/02/'>February 2021</a></li>
	<li><a href='https://marcusedmondson.com/2020/08/'>August 2020</a></li>
	<li><a href='https://marcusedmondson.com/2020/07/'>July 2020</a></li>
	<li><a href='https://marcusedmondson.com/2019/02/'>February 2019</a></li>
	<li><a href='https://marcusedmondson.com/2019/01/'>January 2019</a></li>
	<li><a href='https://marcusedmondson.com/2018/12/'>December 2018</a></li>
	<li><a href='https://marcusedmondson.com/2018/08/'>August 2018</a></li>
	<li><a href='https://marcusedmondson.com/2018/03/'>March 2018</a></li>
	<li><a href='https://marcusedmondson.com/2018/02/'>February 2018</a></li>
			</ul>

			</aside><aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://marcusedmondson.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside></div><!-- #secondary -->

	</div>
	<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
				<div class="entry-background" style="background-image:url(https://marcusedmondson.files.wordpress.com/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png?crop)">
		<header class="entry-header">
			<h1 class="entry-title">Black Energy &#8211;&nbsp;Analysis</h1>		</header><!-- .entry-header -->
	</div>

<article id="post-141" class="post-141 post type-post status-publish format-standard hentry category-uncategorized has-post-thumbnail fallback-thumbnail">
	<div class="entry-content-wrapper">
		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/" rel="bookmark"><time class="entry-date published updated" datetime="2019-01-18T16:30:26+00:00">January 18, 2019</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://marcusedmondson.com/author/marcusedmondson/">Marcus Edmondson</a></span></span>		</div><!-- .entry-meta -->
		<div class="entry-content">
			<p>So today I wanted to do a blog post on Black Energy. The sample I will be working with was sourced from hybrid analysis here: <a href="https://www.hybrid-analysis.com/sample/39d04828ab0bba42a0e4cdd53fe1c04e4eef6d7b26d0008bd0d88b06cc316a81?environmentId=4" rel="nofollow">https://www.hybrid-analysis.com/sample/39d04828ab0bba42a0e4cdd53fe1c04e4eef6d7b26d0008bd0d88b06cc316a81?environmentId=4</a>. This particular piece of malware was used to target the networks used to control power grids and has been associated to the Sandworm Team, who used it to also target organizations in the Ukraine.  According to Mitre the Sandworm Team is a Russian cyber espionage group that has operated since approximately 2009.  The group likely consists of Russian pro-hacktivists. Sandworm Team targets mainly Ukrainian entities associated with energy, industrial control systems, SCADA, government, and media. Sandworm Team has been linked to the Ukrainian energy sector attack in late 2015. So now that we have a little background lets start our analysis.</p>
<p>When you initially open up the document you are greeted with this.</p>
<p><img data-attachment-id="142" data-permalink="https://marcusedmondson.com/2019/01/18/black-energy-analysis/screen-shot-2019-01-18-at-9-45-40-am/" data-orig-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png" data-orig-size="3360,2100" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screen shot 2019-01-18 at 9.45.40 am" data-image-description="" data-image-caption="" data-medium-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png?w=300" data-large-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png?w=1000" class="alignnone size-full wp-image-142" src="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png?w=1000" alt="Screen Shot 2019-01-18 at 9.45.40 AM.png"   srcset="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png 3360w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png?w=150&amp;h=94 150w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png?w=300&amp;h=188 300w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png?w=768&amp;h=480 768w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.45.40-am.png?w=1024&amp;h=640 1024w" sizes="(max-width: 3360px) 100vw, 3360px" /></p>
<p>I don&#8217;t speak Russian but, I&#8217;m pretty sure this is telling the user to view this document you need to enable the content. So lets do it and see what we can get. I&#8217;m going to use my usual setup of RegShot/Procmon and Process Hacker with my Windows VM pointing to my Remnux VM where I will have fakedns, inestsim and Wireshark running. So here is what RegShot is showing me.</p>
<p><img data-attachment-id="143" data-permalink="https://marcusedmondson.com/2019/01/18/black-energy-analysis/screen-shot-2019-01-18-at-9-57-10-am/" data-orig-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.57.10-am.png" data-orig-size="3360,2100" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screen shot 2019-01-18 at 9.57.10 am" data-image-description="" data-image-caption="" data-medium-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.57.10-am.png?w=300" data-large-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.57.10-am.png?w=1000" class="alignnone size-full wp-image-143" src="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.57.10-am.png?w=1000" alt="screen shot 2019-01-18 at 9.57.10 am"   srcset="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.57.10-am.png 3360w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.57.10-am.png?w=150&amp;h=94 150w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.57.10-am.png?w=300&amp;h=188 300w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.57.10-am.png?w=768&amp;h=480 768w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-9.57.10-am.png?w=1024&amp;h=640 1024w" sizes="(max-width: 3360px) 100vw, 3360px" /></p>
<p>After taking a quick look it looks like we have a .lnk file being dropped into the Startup folder which is a pretty common persistence technique used by malware. Inside the .lnk file the target is: %windir%\System32\rundll32.exe &#8220;C:\Users\IEUser\AppData\Local\FONTCACHE.DAT&#8221;,#1. We also have multiple other processes being kicked off by the word document, one of which is vba_macro.exe that runs and deletes itself. Here is the process listing from Process Hacker.</p>
<p><img data-attachment-id="144" data-permalink="https://marcusedmondson.com/2019/01/18/black-energy-analysis/be_processes/" data-orig-file="https://marcusedmondson.com/wp-content/uploads/2019/01/be_processes.png" data-orig-size="1152,648" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="be_processes" data-image-description="" data-image-caption="" data-medium-file="https://marcusedmondson.com/wp-content/uploads/2019/01/be_processes.png?w=300" data-large-file="https://marcusedmondson.com/wp-content/uploads/2019/01/be_processes.png?w=1000" class="alignnone size-full wp-image-144" src="https://marcusedmondson.com/wp-content/uploads/2019/01/be_processes.png?w=1000" alt="be_processes"   srcset="https://marcusedmondson.com/wp-content/uploads/2019/01/be_processes.png 1152w, https://marcusedmondson.com/wp-content/uploads/2019/01/be_processes.png?w=150&amp;h=84 150w, https://marcusedmondson.com/wp-content/uploads/2019/01/be_processes.png?w=300&amp;h=169 300w, https://marcusedmondson.com/wp-content/uploads/2019/01/be_processes.png?w=768&amp;h=432 768w, https://marcusedmondson.com/wp-content/uploads/2019/01/be_processes.png?w=1024&amp;h=576 1024w" sizes="(max-width: 1152px) 100vw, 1152px" /></p>
<p>After looking at Wireshark we also have a network connection going to 5[.]149[.]254[.]114//Microsoft/Update/KC074913[.]php and sending back some base64 to the server.</p>
<p><img data-attachment-id="145" data-permalink="https://marcusedmondson.com/2019/01/18/black-energy-analysis/screen-shot-2019-01-18-at-10-16-00-am-1/" data-orig-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.16.00-am-1.png" data-orig-size="3360,2100" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screen shot 2019-01-18 at 10.16.00 am 1" data-image-description="" data-image-caption="" data-medium-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.16.00-am-1.png?w=300" data-large-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.16.00-am-1.png?w=1000" loading="lazy" class="alignnone size-full wp-image-145" src="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.16.00-am-1.png?w=1000" alt="screen shot 2019-01-18 at 10.16.00 am 1"   srcset="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.16.00-am-1.png 3360w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.16.00-am-1.png?w=150&amp;h=94 150w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.16.00-am-1.png?w=300&amp;h=188 300w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.16.00-am-1.png?w=768&amp;h=480 768w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.16.00-am-1.png?w=1024&amp;h=640 1024w" sizes="(max-width: 3360px) 100vw, 3360px" /></p>
<p>The base64 wil decode to this:</p>
<p>b_id=MSEDGEWIN10_320E10D4F923CEC8B1A11E4A1DB9950D&amp;b_gen=301018stb&amp;b_ver=2.3&amp;os_v=17134&amp;os_type=1</p>
<p>Which is the malware fingerprinting the host OS versions.</p>
<p>I also want to cover a quick way for you to dump vba_macro.exe before it runs and deletes itself. So on the Word document click alt+F11 or on Mac option+F11, this will bring up the Visual Basic window showing the macros. At the very beginning you see array after array of numbers, which appears to possibly be machine code.</p>
<p><img data-attachment-id="146" data-permalink="https://marcusedmondson.com/2019/01/18/black-energy-analysis/screen-shot-2019-01-18-at-10-25-26-am/" data-orig-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.25.26-am.png" data-orig-size="3360,2100" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screen shot 2019-01-18 at 10.25.26 am" data-image-description="" data-image-caption="" data-medium-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.25.26-am.png?w=300" data-large-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.25.26-am.png?w=1000" loading="lazy" class="alignnone size-full wp-image-146" src="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.25.26-am.png?w=1000" alt="screen shot 2019-01-18 at 10.25.26 am"   srcset="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.25.26-am.png 3360w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.25.26-am.png?w=150&amp;h=94 150w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.25.26-am.png?w=300&amp;h=188 300w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.25.26-am.png?w=768&amp;h=480 768w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.25.26-am.png?w=1024&amp;h=640 1024w" sizes="(max-width: 3360px) 100vw, 3360px" /></p>
<p>If you scroll down to the bottom you will see the meat of what&#8217;s happening. It is looping over the arrays and writing it to a file called vba_macro. So we will put a breakpoint right after the loop ends and then run the macros to dump the file, which we will then move to the desktop.</p>
<p><img data-attachment-id="147" data-permalink="https://marcusedmondson.com/2019/01/18/black-energy-analysis/screen-shot-2019-01-18-at-10-32-58-am/" data-orig-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.32.58-am.png" data-orig-size="3360,2100" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screen shot 2019-01-18 at 10.32.58 am" data-image-description="" data-image-caption="" data-medium-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.32.58-am.png?w=300" data-large-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.32.58-am.png?w=1000" loading="lazy" class="alignnone size-full wp-image-147" src="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.32.58-am.png?w=1000" alt="screen shot 2019-01-18 at 10.32.58 am"   srcset="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.32.58-am.png 3360w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.32.58-am.png?w=150&amp;h=94 150w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.32.58-am.png?w=300&amp;h=188 300w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.32.58-am.png?w=768&amp;h=480 768w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.32.58-am.png?w=1024&amp;h=640 1024w" sizes="(max-width: 3360px) 100vw, 3360px" /></p>
<p>So as I started analyzing vba_macro I loaded it into IDA to get a look at the imports and strings, I noticed most of the imports had no xrefs which puzzled me for a while, I think a lot of the imports are in there to send the analyst down rabbit holes. So I loaded vba_macro up in x32dbg and set breakpoints on some Native API functions like NtWriteFile, NtOpenProcess, etc&#8230; I did this because I remember reading that malware will sometimes use these lower level API&#8217;s to avoid detection. I then started running it to see what I could find.</p>
<p>So here is a call to NtWriteFile where it looks like it is creating the .lnk file.<img data-attachment-id="148" data-permalink="https://marcusedmondson.com/2019/01/18/black-energy-analysis/screen-shot-2019-01-18-at-10-58-41-am/" data-orig-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.58.41-am.png" data-orig-size="2024,212" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screen shot 2019-01-18 at 10.58.41 am" data-image-description="" data-image-caption="" data-medium-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.58.41-am.png?w=300" data-large-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.58.41-am.png?w=1000" loading="lazy" class="alignnone size-full wp-image-148" src="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.58.41-am.png?w=1000" alt="Screen Shot 2019-01-18 at 10.58.41 AM.png"   srcset="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.58.41-am.png 2024w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.58.41-am.png?w=150&amp;h=16 150w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.58.41-am.png?w=300&amp;h=31 300w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.58.41-am.png?w=768&amp;h=80 768w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-10.58.41-am.png?w=1024&amp;h=107 1024w" sizes="(max-width: 2024px) 100vw, 2024px" /></p>
<p>And here is a call to ShellExecuteW opening the .lnk file.</p>
<p><img data-attachment-id="149" data-permalink="https://marcusedmondson.com/2019/01/18/black-energy-analysis/screen-shot-2019-01-18-at-11-09-59-am/" data-orig-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-11.09.59-am.png" data-orig-size="3360,2100" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screen shot 2019-01-18 at 11.09.59 am" data-image-description="" data-image-caption="" data-medium-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-11.09.59-am.png?w=300" data-large-file="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-11.09.59-am.png?w=1000" loading="lazy" class="alignnone size-full wp-image-149" src="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-11.09.59-am.png?w=1000" alt="screen shot 2019-01-18 at 11.09.59 am"   srcset="https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-11.09.59-am.png 3360w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-11.09.59-am.png?w=150&amp;h=94 150w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-11.09.59-am.png?w=300&amp;h=188 300w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-11.09.59-am.png?w=768&amp;h=480 768w, https://marcusedmondson.com/wp-content/uploads/2019/01/screen-shot-2019-01-18-at-11.09.59-am.png?w=1024&amp;h=640 1024w" sizes="(max-width: 3360px) 100vw, 3360px" /></p>
<p>So to sum things up a quick down and dirty of my interpretation of what this malware is doing:</p>
<ol>
<li>Word document macros run which drop vba_macro to disk.</li>
<li>vba_macro creates the .lnk and fontcache.dat and runs .lnk file which in turn runs fontcache.dat with rundll32 which provides the network connectivity to the above address we talked about.</li>
<li>vba_macro also kicks off a cmd.exe which is continually running PING.exe and attrib.exe.</li>
</ol>
<p>So thank you for reading and hope this has helped someone to learn something new and until next time&#8230;</p>
<p>Happy hunting,</p>
<p>Marcus</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>References:</p>
<p><a href="https://attack.mitre.org/groups/G0034/">https://attack.mitre.org/groups/G0034/</a></p>
<p><a href="https://securelist.com/blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/73440/">https://securelist.com/blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/73440/</a></p>
<p><a href="https://threatconnect.com/blog/casting-a-light-on-blackenergy/">https://threatconnect.com/blog/casting-a-light-on-blackenergy/</a></p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-141" class="share-twitter sd-button share-icon" href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-141" class="share-facebook sd-button share-icon" href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-141" class="share-linkedin sd-button share-icon" href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-126222267-141-67d0a6225dc00' data-src='//widgets.wp.com/likes/index.html?ver=20250311#blog_id=126222267&amp;post_id=141&amp;origin=marcusedmondson.wordpress.com&amp;obj_id=126222267-141-67d0a6225dc00&amp;domain=marcusedmondson.com' data-name='like-post-frame-126222267-141-67d0a6225dc00' data-title='Like or Reblog'><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class='loading'>Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	
</div></div>					</div><!-- .entry-content -->

		<footer class="entry-footer">
			
					</footer><!-- .entry-footer -->

	</div><!-- .entry-content-wrapper -->
</article><!-- #post-## -->

			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			5 thoughts on &ldquo;<span>Black Energy &#8211;&nbsp;Analysis</span>&rdquo;		</h2>

		
		<ol class="comment-list">
					<li id="comment-49" class="comment byuser comment-author-keydet89 even thread-even depth-1 parent">
			<article id="div-comment-49" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://0.gravatar.com/avatar/6cace935dd0481c01fcb2fcde6a29c8eba3adbff32470e2e4f90ab4cd1fd43f5?s=75&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/6cace935dd0481c01fcb2fcde6a29c8eba3adbff32470e2e4f90ab4cd1fd43f5?s=75&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/6cace935dd0481c01fcb2fcde6a29c8eba3adbff32470e2e4f90ab4cd1fd43f5?s=113&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/6cace935dd0481c01fcb2fcde6a29c8eba3adbff32470e2e4f90ab4cd1fd43f5?s=150&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/6cace935dd0481c01fcb2fcde6a29c8eba3adbff32470e2e4f90ab4cd1fd43f5?s=225&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/6cace935dd0481c01fcb2fcde6a29c8eba3adbff32470e2e4f90ab4cd1fd43f5?s=300&#038;d=identicon&#038;r=G 4x' class='avatar avatar-75' height='75' width='75' loading='lazy' decoding='async' />						<b class="fn">keydet89</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/#comment-49"><time datetime="2019-01-20T11:46:22+00:00">January 20, 2019 at 11:46 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Just for clarification, is the &#8220;.lnk file being dropped into the Startup folder&#8221;, or created in the Startup folder?  &#8220;Dropping&#8221; would suggest that it&#8217;s downloaded somehow, rather than being created.  Thanks!</p>
<p id="comment-like-49" data-liked=comment-not-liked class="comment-likes comment-not-liked"><a href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?like_comment=49&#038;_wpnonce=8066cbb21d" class="comment-like-link needs-login" rel="nofollow" data-blog="126222267"><span>Like</span></a><span id="comment-like-count-49" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?replytocom=49#respond" data-commentid="49" data-postid="141" data-belowelement="div-comment-49" data-respondelement="respond" data-replyto="Reply to keydet89" aria-label="Reply to keydet89">Reply</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-51" class="comment byuser comment-author-marcusedmondson bypostauthor odd alt depth-2">
			<article id="div-comment-51" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=75&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=75&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=113&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=150&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=225&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=300&#038;d=identicon&#038;r=G 4x' class='avatar avatar-75' height='75' width='75' loading='lazy' decoding='async' />						<b class="fn"><a href="https://marcusedmondson.wordpress.com" class="url" rel="ugc external nofollow">Marcus Edmondson</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/#comment-51"><time datetime="2019-01-20T12:20:30+00:00">January 20, 2019 at 12:20 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>It was created in the folder. My VM did not have internet connection. During debugging of vba_macro.exe it created the file with NtCreateFile. When I use the term “dropper” I use it as a file being created and when I use “downloader” I use it for a file being downloaded. </p>
<p id="comment-like-51" data-liked=comment-not-liked class="comment-likes comment-not-liked"><a href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?like_comment=51&#038;_wpnonce=2b0b53cd42" class="comment-like-link needs-login" rel="nofollow" data-blog="126222267"><span>Like</span></a><span id="comment-like-count-51" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?replytocom=51#respond" data-commentid="51" data-postid="141" data-belowelement="div-comment-51" data-respondelement="respond" data-replyto="Reply to Marcus Edmondson" aria-label="Reply to Marcus Edmondson">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-54" class="pingback even thread-odd thread-alt depth-1">
			<div class="comment-body">
				Pingback: <a href="https://blog.lowmillercg.com/blackenergy-analysis/" class="url" rel="ugc external nofollow">BlackEnergy Analysis | Lowmiller Consulting Group Blog</a> 			</div>
		</li><!-- #comment-## -->
		<li id="comment-55" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-55" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://0.gravatar.com/avatar/341fc2e63508fac9880405d75db7ad19fc23370e756cc71e6ba91042bbe66336?s=75&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/341fc2e63508fac9880405d75db7ad19fc23370e756cc71e6ba91042bbe66336?s=75&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/341fc2e63508fac9880405d75db7ad19fc23370e756cc71e6ba91042bbe66336?s=113&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/341fc2e63508fac9880405d75db7ad19fc23370e756cc71e6ba91042bbe66336?s=150&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/341fc2e63508fac9880405d75db7ad19fc23370e756cc71e6ba91042bbe66336?s=225&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/341fc2e63508fac9880405d75db7ad19fc23370e756cc71e6ba91042bbe66336?s=300&#038;d=identicon&#038;r=G 4x' class='avatar avatar-75' height='75' width='75' loading='lazy' decoding='async' />						<b class="fn">think.pink@gmx.de</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/#comment-55"><time datetime="2019-01-21T12:34:00+00:00">January 21, 2019 at 12:34 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Very nice, but some of the screenshots are really much too small&#8230;&#8230;&#8230;</p>
<p id="comment-like-55" data-liked=comment-not-liked class="comment-likes comment-not-liked"><a href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?like_comment=55&#038;_wpnonce=8b5c2413bc" class="comment-like-link needs-login" rel="nofollow" data-blog="126222267"><span>Like</span></a><span id="comment-like-count-55" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?replytocom=55#respond" data-commentid="55" data-postid="141" data-belowelement="div-comment-55" data-respondelement="respond" data-replyto="Reply to think.pink@gmx.de" aria-label="Reply to think.pink@gmx.de">Reply</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-56" class="comment byuser comment-author-marcusedmondson bypostauthor even depth-2">
			<article id="div-comment-56" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=75&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=75&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=113&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=150&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=225&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=300&#038;d=identicon&#038;r=G 4x' class='avatar avatar-75' height='75' width='75' loading='lazy' decoding='async' />						<b class="fn"><a href="https://marcusedmondson.wordpress.com" class="url" rel="ugc external nofollow">Marcus Edmondson</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/#comment-56"><time datetime="2019-01-21T12:37:53+00:00">January 21, 2019 at 12:37 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I appreciate the feedback! You are correct, I will definitely fix that in my next post. </p>
<p id="comment-like-56" data-liked=comment-not-liked class="comment-likes comment-not-liked"><a href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?like_comment=56&#038;_wpnonce=0832b9afbb" class="comment-like-link needs-login" rel="nofollow" data-blog="126222267"><span>Like</span></a><span id="comment-like-count-56" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/?replytocom=56#respond" data-commentid="56" data-postid="141" data-belowelement="div-comment-56" data-respondelement="respond" data-replyto="Reply to Marcus Edmondson" aria-label="Reply to Marcus Edmondson">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2019/01/18/black-energy-analysis/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://marcusedmondson.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>


<div class="comment-form__verbum transparent"></div><div class="verbum-form-meta"><input type='hidden' name='comment_post_ID' value='141' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />

			<input type="hidden" name="highlander_comment_nonce" id="highlander_comment_nonce" value="2e890a3cbb" />
			<input type="hidden" name="verbum_show_subscription_modal" value="" /></div><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="a465c5adae" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="201"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->


			<div class="entry-footer-wrapper">
						<div class="entry-author author-avatar-show">
						<div class="author-avatar">
				<img alt='' src='https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=140&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=140&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=210&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=280&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=420&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/2e8e109ca2aeff3ccfabfa76a58b76020122043e71b67b832f65c2e3698dec77?s=560&#038;d=identicon&#038;r=G 4x' class='avatar avatar-140' height='140' width='140' loading='lazy' decoding='async' />			</div><!-- .author-avatar -->
			
			<div class="author-heading">
				<h2 class="author-title">
					Published by <span class="author-name">Marcus Edmondson</span>				</h2>
			</div><!-- .author-heading -->

			<p class="author-bio">
				With over fifteen years of experience in cyber security and information technology, I am an expert in digital forensics, threat hunting, and incident response. I currently work as a Cyber Network Operator at the US Department of Defense, where I use various tools and techniques in an offensive capacity on critical networks. 

I have a passion for hunting, forensics, and detection, and I leverage my background in offensive cyber operations to improve defenses and gain visibility into attacks. I am skilled in collecting, parsing, and analyzing security data at scale using PowerShell, Velociraptor, Elasticsearch, SQL, Python, and spreadsheet tools. I am always eager to learn and apply new techniques to find adversaries on networks. I hold eleven GIAC certifications: GCFA, GCWN, GCFE, GPEN, GCPN, GREM, GCIH, GDAT, GCTI, GWAPT and GCIA.				<a class="author-link" href="https://marcusedmondson.com/author/marcusedmondson/" rel="author">
					View all posts by Marcus Edmondson				</a>
			</p><!-- .author-bio -->
		</div><!-- .entry-auhtor -->
						
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://marcusedmondson.com/2019/01/13/rig-exploit-kit-vidar-behavioral-analysis/" rel="prev"><span class="title">Previous</span>Rig Exploit Kit &#8211; Vidar Behavioral&nbsp;Analysis</a></div><div class="nav-next"><a href="https://marcusedmondson.com/2019/01/21/powershell-downloader-emotet/" rel="next"><span class="title">Next</span>PowerShell Downloader &#8211;&nbsp;Emotet</a></div></div>
	</nav>			</div><!-- .entry-footer-wrapper -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


	</div><!-- #content -->

	<footer id="colophon" class="site-footer" role="contentinfo">
				<div class="site-info">
			<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
			
					</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

<!--  -->
<script type="text/javascript" src="//0.gravatar.com/js/hovercards/hovercards.min.js?ver=2025117d8bf6c02970a26c6b0c26b0fcfc89796aa30f84307cffd8fd28d2bcca53dd7a" id="grofiles-cards-js"></script>
<script type="text/javascript" id="wpgroho-js-extra">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240i'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init(
					'body',
					'#wp-admin-bar-my-account',
					{
						i18n: {
							'Edit your profile →': 'Edit your profile →',
							'View profile →': 'View profile →',
							'Contact': 'Contact',
							'Send money': 'Send money',
							'Sorry, we are unable to load this Gravatar profile.': 'Sorry, we are unable to load this Gravatar profile.',
							'Profile not found.': 'Profile not found.',
							'Too Many Requests.': 'Too Many Requests.',
							'Internal Server Error.': 'Internal Server Error.',
						},
					}
				);
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-c2af608a802cf47e8d64367be34e191c">
	</div>
	<div class="grofile-hash-map-dcda95dc7d97521f34498134d48ad2ae">
	</div>
	<div class="grofile-hash-map-140038f170eb1973d9c1145e68ff8ee8">
	</div>
	<div class="grofile-hash-map-dcda95dc7d97521f34498134d48ad2ae">
	</div>
	</div>
		<div id="actionbar" dir="ltr" style="display: none;"
			class="actnbr-pub-intergalactic-2 actnbr-has-follow actnbr-has-actions">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-comment" href="https://marcusedmondson.com/2019/01/18/black-energy-analysis/#comments">
							<svg class="gridicon gridicons-comment" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 16l-5 5v-5H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2h-7z"/></g></svg>							<span>Comment						</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"/></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://marcusedmondson.com">
				<img loading='lazy' alt='' src='https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=50' srcset='https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=50 1x, https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=75 1.5x, https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=100 2x, https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=150 3x, https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=200 4x' class='avatar avatar-50' height='50' width='50' />				Marcus Edmondson | Offensive Security | Information Security			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com" accept-charset="utf-8" style="display: none;">
																				<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address" />
										</div>
										<input type="hidden" name="action" value="subscribe" />
										<input type="hidden" name="blog_id" value="126222267" />
										<input type="hidden" name="source" value="https://marcusedmondson.com/2019/01/18/black-energy-analysis/" />
										<input type="hidden" name="sub-type" value="actionbar-follow" />
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="2b5d123701" />										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fmarcusedmondson.com%252F2019%252F01%252F18%252Fblack-energy-analysis%252F">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"/></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
								<li class="actnbr-sitename">
			<a href="https://marcusedmondson.com">
				<img loading='lazy' alt='' src='https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=50' srcset='https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=50 1x, https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=75 1.5x, https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=100 2x, https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=150 3x, https://marcusedmondson.com/wp-content/uploads/2020/07/image.jpg?w=200 4x' class='avatar avatar-50' height='50' width='50' />				Marcus Edmondson | Offensive Security | Information Security			</a>
		</li>
								<li class="actnbr-folded-follow">
										<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
								</li>
														<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
							<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fmarcusedmondson.com%252F2019%252F01%252F18%252Fblack-energy-analysis%252F">Log in</a></li>
																<li class="actnbr-shortlink">
										<a href="https://wp.me/p8xCb1-2h">
											<span class="actnbr-shortlink__text">Copy shortlink</span>
											<span class="actnbr-shortlink__icon"><svg class="gridicon gridicons-checkmark" height="16" width="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M9 19.414l-6.707-6.707 1.414-1.414L9 16.586 20.293 5.293l1.414 1.414"/></g></svg></span>
										</a>
									</li>
																<li class="flb-report">
									<a href="https://wordpress.com/abuse/?report_url=https://marcusedmondson.com/2019/01/18/black-energy-analysis/" target="_blank" rel="noopener noreferrer">
										Report this content									</a>
								</li>
															<li class="actnbr-reader">
									<a href="https://wordpress.com/reader/blogs/126222267/posts/141">
										View post in Reader									</a>
								</li>
															<li class="actnbr-subs">
									<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
								</li>
																<li class="actnbr-fold"><a href="">Collapse this bar</a></li>
														</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20250116";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20250204";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/marcusedmondson.com\/2019\/01\/18\/black-energy-analysis\/":141};
	</script>
				<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-2' href='https://s0.wp.com/_static/??-eJyljEsKgDAMBS9kDUUquhDPom0Qaz/BNHh9KdgTuBl4w2PgIWVzKpgKRFEU5DgTg8dCm72+DTHnCicBGex2Z2EMwM9JeKtdkgvYW+YOftTaqYkaXOOix8noQU+z8S9MR0BZ&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" src="https://s1.wp.com/wp-content/js/mobile-useragent-info.js?m=1609849039i&amp;ver=20241018" id="mobile-useragent-info-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="verbum-settings-js-before">
/* <![CDATA[ */
window.VerbumComments = {"Log in or provide your name and email to leave a reply.":"Log in or provide your name and email to leave a reply.","Log in or provide your name and email to leave a comment.":"Log in or provide your name and email to leave a comment.","Receive web and mobile notifications for posts on this site.":"Receive web and mobile notifications for posts on this site.","Name":"Name","Email (address never made public)":"Email (address never made public)","Website (optional)":"Website (optional)","Leave a reply. (log in optional)":"Leave a reply. (log in optional)","Leave a comment. (log in optional)":"Leave a comment. (log in optional)","Log in to leave a reply.":"Log in to leave a reply.","Log in to leave a comment.":"Log in to leave a comment.","Logged in via %s":"Logged in via %s","Log out":"Log out","Email":"Email","(Address never made public)":"(Address never made public)","Instantly":"Instantly","Daily":"Daily","Reply":"Reply","Comment":"Comment","WordPress":"WordPress","Weekly":"Weekly","Notify me of new posts":"Notify me of new posts","Email me new posts":"Email me new posts","Email me new comments":"Email me new comments","Cancel":"Cancel","Write a comment...":"Write a comment...","Write a reply...":"Write a reply...","Website":"Website","Optional":"Optional","We'll keep you in the loop!":"We'll keep you in the loop!","Loading your comment...":"Loading your comment...","Discover more from":"Discover more from Marcus Edmondson | Offensive Security | Information Security","Subscribe now to keep reading and get access to the full archive.":"Subscribe now to keep reading and get access to the full archive.","Continue reading":"Continue reading","Never miss a beat!":"Never miss a beat!","Interested in getting blog post updates? Simply click the button below to stay in the loop!":"Interested in getting blog post updates? Simply click the button below to stay in the loop!","Enter your email address":"Enter your email address","Subscribe":"Subscribe","Comment sent successfully":"Comment sent successfully","Save my name, email, and website in this browser for the next time I comment.":"Save my name, email, and website in this browser for the next time I comment.","siteId":126222267,"postId":141,"mustLogIn":false,"requireNameEmail":true,"commentRegistration":false,"connectURL":"https:\/\/marcusedmondson.wordpress.com\/public.api\/connect\/?action=request&domain=marcusedmondson.com","logoutURL":"https:\/\/marcusedmondson.wordpress.com\/wp-login.php?action=logout&_wpnonce=f725d7a150","homeURL":"https:\/\/marcusedmondson.com\/","subscribeToBlog":true,"subscribeToComment":true,"isJetpackCommentsLoggedIn":false,"jetpackUsername":"","jetpackUserId":0,"jetpackSignature":"","jetpackAvatar":"https:\/\/0.gravatar.com\/avatar\/?s=96&amp;d=identicon&amp;r=G","enableBlocks":true,"enableSubscriptionModal":true,"currentLocale":"en","isJetpackComments":false,"allowedBlocks":["core\/paragraph","core\/list","core\/code","core\/list-item","core\/quote","core\/image","core\/embed","core\/quote","core\/code"],"embedNonce":"e67c26a544","verbumBundleUrl":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/moon\/jetpack_vendor\/automattic\/jetpack-mu-wpcom\/src\/features\/verbum-comments\/dist\/index.js","isRTL":false,"vbeCacheBuster":1738686361,"iframeUniqueId":0,"colorScheme":false}
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/_static/??/wp-content/mu-plugins/likes/queuehandler.js,/wp-includes/js/dist/vendor/wp-polyfill.min.js?m=1727178113j'></script>
<script type="text/javascript" src="https://s1.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/moon/jetpack_vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/assets/dynamic-loader.js?m=1737738052i&amp;minify=false&amp;ver=8faf228ea9885f52f2fc" id="verbum-dynamic-loader-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="comment-like-js-extra">
/* <![CDATA[ */
var comment_like_text = {"loading":"Loading...","swipeUrl":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/comment-likes\/js\/lib\/swipe.js?ver=20131008"};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/moon\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/marcusedmondson.com\/wp-admin\/admin-ajax.php","nonce":"8f93e1a8ca","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/marcusedmondson.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fmarcusedmondson.com%2F2019%2F01%2F18%2Fblack-energy-analysis%2F","blog_id":"126222267","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=126222267&v=wpcom&tz=0&user_id=0&subd=marcusedmondson","is_public":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/_static/??-eJydj1sOwiAQRTckHRWN/hiXYijQOuUZHqndvVit0X5o9I85uQ8u9J5wZ5O0CUwmXucWbQTujCmIaFQyQjcDVRcX8GJMZ2mKzOcasJDQMs14Qk7WN+sM/WaOCn0ptYo0judIGrxMAWi5zuL9e0F6PVQG7bzlZVsnk2dcPW4wzlk4lTCoM2oBnAWXo9RP3QS+xDKF0chEaLW8x02gCaNYfPBOFaT3Zcns/H9KPLMgBRNiGJ9o28eGozmsdpTut3Sz3ndXGni/6A=='></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
	<iframe src='https://widgets.wp.com/likes/master.html?ver=20250311#ver=20250311&amp;origin=https://marcusedmondson.com' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' class='wpl-new-layout' role="dialog" aria-hidden="true" tabindex="-1">
		<div class="likes-text">
			<span>%d</span>		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>

		<script src="//stats.wp.com/w.js?68" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'126222267','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'126222267','v':'wpcom','tz':'0','user_id':'0','post':'141','subd':'marcusedmondson'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1mNzc2NTVTamdsd0xoLz9RQkM2K298TXY9bERQMXc2MjhEaVZfb2wwakRoSj0mUkp1THptM1NdbkV1WjZIcU9mVWQmPUIvMlN6Jk8wW3NYVEJ3dWZOWExuWD9CblhlVnFBZWZMWTI2eVFvTmx3RWZoXXYxVXdmJll3VDF0MkJpMXJ+OHBXODNKTFp5WGFlbi0ybFZKRjlNPWlPaS1VdVJIV0EvNitrUUJbXy1VPytFRltGRHQtc1Jmalp2WCYsaC0mT2licVJsK1U9cFJ0WlQmRHRsfnVfR0NSWE9pNmozVVB3W1A9R1sucyZmPXZXa2R+NGdQYV1GbDFOUk1OU1NoYThoaFZuWDVVNEV4OGVyOENoU084QlZFd1kwJWFvcQ=='}]);
_stq.push([ 'clickTrackerInit', '126222267', '141' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script defer id="bilmur" data-customproperties="{&quot;enq_jquery&quot;:&quot;1&quot;,&quot;logged_in&quot;:&quot;0&quot;,&quot;wptheme&quot;:&quot;pub\/intergalactic-2&quot;,&quot;wptheme_is_block&quot;:&quot;0&quot;}" data-provider="wordpress.com" data-service="simple" data-site-tz="Etc/GMT-0"   src="/wp-content/js/bilmur-4.min.js?i=12&m=202511"></script><script>
( function() {
	function getMobileUserAgentInfo() {
		if ( typeof wpcom_mobile_user_agent_info === 'object' ) {
			wpcom_mobile_user_agent_info.init();
			var mobileStatsQueryString = '';

			if ( wpcom_mobile_user_agent_info.matchedPlatformName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
			}

			if ( wpcom_mobile_user_agent_info.matchedUserAgentName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
			}

			if ( wpcom_mobile_user_agent_info.isIPad() ) {
				mobileStatsQueryString += '&x_' + 'ipad_views' + '=' + 'views';
			}

			if ( mobileStatsQueryString != '' ) {
				new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
			}
		}
	}

	document.addEventListener( 'DOMContentLoaded', getMobileUserAgentInfo );
} )();
</script>
<script type='disabled' id='wp-enqueue-dynamic-script:wp-i18n:after:1'>
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>

<script>
(function() {
	'use strict';

	const fetches = {};
	const promises = {};
	const urls = {
		'wp-hooks': 'https://s0.wp.com/wp-content/plugins/gutenberg-core/v20.0.4/build/hooks/index.min.js?m=1741299224i&ver=84e753e2b66eb7028d38',
		'wp-i18n': 'https://s0.wp.com/wp-content/plugins/gutenberg-core/v20.0.4/build/i18n/index.min.js?m=1741299224i&ver=bd5a2533e717a1043151',
		'verbum': 'https://s2.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/moon/jetpack_vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.js?m=1739370055i&minify=false&ver=9d441fa76e2f0f23ffc9'
	};
	const loaders = {
		'verbum': () => {
			fetchExternalScript('wp-hooks');
			fetchExternalScript('wp-i18n');
			fetchExternalScript('verbum');
			promises['wp-hooks'] = promises['wp-hooks'] || loadWPScript('wp-hooks');
			promises['wp-i18n'] = promises['wp-i18n'] || promises['wp-hooks'].then( () => loadWPScript('wp-i18n') );
			promises['verbum'] = promises['verbum'] || promises['wp-i18n'].then( () => loadWPScript('verbum') );
			return promises['verbum'];
		},
		
	};
	const scriptExtras = {
		'wp-i18n': { translations: 0, before: 0, after: 1 },
		
	};

	window.WP_Enqueue_Dynamic_Script = {
		loadScript: (handle) => {
			if (!loaders[handle]) {
				console.error('WP_Enqueue_Dynamic_Script: unregistered script `' + handle + '`.');
			}
			return loaders[handle]();
		}
	};

	function fetchExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		fetches[handle] = fetches[handle] || fetch(urls[handle], { mode: 'no-cors' });
		return fetches[handle];
	}

	function runExtraScript(handle, type, index) {
		const id = 'wp-enqueue-dynamic-script:' + handle + ':' + type + ':' + (index + 1);
		const template = document.getElementById(id);
		if (!template) {
			return Promise.reject();
		}

		const script = document.createElement( 'script' );
		script.innerHTML = template.innerHTML;
		document.body.appendChild( script );
		return Promise.resolve();
	}

	function loadExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		return fetches[handle].then(() => {
			return new Promise((resolve, reject) => {
				const script = document.createElement('script');
				script.onload = () => resolve();
				script.onerror = (e) => reject(e);
				script.src = urls[handle];
				document.body.appendChild(script);
			});
		});
	}

	function loadExtra(handle, pos) {
		const count = (scriptExtras[handle] && scriptExtras[handle][pos]) || 0;
		let promise = Promise.resolve();

		for (let i = 0; i < count; i++) {
			promise = promise.then(() => runExtraScript(handle, pos, i));
		}

		return promise;
	}

	function loadWPScript(handle) {
		// Core loads scripts in this order. See: https://github.com/WordPress/WordPress/blob/a59eb9d39c4fcba834b70c9e8dfd64feeec10ba6/wp-includes/class-wp-scripts.php#L428.
		return loadExtra(handle, 'translations')
			.then(() => loadExtra(handle, 'before'))
			.then(() => loadExternalScript(handle))
			.then(() => loadExtra(handle, 'after'));
	}
} )();
</script>

</body>
</html>
