
<!DOCTYPE html>
<!--[if lt IE 7 ]><html lang="en-GB" class="no-js ie ie6 lte7 lte8 lte9"><![endif]-->
<!--[if IE 7 ]><html lang="en-GB" class="no-js ie ie7 lte7 lte8 lte9"><![endif]-->
<!--[if IE 8 ]><html lang="en-GB" class="no-js ie ie8 lte8 lte9"><![endif]-->
<!--[if IE 9 ]><html lang="en-GB" class="no-js ie ie9 lte9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en-GB" class="no-js"><!--<![endif]-->
	
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-67981177-1" type="e4ab2430e78c4f088213113f-text/javascript"></script>
		<script type="e4ab2430e78c4f088213113f-text/javascript">
	  		window.dataLayer = window.dataLayer || [];
	  		function gtag(){dataLayer.push(arguments);}
	  		gtag('js', new Date());

	  		gtag('config', 'UA-67981177-1');
		</script>
		<meta charset="utf-8">
	    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	    
	    <title>Investigating a Suspicious Service - MDSec</title>
	           
		<!-- iPhone Scaling 1:1 (RESPONSIVE) -->
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
			    	   		
		<!-- Favicons Start -->
		<link rel="apple-touch-icon" sizes="57x57" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-152x152.png">
		<link rel="apple-touch-icon" sizes="180x180" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-180x180.png">
		<link rel="icon" type="image/png" sizes="192x192" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/android-icon-192x192.png">
		<link rel="icon" type="image/png" sizes="32x32" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="96x96" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/favicon-96x96.png">
		<link rel="icon" type="image/png" sizes="16x16" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/favicon-16x16.png">
		<link rel="manifest" href="/manifest.json">
		<meta name="msapplication-TileColor" content="#ffffff">
		<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
		<meta name="theme-color" content="#ffffff">
		<!-- Favicons End -->   
	        
		<!-- Typekit Fonts -->
		<!--<link rel="stylesheet" href="https://use.typekit.net/jsa1tji.css">-->
		<link rel="stylesheet" href="https://use.typekit.net/icv6vdt.css">
	    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v26.1.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<link rel="canonical" href="https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/" />
	<meta property="og:locale" content="en_GB" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Investigating a Suspicious Service - MDSec" />
	<meta property="og:description" content="The Incident Response team at MDSec regularly gets queries from our customers, as well as our consultants about odd things that they’ve found, either during engagements, or on an ad-hoc..." />
	<meta property="og:url" content="https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/" />
	<meta property="og:site_name" content="MDSec" />
	<meta property="article:published_time" content="2021-07-14T07:59:23+00:00" />
	<meta property="og:image" content="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image.png" />
	<meta name="author" content="Admin" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@mdseclabs" />
	<meta name="twitter:site" content="@mdseclabs" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Admin" />
	<meta name="twitter:label2" content="Estimated reading time" />
	<meta name="twitter:data2" content="9 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/#article","isPartOf":{"@id":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/"},"author":{"name":"Admin","@id":"https://www.mdsec.co.uk/#/schema/person/17b494d22ae189270c1e0e41b25fcae3"},"headline":"Investigating a Suspicious Service","datePublished":"2021-07-14T07:59:23+00:00","mainEntityOfPage":{"@id":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/"},"wordCount":1066,"publisher":{"@id":"https://www.mdsec.co.uk/#organization"},"image":{"@id":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/#primaryimage"},"thumbnailUrl":"https://www.mdsec.co.uk/wp-content/uploads/2021/07/image.png","articleSection":["Response"],"inLanguage":"en-GB"},{"@type":"WebPage","@id":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/","url":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/","name":"Investigating a Suspicious Service - MDSec","isPartOf":{"@id":"https://www.mdsec.co.uk/#website"},"primaryImageOfPage":{"@id":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/#primaryimage"},"image":{"@id":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/#primaryimage"},"thumbnailUrl":"https://www.mdsec.co.uk/wp-content/uploads/2021/07/image.png","datePublished":"2021-07-14T07:59:23+00:00","breadcrumb":{"@id":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/#breadcrumb"},"inLanguage":"en-GB","potentialAction":[{"@type":"ReadAction","target":["https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/"]}]},{"@type":"ImageObject","inLanguage":"en-GB","@id":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/#primaryimage","url":"https://www.mdsec.co.uk/wp-content/uploads/2021/07/image.png","contentUrl":"https://www.mdsec.co.uk/wp-content/uploads/2021/07/image.png","width":764,"height":46},{"@type":"BreadcrumbList","@id":"https://www.mdsec.co.uk/2021/07/investigating-a-suspicious-service/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.mdsec.co.uk/"},{"@type":"ListItem","position":2,"name":"Investigating a Suspicious Service"}]},{"@type":"WebSite","@id":"https://www.mdsec.co.uk/#website","url":"https://www.mdsec.co.uk/","name":"MDSec","description":"Unrivalled Security Consulting &amp; Training","publisher":{"@id":"https://www.mdsec.co.uk/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.mdsec.co.uk/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-GB"},{"@type":"Organization","@id":"https://www.mdsec.co.uk/#organization","name":"MDSec","url":"https://www.mdsec.co.uk/","logo":{"@type":"ImageObject","inLanguage":"en-GB","@id":"https://www.mdsec.co.uk/#/schema/logo/image/","url":"https://www.mdsec.co.uk/wp-content/uploads/2020/08/MDSec-Logo-Blue.png","contentUrl":"https://www.mdsec.co.uk/wp-content/uploads/2020/08/MDSec-Logo-Blue.png","width":1500,"height":1000,"caption":"MDSec"},"image":{"@id":"https://www.mdsec.co.uk/#/schema/logo/image/"},"sameAs":["https://x.com/mdseclabs"]},{"@type":"Person","@id":"https://www.mdsec.co.uk/#/schema/person/17b494d22ae189270c1e0e41b25fcae3","name":"Admin","image":{"@type":"ImageObject","inLanguage":"en-GB","@id":"https://www.mdsec.co.uk/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/9cb7b62409a4b5ef00769dca4ba852fc49229c9729d600fc2637daf77068c31c?s=96&d=wp_user_avatar&r=g","contentUrl":"https://secure.gravatar.com/avatar/9cb7b62409a4b5ef00769dca4ba852fc49229c9729d600fc2637daf77068c31c?s=96&d=wp_user_avatar&r=g","caption":"Admin"},"sameAs":["https://x.com/mdseclabs"],"url":"https://www.mdsec.co.uk/author/dominic/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='stylesheet' id='wp-block-library-css' href='https://www.mdsec.co.uk/wp-includes/css/dist/block-library/style.min.css?ver=01a5439a30c9a5a5631fd5e6cfa37a2f' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='taxonomy-image-plugin-public-css' href='https://www.mdsec.co.uk/wp-content/plugins/taxonomy-images/css/style.css?ver=0.9.6' type='text/css' media='screen' />
<link rel='stylesheet' id='style-css' href='https://www.mdsec.co.uk/wp-content/themes/mdsec/css/style.css?ver=1.1.5' type='text/css' media='all' />
<link rel='stylesheet' id='prism-css-css' href='https://www.mdsec.co.uk/wp-content/themes/mdsec/css/solarized_dark.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='flickity-css-css' href='https://www.mdsec.co.uk/wp-content/themes/mdsec/css/flickity.min.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='hamburger-css-css' href='https://www.mdsec.co.uk/wp-content/themes/mdsec/css/hamburgers.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css' href='https://www.mdsec.co.uk/wp-content/themes/mdsec/css/font-awesome.min.css?ver=01a5439a30c9a5a5631fd5e6cfa37a2f' type='text/css' media='all' />
<!--[if lt IE 9]>
<script type="text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/html5shiv.js?ver=3.7.3" id="html5js-js"></script>
<![endif]-->
<!--[if lt IE 9]>
<script type="text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/respond.js?ver=1.3.1" id="respond-script-js"></script>
<![endif]-->
<!--[if lt IE 9]>
<script type="text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/selectivizr-min.js?ver=1.0.2" id="selectivizr-script-js"></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://www.mdsec.co.uk/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://www.mdsec.co.uk/wp-json/wp/v2/posts/2653" /><link rel='shortlink' href='https://www.mdsec.co.uk/?p=2653' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://www.mdsec.co.uk/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.mdsec.co.uk%2F2021%2F07%2Finvestigating-a-suspicious-service%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://www.mdsec.co.uk/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.mdsec.co.uk%2F2021%2F07%2Finvestigating-a-suspicious-service%2F&#038;format=xml" />
		<style type="text/css" id="wp-custom-css">
			.insights-content p
{
	font-family: titling-gothic-fb,sans-serif;
	color: #777a85;
}

.insights-content ul li
{
	font-family: titling-gothic-fb,sans-serif;
color: #777a85;
}


.insights-content h2
{
	font-family: fabrikat_mono_regular;
	font-weight: bold;
}

.insights-content figure
{
	justify-content: center;
}

.insights-content .wp-block-code code {
    max-width: 1000px;
    display: block;
    overflow-x: auto;
    color: #839496;
    margin: 0 auto;
    -webkit-text-size-adjust: none;
    font-size: 1.3rem;
    line-height: 20px;
		padding: 2px 0px;
}		</style>
					    
	</head>
	    
	<body class="wp-singular post-template-default single single-post postid-2653 single-format-standard wp-theme-mdsec">
    <!--[if lt IE 7]>
        <div class="browse-happy">
        	 <a href="https://www.mdsec.co.uk">
				<div id="logo">Logo</div>
			</a>
        	<p>You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        </div>    	
    <![endif]-->              
	
	<!-- Site Wrapper Start --> 
	<div class="site-wrapper">
		
	<!-- Header Start --> 
	<header class="clearfix">
		<div class="logo">
			<a href="https://www.mdsec.co.uk" title="MDSec">
				<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 188.3 50" style="enable-background:new 0 0 188.3 50;" xml:space="preserve">
				<g>
					<g>
						<path class="st0" d="M71.3,49.7V33.1l-7.7,16.5h-5.9l-7.5-16.5v16.5h-5.7V24.9h7.7l8.5,18.9l8.7-18.9H77v24.8H71.3z"/>
						<path class="st0" d="M95.8,49.7H80V24.9h15.6c5.7,0,9,1.6,10.6,4.4c1.2,1.8,1.6,4,1.6,7.6c0,3.9-0.4,6.1-1.5,8
							C104.7,47.9,101.4,49.7,95.8,49.7z M101.9,37c0-2.1-0.3-3.9-1-4.8c-1.1-1.7-2.9-2.5-6.2-2.5H86v15h8.6c3.4,0,5.3-0.8,6.4-2.4
							C101.7,41.3,101.9,39.3,101.9,37z"/>
						<path class="st0" d="M125.2,50c-8.7,0-13.1-2.8-13.4-7.9h2.8c0.2,3.7,4.1,5.4,10.6,5.4c6.9,0,9.3-1.8,9.3-4.5c0-2.9-2.1-4.1-9.9-5
							c-5.9-0.7-12.3-1.4-12.3-6.8c0-3.6,3.1-6.7,11.8-6.7c8.5,0,11.9,3.5,12.7,7.3h-2.9c-0.7-2.9-3.5-4.8-9.9-4.8
							c-6.3,0-8.9,1.7-8.9,4.1c0,3.4,4.9,3.9,10.1,4.4c7.5,0.8,12.1,2.1,12.1,7.2C137.3,47.2,133.8,50,125.2,50z"/>
						<path class="st0" d="M151.9,50c-7.3,0-11.6-2.8-11.6-9.2c0-5.8,4.3-8.9,11.5-8.9c8.1,0,11.7,4,11.4,10h-20.3c0.1,3.8,3.5,6,9.2,6
							c5.9,0,7.9-2.2,8.3-3.5h2.6C162.2,47.2,159.3,50,151.9,50z M151.7,34c-5.8,0-8.9,2.3-8.9,5.8h17.7C160.5,36.4,157.9,34,151.7,34z"
							/>
						<path class="st0" d="M185.7,38.5c-0.1-0.8-0.3-1.4-0.9-2c-1.2-1.4-3.7-2.4-7.4-2.4c-3.8,0-6.4,0.9-7.9,2.7c-0.9,1-1.2,2.4-1.2,4.2
							c0,1.9,0.4,3.3,1.3,4.3c1.4,1.7,4.1,2.5,7.9,2.5c3.7,0,5.9-0.7,7.2-1.9c0.6-0.6,1-1.5,1.1-2.2h2.6c-0.2,1.3-0.7,2.6-1.6,3.5
							C185,49,182,50,177.3,50c-4.8,0-8.1-1.1-9.9-3.3c-1.2-1.4-1.8-3.3-1.8-5.8c0-2.3,0.6-4.2,1.7-5.6c1.9-2.2,5.3-3.5,9.9-3.5
							c5.3,0,8.4,1.5,9.8,3.5c0.8,1,1,2.1,1.1,3.2H185.7z"/>
					</g>
					<path class="st0" d="M31,44.1H2c-1.1,0-2,0.9-2,2v3.5h32.9V46C32.9,45,32,44.1,31,44.1z"/>
					<path class="st0" d="M19.5,19.2l0.3,0c0.9-0.1,1.6-0.4,2.3-0.9l0,0l3,2.5c0.3,0.3,0.7,0.5,1.1,0.6c1.2,0.3,2.4-0.2,3-1.2l1.8-1.9
						c0.3-0.3,0.3-0.7,0.1-1l-5.4-7.5C25.2,9.3,25,8.6,24.8,8c-0.2-1.1-0.9-2-1.9-2.5l-3.7-1.9l2.5-2.5l0,0c0,0-0.1-0.1-0.1-0.1
						c-0.6-0.6-1.4-1-2.3-1c-0.6,0-1.1,0.1-1.6,0.4l0,0l-7.7,3.3l0,0c-4.7,2-8,6.7-8,12.1v2L5.9,14v2.7L2,20.5v2.7l3.8-3.8v2.7L2,25.9
						v2.7l3.8-3.8v2.7L2,31.4v1.7h3.9L2,37V42H31v-0.7c0-7.7-3.2-12.2-6.5-14.4c-2.4-1.6-8.1-3.3-8.1-8.4c0.8,0.5,1.8,0.8,2.8,0.8
						C19.3,19.2,19.4,19.2,19.5,19.2z"/>
				</g>
				</svg>
			</a>
		</div>
							
		<!-- Navigation Start -->   
		<nav role="navigation" class="main-navigation" id="main-navigation">        		
    		<ul id="menu-main-navigation" class="clearfix"><li id="menu-item-367" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-367"><a href="#">Our Services</a></li>
<li id="menu-item-368" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-368"><a href="#">Knowledge Centre</a></li>
<li id="menu-item-19" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-19"><a href="https://www.mdsec.co.uk/about/">About</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20"><a href="https://www.mdsec.co.uk/contact/">Contact</a></li>
</ul>		</nav>
		<!-- Navigation End--> 	
		
		<!-- Navigation Start -->   
		<nav role="navigation" class="mobile-navigation" id="mobile-navigation">        		
    		<ul id="menu-mobile-navigation" class="clearfix"><li id="menu-item-373" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-373"><a href="#">Our Services</a>
<ul class="sub-menu">
	<li id="menu-item-374" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-374"><a href="https://www.mdsec.co.uk/our-services/adversary-simulation/">Adversary Simulation</a></li>
	<li id="menu-item-375" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-375"><a href="https://www.mdsec.co.uk/our-services/application-security/">Application Security</a></li>
	<li id="menu-item-376" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-376"><a href="https://www.mdsec.co.uk/our-services/penetration-testing/">Penetration Testing</a></li>
	<li id="menu-item-377" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-377"><a href="https://www.mdsec.co.uk/our-services/response/">Response</a></li>
</ul>
</li>
<li id="menu-item-378" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-378"><a href="#">Knowledge Centre</a>
<ul class="sub-menu">
	<li id="menu-item-379" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-379"><a href="https://www.mdsec.co.uk/knowledge-centre/insights/">Insights</a></li>
	<li id="menu-item-380" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-380"><a href="https://www.mdsec.co.uk/knowledge-centre/research/">Research</a></li>
	<li id="menu-item-381" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-381"><a href="https://www.mdsec.co.uk/knowledge-centre/training/">Training</a></li>
</ul>
</li>
<li id="menu-item-371" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-371"><a href="https://www.mdsec.co.uk/about/">About</a></li>
<li id="menu-item-372" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-372"><a href="https://www.mdsec.co.uk/contact/">Contact</a></li>
</ul>		</nav>
		<!-- Navigation End--> 		
		
		
		<div class="menu-toggle">
			<button class="hamburger hamburger--slider" type="button">
				<span class="hamburger-box">
					<span class="hamburger-inner"></span>
				</span>
			</button>		
		</div>		   	       		
	</header>
    <!-- Header End --> 
		
		
	<div class="subnav">
		<section class="content-wrapper">
			<ul class="service-list clearfix">
				<li class="item">
					<a href="https://www.mdsec.co.uk/our-services/adversary-simulation/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-adversary.svg" alt="Adversary">
						</div>
						<hgroup>
							<h2>
								Adversary Simulation
							</h2>
						</hgroup>
						<p>Our best in class red team can deliver a holistic cyber attack simulation to provide a true evaluation of your organisation&#8217;s cyber resilience.</p>
						
					</a>
				</li>
				<li class="item">
					<a href="https://www.mdsec.co.uk/our-services/applicaton-security/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-application-security.svg" alt="Application Security">
						</div>
						<hgroup>
							<h2>
								Application <br>Security
							</h2>
						</hgroup>
						<p>Leverage the team behind the industry-leading Web Application and Mobile Hacker’s Handbook series.</p>
					</a>
				</li>
				<li class="item">
					<a href="https://www.mdsec.co.uk/our-services/penetration-testing/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-penetration-testing.svg" alt="Penetration Testing">
						</div>
						<hgroup>
							<h2>
								Penetration <br>Testing
							</h2>
						</hgroup>
						<p>MDSec’s penetration testing team is trusted by companies from the world’s leading technology firms to global financial institutions.</p>
					</a>
				</li>
				<li class="item">
					<a href="https://www.mdsec.co.uk/our-services/response/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-response.svg" alt="Response">
						</div>
						<hgroup>
							<h2>
								Response
							</h2>
						</hgroup>
						<p>Our certified team work with customers at all stages of the Incident Response lifecycle through our range of proactive and reactive services.</p>
					</a>
				</li>
			</ul>
		</section>		
	</div>
	<div class="subnav-kc">
		<section class="content-wrapper">
			<ul class="service-list clearfix">
				<li>
					<a href="https://www.mdsec.co.uk/knowledge-centre/research/">
						<hgroup>
							<h2>
								Research
							</h2>
						</hgroup>
						<p>MDSec&#8217;s dedicated research team periodically releases white papers, blog posts, and tooling.</p>
					</a>
				</li>
				<li>
					<a href="https://www.mdsec.co.uk/knowledge-centre/training/">
						<hgroup>
							<h2>
								Training
							</h2>
						</hgroup>
						<p>MDSec&#8217;s training courses are informed by our security consultancy and research functions, ensuring you benefit from the latest and most applicable trends in the field.</p>
					</a>
				</li>
				<li>
					<a href="https://www.mdsec.co.uk/knowledge-centre/insights/">
						<hgroup>
							<h2>
								Insights
							</h2>
						</hgroup>
						<p>View insights from MDSec&#8217;s consultancy and research teams.</p>
					</a>
				</li>
			</ul>
		</section>		
	</div>		

	
	<section class="insights-single-header">
		<div class="content-wrapper">
			<div class="the-category">
			<span class="category">Response</span>			</div>
			<h1>Investigating a Suspicious Service</h1>
		</div>
	</section>

	<section class="full-width-wrapper white pad20-120">
		<div class="content-wrapper">
			<div class="breadcrumb-wrapper">
				<div id="breadcrumbs">
					<span>
						<span><a href="https://www.mdsec.co.uk/" >Home</a> &gt; 
							<span>
							<a href="https://www.mdsec.co.uk/knowledge-centre/" >Knowledge Centre</a> &gt; 
							<a href="https://www.mdsec.co.uk/knowledge-centre/insights" >Insights</a> &gt;
								<span class="breadcrumb_last" aria-current="page">Investigating a Suspicious Service</span>
							</span>
						</span>
					</span>
				</div>
			</div>	

		</div>
		
		<div class="insights-content">
		
<p>The Incident Response team at MDSec regularly gets queries from our customers, as well as our consultants about odd things that they’ve found, either during engagements, or on an ad-hoc basis.</p>



<p>Recently, during one of our Purple Team exercises, one of our consultants drew our attention to a large number of services that had been deployed across the customer network, that were; quite rightly causing a bit of concern.</p>



<div class="wp-block-image"><figure class="aligncenter size-full is-resized"><img decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image.png" alt="" class="wp-image-2656" width="573" height="35" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image.png 764w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-375x23.png 375w" sizes="(max-width: 573px) 100vw, 573px" /></figure></div>



<p>These services had all the hallmarks of “probably bad, at least very weird”: seemingly randomly named, with some lumps of PowerShell for good measure.</p>



<p>&nbsp;The customer, and our consultant had a couple of questions about these services:</p>



<ol class="wp-block-list" type="1"><li>How do we work out when these were created?</li><li>What is it/how much do we need to care?</li></ol>



<h3 class="wp-block-heading"><strong>1: How do we work out when these were created?</strong></h3>



<p>There are a couple of simple ways to query information about a service, we prefer using <code>sc qc &lt;service name></code>. Which displays information about the type of service, the display name, the path name etc.</p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img fetchpriority="high" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-1-960x239.png" alt="" class="wp-image-2657" width="720" height="179" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-1-960x239.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-1-768x191.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-1-375x93.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-1.png 964w" sizes="(max-width: 720px) 100vw, 720px" /></figure></div>



<p>Unfortunately, this doesn’t display information about when a service was created. There are a number of different ways to obtain this information, some more reliable than others.</p>



<p><strong>Windows Event Logs</strong></p>



<p>System Log, EventID: 7045</p>



<figure class="wp-block-image size-large"><img decoding="async" width="960" height="199" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-2-960x199.png" alt="" class="wp-image-2658" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-2-960x199.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-2-768x159.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-2-375x78.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-2.png 964w" sizes="(max-width: 960px) 100vw, 960px" /></figure>



<p>You can also query using PowerShell:</p>



<pre class="wp-block-code"><code>Get-EventLog -LogName System | Where-Object {$_.EventID -eq 7045 | Select-Object -Property TimeGenerated, Message | Format-List</code></pre>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="928" height="346" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-3.png" alt="" class="wp-image-2659" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-3.png 928w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-3-768x286.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-3-375x140.png 375w" sizes="auto, (max-width: 928px) 100vw, 928px" /></figure>



<p>Or, if you’re using <a href="https://github.com/cbasnett/Log-Extractor" target="_blank" rel="noreferrer noopener">Log-Extractor</a>:</p>



<pre class="wp-block-code"><code>zgrep '"EventID":{"Qualifiers":"7045"}' *| cut -d ':' -f2- | jq .</code></pre>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="546" height="432" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-4.png" alt="" class="wp-image-2660" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-4.png 546w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-4-375x297.png 375w" sizes="auto, (max-width: 546px) 100vw, 546px" /></figure>



<p>*Note that the time shown in the Log-Extractor log is UTC whereas the other two are quoted in local time (because Windows hates analysts).</p>



<p>The trouble with using Windows Event Logs for this sort of thing is that if not centralised (as with this customer) these logs typically have a fairly short lifespan resulting in data being missing or inconclusive.</p>



<p><strong>Registry</strong></p>



<p>Services are stored within the Windows Registry, which contains written dates for specific keys. Unfortunately, there’s no super simple way of programatically getting this data, and in the backward way of Windows the simplest way is the following:</p>



<ul class="wp-block-list"><li>Open Registry Editor</li><li>Navigate to appropriate key (<code>HKLM\System\CurrentControlSet\Services\&lt;Service Name&gt;</code>)</li><li>Right Click, Export as text (not .reg)</li></ul>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="572" height="106" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-5.png" alt="" class="wp-image-2661" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-5.png 572w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-5-375x69.png 375w" sizes="auto, (max-width: 572px) 100vw, 572px" /></figure>



<h3 class="wp-block-heading"><strong>2: What is it/how much do we need to care?</strong></h3>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-6.png" alt="" class="wp-image-2662" width="719" height="99" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-6.png 958w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-6-768x106.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-6-375x52.png 375w" sizes="auto, (max-width: 719px) 100vw, 719px" /></figure>



<p>Looking at the code, we can see that there are two separate commands being run, the first of which is just command prompt being used to start a process:</p>



<pre class="wp-block-code"><code>cmd.exe /b /c start /b /min &lt;command&gt;</code></pre>



<p>What this is effectively doing is running the command minimised to a user. Largely unnecessary when running as a service but there we are! Interestingly from a detection standpoint this would generate two <code>cmd.exe</code> processes with parent child relationships, and then finally a PowerShell process which would be trivial to signature and unlikely to be associated with legitimate activity.</p>



<p>The much more interesting command being ran is that of the PowerShell script. Immediately we can observe a couple of things:</p>



<pre class="wp-block-code"><code>powershell.exe -nop -w hidden -noni -c</code></pre>



<p>This basically runs the command with no profile (-nop) in a hidden window, in non-interactive (-noni) mode. But we don’t really care about this beyond the fact that it exists.</p>



<p>With a bit of tidying up (and switching to a decent environment), we’re left with some more cohesive PowerShell:</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="960" height="339" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-7-960x339.png" alt="" class="wp-image-2663" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-7-960x339.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-7-768x271.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-7-375x132.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-7.png 964w" sizes="auto, (max-width: 960px) 100vw, 960px" /></figure>



<p>We can see here, quite simply the script is looking to see if we’re running a 32 bit of 64 bit system, then launching a PowerShell process in the background with a number of arguments (in this case the bit we care about). Let’s get rid of all the fluff and focus on the bits we care about:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="960" height="108" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-8-960x108.png" alt="" class="wp-image-2664" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-8-960x108.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-8-768x86.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-8-375x42.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-8.png 964w" sizes="auto, (max-width: 960px) 100vw, 960px" /></figure></div>



<p>Effectively what this code is doing is Gzip Decompressing some base64 encoded data. We can work with that! A couple of lines of Python is all that’s needed to convert this into something sensible:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="624" height="188" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-9.png" alt="" class="wp-image-2665" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-9.png 624w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-9-375x113.png 375w" sizes="auto, (max-width: 624px) 100vw, 624px" /></figure></div>



<p>This code should be fairly self explanatory, but in case it’s not. We can use the python base64 library to decode the data, then the gzip library to decompress. You could achieve something very similar using <a href="https://gchq.github.io/CyberChef/" target="_blank" rel="noreferrer noopener">CyberChef</a>:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="804" height="492" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-10.png" alt="" class="wp-image-2666" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-10.png 804w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-10-768x470.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-10-375x229.png 375w" sizes="auto, (max-width: 804px) 100vw, 804px" /></figure></div>



<p>The result of which gives us something like:</p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-11-960x329.png" alt="" class="wp-image-2667" width="720" height="247" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-11-960x329.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-11-768x263.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-11-375x128.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-11.png 964w" sizes="auto, (max-width: 720px) 100vw, 720px" /></figure></div>



<p>Oh, this looks a bit more complex. This is the point where experience and time optimisation come in. We can see that “$c3F” contains some more base64, we can see that this is effectively being copied into “$gB” which is then invoked in a “<code>CreateThread</code>” function ultimately meaning that the base64 content is executed. Beyond this, we don’t really care at this stage. I’m far more interested in what is under the base64.</p>



<p>With some minor adjustments to our python, we get some gunk out of the Base64, gunk being the technical word for “file doesn’t know what this is”.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="332" height="40" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-12.png" alt="" class="wp-image-2668"/></figure></div>



<p>Ok, well if only it was easy. Let’s have a look at the hex, and from the age-old cyber security textbook let’s get some Google going:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="534" height="340" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-13.png" alt="" class="wp-image-2669" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-13.png 534w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-13-375x239.png 375w" sizes="auto, (max-width: 534px) 100vw, 534px" /></figure></div>



<p><code>FC E8</code> rang a bell for me before we Googled it, but the search results confirm my suspicions.</p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-14.png" alt="" class="wp-image-2670" width="480" height="344" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-14.png 640w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-14-375x268.png 375w" sizes="auto, (max-width: 480px) 100vw, 480px" /></figure></div>



<p>We always say to analysts, Google everything, sometimes it can save a LOT of time. A long time ago we confirmed that some samples were linked to a known APT group by Googling some strings in a sample we identified. We could have spent significant time and effort reverse engineering the binary, but why bother when someone has already done that work and published it, we save the customer time and money by working efficiently.</p>



<p>Enter <a href="http://sandsprite.com/blogs/index.php?uid=7&amp;pid=152" target="_blank" rel="noreferrer noopener">SCDBG</a>, this awesome tool emulates shellcode and displays what functions are being called. There’s even a pretty GUI to make it utterly fool proof:</p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-15.png" alt="" class="wp-image-2671" width="339" height="177" srcset="https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-15.png 452w, https://www.mdsec.co.uk/wp-content/uploads/2021/07/image-15-375x196.png 375w" sizes="auto, (max-width: 339px) 100vw, 339px" /></figure></div>



<p>So, what we have here is most likely a Metasploit stager which is attempting to connect to 10.x.x.x address on port 4444. Given its an internal RFC1918 IP address and a default port number, it seems like the most likely explanation is that a security assessment or internal test had occurred and been poorly cleaned up in the past. At this point any further analysis with the data in our possession was unlikely to yield any further results so we reported our findings to the customer who were able to confirm our theory.</p>



<p>This is just one of many possible ways of performing analysis of an unknown, the key takeaways are to focus on the key items rather than getting hung up in the details.</p>



<p>MDSec provides a range of proactive and reactive response services, as well as 24/7/365 retained Emergency Response services. To find out more about how we can help your organisation, please get in touch: <a href="mailto:response@mdsec.co.uk">response@mdsec.co.uk</a>.</p>



<h3 class="wp-block-heading"><strong>Yara Rule to detect Metasploit and Cobalt Strike Shellcode</strong></h3>



<pre class="wp-block-code"><code>{    
    meta:
        description = "Detects MSF Shellcode"
        author = "MDSec"
        reference = "https://www.mdsec.co.uk"
        date = "2021-05-04"
    strings:
        $initial = {fc e8 ?? 00 00 00 00}

    condition:
        $initial at 0
}</code></pre>



<p>This blog post was written by <a href="https://twitter.com/chrisbasnett7" target="_blank" rel="noreferrer noopener">Chris Basnett</a>.</p>
		</div>
		
		<div class="author">
			<div class="content-wrapper clearfix">
				<div class="author-avatar">
					<img alt='' src='https://secure.gravatar.com/avatar/9cb7b62409a4b5ef00769dca4ba852fc49229c9729d600fc2637daf77068c31c?s=96&#038;d=wp_user_avatar&#038;r=g' srcset='https://secure.gravatar.com/avatar/9cb7b62409a4b5ef00769dca4ba852fc49229c9729d600fc2637daf77068c31c?s=192&#038;d=wp_user_avatar&#038;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' loading='lazy' decoding='async'/>				</div>
				<div class="author-meta">
					<div class="author-meta__content">
						<span>written by</span>
						<h4>MDSec Research</h4>
					</div>
				</div>
			</div>
		</div>
		<section class="testing">
	<div class="content-wrapper">
		<h2>Ready to engage<br>with MDSec?</h2>
		<div class="button">
			<a href="https://www.mdsec.co.uk/contact">
				Get in touch
			</a>
		</div>
	</div>
</section>		
	</section>




	<section class="newsletter">
	<div class="content-wrapper clearfix">
		<div class="newsletter-left">
			<p>
				Stay updated with the latest <br>news from MDSec.
			</p>
		</div>
		<div class="newsletter-right">
			<div class="frm_forms  with_frm_style frm_style_formidable-style" id="frm_form_2_container" >
<form enctype="multipart/form-data" method="post" class="frm-show-form  frm_js_validate " id="form_newslettersignupform" >
<div class="frm_form_fields ">
<fieldset>
<legend class="frm_screen_reader">Newsletter Signup Form</legend>

<div class="frm_fields_container">
<input type="hidden" name="frm_action" value="create" />
<input type="hidden" name="form_id" value="2" />
<input type="hidden" name="frm_hide_fields_2" id="frm_hide_fields_2" value="" />
<input type="hidden" name="form_key" value="newslettersignupform" />
<input type="hidden" name="item_meta[0]" value="" />
<input type="hidden" id="frm_submit_entry_2" name="frm_submit_entry_2" value="d39fc79401" /><input type="hidden" name="_wp_http_referer" value="/2021/07/investigating-a-suspicious-service/" /><div id="frm_field_10_container" class="frm_form_field form-field  frm_none_container frm_full">
    <label for="field_nkjbj" id="field_nkjbj_label" class="frm_primary_label">Email
        <span class="frm_required"></span>
    </label>
    <input type="email" id="field_nkjbj" name="item_meta[10]" value=""  placeholder="Enter your email for updates" data-invmsg="Email is invalid" aria-invalid="false"  />
    
    
</div>
<div id="frm_field_11_container" class="frm_form_field form-field  frm_none_container frm_first frm_full">
    <label for="g-recaptcha-response" id="field_ah4d8_label" class="frm_primary_label">
        <span class="frm_required"></span>
    </label>
    <div  id="field_ah4d8" class="frm-g-recaptcha" data-sitekey="6Lc27L0ZAAAAAMV4QCtKwWRbT-Hm1FnY6IKqcSxw" data-size="invisible" data-theme="light"></div>
    
    
</div>
	<input type="hidden" name="item_key" value="" />
			<div id="frm_field_29_container">
			<label for="field_o79t3"  style="display:none;">
				If you are human, leave this field blank.			</label>
			<input  id="field_o79t3" type="text" class="frm_form_field form-field frm_verify" name="item_meta[29]" value=""  style="display:none;" />
		</div>
		<input name="frm_state" type="hidden" value="sLl+is0DzTJ53hwWmIZHJ93AFeMhYrOB8yG9US4sGwU=" /><div class="frm_submit">

<button class="frm_button_submit" type="submit"  >Submit</button>

</div></div>
</fieldset>
</div>

</form>
</div>
			
		</div>
	</div>
</section>

		</div>
	<!-- Site Wrapper End -->
	
	<!-- Footer Start -->	
	<footer>
		<div class="content-wrapper clearfix">
			<div class="footer-col">
				<div class="footer-logo">
					<a href="https://www.mdsec.co.uk" title="MDSec">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/mdsec-logo.svg" alt="MDsec">
					</a>
				</div>
			</div>
			<div class="footer-col">
				<h3>Services</h3>
				<nav class="footer-nav">
					<ul>
						<li><a href="https://www.mdsec.co.uk/our-services/adversary-simulation/">Adversary Simulation</a></li>
						<li><a href="https://www.mdsec.co.uk/our-services/applicaton-security/">Application Security</a></li>
						<li><a href="https://www.mdsec.co.uk/our-services/penetration-testing/">Penetration Testing</a></li>
						<li><a href="https://www.mdsec.co.uk/our-services/response/">Response</a></li>
					</ul>
				</nav>
				<h3>Resource Centre</h3>
				<nav class="footer-nav">
					<ul>
						<li><a href="https://www.mdsec.co.uk/knowledge-centre/research/">Research</a></li>
						<li><a href="https://www.mdsec.co.uk/knowledge-centre/training/">Training</a></li>
						<li><a href="https://www.mdsec.co.uk/knowledge-centre/insights/">Insights</a></li>
					</ul>
				</nav>				
			</div>
			<div class="footer-col">
				<h3>Company</h3>
				<nav class="footer-nav">
					<ul>
						<li><a href="https://www.mdsec.co.uk/about/">About</a></li>
						<li><a href="https://www.mdsec.co.uk/contact/">Contact</a></li>
						<li><a href="https://www.mdsec.co.uk/careers/">Careers</a></li>
						<li><a href="https://www.mdsec.co.uk/privacy-policy/">Privacy</a></li>
					</ul>
				</nav>
				<p>
					t: +44 (0) 1625 263 503<br>
					e: <a href="mailto:contact@mdsec.co.uk">contact@mdsec.co.uk</a>
				</p>
				<p>
					32A Park Green<br>
					Macclesfield<br>
					Cheshire<br>
					SK11 7NA
				</p>
			</div>
			<div class="footer-col">
				<h3>Accreditations</h3>
				<div class="logo-list clearfix">
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/logos/best.png" alt="Best">
					</div>
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/uploads/2019/11/check-whitetrans.png" alt="IT Health Check Service">
					</div>
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/logos/crest-star.png" alt="Crest Star">
					</div>
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/logos/crest.png" alt="Crest">
					</div>
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/logos/cyber-essentials.png" alt="Cyber Essentials">
					</div>
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/logos/british-assessment-bureau.png" alt="British Assessment Bureau">
					</div>
				</div>
			</div>
		</div>
	</footer>

	<div class="end clearfix">
		<div class="end__left">
			Copyright 2025 MDSec
		</div>
		<div class="end__right">
			<!--<a href="#">Privacy Policy</a>-->
		</div>
	</div>
	<!-- Footer End -->
	
    <script type="e4ab2430e78c4f088213113f-text/javascript">
				( function() {
					const style = document.createElement( 'style' );
					style.appendChild( document.createTextNode( '#frm_field_29_container {visibility:hidden;overflow:hidden;width:0;height:0;position:absolute;}' ) );
					document.head.appendChild( style );
					document.currentScript?.remove();
				} )();
			</script><script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/mdsec\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="e4ab2430e78c4f088213113f-text/javascript" src="https://www.mdsec.co.uk/wp-includes/js/jquery/jquery.js?ver=1.11.0" id="jquery-js"></script>
<script type="e4ab2430e78c4f088213113f-text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/main.js?ver=1" id="main-js"></script>
<script type="e4ab2430e78c4f088213113f-text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/highlight.min.js?ver=1" id="prism-js-js"></script>
<script type="e4ab2430e78c4f088213113f-text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/isotope.pkgd.min.js?ver=1" id="isotope-js-js"></script>
<script type="e4ab2430e78c4f088213113f-text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/jquery.matchHeight.js?ver=1.0.0" id="matchheight-js-js"></script>
<script type="e4ab2430e78c4f088213113f-text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/modernizr.js?ver=2.8.3" id="modernizr-script-js"></script>
<script type="e4ab2430e78c4f088213113f-text/javascript" id="formidable-js-extra">
/* <![CDATA[ */
var frm_js = {"ajax_url":"https:\/\/www.mdsec.co.uk\/wp-admin\/admin-ajax.php","images_url":"https:\/\/www.mdsec.co.uk\/wp-content\/plugins\/formidable\/images","loading":"Loading\u2026","remove":"Remove","offset":"4","nonce":"609bbda4b5","id":"ID","no_results":"No results match","file_spam":"That file looks like Spam.","calc_error":"There is an error in the calculation in the field with key","empty_fields":"Please complete the preceding required fields before uploading a file.","focus_first_error":"1","include_alert_role":"1","include_resend_email":""};
/* ]]> */
</script>
<script type="e4ab2430e78c4f088213113f-text/javascript" src="https://www.mdsec.co.uk/wp-content/plugins/formidable/js/frm.min.js?ver=6.25" id="formidable-js"></script>
<script type="e4ab2430e78c4f088213113f-text/javascript" defer="defer" async="async" src="https://www.google.com/recaptcha/api.js?onload=frmRecaptcha&amp;render=explicit&amp;ver=3" id="captcha-api-js"></script>

	<script type="e4ab2430e78c4f088213113f-text/javascript">
		
		$grid = jQuery('.grid').isotope({
			itemSelector: '.grid-item',
			percentPosition: true,
			masonry: {
			columnWidth: '.grid-sizer',
			gutter: '.gutter-sizer',
			}
		});

		jQuery('.filter-group').on( 'click', 'li', function() {
			var filterValue = jQuery(this).attr('data-filter');
			var filterName = jQuery(this).attr('data-name');
			$grid.isotope({ filter: filterValue });
			var elems = $grid.isotope('getFilteredItemElements');
			jQuery(".sort-group-item").removeClass('active');

		});	

	</script>
	<script type="e4ab2430e78c4f088213113f-text/javascript" src='/wp-content/themes/mdsec/jquery.marquee.min.js'></script>		
	<script type="e4ab2430e78c4f088213113f-text/javascript">
	jQuery(window).load(function() {
		jQuery('.message').marquee({
			//speed in milliseconds of the marquee
			duration: 12000,
			//gap in pixels between the tickers
			gap: 0,
			//time in milliseconds before the marquee will start animating
			delayBeforeStart: 500,
			//'left' or 'right'
			direction: 'left',
			//true or false - should the marquee be duplicated to show an effect of continues flow
			duplicated: true,
			pauseOnHover: true,
			startVisible: true
		});
		
		jQuery('.message-item').css('opacity', '1');
	});
	</script>
	<script type="e4ab2430e78c4f088213113f-text/javascript">hljs.initHighlightingOnLoad();</script>



    	    			
<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="e4ab2430e78c4f088213113f-|49" defer></script></body>
<!-- Body End -->

</html>
