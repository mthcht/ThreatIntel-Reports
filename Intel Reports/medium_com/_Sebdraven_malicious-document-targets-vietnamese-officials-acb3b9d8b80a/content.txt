<!doctype html><html lang="en"><head><title data-rh="true">Malicious document targets Vietnamese officials | by Sebdraven | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2018-08-13T10:13:32.764Z"/><meta data-rh="true" name="title" content="Malicious document targets Vietnamese officials | by Sebdraven | Medium"/><meta data-rh="true" property="og:title" content="Malicious document targets Vietnamese officials"/><meta data-rh="true" property="al:android:url" content="medium://p/acb3b9d8b80a"/><meta data-rh="true" property="al:ios:url" content="medium://p/acb3b9d8b80a"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="After our investigation of APT SideWinder, we’ve done a yara rule for hunting RTF document exploiting the CVE-2017–11882. We found a document written in Vietnamese dealing with a summary about…"/><meta data-rh="true" property="og:description" content="After our investigation of APT SideWinder, we’ve done a yara rule for hunting RTF document exploiting the CVE-2017–11882."/><meta data-rh="true" property="og:url" content="https://sebdraven.medium.com/malicious-document-targets-vietnamese-officials-acb3b9d8b80a"/><meta data-rh="true" property="al:web:url" content="https://sebdraven.medium.com/malicious-document-targets-vietnamese-officials-acb3b9d8b80a"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*UjwuTDu6t3I4qJHq"/><meta data-rh="true" property="article:author" content="https://sebdraven.medium.com"/><meta data-rh="true" name="author" content="Sebdraven"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Malicious document targets Vietnamese officials"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/acb3b9d8b80a"/><meta data-rh="true" property="twitter:description" content="After our investigation of APT SideWinder, we’ve done a yara rule for hunting RTF document exploiting the CVE-2017–11882."/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*UjwuTDu6t3I4qJHq"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@Sebdraven"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="9 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://sebdraven.medium.com"/><link data-rh="true" rel="canonical" href="https://sebdraven.medium.com/malicious-document-targets-vietnamese-officials-acb3b9d8b80a"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/acb3b9d8b80a"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fda:true\u002Fresize:fit:1200\u002F0*UjwuTDu6t3I4qJHq"],"url":"https:\u002F\u002Fsebdraven.medium.com\u002Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a","dateCreated":"2018-07-31T17:03:36.464Z","datePublished":"2018-07-31T17:03:36.464Z","dateModified":"2018-08-13T10:13:32.764Z","headline":"Malicious document targets Vietnamese officials - Sebdraven - Medium","name":"Malicious document targets Vietnamese officials - Sebdraven - Medium","description":"After our investigation of APT SideWinder, we’ve done a yara rule for hunting RTF document exploiting the CVE-2017–11882. We found a document written in Vietnamese dealing with a summary about…","identifier":"acb3b9d8b80a","author":{"@type":"Person","name":"Sebdraven","url":"https:\u002F\u002Fsebdraven.medium.com"},"creator":["Sebdraven"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fsebdraven.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fsebdraven.medium.com\u002Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a"}</script><style type="text/css" data-fela-rehydration="612" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="612" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{gap:16px}.ag{color:inherit}.ah{fill:inherit}.ai{font-size:inherit}.aj{border:inherit}.ak{font-family:inherit}.al{letter-spacing:inherit}.am{font-weight:inherit}.an{padding:0}.ao{margin:0}.ap{cursor:pointer}.aq:disabled{cursor:not-allowed}.ar:disabled{color:#6B6B6B}.as:disabled{fill:#6B6B6B}.av{width:auto}.aw path{fill:#242424}.ax{height:25px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{width:0}.cc{border-right:none}.cd{transition:width 300ms}.ce{flex:0 0 auto}.cf{padding:24px 0}.cg{flex-direction:column}.ch{gap:8px}.ci{transform:translateX(-240px)}.cj{transition:transform 300ms}.ck{position:fixed}.cl{text-align:left}.cm{color:#6B6B6B}.cp{padding:8px 24px}.cq{margin-left:16px}.cr{overflow:hidden}.cs{max-height:20px}.ct{text-overflow:ellipsis}.cu{display:-webkit-box}.cv{-webkit-line-clamp:1}.cw{-webkit-box-orient:vertical}.cx{word-break:break-all}.cz{list-style:none}.da{flex-shrink:0}.db{margin-left:8px}.dc{stroke:#242424}.dd{stroke-width:1.5}.de{stroke-linecap:round}.df{stroke-linejoin:round}.dg{padding:12px 24px 12px 64px}.dh{height:40px}.di{border-bottom:1px solid #E5E5E5}.dj{margin:8px 24px}.dk{width:24px}.dl{width:calc(100% - 240px)}.dm{flex:1 1 auto}.dn{justify-content:center}.dt{max-width:680px}.du{min-width:0}.dv{animation:k1 1.2s ease-in-out infinite}.dw{height:100vh}.dx{margin-bottom:16px}.dy{margin-top:48px}.dz{align-items:flex-start}.ea{justify-content:space-between}.eb{margin-bottom:24px}.eh{width:80%}.ei{background-color:#F2F2F2}.ep{height:44px}.eq{width:44px}.er{margin:auto 0}.es{margin-bottom:4px}.et{height:16px}.eu{width:120px}.ev{width:80px}.fb{margin-bottom:8px}.fc{width:96%}.fd{width:98%}.fe{width:81%}.ff{font-size:13px}.fg{height:100%}.fy{color:#FFFFFF}.fz{fill:#FFFFFF}.ga{background:#1A8917}.gb{border-color:#1A8917}.gf:disabled{cursor:inherit !important}.gg:disabled{opacity:0.3}.gh:disabled:hover{background:#1A8917}.gi:disabled:hover{border-color:#1A8917}.gj{border-radius:99em}.gk{border-width:1px}.gl{border-style:solid}.gm{box-sizing:border-box}.gn{text-decoration:none}.go{text-align:center}.gr{margin-right:32px}.gs{position:relative}.gt{fill:#6B6B6B}.gv{background:transparent}.gw svg{margin-left:4px}.gx svg{fill:#6B6B6B}.gz{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.ha{position:absolute}.hh{margin:0 24px}.hl{background:rgba(255, 255, 255, 1)}.hm{border:1px solid #F2F2F2}.hn{box-shadow:0 1px 4px #F2F2F2}.ho{max-height:100vh}.hp{overflow-y:auto}.hq{left:0}.hr{top:calc(100vh + 100px)}.hs{bottom:calc(100vh + 100px)}.ht{width:10px}.hu{pointer-events:none}.hv{word-break:break-word}.hw{word-wrap:break-word}.hx:after{display:block}.hy:after{content:""}.hz:after{clear:both}.ia{line-height:1.23}.ib{letter-spacing:0}.ic{font-style:normal}.id{font-weight:700}.ji{align-items:baseline}.jj{width:48px}.jk{height:48px}.jl{border:2px solid rgba(255, 255, 255, 1)}.jm{z-index:0}.jn{box-shadow:none}.jo{border:1px solid rgba(0, 0, 0, 0.05)}.jp{margin-bottom:2px}.jq{flex-wrap:nowrap}.jr{font-size:16px}.js{line-height:24px}.ju{margin:0 8px}.jv{display:inline}.jw{text-decoration:underline}.jz{flex-wrap:wrap}.ka{padding-left:8px}.kb{padding-right:8px}.lc> *{flex-shrink:0}.ld{overflow-x:scroll}.le::-webkit-scrollbar{display:none}.lf{scrollbar-width:none}.lg{-ms-overflow-style:none}.lh{width:74px}.li{flex-direction:row}.lj{z-index:2}.lk{margin-right:4px}.ln{-webkit-user-select:none}.lo{border:0}.lp{fill:rgba(117, 117, 117, 1)}.ls{outline:0}.lt{user-select:none}.lu> svg{pointer-events:none}.md{cursor:progress}.me{margin-left:4px}.mf{margin-top:0px}.mg{opacity:1}.mh{padding:4px 0}.mk{width:16px}.mm{display:inline-flex}.ms{max-width:100%}.mt{padding:8px 2px}.mu svg{color:#6B6B6B}.nl{line-height:1.58}.nm{letter-spacing:-0.004em}.nn{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.oi{margin-bottom:-0.46em}.oj{margin-left:auto}.ok{margin-right:auto}.ol{max-width:1600px}.or{clear:both}.ot{cursor:zoom-in}.ou{z-index:auto}.ow{height:auto}.ox{margin-top:10px}.oy{max-width:728px}.pb{line-height:1.12}.pc{letter-spacing:-0.022em}.pd{font-weight:600}.py{margin-bottom:-0.28em}.qe{max-width:1273px}.qf{list-style-type:decimal}.qg{margin-left:30px}.qh{padding-left:0px}.qn{max-width:900px}.qo{max-width:774px}.qp{max-width:720px}.qq{max-width:723px}.qr{max-width:791px}.qs{max-width:227px}.qt{max-width:883px}.qu{max-width:814px}.qv{max-width:776px}.qw{max-width:466px}.qx{max-width:260px}.qy{max-width:1178px}.qz{max-width:1139px}.ra{max-width:858px}.rb{max-width:1332px}.rc{max-width:1298px}.rd{max-width:1289px}.re{max-width:568px}.rf{max-width:1180px}.rg{max-width:763px}.rh{max-width:803px}.ri{max-width:893px}.rj{max-width:589px}.rk{max-width:527px}.rl{max-width:705px}.rm{max-width:745px}.rn{max-width:753px}.ro{max-width:410px}.rp{list-style-type:disc}.rq{max-width:1329px}.rr{max-width:792px}.rs{max-width:773px}.rt{max-width:424px}.ru{max-width:166px}.rv{max-width:1323px}.rw{max-width:1269px}.rx{max-width:1322px}.ry{max-width:679px}.rz{max-width:526px}.sa{max-width:545px}.sb{max-width:652px}.sc{max-width:878px}.sd{max-width:742px}.se{max-width:1018px}.sf{max-width:418px}.sg{max-width:494px}.sh{max-width:404px}.si{max-width:788px}.sj{max-width:1044px}.sk{margin-bottom:26px}.sl{margin-top:6px}.sm{margin-top:8px}.sn{margin-right:8px}.so{padding:8px 16px}.sp{border-radius:100px}.sq{transition:background 300ms ease}.ss{white-space:nowrap}.st{border-top:none}.su{margin-bottom:50px}.sv{height:52px}.sw{max-height:52px}.sx{box-sizing:content-box}.sy{position:static}.sz{z-index:1}.tb{max-width:155px}.th{margin-right:20px}.ti{margin-bottom:64px}.tx{height:64px}.ty{width:64px}.tz{align-self:flex-end}.ua{color:rgba(255, 255, 255, 1)}.ub{fill:rgba(255, 255, 255, 1)}.uc{background:rgba(25, 25, 25, 1)}.ud{border-color:rgba(25, 25, 25, 1)}.ug:disabled{opacity:0.1}.uh:disabled:hover{background:rgba(25, 25, 25, 1)}.ui:disabled:hover{border-color:rgba(25, 25, 25, 1)}.uo{padding-right:4px}.up{font-weight:500}.vc{white-space:pre-wrap}.vd{margin-top:16px}.vj{height:0px}.vk{gap:18px}.vl{fill:rgba(61, 61, 61, 1)}.vn{padding-bottom:20px}.vo{border-bottom:1px solid #F2F2F2}.vu{margin-top:32px}.vv{fill:#242424}.vw{background:0}.vx{border-color:#242424}.vy:disabled:hover{color:#242424}.vz:disabled:hover{fill:#242424}.wa:disabled:hover{border-color:#242424}.wl{border-bottom:solid 1px #E5E5E5}.wm{margin-top:72px}.wn{margin-bottom:0px}.wo{margin-right:16px}.at:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.au:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.cn:hover{color:#242424}.co:hover p{color:#242424}.gc:hover{background:#156D12}.gd:hover{border-color:#156D12}.ge:hover{cursor:pointer}.gu:hover{fill:#242424}.gy:hover svg{fill:#242424}.hb:hover{background-color:rgba(0, 0, 0, 0.1)}.jt:hover{text-decoration:underline}.lr:hover{fill:rgba(8, 8, 8, 1)}.mi:hover{fill:#000000}.mj:hover p{color:#000000}.ml:hover{color:#000000}.mv:hover svg{color:#000000}.sr:hover{background-color:#F2F2F2}.tw:hover{background-color:none}.ue:hover{background:#000000}.uf:hover{border-color:#242424}.vm:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.lq:focus{fill:rgba(8, 8, 8, 1)}.mw:focus svg{color:#000000}.ov:focus{transform:scale(1.01)}.lv:active{border-style:none}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.ds{margin:0 64px}.eg{height:48px}.eo{margin-bottom:52px}.fa{margin-bottom:48px}.fp{font-size:14px}.fq{line-height:20px}.fw{font-size:13px}.fx{padding:5px 12px}.gq{display:flex}.hg{margin-bottom:50px}.hk{max-width:680px}.iy{font-size:42px}.iz{margin-top:1.19em}.ja{margin-bottom:32px}.jb{line-height:52px}.jc{letter-spacing:-0.011em}.jh{align-items:center}.ko{border-top:solid 1px #F2F2F2}.kp{border-bottom:solid 1px #F2F2F2}.kq{margin:32px 0 0}.kr{padding:3px 8px}.la> *{margin-right:24px}.lb> :last-child{margin-right:0}.mc{margin-top:0px}.mr{margin:0}.oe{font-size:20px}.of{margin-top:2.14em}.og{line-height:32px}.oh{letter-spacing:-0.003em}.oq{margin-top:56px}.pu{font-size:24px}.pv{margin-top:1.95em}.pw{line-height:30px}.px{letter-spacing:-0.016em}.qd{margin-top:0.94em}.qm{margin-top:1.14em}.tg{display:inline-block}.tj{flex-direction:row}.tm{margin-bottom:0}.tn{margin-right:20px}.uj{max-width:500px}.va{line-height:24px}.vb{letter-spacing:0}.vi{margin-bottom:88px}.vt{margin:40px 0 16px}.wf{width:min-width}.wk{padding-top:72px}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.mb{margin-top:0px}.oz{margin-left:auto}.pa{text-align:center}.tf{display:inline-block}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.ma{margin-top:0px}.te{display:inline-block}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ly{margin-top:0px}.lz{margin-right:0px}.td{display:inline-block}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.do{margin:0 24px}.ec{height:40px}.ej{margin-bottom:44px}.ew{margin-bottom:32px}.fh{font-size:13px}.fi{line-height:20px}.fr{padding:0px 8px 1px}.hc{margin-bottom:2px}.ie{font-size:32px}.if{margin-top:1.01em}.ig{margin-bottom:24px}.ih{line-height:38px}.ii{letter-spacing:-0.014em}.jd{align-items:flex-start}.jx{flex-direction:column}.kc{margin:24px -24px 0}.kd{padding:0}.ks> *{margin-right:8px}.kt> :last-child{margin-right:24px}.ll{margin-left:0px}.lw{margin-top:0px}.lx{margin-right:0px}.mn{margin:0}.mx{border:1px solid #F2F2F2}.my{border-radius:99em}.mz{padding:0px 16px 0px 12px}.na{height:38px}.nb{align-items:center}.nd svg{margin-right:8px}.no{font-size:18px}.np{margin-top:1.56em}.nq{line-height:28px}.nr{letter-spacing:-0.003em}.om{margin-top:40px}.pe{font-size:20px}.pf{margin-top:1.2em}.pg{line-height:24px}.ph{letter-spacing:0}.pz{margin-top:0.67em}.qi{margin-top:1.34em}.tc{display:inline-block}.tu{margin-bottom:20px}.tv{margin-right:0}.un{max-width:100%}.uq{font-size:24px}.ur{line-height:30px}.us{letter-spacing:-0.016em}.ve{margin-bottom:64px}.vp{margin:32px 0 16px}.wb{width:100%}.wg{padding-top:48px}.nc:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.dr{margin:0 64px}.ef{height:48px}.em{margin-bottom:52px}.ez{margin-bottom:48px}.fn{font-size:14px}.fo{line-height:20px}.fu{font-size:13px}.fv{padding:5px 12px}.gp{display:flex}.hf{margin-bottom:50px}.hj{max-width:680px}.it{font-size:42px}.iu{margin-top:1.19em}.iv{margin-bottom:32px}.iw{line-height:52px}.ix{letter-spacing:-0.011em}.jg{align-items:center}.kk{border-top:solid 1px #F2F2F2}.kl{border-bottom:solid 1px #F2F2F2}.km{margin:32px 0 0}.kn{padding:3px 8px}.ky> *{margin-right:24px}.kz> :last-child{margin-right:0}.mq{margin:0}.oa{font-size:20px}.ob{margin-top:2.14em}.oc{line-height:32px}.od{letter-spacing:-0.003em}.op{margin-top:56px}.pq{font-size:24px}.pr{margin-top:1.95em}.ps{line-height:30px}.pt{letter-spacing:-0.016em}.qc{margin-top:0.94em}.ql{margin-top:1.14em}.tk{flex-direction:row}.to{margin-bottom:0}.tp{margin-right:20px}.uk{max-width:500px}.uy{line-height:24px}.uz{letter-spacing:0}.vh{margin-bottom:88px}.vs{margin:40px 0 16px}.we{width:min-width}.wj{padding-top:72px}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.dq{margin:0 48px}.ee{height:48px}.el{margin-bottom:52px}.ey{margin-bottom:48px}.fl{font-size:13px}.fm{line-height:20px}.ft{padding:0px 8px 1px}.he{margin-bottom:50px}.hi{max-width:680px}.io{font-size:42px}.ip{margin-top:1.19em}.iq{margin-bottom:32px}.ir{line-height:52px}.is{letter-spacing:-0.011em}.jf{align-items:center}.kg{border-top:solid 1px #F2F2F2}.kh{border-bottom:solid 1px #F2F2F2}.ki{margin:32px 0 0}.kj{padding:3px 8px}.kw> *{margin-right:24px}.kx> :last-child{margin-right:0}.mp{margin:0}.nw{font-size:20px}.nx{margin-top:2.14em}.ny{line-height:32px}.nz{letter-spacing:-0.003em}.oo{margin-top:56px}.pm{font-size:24px}.pn{margin-top:1.95em}.po{line-height:30px}.pp{letter-spacing:-0.016em}.qb{margin-top:0.94em}.qk{margin-top:1.14em}.tl{flex-direction:row}.tq{margin-bottom:0}.tr{margin-right:20px}.ul{max-width:500px}.uw{line-height:24px}.ux{letter-spacing:0}.vg{margin-bottom:88px}.vr{margin:40px 0 16px}.wd{width:min-width}.wi{padding-top:72px}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.dp{margin:0 24px}.ed{height:40px}.ek{margin-bottom:44px}.ex{margin-bottom:32px}.fj{font-size:13px}.fk{line-height:20px}.fs{padding:0px 8px 1px}.hd{margin-bottom:2px}.ij{font-size:32px}.ik{margin-top:1.01em}.il{margin-bottom:24px}.im{line-height:38px}.in{letter-spacing:-0.014em}.je{align-items:flex-start}.jy{flex-direction:column}.ke{margin:24px 0 0}.kf{padding:0}.ku> *{margin-right:8px}.kv> :last-child{margin-right:8px}.lm{margin-left:0px}.mo{margin:0}.ne{border:1px solid #F2F2F2}.nf{border-radius:99em}.ng{padding:0px 16px 0px 12px}.nh{height:38px}.ni{align-items:center}.nk svg{margin-right:8px}.ns{font-size:18px}.nt{margin-top:1.56em}.nu{line-height:28px}.nv{letter-spacing:-0.003em}.on{margin-top:40px}.pi{font-size:20px}.pj{margin-top:1.2em}.pk{line-height:24px}.pl{letter-spacing:0}.qa{margin-top:0.67em}.qj{margin-top:1.34em}.ts{margin-bottom:20px}.tt{margin-right:0}.um{max-width:100%}.ut{font-size:24px}.uu{line-height:30px}.uv{letter-spacing:-0.016em}.vf{margin-bottom:64px}.vq{margin:32px 0 16px}.wc{width:100%}.wh{padding-top:48px}.nj:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="print">.ta{display:none}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.cy{max-height:none}</style><style type="text/css" data-fela-rehydration="612" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.os{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="cm ah ff bf al b an ao ap aq ar as at au s u w i d q fg z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Facb3b9d8b80a&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="db"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b fh fi fj fk fl fm fn fo fp fq cm"><span><button class="bf b fh fi fr fj fk fs fl fm ft fu fo fv fw fq fx fy fz ga gb gc gd ge gf gg gh gi gj gk gl gm bm gn go" data-testid="headerSignUpButton">Sign up</button></span></p><div class="cq l"><p class="bf b fh fi fj fk fl fm fn fo fp fq cm"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae af"><a class="ag ah ai aj ak al am an ao ap aq ar as at au ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="av aw ax"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w gp gq"><div class="gr ab"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" rel="noopener follow"><div class="bf b bg z cm gs gt ab q cn gu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="db l">Write</div></div></a></span></div></div><div class="k j i d"><div class="gr ab"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSearchButton" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><div class="bf b bg z cm gs gt ab q cn gu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="gr h k j"><div class="ab q"><p class="bf b fh fi fj fk fl fm fn fo fp fq cm"><span><button class="bf b fh fi fr fj fk fs fl fm ft fu fo fv fw fq fx fy fz ga gb gc gd ge gf gg gh gi gj gk gl gm bm gn go" data-testid="headerSignUpButton">Sign up</button></span></p><div class="cq l"><p class="bf b fh fi fj fk fl fm fn fo fp fq cm"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay gv an ab q ap gw gx gy" aria-label="user options menu" data-testid="headerUserIcon"><div class="l gs"><img alt="" class="l gm by bz ca ei" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="gz by l bz ca ha n ay hb"></div></div></button></div></div></div><div class="ab"><div class="cb cc cd ce"><div class="ba cf ab cg ch ci cj ck"><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co cp"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Home"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.75v10.5c0 .138.112.25.25.25h5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v5.5c0 .138.112.25.25.25h5a.25.25 0 0 0 .25-.25v-10.5M22 9l-9.1-6.825a1.5 1.5 0 0 0-1.8 0L2 9"></path></svg><div class="cq l"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Home</p></div></div></div></a><details class="cr"><summary class="q ap ab cz bf b bg z cm cn co cp"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Lists"><path stroke="currentColor" d="M6.44 6.69a1.5 1.5 0 0 1 1.06-.44h9a1.5 1.5 0 0 1 1.06.44l.354-.354-.353.353A1.5 1.5 0 0 1 18 7.75v14l-5.694-4.396-.306-.236-.306.236L6 21.75v-14c0-.398.158-.78.44-1.06Z"></path><path stroke="currentColor" stroke-linecap="round" d="M12.5 2.75h-8a2 2 0 0 0-2 2v11.5"></path></svg><div class="cq l ae"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Library</p></div><div class="da db" style="transform:rotate(0deg"><svg xmlns="http://www.w3.org/2000/svg" width="16px" height="16px" fill="none" viewBox="0 0 24 24" class="dc dd de df"><path d="m6 9 6 6 6-6"></path></svg></div></summary><div style="height:0"><div class="l"><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/lists?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co dg">Your lists</div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/lists/saved?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co dg">Saved lists</div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/list/highlights?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co dg">Highlights</div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/lists/reading-history?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co dg">Reading history</div></a><div class="dh l"></div></div></div></details><div class="di dj dk l"></div><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/stories/drafts?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co cp"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Stories"><path stroke="currentColor" d="M4.75 21.5h14.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25H4.75a.25.25 0 0 0-.25.25v18.5c0 .138.112.25.25.25Z"></path><path stroke="currentColor" stroke-linecap="round" d="M8 8.5h8M8 15.5h5M8 12h8"></path></svg><div class="cq l"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Stories</p></div></div></div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/stats?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co cp"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Stats"><path stroke="currentColor" d="M2.75 19h4.5a.25.25 0 0 0 .25-.25v-6.5a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25ZM9.75 19h4.5a.25.25 0 0 0 .25-.25V8.25a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25ZM16.75 19h4.5a.25.25 0 0 0 .25-.25V4.25a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v14.5c0 .138.112.25.25.25Z"></path></svg><div class="cq l"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Stats</p></div></div></div></a></div></div><div class="dl l dm"><div class="l"><div class="hc hd he hf hg l"><div class="ab dn"><div class="du bh hh hi hj hk"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="ha hq hr hs ht hu"></div><div class="hv hw hx hy hz"><div class="ab dn"><div class="du bh hh hi hj hk"><div><h1 id="5e17" class="pw-post-title ia ib ic bf id ie if ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bk" data-testid="storyTitle">Malicious document targets Vietnamese officials</h1><div><div class="speechify-ignore ab ea"><div class="speechify-ignore bh l"><div class="jd je jf jg jh ab"><div><div class="ab ji"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--acb3b9d8b80a---------------------------------------"><div class="l jj jk by jl jm"><div class="l gs"><img alt="Sebdraven" class="l gm by ep eq ei" src="https://miro.medium.com/v2/resize:fill:88:88/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="jn by l ep eq ha n jo hb"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="jp ab q"><div class="ab q jq"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b jr js bk"><a class="ag ah ai aj ak al am an ao ap aq ar as jt" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--acb3b9d8b80a---------------------------------------">Sebdraven</a></p></div></div></div><span class="ju jv" aria-hidden="true"><span class="bf b bg z bk">·</span></span><p class="bf b jr js bk"><span><a class="ag ah ai aj ak al am an ao ap aq ar as jw" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11d98531eebe&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=post_page-11d98531eebe--byline--acb3b9d8b80a---------------------post_header------------------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ce"><span class="bf b bg z cm"><div class="ab dz jx jy jz"><span class="bf b bg z cm"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="ka kb l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z cm">·</span></span></div><span data-testid="storyPublishDate">Jul 31, 2018</span></div></span></div></span></div></div></div><div class="ab ea kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr"><div class="h k w gp gq q"><div class="lh l"><div class="ab q li lj"><div class="pw-multi-vote-icon gs lk ll lm ln"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Facb3b9d8b80a&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---header_actions--acb3b9d8b80a---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="lo ap lp lq lr ls an lt lu lv ln"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lw lx ly lz ma mb mc"><p class="bf b ff z cm"><span class="md">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ap lo mg mh ab q gt mi mj" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="mf"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b ff z cm"><span class="pw-responses-count me mf">4</span></p></button></div></div></div><div class="ab q ks kt ku kv kw kx ky kz la lb lc ld le lf lg"><div class="mk k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Facb3b9d8b80a&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a&amp;source=---header_actions--acb3b9d8b80a---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="cm ml" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="gm mm dz"><div class="l ae"><div class="ab dn"><div class="mn mo mp mq mr ms du bh"><div class="ab"><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="ag gt ai aj ak al am mt ao ap aq gg mu mv mj mw mx my mz na s nb nc nd ne nf ng nh u ni nj nk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z cm">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ag gt ai aj ak al am mt ao ap aq gg mu mv mj mw mx my mz na s nb nc nd ne nf ng nh u ni nj nk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z cm">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="ad8e" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">After our investigation of APT SideWinder, we’ve done a yara rule for hunting RTF document exploiting the CVE-2017–11882.</p><p id="73f1" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">We found a document written in Vietnamese dealing with a summary about differents projects in the district Hải Châu of Đà Nẵng.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok ol"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*UjwuTDu6t3I4qJHq 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*UjwuTDu6t3I4qJHq 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*UjwuTDu6t3I4qJHq 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*UjwuTDu6t3I4qJHq 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*UjwuTDu6t3I4qJHq 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*UjwuTDu6t3I4qJHq 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UjwuTDu6t3I4qJHq 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*UjwuTDu6t3I4qJHq 640w, https://miro.medium.com/v2/resize:fit:720/0*UjwuTDu6t3I4qJHq 720w, https://miro.medium.com/v2/resize:fit:750/0*UjwuTDu6t3I4qJHq 750w, https://miro.medium.com/v2/resize:fit:786/0*UjwuTDu6t3I4qJHq 786w, https://miro.medium.com/v2/resize:fit:828/0*UjwuTDu6t3I4qJHq 828w, https://miro.medium.com/v2/resize:fit:1100/0*UjwuTDu6t3I4qJHq 1100w, https://miro.medium.com/v2/resize:fit:1400/0*UjwuTDu6t3I4qJHq 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="368" loading="eager" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">RTF document</figcaption></figure><p id="448a" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">In this article, we’ll detail the infection chains and the infrastructures of the attackers and the TTPs of this campaign.</p><p id="1ee3" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">The infrastructures and TTPs during this campaign seem to the Chinese hacking group 1937CN.</p><h1 id="c43a" class="pb pc ic bf pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px py bk">Infection chains</h1><p id="80da" class="pw-post-body-paragraph nl nm ic nn b no pz nq nr ns qa nu nv nw qb ny nz oa qc oc od oe qd og oh oi hv bk">Joe sandbox has a good representation of the behaviour of the infection.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*BeY1Ys_G6fA5for1 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*BeY1Ys_G6fA5for1 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*BeY1Ys_G6fA5for1 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*BeY1Ys_G6fA5for1 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*BeY1Ys_G6fA5for1 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*BeY1Ys_G6fA5for1 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BeY1Ys_G6fA5for1 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*BeY1Ys_G6fA5for1 640w, https://miro.medium.com/v2/resize:fit:720/0*BeY1Ys_G6fA5for1 720w, https://miro.medium.com/v2/resize:fit:750/0*BeY1Ys_G6fA5for1 750w, https://miro.medium.com/v2/resize:fit:786/0*BeY1Ys_G6fA5for1 786w, https://miro.medium.com/v2/resize:fit:828/0*BeY1Ys_G6fA5for1 828w, https://miro.medium.com/v2/resize:fit:1100/0*BeY1Ys_G6fA5for1 1100w, https://miro.medium.com/v2/resize:fit:1400/0*BeY1Ys_G6fA5for1 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="511" loading="lazy" role="presentation"/></picture></div></div></figure><p id="1c30" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">This rtf document is really malicious and it exploits the equation vulnerability to write two files in the system:</p><ol class=""><li id="86c8" class="nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi qf qg qh bk">A dll named RasTls.dll</li><li id="12d5" class="nl nm ic nn b no qi nq nr ns qj nu nv nw qk ny nz oa ql oc od oe qm og oh oi qf qg qh bk">A executable file named dascgosrky.exe</li></ol><p id="c25c" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">This document is interesting to analyze so let’go !</p><h1 id="8c93" class="pb pc ic bf pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px py bk">RTF analysis</h1><p id="9bbc" class="pw-post-body-paragraph nl nm ic nn b no pz nq nr ns qa nu nv nw qb ny nz oa qc oc od oe qd og oh oi hv bk">With rtfobj, we found three ole objects in the document:</p><p id="f30b" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">two non well formed ole object and a third named package ole object.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*z0se9_iRLZkEJWxH 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*z0se9_iRLZkEJWxH 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*z0se9_iRLZkEJWxH 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*z0se9_iRLZkEJWxH 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*z0se9_iRLZkEJWxH 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*z0se9_iRLZkEJWxH 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*z0se9_iRLZkEJWxH 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*z0se9_iRLZkEJWxH 640w, https://miro.medium.com/v2/resize:fit:720/0*z0se9_iRLZkEJWxH 720w, https://miro.medium.com/v2/resize:fit:750/0*z0se9_iRLZkEJWxH 750w, https://miro.medium.com/v2/resize:fit:786/0*z0se9_iRLZkEJWxH 786w, https://miro.medium.com/v2/resize:fit:828/0*z0se9_iRLZkEJWxH 828w, https://miro.medium.com/v2/resize:fit:1100/0*z0se9_iRLZkEJWxH 1100w, https://miro.medium.com/v2/resize:fit:1400/0*z0se9_iRLZkEJWxH 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="244" loading="lazy" role="presentation"/></picture></div></div></figure><p id="b562" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">The package ole object is used to write a file in the disk when the document is opened at the destination described by the ole object.</p><p id="e3d4" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">That’s why, there is a path and a name in the ole object.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*llpUExFIbs-M60xs 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*llpUExFIbs-M60xs 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*llpUExFIbs-M60xs 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*llpUExFIbs-M60xs 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*llpUExFIbs-M60xs 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*llpUExFIbs-M60xs 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*llpUExFIbs-M60xs 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*llpUExFIbs-M60xs 640w, https://miro.medium.com/v2/resize:fit:720/0*llpUExFIbs-M60xs 720w, https://miro.medium.com/v2/resize:fit:750/0*llpUExFIbs-M60xs 750w, https://miro.medium.com/v2/resize:fit:786/0*llpUExFIbs-M60xs 786w, https://miro.medium.com/v2/resize:fit:828/0*llpUExFIbs-M60xs 828w, https://miro.medium.com/v2/resize:fit:1100/0*llpUExFIbs-M60xs 1100w, https://miro.medium.com/v2/resize:fit:1400/0*llpUExFIbs-M60xs 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="598" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Package OLE Object</figcaption></figure><p id="539c" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">This technique is used to execute code like sct file to download an executable on the operating system. McAfee labs has detailed all this stuff with sct file: <a class="ag jw" href="https://securingtomorrow.mcafee.com/mcafee-labs/dropping-files-temp-folder-raises-security-concerns/" rel="noopener ugc nofollow" target="_blank">https://securingtomorrow.mcafee.com/mcafee-labs/dropping-files-temp-folder-raises-security-concerns/</a></p><p id="32ad" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">Many attackers use it in the wild because it’ very easy to use and it’ supported by the office software with RTF files.</p><p id="6b70" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">So, in our case, a file named 8.t is dropped on %TMP% folder.</p><p id="9dfc" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">If we check it, it’s clearly encrypted.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*4WjryYG3SbumYg8i 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*4WjryYG3SbumYg8i 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*4WjryYG3SbumYg8i 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*4WjryYG3SbumYg8i 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*4WjryYG3SbumYg8i 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*4WjryYG3SbumYg8i 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4WjryYG3SbumYg8i 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*4WjryYG3SbumYg8i 640w, https://miro.medium.com/v2/resize:fit:720/0*4WjryYG3SbumYg8i 720w, https://miro.medium.com/v2/resize:fit:750/0*4WjryYG3SbumYg8i 750w, https://miro.medium.com/v2/resize:fit:786/0*4WjryYG3SbumYg8i 786w, https://miro.medium.com/v2/resize:fit:828/0*4WjryYG3SbumYg8i 828w, https://miro.medium.com/v2/resize:fit:1100/0*4WjryYG3SbumYg8i 1100w, https://miro.medium.com/v2/resize:fit:1400/0*4WjryYG3SbumYg8i 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="937" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">8.t encrypted</figcaption></figure><p id="bd02" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">The others object ole seem to the exploit of CVE-2017–11882.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*o_6PY8at9KPdbiiG 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*o_6PY8at9KPdbiiG 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*o_6PY8at9KPdbiiG 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*o_6PY8at9KPdbiiG 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*o_6PY8at9KPdbiiG 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*o_6PY8at9KPdbiiG 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*o_6PY8at9KPdbiiG 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*o_6PY8at9KPdbiiG 640w, https://miro.medium.com/v2/resize:fit:720/0*o_6PY8at9KPdbiiG 720w, https://miro.medium.com/v2/resize:fit:750/0*o_6PY8at9KPdbiiG 750w, https://miro.medium.com/v2/resize:fit:786/0*o_6PY8at9KPdbiiG 786w, https://miro.medium.com/v2/resize:fit:828/0*o_6PY8at9KPdbiiG 828w, https://miro.medium.com/v2/resize:fit:1100/0*o_6PY8at9KPdbiiG 1100w, https://miro.medium.com/v2/resize:fit:1400/0*o_6PY8at9KPdbiiG 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="854" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Equation Ole Object</figcaption></figure><p id="2729" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">At the end of the object ole, we have differents API functions to make a runPE.</p><p id="b4da" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">Another interesting thing is this string at the begin of the object: 7e079a2524fa63a55fbcfe</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*GyysuwepHVVQxfEc 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*GyysuwepHVVQxfEc 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*GyysuwepHVVQxfEc 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*GyysuwepHVVQxfEc 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*GyysuwepHVVQxfEc 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*GyysuwepHVVQxfEc 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GyysuwepHVVQxfEc 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*GyysuwepHVVQxfEc 640w, https://miro.medium.com/v2/resize:fit:720/0*GyysuwepHVVQxfEc 720w, https://miro.medium.com/v2/resize:fit:750/0*GyysuwepHVVQxfEc 750w, https://miro.medium.com/v2/resize:fit:786/0*GyysuwepHVVQxfEc 786w, https://miro.medium.com/v2/resize:fit:828/0*GyysuwepHVVQxfEc 828w, https://miro.medium.com/v2/resize:fit:1100/0*GyysuwepHVVQxfEc 1100w, https://miro.medium.com/v2/resize:fit:1400/0*GyysuwepHVVQxfEc 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="36" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">String found in many exploits of CVE-2017–11882</figcaption></figure><p id="9d68" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">We have the same string used by APT SideWinder in the equation object ole.</p><p id="cd30" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">It’s the same toolset to create the malicious document.</p><p id="d2e2" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">So now, we have to debug the malicious document to find how the file 8.t is used and find this runPE.</p><h1 id="feb3" class="pb pc ic bf pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px py bk">Debugging of the shellcode</h1><p id="6872" class="pw-post-body-paragraph nl nm ic nn b no pz nq nr ns qa nu nv nw qb ny nz oa qc oc od oe qd og oh oi hv bk">At the start of the analysis, we think the process EQNEDT32.exe is created by Winword.exe using the function CreateProcess. So we decided to set a breakpoint at the call of his function.</p><p id="3da9" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">But EQNEDT32.exe is invoked by Winword.exe using COM Object. It’s not CreateProcess that used and Winword.exe is not the parent process of EQNEDT32.exe. So we have to attach the debugger when EQNEDT32.exe is launched.</p><p id="a7dd" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">For that, we used a technique named Image File Execution Options that was documented by Microsoft. <a class="ag jw" href="https://blogs.msdn.microsoft.com/mithuns/2010/03/24/image-file-execution-options-ifeo/" rel="noopener ugc nofollow" target="_blank">https://blogs.msdn.microsoft.com/mithuns/2010/03/24/image-file-execution-options-ifeo/</a></p><p id="121e" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">We create a key EQNEDT32.exe.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*AchzzWF6FLH4L7me 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*AchzzWF6FLH4L7me 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*AchzzWF6FLH4L7me 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*AchzzWF6FLH4L7me 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*AchzzWF6FLH4L7me 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*AchzzWF6FLH4L7me 1100w, https://miro.medium.com/v2/resize:fit:454/format:webp/0*AchzzWF6FLH4L7me 454w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 227px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*AchzzWF6FLH4L7me 640w, https://miro.medium.com/v2/resize:fit:720/0*AchzzWF6FLH4L7me 720w, https://miro.medium.com/v2/resize:fit:750/0*AchzzWF6FLH4L7me 750w, https://miro.medium.com/v2/resize:fit:786/0*AchzzWF6FLH4L7me 786w, https://miro.medium.com/v2/resize:fit:828/0*AchzzWF6FLH4L7me 828w, https://miro.medium.com/v2/resize:fit:1100/0*AchzzWF6FLH4L7me 1100w, https://miro.medium.com/v2/resize:fit:454/0*AchzzWF6FLH4L7me 454w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 227px"/><img alt="" class="bh ms ow c" width="227" height="175" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Registry HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</figcaption></figure><p id="95f9" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And we set a value string for launching the debugger when EQNEDT32.exe is executed and attaching the debugger to the process .</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*T9fAPdGsgF8vJmsY 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*T9fAPdGsgF8vJmsY 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*T9fAPdGsgF8vJmsY 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*T9fAPdGsgF8vJmsY 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*T9fAPdGsgF8vJmsY 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*T9fAPdGsgF8vJmsY 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*T9fAPdGsgF8vJmsY 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*T9fAPdGsgF8vJmsY 640w, https://miro.medium.com/v2/resize:fit:720/0*T9fAPdGsgF8vJmsY 720w, https://miro.medium.com/v2/resize:fit:750/0*T9fAPdGsgF8vJmsY 750w, https://miro.medium.com/v2/resize:fit:786/0*T9fAPdGsgF8vJmsY 786w, https://miro.medium.com/v2/resize:fit:828/0*T9fAPdGsgF8vJmsY 828w, https://miro.medium.com/v2/resize:fit:1100/0*T9fAPdGsgF8vJmsY 1100w, https://miro.medium.com/v2/resize:fit:1400/0*T9fAPdGsgF8vJmsY 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="63" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Value to set the debuuger when EQNEDT32.exe is executed</figcaption></figure><p id="dc51" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">When we open the rtf document, Winword is launched and EQNEDT32.exe also.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*-knWoOBXf2rZYzAv 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*-knWoOBXf2rZYzAv 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*-knWoOBXf2rZYzAv 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*-knWoOBXf2rZYzAv 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*-knWoOBXf2rZYzAv 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*-knWoOBXf2rZYzAv 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-knWoOBXf2rZYzAv 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*-knWoOBXf2rZYzAv 640w, https://miro.medium.com/v2/resize:fit:720/0*-knWoOBXf2rZYzAv 720w, https://miro.medium.com/v2/resize:fit:750/0*-knWoOBXf2rZYzAv 750w, https://miro.medium.com/v2/resize:fit:786/0*-knWoOBXf2rZYzAv 786w, https://miro.medium.com/v2/resize:fit:828/0*-knWoOBXf2rZYzAv 828w, https://miro.medium.com/v2/resize:fit:1100/0*-knWoOBXf2rZYzAv 1100w, https://miro.medium.com/v2/resize:fit:1400/0*-knWoOBXf2rZYzAv 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="77" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Winword process</figcaption></figure><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*zc__yXOamZEOtvMx 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*zc__yXOamZEOtvMx 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*zc__yXOamZEOtvMx 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*zc__yXOamZEOtvMx 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*zc__yXOamZEOtvMx 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*zc__yXOamZEOtvMx 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zc__yXOamZEOtvMx 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*zc__yXOamZEOtvMx 640w, https://miro.medium.com/v2/resize:fit:720/0*zc__yXOamZEOtvMx 720w, https://miro.medium.com/v2/resize:fit:750/0*zc__yXOamZEOtvMx 750w, https://miro.medium.com/v2/resize:fit:786/0*zc__yXOamZEOtvMx 786w, https://miro.medium.com/v2/resize:fit:828/0*zc__yXOamZEOtvMx 828w, https://miro.medium.com/v2/resize:fit:1100/0*zc__yXOamZEOtvMx 1100w, https://miro.medium.com/v2/resize:fit:1400/0*zc__yXOamZEOtvMx 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="57" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">EQNEDT32.exe process attached by the debugger</figcaption></figure><p id="ec72" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And the debugger is attached at the entrypoint of EQNEDT32.exe.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok qw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*l27hHfCpE1guw2mp 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*l27hHfCpE1guw2mp 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*l27hHfCpE1guw2mp 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*l27hHfCpE1guw2mp 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*l27hHfCpE1guw2mp 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*l27hHfCpE1guw2mp 1100w, https://miro.medium.com/v2/resize:fit:932/format:webp/0*l27hHfCpE1guw2mp 932w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 466px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*l27hHfCpE1guw2mp 640w, https://miro.medium.com/v2/resize:fit:720/0*l27hHfCpE1guw2mp 720w, https://miro.medium.com/v2/resize:fit:750/0*l27hHfCpE1guw2mp 750w, https://miro.medium.com/v2/resize:fit:786/0*l27hHfCpE1guw2mp 786w, https://miro.medium.com/v2/resize:fit:828/0*l27hHfCpE1guw2mp 828w, https://miro.medium.com/v2/resize:fit:1100/0*l27hHfCpE1guw2mp 1100w, https://miro.medium.com/v2/resize:fit:932/0*l27hHfCpE1guw2mp 932w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 466px"/><img alt="" class="bh ms ow c" width="466" height="56" loading="lazy" role="presentation"/></picture></div></figure><p id="2568" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">We check if it’s 8.t is correctly created in the %TMP% folder.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok qx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*p77roZuWiKJIR-1R 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*p77roZuWiKJIR-1R 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*p77roZuWiKJIR-1R 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*p77roZuWiKJIR-1R 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*p77roZuWiKJIR-1R 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*p77roZuWiKJIR-1R 1100w, https://miro.medium.com/v2/resize:fit:520/format:webp/0*p77roZuWiKJIR-1R 520w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 260px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*p77roZuWiKJIR-1R 640w, https://miro.medium.com/v2/resize:fit:720/0*p77roZuWiKJIR-1R 720w, https://miro.medium.com/v2/resize:fit:750/0*p77roZuWiKJIR-1R 750w, https://miro.medium.com/v2/resize:fit:786/0*p77roZuWiKJIR-1R 786w, https://miro.medium.com/v2/resize:fit:828/0*p77roZuWiKJIR-1R 828w, https://miro.medium.com/v2/resize:fit:1100/0*p77roZuWiKJIR-1R 1100w, https://miro.medium.com/v2/resize:fit:520/0*p77roZuWiKJIR-1R 520w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 260px"/><img alt="" class="bh ms ow c" width="260" height="89" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">8.t dropped on disk</figcaption></figure><p id="8687" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">Now we set a breakpoint at the createFile to check if the shellcode of the exploit reads the file 8.t.</p><p id="85f3" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">CreateFile is called at call eqnedt32.41E5EE.</p><p id="2133" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">The param of the path of file is pushed on the stack push dword ptr ss:[ebp-4].</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qy"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*0KxqoNNo4xV3XkJg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*0KxqoNNo4xV3XkJg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*0KxqoNNo4xV3XkJg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*0KxqoNNo4xV3XkJg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*0KxqoNNo4xV3XkJg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*0KxqoNNo4xV3XkJg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0KxqoNNo4xV3XkJg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*0KxqoNNo4xV3XkJg 640w, https://miro.medium.com/v2/resize:fit:720/0*0KxqoNNo4xV3XkJg 720w, https://miro.medium.com/v2/resize:fit:750/0*0KxqoNNo4xV3XkJg 750w, https://miro.medium.com/v2/resize:fit:786/0*0KxqoNNo4xV3XkJg 786w, https://miro.medium.com/v2/resize:fit:828/0*0KxqoNNo4xV3XkJg 828w, https://miro.medium.com/v2/resize:fit:1100/0*0KxqoNNo4xV3XkJg 1100w, https://miro.medium.com/v2/resize:fit:1400/0*0KxqoNNo4xV3XkJg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="56" loading="lazy" role="presentation"/></picture></div></div></figure><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok qz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*nKQqfpBSnORnG9Ih 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*nKQqfpBSnORnG9Ih 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*nKQqfpBSnORnG9Ih 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*nKQqfpBSnORnG9Ih 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*nKQqfpBSnORnG9Ih 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*nKQqfpBSnORnG9Ih 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nKQqfpBSnORnG9Ih 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*nKQqfpBSnORnG9Ih 640w, https://miro.medium.com/v2/resize:fit:720/0*nKQqfpBSnORnG9Ih 720w, https://miro.medium.com/v2/resize:fit:750/0*nKQqfpBSnORnG9Ih 750w, https://miro.medium.com/v2/resize:fit:786/0*nKQqfpBSnORnG9Ih 786w, https://miro.medium.com/v2/resize:fit:828/0*nKQqfpBSnORnG9Ih 828w, https://miro.medium.com/v2/resize:fit:1100/0*nKQqfpBSnORnG9Ih 1100w, https://miro.medium.com/v2/resize:fit:1400/0*nKQqfpBSnORnG9Ih 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="34" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5a95" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">The shellcode uses CreateFile to the 8.t in the %TMP% folder</p><p id="90f6" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">So now, we can return of the user code at the calling function.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok ra"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Z69pZnETOuY6cQTE 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Z69pZnETOuY6cQTE 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Z69pZnETOuY6cQTE 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Z69pZnETOuY6cQTE 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Z69pZnETOuY6cQTE 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Z69pZnETOuY6cQTE 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Z69pZnETOuY6cQTE 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Z69pZnETOuY6cQTE 640w, https://miro.medium.com/v2/resize:fit:720/0*Z69pZnETOuY6cQTE 720w, https://miro.medium.com/v2/resize:fit:750/0*Z69pZnETOuY6cQTE 750w, https://miro.medium.com/v2/resize:fit:786/0*Z69pZnETOuY6cQTE 786w, https://miro.medium.com/v2/resize:fit:828/0*Z69pZnETOuY6cQTE 828w, https://miro.medium.com/v2/resize:fit:1100/0*Z69pZnETOuY6cQTE 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Z69pZnETOuY6cQTE 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="29" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5c9c" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">After a step into, we enter in the shellcode, the address space has changed:</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Dv2Xdv-5iWaptdeB 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Dv2Xdv-5iWaptdeB 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Dv2Xdv-5iWaptdeB 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Dv2Xdv-5iWaptdeB 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Dv2Xdv-5iWaptdeB 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Dv2Xdv-5iWaptdeB 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Dv2Xdv-5iWaptdeB 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Dv2Xdv-5iWaptdeB 640w, https://miro.medium.com/v2/resize:fit:720/0*Dv2Xdv-5iWaptdeB 720w, https://miro.medium.com/v2/resize:fit:750/0*Dv2Xdv-5iWaptdeB 750w, https://miro.medium.com/v2/resize:fit:786/0*Dv2Xdv-5iWaptdeB 786w, https://miro.medium.com/v2/resize:fit:828/0*Dv2Xdv-5iWaptdeB 828w, https://miro.medium.com/v2/resize:fit:1100/0*Dv2Xdv-5iWaptdeB 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Dv2Xdv-5iWaptdeB 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="256" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Shellcode of the exploit</figcaption></figure><p id="6dd1" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">After CreateFile, GetFileSize is called to have the size of the file</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*sVUaySpk_IqLDEEd 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*sVUaySpk_IqLDEEd 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*sVUaySpk_IqLDEEd 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*sVUaySpk_IqLDEEd 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*sVUaySpk_IqLDEEd 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*sVUaySpk_IqLDEEd 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sVUaySpk_IqLDEEd 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*sVUaySpk_IqLDEEd 640w, https://miro.medium.com/v2/resize:fit:720/0*sVUaySpk_IqLDEEd 720w, https://miro.medium.com/v2/resize:fit:750/0*sVUaySpk_IqLDEEd 750w, https://miro.medium.com/v2/resize:fit:786/0*sVUaySpk_IqLDEEd 786w, https://miro.medium.com/v2/resize:fit:828/0*sVUaySpk_IqLDEEd 828w, https://miro.medium.com/v2/resize:fit:1100/0*sVUaySpk_IqLDEEd 1100w, https://miro.medium.com/v2/resize:fit:1400/0*sVUaySpk_IqLDEEd 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="102" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Get the size of the file</figcaption></figure><p id="6ad8" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">After is Virtualloc, and it create a memory page at 1FD0000 (eax value)</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*ZbIjFGLCh8gNGkvZ 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*ZbIjFGLCh8gNGkvZ 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*ZbIjFGLCh8gNGkvZ 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*ZbIjFGLCh8gNGkvZ 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*ZbIjFGLCh8gNGkvZ 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*ZbIjFGLCh8gNGkvZ 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZbIjFGLCh8gNGkvZ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*ZbIjFGLCh8gNGkvZ 640w, https://miro.medium.com/v2/resize:fit:720/0*ZbIjFGLCh8gNGkvZ 720w, https://miro.medium.com/v2/resize:fit:750/0*ZbIjFGLCh8gNGkvZ 750w, https://miro.medium.com/v2/resize:fit:786/0*ZbIjFGLCh8gNGkvZ 786w, https://miro.medium.com/v2/resize:fit:828/0*ZbIjFGLCh8gNGkvZ 828w, https://miro.medium.com/v2/resize:fit:1100/0*ZbIjFGLCh8gNGkvZ 1100w, https://miro.medium.com/v2/resize:fit:1400/0*ZbIjFGLCh8gNGkvZ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="91" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">VirtualAlloc memory page to load 8.t</figcaption></figure><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok ol"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*LdAKz0ohFyXUZLnQ 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*LdAKz0ohFyXUZLnQ 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*LdAKz0ohFyXUZLnQ 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*LdAKz0ohFyXUZLnQ 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*LdAKz0ohFyXUZLnQ 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*LdAKz0ohFyXUZLnQ 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LdAKz0ohFyXUZLnQ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*LdAKz0ohFyXUZLnQ 640w, https://miro.medium.com/v2/resize:fit:720/0*LdAKz0ohFyXUZLnQ 720w, https://miro.medium.com/v2/resize:fit:750/0*LdAKz0ohFyXUZLnQ 750w, https://miro.medium.com/v2/resize:fit:786/0*LdAKz0ohFyXUZLnQ 786w, https://miro.medium.com/v2/resize:fit:828/0*LdAKz0ohFyXUZLnQ 828w, https://miro.medium.com/v2/resize:fit:1100/0*LdAKz0ohFyXUZLnQ 1100w, https://miro.medium.com/v2/resize:fit:1400/0*LdAKz0ohFyXUZLnQ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="25" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">After virtualAlloc, the memory page is pointed by EAX</figcaption></figure><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok re"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*scFreDPlrg0vMk3y 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*scFreDPlrg0vMk3y 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*scFreDPlrg0vMk3y 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*scFreDPlrg0vMk3y 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*scFreDPlrg0vMk3y 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*scFreDPlrg0vMk3y 1100w, https://miro.medium.com/v2/resize:fit:1136/format:webp/0*scFreDPlrg0vMk3y 1136w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 568px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*scFreDPlrg0vMk3y 640w, https://miro.medium.com/v2/resize:fit:720/0*scFreDPlrg0vMk3y 720w, https://miro.medium.com/v2/resize:fit:750/0*scFreDPlrg0vMk3y 750w, https://miro.medium.com/v2/resize:fit:786/0*scFreDPlrg0vMk3y 786w, https://miro.medium.com/v2/resize:fit:828/0*scFreDPlrg0vMk3y 828w, https://miro.medium.com/v2/resize:fit:1100/0*scFreDPlrg0vMk3y 1100w, https://miro.medium.com/v2/resize:fit:1136/0*scFreDPlrg0vMk3y 1136w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 568px"/><img alt="" class="bh ms ow c" width="568" height="223" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">The page allocated</figcaption></figure><p id="09af" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">ReadFile is called:</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*9U63odBDYmELykLj 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*9U63odBDYmELykLj 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*9U63odBDYmELykLj 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*9U63odBDYmELykLj 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*9U63odBDYmELykLj 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*9U63odBDYmELykLj 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9U63odBDYmELykLj 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*9U63odBDYmELykLj 640w, https://miro.medium.com/v2/resize:fit:720/0*9U63odBDYmELykLj 720w, https://miro.medium.com/v2/resize:fit:750/0*9U63odBDYmELykLj 750w, https://miro.medium.com/v2/resize:fit:786/0*9U63odBDYmELykLj 786w, https://miro.medium.com/v2/resize:fit:828/0*9U63odBDYmELykLj 828w, https://miro.medium.com/v2/resize:fit:1100/0*9U63odBDYmELykLj 1100w, https://miro.medium.com/v2/resize:fit:1400/0*9U63odBDYmELykLj 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="98" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Readfile 8.t</figcaption></figure><p id="9f38" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And 8.t is loaded at 1FD0000:</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Jk1gs5HJ_bqItbId 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Jk1gs5HJ_bqItbId 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Jk1gs5HJ_bqItbId 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Jk1gs5HJ_bqItbId 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Jk1gs5HJ_bqItbId 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Jk1gs5HJ_bqItbId 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Jk1gs5HJ_bqItbId 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Jk1gs5HJ_bqItbId 640w, https://miro.medium.com/v2/resize:fit:720/0*Jk1gs5HJ_bqItbId 720w, https://miro.medium.com/v2/resize:fit:750/0*Jk1gs5HJ_bqItbId 750w, https://miro.medium.com/v2/resize:fit:786/0*Jk1gs5HJ_bqItbId 786w, https://miro.medium.com/v2/resize:fit:828/0*Jk1gs5HJ_bqItbId 828w, https://miro.medium.com/v2/resize:fit:1100/0*Jk1gs5HJ_bqItbId 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Jk1gs5HJ_bqItbId 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="193" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">8.t in memory</figcaption></figure><p id="6279" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And the shellcode decrypts the 8.t file in memory at 0066C82A.</p><p id="da31" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">The loop of decryption is a xoring with different manipulations on the decryption key.</p><p id="b13c" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">At the start of the decryption the key is set to 7BF48E63.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*PGv72R85Q_sluT4L 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*PGv72R85Q_sluT4L 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*PGv72R85Q_sluT4L 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*PGv72R85Q_sluT4L 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*PGv72R85Q_sluT4L 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*PGv72R85Q_sluT4L 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PGv72R85Q_sluT4L 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*PGv72R85Q_sluT4L 640w, https://miro.medium.com/v2/resize:fit:720/0*PGv72R85Q_sluT4L 720w, https://miro.medium.com/v2/resize:fit:750/0*PGv72R85Q_sluT4L 750w, https://miro.medium.com/v2/resize:fit:786/0*PGv72R85Q_sluT4L 786w, https://miro.medium.com/v2/resize:fit:828/0*PGv72R85Q_sluT4L 828w, https://miro.medium.com/v2/resize:fit:1100/0*PGv72R85Q_sluT4L 1100w, https://miro.medium.com/v2/resize:fit:1400/0*PGv72R85Q_sluT4L 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="201" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Decryption loop</figcaption></figure><p id="4dd3" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And the xor is made after key manipulation.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok ri"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*bSANUUTbXIj4P9Nj 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*bSANUUTbXIj4P9Nj 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*bSANUUTbXIj4P9Nj 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*bSANUUTbXIj4P9Nj 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*bSANUUTbXIj4P9Nj 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*bSANUUTbXIj4P9Nj 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bSANUUTbXIj4P9Nj 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*bSANUUTbXIj4P9Nj 640w, https://miro.medium.com/v2/resize:fit:720/0*bSANUUTbXIj4P9Nj 720w, https://miro.medium.com/v2/resize:fit:750/0*bSANUUTbXIj4P9Nj 750w, https://miro.medium.com/v2/resize:fit:786/0*bSANUUTbXIj4P9Nj 786w, https://miro.medium.com/v2/resize:fit:828/0*bSANUUTbXIj4P9Nj 828w, https://miro.medium.com/v2/resize:fit:1100/0*bSANUUTbXIj4P9Nj 1100w, https://miro.medium.com/v2/resize:fit:1400/0*bSANUUTbXIj4P9Nj 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="145" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Set the decryption key in EAX</figcaption></figure><p id="3cd0" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">If we check the destination of the result of the xoring (here edx + ebx), we find 01FD0000 where 8.t is loaded.</p><p id="22db" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">After two step of the loop, we can see the magic number MZ set at the begin of memory section.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok rj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*qV4ri5WwmOZY656e 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*qV4ri5WwmOZY656e 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*qV4ri5WwmOZY656e 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*qV4ri5WwmOZY656e 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*qV4ri5WwmOZY656e 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*qV4ri5WwmOZY656e 1100w, https://miro.medium.com/v2/resize:fit:1178/format:webp/0*qV4ri5WwmOZY656e 1178w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 589px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*qV4ri5WwmOZY656e 640w, https://miro.medium.com/v2/resize:fit:720/0*qV4ri5WwmOZY656e 720w, https://miro.medium.com/v2/resize:fit:750/0*qV4ri5WwmOZY656e 750w, https://miro.medium.com/v2/resize:fit:786/0*qV4ri5WwmOZY656e 786w, https://miro.medium.com/v2/resize:fit:828/0*qV4ri5WwmOZY656e 828w, https://miro.medium.com/v2/resize:fit:1100/0*qV4ri5WwmOZY656e 1100w, https://miro.medium.com/v2/resize:fit:1178/0*qV4ri5WwmOZY656e 1178w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 589px"/><img alt="" class="bh ms ow c" width="589" height="23" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">MZ magic number</figcaption></figure><p id="8d49" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">At the end of the decryption loop, we have a PE in memory at 01FD0000.</p><p id="c447" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">the file 8.t has been decrypted.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Qr7rIF4SzfRXrfA- 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Qr7rIF4SzfRXrfA- 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Qr7rIF4SzfRXrfA- 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Qr7rIF4SzfRXrfA- 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Qr7rIF4SzfRXrfA- 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Qr7rIF4SzfRXrfA- 1100w, https://miro.medium.com/v2/resize:fit:1054/format:webp/0*Qr7rIF4SzfRXrfA- 1054w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 527px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Qr7rIF4SzfRXrfA- 640w, https://miro.medium.com/v2/resize:fit:720/0*Qr7rIF4SzfRXrfA- 720w, https://miro.medium.com/v2/resize:fit:750/0*Qr7rIF4SzfRXrfA- 750w, https://miro.medium.com/v2/resize:fit:786/0*Qr7rIF4SzfRXrfA- 786w, https://miro.medium.com/v2/resize:fit:828/0*Qr7rIF4SzfRXrfA- 828w, https://miro.medium.com/v2/resize:fit:1100/0*Qr7rIF4SzfRXrfA- 1100w, https://miro.medium.com/v2/resize:fit:1054/0*Qr7rIF4SzfRXrfA- 1054w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 527px"/><img alt="" class="bh ms ow c" width="527" height="206" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">8.t fully decrypted</figcaption></figure><p id="20a4" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">Then, the shellcode uses the VirtualAlloc and create a memory page at 02070000.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok ol"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*K0wfJidHIcxQXFkw 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*K0wfJidHIcxQXFkw 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*K0wfJidHIcxQXFkw 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*K0wfJidHIcxQXFkw 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*K0wfJidHIcxQXFkw 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*K0wfJidHIcxQXFkw 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*K0wfJidHIcxQXFkw 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*K0wfJidHIcxQXFkw 640w, https://miro.medium.com/v2/resize:fit:720/0*K0wfJidHIcxQXFkw 720w, https://miro.medium.com/v2/resize:fit:750/0*K0wfJidHIcxQXFkw 750w, https://miro.medium.com/v2/resize:fit:786/0*K0wfJidHIcxQXFkw 786w, https://miro.medium.com/v2/resize:fit:828/0*K0wfJidHIcxQXFkw 828w, https://miro.medium.com/v2/resize:fit:1100/0*K0wfJidHIcxQXFkw 1100w, https://miro.medium.com/v2/resize:fit:1400/0*K0wfJidHIcxQXFkw 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="69" loading="lazy" role="presentation"/></picture></div></div></figure><p id="7923" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And the new PE at 01FD0000 is copied at this address.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rl"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*danFn5PtUkMayFkP 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*danFn5PtUkMayFkP 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*danFn5PtUkMayFkP 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*danFn5PtUkMayFkP 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*danFn5PtUkMayFkP 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*danFn5PtUkMayFkP 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*danFn5PtUkMayFkP 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*danFn5PtUkMayFkP 640w, https://miro.medium.com/v2/resize:fit:720/0*danFn5PtUkMayFkP 720w, https://miro.medium.com/v2/resize:fit:750/0*danFn5PtUkMayFkP 750w, https://miro.medium.com/v2/resize:fit:786/0*danFn5PtUkMayFkP 786w, https://miro.medium.com/v2/resize:fit:828/0*danFn5PtUkMayFkP 828w, https://miro.medium.com/v2/resize:fit:1100/0*danFn5PtUkMayFkP 1100w, https://miro.medium.com/v2/resize:fit:1400/0*danFn5PtUkMayFkP 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="246" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">the PE decrypted is copied in the new memory page</figcaption></figure><p id="8688" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">After GetModuleFileNameA is called to have the path of EQNEDT32.exe</p><p id="6634" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And EQNEDT32.exe is forked in suspend status by a CreateProcess and the shellcode overwrite it by the PE at the address 02070000</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kk64ZHud8G2F4tCC4OsG8A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kk64ZHud8G2F4tCC4OsG8A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kk64ZHud8G2F4tCC4OsG8A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kk64ZHud8G2F4tCC4OsG8A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kk64ZHud8G2F4tCC4OsG8A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kk64ZHud8G2F4tCC4OsG8A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kk64ZHud8G2F4tCC4OsG8A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*kk64ZHud8G2F4tCC4OsG8A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kk64ZHud8G2F4tCC4OsG8A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kk64ZHud8G2F4tCC4OsG8A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kk64ZHud8G2F4tCC4OsG8A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kk64ZHud8G2F4tCC4OsG8A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kk64ZHud8G2F4tCC4OsG8A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*kk64ZHud8G2F4tCC4OsG8A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="77" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Fork of EQNEDT32.exe</figcaption></figure><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*ypOCUTfbDeferzub 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*ypOCUTfbDeferzub 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*ypOCUTfbDeferzub 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*ypOCUTfbDeferzub 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*ypOCUTfbDeferzub 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*ypOCUTfbDeferzub 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ypOCUTfbDeferzub 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*ypOCUTfbDeferzub 640w, https://miro.medium.com/v2/resize:fit:720/0*ypOCUTfbDeferzub 720w, https://miro.medium.com/v2/resize:fit:750/0*ypOCUTfbDeferzub 750w, https://miro.medium.com/v2/resize:fit:786/0*ypOCUTfbDeferzub 786w, https://miro.medium.com/v2/resize:fit:828/0*ypOCUTfbDeferzub 828w, https://miro.medium.com/v2/resize:fit:1100/0*ypOCUTfbDeferzub 1100w, https://miro.medium.com/v2/resize:fit:1400/0*ypOCUTfbDeferzub 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="78" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Overwritting of EQNEDT32.exe</figcaption></figure><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok ro"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*L0Hhdpr9Wenz-bek 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*L0Hhdpr9Wenz-bek 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*L0Hhdpr9Wenz-bek 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*L0Hhdpr9Wenz-bek 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*L0Hhdpr9Wenz-bek 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*L0Hhdpr9Wenz-bek 1100w, https://miro.medium.com/v2/resize:fit:820/format:webp/0*L0Hhdpr9Wenz-bek 820w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 410px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*L0Hhdpr9Wenz-bek 640w, https://miro.medium.com/v2/resize:fit:720/0*L0Hhdpr9Wenz-bek 720w, https://miro.medium.com/v2/resize:fit:750/0*L0Hhdpr9Wenz-bek 750w, https://miro.medium.com/v2/resize:fit:786/0*L0Hhdpr9Wenz-bek 786w, https://miro.medium.com/v2/resize:fit:828/0*L0Hhdpr9Wenz-bek 828w, https://miro.medium.com/v2/resize:fit:1100/0*L0Hhdpr9Wenz-bek 1100w, https://miro.medium.com/v2/resize:fit:820/0*L0Hhdpr9Wenz-bek 820w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 410px"/><img alt="" class="bh ms ow c" width="410" height="53" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Stack used by NTWriteVirtualMemory</figcaption></figure><p id="ebd5" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And the shellcode does a ResumeThread to launch the new PE.</p><p id="8c1a" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">So, We’ve found all API Calls in the object ole at the beginning and we have a runPE to launch the new EQNEDT32.exe overwritten.</p><h1 id="3023" class="pb pc ic bf pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px py bk">Analysing the fork of EQNEDT32.exe</h1><p id="1c24" class="pw-post-body-paragraph nl nm ic nn b no pz nq nr ns qa nu nv nw qb ny nz oa qc oc od oe qd og oh oi hv bk">We know that this process has to create on disk two files following the Joe SandBox Analysis:</p><ul class=""><li id="a1ef" class="nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi rp qg qh bk">A dll named RasTls.dll</li><li id="9e7e" class="nl nm ic nn b no qi nq nr ns qj nu nv nw qk ny nz oa ql oc od oe qm og oh oi rp qg qh bk">A executable file named dascgosrky.exe</li></ul><p id="da74" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">If we dump EQNEDT32.exe and we put in IDA, we found quickly the function that drops the files on disk (sub_00401150) renamed dropFiles.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*g-1TYchR4C-l1bZe 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*g-1TYchR4C-l1bZe 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*g-1TYchR4C-l1bZe 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*g-1TYchR4C-l1bZe 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*g-1TYchR4C-l1bZe 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*g-1TYchR4C-l1bZe 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*g-1TYchR4C-l1bZe 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*g-1TYchR4C-l1bZe 640w, https://miro.medium.com/v2/resize:fit:720/0*g-1TYchR4C-l1bZe 720w, https://miro.medium.com/v2/resize:fit:750/0*g-1TYchR4C-l1bZe 750w, https://miro.medium.com/v2/resize:fit:786/0*g-1TYchR4C-l1bZe 786w, https://miro.medium.com/v2/resize:fit:828/0*g-1TYchR4C-l1bZe 828w, https://miro.medium.com/v2/resize:fit:1100/0*g-1TYchR4C-l1bZe 1100w, https://miro.medium.com/v2/resize:fit:1400/0*g-1TYchR4C-l1bZe 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="368" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">DropFiles Fucntion</figcaption></figure><p id="6fea" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And at the start of this functions, we have a loop with a xor.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*2zdLF3_sBWAbZ1cn 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*2zdLF3_sBWAbZ1cn 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*2zdLF3_sBWAbZ1cn 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*2zdLF3_sBWAbZ1cn 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*2zdLF3_sBWAbZ1cn 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*2zdLF3_sBWAbZ1cn 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2zdLF3_sBWAbZ1cn 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*2zdLF3_sBWAbZ1cn 640w, https://miro.medium.com/v2/resize:fit:720/0*2zdLF3_sBWAbZ1cn 720w, https://miro.medium.com/v2/resize:fit:750/0*2zdLF3_sBWAbZ1cn 750w, https://miro.medium.com/v2/resize:fit:786/0*2zdLF3_sBWAbZ1cn 786w, https://miro.medium.com/v2/resize:fit:828/0*2zdLF3_sBWAbZ1cn 828w, https://miro.medium.com/v2/resize:fit:1100/0*2zdLF3_sBWAbZ1cn 1100w, https://miro.medium.com/v2/resize:fit:1400/0*2zdLF3_sBWAbZ1cn 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="343" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Second loop of decryption</figcaption></figure><p id="ee94" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And just after we have a call of the decompression function.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*6bila_55UIdXaZVs 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*6bila_55UIdXaZVs 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*6bila_55UIdXaZVs 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*6bila_55UIdXaZVs 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*6bila_55UIdXaZVs 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*6bila_55UIdXaZVs 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6bila_55UIdXaZVs 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*6bila_55UIdXaZVs 640w, https://miro.medium.com/v2/resize:fit:720/0*6bila_55UIdXaZVs 720w, https://miro.medium.com/v2/resize:fit:750/0*6bila_55UIdXaZVs 750w, https://miro.medium.com/v2/resize:fit:786/0*6bila_55UIdXaZVs 786w, https://miro.medium.com/v2/resize:fit:828/0*6bila_55UIdXaZVs 828w, https://miro.medium.com/v2/resize:fit:1100/0*6bila_55UIdXaZVs 1100w, https://miro.medium.com/v2/resize:fit:1400/0*6bila_55UIdXaZVs 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="237" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Decompression function used zlib</figcaption></figure><p id="004f" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">The function dropFiles is called twice by the sub_4012D0.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok rt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*XWAq6Iz3HsRky01e 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*XWAq6Iz3HsRky01e 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*XWAq6Iz3HsRky01e 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*XWAq6Iz3HsRky01e 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*XWAq6Iz3HsRky01e 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*XWAq6Iz3HsRky01e 1100w, https://miro.medium.com/v2/resize:fit:848/format:webp/0*XWAq6Iz3HsRky01e 848w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 424px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*XWAq6Iz3HsRky01e 640w, https://miro.medium.com/v2/resize:fit:720/0*XWAq6Iz3HsRky01e 720w, https://miro.medium.com/v2/resize:fit:750/0*XWAq6Iz3HsRky01e 750w, https://miro.medium.com/v2/resize:fit:786/0*XWAq6Iz3HsRky01e 786w, https://miro.medium.com/v2/resize:fit:828/0*XWAq6Iz3HsRky01e 828w, https://miro.medium.com/v2/resize:fit:1100/0*XWAq6Iz3HsRky01e 1100w, https://miro.medium.com/v2/resize:fit:848/0*XWAq6Iz3HsRky01e 848w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 424px"/><img alt="" class="bh ms ow c" width="424" height="289" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Drop the dll and the executable</figcaption></figure><p id="253b" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">If we check the call graph, DropFiles is called only by the function sub_4012D0.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok ru"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*dtetntiSL1fJu8I7 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*dtetntiSL1fJu8I7 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*dtetntiSL1fJu8I7 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*dtetntiSL1fJu8I7 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*dtetntiSL1fJu8I7 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*dtetntiSL1fJu8I7 1100w, https://miro.medium.com/v2/resize:fit:332/format:webp/0*dtetntiSL1fJu8I7 332w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 166px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*dtetntiSL1fJu8I7 640w, https://miro.medium.com/v2/resize:fit:720/0*dtetntiSL1fJu8I7 720w, https://miro.medium.com/v2/resize:fit:750/0*dtetntiSL1fJu8I7 750w, https://miro.medium.com/v2/resize:fit:786/0*dtetntiSL1fJu8I7 786w, https://miro.medium.com/v2/resize:fit:828/0*dtetntiSL1fJu8I7 828w, https://miro.medium.com/v2/resize:fit:1100/0*dtetntiSL1fJu8I7 1100w, https://miro.medium.com/v2/resize:fit:332/0*dtetntiSL1fJu8I7 332w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 166px"/><img alt="" class="bh ms ow c" width="166" height="540" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Functions using DropFiles function</figcaption></figure><p id="a84b" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">So we set a breakpoint on CreateFile because at each execution, EQNEDT32.exe starts by CreateFile onstaticcache.dat.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*IIdwPvqg7vJSZPTb 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*IIdwPvqg7vJSZPTb 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*IIdwPvqg7vJSZPTb 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*IIdwPvqg7vJSZPTb 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*IIdwPvqg7vJSZPTb 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*IIdwPvqg7vJSZPTb 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IIdwPvqg7vJSZPTb 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*IIdwPvqg7vJSZPTb 640w, https://miro.medium.com/v2/resize:fit:720/0*IIdwPvqg7vJSZPTb 720w, https://miro.medium.com/v2/resize:fit:750/0*IIdwPvqg7vJSZPTb 750w, https://miro.medium.com/v2/resize:fit:786/0*IIdwPvqg7vJSZPTb 786w, https://miro.medium.com/v2/resize:fit:828/0*IIdwPvqg7vJSZPTb 828w, https://miro.medium.com/v2/resize:fit:1100/0*IIdwPvqg7vJSZPTb 1100w, https://miro.medium.com/v2/resize:fit:1400/0*IIdwPvqg7vJSZPTb 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="104" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Breakpoint to createfile</figcaption></figure><p id="b0a0" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And we return at the user code to set a new breakpoint to check the static analysis.</p><p id="1ef8" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">So we set a breakpoint at 0040159A when DropFiles is called.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*mPqUIrP66QLkZuGa 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*mPqUIrP66QLkZuGa 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*mPqUIrP66QLkZuGa 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*mPqUIrP66QLkZuGa 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*mPqUIrP66QLkZuGa 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*mPqUIrP66QLkZuGa 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mPqUIrP66QLkZuGa 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*mPqUIrP66QLkZuGa 640w, https://miro.medium.com/v2/resize:fit:720/0*mPqUIrP66QLkZuGa 720w, https://miro.medium.com/v2/resize:fit:750/0*mPqUIrP66QLkZuGa 750w, https://miro.medium.com/v2/resize:fit:786/0*mPqUIrP66QLkZuGa 786w, https://miro.medium.com/v2/resize:fit:828/0*mPqUIrP66QLkZuGa 828w, https://miro.medium.com/v2/resize:fit:1100/0*mPqUIrP66QLkZuGa 1100w, https://miro.medium.com/v2/resize:fit:1400/0*mPqUIrP66QLkZuGa 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="31" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Breakpoint to the first call of DropFiles</figcaption></figure><p id="eb91" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And now we can analyse the second loop of decryption.</p><p id="3d42" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">The first step is the initialization of the decryption function.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok rx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Cof9a7EXfLVLiY7b 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Cof9a7EXfLVLiY7b 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Cof9a7EXfLVLiY7b 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Cof9a7EXfLVLiY7b 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Cof9a7EXfLVLiY7b 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Cof9a7EXfLVLiY7b 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Cof9a7EXfLVLiY7b 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Cof9a7EXfLVLiY7b 640w, https://miro.medium.com/v2/resize:fit:720/0*Cof9a7EXfLVLiY7b 720w, https://miro.medium.com/v2/resize:fit:750/0*Cof9a7EXfLVLiY7b 750w, https://miro.medium.com/v2/resize:fit:786/0*Cof9a7EXfLVLiY7b 786w, https://miro.medium.com/v2/resize:fit:828/0*Cof9a7EXfLVLiY7b 828w, https://miro.medium.com/v2/resize:fit:1100/0*Cof9a7EXfLVLiY7b 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Cof9a7EXfLVLiY7b 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="225" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Set for the second loop encryption</figcaption></figure><p id="16eb" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And after we find the xor and store the result in esi+eax.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok ry"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*o89HisxMXD7MXiDm 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*o89HisxMXD7MXiDm 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*o89HisxMXD7MXiDm 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*o89HisxMXD7MXiDm 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*o89HisxMXD7MXiDm 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*o89HisxMXD7MXiDm 1100w, https://miro.medium.com/v2/resize:fit:1358/format:webp/0*o89HisxMXD7MXiDm 1358w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 679px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*o89HisxMXD7MXiDm 640w, https://miro.medium.com/v2/resize:fit:720/0*o89HisxMXD7MXiDm 720w, https://miro.medium.com/v2/resize:fit:750/0*o89HisxMXD7MXiDm 750w, https://miro.medium.com/v2/resize:fit:786/0*o89HisxMXD7MXiDm 786w, https://miro.medium.com/v2/resize:fit:828/0*o89HisxMXD7MXiDm 828w, https://miro.medium.com/v2/resize:fit:1100/0*o89HisxMXD7MXiDm 1100w, https://miro.medium.com/v2/resize:fit:1358/0*o89HisxMXD7MXiDm 1358w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 679px"/><img alt="" class="bh ms ow c" width="679" height="121" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Decryption loop</figcaption></figure><p id="7b1e" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">In the first step of the decryption loop, the result is written to 411BC0 in the address space of EQNEDT32.exe.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok rz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*v_yQA_1fBa_lnJoM 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*v_yQA_1fBa_lnJoM 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*v_yQA_1fBa_lnJoM 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*v_yQA_1fBa_lnJoM 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*v_yQA_1fBa_lnJoM 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*v_yQA_1fBa_lnJoM 1100w, https://miro.medium.com/v2/resize:fit:1052/format:webp/0*v_yQA_1fBa_lnJoM 1052w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 526px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*v_yQA_1fBa_lnJoM 640w, https://miro.medium.com/v2/resize:fit:720/0*v_yQA_1fBa_lnJoM 720w, https://miro.medium.com/v2/resize:fit:750/0*v_yQA_1fBa_lnJoM 750w, https://miro.medium.com/v2/resize:fit:786/0*v_yQA_1fBa_lnJoM 786w, https://miro.medium.com/v2/resize:fit:828/0*v_yQA_1fBa_lnJoM 828w, https://miro.medium.com/v2/resize:fit:1100/0*v_yQA_1fBa_lnJoM 1100w, https://miro.medium.com/v2/resize:fit:1052/0*v_yQA_1fBa_lnJoM 1052w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 526px"/><img alt="" class="bh ms ow c" width="526" height="24" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Before the decryption</figcaption></figure><p id="67a9" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">After tree loops, we obtains the header of zlib compressed object.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok sa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*DwL9yQvCwNl3ROPO 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*DwL9yQvCwNl3ROPO 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*DwL9yQvCwNl3ROPO 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*DwL9yQvCwNl3ROPO 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*DwL9yQvCwNl3ROPO 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*DwL9yQvCwNl3ROPO 1100w, https://miro.medium.com/v2/resize:fit:1090/format:webp/0*DwL9yQvCwNl3ROPO 1090w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 545px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*DwL9yQvCwNl3ROPO 640w, https://miro.medium.com/v2/resize:fit:720/0*DwL9yQvCwNl3ROPO 720w, https://miro.medium.com/v2/resize:fit:750/0*DwL9yQvCwNl3ROPO 750w, https://miro.medium.com/v2/resize:fit:786/0*DwL9yQvCwNl3ROPO 786w, https://miro.medium.com/v2/resize:fit:828/0*DwL9yQvCwNl3ROPO 828w, https://miro.medium.com/v2/resize:fit:1100/0*DwL9yQvCwNl3ROPO 1100w, https://miro.medium.com/v2/resize:fit:1090/0*DwL9yQvCwNl3ROPO 1090w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 545px"/><img alt="" class="bh ms ow c" width="545" height="24" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">After the decryption</figcaption></figure><p id="d9f3" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And at the memory page 021E0000, a PE is decompressed.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok sb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*RZNRY50hvuvdYAx0 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*RZNRY50hvuvdYAx0 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*RZNRY50hvuvdYAx0 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*RZNRY50hvuvdYAx0 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*RZNRY50hvuvdYAx0 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*RZNRY50hvuvdYAx0 1100w, https://miro.medium.com/v2/resize:fit:1304/format:webp/0*RZNRY50hvuvdYAx0 1304w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 652px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*RZNRY50hvuvdYAx0 640w, https://miro.medium.com/v2/resize:fit:720/0*RZNRY50hvuvdYAx0 720w, https://miro.medium.com/v2/resize:fit:750/0*RZNRY50hvuvdYAx0 750w, https://miro.medium.com/v2/resize:fit:786/0*RZNRY50hvuvdYAx0 786w, https://miro.medium.com/v2/resize:fit:828/0*RZNRY50hvuvdYAx0 828w, https://miro.medium.com/v2/resize:fit:1100/0*RZNRY50hvuvdYAx0 1100w, https://miro.medium.com/v2/resize:fit:1304/0*RZNRY50hvuvdYAx0 1304w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 652px"/><img alt="" class="bh ms ow c" width="652" height="241" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Page memory allocated to store the dll</figcaption></figure><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok sc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*CsMIkL0uD7AywTxS 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*CsMIkL0uD7AywTxS 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*CsMIkL0uD7AywTxS 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*CsMIkL0uD7AywTxS 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*CsMIkL0uD7AywTxS 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*CsMIkL0uD7AywTxS 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CsMIkL0uD7AywTxS 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*CsMIkL0uD7AywTxS 640w, https://miro.medium.com/v2/resize:fit:720/0*CsMIkL0uD7AywTxS 720w, https://miro.medium.com/v2/resize:fit:750/0*CsMIkL0uD7AywTxS 750w, https://miro.medium.com/v2/resize:fit:786/0*CsMIkL0uD7AywTxS 786w, https://miro.medium.com/v2/resize:fit:828/0*CsMIkL0uD7AywTxS 828w, https://miro.medium.com/v2/resize:fit:1100/0*CsMIkL0uD7AywTxS 1100w, https://miro.medium.com/v2/resize:fit:1400/0*CsMIkL0uD7AywTxS 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="446" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">After decompression</figcaption></figure><p id="757b" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And after the file is created with the following path: L”C:\\Users\\IEUser\\AppData\\Roaming\\Microsoft\\Windows\\Network Shortcuts\\RasTls.dll”</p><p id="6741" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">Stored by ebx.</p><p id="2f7a" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">DropFiles is called a twice to decrypt and decompress the executable file.</p><p id="61c8" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">The offset where store the file is 00434EF8 and the pe decompressed is stored at 025D0020</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok sd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*QpJE4TMOOeyj9ZK1 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*QpJE4TMOOeyj9ZK1 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*QpJE4TMOOeyj9ZK1 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*QpJE4TMOOeyj9ZK1 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*QpJE4TMOOeyj9ZK1 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*QpJE4TMOOeyj9ZK1 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QpJE4TMOOeyj9ZK1 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*QpJE4TMOOeyj9ZK1 640w, https://miro.medium.com/v2/resize:fit:720/0*QpJE4TMOOeyj9ZK1 720w, https://miro.medium.com/v2/resize:fit:750/0*QpJE4TMOOeyj9ZK1 750w, https://miro.medium.com/v2/resize:fit:786/0*QpJE4TMOOeyj9ZK1 786w, https://miro.medium.com/v2/resize:fit:828/0*QpJE4TMOOeyj9ZK1 828w, https://miro.medium.com/v2/resize:fit:1100/0*QpJE4TMOOeyj9ZK1 1100w, https://miro.medium.com/v2/resize:fit:1400/0*QpJE4TMOOeyj9ZK1 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="686" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Decryption of the executable dascgosrky.exe</figcaption></figure><p id="4062" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And the path of the new file is : ebx=005DA228 L”C:\\Users\\IEUser\\AppData\\Roaming\\Microsoft\\Windows\\Network Shortcuts\\dascgosrky.exe”</p><p id="f9f3" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">So we have two files in networks shortcuts of Windows.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok se"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*iRfSKvRRYY5h96uv 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*iRfSKvRRYY5h96uv 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*iRfSKvRRYY5h96uv 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*iRfSKvRRYY5h96uv 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*iRfSKvRRYY5h96uv 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*iRfSKvRRYY5h96uv 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iRfSKvRRYY5h96uv 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*iRfSKvRRYY5h96uv 640w, https://miro.medium.com/v2/resize:fit:720/0*iRfSKvRRYY5h96uv 720w, https://miro.medium.com/v2/resize:fit:750/0*iRfSKvRRYY5h96uv 750w, https://miro.medium.com/v2/resize:fit:786/0*iRfSKvRRYY5h96uv 786w, https://miro.medium.com/v2/resize:fit:828/0*iRfSKvRRYY5h96uv 828w, https://miro.medium.com/v2/resize:fit:1100/0*iRfSKvRRYY5h96uv 1100w, https://miro.medium.com/v2/resize:fit:1400/0*iRfSKvRRYY5h96uv 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="101" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Files drops on disk</figcaption></figure><h1 id="e4f3" class="pb pc ic bf pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px py bk">dll hijacking</h1><p id="0b60" class="pw-post-body-paragraph nl nm ic nn b no pz nq nr ns qa nu nv nw qb ny nz oa qc oc od oe qd og oh oi hv bk">Dascgosrky.exe is a legit and trusted software develop by Symantec.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok sf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*_UlmQfFwPW9TmjZ_ 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*_UlmQfFwPW9TmjZ_ 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*_UlmQfFwPW9TmjZ_ 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*_UlmQfFwPW9TmjZ_ 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*_UlmQfFwPW9TmjZ_ 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*_UlmQfFwPW9TmjZ_ 1100w, https://miro.medium.com/v2/resize:fit:836/format:webp/0*_UlmQfFwPW9TmjZ_ 836w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 418px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*_UlmQfFwPW9TmjZ_ 640w, https://miro.medium.com/v2/resize:fit:720/0*_UlmQfFwPW9TmjZ_ 720w, https://miro.medium.com/v2/resize:fit:750/0*_UlmQfFwPW9TmjZ_ 750w, https://miro.medium.com/v2/resize:fit:786/0*_UlmQfFwPW9TmjZ_ 786w, https://miro.medium.com/v2/resize:fit:828/0*_UlmQfFwPW9TmjZ_ 828w, https://miro.medium.com/v2/resize:fit:1100/0*_UlmQfFwPW9TmjZ_ 1100w, https://miro.medium.com/v2/resize:fit:836/0*_UlmQfFwPW9TmjZ_ 836w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 418px"/><img alt="" class="bh ms ow c" width="418" height="534" loading="lazy" role="presentation"/></picture></div></figure><p id="a082" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">To load the library RasTls.dll, the executable calls LoadLibrary and GetProcaddress in sub_401940 to execute the malicious functions</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok sg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*OfrLEq9IeAVFLU3P 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*OfrLEq9IeAVFLU3P 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*OfrLEq9IeAVFLU3P 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*OfrLEq9IeAVFLU3P 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*OfrLEq9IeAVFLU3P 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*OfrLEq9IeAVFLU3P 1100w, https://miro.medium.com/v2/resize:fit:988/format:webp/0*OfrLEq9IeAVFLU3P 988w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 494px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*OfrLEq9IeAVFLU3P 640w, https://miro.medium.com/v2/resize:fit:720/0*OfrLEq9IeAVFLU3P 720w, https://miro.medium.com/v2/resize:fit:750/0*OfrLEq9IeAVFLU3P 750w, https://miro.medium.com/v2/resize:fit:786/0*OfrLEq9IeAVFLU3P 786w, https://miro.medium.com/v2/resize:fit:828/0*OfrLEq9IeAVFLU3P 828w, https://miro.medium.com/v2/resize:fit:1100/0*OfrLEq9IeAVFLU3P 1100w, https://miro.medium.com/v2/resize:fit:988/0*OfrLEq9IeAVFLU3P 988w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 494px"/><img alt="" class="bh ms ow c" width="494" height="740" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Dascgosrky.exe loading the malicious</figcaption></figure><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok sh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*NuyGFynu86jp1zd0 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*NuyGFynu86jp1zd0 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*NuyGFynu86jp1zd0 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*NuyGFynu86jp1zd0 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*NuyGFynu86jp1zd0 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*NuyGFynu86jp1zd0 1100w, https://miro.medium.com/v2/resize:fit:808/format:webp/0*NuyGFynu86jp1zd0 808w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 404px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*NuyGFynu86jp1zd0 640w, https://miro.medium.com/v2/resize:fit:720/0*NuyGFynu86jp1zd0 720w, https://miro.medium.com/v2/resize:fit:750/0*NuyGFynu86jp1zd0 750w, https://miro.medium.com/v2/resize:fit:786/0*NuyGFynu86jp1zd0 786w, https://miro.medium.com/v2/resize:fit:828/0*NuyGFynu86jp1zd0 828w, https://miro.medium.com/v2/resize:fit:1100/0*NuyGFynu86jp1zd0 1100w, https://miro.medium.com/v2/resize:fit:808/0*NuyGFynu86jp1zd0 808w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 404px"/><img alt="" class="bh ms ow c" width="404" height="708" loading="lazy" role="presentation"/></picture></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">The original file</figcaption></figure><p id="556e" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">If we check the exports in IDA, we just have a dllentrypoint. The dll is executed like this.</p><p id="6d58" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">We’ll analyse the RAT in the second Part.</p><h1 id="ca69" class="pb pc ic bf pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px py bk">Infrastructure of Attackers</h1><p id="8ba0" class="pw-post-body-paragraph nl nm ic nn b no pz nq nr ns qa nu nv nw qb ny nz oa qc oc od oe qd og oh oi hv bk">The domain contacted is wouderfulu.impresstravel.ga and this domain resolved on 192.99.181.14.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok si"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*bWs378Qw7-Rdrrgt 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*bWs378Qw7-Rdrrgt 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*bWs378Qw7-Rdrrgt 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*bWs378Qw7-Rdrrgt 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*bWs378Qw7-Rdrrgt 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*bWs378Qw7-Rdrrgt 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bWs378Qw7-Rdrrgt 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*bWs378Qw7-Rdrrgt 640w, https://miro.medium.com/v2/resize:fit:720/0*bWs378Qw7-Rdrrgt 720w, https://miro.medium.com/v2/resize:fit:750/0*bWs378Qw7-Rdrrgt 750w, https://miro.medium.com/v2/resize:fit:786/0*bWs378Qw7-Rdrrgt 786w, https://miro.medium.com/v2/resize:fit:828/0*bWs378Qw7-Rdrrgt 828w, https://miro.medium.com/v2/resize:fit:1100/0*bWs378Qw7-Rdrrgt 1100w, https://miro.medium.com/v2/resize:fit:1400/0*bWs378Qw7-Rdrrgt 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="454" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Domain wouderfulu.impresstravel.ga</figcaption></figure><p id="cf26" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">This IP has differents domains found with PassiveTotal and theses domains is recorded in the IP 176.223.165.122.</p><p id="ebd4" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">Many domain names is used for Vietnameses people.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot gs ou bh ov"><div class="oj ok sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Bwrh_O_Sybq67s6w 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Bwrh_O_Sybq67s6w 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Bwrh_O_Sybq67s6w 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Bwrh_O_Sybq67s6w 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Bwrh_O_Sybq67s6w 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Bwrh_O_Sybq67s6w 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Bwrh_O_Sybq67s6w 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Bwrh_O_Sybq67s6w 640w, https://miro.medium.com/v2/resize:fit:720/0*Bwrh_O_Sybq67s6w 720w, https://miro.medium.com/v2/resize:fit:750/0*Bwrh_O_Sybq67s6w 750w, https://miro.medium.com/v2/resize:fit:786/0*Bwrh_O_Sybq67s6w 786w, https://miro.medium.com/v2/resize:fit:828/0*Bwrh_O_Sybq67s6w 828w, https://miro.medium.com/v2/resize:fit:1100/0*Bwrh_O_Sybq67s6w 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Bwrh_O_Sybq67s6w 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ms ow c" width="700" height="345" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ox go oy oj ok oz pa bf b bg z cm">Expansion of domains</figcaption></figure><p id="9d8c" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">There are two domains really interesting:</p><p id="20ba" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">Halong.dulichculao.com is already used in the campaign targeting Vietnameses organizations.</p><p id="8587" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk"><a class="ag jw" href="https://www.fortinet.com/blog/threat-research/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations.html" rel="noopener ugc nofollow" target="_blank">https://www.fortinet.com/blog/threat-research/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations.html</a></p><p id="1a51" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">For Fortinet is the Chinese hacking group 1937CN.</p><p id="29e3" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">If we compare the TTPs, it’s really similar. They used RTFs to make the intrusion and dll hijacking to load the real payload.</p><p id="4c39" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">And the name of domains are really similar between the campaings.</p><p id="b020" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">The second one is:</p><p id="05c9" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">Cat.toonganuh.com is a subdomain of tooganuh.com recorded by <a class="ag jw" href="mailto:florence1972@scryptmail.com" rel="noopener ugc nofollow" target="_blank">florence1972@scryptmail.com</a></p><h1 id="21cf" class="pb pc ic bf pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px py bk">Conclusion</h1><p id="cf14" class="pw-post-body-paragraph nl nm ic nn b no pz nq nr ns qa nu nv nw qb ny nz oa qc oc od oe qd og oh oi hv bk">The Chinese hacking group 1937CN continues to target Vietnam officials with the same TTPs with a refreshing on the tools used. The toolset used by this group to create RTF malicious document has the same properpy of the SideWinder.</p><p id="a92b" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">I want to thank my buddies on “Zone de Confort”. It’s with this dreamteam, I can finalize correctly this analyses.</p><p id="2d66" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">In the second part, we analyze the RAT using in this campaign. Or if another reverse can make that, I’ll paid a beer ;)</p><h1 id="370f" class="pb pc ic bf pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px py bk">IOCs for the paper:</h1><p id="b908" class="pw-post-body-paragraph nl nm ic nn b no pz nq nr ns qa nu nv nw qb ny nz oa qc oc od oe qd og oh oi hv bk">domains:<br/>dn.dulichbiendao.org<br/>gateway.vietbaotinmoi.com</p><p id="f150" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">web.thoitietvietnam.org<br/>hn.dulichbiendao.org<br/>halong.dulichculao.com<br/>cat.toonganuh.com<br/>new.sggpnews.com<br/>dulichculao.com<br/>coco.sodexoa.com.<br/>thoitiet.malware-sinkhole.net<br/>wouderfulu.impresstravel.ga<br/>toonganuh.com<br/>coco.sodexoa.com</p><p id="8880" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">IPs:<br/>192.99.181.14<br/>176.223.165.122</p><p id="0081" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">RTFs:</p><p id="6781" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">42162c495e835cdf28670661a53d47d12255d9c791c1c5653673b25fb587ffed</p><p id="6350" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">8.t:</p><p id="4afb" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">2c60d4312e4416745e56048ee35e694a79e1bc77e7e4d0b5811e64c84a72d2d7</p><p id="60ca" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">PE:</p><p id="00f3" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">f9ebf6aeb3f0fb0c29bd8f3d652476cd1fe8bd9a0c11cb15c43de33bbce0bf68 (exe)</p><p id="43f5" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">9f5da7524817736cd85d87dae93fdbe478385baac1c0aa3102b6ad50d7e5e368 (dll)</p><h1 id="938a" class="pb pc ic bf pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px py bk">Update:</h1><p id="132a" class="pw-post-body-paragraph nl nm ic nn b no pz nq nr ns qa nu nv nw qb ny nz oa qc oc od oe qd og oh oi hv bk">The payload is PlugX. Thanks to Gabor Szappanos <a class="ag jw" href="https://twitter.com/GaborSzappanos/status/1024622354582908928" rel="noopener ugc nofollow" target="_blank">https://twitter.com/GaborSzappanos/status/1024622354582908928</a></p><p id="0713" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">Update IOCs:</p><p id="990f" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">597c0c6f397eefb06155abdf5aa9a7476c977c44ef8bd9575b01359e96273486 59.rtf<br/>11f38b6a69978dad95c9b1479db9a8729ca57329855998bd41befc364657d654 RasTls.dll<br/>f9ebf6aeb3f0fb0c29bd8f3d652476cd1fe8bd9a0c11cb15c43de33bbce0bf68 RasTls.exe</p><p id="3ff0" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">b70069e1c8e829bfd7090ba3dfbf0e256fc7dfcefc6acafb3b53abcf2caa2253 b7.rtf<br/>77361b1ca09d6857d68cea052a0bb857e03d776d3e1943897315a80a19f20fc2 spoolsver.exe<br/>9fba998ab2c1b7fec39da9817b27768ba7892c0613c4be7c525989161981d2e2 vsodscpl.dll</p><p id="81b9" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">9d239ddd4c925d14e00b5a95827e9191bfda7d59858f141f6f5dcc52329838f0 9d.rtf<br/>087d8bee1db61273a7cd533d52b63265d3a8a8b897526d7849c48bcdba4b22ec RasTls.dll<br/>f9ebf6aeb3f0fb0c29bd8f3d652476cd1fe8bd9a0c11cb15c43de33bbce0bf68 RasTls.exe</p><p id="78ef" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">332aa26d719a20f3a26b2b00a9ca5d2e090b33f5070b057f4950d4f088201ab9 rtf</p><p id="b4e8" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">93aa353320a8e27923880401a4a0f3760374b4d17dcd709d351e612d589b969d vsodscpl.dll</p><p id="1cc5" class="pw-post-body-paragraph nl nm ic nn b no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi hv bk">77361b1ca09d6857d68cea052a0bb857e03d776d3e1943897315a80a19f20fc2 ScnCfg.exe</p></div></div></div></div></section></div></div></article></div><div class="ab dn"><div class="du bh hh hi hj hk"><div class="sk sl ab jz"><div class="sm ab"><a class="sn ay an ap" href="https://medium.com/tag/security?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><div class="so gs ei sp hm sq sr bf b bg z bk ss">Security</div></a></div><div class="sm ab"><a class="sn ay an ap" href="https://medium.com/tag/malware-analysis?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><div class="so gs ei sp hm sq sr bf b bg z bk ss">Malware Analysis</div></a></div><div class="sm ab"><a class="sn ay an ap" href="https://medium.com/tag/threat-intelligence?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><div class="so gs ei sp hm sq sr bf b bg z bk ss">Threat Intelligence</div></a></div></div></div></div><div class="l"></div><footer class="st su sv sw sx ab q sy sz c"><div class="l ae"><div class="ab dn"><div class="du bh hh hi hj hk"><div class="ab ea ta"><div class="ab q li"><div class="tb l"><span class="l tc td te e d"><div class="ab q li lj"><div class="pw-multi-vote-icon gs lk ll lm ln"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Facb3b9d8b80a&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---footer_actions--acb3b9d8b80a---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="lo ap lp lq lr ls an lt lu lv ln"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lw lx ly lz ma mb mc"><p class="bf b ff z cm"><span class="md">--</span></p></div></div></span><span class="l h g f tf tg"><div class="ab q li lj"><div class="pw-multi-vote-icon gs lk ll lm ln"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Facb3b9d8b80a&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---footer_actions--acb3b9d8b80a---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="lo ap lp lq lr ls an lt lu lv ln"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lw lx ly lz ma mb mc"><p class="bf b ff z cm"><span class="md">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ap lo mg mh ab q gt mi mj" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="mf"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b bg z cm"><span class="pw-responses-count me mf">4</span></p></button></div></div></div></div><div class="ab q"><div class="th l ce"><div><div class="bm" aria-hidden="false"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Facb3b9d8b80a&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a&amp;source=---footer_actions--acb3b9d8b80a---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="cm ml" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="th l ce"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="ag gt ai aj ak al am mt ao ap aq gg mu mv mj mw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="ti l"><div class="ab dn"><div class="du bh hh hi hj hk"><div class="ab tj tk tl jy jx"><div class="tm tn to tp tq tr ts tt tu tv ab ea"><div class="h k"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--acb3b9d8b80a---------------------------------------"><div class="l gs"><img alt="Sebdraven" class="l gm by jk jj ei" src="https://miro.medium.com/v2/resize:fill:96:96/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="48" height="48" loading="lazy"/><div class="gz by l jk jj ha n ay tw"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--acb3b9d8b80a---------------------------------------"><div class="l gs"><img alt="Sebdraven" class="l gm by tx ty ei" src="https://miro.medium.com/v2/resize:fill:128:128/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="64" height="64" loading="lazy"/><div class="gz by l tx ty ha n ay tw"></div></div></a></div><div class="j i d tz ce"><div class="ab"><span><button class="bf b bg z ua so ub uc ud ue uf ge gf ug uh ui gj gk gl gm bm gn go">Follow</button></span></div></div></div><div class="ab cg dm"><div class="uj uk ul um un l"><a class="ag ah ai ak al am an ao ap aq ar as at au ab q" rel="noopener follow" href="/?source=post_page---post_author_info--acb3b9d8b80a---------------------------------------"><h2 class="pw-author-name bf up uq ur us ut uu uv nw uw ux oa uy uz oe va vb bk"><span class="hv uo">Written by <!-- -->Sebdraven</span></h2></a><div class="sm ab ji"><div class="l ce"><span class="pw-follower-count bf b bg z cm"><a class="ag ah ai aj ak al am an ao ap aq ar as jt" rel="noopener follow" href="/followers?source=post_page---post_author_info--acb3b9d8b80a---------------------------------------">543 Followers</a></span></div><div class="bf b bg z cm ab vc"><span class="ju l" aria-hidden="true"><span class="bf b bg z cm">·</span></span><a class="ag ah ai aj ak al am an ao ap aq ar as jt" rel="noopener follow" href="/following?source=post_page---post_author_info--acb3b9d8b80a---------------------------------------">18 Following</a></div></div><div class="vd l"><p class="bf b bg z bk"><span class="hv">Malwarist,Threat Huntist and pythonist / core dev of #yeti/ member of @ProjectHoneynet / co-organizer #BotConf / researcher</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ua so ub uc ud ue uf ge gf ug uh ui gj gk gl gm bm gn go">Follow</button></span></div></div></div></div></div></div><div class="ve vf vg vh vi l"><div class="vj bh r ti"></div><div class="ab dn"><div class="du bh hh hi hj hk"><div class="ab q ea"><h2 class="bf up pe pg ph pi pk pl pm po pp pq ps pt pu pw px bk">Responses (<!-- -->4<!-- -->)</h2><div class="ab vk"><div><div class="bm" aria-hidden="false"><a class="vl vm" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--acb3b9d8b80a---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="vn vo vp vq vr vs vt l"></div><div class="vu l"><button class="bf b bg z bk so vv vw vx ml mi uf ge gf gg vy vz wa gj wb wc wd we wf gk gl gm bm gn go">See all responses</button></div></div></div></div><div class="wg wh wi wj wk l bx"><div class="h k j"><div class="vj bh wl wm"></div><div class="ab dn"><div class="du bh hh hi hj hk"><div class="cf ab li jz"><div class="wn wo l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://help.medium.com/hc/en-us?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Help</p></a></div><div class="wn wo l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.statuspage.io/?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Status</p></a></div><div class="wn wo l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.com/about?autoplay=1&amp;source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">About</p></a></div><div class="wn wo l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Careers</p></a></div><div class="wn wo l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bf b ff z cm">Press</p></a></div><div class="wn wo l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://blog.medium.com/?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Blog</p></a></div><div class="wn wo l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Privacy</p></a></div><div class="wn wo l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Rules</p></a></div><div class="wn wo l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Terms</p></a></div><div class="wn l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://speechify.com/medium?source=post_page-----acb3b9d8b80a---------------------------------------" rel="noopener follow"><p class="bf b ff z cm">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250327-082102-9e6cdffbd1"</script><script>window.__GRAPHQL_URI__ = "https://sebdraven.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-acb3b9d8b80a","user-11d98531eebe"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"pubFeaturingPostPageLabelEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"USER","id":"11d98531eebe","explicit":true},"viewerIsBot":false},"debug":{"requestId":"3d42ebdb-e0e3-4fff-89dc-bb2d07453797","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-128fcb47361ef69b58516c4b9f2afd2a-c0efd11015348c77-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fsebdraven.medium.com\u002Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a","host":"sebdraven.medium.com","hostname":"sebdraven.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250327-082102-9e6cdffbd1","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250327-082102-9e6cdffbd1","commit":"9e6cdffbd1b84db998e42499a24b943d08c46817"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"sebdraven.medium.com\"})":null,"postResult({\"id\":\"acb3b9d8b80a\"})":{"__ref":"Post:acb3b9d8b80a"}},"LinkedAccounts:11d98531eebe":{"__typename":"LinkedAccounts","mastodon":null,"id":"11d98531eebe"},"Membership:053eb905-f962-4628-8989-2a2e6e40254f":{"__typename":"Membership","tier":"MEMBER","id":"053eb905-f962-4628-8989-2a2e6e40254f"},"User:11d98531eebe":{"__typename":"User","id":"11d98531eebe","linkedAccounts":{"__ref":"LinkedAccounts:11d98531eebe"},"isSuspended":false,"name":"Sebdraven","imageId":"1*ycwwStTvoVxriAE2No5ipQ.jpeg","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"sebdraven.medium.com"}},"hasSubdomain":true,"username":"sebdraven","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":543,"followingCount":9,"collectionFollowingCount":9},"bio":"Malwarist,Threat Huntist and pythonist \u002F core dev of #yeti\u002F member of @ProjectHoneynet \u002F co-organizer #BotConf \u002F researcher","membership":{"__ref":"Membership:053eb905-f962-4628-8989-2a2e6e40254f"},"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:11d98531eebe-viewerId:lo_e418b373fc33"},"twitterScreenName":"Sebdraven"},"Paragraph:9bec290a37ee_0":{"__typename":"Paragraph","id":"9bec290a37ee_0","name":"5e17","type":"H3","href":null,"layout":null,"metadata":null,"text":"Malicious document targets Vietnamese officials","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_1":{"__typename":"Paragraph","id":"9bec290a37ee_1","name":"ad8e","type":"P","href":null,"layout":null,"metadata":null,"text":"After our investigation of APT SideWinder, we’ve done a yara rule for hunting RTF document exploiting the CVE-2017–11882.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_2":{"__typename":"Paragraph","id":"9bec290a37ee_2","name":"73f1","type":"P","href":null,"layout":null,"metadata":null,"text":"We found a document written in Vietnamese dealing with a summary about differents projects in the district Hải Châu of Đà Nẵng.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*UjwuTDu6t3I4qJHq":{"__typename":"ImageMetadata","id":"0*UjwuTDu6t3I4qJHq","originalHeight":840,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_3":{"__typename":"Paragraph","id":"9bec290a37ee_3","name":"2b76","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*UjwuTDu6t3I4qJHq"},"text":"RTF document","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_4":{"__typename":"Paragraph","id":"9bec290a37ee_4","name":"448a","type":"P","href":null,"layout":null,"metadata":null,"text":"In this article, we’ll detail the infection chains and the infrastructures of the attackers and the TTPs of this campaign.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_5":{"__typename":"Paragraph","id":"9bec290a37ee_5","name":"1ee3","type":"P","href":null,"layout":null,"metadata":null,"text":"The infrastructures and TTPs during this campaign seem to the Chinese hacking group 1937CN.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_6":{"__typename":"Paragraph","id":"9bec290a37ee_6","name":"c43a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Infection chains","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_7":{"__typename":"Paragraph","id":"9bec290a37ee_7","name":"80da","type":"P","href":null,"layout":null,"metadata":null,"text":"Joe sandbox has a good representation of the behaviour of the infection.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*BeY1Ys_G6fA5for1":{"__typename":"ImageMetadata","id":"0*BeY1Ys_G6fA5for1","originalHeight":928,"originalWidth":1273,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_8":{"__typename":"Paragraph","id":"9bec290a37ee_8","name":"d073","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*BeY1Ys_G6fA5for1"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_9":{"__typename":"Paragraph","id":"9bec290a37ee_9","name":"1c30","type":"P","href":null,"layout":null,"metadata":null,"text":"This rtf document is really malicious and it exploits the equation vulnerability to write two files in the system:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_10":{"__typename":"Paragraph","id":"9bec290a37ee_10","name":"86c8","type":"OLI","href":null,"layout":null,"metadata":null,"text":"A dll named RasTls.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_11":{"__typename":"Paragraph","id":"9bec290a37ee_11","name":"12d5","type":"OLI","href":null,"layout":null,"metadata":null,"text":"A executable file named dascgosrky.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_12":{"__typename":"Paragraph","id":"9bec290a37ee_12","name":"c25c","type":"P","href":null,"layout":null,"metadata":null,"text":"This document is interesting to analyze so let’go !","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_13":{"__typename":"Paragraph","id":"9bec290a37ee_13","name":"8c93","type":"H3","href":null,"layout":null,"metadata":null,"text":"RTF analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_14":{"__typename":"Paragraph","id":"9bec290a37ee_14","name":"9bbc","type":"P","href":null,"layout":null,"metadata":null,"text":"With rtfobj, we found three ole objects in the document:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_15":{"__typename":"Paragraph","id":"9bec290a37ee_15","name":"f30b","type":"P","href":null,"layout":null,"metadata":null,"text":"two non well formed ole object and a third named package ole object.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*z0se9_iRLZkEJWxH":{"__typename":"ImageMetadata","id":"0*z0se9_iRLZkEJWxH","originalHeight":313,"originalWidth":900,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_16":{"__typename":"Paragraph","id":"9bec290a37ee_16","name":"5831","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*z0se9_iRLZkEJWxH"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_17":{"__typename":"Paragraph","id":"9bec290a37ee_17","name":"b562","type":"P","href":null,"layout":null,"metadata":null,"text":"The package ole object is used to write a file in the disk when the document is opened at the destination described by the ole object.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_18":{"__typename":"Paragraph","id":"9bec290a37ee_18","name":"e3d4","type":"P","href":null,"layout":null,"metadata":null,"text":"That’s why, there is a path and a name in the ole object.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*llpUExFIbs-M60xs":{"__typename":"ImageMetadata","id":"0*llpUExFIbs-M60xs","originalHeight":661,"originalWidth":774,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_19":{"__typename":"Paragraph","id":"9bec290a37ee_19","name":"09f5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*llpUExFIbs-M60xs"},"text":"Package OLE Object","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_20":{"__typename":"Paragraph","id":"9bec290a37ee_20","name":"539c","type":"P","href":null,"layout":null,"metadata":null,"text":"This technique is used to execute code like sct file to download an executable on the operating system. McAfee labs has detailed all this stuff with sct file: https:\u002F\u002Fsecuringtomorrow.mcafee.com\u002Fmcafee-labs\u002Fdropping-files-temp-folder-raises-security-concerns\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":159,"end":259,"href":"https:\u002F\u002Fsecuringtomorrow.mcafee.com\u002Fmcafee-labs\u002Fdropping-files-temp-folder-raises-security-concerns\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_21":{"__typename":"Paragraph","id":"9bec290a37ee_21","name":"32ad","type":"P","href":null,"layout":null,"metadata":null,"text":"Many attackers use it in the wild because it’ very easy to use and it’ supported by the office software with RTF files.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_22":{"__typename":"Paragraph","id":"9bec290a37ee_22","name":"6b70","type":"P","href":null,"layout":null,"metadata":null,"text":"So, in our case, a file named 8.t is dropped on %TMP% folder.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_23":{"__typename":"Paragraph","id":"9bec290a37ee_23","name":"9dfc","type":"P","href":null,"layout":null,"metadata":null,"text":"If we check it, it’s clearly encrypted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*4WjryYG3SbumYg8i":{"__typename":"ImageMetadata","id":"0*4WjryYG3SbumYg8i","originalHeight":963,"originalWidth":720,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_24":{"__typename":"Paragraph","id":"9bec290a37ee_24","name":"4100","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*4WjryYG3SbumYg8i"},"text":"8.t encrypted","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_25":{"__typename":"Paragraph","id":"9bec290a37ee_25","name":"bd02","type":"P","href":null,"layout":null,"metadata":null,"text":"The others object ole seem to the exploit of CVE-2017–11882.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*o_6PY8at9KPdbiiG":{"__typename":"ImageMetadata","id":"0*o_6PY8at9KPdbiiG","originalHeight":882,"originalWidth":723,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_26":{"__typename":"Paragraph","id":"9bec290a37ee_26","name":"dcb3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*o_6PY8at9KPdbiiG"},"text":"Equation Ole Object","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_27":{"__typename":"Paragraph","id":"9bec290a37ee_27","name":"2729","type":"P","href":null,"layout":null,"metadata":null,"text":"At the end of the object ole, we have differents API functions to make a runPE.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_28":{"__typename":"Paragraph","id":"9bec290a37ee_28","name":"b4da","type":"P","href":null,"layout":null,"metadata":null,"text":"Another interesting thing is this string at the begin of the object: 7e079a2524fa63a55fbcfe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*GyysuwepHVVQxfEc":{"__typename":"ImageMetadata","id":"0*GyysuwepHVVQxfEc","originalHeight":40,"originalWidth":791,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_29":{"__typename":"Paragraph","id":"9bec290a37ee_29","name":"8806","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*GyysuwepHVVQxfEc"},"text":"String found in many exploits of CVE-2017–11882","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_30":{"__typename":"Paragraph","id":"9bec290a37ee_30","name":"9d68","type":"P","href":null,"layout":null,"metadata":null,"text":"We have the same string used by APT SideWinder in the equation object ole.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_31":{"__typename":"Paragraph","id":"9bec290a37ee_31","name":"cd30","type":"P","href":null,"layout":null,"metadata":null,"text":"It’s the same toolset to create the malicious document.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_32":{"__typename":"Paragraph","id":"9bec290a37ee_32","name":"d2e2","type":"P","href":null,"layout":null,"metadata":null,"text":"So now, we have to debug the malicious document to find how the file 8.t is used and find this runPE.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_33":{"__typename":"Paragraph","id":"9bec290a37ee_33","name":"feb3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Debugging of the shellcode","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_34":{"__typename":"Paragraph","id":"9bec290a37ee_34","name":"6872","type":"P","href":null,"layout":null,"metadata":null,"text":"At the start of the analysis, we think the process EQNEDT32.exe is created by Winword.exe using the function CreateProcess. So we decided to set a breakpoint at the call of his function.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_35":{"__typename":"Paragraph","id":"9bec290a37ee_35","name":"3da9","type":"P","href":null,"layout":null,"metadata":null,"text":"But EQNEDT32.exe is invoked by Winword.exe using COM Object. It’s not CreateProcess that used and Winword.exe is not the parent process of EQNEDT32.exe. So we have to attach the debugger when EQNEDT32.exe is launched.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_36":{"__typename":"Paragraph","id":"9bec290a37ee_36","name":"a7dd","type":"P","href":null,"layout":null,"metadata":null,"text":"For that, we used a technique named Image File Execution Options that was documented by Microsoft. https:\u002F\u002Fblogs.msdn.microsoft.com\u002Fmithuns\u002F2010\u002F03\u002F24\u002Fimage-file-execution-options-ifeo\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":99,"end":185,"href":"https:\u002F\u002Fblogs.msdn.microsoft.com\u002Fmithuns\u002F2010\u002F03\u002F24\u002Fimage-file-execution-options-ifeo\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_37":{"__typename":"Paragraph","id":"9bec290a37ee_37","name":"121e","type":"P","href":null,"layout":null,"metadata":null,"text":"We create a key EQNEDT32.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*AchzzWF6FLH4L7me":{"__typename":"ImageMetadata","id":"0*AchzzWF6FLH4L7me","originalHeight":175,"originalWidth":227,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_38":{"__typename":"Paragraph","id":"9bec290a37ee_38","name":"d199","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*AchzzWF6FLH4L7me"},"text":"Registry HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_39":{"__typename":"Paragraph","id":"9bec290a37ee_39","name":"95f9","type":"P","href":null,"layout":null,"metadata":null,"text":"And we set a value string for launching the debugger when EQNEDT32.exe is executed and attaching the debugger to the process .","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*T9fAPdGsgF8vJmsY":{"__typename":"ImageMetadata","id":"0*T9fAPdGsgF8vJmsY","originalHeight":79,"originalWidth":883,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_40":{"__typename":"Paragraph","id":"9bec290a37ee_40","name":"4df4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*T9fAPdGsgF8vJmsY"},"text":"Value to set the debuuger when EQNEDT32.exe is executed","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_41":{"__typename":"Paragraph","id":"9bec290a37ee_41","name":"dc51","type":"P","href":null,"layout":null,"metadata":null,"text":"When we open the rtf document, Winword is launched and EQNEDT32.exe also.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*-knWoOBXf2rZYzAv":{"__typename":"ImageMetadata","id":"0*-knWoOBXf2rZYzAv","originalHeight":89,"originalWidth":814,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_42":{"__typename":"Paragraph","id":"9bec290a37ee_42","name":"e3d9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*-knWoOBXf2rZYzAv"},"text":"Winword process","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*zc__yXOamZEOtvMx":{"__typename":"ImageMetadata","id":"0*zc__yXOamZEOtvMx","originalHeight":63,"originalWidth":776,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_43":{"__typename":"Paragraph","id":"9bec290a37ee_43","name":"1179","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*zc__yXOamZEOtvMx"},"text":"EQNEDT32.exe process attached by the debugger","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_44":{"__typename":"Paragraph","id":"9bec290a37ee_44","name":"ec72","type":"P","href":null,"layout":null,"metadata":null,"text":"And the debugger is attached at the entrypoint of EQNEDT32.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*l27hHfCpE1guw2mp":{"__typename":"ImageMetadata","id":"0*l27hHfCpE1guw2mp","originalHeight":56,"originalWidth":466,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_45":{"__typename":"Paragraph","id":"9bec290a37ee_45","name":"62ea","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*l27hHfCpE1guw2mp"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_46":{"__typename":"Paragraph","id":"9bec290a37ee_46","name":"2568","type":"P","href":null,"layout":null,"metadata":null,"text":"We check if it’s 8.t is correctly created in the %TMP% folder.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*p77roZuWiKJIR-1R":{"__typename":"ImageMetadata","id":"0*p77roZuWiKJIR-1R","originalHeight":89,"originalWidth":260,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_47":{"__typename":"Paragraph","id":"9bec290a37ee_47","name":"bab4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*p77roZuWiKJIR-1R"},"text":"8.t dropped on disk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_48":{"__typename":"Paragraph","id":"9bec290a37ee_48","name":"8687","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we set a breakpoint at the createFile to check if the shellcode of the exploit reads the file 8.t.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_49":{"__typename":"Paragraph","id":"9bec290a37ee_49","name":"85f3","type":"P","href":null,"layout":null,"metadata":null,"text":"CreateFile is called at call eqnedt32.41E5EE.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_50":{"__typename":"Paragraph","id":"9bec290a37ee_50","name":"2133","type":"P","href":null,"layout":null,"metadata":null,"text":"The param of the path of file is pushed on the stack push dword ptr ss:[ebp-4].","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*0KxqoNNo4xV3XkJg":{"__typename":"ImageMetadata","id":"0*0KxqoNNo4xV3XkJg","originalHeight":93,"originalWidth":1178,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_51":{"__typename":"Paragraph","id":"9bec290a37ee_51","name":"26bb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*0KxqoNNo4xV3XkJg"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*nKQqfpBSnORnG9Ih":{"__typename":"ImageMetadata","id":"0*nKQqfpBSnORnG9Ih","originalHeight":54,"originalWidth":1139,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_52":{"__typename":"Paragraph","id":"9bec290a37ee_52","name":"fcf1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*nKQqfpBSnORnG9Ih"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_53":{"__typename":"Paragraph","id":"9bec290a37ee_53","name":"5a95","type":"P","href":null,"layout":null,"metadata":null,"text":"The shellcode uses CreateFile to the 8.t in the %TMP% folder","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_54":{"__typename":"Paragraph","id":"9bec290a37ee_54","name":"90f6","type":"P","href":null,"layout":null,"metadata":null,"text":"So now, we can return of the user code at the calling function.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Z69pZnETOuY6cQTE":{"__typename":"ImageMetadata","id":"0*Z69pZnETOuY6cQTE","originalHeight":35,"originalWidth":858,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_55":{"__typename":"Paragraph","id":"9bec290a37ee_55","name":"ea9e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Z69pZnETOuY6cQTE"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_56":{"__typename":"Paragraph","id":"9bec290a37ee_56","name":"5c9c","type":"P","href":null,"layout":null,"metadata":null,"text":"After a step into, we enter in the shellcode, the address space has changed:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Dv2Xdv-5iWaptdeB":{"__typename":"ImageMetadata","id":"0*Dv2Xdv-5iWaptdeB","originalHeight":487,"originalWidth":1332,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_57":{"__typename":"Paragraph","id":"9bec290a37ee_57","name":"2dff","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Dv2Xdv-5iWaptdeB"},"text":"Shellcode of the exploit","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_58":{"__typename":"Paragraph","id":"9bec290a37ee_58","name":"6dd1","type":"P","href":null,"layout":null,"metadata":null,"text":"After CreateFile, GetFileSize is called to have the size of the file","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*sVUaySpk_IqLDEEd":{"__typename":"ImageMetadata","id":"0*sVUaySpk_IqLDEEd","originalHeight":188,"originalWidth":1298,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_59":{"__typename":"Paragraph","id":"9bec290a37ee_59","name":"6f6c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*sVUaySpk_IqLDEEd"},"text":"Get the size of the file","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_60":{"__typename":"Paragraph","id":"9bec290a37ee_60","name":"6ad8","type":"P","href":null,"layout":null,"metadata":null,"text":"After is Virtualloc, and it create a memory page at 1FD0000 (eax value)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*ZbIjFGLCh8gNGkvZ":{"__typename":"ImageMetadata","id":"0*ZbIjFGLCh8gNGkvZ","originalHeight":166,"originalWidth":1289,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_61":{"__typename":"Paragraph","id":"9bec290a37ee_61","name":"0b2b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*ZbIjFGLCh8gNGkvZ"},"text":"VirtualAlloc memory page to load 8.t","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*LdAKz0ohFyXUZLnQ":{"__typename":"ImageMetadata","id":"0*LdAKz0ohFyXUZLnQ","originalHeight":56,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_62":{"__typename":"Paragraph","id":"9bec290a37ee_62","name":"b05d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*LdAKz0ohFyXUZLnQ"},"text":"After virtualAlloc, the memory page is pointed by EAX","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*scFreDPlrg0vMk3y":{"__typename":"ImageMetadata","id":"0*scFreDPlrg0vMk3y","originalHeight":223,"originalWidth":568,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_63":{"__typename":"Paragraph","id":"9bec290a37ee_63","name":"cd7d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*scFreDPlrg0vMk3y"},"text":"The page allocated","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_64":{"__typename":"Paragraph","id":"9bec290a37ee_64","name":"09af","type":"P","href":null,"layout":null,"metadata":null,"text":"ReadFile is called:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*9U63odBDYmELykLj":{"__typename":"ImageMetadata","id":"0*9U63odBDYmELykLj","originalHeight":164,"originalWidth":1180,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_65":{"__typename":"Paragraph","id":"9bec290a37ee_65","name":"ef54","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*9U63odBDYmELykLj"},"text":"Readfile 8.t","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_66":{"__typename":"Paragraph","id":"9bec290a37ee_66","name":"9f38","type":"P","href":null,"layout":null,"metadata":null,"text":"And 8.t is loaded at 1FD0000:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Jk1gs5HJ_bqItbId":{"__typename":"ImageMetadata","id":"0*Jk1gs5HJ_bqItbId","originalHeight":210,"originalWidth":763,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_67":{"__typename":"Paragraph","id":"9bec290a37ee_67","name":"d911","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Jk1gs5HJ_bqItbId"},"text":"8.t in memory","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_68":{"__typename":"Paragraph","id":"9bec290a37ee_68","name":"6279","type":"P","href":null,"layout":null,"metadata":null,"text":"And the shellcode decrypts the 8.t file in memory at 0066C82A.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_69":{"__typename":"Paragraph","id":"9bec290a37ee_69","name":"da31","type":"P","href":null,"layout":null,"metadata":null,"text":"The loop of decryption is a xoring with different manipulations on the decryption key.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_70":{"__typename":"Paragraph","id":"9bec290a37ee_70","name":"b13c","type":"P","href":null,"layout":null,"metadata":null,"text":"At the start of the decryption the key is set to 7BF48E63.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*PGv72R85Q_sluT4L":{"__typename":"ImageMetadata","id":"0*PGv72R85Q_sluT4L","originalHeight":230,"originalWidth":803,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_71":{"__typename":"Paragraph","id":"9bec290a37ee_71","name":"8b61","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*PGv72R85Q_sluT4L"},"text":"Decryption loop","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_72":{"__typename":"Paragraph","id":"9bec290a37ee_72","name":"4dd3","type":"P","href":null,"layout":null,"metadata":null,"text":"And the xor is made after key manipulation.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*bSANUUTbXIj4P9Nj":{"__typename":"ImageMetadata","id":"0*bSANUUTbXIj4P9Nj","originalHeight":184,"originalWidth":893,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_73":{"__typename":"Paragraph","id":"9bec290a37ee_73","name":"175b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*bSANUUTbXIj4P9Nj"},"text":"Set the decryption key in EAX","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_74":{"__typename":"Paragraph","id":"9bec290a37ee_74","name":"3cd0","type":"P","href":null,"layout":null,"metadata":null,"text":"If we check the destination of the result of the xoring (here edx + ebx), we find 01FD0000 where 8.t is loaded.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_75":{"__typename":"Paragraph","id":"9bec290a37ee_75","name":"22db","type":"P","href":null,"layout":null,"metadata":null,"text":"After two step of the loop, we can see the magic number MZ set at the begin of memory section.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*qV4ri5WwmOZY656e":{"__typename":"ImageMetadata","id":"0*qV4ri5WwmOZY656e","originalHeight":23,"originalWidth":589,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_76":{"__typename":"Paragraph","id":"9bec290a37ee_76","name":"b920","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*qV4ri5WwmOZY656e"},"text":"MZ magic number","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_77":{"__typename":"Paragraph","id":"9bec290a37ee_77","name":"8d49","type":"P","href":null,"layout":null,"metadata":null,"text":"At the end of the decryption loop, we have a PE in memory at 01FD0000.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_78":{"__typename":"Paragraph","id":"9bec290a37ee_78","name":"c447","type":"P","href":null,"layout":null,"metadata":null,"text":"the file 8.t has been decrypted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Qr7rIF4SzfRXrfA-":{"__typename":"ImageMetadata","id":"0*Qr7rIF4SzfRXrfA-","originalHeight":206,"originalWidth":527,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_79":{"__typename":"Paragraph","id":"9bec290a37ee_79","name":"ba02","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Qr7rIF4SzfRXrfA-"},"text":"8.t fully decrypted","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_80":{"__typename":"Paragraph","id":"9bec290a37ee_80","name":"20a4","type":"P","href":null,"layout":null,"metadata":null,"text":"Then, the shellcode uses the VirtualAlloc and create a memory page at 02070000.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*K0wfJidHIcxQXFkw":{"__typename":"ImageMetadata","id":"0*K0wfJidHIcxQXFkw","originalHeight":156,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_81":{"__typename":"Paragraph","id":"9bec290a37ee_81","name":"574c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*K0wfJidHIcxQXFkw"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_82":{"__typename":"Paragraph","id":"9bec290a37ee_82","name":"7923","type":"P","href":null,"layout":null,"metadata":null,"text":"And the new PE at 01FD0000 is copied at this address.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*danFn5PtUkMayFkP":{"__typename":"ImageMetadata","id":"0*danFn5PtUkMayFkP","originalHeight":247,"originalWidth":705,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_83":{"__typename":"Paragraph","id":"9bec290a37ee_83","name":"dcb0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*danFn5PtUkMayFkP"},"text":"the PE decrypted is copied in the new memory page","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_84":{"__typename":"Paragraph","id":"9bec290a37ee_84","name":"8688","type":"P","href":null,"layout":null,"metadata":null,"text":"After GetModuleFileNameA is called to have the path of EQNEDT32.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_85":{"__typename":"Paragraph","id":"9bec290a37ee_85","name":"6634","type":"P","href":null,"layout":null,"metadata":null,"text":"And EQNEDT32.exe is forked in suspend status by a CreateProcess and the shellcode overwrite it by the PE at the address 02070000","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kk64ZHud8G2F4tCC4OsG8A.png":{"__typename":"ImageMetadata","id":"1*kk64ZHud8G2F4tCC4OsG8A.png","originalHeight":81,"originalWidth":745,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_86":{"__typename":"Paragraph","id":"9bec290a37ee_86","name":"c479","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*kk64ZHud8G2F4tCC4OsG8A.png"},"text":"Fork of EQNEDT32.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*ypOCUTfbDeferzub":{"__typename":"ImageMetadata","id":"0*ypOCUTfbDeferzub","originalHeight":83,"originalWidth":753,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_87":{"__typename":"Paragraph","id":"9bec290a37ee_87","name":"3067","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*ypOCUTfbDeferzub"},"text":"Overwritting of EQNEDT32.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*L0Hhdpr9Wenz-bek":{"__typename":"ImageMetadata","id":"0*L0Hhdpr9Wenz-bek","originalHeight":53,"originalWidth":410,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_88":{"__typename":"Paragraph","id":"9bec290a37ee_88","name":"4276","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*L0Hhdpr9Wenz-bek"},"text":"Stack used by NTWriteVirtualMemory","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_89":{"__typename":"Paragraph","id":"9bec290a37ee_89","name":"ebd5","type":"P","href":null,"layout":null,"metadata":null,"text":"And the shellcode does a ResumeThread to launch the new PE.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_90":{"__typename":"Paragraph","id":"9bec290a37ee_90","name":"8c1a","type":"P","href":null,"layout":null,"metadata":null,"text":"So, We’ve found all API Calls in the object ole at the beginning and we have a runPE to launch the new EQNEDT32.exe overwritten.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_91":{"__typename":"Paragraph","id":"9bec290a37ee_91","name":"3023","type":"H3","href":null,"layout":null,"metadata":null,"text":"Analysing the fork of EQNEDT32.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_92":{"__typename":"Paragraph","id":"9bec290a37ee_92","name":"1c24","type":"P","href":null,"layout":null,"metadata":null,"text":"We know that this process has to create on disk two files following the Joe SandBox Analysis:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_93":{"__typename":"Paragraph","id":"9bec290a37ee_93","name":"a1ef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"A dll named RasTls.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_94":{"__typename":"Paragraph","id":"9bec290a37ee_94","name":"9e7e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"A executable file named dascgosrky.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_95":{"__typename":"Paragraph","id":"9bec290a37ee_95","name":"da74","type":"P","href":null,"layout":null,"metadata":null,"text":"If we dump EQNEDT32.exe and we put in IDA, we found quickly the function that drops the files on disk (sub_00401150) renamed dropFiles.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*g-1TYchR4C-l1bZe":{"__typename":"ImageMetadata","id":"0*g-1TYchR4C-l1bZe","originalHeight":697,"originalWidth":1329,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_96":{"__typename":"Paragraph","id":"9bec290a37ee_96","name":"803e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*g-1TYchR4C-l1bZe"},"text":"DropFiles Fucntion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_97":{"__typename":"Paragraph","id":"9bec290a37ee_97","name":"6fea","type":"P","href":null,"layout":null,"metadata":null,"text":"And at the start of this functions, we have a loop with a xor.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*2zdLF3_sBWAbZ1cn":{"__typename":"ImageMetadata","id":"0*2zdLF3_sBWAbZ1cn","originalHeight":387,"originalWidth":792,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_98":{"__typename":"Paragraph","id":"9bec290a37ee_98","name":"442c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*2zdLF3_sBWAbZ1cn"},"text":"Second loop of decryption","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_99":{"__typename":"Paragraph","id":"9bec290a37ee_99","name":"ee94","type":"P","href":null,"layout":null,"metadata":null,"text":"And just after we have a call of the decompression function.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*6bila_55UIdXaZVs":{"__typename":"ImageMetadata","id":"0*6bila_55UIdXaZVs","originalHeight":261,"originalWidth":773,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_100":{"__typename":"Paragraph","id":"9bec290a37ee_100","name":"95ea","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*6bila_55UIdXaZVs"},"text":"Decompression function used zlib","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_101":{"__typename":"Paragraph","id":"9bec290a37ee_101","name":"004f","type":"P","href":null,"layout":null,"metadata":null,"text":"The function dropFiles is called twice by the sub_4012D0.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*XWAq6Iz3HsRky01e":{"__typename":"ImageMetadata","id":"0*XWAq6Iz3HsRky01e","originalHeight":289,"originalWidth":424,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_102":{"__typename":"Paragraph","id":"9bec290a37ee_102","name":"8956","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*XWAq6Iz3HsRky01e"},"text":"Drop the dll and the executable","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_103":{"__typename":"Paragraph","id":"9bec290a37ee_103","name":"253b","type":"P","href":null,"layout":null,"metadata":null,"text":"If we check the call graph, DropFiles is called only by the function sub_4012D0.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*dtetntiSL1fJu8I7":{"__typename":"ImageMetadata","id":"0*dtetntiSL1fJu8I7","originalHeight":540,"originalWidth":166,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_104":{"__typename":"Paragraph","id":"9bec290a37ee_104","name":"a6d0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*dtetntiSL1fJu8I7"},"text":"Functions using DropFiles function","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_105":{"__typename":"Paragraph","id":"9bec290a37ee_105","name":"a84b","type":"P","href":null,"layout":null,"metadata":null,"text":"So we set a breakpoint on CreateFile because at each execution, EQNEDT32.exe starts by CreateFile onstaticcache.dat.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*IIdwPvqg7vJSZPTb":{"__typename":"ImageMetadata","id":"0*IIdwPvqg7vJSZPTb","originalHeight":195,"originalWidth":1323,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_106":{"__typename":"Paragraph","id":"9bec290a37ee_106","name":"9814","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*IIdwPvqg7vJSZPTb"},"text":"Breakpoint to createfile","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_107":{"__typename":"Paragraph","id":"9bec290a37ee_107","name":"b0a0","type":"P","href":null,"layout":null,"metadata":null,"text":"And we return at the user code to set a new breakpoint to check the static analysis.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_108":{"__typename":"Paragraph","id":"9bec290a37ee_108","name":"1ef8","type":"P","href":null,"layout":null,"metadata":null,"text":"So we set a breakpoint at 0040159A when DropFiles is called.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*mPqUIrP66QLkZuGa":{"__typename":"ImageMetadata","id":"0*mPqUIrP66QLkZuGa","originalHeight":56,"originalWidth":1269,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_109":{"__typename":"Paragraph","id":"9bec290a37ee_109","name":"0381","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*mPqUIrP66QLkZuGa"},"text":"Breakpoint to the first call of DropFiles","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_110":{"__typename":"Paragraph","id":"9bec290a37ee_110","name":"eb91","type":"P","href":null,"layout":null,"metadata":null,"text":"And now we can analyse the second loop of decryption.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_111":{"__typename":"Paragraph","id":"9bec290a37ee_111","name":"3d42","type":"P","href":null,"layout":null,"metadata":null,"text":"The first step is the initialization of the decryption function.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Cof9a7EXfLVLiY7b":{"__typename":"ImageMetadata","id":"0*Cof9a7EXfLVLiY7b","originalHeight":424,"originalWidth":1322,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_112":{"__typename":"Paragraph","id":"9bec290a37ee_112","name":"296f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Cof9a7EXfLVLiY7b"},"text":"Set for the second loop encryption","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_113":{"__typename":"Paragraph","id":"9bec290a37ee_113","name":"16eb","type":"P","href":null,"layout":null,"metadata":null,"text":"And after we find the xor and store the result in esi+eax.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*o89HisxMXD7MXiDm":{"__typename":"ImageMetadata","id":"0*o89HisxMXD7MXiDm","originalHeight":121,"originalWidth":679,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_114":{"__typename":"Paragraph","id":"9bec290a37ee_114","name":"2cb4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*o89HisxMXD7MXiDm"},"text":"Decryption loop","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_115":{"__typename":"Paragraph","id":"9bec290a37ee_115","name":"7b1e","type":"P","href":null,"layout":null,"metadata":null,"text":"In the first step of the decryption loop, the result is written to 411BC0 in the address space of EQNEDT32.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*v_yQA_1fBa_lnJoM":{"__typename":"ImageMetadata","id":"0*v_yQA_1fBa_lnJoM","originalHeight":24,"originalWidth":526,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_116":{"__typename":"Paragraph","id":"9bec290a37ee_116","name":"025d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*v_yQA_1fBa_lnJoM"},"text":"Before the decryption","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_117":{"__typename":"Paragraph","id":"9bec290a37ee_117","name":"67a9","type":"P","href":null,"layout":null,"metadata":null,"text":"After tree loops, we obtains the header of zlib compressed object.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*DwL9yQvCwNl3ROPO":{"__typename":"ImageMetadata","id":"0*DwL9yQvCwNl3ROPO","originalHeight":24,"originalWidth":545,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_118":{"__typename":"Paragraph","id":"9bec290a37ee_118","name":"12e4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*DwL9yQvCwNl3ROPO"},"text":"After the decryption","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_119":{"__typename":"Paragraph","id":"9bec290a37ee_119","name":"d9f3","type":"P","href":null,"layout":null,"metadata":null,"text":"And at the memory page 021E0000, a PE is decompressed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*RZNRY50hvuvdYAx0":{"__typename":"ImageMetadata","id":"0*RZNRY50hvuvdYAx0","originalHeight":241,"originalWidth":652,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_120":{"__typename":"Paragraph","id":"9bec290a37ee_120","name":"20a8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*RZNRY50hvuvdYAx0"},"text":"Page memory allocated to store the dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*CsMIkL0uD7AywTxS":{"__typename":"ImageMetadata","id":"0*CsMIkL0uD7AywTxS","originalHeight":559,"originalWidth":878,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_121":{"__typename":"Paragraph","id":"9bec290a37ee_121","name":"6c6b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*CsMIkL0uD7AywTxS"},"text":"After decompression","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_122":{"__typename":"Paragraph","id":"9bec290a37ee_122","name":"757b","type":"P","href":null,"layout":null,"metadata":null,"text":"And after the file is created with the following path: L”C:\\\\Users\\\\IEUser\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Network Shortcuts\\\\RasTls.dll”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_123":{"__typename":"Paragraph","id":"9bec290a37ee_123","name":"6741","type":"P","href":null,"layout":null,"metadata":null,"text":"Stored by ebx.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_124":{"__typename":"Paragraph","id":"9bec290a37ee_124","name":"2f7a","type":"P","href":null,"layout":null,"metadata":null,"text":"DropFiles is called a twice to decrypt and decompress the executable file.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_125":{"__typename":"Paragraph","id":"9bec290a37ee_125","name":"61c8","type":"P","href":null,"layout":null,"metadata":null,"text":"The offset where store the file is 00434EF8 and the pe decompressed is stored at 025D0020","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*QpJE4TMOOeyj9ZK1":{"__typename":"ImageMetadata","id":"0*QpJE4TMOOeyj9ZK1","originalHeight":727,"originalWidth":742,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_126":{"__typename":"Paragraph","id":"9bec290a37ee_126","name":"c39a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*QpJE4TMOOeyj9ZK1"},"text":"Decryption of the executable dascgosrky.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_127":{"__typename":"Paragraph","id":"9bec290a37ee_127","name":"4062","type":"P","href":null,"layout":null,"metadata":null,"text":"And the path of the new file is : ebx=005DA228 L”C:\\\\Users\\\\IEUser\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Network Shortcuts\\\\dascgosrky.exe”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_128":{"__typename":"Paragraph","id":"9bec290a37ee_128","name":"f9f3","type":"P","href":null,"layout":null,"metadata":null,"text":"So we have two files in networks shortcuts of Windows.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*iRfSKvRRYY5h96uv":{"__typename":"ImageMetadata","id":"0*iRfSKvRRYY5h96uv","originalHeight":146,"originalWidth":1018,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_129":{"__typename":"Paragraph","id":"9bec290a37ee_129","name":"0850","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*iRfSKvRRYY5h96uv"},"text":"Files drops on disk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_130":{"__typename":"Paragraph","id":"9bec290a37ee_130","name":"e4f3","type":"H3","href":null,"layout":null,"metadata":null,"text":"dll hijacking","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_131":{"__typename":"Paragraph","id":"9bec290a37ee_131","name":"0b60","type":"P","href":null,"layout":null,"metadata":null,"text":"Dascgosrky.exe is a legit and trusted software develop by Symantec.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*_UlmQfFwPW9TmjZ_":{"__typename":"ImageMetadata","id":"0*_UlmQfFwPW9TmjZ_","originalHeight":534,"originalWidth":418,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_132":{"__typename":"Paragraph","id":"9bec290a37ee_132","name":"d4f6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*_UlmQfFwPW9TmjZ_"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_133":{"__typename":"Paragraph","id":"9bec290a37ee_133","name":"a082","type":"P","href":null,"layout":null,"metadata":null,"text":"To load the library RasTls.dll, the executable calls LoadLibrary and GetProcaddress in sub_401940 to execute the malicious functions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*OfrLEq9IeAVFLU3P":{"__typename":"ImageMetadata","id":"0*OfrLEq9IeAVFLU3P","originalHeight":740,"originalWidth":494,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_134":{"__typename":"Paragraph","id":"9bec290a37ee_134","name":"45b3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*OfrLEq9IeAVFLU3P"},"text":"Dascgosrky.exe loading the malicious","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*NuyGFynu86jp1zd0":{"__typename":"ImageMetadata","id":"0*NuyGFynu86jp1zd0","originalHeight":708,"originalWidth":404,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_135":{"__typename":"Paragraph","id":"9bec290a37ee_135","name":"a77d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*NuyGFynu86jp1zd0"},"text":"The original file","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_136":{"__typename":"Paragraph","id":"9bec290a37ee_136","name":"556e","type":"P","href":null,"layout":null,"metadata":null,"text":"If we check the exports in IDA, we just have a dllentrypoint. The dll is executed like this.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_137":{"__typename":"Paragraph","id":"9bec290a37ee_137","name":"6d58","type":"P","href":null,"layout":null,"metadata":null,"text":"We’ll analyse the RAT in the second Part.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_138":{"__typename":"Paragraph","id":"9bec290a37ee_138","name":"ca69","type":"H3","href":null,"layout":null,"metadata":null,"text":"Infrastructure of Attackers","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_139":{"__typename":"Paragraph","id":"9bec290a37ee_139","name":"8ba0","type":"P","href":null,"layout":null,"metadata":null,"text":"The domain contacted is wouderfulu.impresstravel.ga and this domain resolved on 192.99.181.14.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*bWs378Qw7-Rdrrgt":{"__typename":"ImageMetadata","id":"0*bWs378Qw7-Rdrrgt","originalHeight":511,"originalWidth":788,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_140":{"__typename":"Paragraph","id":"9bec290a37ee_140","name":"2fdf","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*bWs378Qw7-Rdrrgt"},"text":"Domain wouderfulu.impresstravel.ga","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_141":{"__typename":"Paragraph","id":"9bec290a37ee_141","name":"cf26","type":"P","href":null,"layout":null,"metadata":null,"text":"This IP has differents domains found with PassiveTotal and theses domains is recorded in the IP 176.223.165.122.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_142":{"__typename":"Paragraph","id":"9bec290a37ee_142","name":"ebd4","type":"P","href":null,"layout":null,"metadata":null,"text":"Many domain names is used for Vietnameses people.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Bwrh_O_Sybq67s6w":{"__typename":"ImageMetadata","id":"0*Bwrh_O_Sybq67s6w","originalHeight":514,"originalWidth":1044,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9bec290a37ee_143":{"__typename":"Paragraph","id":"9bec290a37ee_143","name":"fb5a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Bwrh_O_Sybq67s6w"},"text":"Expansion of domains","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_144":{"__typename":"Paragraph","id":"9bec290a37ee_144","name":"9d8c","type":"P","href":null,"layout":null,"metadata":null,"text":"There are two domains really interesting:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_145":{"__typename":"Paragraph","id":"9bec290a37ee_145","name":"20ba","type":"P","href":null,"layout":null,"metadata":null,"text":"Halong.dulichculao.com is already used in the campaign targeting Vietnameses organizations.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_146":{"__typename":"Paragraph","id":"9bec290a37ee_146","name":"8587","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fwww.fortinet.com\u002Fblog\u002Fthreat-research\u002Frehashed-rat-used-in-apt-campaign-against-vietnamese-organizations.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":117,"href":"https:\u002F\u002Fwww.fortinet.com\u002Fblog\u002Fthreat-research\u002Frehashed-rat-used-in-apt-campaign-against-vietnamese-organizations.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_147":{"__typename":"Paragraph","id":"9bec290a37ee_147","name":"1a51","type":"P","href":null,"layout":null,"metadata":null,"text":"For Fortinet is the Chinese hacking group 1937CN.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_148":{"__typename":"Paragraph","id":"9bec290a37ee_148","name":"29e3","type":"P","href":null,"layout":null,"metadata":null,"text":"If we compare the TTPs, it’s really similar. They used RTFs to make the intrusion and dll hijacking to load the real payload.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_149":{"__typename":"Paragraph","id":"9bec290a37ee_149","name":"4c39","type":"P","href":null,"layout":null,"metadata":null,"text":"And the name of domains are really similar between the campaings.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_150":{"__typename":"Paragraph","id":"9bec290a37ee_150","name":"b020","type":"P","href":null,"layout":null,"metadata":null,"text":"The second one is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_151":{"__typename":"Paragraph","id":"9bec290a37ee_151","name":"05c9","type":"P","href":null,"layout":null,"metadata":null,"text":"Cat.toonganuh.com is a subdomain of tooganuh.com recorded by florence1972@scryptmail.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":61,"end":88,"href":"mailto:florence1972@scryptmail.com","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_152":{"__typename":"Paragraph","id":"9bec290a37ee_152","name":"21cf","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_153":{"__typename":"Paragraph","id":"9bec290a37ee_153","name":"cf14","type":"P","href":null,"layout":null,"metadata":null,"text":"The Chinese hacking group 1937CN continues to target Vietnam officials with the same TTPs with a refreshing on the tools used. The toolset used by this group to create RTF malicious document has the same properpy of the SideWinder.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_154":{"__typename":"Paragraph","id":"9bec290a37ee_154","name":"a92b","type":"P","href":null,"layout":null,"metadata":null,"text":"I want to thank my buddies on “Zone de Confort”. It’s with this dreamteam, I can finalize correctly this analyses.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_155":{"__typename":"Paragraph","id":"9bec290a37ee_155","name":"2d66","type":"P","href":null,"layout":null,"metadata":null,"text":"In the second part, we analyze the RAT using in this campaign. Or if another reverse can make that, I’ll paid a beer ;)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_156":{"__typename":"Paragraph","id":"9bec290a37ee_156","name":"370f","type":"H3","href":null,"layout":null,"metadata":null,"text":"IOCs for the paper:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_157":{"__typename":"Paragraph","id":"9bec290a37ee_157","name":"b908","type":"P","href":null,"layout":null,"metadata":null,"text":"domains:\ndn.dulichbiendao.org\ngateway.vietbaotinmoi.com","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_158":{"__typename":"Paragraph","id":"9bec290a37ee_158","name":"f150","type":"P","href":null,"layout":null,"metadata":null,"text":"web.thoitietvietnam.org\nhn.dulichbiendao.org\nhalong.dulichculao.com\ncat.toonganuh.com\nnew.sggpnews.com\ndulichculao.com\ncoco.sodexoa.com.\nthoitiet.malware-sinkhole.net\nwouderfulu.impresstravel.ga\ntoonganuh.com\ncoco.sodexoa.com","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_159":{"__typename":"Paragraph","id":"9bec290a37ee_159","name":"8880","type":"P","href":null,"layout":null,"metadata":null,"text":"IPs:\n192.99.181.14\n176.223.165.122","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_160":{"__typename":"Paragraph","id":"9bec290a37ee_160","name":"0081","type":"P","href":null,"layout":null,"metadata":null,"text":"RTFs:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_161":{"__typename":"Paragraph","id":"9bec290a37ee_161","name":"6781","type":"P","href":null,"layout":null,"metadata":null,"text":"42162c495e835cdf28670661a53d47d12255d9c791c1c5653673b25fb587ffed","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_162":{"__typename":"Paragraph","id":"9bec290a37ee_162","name":"6350","type":"P","href":null,"layout":null,"metadata":null,"text":"8.t:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_163":{"__typename":"Paragraph","id":"9bec290a37ee_163","name":"4afb","type":"P","href":null,"layout":null,"metadata":null,"text":"2c60d4312e4416745e56048ee35e694a79e1bc77e7e4d0b5811e64c84a72d2d7","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_164":{"__typename":"Paragraph","id":"9bec290a37ee_164","name":"60ca","type":"P","href":null,"layout":null,"metadata":null,"text":"PE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_165":{"__typename":"Paragraph","id":"9bec290a37ee_165","name":"00f3","type":"P","href":null,"layout":null,"metadata":null,"text":"f9ebf6aeb3f0fb0c29bd8f3d652476cd1fe8bd9a0c11cb15c43de33bbce0bf68 (exe)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_166":{"__typename":"Paragraph","id":"9bec290a37ee_166","name":"43f5","type":"P","href":null,"layout":null,"metadata":null,"text":"9f5da7524817736cd85d87dae93fdbe478385baac1c0aa3102b6ad50d7e5e368 (dll)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_167":{"__typename":"Paragraph","id":"9bec290a37ee_167","name":"938a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Update:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_168":{"__typename":"Paragraph","id":"9bec290a37ee_168","name":"132a","type":"P","href":null,"layout":null,"metadata":null,"text":"The payload is PlugX. Thanks to Gabor Szappanos https:\u002F\u002Ftwitter.com\u002FGaborSzappanos\u002Fstatus\u002F1024622354582908928","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":48,"end":109,"href":"https:\u002F\u002Ftwitter.com\u002FGaborSzappanos\u002Fstatus\u002F1024622354582908928","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_169":{"__typename":"Paragraph","id":"9bec290a37ee_169","name":"0713","type":"P","href":null,"layout":null,"metadata":null,"text":"Update IOCs:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_170":{"__typename":"Paragraph","id":"9bec290a37ee_170","name":"990f","type":"P","href":null,"layout":null,"metadata":null,"text":"597c0c6f397eefb06155abdf5aa9a7476c977c44ef8bd9575b01359e96273486 59.rtf\n11f38b6a69978dad95c9b1479db9a8729ca57329855998bd41befc364657d654 RasTls.dll\nf9ebf6aeb3f0fb0c29bd8f3d652476cd1fe8bd9a0c11cb15c43de33bbce0bf68 RasTls.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_171":{"__typename":"Paragraph","id":"9bec290a37ee_171","name":"3ff0","type":"P","href":null,"layout":null,"metadata":null,"text":"b70069e1c8e829bfd7090ba3dfbf0e256fc7dfcefc6acafb3b53abcf2caa2253 b7.rtf\n77361b1ca09d6857d68cea052a0bb857e03d776d3e1943897315a80a19f20fc2 spoolsver.exe\n9fba998ab2c1b7fec39da9817b27768ba7892c0613c4be7c525989161981d2e2 vsodscpl.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_172":{"__typename":"Paragraph","id":"9bec290a37ee_172","name":"81b9","type":"P","href":null,"layout":null,"metadata":null,"text":"9d239ddd4c925d14e00b5a95827e9191bfda7d59858f141f6f5dcc52329838f0 9d.rtf\n087d8bee1db61273a7cd533d52b63265d3a8a8b897526d7849c48bcdba4b22ec RasTls.dll\nf9ebf6aeb3f0fb0c29bd8f3d652476cd1fe8bd9a0c11cb15c43de33bbce0bf68 RasTls.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_173":{"__typename":"Paragraph","id":"9bec290a37ee_173","name":"78ef","type":"P","href":null,"layout":null,"metadata":null,"text":"332aa26d719a20f3a26b2b00a9ca5d2e090b33f5070b057f4950d4f088201ab9 rtf","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_174":{"__typename":"Paragraph","id":"9bec290a37ee_174","name":"b4e8","type":"P","href":null,"layout":null,"metadata":null,"text":"93aa353320a8e27923880401a4a0f3760374b4d17dcd709d351e612d589b969d vsodscpl.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9bec290a37ee_175":{"__typename":"Paragraph","id":"9bec290a37ee_175","name":"1cc5","type":"P","href":null,"layout":null,"metadata":null,"text":"77361b1ca09d6857d68cea052a0bb857e03d776d3e1943897315a80a19f20fc2 ScnCfg.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:11d98531eebe-viewerId:lo_e418b373fc33":{"__typename":"UserViewerEdge","id":"userId:11d98531eebe-viewerId:lo_e418b373fc33","isMuting":false},"PostViewerEdge:postId:acb3b9d8b80a-viewerId:lo_e418b373fc33":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:acb3b9d8b80a-viewerId:lo_e418b373fc33","shouldFollowPostForExternalSearch":true},"Tag:security":{"__typename":"Tag","id":"security","displayTitle":"Security","normalizedTagSlug":"security"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Tag:threat-intelligence":{"__typename":"Tag","id":"threat-intelligence","displayTitle":"Threat Intelligence","normalizedTagSlug":"threat-intelligence"},"Post:acb3b9d8b80a":{"__typename":"Post","id":"acb3b9d8b80a","collection":null,"content({\"postMeteringOptions\":{\"referrer\":\"\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"5b1e","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:9bec290a37ee_0"},{"__ref":"Paragraph:9bec290a37ee_1"},{"__ref":"Paragraph:9bec290a37ee_2"},{"__ref":"Paragraph:9bec290a37ee_3"},{"__ref":"Paragraph:9bec290a37ee_4"},{"__ref":"Paragraph:9bec290a37ee_5"},{"__ref":"Paragraph:9bec290a37ee_6"},{"__ref":"Paragraph:9bec290a37ee_7"},{"__ref":"Paragraph:9bec290a37ee_8"},{"__ref":"Paragraph:9bec290a37ee_9"},{"__ref":"Paragraph:9bec290a37ee_10"},{"__ref":"Paragraph:9bec290a37ee_11"},{"__ref":"Paragraph:9bec290a37ee_12"},{"__ref":"Paragraph:9bec290a37ee_13"},{"__ref":"Paragraph:9bec290a37ee_14"},{"__ref":"Paragraph:9bec290a37ee_15"},{"__ref":"Paragraph:9bec290a37ee_16"},{"__ref":"Paragraph:9bec290a37ee_17"},{"__ref":"Paragraph:9bec290a37ee_18"},{"__ref":"Paragraph:9bec290a37ee_19"},{"__ref":"Paragraph:9bec290a37ee_20"},{"__ref":"Paragraph:9bec290a37ee_21"},{"__ref":"Paragraph:9bec290a37ee_22"},{"__ref":"Paragraph:9bec290a37ee_23"},{"__ref":"Paragraph:9bec290a37ee_24"},{"__ref":"Paragraph:9bec290a37ee_25"},{"__ref":"Paragraph:9bec290a37ee_26"},{"__ref":"Paragraph:9bec290a37ee_27"},{"__ref":"Paragraph:9bec290a37ee_28"},{"__ref":"Paragraph:9bec290a37ee_29"},{"__ref":"Paragraph:9bec290a37ee_30"},{"__ref":"Paragraph:9bec290a37ee_31"},{"__ref":"Paragraph:9bec290a37ee_32"},{"__ref":"Paragraph:9bec290a37ee_33"},{"__ref":"Paragraph:9bec290a37ee_34"},{"__ref":"Paragraph:9bec290a37ee_35"},{"__ref":"Paragraph:9bec290a37ee_36"},{"__ref":"Paragraph:9bec290a37ee_37"},{"__ref":"Paragraph:9bec290a37ee_38"},{"__ref":"Paragraph:9bec290a37ee_39"},{"__ref":"Paragraph:9bec290a37ee_40"},{"__ref":"Paragraph:9bec290a37ee_41"},{"__ref":"Paragraph:9bec290a37ee_42"},{"__ref":"Paragraph:9bec290a37ee_43"},{"__ref":"Paragraph:9bec290a37ee_44"},{"__ref":"Paragraph:9bec290a37ee_45"},{"__ref":"Paragraph:9bec290a37ee_46"},{"__ref":"Paragraph:9bec290a37ee_47"},{"__ref":"Paragraph:9bec290a37ee_48"},{"__ref":"Paragraph:9bec290a37ee_49"},{"__ref":"Paragraph:9bec290a37ee_50"},{"__ref":"Paragraph:9bec290a37ee_51"},{"__ref":"Paragraph:9bec290a37ee_52"},{"__ref":"Paragraph:9bec290a37ee_53"},{"__ref":"Paragraph:9bec290a37ee_54"},{"__ref":"Paragraph:9bec290a37ee_55"},{"__ref":"Paragraph:9bec290a37ee_56"},{"__ref":"Paragraph:9bec290a37ee_57"},{"__ref":"Paragraph:9bec290a37ee_58"},{"__ref":"Paragraph:9bec290a37ee_59"},{"__ref":"Paragraph:9bec290a37ee_60"},{"__ref":"Paragraph:9bec290a37ee_61"},{"__ref":"Paragraph:9bec290a37ee_62"},{"__ref":"Paragraph:9bec290a37ee_63"},{"__ref":"Paragraph:9bec290a37ee_64"},{"__ref":"Paragraph:9bec290a37ee_65"},{"__ref":"Paragraph:9bec290a37ee_66"},{"__ref":"Paragraph:9bec290a37ee_67"},{"__ref":"Paragraph:9bec290a37ee_68"},{"__ref":"Paragraph:9bec290a37ee_69"},{"__ref":"Paragraph:9bec290a37ee_70"},{"__ref":"Paragraph:9bec290a37ee_71"},{"__ref":"Paragraph:9bec290a37ee_72"},{"__ref":"Paragraph:9bec290a37ee_73"},{"__ref":"Paragraph:9bec290a37ee_74"},{"__ref":"Paragraph:9bec290a37ee_75"},{"__ref":"Paragraph:9bec290a37ee_76"},{"__ref":"Paragraph:9bec290a37ee_77"},{"__ref":"Paragraph:9bec290a37ee_78"},{"__ref":"Paragraph:9bec290a37ee_79"},{"__ref":"Paragraph:9bec290a37ee_80"},{"__ref":"Paragraph:9bec290a37ee_81"},{"__ref":"Paragraph:9bec290a37ee_82"},{"__ref":"Paragraph:9bec290a37ee_83"},{"__ref":"Paragraph:9bec290a37ee_84"},{"__ref":"Paragraph:9bec290a37ee_85"},{"__ref":"Paragraph:9bec290a37ee_86"},{"__ref":"Paragraph:9bec290a37ee_87"},{"__ref":"Paragraph:9bec290a37ee_88"},{"__ref":"Paragraph:9bec290a37ee_89"},{"__ref":"Paragraph:9bec290a37ee_90"},{"__ref":"Paragraph:9bec290a37ee_91"},{"__ref":"Paragraph:9bec290a37ee_92"},{"__ref":"Paragraph:9bec290a37ee_93"},{"__ref":"Paragraph:9bec290a37ee_94"},{"__ref":"Paragraph:9bec290a37ee_95"},{"__ref":"Paragraph:9bec290a37ee_96"},{"__ref":"Paragraph:9bec290a37ee_97"},{"__ref":"Paragraph:9bec290a37ee_98"},{"__ref":"Paragraph:9bec290a37ee_99"},{"__ref":"Paragraph:9bec290a37ee_100"},{"__ref":"Paragraph:9bec290a37ee_101"},{"__ref":"Paragraph:9bec290a37ee_102"},{"__ref":"Paragraph:9bec290a37ee_103"},{"__ref":"Paragraph:9bec290a37ee_104"},{"__ref":"Paragraph:9bec290a37ee_105"},{"__ref":"Paragraph:9bec290a37ee_106"},{"__ref":"Paragraph:9bec290a37ee_107"},{"__ref":"Paragraph:9bec290a37ee_108"},{"__ref":"Paragraph:9bec290a37ee_109"},{"__ref":"Paragraph:9bec290a37ee_110"},{"__ref":"Paragraph:9bec290a37ee_111"},{"__ref":"Paragraph:9bec290a37ee_112"},{"__ref":"Paragraph:9bec290a37ee_113"},{"__ref":"Paragraph:9bec290a37ee_114"},{"__ref":"Paragraph:9bec290a37ee_115"},{"__ref":"Paragraph:9bec290a37ee_116"},{"__ref":"Paragraph:9bec290a37ee_117"},{"__ref":"Paragraph:9bec290a37ee_118"},{"__ref":"Paragraph:9bec290a37ee_119"},{"__ref":"Paragraph:9bec290a37ee_120"},{"__ref":"Paragraph:9bec290a37ee_121"},{"__ref":"Paragraph:9bec290a37ee_122"},{"__ref":"Paragraph:9bec290a37ee_123"},{"__ref":"Paragraph:9bec290a37ee_124"},{"__ref":"Paragraph:9bec290a37ee_125"},{"__ref":"Paragraph:9bec290a37ee_126"},{"__ref":"Paragraph:9bec290a37ee_127"},{"__ref":"Paragraph:9bec290a37ee_128"},{"__ref":"Paragraph:9bec290a37ee_129"},{"__ref":"Paragraph:9bec290a37ee_130"},{"__ref":"Paragraph:9bec290a37ee_131"},{"__ref":"Paragraph:9bec290a37ee_132"},{"__ref":"Paragraph:9bec290a37ee_133"},{"__ref":"Paragraph:9bec290a37ee_134"},{"__ref":"Paragraph:9bec290a37ee_135"},{"__ref":"Paragraph:9bec290a37ee_136"},{"__ref":"Paragraph:9bec290a37ee_137"},{"__ref":"Paragraph:9bec290a37ee_138"},{"__ref":"Paragraph:9bec290a37ee_139"},{"__ref":"Paragraph:9bec290a37ee_140"},{"__ref":"Paragraph:9bec290a37ee_141"},{"__ref":"Paragraph:9bec290a37ee_142"},{"__ref":"Paragraph:9bec290a37ee_143"},{"__ref":"Paragraph:9bec290a37ee_144"},{"__ref":"Paragraph:9bec290a37ee_145"},{"__ref":"Paragraph:9bec290a37ee_146"},{"__ref":"Paragraph:9bec290a37ee_147"},{"__ref":"Paragraph:9bec290a37ee_148"},{"__ref":"Paragraph:9bec290a37ee_149"},{"__ref":"Paragraph:9bec290a37ee_150"},{"__ref":"Paragraph:9bec290a37ee_151"},{"__ref":"Paragraph:9bec290a37ee_152"},{"__ref":"Paragraph:9bec290a37ee_153"},{"__ref":"Paragraph:9bec290a37ee_154"},{"__ref":"Paragraph:9bec290a37ee_155"},{"__ref":"Paragraph:9bec290a37ee_156"},{"__ref":"Paragraph:9bec290a37ee_157"},{"__ref":"Paragraph:9bec290a37ee_158"},{"__ref":"Paragraph:9bec290a37ee_159"},{"__ref":"Paragraph:9bec290a37ee_160"},{"__ref":"Paragraph:9bec290a37ee_161"},{"__ref":"Paragraph:9bec290a37ee_162"},{"__ref":"Paragraph:9bec290a37ee_163"},{"__ref":"Paragraph:9bec290a37ee_164"},{"__ref":"Paragraph:9bec290a37ee_165"},{"__ref":"Paragraph:9bec290a37ee_166"},{"__ref":"Paragraph:9bec290a37ee_167"},{"__ref":"Paragraph:9bec290a37ee_168"},{"__ref":"Paragraph:9bec290a37ee_169"},{"__ref":"Paragraph:9bec290a37ee_170"},{"__ref":"Paragraph:9bec290a37ee_171"},{"__ref":"Paragraph:9bec290a37ee_172"},{"__ref":"Paragraph:9bec290a37ee_173"},{"__ref":"Paragraph:9bec290a37ee_174"},{"__ref":"Paragraph:9bec290a37ee_175"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:11d98531eebe"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fsebdraven.medium.com\u002Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isLimitedState":false,"isPublished":true,"allowResponses":true,"responsesLocked":false,"visibility":"PUBLIC","latestPublishedVersion":"9bec290a37ee","postResponses":{"__typename":"PostResponses","count":4},"responseDistribution":"NOT_DISTRIBUTED","clapCount":45,"title":"Malicious document targets Vietnamese officials","isSeries":false,"sequence":null,"uniqueSlug":"malicious-document-targets-vietnamese-officials-acb3b9d8b80a","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1534155212764,"readingTime":8.765094339622642,"previewContent":{"__typename":"PreviewContent","subtitle":"After our investigation of APT SideWinder, we’ve done a yara rule for hunting RTF document exploiting the CVE-2017–11882."},"previewImage":{"__ref":"ImageMetadata:0*UjwuTDu6t3I4qJHq"},"isShortform":false,"seoTitle":"","firstPublishedAt":1533056616464,"updatedAt":1534155212764,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:acb3b9d8b80a-viewerId:lo_e418b373fc33"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:security"},{"__ref":"Tag:malware-analysis"},{"__ref":"Tag:threat-intelligence"}],"isFeaturedInPublishedPublication":false,"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1435,"layerCake":4}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.4844857f.js"></script><script src="https://cdn-client.medium.com/lite/static/js/4164.63b05cfd.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.0df7aaf2.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.5bef8967.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4505.6dfaf853.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9380.fb176dee.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.14632006.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.2791b202.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.e7627065.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4737.f07510eb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7381.7f2aa00a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6372.2eeebbff.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7938.607ab959.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6240.ce1d8647.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6199.4827c642.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4929.485ef991.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3623.7c96e20d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7979.15bcd496.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.de4e470a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.ba40f706.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8664.b06e2cc0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4378.14d600be.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/144.54e8afc4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3666.cdb15b43.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8768.c294838b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1069.499eaa23.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3523.a6edc225.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3515.71934948.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.1d221cdc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.0d800846.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.1770f8f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.2bee425e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.55ad176a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.00cf71c8.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9273711659337fa4',t:'MTc0MzEyNjI2MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"9273711659337fa4","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>