<!doctype html><html lang="en"><head><title data-rh="true">Deep analysis of REvil Ransomware | Written in Korean | by S2W | S2W BLOG | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" name="apple-itunes-app" content="app-id=828256236, app-argument=/s2wblog/deep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317, affiliate-data=ct=smart_app_banner"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2021-06-25T03:17:29.195Z"/><meta data-rh="true" name="title" content="Deep analysis of REvil Ransomware | Written in Korean | by S2W | S2W BLOG | Medium"/><meta data-rh="true" property="og:title" content="Deep analysis of REvil Ransomware | Written in Korean"/><meta data-rh="true" property="al:android:url" content="medium://p/d1899c0e9317"/><meta data-rh="true" property="al:ios:url" content="medium://p/d1899c0e9317"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="REvil 랜섬웨어는 RC4알고리즘을 이용하여 악성코드 내부에 포함된 Win32 API함수 주소, 설정정보 및 문자열을 복호화하고 악성 행위에 사용한다. 악성코드마다 사용되는 key는 상이하다.
RC4 key : 9UAo1qQ8ce4w13Jv36xcPgMz6NCykVjs REvil 랜섬웨어는 기존 랜섬웨어 그룹들이 주로 사용하는 RSA와 AES 알고리즘…"/><meta data-rh="true" property="og:description" content="Author: Sojun Ryu (hypen) @ S2WLAB Talon"/><meta data-rh="true" property="og:url" content="https://medium.com/s2wblog/deep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317"/><meta data-rh="true" property="al:web:url" content="https://medium.com/s2wblog/deep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*Qs6ckloSB92wDYDACISQoA.png"/><meta data-rh="true" property="article:author" content="https://s2w.medium.com"/><meta data-rh="true" name="author" content="S2W"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Deep analysis of REvil Ransomware | Written in Korean"/><meta data-rh="true" name="twitter:site" content="@s2w_official"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/d1899c0e9317"/><meta data-rh="true" property="twitter:description" content="Author: Sojun Ryu (hypen) @ S2WLAB Talon"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*Qs6ckloSB92wDYDACISQoA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@S2W_Official"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="32 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" rel="manifest" href="/manifest.json"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://s2w.medium.com"/><link data-rh="true" rel="canonical" href="https://medium.com/s2wblog/deep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/d1899c0e9317"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*Qs6ckloSB92wDYDACISQoA.png"],"url":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317","dateCreated":"2021-06-23T07:22:56.430Z","datePublished":"2021-06-23T07:22:56.430Z","dateModified":"2022-01-06T11:26:30.110Z","headline":"Deep analysis of REvil Ransomware | Written in Korean","name":"Deep analysis of REvil Ransomware | Written in Korean","description":"REvil 랜섬웨어는 RC4알고리즘을 이용하여 악성코드 내부에 포함된 Win32 API함수 주소, 설정정보 및 문자열을 복호화하고 악성 행위에 사용한다. 악성코드마다 사용되는 key는 상이하다.\nRC4 key : 9UAo1qQ8ce4w13Jv36xcPgMz6NCykVjs REvil 랜섬웨어는 기존 랜섬웨어 그룹들이 주로 사용하는 RSA와 AES 알고리즘…","identifier":"d1899c0e9317","author":{"@type":"Person","name":"S2W","url":"https:\u002F\u002Fs2w.medium.com"},"creator":["S2W"],"publisher":{"@type":"Organization","name":"S2W BLOG","url":"https:\u002F\u002Fmedium.com\u002Fs2wblog","logo":{"@type":"ImageObject","width":60,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:120\u002F1*dAAOzI0wCWzr0K3RGg2Pzw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317"}</script><style type="text/css" data-fela-rehydration="599" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="599" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.d{display:none}.m{display:block}.n{position:sticky}.o{top:0}.p{z-index:500}.q{padding:0 24px}.r{align-items:center}.s{border-bottom:solid 1px #F2F2F2}.z{height:41px}.ab{line-height:20px}.ac{display:flex}.ae{height:57px}.af{flex:1 0 auto}.ag{color:inherit}.ah{fill:inherit}.ai{font-size:inherit}.aj{border:none}.ak{font-family:inherit}.al{letter-spacing:inherit}.am{font-weight:inherit}.an{padding:0}.ao{margin:0}.ap{cursor:pointer}.aq:disabled{cursor:not-allowed}.ar:disabled{color:#6B6B6B}.as:disabled{fill:#6B6B6B}.av{width:auto}.aw path{fill:#242424}.ax{height:25px}.ay{margin-left:24px}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{height:24px}.bw{background-color:#F9F9F9}.bx{border-radius:50%}.by{height:32px}.bz{width:32px}.ca{flex:1 1 auto}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(26, 137, 23, 1)}.es{border-color:rgba(26, 137, 23, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(26, 137, 23, 1)}.ez:disabled:hover{border-color:rgba(26, 137, 23, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fg{margin-left:16px}.fh{border:inherit}.fk{margin-right:32px}.fl{position:relative}.fm{fill:#6B6B6B}.fp{background:transparent}.fq svg{margin-left:4px}.fr svg{fill:#6B6B6B}.ft{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fu{position:absolute}.fw{max-width:100%}.fx{overflow:hidden}.fy{text-overflow:ellipsis}.fz{white-space:nowrap}.ga{border-bottom:1px solid #F2F2F2}.gb{height:3px}.gc{max-width:1192px}.gi{font-weight:500}.gw{margin:0 8px}.gx{display:inline}.gy{font-size:16px}.gz{line-height:24px}.ha{pointer-events:none}.hb{will-change:opacity, transform}.hc{width:calc(100% - 0px)}.hf{opacity:0}.hg{transform:translateY(89px)}.hh{width:148px}.hi{border-radius:2px}.hj{height:38px}.hk{width:38px}.hm{margin-top:16px}.hn{word-break:break-word}.ht{margin:0 24px}.hx{background:rgba(255, 255, 255, 1)}.hy{border:1px solid #F2F2F2}.hz{box-shadow:0 1px 4px #F2F2F2}.ia{max-height:100vh}.ib{overflow-y:auto}.ic{left:0}.id{top:calc(100vh + 100px)}.ie{bottom:calc(100vh + 100px)}.if{width:10px}.ig{word-wrap:break-word}.ih:after{display:block}.ii:after{content:""}.ij:after{clear:both}.ik{line-height:1.23}.il{letter-spacing:0}.im{font-style:normal}.in{font-weight:700}.jx{gap:12px}.jy{align-items:baseline}.jz{width:36px}.ka{height:36px}.kb{border:2px solid rgba(255, 255, 255, 1)}.kc{z-index:0}.kd{box-shadow:none}.ke{border:1px solid rgba(0, 0, 0, 0.05)}.kf{margin-bottom:2px}.kg{flex-wrap:nowrap}.ki{width:12px}.kj{background:0}.kk path{stroke:#242424}.kl{border-radius:24px}.km{width:66px}.kn{padding:6px 12px 6px 12px}.ko{word-break:keep-all}.kp{flex-wrap:wrap}.kq{padding-left:8px}.kr{padding-right:8px}.ls> *{flex-shrink:0}.lt{overflow-x:scroll}.lu::-webkit-scrollbar{display:none}.lv{scrollbar-width:none}.lw{-ms-overflow-style:none}.lx{width:74px}.ly{flex-direction:row}.lz{z-index:2}.ma{margin-right:4px}.md{-webkit-user-select:none}.me{border:0}.mf{fill:rgba(117, 117, 117, 1)}.mi{outline:0}.mj{user-select:none}.mk> svg{pointer-events:none}.mt{cursor:progress}.mu{opacity:1}.mv{padding:4px 0}.my{margin-top:0px}.mz{width:16px}.nb{padding:8px 2px}.nc svg{color:#6B6B6B}.nt{line-height:1.58}.nu{letter-spacing:-0.004em}.nv{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.on{margin-bottom:-0.46em}.oo{background:none}.op{color:rgba(26, 137, 23, 1)}.oq{box-shadow:inset 3px 0 0 0 #242424}.or{padding-left:23px}.os{margin-left:-20px}.ot{font-style:italic}.ou{clear:both}.pd{margin-left:auto}.pe{margin-right:auto}.pf{max-width:5122px}.pl{padding-top:5px}.pm{padding-bottom:5px}.po{cursor:zoom-in}.pp{z-index:auto}.pr{height:auto}.ps{margin-top:10px}.pt{max-width:728px}.pw{text-decoration:underline}.px{line-height:1.12}.py{letter-spacing:-0.022em}.pz{font-weight:600}.qs{margin-bottom:-0.28em}.qt{line-height:1.18}.qz{margin-bottom:-0.31em}.rf{list-style-type:disc}.rg{margin-left:30px}.rh{padding-left:0px}.rn{max-width:1920px}.ro{overflow-x:auto}.rp{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.rq{padding:20px}.rr{border-radius:0}.rs{background:#F2F2F2}.rt{margin-top:-0.09em}.ru{margin-bottom:-0.09em}.rv{white-space:pre-wrap}.rw{min-width:fit-content}.rx{margin-top:32px}.ry{margin-bottom:14px}.rz{padding-top:24px}.sa{padding-bottom:10px}.sb{background-color:#000000}.sc{width:3px}.sd{margin-right:20px}.sj{padding:2px 4px}.sk{font-size:75%}.sl> strong{font-family:inherit}.sm{max-width:1564px}.sn{max-width:1320px}.so{max-width:1436px}.sp{max-width:1568px}.sq{max-width:1540px}.sr{max-width:1458px}.ss{list-style-type:decimal}.st{max-width:1572px}.su{max-width:4226px}.sv{max-width:1432px}.sw{max-width:1434px}.sx{max-width:1444px}.sy{max-width:2576px}.sz{max-width:3168px}.ta{max-width:1310px}.tb{max-width:2600px}.tc{margin-top:0.91em}.td{max-width:1954px}.te{max-width:1062px}.tf{max-width:1394px}.tg{margin-bottom:26px}.th{margin-top:6px}.ti{margin-top:8px}.tj{margin-right:8px}.tk{padding:8px 16px}.tl{border-radius:100px}.tm{transition:background 300ms ease}.to{border-top:none}.tp{margin-bottom:50px}.tq{height:52px}.tr{max-height:52px}.ts{box-sizing:content-box}.tt{position:static}.tu{z-index:1}.tw{max-width:155px}.uc{flex:0 0 auto}.ud{margin-bottom:64px}.ue{margin-bottom:48px}.ur{height:48px}.us{width:48px}.ut{height:64px}.uu{width:64px}.uv{align-self:flex-end}.uw{border-radius:19px}.ux{padding:9px 16px 9px 16px}.vb{padding-right:4px}.vi{margin-bottom:54px}.vj{height:0px}.vk{gap:18px}.vl{fill:rgba(61, 61, 61, 1)}.vx{border-bottom:solid 1px #E5E5E5}.vy{margin-top:72px}.vz{padding:24px 0}.wa{margin-bottom:0px}.wb{margin-right:16px}.at:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.au:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(15, 115, 12, 1)}.eu:hover{border-color:rgba(15, 115, 12, 1)}.ev:hover{cursor:pointer}.fn:hover{color:#242424}.fo:hover{fill:#242424}.fs:hover svg{fill:#242424}.fv:hover{background-color:rgba(0, 0, 0, 0.1)}.hl:hover{background-color:none}.kh:hover{text-decoration:underline}.mh:hover{fill:rgba(8, 8, 8, 1)}.mw:hover{fill:#000000}.mx:hover p{color:#000000}.na:hover{color:#000000}.nd:hover svg{color:#000000}.tn:hover{background-color:#F2F2F2}.vm:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.mg:focus{fill:rgba(8, 8, 8, 1)}.ne:focus svg{color:#000000}.pq:focus{transform:scale(1.01)}.ml:active{border-style:none}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="all and (min-width: 1080px)">.e{display:none}.bv{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fj{display:flex}.gh{max-width:250px}.gt{font-size:20px}.gu{line-height:24px}.gv{letter-spacing:0}.hs{margin-bottom:50px}.hw{max-width:680px}.ji{font-size:42px}.jj{margin-top:1.19em}.jk{margin-bottom:32px}.jl{line-height:52px}.jm{letter-spacing:-0.011em}.jv{align-items:center}.jw{flex-direction:row}.le{border-top:solid 1px #F2F2F2}.lf{border-bottom:solid 1px #F2F2F2}.lg{margin:32px 0 0}.lh{padding:3px 8px}.lq> *{margin-right:24px}.lr> :last-child{margin-right:0}.ms{margin-top:0px}.ok{margin-top:2.14em}.ol{line-height:32px}.om{letter-spacing:-0.003em}.pc{max-width:1192px}.pk{margin-top:56px}.qo{font-size:24px}.qp{margin-top:1.95em}.qq{line-height:30px}.qr{letter-spacing:-0.016em}.qy{margin-top:1.72em}.re{margin-top:0.94em}.rm{margin-top:1.14em}.si{margin-top:1.25em}.ub{display:inline-block}.uh{margin-bottom:0}.ui{margin-right:20px}.uy{max-width:500px}.vr{margin:40px 0 0}.vw{padding-top:72px}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.f{display:none}.mr{margin-top:0px}.pu{margin-left:auto}.pv{text-align:center}.ua{display:inline-block}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="all and (max-width: 903.98px)">.g{display:none}.mq{margin-top:0px}.tz{display:inline-block}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="all and (max-width: 727.98px)">.h{display:none}.mo{margin-top:0px}.mp{margin-right:0px}.ty{display:inline-block}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="all and (max-width: 551.98px)">.i{display:none}.t{display:flex}.u{justify-content:space-between}.br{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.gd{max-width:150px}.gj{font-size:16px}.gk{letter-spacing:0}.ho{margin-bottom:2px}.io{font-size:32px}.ip{margin-top:1.01em}.iq{margin-bottom:24px}.ir{line-height:38px}.is{letter-spacing:-0.014em}.jn{align-items:flex-start}.jo{flex-direction:column-reverse}.ks{margin:24px -24px 0}.kt{padding:0}.li> *{margin-right:8px}.lj> :last-child{margin-right:24px}.mb{margin-left:0px}.mm{margin-top:0px}.mn{margin-right:0px}.nf{border:1px solid #F2F2F2}.ng{border-radius:99em}.nh{padding:0px 16px 0px 12px}.ni{height:38px}.nj{align-items:center}.nl svg{margin-right:8px}.nw{font-size:18px}.nx{margin-top:1.56em}.ny{line-height:28px}.nz{letter-spacing:-0.003em}.ov{margin:0}.ow{max-width:100%}.pg{margin-top:40px}.qa{font-size:20px}.qb{margin-top:1.2em}.qc{line-height:24px}.qu{margin-top:1.23em}.ra{margin-top:0.67em}.ri{margin-top:1.34em}.se{margin-top:0.93em}.tx{display:inline-block}.ug{flex-direction:column}.up{margin-bottom:20px}.uq{margin-right:0}.vc{font-size:24px}.vd{line-height:30px}.ve{letter-spacing:-0.016em}.vn{margin:32px 0 0}.vs{padding-top:48px}.nk:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.j{display:none}.bu{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fi{display:flex}.gg{max-width:250px}.gq{font-size:20px}.gr{line-height:24px}.gs{letter-spacing:0}.hr{margin-bottom:50px}.hv{max-width:680px}.jd{font-size:42px}.je{margin-top:1.19em}.jf{margin-bottom:32px}.jg{line-height:52px}.jh{letter-spacing:-0.011em}.jt{align-items:center}.ju{flex-direction:row}.la{border-top:solid 1px #F2F2F2}.lb{border-bottom:solid 1px #F2F2F2}.lc{margin:32px 0 0}.ld{padding:3px 8px}.lo> *{margin-right:24px}.lp> :last-child{margin-right:0}.oh{margin-top:2.14em}.oi{line-height:32px}.oj{letter-spacing:-0.003em}.pb{max-width:1192px}.pj{margin-top:56px}.qk{font-size:24px}.ql{margin-top:1.95em}.qm{line-height:30px}.qn{letter-spacing:-0.016em}.qx{margin-top:1.72em}.rd{margin-top:0.94em}.rl{margin-top:1.14em}.sh{margin-top:1.25em}.uj{margin-bottom:0}.uk{margin-right:20px}.uz{max-width:500px}.vq{margin:40px 0 0}.vv{padding-top:72px}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.k{display:none}.x{display:flex}.y{justify-content:space-between}.bt{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.gf{max-width:250px}.gn{font-size:20px}.go{line-height:24px}.gp{letter-spacing:0}.hq{margin-bottom:50px}.hu{max-width:680px}.iy{font-size:42px}.iz{margin-top:1.19em}.ja{margin-bottom:32px}.jb{line-height:52px}.jc{letter-spacing:-0.011em}.jr{align-items:center}.js{flex-direction:row}.kw{border-top:solid 1px #F2F2F2}.kx{border-bottom:solid 1px #F2F2F2}.ky{margin:32px 0 0}.kz{padding:3px 8px}.lm> *{margin-right:24px}.ln> :last-child{margin-right:0}.oe{margin-top:2.14em}.of{line-height:32px}.og{letter-spacing:-0.003em}.oz{margin:0}.pa{max-width:100%}.pi{margin-top:56px}.qg{font-size:24px}.qh{margin-top:1.95em}.qi{line-height:30px}.qj{letter-spacing:-0.016em}.qw{margin-top:1.72em}.rc{margin-top:0.94em}.rk{margin-top:1.14em}.sg{margin-top:1.25em}.ul{margin-bottom:0}.um{margin-right:20px}.va{max-width:500px}.vp{margin:40px 0 0}.vu{padding-top:72px}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.l{display:none}.v{display:flex}.w{justify-content:space-between}.bs{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.ge{max-width:150px}.gl{font-size:16px}.gm{letter-spacing:0}.hp{margin-bottom:2px}.it{font-size:32px}.iu{margin-top:1.01em}.iv{margin-bottom:24px}.iw{line-height:38px}.ix{letter-spacing:-0.014em}.jp{align-items:flex-start}.jq{flex-direction:column-reverse}.ku{margin:24px 0 0}.kv{padding:0}.lk> *{margin-right:8px}.ll> :last-child{margin-right:8px}.mc{margin-left:0px}.nm{border:1px solid #F2F2F2}.nn{border-radius:99em}.no{padding:0px 16px 0px 12px}.np{height:38px}.nq{align-items:center}.ns svg{margin-right:8px}.oa{font-size:18px}.ob{margin-top:1.56em}.oc{line-height:28px}.od{letter-spacing:-0.003em}.ox{margin:0}.oy{max-width:100%}.ph{margin-top:40px}.qd{font-size:20px}.qe{margin-top:1.2em}.qf{line-height:24px}.qv{margin-top:1.23em}.rb{margin-top:0.67em}.rj{margin-top:1.34em}.sf{margin-top:0.93em}.uf{flex-direction:column}.un{margin-bottom:20px}.uo{margin-right:0}.vf{font-size:24px}.vg{line-height:30px}.vh{letter-spacing:-0.016em}.vo{margin:32px 0 0}.vt{padding-top:48px}.nr:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="print">.tv{display:none}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.hd{transition:opacity 200ms}.pn{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="599" data-fela-type="RULE" media="all and (max-width: 1232px)">.he{display:none}</style></head><body><div id="root"><div class="a b c"><a href="/sitemap/sitemap.xml" class="d">Sitemap</a><div class="e f g h i j k l"></div><script>document.domain = document.domain;</script><div class="m c"><div class="m n o p c"><div class="q r s t u v w x y j e z ab"><a class="du ah dv bf al b an ao ap aq ar as at au t v x j e r dw ab" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd1899c0e9317&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ac r"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fg m"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------">Sign in</a></span></p></div></div></div><div class="q r s ac ae"><div class="ac r af"><a class="ag ah ai aj ak al am an ao ap aq ar as at au ac" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=post_page---top_nav_layout_nav-----------------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" aria-labelledby="wordmark-medium-desc" viewBox="0 0 719 160" class="av aw ax"><desc id="wordmark-medium-desc">Medium Logo</desc><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ay i"><div class="ac aj az ba bb r bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ac"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="aj be bf bg ab bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="i l x fi fj"><div class="fk ac"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------"><div class="bf b bg ab du fl fm ac r fn fo"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt m">Write</div></div></a></span></div></div><div class="l k j e"><div class="fk ac"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=post_page---top_nav_layout_nav-----------------------------------------"><div class="bf b bg ab du fl fm ac r fn fo"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fk i l k"><div class="ac r"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fg m"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------">Sign in</a></span></p></div></div></div><div class="m" aria-hidden="false"><button class="aj fp an ac r ap fq fr fs" aria-label="user options menu" data-testid="headerUserIcon"><div class="m fl"><img alt="" class="m fd bx by bz cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="ft bx m by bz fu o aj fv"></div></div></button></div></div></div><div class="ac"><div class="ca bh"><div class="m"><div><div class="ga bh m"><div class="gb bh bj"></div><div class="ac cb"><div class="cc cd ce cf cg gc ci bh"><div class="ae ac r"><div class="gd ge gf gg gh m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://medium.com/s2wblog?source=post_page---publication_nav-30a8766b5c42-d1899c0e9317---------------------------------------" rel="noopener follow"><h2 class="bf gi gj dy gk gl ea gm gn go gp gq gr gs gt gu gv bk"><div class="fw fx fy fz">S2W BLOG</div></h2></a></div><div class="t v k j e"><span class="gw gx" aria-hidden="true"><span class="bf b gy gz bk">·</span></span><p class="bf b gy gz bk"></p></div></div></div></div></div></div><div class="ha fu hb hc o hd he hf hg"><div class="ac cb"><div class="cc cd ce cf cg gc ci bh"><div class="hh m"><div class="ha"><div class="ac cn co"><a href="https://medium.com/s2wblog?source=post_page---post_publication_sidebar-30a8766b5c42-d1899c0e9317---------------------------------------" rel="noopener follow"><div class="fl"><img alt="S2W BLOG" class="cx hi m hk hj" src="https://miro.medium.com/v2/resize:fill:76:76/1*3vCxewFUeWWkQ-O5X558rQ.jpeg" width="38" height="38" loading="lazy"/><div class="hi m hj hk fu o ft hl"></div></div></a><div class="hm m"></div><p class="bf b bg ab du"><span class="hn">S2W is a big data intelligence company specialized in the Dark Web, Deepweb and any other covert channels.</span></p><div class="hm m"></div><p class="bf b bg ab bk"></p></div></div></div></div></div></div><div class="ho hp hq hr hs m"><div class="ac cb"><div class="ci bh ht hu hv hw"></div></div><article><div class="m"><div class="m"><span class="m"></span><section><div><div class="fu ic id ie if ha"></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><div><h1 id="b7dd" class="pw-post-title ik il im bf in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bk" data-testid="storyTitle">Deep analysis of REvil Ransomware | Written in Korean</h1><div><div class="speechify-ignore ac cp"><div class="speechify-ignore bh m"><div class="ac jn jo jp jq jr js jt ju jv jw jx"><div class="ac r jx"><div class="ac jy"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><a rel="noopener follow" href="/@s2w?source=post_page---byline--d1899c0e9317---------------------------------------"><div class="m jz ka bx kb kc"><div class="m fl"><img alt="S2W" class="m fd bx by bz cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*1DiWQYMzvUSAzrLJQX1z6g.png" width="32" height="32" loading="lazy" data-testid="authorPhoto"/><div class="kd bx m by bz fu o ke fv"></div></div></div></a></div></div></div></div><span class="bf b bg ab bk"><div class="kf ac r"><div class="ac r kg"><div class="ac r"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><span class="bf b bg ab bk"><a class="ag ah ai fh ak al am an ao ap aq ar as kh" data-testid="authorName" rel="noopener follow" href="/@s2w?source=post_page---byline--d1899c0e9317---------------------------------------">S2W</a></span></div></div></div></div><div class="ki bm"></div><div class="bm" aria-hidden="false"><button style="border:1px solid rgba(0, 0, 0, 0)" class="kj kk ap ac cb r aq ex kl km kn"><span class="bf b bg ab bk bh"><span class="bm ko">Follow</span></span></button></div></div></div></span></div><div class="ac r kp"><span class="bf b bg ab du"><div class="ac af"><span data-testid="storyReadTime">32 min read</span><div class="kq kr m" aria-hidden="true"><span class="m" aria-hidden="true"><span class="bf b bg ab du">·</span></span></div><span data-testid="storyPublishDate">Jun 23, 2021</span></div></span></div></div><div class="ac cp ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh"><div class="i l x fi fj r"><div class="lx m"><div class="ac r ly lz"><div class="pw-multi-vote-icon fl ma mb mc md"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fs2wblog%2Fd1899c0e9317&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317&amp;user=S2W&amp;userId=b408bb1e7c46&amp;source=---header_actions--d1899c0e9317---------------------clap_footer------------------"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><div class="me ap mf mg mh mi an mj mk ml md" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m mm mn mo mp mq mr ms"><p class="bf b dv ab du"><span class="mt">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><button class="ap me mu mv ac r fm mw mx" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="my"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ac r li lj lk ll lm ln lo lp lq lr ls lt lu lv lw"><div class="mz l k j e"></div><div class="i l"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1899c0e9317&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317&amp;source=---header_actions--d1899c0e9317---------------------bookmark_footer------------------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du na" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ag fm ai fh ak al am nb ao ap aq ex nc nd mx ne nf ng nh ni t nj nk nl nm nn no np v nq nr ns"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bf b bg ab du">Share</p></div></button></div></div></div></div></div></div></div></div></div></div><p id="a2a5" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">Author</strong>: Sojun Ryu (<span class="gx"><span class="gx" aria-hidden="false"><div tabindex="-1" class="be"><a class="oo op fe" href="https://medium.com/u/c109a5c416ae?source=post_page---user_mention--d1899c0e9317---------------------------------------" rel="noopener" target="_blank">hypen</a></div></span></span>) @ S2WLAB Talon</p><blockquote class="oq or os"><p id="ab94" class="nt nu ot nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">We are working on the English version. Coming soon!</p></blockquote></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe pf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Qs6ckloSB92wDYDACISQoA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Qs6ckloSB92wDYDACISQoA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Qs6ckloSB92wDYDACISQoA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Qs6ckloSB92wDYDACISQoA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Qs6ckloSB92wDYDACISQoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Qs6ckloSB92wDYDACISQoA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Qs6ckloSB92wDYDACISQoA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Qs6ckloSB92wDYDACISQoA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Qs6ckloSB92wDYDACISQoA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Qs6ckloSB92wDYDACISQoA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Qs6ckloSB92wDYDACISQoA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Qs6ckloSB92wDYDACISQoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Qs6ckloSB92wDYDACISQoA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Qs6ckloSB92wDYDACISQoA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="367" loading="eager" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">Photo by <a class="ag pw" href="https://unsplash.com/@cbpsc1?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Clint Patterson</a> on <a class="ag pw" href="https://unsplash.com/s/photos/hacker?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="0328" class="px py im bf pz qa qb qc gk qd qe qf gm qg qh qi qj qk ql qm qn qo qp qq qr qs bk">Executive Summary</h1><h2 id="e058" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">침투과정</h2><ul class=""><li id="e3e0" class="nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on rf rg rh bk">2019년 4월에 처음 등장한 REvil 랜섬웨어는 초기 오라클 웹로직 취약점 (CVE-2019–2725)을 이용하여 다양한 환경에 최초 침투를 시도</li><li id="105e" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">이후 Pulse Secure VPN 취약점 (CVE-2019–11510), FortiOS VPN 취약점 (CVE-2018–13379) 및 RDP 취약점 등 제로데이 취약점이 아닌, 패치가 적용되기 전의 N-day 취약점을 통해 기업 환경에 침투를 시도하여 매우 많은 기업을 감염시킴</li><li id="fc0e" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">최근에는 다크웹에서 이미 유명한 악성코드인 Gootkit, QBot, IcedId와 같은 다운로드 및 로드에 특화된 악성코드에 의해 실행됨</li></ul><h2 id="8265" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">주요 특징</h2><ul class=""><li id="f558" class="nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on rf rg rh bk">암호화 키 교환 시, 랜섬웨어 악성코드들이 주로 사용하는 RSA를 사용하지 않고 타원 곡선 기반 암호(Elliptic Curve Cryptography)를 사용하며, 파일 암호화에는 Salsa20 알고리즘을 이용하여 파일을 암호화</li><li id="e001" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">로컬 드라이브 내 파일 뿐만 아니라 원격 드라이브 및 공유 드라이브 내 파일도 암호화하며, IOCP기법을 사용한 비동기 I/O방식으로 암호화 속도를 높임</li><li id="2c38" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">2019년 12월부터 자체 Leak 사이트를 운영하여 피해 기업으로부터 탈취한 데이터를 게시하며, 협상에 응하지 않을 시 데이터를 공개하는 이중 갈취 전략을 사용.</li><li id="515b" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">비트코인을 통해 몸값을 지불받다가 2020년 4월부터 모네로로 변경함. 하지만 최근에는 피해자가 비트코인으로 지불을 원할 시, 10% 추가 금액을 낼 경우 비트코인으로도 지불받음</li><li id="43a5" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">2021년 2월부터는 기존 Leak 사이트를 통한 이중 갈취 전략에서 홈페이지 DDoS 공격 및 피해 기업의 비즈니스 파트너에게 VoIP로 연락하는 협박 방식을 추가하겠다고 언급</li></ul><h2 id="e3bb" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">최근 이슈</h2><ul class=""><li id="45e2" class="nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on rf rg rh bk">최근 Darkside의 Colonial Pipeline 공격, REvil 랜섬웨어의 JBS 공격 이후로 미국이 랜섬웨어 공격에 강력하게 대처하겠다는 발표 후, REvil은 오히려 미국에 대한 공격을 멈추지 않고, 더욱 더 강화하겠다고 언급함</li><li id="e3ce" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">현재까지 REvil 랜섬웨어 조직은 Darkside 랜섬웨어 조직, LV 랜섬웨어 조직과 Prometheus 조직까지 최소 3개의 랜섬웨어 조직과 연관되어있음</li></ul></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe rn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*sgzuMd7v675NXHydNMbUoA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*sgzuMd7v675NXHydNMbUoA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*sgzuMd7v675NXHydNMbUoA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*sgzuMd7v675NXHydNMbUoA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*sgzuMd7v675NXHydNMbUoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*sgzuMd7v675NXHydNMbUoA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*sgzuMd7v675NXHydNMbUoA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*sgzuMd7v675NXHydNMbUoA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*sgzuMd7v675NXHydNMbUoA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*sgzuMd7v675NXHydNMbUoA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*sgzuMd7v675NXHydNMbUoA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*sgzuMd7v675NXHydNMbUoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*sgzuMd7v675NXHydNMbUoA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*sgzuMd7v675NXHydNMbUoA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="1035" loading="eager" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">Overall flow of REvil Ransomware</figcaption></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="daa3" class="px py im bf pz qa qb qc gk qd qe qf gm qg qh qi qj qk ql qm qn qo qp qq qr qs bk">Malware Information</h1><pre class="pg ph pi pj pk ro rp rq rr aj rs bk"><span id="3db4" class="qt py im rp b gy rt ru m rv rw"><strong class="rp in">MD5</strong> : 2075566e7855679d66705741dabe82b4<br/><strong class="rp in">SHA-1</strong> : 136443e2746558b403ae6fc9d9b40bfa92b23420<br/><strong class="rp in">SHA-256</strong> : 12d8bfa1aeb557c146b98f069f3456cc8392863a2f4ad938722cd7ca1a773b39<br/><strong class="rp in">Compile Time</strong>: 2021–03–21 21:46:43<br/><strong class="rp in">File type</strong> : Win32 EXE file</span></pre></div></div></div><div class="ac cb rx ry rz sa" role="separator"><span class="sb bx bm gb sc sd"></span><span class="sb bx bm gb sc sd"></span><span class="sb bx bm gb sc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="17c4" class="px py im bf pz qa se qc gk qd sf qf gm qg sg qi qj qk sh qm qn qo si qq qr qs bk">Detailed Analysis</h1><h2 id="6d93" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">1. RC4 알고리즘을 이용하여 데이터 복호화</h2><p id="0d53" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">REvil 랜섬웨어는 RC4알고리즘을 이용하여 악성코드 내부에 포함된 Win32 API함수 주소, 설정정보 및 문자열을 복호화하고 악성 행위에 사용한다. 악성코드마다 사용되는 key는 상이하다.<br/><code class="cx sj sk sl rp b">RC4 key : 9UAo1qQ8ce4w13Jv36xcPgMz6NCykVjs</code></p><h2 id="e797" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">2. 상세 옵션을 통해 세부 기능 설정</h2><p id="64b8" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">복호화된 정보 중 악성 행위에 필요한 19개의 상세 옵션이 JSON 형태로 표현되어 있다. 분석한 샘플인 2.05 버전의 각 옵션별 기능은 아래와 같다.</p></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe sm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*GRsqaoitWYtOriCIfiIXrg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GRsqaoitWYtOriCIfiIXrg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GRsqaoitWYtOriCIfiIXrg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GRsqaoitWYtOriCIfiIXrg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GRsqaoitWYtOriCIfiIXrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GRsqaoitWYtOriCIfiIXrg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*GRsqaoitWYtOriCIfiIXrg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*GRsqaoitWYtOriCIfiIXrg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GRsqaoitWYtOriCIfiIXrg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GRsqaoitWYtOriCIfiIXrg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GRsqaoitWYtOriCIfiIXrg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GRsqaoitWYtOriCIfiIXrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GRsqaoitWYtOriCIfiIXrg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*GRsqaoitWYtOriCIfiIXrg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="692" loading="eager" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">Table 1. 상세 옵션표</figcaption></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><h2 id="81be" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">3. 암호화 사전 작업</h2><p id="f12b" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">REvil 랜섬웨어는 기존 랜섬웨어 그룹들이 주로 사용하는 RSA와 AES 알고리즘 조합을 사용하지 않고, ECC Diffie hellman 키 교환과 AES-256이 결합된 ECIES 공개키 알고리즘과 Salsa20 비밀키 알고리즘으로 파일 및 데이터를 암호화한다. 이를 위해 악성코드 내에 하드코딩 된 key를 이용하여 암호화에 필요한 구조체 데이터를 사전에 생성하며, 이를 레지스트리에 저장하여 재실행되어도 기존에 생성된 key를 사용함으로써 해당 값이 바뀌지 않도록 한다. 사용되는 레지스트리는 REvil 랜섬웨어 버전별로 상이하다.</p></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe sn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jjJa5X6R5KMpapZFLSUOLQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jjJa5X6R5KMpapZFLSUOLQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jjJa5X6R5KMpapZFLSUOLQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jjJa5X6R5KMpapZFLSUOLQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jjJa5X6R5KMpapZFLSUOLQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jjJa5X6R5KMpapZFLSUOLQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*jjJa5X6R5KMpapZFLSUOLQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jjJa5X6R5KMpapZFLSUOLQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jjJa5X6R5KMpapZFLSUOLQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jjJa5X6R5KMpapZFLSUOLQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jjJa5X6R5KMpapZFLSUOLQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jjJa5X6R5KMpapZFLSUOLQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jjJa5X6R5KMpapZFLSUOLQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*jjJa5X6R5KMpapZFLSUOLQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="863" loading="eager" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">Ecryption Flow</figcaption></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><p id="0266" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1) 레지스트리 path : HKLM\SOFTWARE\BlackLivesMatter</p><pre class="pg ph pi pj pk ro rp rq rr aj rs bk"><span id="4b5a" class="qt py im rp b gy rt ru m rv rw">key : 54k =&gt; value : 공격자 공개키 (pk)<br/>key : aOwO =&gt; value : 파일 암호화 key생성에 사용된 공개키 (pk_key)<br/>key : Krdfp =&gt; value : 공격자 공개키로 암호화된 비밀키 구조체 (sk_key struct)<br/>key : hq0G6x =&gt; value : 제작자 마스터키로 암호화된 비밀키 구조체 (0_key struct)</span></pre><p id="42be" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2) HKLM 경로에 등록 실패 시 HKCU로 변경하여 등록 시도</p><h2 id="18c7" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">4. 감염기기 정보 수집</h2><p id="084c" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">이후 감염된 기기의 정보를 수집한다. 수집 목록은 아래와 같다.</p><p id="05f4" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1) 감염기기 식별 값 (UID)</p><ul class=""><li id="6bdc" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">현재 디스크의 VolumeSerial과 프로세서 이름을 수집</li><li id="20b6" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">각각의 CRC32 체크섬 값을 조합한 16글자 문자열</li><li id="dc3b" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">예시 : 3EE1CF8D0ECB68EF</li></ul><p id="570d" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2) 암호화 확장자 (Extension)</p><ul class=""><li id="2995" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">5~10개의 랜덤 문자 조합 문자열 (기존 화이트리스트에 포함되지 않은)</li><li id="beef" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">예시 : 670o6j8nm</li><li id="a60c" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">이후 레지스트리에 생성한 랜덤 확장자 저장</li><li id="a7ea" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Path : HKLM\ SOFTWARE\\BlackLivesMatter</li><li id="ec0f" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Key : x4WHjRs → value : [랜덤 확장자]</li><li id="8932" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">HKLM 경로에 등록 실패 시 HKCU로 경로 변경</li></ul><p id="e03e" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3) 유저명<br/>4) 컴퓨터명<br/>5) 현재 기기의 도메인명 <code class="cx sj sk sl rp b">도메인이 없을 경우 WORKGROUP으로 지정<br/></code>6) 현재 지역 및 사용 언어<br/>7) 현재 유저의 사용 언어, 시스템의 기본 언어, 키보드 layout을 수집 후 CIS 국가 여부 확인</p><pre class="pg ph pi pj pk ro rp rq rr aj rs bk"><span id="5b4b" class="qt py im rp b gy rt ru m rv rw"><em class="ot">CIS: Commonwealth of Independent States 의 약자로 1991년 소련(소비에트 연방)의 해체로 독립한 국가들의 국제기구. 러시아, 몰도바, 벨라루스, 아르메니아, 아제르바이잔, 우즈베키스탄, 카자흐스탄, 키르기스스탄, 타지키스탄이 공식 회원국으로 참여하고 있으며 투르크메니스탄, 몽골, 아프가니스탄은 비공식 참관국으로 참여하고 있음</em></span></pre><p id="7639" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">8) 운영체제 버전<br/>9) 디스크 별 전체 용량 및 사용 가능한 용량<br/>10) 컴퓨터 x86, x64 여부</p><h2 id="459d" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">5. CIS국가 여부 확인</h2><p id="061d" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">상세 옵션 중 dbg옵션이 False일 경우, 아래와 같이 유저 및 시스템 언어, 키보드 layout을 확인하여 CIS(독립국가연합) 지역의 기기일 경우 악성 행위를 수행하지 않는다. 반면 dbg 옵션이 True일 경우 공격자들의 디버깅용으로 실행되며 언어 및 layout을 확인하지 않는다.</p><figure class="pg ph pi pj pk ou pd pe paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe sm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*rvF55xZVqIKfvnALL_c6Lg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*rvF55xZVqIKfvnALL_c6Lg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*rvF55xZVqIKfvnALL_c6Lg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*rvF55xZVqIKfvnALL_c6Lg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*rvF55xZVqIKfvnALL_c6Lg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rvF55xZVqIKfvnALL_c6Lg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rvF55xZVqIKfvnALL_c6Lg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*rvF55xZVqIKfvnALL_c6Lg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*rvF55xZVqIKfvnALL_c6Lg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*rvF55xZVqIKfvnALL_c6Lg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*rvF55xZVqIKfvnALL_c6Lg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*rvF55xZVqIKfvnALL_c6Lg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*rvF55xZVqIKfvnALL_c6Lg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*rvF55xZVqIKfvnALL_c6Lg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh fw pr c" width="700" height="440" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">Table 2. 유저/시스템 언어와 키보드 레이아웃</figcaption></figure><h2 id="76dd" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">6. 파라미터를 통한 실행 모드 지정</h2></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe so"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VbXk_qbvRQUoREVyrDC8qg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VbXk_qbvRQUoREVyrDC8qg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VbXk_qbvRQUoREVyrDC8qg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VbXk_qbvRQUoREVyrDC8qg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VbXk_qbvRQUoREVyrDC8qg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VbXk_qbvRQUoREVyrDC8qg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*VbXk_qbvRQUoREVyrDC8qg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*VbXk_qbvRQUoREVyrDC8qg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VbXk_qbvRQUoREVyrDC8qg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VbXk_qbvRQUoREVyrDC8qg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VbXk_qbvRQUoREVyrDC8qg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VbXk_qbvRQUoREVyrDC8qg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VbXk_qbvRQUoREVyrDC8qg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*VbXk_qbvRQUoREVyrDC8qg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="324" loading="eager" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">Table 3. 파라미터 목록</figcaption></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><p id="6a4e" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><code class="cx sj sk sl rp b"><strong class="nv in">-nolan:</strong></code><strong class="nv in">네트워크 공유드라이브는 감염 대상에서 제외</strong></p><p id="8f2e" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1) 파라미터로 주어지지 않은 경우, 네트워크 드라이브 암호화 시도</p><p id="7f4d" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2) 원격 드라이브 암호화: A~Z드라이브 중 원격 드라이브 내 파일 암호화</p><p id="ac43" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3) 공유 드라이브</p><ul class=""><li id="3380" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">현재 연결된 모든 공유 리소스 내 파일 암호화</li><li id="70c5" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">네트워크 컨텍스트 내 모든 공유 리소스 내 파일 암호화</li><li id="54e4" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">네트워크의 모든 공유 리소스 내 파일 암호화</li><li id="87f1" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">영구적으로 연결된 모든 공유 리소스 내 파일 암호화</li><li id="b10a" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">최근 연결된 모든 공유 리 소스 내 파일 암호화</li></ul><p id="5464" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><code class="cx sj sk sl rp b"><strong class="nv in">-nolocal:</strong></code><strong class="nv in"> 로컬 드라이브는 감염 대상에서 제외</strong></p><p id="7d0f" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1) 파라미터로 주어지지 않은 경우, 로컬 드라이브 암호화 시도</p><p id="618c" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2) 로컬 드라이브 암호화: A~Z드라이브 중, 이동식 및 일반 드라이브 내 파일 암호화</p><p id="f15c" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><code class="cx sj sk sl rp b"><strong class="nv in">-smode:</strong></code><strong class="nv in"> 윈도우 계정 비밀번호 변경 및 안전모드로 재부팅</strong></p><p id="32b5" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1) 안전모드 부팅이 아닌, 정상 모드로 부팅되었을 경우에만 동작</p><p id="6216" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2) 안전모드에서 암호화를 할 경우, 백신 탐지를 우회하고 파일 암호화의 성공률이 높아질 수 있음</p><p id="69d4" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3) 현재 계정의 비밀번호를 “DTrump4ever”로 변경</p><p id="eece" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4) 레지스트리를 변경하여 변경된 비밀번호로 자동 로그인되도록 설정</p><ul class=""><li id="0ca9" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">Path : HKLM\ SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</li><li id="db6f" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Key : AutoAdminLogon → value : 1</li><li id="769a" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Key : DefaultUserName → value : 현재 유저 명</li><li id="ffc3" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Key : DefaultPassword → value : DTrump4ver</li></ul><p id="a945" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5) 레지스트리 변경 후 재부팅 완료시 악성코드 재실행 및 부팅 모드 정상 모드로 복구</p><ul class=""><li id="e411" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">Path : HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce</li><li id="7f4a" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Key : *AstraZeneca → value : 악성코드 파일 명</li><li id="e026" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">(Vista 이전) Key : *MarineLePen → value : bootcfg /raw /fastdetect /id 1</li><li id="4f37" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">(Vista 이후) Key : *MarineLePen → value : bcdedit /deletevalue {current} safeboot</li></ul><p id="3dd7" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">6) 설정 후, 부팅 모드를 네트워크 가능한 안전모드로 변경하는 명령어 실행</p><ul class=""><li id="6aab" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">(Vista 이전) 명령어 : bootcfg /raw /a /safeboot:network /id 1</li><li id="859d" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">(Vista 이후) 명령어 : bcdedit /set {current} safeboot network</li></ul><p id="8df3" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">7) 설정 완료 후 감염기기 재부팅</p><ul class=""><li id="2883" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">명령어 : SHUTDOWN -r -f -t 02</li><li id="53f4" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">2초 후 시스템을 강제로 재부팅</li></ul><p id="5dad" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><code class="cx sj sk sl rp b"><strong class="nv in">-silent:</strong></code><strong class="nv in"> 특정 서비스, 프로세스 종료 및 볼륨 섀도우 카피 삭제 수행하지 않음</strong></p><p id="c616" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1) 파라미터로 주어지지 않은 경우, 특정 서비스와 프로세스 종료 및 볼륨 섀도우 카피 삭제</p><p id="a209" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2) Win32 API를 이용하여 현재 실행 중인 특정 프로세스 종료</p><p id="1fad" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3) WMI로 신규 프로세스 생성 Event를 모니터링하여 특정 프로세스 생성 시 종료</p><p id="24df" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4) 특정 프로세스 목록</p></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe sp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*f3vK27N8RDAn9ft4n5BYgw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*f3vK27N8RDAn9ft4n5BYgw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*f3vK27N8RDAn9ft4n5BYgw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*f3vK27N8RDAn9ft4n5BYgw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*f3vK27N8RDAn9ft4n5BYgw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*f3vK27N8RDAn9ft4n5BYgw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*f3vK27N8RDAn9ft4n5BYgw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*f3vK27N8RDAn9ft4n5BYgw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*f3vK27N8RDAn9ft4n5BYgw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*f3vK27N8RDAn9ft4n5BYgw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*f3vK27N8RDAn9ft4n5BYgw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*f3vK27N8RDAn9ft4n5BYgw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*f3vK27N8RDAn9ft4n5BYgw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*f3vK27N8RDAn9ft4n5BYgw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="424" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><p id="a841" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5) Win32 API를 이용하여 현재 실행 중인 특정 서비스 종료</p><p id="84c4" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">6) WMI로 서비스 변동사항 Event를 모니터링하여 특정 서비스 실행 시 중지</p><p id="b9e5" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">7) 특정 서비스 목록</p></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe sq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*I20lTr4W8WsHWurr4aL1tg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*I20lTr4W8WsHWurr4aL1tg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*I20lTr4W8WsHWurr4aL1tg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*I20lTr4W8WsHWurr4aL1tg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*I20lTr4W8WsHWurr4aL1tg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*I20lTr4W8WsHWurr4aL1tg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*I20lTr4W8WsHWurr4aL1tg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*I20lTr4W8WsHWurr4aL1tg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*I20lTr4W8WsHWurr4aL1tg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*I20lTr4W8WsHWurr4aL1tg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*I20lTr4W8WsHWurr4aL1tg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*I20lTr4W8WsHWurr4aL1tg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*I20lTr4W8WsHWurr4aL1tg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*I20lTr4W8WsHWurr4aL1tg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="428" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><p id="a705" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">8) WQL(SQL for WMI) 쿼리를 이용하여 감염된 기기의 Volume Shadow Copy를 모두 삭제</p><ul class=""><li id="f2f3" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">WQL Query : SELECT * FROM Win32_ShadowCopy</li><li id="31b6" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">이후 Win32_ShadowCopy.ID=[조회한 ID]에 대하여 DeleteInstance 작업 수행</li></ul><p id="683f" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><code class="cx sj sk sl rp b"><strong class="nv in">-path:</strong></code><strong class="nv in"> 특정 경로에 대해서만 암호화 진행</strong></p><p id="6124" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1) 주어진 경로에 대해서만 파일 암호화 진행</p><p id="7529" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2) 네트워크 및 로컬 경로 여부 확인하여 진행</p><p id="6920" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3) 전체 파일 암호화 전에 공격자가 테스트 용도로 사용하는 기능</p><ul class=""><li id="cffb" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">-path로 실행될 경우 권한 상승, 정보유출, 바탕화면 변경 등을 수행하지 않음</li></ul><p id="8ee1" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><code class="cx sj sk sl rp b"><strong class="nv in">-fast:</strong></code><strong class="nv in"> 빠른 암호화 모드</strong></p><p id="d335" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1) -path와 함께 사용되며, 파일 암호화 시 상위 0x100000만 암호화를 수행</p><p id="ce4f" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2) 상세 옵션 중 et가 1일 때와 동일</p><p id="9d69" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><code class="cx sj sk sl rp b"><strong class="nv in">-full:</strong></code><strong class="nv in"> 전체 암호화 모드</strong></p><p id="4215" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1) -path와 함께 사용되며, 파일 암호화 시 파일 전체에 대해서 암호화를 수행</p><p id="15f9" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2) 상세 옵션 중 et가 0일 때와 동일</p><h2 id="c741" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">7. 동작 과정</h2><p id="8e68" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk"><strong class="nv in">1) 뮤텍스 생성</strong></p><p id="68d0" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">악성코드의 중복 실행 방지를 위해 특정 문자열을 이용하여 뮤텍스 생성</p><ul class=""><li id="914e" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">뮤텍스 명 : Global\\F69C27FF-AB15-CCAA-A2D6–7F7ADA90E7E3</li><li id="a2f2" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">문자열은 악성코드마다 다른 값을 사용</li><li id="7291" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">중복 실행 시 현재 프로세스를 종료</li></ul><p id="1efe" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">2) 상세 옵션 </strong><code class="cx sj sk sl rp b"><strong class="nv in">exp</strong></code><strong class="nv in"> (Table 1. 상세 옵션표 참고)에 따른 행위 수행</strong></p><ul class=""><li id="f8fd" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">유저가 관리자 권한을 갖고 있지만, 프로세스가 관리자 권한을 갖지 않은 경우 프로세스 재실행</li><li id="ad69" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">유저가 승낙할 때까지 관리자 권한으로 실행을 요구하는 UAC 수락 요청 창을 화면 상에 계속 표출</li></ul><p id="69f3" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">3) 암호화 작업 전 기타 행위</strong></p><ul class=""><li id="5dca" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">강제로 휴지통 비우기</li><li id="320a" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">프로세스의 CPU 스케줄링 우선순위를 일반 프로세스보다 한 단계 상승시켜 리소스 사용</li><li id="c6f8" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">프로세스가 실행되는 도중 절전 모드 전환 및 디스플레이 꺼짐 방지</li><li id="d50f" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">SeDebugPrivilege 권한을 할당하여 타 프로세스에 접근 가능하도록 권한 설정</li></ul><p id="b938" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">4) 상세 옵션 </strong><code class="cx sj sk sl rp b"><strong class="nv in">arn</strong></code><strong class="nv in"> (Table 1. 상세 옵션표 참고) 에 따른 행위 수행</strong></p><p id="75e1" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">레지스트리를 변경하여 기기를 재부팅하더라도 악성코드가 실행되도록 설정</p><ul class=""><li id="7a44" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">Path : HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</li><li id="76a0" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Key : 3&quot;qZhotTgfr3 → value : 악성코드 파일 명</li><li id="ea06" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">HKLM 경로에 등록 실패 시 HKCU로 변경</li></ul><p id="b92a" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">5) 바탕화면 변경</strong></p><p id="485b" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1. 바탕화면을 파란색 배경에 자신들의 메시지가 담긴 이미지로 변경</p><ul class=""><li id="2036" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">원본 이미지 파일 경로 : %temp%\[랜덤 3~13개의 문자열].bmp</li><li id="9d07" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">아래는 상세 옵션 img에 명시된 협박 메시지이며, 협박 메시지 상에 instuctions 은 instruction의 오타임</li></ul><pre class="pg ph pi pj pk ro rp rq rr aj rs bk"><span id="394f" class="qt py im rp b gy rt ru m rv rw">All of Your fiels are encrypted!<br/>Find [Random Extension]-readme.txt and follow instuctions</span></pre><ul class=""><li id="6c18" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">실제 변경된 바탕화면</li></ul></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe sr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*6k2-GLuhDZs36ZPdpBXQhQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*6k2-GLuhDZs36ZPdpBXQhQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*6k2-GLuhDZs36ZPdpBXQhQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*6k2-GLuhDZs36ZPdpBXQhQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*6k2-GLuhDZs36ZPdpBXQhQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*6k2-GLuhDZs36ZPdpBXQhQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*6k2-GLuhDZs36ZPdpBXQhQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*6k2-GLuhDZs36ZPdpBXQhQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*6k2-GLuhDZs36ZPdpBXQhQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*6k2-GLuhDZs36ZPdpBXQhQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*6k2-GLuhDZs36ZPdpBXQhQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*6k2-GLuhDZs36ZPdpBXQhQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*6k2-GLuhDZs36ZPdpBXQhQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*6k2-GLuhDZs36ZPdpBXQhQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="486" loading="eager" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">Compromised Background</figcaption></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><p id="105f" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">6) 상세 옵션 </strong><code class="cx sj sk sl rp b"><strong class="nv in">net</strong></code><strong class="nv in"> 에 따른 행위 수행</strong></p><ol class=""><li id="c866" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on ss rg rh bk">JSON 형태로 감염기기 정보 및 암호화에 사용된 정보 수집</li></ol><pre class="pg ph pi pj pk ro rp rq rr aj rs bk"><span id="d1cb" class="qt py im rp b gy rt ru m rv rw">{<br/>    &quot;ver&quot;: [REvil 랜섬웨어 버전],<br/>    &quot;pid&quot;: [악성코드 식별자], (상세옵션에 명시됨)<br/>    &quot;sub&quot;: [악성코드 식별자], (상세옵션에 명시됨)<br/>    &quot;pk&quot;: [암호화에 사용된 공개키 정보], (상세옵션에 명시됨)<br/>    &quot;uid&quot;: [Victim ID],<br/>    &quot;sk&quot;: [sk_key struct(비밀키 구조체)],<br/>    &quot;unm&quot;: [유저 명],<br/>    &quot;net&quot;: [컴퓨터 명],<br/>    &quot;grp&quot;: [도메인 명],<br/>    &quot;lng&quot;: [지역 및 사용언어],<br/>    &quot;bro&quot;: [CIS 국가 여부],<br/>    &quot;os&quot;: [운영체제 버전],<br/>    &quot;bit&quot;: [32bit 또는 64bit 여부],<br/>    &quot;dsk&quot;: [디스크 별 전체 용량 및 사용 가능한 용량 정보],<br/>    &quot;ext&quot;: [암호화 확장자]&quot;<br/>}</span></pre><p id="69b0" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. 모든 정보를 취합한 뒤, 파일과 동일한 방식으로 데이터를 암호화</p><ul class=""><li id="51d1" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">데이터 암호화에는 악성코드 내에 별도로 하드코딩된 공개 key 사용</li></ul><p id="baa7" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. 암호화한 데이터를 레지스트리에 저장</p><ul class=""><li id="ceeb" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">Path : HKLM\SOFTWARE\BlackLivesMatter</li><li id="fece" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Key : XFx41h1r → value : [암호화 된 감염기기 정보 및 암호화에 사용된 정보]</li><li id="e204" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">HKLM 경로에 등록 실패 시 HKCU로 변경</li></ul><p id="e42e" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. 상세 옵션 중 <code class="cx sj sk sl rp b"><strong class="nv in">dmn</strong></code>에 저장되어 있는 도메인 별로 아래 그림과 같이 특정 문자열을 조합하여 랜덤 URL 주소 생성하여 접속 시도</p></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe rn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EeWJKnt3t_4G6s18mKnPLA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EeWJKnt3t_4G6s18mKnPLA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EeWJKnt3t_4G6s18mKnPLA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EeWJKnt3t_4G6s18mKnPLA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EeWJKnt3t_4G6s18mKnPLA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EeWJKnt3t_4G6s18mKnPLA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*EeWJKnt3t_4G6s18mKnPLA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*EeWJKnt3t_4G6s18mKnPLA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EeWJKnt3t_4G6s18mKnPLA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EeWJKnt3t_4G6s18mKnPLA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EeWJKnt3t_4G6s18mKnPLA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EeWJKnt3t_4G6s18mKnPLA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EeWJKnt3t_4G6s18mKnPLA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*EeWJKnt3t_4G6s18mKnPLA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="192" loading="eager" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">URL 주소 생성 방식</figcaption></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><p id="b71e" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5. 도메인별로 생성된 URL주소로 수집한 감염기기 정보 목록 전송</p><ul class=""><li id="e431" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">User-agent : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.125 Safari/537.36</li><li id="d528" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Method : POST</li><li id="16a0" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Header : Content-Type: application/octet-stream</li><li id="599e" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Header : Connection: close</li></ul><p id="3438" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">7) 메모리 정리</strong></p><p id="bd82" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1. 감염정보 전송과 모든 파일 암호화를 마친 뒤 관련 데이터를 모두 정리</p><p id="53ec" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. 상세 옵션 및 암호화에 사용된 키 정보, 감염기기 정보가 할당된 메모리를 모두 해제함</p><p id="9aad" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">8) 파일 삭제</strong></p><ol class=""><li id="bd42" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on ss rg rh bk">재부팅될 경우 악성코드가 삭제되도록 설정</li></ol><h2 id="05a3" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">8. 파일 암호화 Thread</h2><p id="d8ed" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk"><strong class="nv in">1) Input/output completion port (IOCP)를 이용한 암호화 작업 수행</strong></p><ul class=""><li id="1b02" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">REvil 랜섬웨어는 IOCP를 이용한 비동기 입출력 방식으로 빠른 암호화를 수행함</li><li id="51f6" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">감염 기기의 프로세서 갯수 * 2개의 암호화 전담 Thread 생성</li></ul><p id="aaae" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">2) ECIES(<em class="ot">Elliptic Curve Integrated Encryption Scheme</em>)를 이용한 파일 암호화</strong></p><ul class=""><li id="d016" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">REvil 랜섬웨어는 ECC Diffie Hellman 키 교환 방식을 사용하여 키 교환을 시도함</li><li id="2726" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">키 생성에는 Curve25519를 사용하는데, 이는 가장 빠른 곡선 중 하나로 알려짐</li><li id="1f65" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">랜섬웨어 바이너리 내에 미리 포함되어 있는 pk (Attacker Key)를 이용하여 실제 파일 암호화에 사용되는 dk_key에 대한 암호화 진행</li><li id="95b8" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">pk 외에 Master Key가 존재하는데, 이는 REvil 랜섬웨어의 메이저 버전마다 동일한 값을 가지며, REvil 랜섬웨어 제작자가 언제든지 파일을 복호화할 수 있는 용도로 사용됨</li></ul><figure class="pg ph pi pj pk ou pd pe paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe st"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*pufcgEgfDRqHNQXjuLsDWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*pufcgEgfDRqHNQXjuLsDWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*pufcgEgfDRqHNQXjuLsDWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*pufcgEgfDRqHNQXjuLsDWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*pufcgEgfDRqHNQXjuLsDWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*pufcgEgfDRqHNQXjuLsDWQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pufcgEgfDRqHNQXjuLsDWQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*pufcgEgfDRqHNQXjuLsDWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*pufcgEgfDRqHNQXjuLsDWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*pufcgEgfDRqHNQXjuLsDWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*pufcgEgfDRqHNQXjuLsDWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*pufcgEgfDRqHNQXjuLsDWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*pufcgEgfDRqHNQXjuLsDWQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*pufcgEgfDRqHNQXjuLsDWQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh fw pr c" width="700" height="256" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">Master key와 Attacke key를 이용한 dk_key 개별 암호화</figcaption></figure><p id="3a34" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">3) 암호화 대상에서 특정 파일, 폴더 및 확장자 제외</strong></p><ul class=""><li id="901b" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">운영체제와 관련되거나 중요도가 낮은 폴더를 암호화 대상에서 제외</li></ul></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe su"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JpMAfDGju0-osf3rwjE5Yg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JpMAfDGju0-osf3rwjE5Yg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JpMAfDGju0-osf3rwjE5Yg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JpMAfDGju0-osf3rwjE5Yg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JpMAfDGju0-osf3rwjE5Yg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JpMAfDGju0-osf3rwjE5Yg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*JpMAfDGju0-osf3rwjE5Yg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*JpMAfDGju0-osf3rwjE5Yg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JpMAfDGju0-osf3rwjE5Yg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JpMAfDGju0-osf3rwjE5Yg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JpMAfDGju0-osf3rwjE5Yg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JpMAfDGju0-osf3rwjE5Yg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JpMAfDGju0-osf3rwjE5Yg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*JpMAfDGju0-osf3rwjE5Yg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="311" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><ul class=""><li id="9699" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">부팅 또는 운영체제 관련 파일을 암호화 대상에서 제외</li></ul></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe sv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*a7y0VFieYGSkEDeMWU45Bg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*a7y0VFieYGSkEDeMWU45Bg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*a7y0VFieYGSkEDeMWU45Bg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*a7y0VFieYGSkEDeMWU45Bg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*a7y0VFieYGSkEDeMWU45Bg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*a7y0VFieYGSkEDeMWU45Bg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*a7y0VFieYGSkEDeMWU45Bg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*a7y0VFieYGSkEDeMWU45Bg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*a7y0VFieYGSkEDeMWU45Bg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*a7y0VFieYGSkEDeMWU45Bg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*a7y0VFieYGSkEDeMWU45Bg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*a7y0VFieYGSkEDeMWU45Bg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*a7y0VFieYGSkEDeMWU45Bg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*a7y0VFieYGSkEDeMWU45Bg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="121" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><ul class=""><li id="3cfa" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">실행 프로그램 또는 스크립트등과 같은 불필요한 확장자를 감염 대상에서 제외</li></ul></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe sw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-4TYFT4z3GdhOaqfrSR4-A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-4TYFT4z3GdhOaqfrSR4-A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-4TYFT4z3GdhOaqfrSR4-A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-4TYFT4z3GdhOaqfrSR4-A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-4TYFT4z3GdhOaqfrSR4-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-4TYFT4z3GdhOaqfrSR4-A.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*-4TYFT4z3GdhOaqfrSR4-A.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-4TYFT4z3GdhOaqfrSR4-A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-4TYFT4z3GdhOaqfrSR4-A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-4TYFT4z3GdhOaqfrSR4-A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-4TYFT4z3GdhOaqfrSR4-A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-4TYFT4z3GdhOaqfrSR4-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-4TYFT4z3GdhOaqfrSR4-A.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*-4TYFT4z3GdhOaqfrSR4-A.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="324" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><ul class=""><li id="ae5d" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">타겟 파일에 접근 중인 서비스 및 프로세스 중 아래 프로세스를 제외한 서비스와 프로세스를 모두 종료</li></ul></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe sx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZLuKfBAG0ohUKkZWXeGi7w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZLuKfBAG0ohUKkZWXeGi7w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZLuKfBAG0ohUKkZWXeGi7w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZLuKfBAG0ohUKkZWXeGi7w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZLuKfBAG0ohUKkZWXeGi7w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZLuKfBAG0ohUKkZWXeGi7w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*ZLuKfBAG0ohUKkZWXeGi7w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZLuKfBAG0ohUKkZWXeGi7w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZLuKfBAG0ohUKkZWXeGi7w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZLuKfBAG0ohUKkZWXeGi7w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZLuKfBAG0ohUKkZWXeGi7w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZLuKfBAG0ohUKkZWXeGi7w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZLuKfBAG0ohUKkZWXeGi7w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*ZLuKfBAG0ohUKkZWXeGi7w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="111" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><ul class=""><li id="0be8" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">파일의 마지막 176byte위치의 32byte를 읽은 뒤 CRC32 checksum이 마지막 216byte위치의 4byte값과 동일한 경우, 이미 암호화가 된 파일로 판단하여 암호화 대상에서 제외</li></ul><p id="7e4a" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">4) 파일 암호화</strong></p><p id="f089" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">상세 옵션 중 <code class="cx sj sk sl rp b"><strong class="nv in">et</strong></code>에 따라 암호화 모드가 구분되며, 기본적으로 0x100000(1MB) 크기 단위로 파일 암호화가 이루어지고 아래와 같은 옵션에 따라 추가 암호화 크기가 정해짐</p><ul class=""><li id="c950" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk"><strong class="nv in">et가 0일 때</strong>, 파일 전체 암호화</li><li id="139f" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk"><strong class="nv in">et가 1일 때</strong>, 파일의 상위 0x100000만 암호화</li><li id="bfba" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk"><strong class="nv in">et가 2일 때</strong>, 파일의 상위 0x100000암호화. 이후, spize 옵션에 명시된 크기만큼 간격을 두어 0x100000씩 추가로 파일 암호화 (spsize에 주어진 크기는 MB단위)</li></ul></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe rn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3QMujS2Uv2SosUjlCusMVw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3QMujS2Uv2SosUjlCusMVw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3QMujS2Uv2SosUjlCusMVw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3QMujS2Uv2SosUjlCusMVw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3QMujS2Uv2SosUjlCusMVw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3QMujS2Uv2SosUjlCusMVw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*3QMujS2Uv2SosUjlCusMVw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3QMujS2Uv2SosUjlCusMVw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3QMujS2Uv2SosUjlCusMVw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3QMujS2Uv2SosUjlCusMVw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3QMujS2Uv2SosUjlCusMVw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3QMujS2Uv2SosUjlCusMVw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3QMujS2Uv2SosUjlCusMVw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*3QMujS2Uv2SosUjlCusMVw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="398" loading="eager" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">File Encryption Modes</figcaption></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><p id="a6ac" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">파일 별로 4x4 key matrix를 생성하여 Salsa20 알고리즘으로 파일을 암호화하며, Salsa20에서 사용되는 key matrix 구조는 아래와 같음. REvil 랜섬웨어는 아래 Key영역에는 생성한 Shared Key의 SHA-3 해시 값을 사용하고, Nonce는 랜덤으로 생성한 8byte, Pos는 0으로 설정</p><figure class="pg ph pi pj pk ou pd pe paragraph-image"><a href="https://en.wikipedia.org/wiki/Salsa20"><div class="pd pe sy"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JmWQqdiR3OupLZJY6_bYQQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JmWQqdiR3OupLZJY6_bYQQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JmWQqdiR3OupLZJY6_bYQQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JmWQqdiR3OupLZJY6_bYQQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JmWQqdiR3OupLZJY6_bYQQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JmWQqdiR3OupLZJY6_bYQQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JmWQqdiR3OupLZJY6_bYQQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*JmWQqdiR3OupLZJY6_bYQQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JmWQqdiR3OupLZJY6_bYQQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JmWQqdiR3OupLZJY6_bYQQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JmWQqdiR3OupLZJY6_bYQQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JmWQqdiR3OupLZJY6_bYQQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JmWQqdiR3OupLZJY6_bYQQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JmWQqdiR3OupLZJY6_bYQQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh fw pr c" width="700" height="368" loading="eager" role="presentation"/></picture></div></a><figcaption class="ps ff pt pd pe pu pv bf b bg ab du"><a class="ag pw" href="https://en.wikipedia.org/wiki/Salsa20" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Salsa20</a></figcaption></figure><p id="9a1d" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><code class="cx sj sk sl rp b"><strong class="nv in">et</strong></code>에 따라 파일 암호화를 마친 뒤, 암호화에 사용된 232byte의 메타데이터를 파일에 추가</p><ul class=""><li id="580d" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">sk_key struct : 공격자 공개키로 암호화된 비밀키 구조체</li><li id="5996" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">0_key struct : 제작자 마스터키로 암호화된 비밀키 구조체</li><li id="a773" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Meta data struct : 공개키, 암호화 모드 등이 포함된 암호화에 사용된 정보 구조체</li></ul></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe rn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*v41UKPJy8htwZfFW0YVM1w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*v41UKPJy8htwZfFW0YVM1w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*v41UKPJy8htwZfFW0YVM1w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*v41UKPJy8htwZfFW0YVM1w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*v41UKPJy8htwZfFW0YVM1w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*v41UKPJy8htwZfFW0YVM1w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*v41UKPJy8htwZfFW0YVM1w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*v41UKPJy8htwZfFW0YVM1w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*v41UKPJy8htwZfFW0YVM1w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*v41UKPJy8htwZfFW0YVM1w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*v41UKPJy8htwZfFW0YVM1w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*v41UKPJy8htwZfFW0YVM1w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*v41UKPJy8htwZfFW0YVM1w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*v41UKPJy8htwZfFW0YVM1w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="422" loading="eager" role="presentation"/></picture></div></div><figcaption class="ps ff pt pd pe pu pv bf b bg ab du">Key struct and Meta data struct</figcaption></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><p id="c2b8" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">4) 암호화 후 파일 확장자 변경</strong></p><p id="f9aa" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">파일의 암호화가 완료되면 원본 파일의 확장자를 기존에 생성한 랜덤 문자열로 변경</p><p id="c9d2" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">5) 랜섬노트 생성</strong></p><p id="c8c1" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1. 상세 옵션 및 기존에 생성한 랜덤 확장자를 이용하여 폴더마다 랜섬노트 생성</p><p id="4377" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. <code class="cx sj sk sl rp b"><strong class="nv in">nbody</strong></code> 옵션 : 랜섬노트 파일명 포맷 → [랜덤 확장자]-readme.txt</p><p id="8cc3" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. <code class="cx sj sk sl rp b"><strong class="nv in">nname</strong></code> 옵션 : 랜섬노트 내용 포맷</p><ul class=""><li id="d742" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk"><strong class="nv in">{UID}</strong> : 감염 기기 식별 값</li><li id="95be" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk"><strong class="nv in">{KEY}</strong> : 정보유출지로 전송한 수집된 정보의 base64 encoding 형태</li><li id="dcdc" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk"><strong class="nv in">{EXT}</strong> : 랜덤 확장자</li></ul><p id="1751" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. 랜섬노트 예시</p><figure class="pg ph pi pj pk ou pd pe paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe sz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*k5N0jbWNXK9EL2mYKAiwcw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*k5N0jbWNXK9EL2mYKAiwcw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*k5N0jbWNXK9EL2mYKAiwcw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*k5N0jbWNXK9EL2mYKAiwcw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*k5N0jbWNXK9EL2mYKAiwcw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*k5N0jbWNXK9EL2mYKAiwcw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5N0jbWNXK9EL2mYKAiwcw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*k5N0jbWNXK9EL2mYKAiwcw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*k5N0jbWNXK9EL2mYKAiwcw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*k5N0jbWNXK9EL2mYKAiwcw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*k5N0jbWNXK9EL2mYKAiwcw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*k5N0jbWNXK9EL2mYKAiwcw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*k5N0jbWNXK9EL2mYKAiwcw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*k5N0jbWNXK9EL2mYKAiwcw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh fw pr c" width="700" height="428" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5cbb" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5. 암호화 전체 과정</p></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe rn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IzAqp3ftCNIkzUEvn6YUrA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IzAqp3ftCNIkzUEvn6YUrA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IzAqp3ftCNIkzUEvn6YUrA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IzAqp3ftCNIkzUEvn6YUrA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IzAqp3ftCNIkzUEvn6YUrA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IzAqp3ftCNIkzUEvn6YUrA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*IzAqp3ftCNIkzUEvn6YUrA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*IzAqp3ftCNIkzUEvn6YUrA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IzAqp3ftCNIkzUEvn6YUrA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IzAqp3ftCNIkzUEvn6YUrA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IzAqp3ftCNIkzUEvn6YUrA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IzAqp3ftCNIkzUEvn6YUrA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IzAqp3ftCNIkzUEvn6YUrA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*IzAqp3ftCNIkzUEvn6YUrA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="953" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><p id="86ca" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">6) 복호화 예시</strong></p><p id="e3c5" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1. 공격자는 암호화된 파일로부터 sk_key struct에 있는 pk_new 추출</p><p id="6291" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. 공격자가 가지고 있는 dk와 pk_new를 이용하여 shared key 생성</p><ul class=""><li id="2419" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">이는 악성코드가 pk와 dk_new를 이용하여 생성한 shared key와 동일함</li><li id="eae3" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">ECDH (Elliiptic Curve Diffie-Hellman)상 아래 수식이 성립하기 때문</li></ul><figure class="pg ph pi pj pk ou pd pe paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe ta"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WRmjvmWmZTHdP424IGwTUg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WRmjvmWmZTHdP424IGwTUg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WRmjvmWmZTHdP424IGwTUg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WRmjvmWmZTHdP424IGwTUg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WRmjvmWmZTHdP424IGwTUg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WRmjvmWmZTHdP424IGwTUg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WRmjvmWmZTHdP424IGwTUg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*WRmjvmWmZTHdP424IGwTUg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WRmjvmWmZTHdP424IGwTUg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WRmjvmWmZTHdP424IGwTUg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WRmjvmWmZTHdP424IGwTUg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WRmjvmWmZTHdP424IGwTUg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WRmjvmWmZTHdP424IGwTUg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*WRmjvmWmZTHdP424IGwTUg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh fw pr c" width="700" height="49" loading="eager" role="presentation"/></picture></div></div></figure><ul class=""><li id="c3d3" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">𝑑𝐴: 공격자의 private key (dk)</li><li id="5e8a" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Q𝐴: 공격자의 public key (pk)</li><li id="01ef" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">𝑑B: 악성코드의 private key (dk_key)</li><li id="ee75" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">QB: 악성코드의 public key (pk_key)</li></ul><p id="4f07" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. 생성한 shared key와 sk_key struct에 있는 AES IV로 복호화하여 dk_key 추출</p><p id="a326" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. 2와 동일한 방식으로 dk_key와 Meta data struct에 있는 pk_new_file로 shared key 생성</p><p id="9585" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5. 생성한 shared key와 Meta data struct에 있는 Salsa nonce를 이용하여 Matrix 생성 후, Salsa IV와 함께 암호화된 파일 데이터 복호화</p></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe tb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*rYGI9oSynDJeuqynl7MaLA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*rYGI9oSynDJeuqynl7MaLA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*rYGI9oSynDJeuqynl7MaLA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*rYGI9oSynDJeuqynl7MaLA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*rYGI9oSynDJeuqynl7MaLA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rYGI9oSynDJeuqynl7MaLA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*rYGI9oSynDJeuqynl7MaLA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*rYGI9oSynDJeuqynl7MaLA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*rYGI9oSynDJeuqynl7MaLA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*rYGI9oSynDJeuqynl7MaLA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*rYGI9oSynDJeuqynl7MaLA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*rYGI9oSynDJeuqynl7MaLA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*rYGI9oSynDJeuqynl7MaLA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*rYGI9oSynDJeuqynl7MaLA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="852" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div></div><div class="ac cb rx ry rz sa" role="separator"><span class="sb bx bm gb sc sd"></span><span class="sb bx bm gb sc sd"></span><span class="sb bx bm gb sc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="6496" class="px py im bf pz qa se qc gk qd sf qf gm qg sg qi qj qk sh qm qn qo si qq qr qs bk">공격 ATT&amp;CK</h1><blockquote class="oq or os"><p id="02cc" class="nt nu ot nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">출처 : Reference에 명시된 분석 블로그 내 IoC 취합</p></blockquote><h2 id="5064" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk"><strong class="am">Initial Access</strong></h2><p id="a444" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. 취약점을 통해 원격 명령어 실행 및 접속 시도</p><ul class=""><li id="cf96" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">오라클 WebLogic 취약점 (CVE-2019–2725)</li><li id="f2d2" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Microsoft Exchange 서버 취약점 (정확한 CVE는 밝혀지지 않음)</li><li id="c164" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">Sharepoint 취약점 (정확한 CVE는 밝혀지지 않음)</li></ul><p id="cc82" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. VPN 취약점을 통한 내부 파일 탈취 시도</p><ul class=""><li id="3429" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">Pulse Secure SSL VPN (CVE-2019–11510)</li><li id="7c1a" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">FortiOS SSL VPN (CVE-2018–13379)</li></ul><p id="03f3" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. RDP를 통한 침투</p><ul class=""><li id="ec3d" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">취약한 RDP 패스워드를 타겟하는 bruteforce 공격 시도</li><li id="888a" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">원격 코드 실행이 가능한 RDP Bluegate 취약점 (CVE-2020–0609, CVE-2020–0610)</li></ul><p id="3655" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. 취약한 Citrix 계정을 통한 침투</p><p id="30b7" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5. 스팸 메일을 통해 다운로드 기능의 악성 매크로가 포함된 XLSM 파일 유포</p><ul class=""><li id="8a45" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">숙소 예약 사이트 (booking.com)를 위장한 피싱 메일</li><li id="cb35" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">해외 배소 업체 (DHL)로 위장한 피싱 메일</li><li id="a702" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">DocuSign 전자 서명 메일로 위장한 피싱 메일</li></ul><p id="3173" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">6. Supply chain</p><ul class=""><li id="c9c8" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">이탈리아의 WinRAR 설치 프로그램 공식 사이트(winrar.it)를 통해 배포</li></ul><p id="4467" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">7. RIG Exploit kit을 통해 배포</p><ul class=""><li id="08be" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">RIG Exploit kit을 활용한 Malvertising 공격으로 감염 시도</li></ul><p id="1b5a" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">8. MSSP 또는 MSP 업체를 장악 후, 경유하여 침투 시도</p><p id="765a" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">9. SEO-Poisoning 로 인해 검색엔진 상단에 노출되는 웹 사이트로부터 악성 파일 다운로드</p><p id="956d" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><strong class="nv in">Execution</strong></p><p id="ed10" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">1. Powershell (.ps1) 스크립트를 이용하여 명령어 실행</p><ul class=""><li id="2946" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">DownloadFile 명령어를 통해 악성코드 다운로드 및 실행</li></ul><p id="633b" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. 악성 코드를 드랍 및 실행하는 Javascript (.js) 스크립트</p><ul class=""><li id="659e" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">난독화 된 javascript 스크립트를 실행시켜 추가 악성코드 다운로드</li></ul><p id="99f0" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. WMI (Windows Management Instrumentation) 쿼리를 이용하여 명령어 실행</p><p id="798f" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. 배치 스크립트를 이용하여 다수의 명령어를 동시에 실행</p><h2 id="c4f8" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk"><strong class="am">Persistence</strong></h2><p id="c068" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. 클라우드 원격 데스크톱 소프트웨어 계정을 통한 지속성 유지</p><ul class=""><li id="5cd6" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">ConnectWise Control (구 ScreenConnect)을 설치 후 지속성 유지</li></ul><p id="d5b5" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. Cobalt Strike 비콘을 통한 지속성 유지</p><p id="0687" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. VPN 취약점으로 지속성 유지</p><p id="3527" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. On-premise virtual desktop appliances를 통한 지속성 유지</p><p id="b79f" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5. Scheduled Task를 이용하여 주기적으로 악성코드 실행</p><p id="bd32" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">6. 최초 침투 후 웹쉘을 삽입하여 지속성 유지</p><p id="e2c2" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">7. REvil 랜섬웨어는 옵션에 따라 부팅 시 자동실행 되도록 레지스트리에 등록</p><h2 id="b267" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk"><strong class="am">Privilege Escalation</strong></h2><p id="4ccc" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. CVE-2018–8453 취약점을 이용하여 로컬 권한 상승 시도</p><p id="5ce9" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. GPO(Group Policy Preferences)내에 포함된 패스워드로 로그인하여 권한 상승</p><p id="13d4" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. 내부 망에서 수집한 계정정보를 통해 권한 상승 시도</p><p id="0756" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. Metasploit의 <a class="ag pw" href="https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/UAC-TokenMagic.ps1" rel="noopener ugc nofollow" target="_blank">UAC-TokenMagic</a> 파워쉘 스크립트로 UAC 우회</p><p id="9ff0" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5. Invoke-SluiBypass 파워쉘 스크립트로 UAC 우회</p><p id="c549" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">6. REvil 랜섬웨어는 SeDebugPrivilege 권한을 할당하여 타 프로세스에 접근 시도</p><h2 id="7ad6" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk"><strong class="am">Defense Evasion</strong></h2><p id="faa4" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. rundll32.exe 라는 정상 프로세스를 이용하여 악성 DLL 파일 실행</p><p id="bdd8" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. BITSAdmin 이라는 정상 도구를 이용하여 내부에 랜섬웨어 배포</p><p id="a21c" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. REvil 랜섬웨어는 옵션에 따라 안전모드로 재부팅하여 파일 암호화</p><p id="fdd1" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. GPO(Group Policy Preferences)를 통해 Windows Defender 및 백신 비활성화</p><ul class=""><li id="5aa3" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">배치 스크립트 사용</li></ul><h2 id="ac8e" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk"><strong class="am">Credential Access</strong></h2><p id="3503" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. Mimikatz를 이용하여 크리덴셜 수집</p><p id="0882" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. ProcDump를 이용하여 lsass 프로세스 dump를 통해 크리덴셜 수집</p><h2 id="9a53" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk"><strong class="am">Discovery</strong></h2><p id="d33f" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. 윈도우 기본 제공 명령어를 통해 정보 탐색</p><ul class=""><li id="8453" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">net : 네트워크 공유 및 워크스테이션 정보 수집</li><li id="e5f1" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">nltest : 도메인 컨트롤러 및 신뢰할 수 있는 도메인 목록 수집</li><li id="d66e" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">ipconfig : 감염기기 전체 IP 정보 수집</li><li id="e5f0" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">systeminfo : 감염기기 전체 시스템 정보 수집</li><li id="7c3f" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">ping : icmp 를 통한 포트스캔 수행</li></ul><p id="e5e9" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. Advanced Port Scanner 도구로 포트 스캐닝 수행</p><p id="c8cb" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. ADRecon을 이용하여 Active Directory 정보 수집</p><p id="ecbd" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. Everything을 이용하여 시스템 내 주요 파일 정보 수집</p><p id="e7ee" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5. PoS Software 설치 여부 확인</p><p id="dd67" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">6. SoftPerfect Network Scanner 도구로 내부 네트워크 스캔</p><p id="b150" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">7. Bloodhound도구로 LDAP 쿼리를 이용하여 Active Directory정보 수집</p><p id="53db" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">8. ADfind 도구로 Active Directory 정보 수집</p><h2 id="58da" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk"><strong class="am">Lateral Movement</strong></h2><p id="4974" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. Scheduled Task: 예약된 작업을 통해 측면 이동 수행</p><p id="3987" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. PsExec: 내부 대역에 악성코드 복사 후 원격으로 실행</p><p id="f945" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. Admin share: 네트워크 공유 기능으로 파일 복사 후 실행</p><p id="367c" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5. WMIExec: WMI 명령어를 통해 내부 대역에 악성코드 복사 후 실행</p><p id="aa51" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">6. CrackMapExec 도구로 측면 이동 수행</p><p id="50ef" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">7. RDP 계정을 수집하여 측면 이동 수행</p><p id="c08d" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">8. Cobalt Strike 기능으로 SMB를 통한 원격 서비스를 생성하여 측면 이동 수행</p><h2 id="459c" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk"><strong class="am">Command and Control</strong></h2><p id="8c81" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. Cobalt Strike 비콘을 통한 감염기기 원격제어 수행</p><p id="5578" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. Gootkit, Qbot, IcedId 와 같은 유명한 악성코드를 통해 원격제어 명령 및 랜섬웨어 다운로드</p><p id="81e7" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. Wget을 통해 추가 악성코드 다운로드</p><p id="bca0" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. 파워쉘 스크립트로 pastebin의 특정 파일을 읽어와 디코딩 후 실행</p><h2 id="e03a" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk"><strong class="am">Exfiltration</strong></h2><p id="43d4" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. Rclone도구를 이용하여 공격자의 원격 서버로 파일 복사</p><p id="00e2" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. Mega 클라우드를 이용하여 탈취한 데이터 저장</p><h2 id="49c4" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk"><strong class="am">Impacts</strong></h2><p id="4da2" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. 주요 파일 암호화</p><p id="1606" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. 주요 백업 및 안티 바이러스 서비스 중지</p><p id="3f68" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. Volume Shadow Copy 삭제</p><p id="2f26" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. VM Snapshot 삭제</p><p id="7f9b" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5. File backup 삭제</p><p id="7ca8" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">6. 중요한 문서 삭제</p></div></div></div><div class="ac cb rx ry rz sa" role="separator"><span class="sb bx bm gb sc sd"></span><span class="sb bx bm gb sc sd"></span><span class="sb bx bm gb sc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="fe81" class="px py im bf pz qa se qc gk qd sf qf gm qg sg qi qj qk sh qm qn qo si qq qr qs bk">Conclusion</h1><p id="f853" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">REvil 랜섬웨어는 2019년 4월에 최초 등장한 이후, 약 2년이 넘는 시간 동안 다크웹 내 RaaS(Ransomware as a Service) 시장에서 최정상의 자리를 지키고 있다. 지속적인 버전 업데이트, 다양한 기능 및 상세 옵션을 통한 쉬운 커스터마이징이 가능하기 때문이다. 다수의 구매자들 (또는 Operator)에 의해 개인부터 JBS와 같은 대형 기업 공격에까지 REvil 랜섬웨어를 이용한 광범위한 공격이 이루어지고 있다.</p><p id="03b2" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">REvil로부터 파생된 조직들이 계속 생겨나고, 인터뷰를 통해 앞으로 더욱 더 적극적으로 공격할 것임을 밝히기도 했다. REvil은 몸값을 받아내기 위해 기업 정보 유출, DDoS, 파트너사 협박 등과 같은 전략을 취하고 있기 때문에 실제로 감염될 경우, 기업 내 큰 타격을 입을 수 있다.</p><p id="382f" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">랜섬웨어의 코드는 2년 동안 크게 바뀌지 않았지만, 이를 사용하는 공격자들이 많은 만큼 매우 다양한 최초 침투 경로, 공격 도구로 배포되고 있다. 그렇기 때문에 랜섬웨어 자체에 대해서만 대응하는 것이 아닌, 전체적인 공격 시나리오를 이해하고 자신 또는 기업의 취약한 부분을 확인하여 점검 및 보완할 수 있어야 한다.</p></div></div></div><div class="ac cb rx ry rz sa" role="separator"><span class="sb bx bm gb sc sd"></span><span class="sb bx bm gb sc sd"></span><span class="sb bx bm gb sc"></span></div><div class="hn ig ih ii ij"><div class="ac cb"><div class="ci bh ht hu hv hw"><h1 id="73b3" class="px py im bf pz qa se qc gk qd sf qf gm qg sg qi qj qk sh qm qn qo si qq qr qs bk">Reference</h1><p id="eec6" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">1. <a class="ag pw" href="https://blog.talosintelligence.com/2019/04/sodinokibi-ransomware-exploits-weblogic.html" rel="noopener ugc nofollow" target="_blank">https://blog.talosintelligence.com/2019/04/sodinokibi-ransomware-exploits-weblogic.html</a></p><p id="a5c6" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. <a class="ag pw" href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/sodinokibi-ransomware-cobalt-strike-pos" rel="noopener ugc nofollow" target="_blank">https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/sodinokibi-ransomware-cobalt-strike-pos</a></p><p id="8517" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">3. <a class="ag pw" href="https://blog.amossys.fr/sodinokibi-malware-analysis.html" rel="noopener ugc nofollow" target="_blank">https://blog.amossys.fr/sodinokibi-malware-analysis.html</a></p><p id="d959" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">4. <a class="ag pw" href="https://www.tgsoft.it/immagini/news/20190705Sodinokibi/Sodinokibi_eng.pdf" rel="noopener ugc nofollow" target="_blank">https://www.tgsoft.it/immagini/news/20190705Sodinokibi/Sodinokibi_eng.pdf</a></p><p id="0398" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">5. <a class="ag pw" href="https://i.blackhat.com/eu-20/Wednesday/eu-20-Clarke-Its-Not-FINished-The-Evolving-Maturity-In-Ransomware-Operations.pdf" rel="noopener ugc nofollow" target="_blank">https://i.blackhat.com/eu-20/Wednesday/eu-20-Clarke-Its-Not-FINished-The-Evolving-Maturity-In-Ransomware-Operations.pdf</a></p><p id="c0d3" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">6. <a class="ag pw" href="https://blog.malwarebytes.com/threat-analysis/2020/11/german-users-targeted-with-gootkit-banker-or-revil-ransomware/" rel="noopener ugc nofollow" target="_blank">https://blog.malwarebytes.com/threat-analysis/2020/11/german-users-targeted-with-gootkit-banker-or-revil-ransomware/</a></p><p id="dbf8" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">7. <a class="ag pw" href="https://asec.ahnlab.com/ko/19640/" rel="noopener ugc nofollow" target="_blank">https://asec.ahnlab.com/ko/19640/</a></p><p id="dce1" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">8. <a class="ag pw" href="https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/" rel="noopener ugc nofollow" target="_blank">https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/</a></p><h1 id="d2a3" class="px py im bf pz qa qb qc gk qd qe qf gm qg qh qi qj qk ql qm qn qo qp qq qr qs bk">Appendix</h1><h2 id="7ca1" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">Appendix #1 : REvil 랜섬웨어 탐지 야라 룰</h2><pre class="pg ph pi pj pk ro rp rq rr aj rs bk"><span id="73e9" class="qt py im rp b gy rt ru m rv rw">rule REvil_Ransomware_V2_5<br/>{<br/>    meta:<br/>        description = &quot;REvil ransomware v2.05 detection rule&quot;<br/>        author = &quot;S2WLAB TALON&quot;<br/>        date = &quot;2021-06-23&quot;<br/>        version = &quot;1.0&quot;<br/>    strings:<br/>        $pattern1 = &quot;ERR0R D0UBLE RUN!&quot; ascii wide nocase<br/>        $pattern2 = &quot;vmcompute.exe&quot; ascii wide nocase<br/>        $pattern3 = &quot;vmms.exe&quot; ascii wide nocase<br/>        $pattern4 = &quot;vmwp.exe&quot; ascii wide nocase<br/>        $pattern5 = &quot;svchost.exe&quot; ascii wide nocase<br/>        $pattern6 = &quot;DTrump4ever&quot; ascii wide nocase<br/>        $pattern7 = &quot;expand 32-byte k&quot; ascii wide nocase<br/>        $pattern8 = &quot;expand 16-byte k&quot; ascii wide nocase<br/>        $pattern9 = &quot;__ProviderArchitecture&quot; ascii wide nocase<br/>        $code1 = {83 EC 10 B9 5B 04 00 00 53 56 8B 75 08 [0-8] C1 E6 10 33 75 08 81 F6 ?? ?? ?? ?? 8B C6 C1 E8 15 57}<br/>        $code2 = {8B 55 08 40 0F B6 C8 8B 45 08 89 4D 10 8B 5D 10 8A 0C 01 0F B6 C1 03 C6 0F B6 F0 8B 45 08 8A 04 06 88 04 13 8B C2 8B D3 8B 5D 14 88 0C 06 0F B6 04 02 8B 55 0C 0F B6 C9 03 C8 0F B6 C1 8B 4D 08 8A 04 08 32 04 1A 88 03 43 8B 45 10 89 5D 14 83 EF 01 75} // rc4<br/>    condition:<br/>        ( 8 of ($pattern*) and $code1 ) or<br/>        ( 8 of ($pattern*) and $code2 )<br/>}</span><span id="335b" class="qt py im rp b gy tc ru m rv rw">rule REvil_Ransomware_V1_6<br/>{<br/>    meta:<br/>        description = &quot;REvil ransomware v1.06 detection rule&quot;<br/>        author = &quot;S2WLAB TALON hypen&quot;<br/>        date = &quot;2021-06-23&quot;<br/>        version = &quot;1.0&quot;<br/>    strings:<br/>        $pattern1 = &quot;ServicesActive&quot; ascii wide nocase<br/>        $pattern2 = &quot;expand 32-byte k&quot; ascii wide nocase<br/>        $pattern3 = &quot;expand 16-byte k&quot; ascii wide nocase<br/>        $code1 = {11 f8 90 45 3a 1d d0 11 89 1f 00 aa 00 4b 2e 24 28 20 bd 49 23 15 d1 11 ad 79 00 c0 4f d8 fd ff 87 a6 12 dc 7f 73 cf 11 88 4d 00 aa 00     4b 2e     24} // rscid<br/>        $code2 = {8B 55 08 40 0F B6 C8 8B 45 08 89 4D 10 8B 5D 10 8A 0C 01 0F B6 C1 03 C6 0F B6 F0 8B 45 08 8A 04 06 88 04 13 8B C2 8B D3 8B 5D 14 88 0C 06 0F     B6 04 02 8B 55 0C 0F B6 C9 03 C8 0F B6 C1 8B 4D 08 8A 04 08 32 04 1A 88 03 43 8B 45 10 89 5D 14 83 EF 01 75} // rc4<br/>    condition:<br/>        all of them<br/>}</span></pre><h2 id="88cb" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">Appendix #2 : Sigma rule</h2><blockquote class="oq or os"><p id="9e7b" class="nt nu ot nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">출처 : <a class="ag pw" href="https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/" rel="noopener ugc nofollow" target="_blank">https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/</a></p></blockquote><p id="7943" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><a class="ag pw" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_powershell_enc_cmd.yml" rel="noopener ugc nofollow" target="_blank">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_powershell_enc_cmd.yml</a></p><p id="879a" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><a class="ag pw" href="https://github.com/Neo23x0/sigma/blob/084cd39505861188d9d8f2d5c0f2835e4f750a3f/rules/windows/process_creation/win_malware_trickbot_recon_activity.yml" rel="noopener ugc nofollow" target="_blank">https://github.com/Neo23x0/sigma/blob/084cd39505861188d9d8f2d5c0f2835e4f750a3f/rules/windows/process_creation/win_malware_trickbot_recon_activity.yml</a></p><p id="6f72" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><a class="ag pw" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_commands_recon_activity.yml" rel="noopener ugc nofollow" target="_blank">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_commands_recon_activity.yml</a></p><p id="95f2" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><a class="ag pw" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/sysmon_rundll32_net_connections.yml" rel="noopener ugc nofollow" target="_blank">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/sysmon_rundll32_net_connections.yml</a></p><p id="4c6f" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><a class="ag pw" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_process_creation_bitsadmin_download.yml" rel="noopener ugc nofollow" target="_blank">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_process_creation_bitsadmin_download.yml</a></p><p id="b661" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><a class="ag pw" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_adfind.yml" rel="noopener ugc nofollow" target="_blank">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_adfind.yml</a></p><p id="6093" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><a class="ag pw" href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_wmi_execution.yml" rel="noopener ugc nofollow" target="_blank">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_wmi_execution.yml</a></p><p id="ad9c" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk"><a class="ag pw" href="https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_office_shell.yml" rel="noopener ugc nofollow" target="_blank">https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_office_shell.yml</a></p><h2 id="04c3" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">Appendix #3 : IoC</h2><p id="cca8" class="pw-post-body-paragraph nt nu im nv b nw ra ny nz oa rb oc od gn rc of og gq rd oi oj gt re ol om on hn bk">Click the below image then redirect to google spreadsheet</p><blockquote class="oq or os"><p id="1fc1" class="nt nu ot nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">출처 : Reference에 명시된 분석 블로그 내 IoC 취합</p></blockquote></div></div><div class="ou"><div class="ac cb"><div class="ov ow ox oy oz pa cf pb cg pc ci bh"><figure class="pg ph pi pj pk ou pl pm paragraph-image"><a href="https://docs.google.com/spreadsheets/d/1cssKIwZP0E1xv0YD1xx5GiEqb7e1I2Klt2nZm0A9FXk/edit?usp=sharing"><div class="pd pe td"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7te_iRyIDNKSxUUWqI_mng.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7te_iRyIDNKSxUUWqI_mng.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7te_iRyIDNKSxUUWqI_mng.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7te_iRyIDNKSxUUWqI_mng.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7te_iRyIDNKSxUUWqI_mng.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7te_iRyIDNKSxUUWqI_mng.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*7te_iRyIDNKSxUUWqI_mng.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*7te_iRyIDNKSxUUWqI_mng.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7te_iRyIDNKSxUUWqI_mng.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7te_iRyIDNKSxUUWqI_mng.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7te_iRyIDNKSxUUWqI_mng.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7te_iRyIDNKSxUUWqI_mng.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7te_iRyIDNKSxUUWqI_mng.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*7te_iRyIDNKSxUUWqI_mng.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh fw pr c" width="1000" height="733" loading="eager" role="presentation"/></picture></div></a></figure></div></div></div><div class="ac cb"><div class="ci bh ht hu hv hw"><h2 id="1eb5" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">Appendix #4 : REvil 협상 사이트 페이지 (최초 Key 입력 및 캡차 유도)</h2><figure class="pg ph pi pj pk ou pd pe paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe te"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BlqLh-gyypMlSPIcj0kZBg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BlqLh-gyypMlSPIcj0kZBg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BlqLh-gyypMlSPIcj0kZBg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BlqLh-gyypMlSPIcj0kZBg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BlqLh-gyypMlSPIcj0kZBg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BlqLh-gyypMlSPIcj0kZBg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BlqLh-gyypMlSPIcj0kZBg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*BlqLh-gyypMlSPIcj0kZBg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BlqLh-gyypMlSPIcj0kZBg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BlqLh-gyypMlSPIcj0kZBg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BlqLh-gyypMlSPIcj0kZBg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BlqLh-gyypMlSPIcj0kZBg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BlqLh-gyypMlSPIcj0kZBg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*BlqLh-gyypMlSPIcj0kZBg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh fw pr c" width="700" height="817" loading="eager" role="presentation"/></picture></div></div></figure><figure class="pg ph pi pj pk ou pd pe paragraph-image"><div role="button" tabindex="0" class="pn po fl pp bh pq"><div class="pd pe tf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*s3vX43JuqF2cWhtM53NxTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*s3vX43JuqF2cWhtM53NxTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*s3vX43JuqF2cWhtM53NxTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*s3vX43JuqF2cWhtM53NxTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*s3vX43JuqF2cWhtM53NxTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*s3vX43JuqF2cWhtM53NxTQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s3vX43JuqF2cWhtM53NxTQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*s3vX43JuqF2cWhtM53NxTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*s3vX43JuqF2cWhtM53NxTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*s3vX43JuqF2cWhtM53NxTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*s3vX43JuqF2cWhtM53NxTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*s3vX43JuqF2cWhtM53NxTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*s3vX43JuqF2cWhtM53NxTQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*s3vX43JuqF2cWhtM53NxTQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh fw pr c" width="700" height="666" loading="eager" role="presentation"/></picture></div></div></figure><h2 id="479b" class="qt py im bf pz gj qu dy gk gl qv ea gm gn qw go gp gq qx gr gs gt qy gu gv qz bk">Appendix #5 : v2.05와 v2.07 비교</h2><blockquote class="oq or os"><p id="82dc" class="nt nu ot nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">현재까지 발견된 REvil 랜섬웨어의 가장 최신 버전은 2.07로 확인됨</p></blockquote><ol class=""><li id="6e81" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on ss rg rh bk">로컬 드라이브 암호화</li></ol><ul class=""><li id="f45c" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">2.07 버전에서는 로컬 드라이브 암호화 시, 드라이브 타입이 DRIVE_FIXED(일반 디스크)일 경우, NetShareAdd 함수로 로컬 공유 시작</li><li id="1088" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">NetShareAdd 함수를 이용한 감염 단말 리소스 공유시 사용되는 comment (SHARE_INFO_2 구조체 내 shi2_remark 멤버 변수) 문자열 : “Share added by R”</li></ul><p id="d19c" class="pw-post-body-paragraph nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on hn bk">2. 네트워크 드라이브 암호화</p><ul class=""><li id="788b" class="nt nu im nv b nw nx ny nz oa ob oc od gn oe of og gq oh oi oj gt ok ol om on rf rg rh bk">2.07 버전에서는 네트워크 드라이브 암호화 함수를 Thread로 생성하지 않음</li><li id="7693" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">기존에는 explorer.exe의 토큰을 impersonate하여 네트워크 공유 탐색 권한을 획득하였는데, 2.07 버전에서는 이에 더해 현재 Thread를 제외한 현재 프로세스 내 모든 Thread에 동일한 토큰 적용</li><li id="3315" class="nt nu im nv b nw ri ny nz oa rj oc od gn rk of og gq rl oi oj gt rm ol om on rf rg rh bk">이후 복제된 토큰으로 네트워크 드라이브 암호화를 시도하고, RevertToSelf로 impersonate 종료 후에 한번 더 네트워크 드라이브 암호화를 시도함</li></ul></div></div></div></div></section></div></div></article></div><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="tg th ac kp"><div class="ti ac"><a class="tj aj an ap" rel="noopener follow" href="/tag/intelligence?source=post_page-----d1899c0e9317---------------------------------------"><div class="tk fl cx tl hy tm tn bf b bg ab bk fz">Intelligence</div></a></div><div class="ti ac"><a class="tj aj an ap" rel="noopener follow" href="/tag/ransomware?source=post_page-----d1899c0e9317---------------------------------------"><div class="tk fl cx tl hy tm tn bf b bg ab bk fz">Ransomware</div></a></div><div class="ti ac"><a class="tj aj an ap" rel="noopener follow" href="/tag/revil?source=post_page-----d1899c0e9317---------------------------------------"><div class="tk fl cx tl hy tm tn bf b bg ab bk fz">Revil</div></a></div><div class="ti ac"><a class="tj aj an ap" rel="noopener follow" href="/tag/darkweb?source=post_page-----d1899c0e9317---------------------------------------"><div class="tk fl cx tl hy tm tn bf b bg ab bk fz">Darkweb</div></a></div><div class="ti ac"><a class="tj aj an ap" rel="noopener follow" href="/tag/cybercrime?source=post_page-----d1899c0e9317---------------------------------------"><div class="tk fl cx tl hy tm tn bf b bg ab bk fz">Cybercrime</div></a></div></div></div></div><div class="m"></div><footer class="to tp tq tr ts ac r tt tu c"><div class="m af"><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="ac cp tv"><div class="ac r ly"><div class="tw m"><span class="m tx ty tz f e"><div class="ac r ly lz"><div class="pw-multi-vote-icon fl ma mb mc md"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fs2wblog%2Fd1899c0e9317&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317&amp;user=S2W&amp;userId=b408bb1e7c46&amp;source=---footer_actions--d1899c0e9317---------------------clap_footer------------------"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><div class="me ap mf mg mh mi an mj mk ml md" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m mm mn mo mp mq mr ms"><p class="bf b dv ab du"><span class="mt">--</span></p></div></div></span><span class="m i h g ua ub"><div class="ac r ly lz"><div class="pw-multi-vote-icon fl ma mb mc md"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fs2wblog%2Fd1899c0e9317&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317&amp;user=S2W&amp;userId=b408bb1e7c46&amp;source=---footer_actions--d1899c0e9317---------------------clap_footer------------------"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><div class="me ap mf mg mh mi an mj mk ml md" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m mm mn mo mp mq mr ms"><p class="bf b dv ab du"><span class="mt">--</span></p></div></div></span></div><div class="ay ac"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><button class="ap me mu mv ac r fm mw mx" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="my"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div></div><div class="ac r"><div class="sd m uc"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1899c0e9317&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317&amp;source=---footer_actions--d1899c0e9317---------------------bookmark_footer------------------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du na" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div><div class="sd m uc"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="ag fm ai fh ak al am nb ao ap aq ex nc nd mx ne"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></footer><div class="ud m"><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="ue m"><div class="ac jw ju js uf ug"><div class="uh ui uj uk ul um un uo up uq ac cp"><div class="i l"><a href="https://medium.com/s2wblog?source=post_page---post_publication_info--d1899c0e9317---------------------------------------" rel="noopener follow"><div class="fl"><img alt="S2W BLOG" class="cx hi m us ur" src="https://miro.medium.com/v2/resize:fill:96:96/1*3vCxewFUeWWkQ-O5X558rQ.jpeg" width="48" height="48" loading="lazy"/><div class="hi m ur us fu o ft hl"></div></div></a></div><div class="k j e"><a href="https://medium.com/s2wblog?source=post_page---post_publication_info--d1899c0e9317---------------------------------------" rel="noopener follow"><div class="fl"><img alt="S2W BLOG" class="cx hi m uu ut" src="https://miro.medium.com/v2/resize:fill:128:128/1*3vCxewFUeWWkQ-O5X558rQ.jpeg" width="64" height="64" loading="lazy"/><div class="hi m ut uu fu o ft hl"></div></div></a></div><div class="k j e uv uc"><div class="ac"><button style="border:1px solid rgba(0, 0, 0, 0)" class="kj kk ap ac cb r aq ex uw lx ux"><span class="bf b bg ab bk bh"><span class="bm ko">Follow</span></span></button></div></div></div><div class="ac co ca"><div class="uy uz va oy ow m"><a class="ag ah ai ak al am an ao ap aq ar as at au ac r" href="https://medium.com/s2wblog?source=post_page---post_publication_info--d1899c0e9317---------------------------------------" rel="noopener follow"><h2 class="pw-author-name bf gi vc vd ve vf vg vh gn go gp gq gr gs gt gu gv bk"><span class="hn vb">Published in <!-- -->S2W BLOG</span></h2></a><div class="ti ac jy"><div class="m uc"><span class="pw-follower-count bf b bg ab du"><a class="ag ah ai fh ak al am an ao ap aq ar as kh" rel="noopener follow" href="/s2wblog/followers?source=post_page---post_publication_info--d1899c0e9317---------------------------------------">247 followers</a></span></div><div class="bf b bg ab du ac rv"><span class="gw m" aria-hidden="true"><span class="bf b bg ab du">·</span></span><a class="ag ah ai fh ak al am an ao ap aq ar as kh" rel="noopener follow" href="/s2wblog/detailed-analysis-of-bpfdoor-targeting-south-korean-company-328171880a98?source=post_page---post_publication_info--d1899c0e9317---------------------------------------">Last published <span>Apr 30, 2025</span></a></div></div><div class="hm m"><p class="bf b bg ab bk"><span class="hn">S2W is a big data intelligence company specialized in the Dark Web, Deepweb and any other covert channels.</span></p></div></div></div><div class="i l"><div class="ac"><button style="border:1px solid rgba(0, 0, 0, 0)" class="kj kk ap ac cb r aq ex uw lx ux"><span class="bf b bg ab bk bh"><span class="bm ko">Follow</span></span></button></div></div></div></div><div class="ac jw ju js uf ug"><div class="uh ui uj uk ul um un uo up uq ac cp"><div class="i l"><a tabindex="0" rel="noopener follow" href="/@s2w?source=post_page---post_author_info--d1899c0e9317---------------------------------------"><div class="m fl"><img alt="S2W" class="m fd bx ur us cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*1DiWQYMzvUSAzrLJQX1z6g.png" width="48" height="48" loading="lazy"/><div class="ft bx m ur us fu o aj hl"></div></div></a></div><div class="k j e"><a tabindex="0" rel="noopener follow" href="/@s2w?source=post_page---post_author_info--d1899c0e9317---------------------------------------"><div class="m fl"><img alt="S2W" class="m fd bx ut uu cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*1DiWQYMzvUSAzrLJQX1z6g.png" width="64" height="64" loading="lazy"/><div class="ft bx m ut uu fu o aj hl"></div></div></a></div><div class="k j e uv uc"><div class="ac"><div class="bm" aria-hidden="false"><button style="border:1px solid rgba(0, 0, 0, 0)" class="kj kk ap ac cb r aq ex uw lx ux"><span class="bf b bg ab bk bh"><span class="bm ko">Follow</span></span></button></div></div></div></div><div class="ac co ca"><div class="uy uz va oy ow m"><a class="ag ah ai ak al am an ao ap aq ar as at au ac r" rel="noopener follow" href="/@s2w?source=post_page---post_author_info--d1899c0e9317---------------------------------------"><h2 class="pw-author-name bf gi vc vd ve vf vg vh gn go gp gq gr gs gt gu gv bk"><span class="hn vb">Written by <!-- -->S2W</span></h2></a><div class="ti ac jy"><div class="m uc"><span class="pw-follower-count bf b bg ab du"><a class="ag ah ai fh ak al am an ao ap aq ar as kh" rel="noopener follow" href="/@s2w/followers?source=post_page---post_author_info--d1899c0e9317---------------------------------------">696 followers</a></span></div><div class="bf b bg ab du ac rv"><span class="gw m" aria-hidden="true"><span class="bf b bg ab du">·</span></span><a class="ag ah ai fh ak al am an ao ap aq ar as kh" rel="noopener follow" href="/@s2w/following?source=post_page---post_author_info--d1899c0e9317---------------------------------------">21 following</a></div></div><div class="hm m"><p class="bf b bg ab bk"><span class="hn">S2W is specializing in cybersecurity data analysis for cyber threat intelligence.</span></p></div></div></div><div class="i l"><div class="ac"><div class="bm" aria-hidden="false"><button style="border:1px solid rgba(0, 0, 0, 0)" class="kj kk ap ac cb r aq ex uw lx ux"><span class="bf b bg ab bk bh"><span class="bm ko">Follow</span></span></button></div></div></div></div></div></div></div><div class="vi m"><div class="vj bh s ud"></div><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="ac r cp"><h2 class="bf gi qa qc gk qd qf gm qg qi qj qk qm qn qo qq qr bk">No responses yet</h2><div class="ac vk"><div><div class="bm" aria-hidden="false"><div tabindex="-1" class="be"><a class="vl vm" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--d1899c0e9317---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="vn vo vp vq vr m"></div></div></div></div><div class="vs vt vu vv vw m bw"><div class="i l k"><div class="vj bh vx vy"></div><div class="ac cb"><div class="ci bh ht hu hv hw"><div class="vz ac ly kp"><div class="wa wb m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://help.medium.com/hc/en-us?source=post_page-----d1899c0e9317---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Help</p></a></div><div class="wa wb m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://medium.statuspage.io/?source=post_page-----d1899c0e9317---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Status</p></a></div><div class="wa wb m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----d1899c0e9317---------------------------------------"><p class="bf b dv ab du">About</p></a></div><div class="wa wb m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----d1899c0e9317---------------------------------------"><p class="bf b dv ab du">Careers</p></a></div><div class="wa wb m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bf b dv ab du">Press</p></a></div><div class="wa wb m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://blog.medium.com/?source=post_page-----d1899c0e9317---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Blog</p></a></div><div class="wa wb m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d1899c0e9317---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Privacy</p></a></div><div class="wa wb m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----d1899c0e9317---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Rules</p></a></div><div class="wa wb m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d1899c0e9317---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Terms</p></a></div><div class="wa m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://speechify.com/medium?source=post_page-----d1899c0e9317---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250523-140855-26da6c5d7e"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-d1899c0e9317","user-b408bb1e7c46","collection-30a8766b5c42","group-followSubscribeButtonEnabled"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"pubFeaturingPostPageLabelEnabled":false,"shouldFollowPostQueryEnabled":false,"followSubscribeButtonEnabled":true,"sunsetLoNonMocUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"755d73a6-0ff3-4cf3-a47d-363dc1aa4197","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-6088c80edb99b204a00f3e82e3aa0ae9-8ad28dc40fba1430-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"staticRouterContext":{"route":{"name":"ShowPostUnderCollection"},"statusCode":200},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250523-140855-26da6c5d7e","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","iosAppId":"828256236","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250523-140855-26da6c5d7e","commit":"26da6c5d7e0a1bda448bb9180425dd04761334c6"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"s2wblog\"})":{"__ref":"Collection:30a8766b5c42"},"postResult({\"id\":\"d1899c0e9317\"})":{"__ref":"Post:d1899c0e9317"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"Collection:30a8766b5c42":{"__typename":"Collection","id":"30a8766b5c42","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"domain":null,"slug":"s2wblog","googleAnalyticsId":null,"name":"S2W BLOG","avatar":{"__ref":"ImageMetadata:1*3vCxewFUeWWkQ-O5X558rQ.jpeg"},"description":"S2W is a big data intelligence company specialized in the Dark Web, Deepweb and any other covert channels.","subscriberCount":247,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:328171880a98"}]},"isAuroraVisible":false,"tintColor":null,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:30a8766b5c42-viewerId:lo_8149ad905322"},"twitterUsername":"s2w_official","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*dAAOzI0wCWzr0K3RGg2Pzw.png"}},"ImageMetadata:1*3vCxewFUeWWkQ-O5X558rQ.jpeg":{"__typename":"ImageMetadata","id":"1*3vCxewFUeWWkQ-O5X558rQ.jpeg"},"User:b408bb1e7c46":{"__typename":"User","id":"b408bb1e7c46","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"s2w.medium.com"}},"hasSubdomain":true,"username":"s2w","name":"S2W","newsletterV3":{"__ref":"NewsletterV3:132c6e8141c4"},"linkedAccounts":{"__ref":"LinkedAccounts:b408bb1e7c46"},"isSuspended":false,"imageId":"1*1DiWQYMzvUSAzrLJQX1z6g.png","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:b408bb1e7c46-viewerId:lo_8149ad905322"},"viewerIsUser":false,"socialStats":{"__typename":"SocialStats","followerCount":696,"followingCount":12,"collectionFollowingCount":9},"bio":"S2W is specializing in cybersecurity data analysis for cyber threat intelligence.","membership":{"__ref":"Membership:bec398b2-fc51-451b-b2e0-9b0436f4b1d5"},"allowNotes":true,"twitterScreenName":"S2W_Official"},"Post:328171880a98":{"__typename":"Post","id":"328171880a98","firstPublishedAt":1746029175000,"creator":{"__ref":"User:b408bb1e7c46"},"collection":{"__ref":"Collection:30a8766b5c42"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Fdetailed-analysis-of-bpfdoor-targeting-south-korean-company-328171880a98","sequence":null,"uniqueSlug":"detailed-analysis-of-bpfdoor-targeting-south-korean-company-328171880a98"},"LinkedAccounts:b408bb1e7c46":{"__typename":"LinkedAccounts","mastodon":null,"id":"b408bb1e7c46"},"UserViewerEdge:userId:b408bb1e7c46-viewerId:lo_8149ad905322":{"__typename":"UserViewerEdge","id":"userId:b408bb1e7c46-viewerId:lo_8149ad905322","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:132c6e8141c4":{"__typename":"NewsletterV3","id":"132c6e8141c4","type":"NEWSLETTER_TYPE_AUTHOR","slug":"b408bb1e7c46","name":"b408bb1e7c46","collection":null,"user":{"__ref":"User:b408bb1e7c46"}},"Membership:bec398b2-fc51-451b-b2e0-9b0436f4b1d5":{"__typename":"Membership","tier":"MEMBER","id":"bec398b2-fc51-451b-b2e0-9b0436f4b1d5"},"Paragraph:230c5f8520b0_0":{"__typename":"Paragraph","id":"230c5f8520b0_0","name":"b7dd","type":"H3","href":null,"layout":null,"metadata":null,"text":"Deep analysis of REvil Ransomware | Written in Korean","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_1":{"__typename":"Paragraph","id":"230c5f8520b0_1","name":"a2a5","type":"P","href":null,"layout":null,"metadata":null,"text":"Author: Sojun Ryu (hypen) @ S2WLAB Talon","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":19,"end":24,"href":null,"anchorType":"USER","userId":"c109a5c416ae","linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_2":{"__typename":"Paragraph","id":"230c5f8520b0_2","name":"ab94","type":"BQ","href":null,"layout":null,"metadata":null,"text":"We are working on the English version. Coming soon!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Qs6ckloSB92wDYDACISQoA.png":{"__typename":"ImageMetadata","id":"1*Qs6ckloSB92wDYDACISQoA.png","originalHeight":1876,"originalWidth":5122,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_3":{"__typename":"Paragraph","id":"230c5f8520b0_3","name":"ee04","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Qs6ckloSB92wDYDACISQoA.png"},"text":"Photo by Clint Patterson on Unsplash","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":24,"href":"https:\u002F\u002Funsplash.com\u002F@cbpsc1?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":28,"end":36,"href":"https:\u002F\u002Funsplash.com\u002Fs\u002Fphotos\u002Fhacker?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_4":{"__typename":"Paragraph","id":"230c5f8520b0_4","name":"0328","type":"H3","href":null,"layout":null,"metadata":null,"text":"Executive Summary","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_5":{"__typename":"Paragraph","id":"230c5f8520b0_5","name":"e058","type":"H4","href":null,"layout":null,"metadata":null,"text":"침투과정","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_6":{"__typename":"Paragraph","id":"230c5f8520b0_6","name":"e3e0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"2019년 4월에 처음 등장한 REvil 랜섬웨어는 초기 오라클 웹로직 취약점 (CVE-2019–2725)을 이용하여 다양한 환경에 최초 침투를 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_7":{"__typename":"Paragraph","id":"230c5f8520b0_7","name":"105e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"이후 Pulse Secure VPN 취약점 (CVE-2019–11510), FortiOS VPN 취약점 (CVE-2018–13379) 및 RDP 취약점 등 제로데이 취약점이 아닌, 패치가 적용되기 전의 N-day 취약점을 통해 기업 환경에 침투를 시도하여 매우 많은 기업을 감염시킴","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_8":{"__typename":"Paragraph","id":"230c5f8520b0_8","name":"fc0e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"최근에는 다크웹에서 이미 유명한 악성코드인 Gootkit, QBot, IcedId와 같은 다운로드 및 로드에 특화된 악성코드에 의해 실행됨","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_9":{"__typename":"Paragraph","id":"230c5f8520b0_9","name":"8265","type":"H4","href":null,"layout":null,"metadata":null,"text":"주요 특징","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_10":{"__typename":"Paragraph","id":"230c5f8520b0_10","name":"f558","type":"ULI","href":null,"layout":null,"metadata":null,"text":"암호화 키 교환 시, 랜섬웨어 악성코드들이 주로 사용하는 RSA를 사용하지 않고 타원 곡선 기반 암호(Elliptic Curve Cryptography)를 사용하며, 파일 암호화에는 Salsa20 알고리즘을 이용하여 파일을 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_11":{"__typename":"Paragraph","id":"230c5f8520b0_11","name":"e001","type":"ULI","href":null,"layout":null,"metadata":null,"text":"로컬 드라이브 내 파일 뿐만 아니라 원격 드라이브 및 공유 드라이브 내 파일도 암호화하며, IOCP기법을 사용한 비동기 I\u002FO방식으로 암호화 속도를 높임","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_12":{"__typename":"Paragraph","id":"230c5f8520b0_12","name":"2c38","type":"ULI","href":null,"layout":null,"metadata":null,"text":"2019년 12월부터 자체 Leak 사이트를 운영하여 피해 기업으로부터 탈취한 데이터를 게시하며, 협상에 응하지 않을 시 데이터를 공개하는 이중 갈취 전략을 사용.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_13":{"__typename":"Paragraph","id":"230c5f8520b0_13","name":"515b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"비트코인을 통해 몸값을 지불받다가 2020년 4월부터 모네로로 변경함. 하지만 최근에는 피해자가 비트코인으로 지불을 원할 시, 10% 추가 금액을 낼 경우 비트코인으로도 지불받음","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_14":{"__typename":"Paragraph","id":"230c5f8520b0_14","name":"43a5","type":"ULI","href":null,"layout":null,"metadata":null,"text":"2021년 2월부터는 기존 Leak 사이트를 통한 이중 갈취 전략에서 홈페이지 DDoS 공격 및 피해 기업의 비즈니스 파트너에게 VoIP로 연락하는 협박 방식을 추가하겠다고 언급","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_15":{"__typename":"Paragraph","id":"230c5f8520b0_15","name":"e3bb","type":"H4","href":null,"layout":null,"metadata":null,"text":"최근 이슈","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_16":{"__typename":"Paragraph","id":"230c5f8520b0_16","name":"45e2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"최근 Darkside의 Colonial Pipeline 공격, REvil 랜섬웨어의 JBS 공격 이후로 미국이 랜섬웨어 공격에 강력하게 대처하겠다는 발표 후, REvil은 오히려 미국에 대한 공격을 멈추지 않고, 더욱 더 강화하겠다고 언급함","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_17":{"__typename":"Paragraph","id":"230c5f8520b0_17","name":"e3ce","type":"ULI","href":null,"layout":null,"metadata":null,"text":"현재까지 REvil 랜섬웨어 조직은 Darkside 랜섬웨어 조직, LV 랜섬웨어 조직과 Prometheus 조직까지 최소 3개의 랜섬웨어 조직과 연관되어있음","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*sgzuMd7v675NXHydNMbUoA.png":{"__typename":"ImageMetadata","id":"1*sgzuMd7v675NXHydNMbUoA.png","originalHeight":1987,"originalWidth":1920,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_18":{"__typename":"Paragraph","id":"230c5f8520b0_18","name":"a5c7","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*sgzuMd7v675NXHydNMbUoA.png"},"text":"Overall flow of REvil Ransomware","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_19":{"__typename":"Paragraph","id":"230c5f8520b0_19","name":"daa3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Malware Information","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_20":{"__typename":"Paragraph","id":"230c5f8520b0_20","name":"3db4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MD5 : 2075566e7855679d66705741dabe82b4\nSHA-1 : 136443e2746558b403ae6fc9d9b40bfa92b23420\nSHA-256 : 12d8bfa1aeb557c146b98f069f3456cc8392863a2f4ad938722cd7ca1a773b39\nCompile Time: 2021–03–21 21:46:43\nFile type : Win32 EXE file","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":223,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":39,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":88,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":163,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":197,"end":206,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_21":{"__typename":"Paragraph","id":"230c5f8520b0_21","name":"17c4","type":"H3","href":null,"layout":null,"metadata":null,"text":"Detailed Analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_22":{"__typename":"Paragraph","id":"230c5f8520b0_22","name":"6d93","type":"H4","href":null,"layout":null,"metadata":null,"text":"1. RC4 알고리즘을 이용하여 데이터 복호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_23":{"__typename":"Paragraph","id":"230c5f8520b0_23","name":"0d53","type":"P","href":null,"layout":null,"metadata":null,"text":"REvil 랜섬웨어는 RC4알고리즘을 이용하여 악성코드 내부에 포함된 Win32 API함수 주소, 설정정보 및 문자열을 복호화하고 악성 행위에 사용한다. 악성코드마다 사용되는 key는 상이하다.\nRC4 key : 9UAo1qQ8ce4w13Jv36xcPgMz6NCykVjs","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":109,"end":151,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_24":{"__typename":"Paragraph","id":"230c5f8520b0_24","name":"e797","type":"H4","href":null,"layout":null,"metadata":null,"text":"2. 상세 옵션을 통해 세부 기능 설정","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_25":{"__typename":"Paragraph","id":"230c5f8520b0_25","name":"64b8","type":"P","href":null,"layout":null,"metadata":null,"text":"복호화된 정보 중 악성 행위에 필요한 19개의 상세 옵션이 JSON 형태로 표현되어 있다. 분석한 샘플인 2.05 버전의 각 옵션별 기능은 아래와 같다.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*GRsqaoitWYtOriCIfiIXrg.png":{"__typename":"ImageMetadata","id":"1*GRsqaoitWYtOriCIfiIXrg.png","originalHeight":1082,"originalWidth":1564,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_26":{"__typename":"Paragraph","id":"230c5f8520b0_26","name":"9f4c","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*GRsqaoitWYtOriCIfiIXrg.png"},"text":"Table 1. 상세 옵션표","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_27":{"__typename":"Paragraph","id":"230c5f8520b0_27","name":"81be","type":"H4","href":null,"layout":null,"metadata":null,"text":"3. 암호화 사전 작업","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_28":{"__typename":"Paragraph","id":"230c5f8520b0_28","name":"f12b","type":"P","href":null,"layout":null,"metadata":null,"text":"REvil 랜섬웨어는 기존 랜섬웨어 그룹들이 주로 사용하는 RSA와 AES 알고리즘 조합을 사용하지 않고, ECC Diffie hellman 키 교환과 AES-256이 결합된 ECIES 공개키 알고리즘과 Salsa20 비밀키 알고리즘으로 파일 및 데이터를 암호화한다. 이를 위해 악성코드 내에 하드코딩 된 key를 이용하여 암호화에 필요한 구조체 데이터를 사전에 생성하며, 이를 레지스트리에 저장하여 재실행되어도 기존에 생성된 key를 사용함으로써 해당 값이 바뀌지 않도록 한다. 사용되는 레지스트리는 REvil 랜섬웨어 버전별로 상이하다.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jjJa5X6R5KMpapZFLSUOLQ.png":{"__typename":"ImageMetadata","id":"1*jjJa5X6R5KMpapZFLSUOLQ.png","originalHeight":1138,"originalWidth":1320,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_29":{"__typename":"Paragraph","id":"230c5f8520b0_29","name":"35dc","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jjJa5X6R5KMpapZFLSUOLQ.png"},"text":"Ecryption Flow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_30":{"__typename":"Paragraph","id":"230c5f8520b0_30","name":"0266","type":"P","href":null,"layout":null,"metadata":null,"text":"1) 레지스트리 path : HKLM\\SOFTWARE\\BlackLivesMatter","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_31":{"__typename":"Paragraph","id":"230c5f8520b0_31","name":"4b5a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"key : 54k =\u003E value : 공격자 공개키 (pk)\nkey : aOwO =\u003E value : 파일 암호화 key생성에 사용된 공개키 (pk_key)\nkey : Krdfp =\u003E value : 공격자 공개키로 암호화된 비밀키 구조체 (sk_key struct)\nkey : hq0G6x =\u003E value : 제작자 마스터키로 암호화된 비밀키 구조체 (0_key struct)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_32":{"__typename":"Paragraph","id":"230c5f8520b0_32","name":"42be","type":"P","href":null,"layout":null,"metadata":null,"text":"2) HKLM 경로에 등록 실패 시 HKCU로 변경하여 등록 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_33":{"__typename":"Paragraph","id":"230c5f8520b0_33","name":"18c7","type":"H4","href":null,"layout":null,"metadata":null,"text":"4. 감염기기 정보 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_34":{"__typename":"Paragraph","id":"230c5f8520b0_34","name":"084c","type":"P","href":null,"layout":null,"metadata":null,"text":"이후 감염된 기기의 정보를 수집한다. 수집 목록은 아래와 같다.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_35":{"__typename":"Paragraph","id":"230c5f8520b0_35","name":"05f4","type":"P","href":null,"layout":null,"metadata":null,"text":"1) 감염기기 식별 값 (UID)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_36":{"__typename":"Paragraph","id":"230c5f8520b0_36","name":"6bdc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"현재 디스크의 VolumeSerial과 프로세서 이름을 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_37":{"__typename":"Paragraph","id":"230c5f8520b0_37","name":"20b6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"각각의 CRC32 체크섬 값을 조합한 16글자 문자열","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_38":{"__typename":"Paragraph","id":"230c5f8520b0_38","name":"dc3b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"예시 : 3EE1CF8D0ECB68EF","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_39":{"__typename":"Paragraph","id":"230c5f8520b0_39","name":"570d","type":"P","href":null,"layout":null,"metadata":null,"text":"2) 암호화 확장자 (Extension)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_40":{"__typename":"Paragraph","id":"230c5f8520b0_40","name":"2995","type":"ULI","href":null,"layout":null,"metadata":null,"text":"5~10개의 랜덤 문자 조합 문자열 (기존 화이트리스트에 포함되지 않은)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_41":{"__typename":"Paragraph","id":"230c5f8520b0_41","name":"beef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"예시 : 670o6j8nm","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_42":{"__typename":"Paragraph","id":"230c5f8520b0_42","name":"a60c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"이후 레지스트리에 생성한 랜덤 확장자 저장","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_43":{"__typename":"Paragraph","id":"230c5f8520b0_43","name":"a7ea","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Path : HKLM\\ SOFTWARE\\\\BlackLivesMatter","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_44":{"__typename":"Paragraph","id":"230c5f8520b0_44","name":"ec0f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Key : x4WHjRs → value : [랜덤 확장자]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_45":{"__typename":"Paragraph","id":"230c5f8520b0_45","name":"8932","type":"ULI","href":null,"layout":null,"metadata":null,"text":"HKLM 경로에 등록 실패 시 HKCU로 경로 변경","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_46":{"__typename":"Paragraph","id":"230c5f8520b0_46","name":"e03e","type":"P","href":null,"layout":null,"metadata":null,"text":"3) 유저명\n4) 컴퓨터명\n5) 현재 기기의 도메인명 도메인이 없을 경우 WORKGROUP으로 지정\n6) 현재 지역 및 사용 언어\n7) 현재 유저의 사용 언어, 시스템의 기본 언어, 키보드 layout을 수집 후 CIS 국가 여부 확인","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":30,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_47":{"__typename":"Paragraph","id":"230c5f8520b0_47","name":"5b4b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"CIS: Commonwealth of Independent States 의 약자로 1991년 소련(소비에트 연방)의 해체로 독립한 국가들의 국제기구. 러시아, 몰도바, 벨라루스, 아르메니아, 아제르바이잔, 우즈베키스탄, 카자흐스탄, 키르기스스탄, 타지키스탄이 공식 회원국으로 참여하고 있으며 투르크메니스탄, 몽골, 아프가니스탄은 비공식 참관국으로 참여하고 있음","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":201,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_48":{"__typename":"Paragraph","id":"230c5f8520b0_48","name":"7639","type":"P","href":null,"layout":null,"metadata":null,"text":"8) 운영체제 버전\n9) 디스크 별 전체 용량 및 사용 가능한 용량\n10) 컴퓨터 x86, x64 여부","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_49":{"__typename":"Paragraph","id":"230c5f8520b0_49","name":"459d","type":"H4","href":null,"layout":null,"metadata":null,"text":"5. CIS국가 여부 확인","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_50":{"__typename":"Paragraph","id":"230c5f8520b0_50","name":"061d","type":"P","href":null,"layout":null,"metadata":null,"text":"상세 옵션 중 dbg옵션이 False일 경우, 아래와 같이 유저 및 시스템 언어, 키보드 layout을 확인하여 CIS(독립국가연합) 지역의 기기일 경우 악성 행위를 수행하지 않는다. 반면 dbg 옵션이 True일 경우 공격자들의 디버깅용으로 실행되며 언어 및 layout을 확인하지 않는다.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rvF55xZVqIKfvnALL_c6Lg.png":{"__typename":"ImageMetadata","id":"1*rvF55xZVqIKfvnALL_c6Lg.png","originalHeight":982,"originalWidth":1564,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_51":{"__typename":"Paragraph","id":"230c5f8520b0_51","name":"6d91","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*rvF55xZVqIKfvnALL_c6Lg.png"},"text":"Table 2. 유저\u002F시스템 언어와 키보드 레이아웃","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_52":{"__typename":"Paragraph","id":"230c5f8520b0_52","name":"76dd","type":"H4","href":null,"layout":null,"metadata":null,"text":"6. 파라미터를 통한 실행 모드 지정","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*VbXk_qbvRQUoREVyrDC8qg.png":{"__typename":"ImageMetadata","id":"1*VbXk_qbvRQUoREVyrDC8qg.png","originalHeight":464,"originalWidth":1436,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_53":{"__typename":"Paragraph","id":"230c5f8520b0_53","name":"aa75","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VbXk_qbvRQUoREVyrDC8qg.png"},"text":"Table 3. 파라미터 목록","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_54":{"__typename":"Paragraph","id":"230c5f8520b0_54","name":"6a4e","type":"P","href":null,"layout":null,"metadata":null,"text":"-nolan:네트워크 공유드라이브는 감염 대상에서 제외","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_55":{"__typename":"Paragraph","id":"230c5f8520b0_55","name":"8f2e","type":"P","href":null,"layout":null,"metadata":null,"text":"1) 파라미터로 주어지지 않은 경우, 네트워크 드라이브 암호화 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_56":{"__typename":"Paragraph","id":"230c5f8520b0_56","name":"7f4d","type":"P","href":null,"layout":null,"metadata":null,"text":"2) 원격 드라이브 암호화: A~Z드라이브 중 원격 드라이브 내 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_57":{"__typename":"Paragraph","id":"230c5f8520b0_57","name":"ac43","type":"P","href":null,"layout":null,"metadata":null,"text":"3) 공유 드라이브","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_58":{"__typename":"Paragraph","id":"230c5f8520b0_58","name":"3380","type":"ULI","href":null,"layout":null,"metadata":null,"text":"현재 연결된 모든 공유 리소스 내 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_59":{"__typename":"Paragraph","id":"230c5f8520b0_59","name":"70c5","type":"ULI","href":null,"layout":null,"metadata":null,"text":"네트워크 컨텍스트 내 모든 공유 리소스 내 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_60":{"__typename":"Paragraph","id":"230c5f8520b0_60","name":"54e4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"네트워크의 모든 공유 리소스 내 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_61":{"__typename":"Paragraph","id":"230c5f8520b0_61","name":"87f1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"영구적으로 연결된 모든 공유 리소스 내 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_62":{"__typename":"Paragraph","id":"230c5f8520b0_62","name":"b10a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"최근 연결된 모든 공유 리 소스 내 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_63":{"__typename":"Paragraph","id":"230c5f8520b0_63","name":"5464","type":"P","href":null,"layout":null,"metadata":null,"text":"-nolocal: 로컬 드라이브는 감염 대상에서 제외","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_64":{"__typename":"Paragraph","id":"230c5f8520b0_64","name":"7d0f","type":"P","href":null,"layout":null,"metadata":null,"text":"1) 파라미터로 주어지지 않은 경우, 로컬 드라이브 암호화 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_65":{"__typename":"Paragraph","id":"230c5f8520b0_65","name":"618c","type":"P","href":null,"layout":null,"metadata":null,"text":"2) 로컬 드라이브 암호화: A~Z드라이브 중, 이동식 및 일반 드라이브 내 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_66":{"__typename":"Paragraph","id":"230c5f8520b0_66","name":"f15c","type":"P","href":null,"layout":null,"metadata":null,"text":"-smode: 윈도우 계정 비밀번호 변경 및 안전모드로 재부팅","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_67":{"__typename":"Paragraph","id":"230c5f8520b0_67","name":"32b5","type":"P","href":null,"layout":null,"metadata":null,"text":"1) 안전모드 부팅이 아닌, 정상 모드로 부팅되었을 경우에만 동작","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_68":{"__typename":"Paragraph","id":"230c5f8520b0_68","name":"6216","type":"P","href":null,"layout":null,"metadata":null,"text":"2) 안전모드에서 암호화를 할 경우, 백신 탐지를 우회하고 파일 암호화의 성공률이 높아질 수 있음","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_69":{"__typename":"Paragraph","id":"230c5f8520b0_69","name":"69d4","type":"P","href":null,"layout":null,"metadata":null,"text":"3) 현재 계정의 비밀번호를 “DTrump4ever”로 변경","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_70":{"__typename":"Paragraph","id":"230c5f8520b0_70","name":"eece","type":"P","href":null,"layout":null,"metadata":null,"text":"4) 레지스트리를 변경하여 변경된 비밀번호로 자동 로그인되도록 설정","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_71":{"__typename":"Paragraph","id":"230c5f8520b0_71","name":"0ca9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Path : HKLM\\ SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_72":{"__typename":"Paragraph","id":"230c5f8520b0_72","name":"db6f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Key : AutoAdminLogon → value : 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_73":{"__typename":"Paragraph","id":"230c5f8520b0_73","name":"769a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Key : DefaultUserName → value : 현재 유저 명","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_74":{"__typename":"Paragraph","id":"230c5f8520b0_74","name":"ffc3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Key : DefaultPassword → value : DTrump4ver","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_75":{"__typename":"Paragraph","id":"230c5f8520b0_75","name":"a945","type":"P","href":null,"layout":null,"metadata":null,"text":"5) 레지스트리 변경 후 재부팅 완료시 악성코드 재실행 및 부팅 모드 정상 모드로 복구","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_76":{"__typename":"Paragraph","id":"230c5f8520b0_76","name":"e411","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Path : HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_77":{"__typename":"Paragraph","id":"230c5f8520b0_77","name":"7f4a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Key : *AstraZeneca → value : 악성코드 파일 명","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_78":{"__typename":"Paragraph","id":"230c5f8520b0_78","name":"e026","type":"ULI","href":null,"layout":null,"metadata":null,"text":"(Vista 이전) Key : *MarineLePen → value : bootcfg \u002Fraw \u002Ffastdetect \u002Fid 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_79":{"__typename":"Paragraph","id":"230c5f8520b0_79","name":"4f37","type":"ULI","href":null,"layout":null,"metadata":null,"text":"(Vista 이후) Key : *MarineLePen → value : bcdedit \u002Fdeletevalue {current} safeboot","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_80":{"__typename":"Paragraph","id":"230c5f8520b0_80","name":"3dd7","type":"P","href":null,"layout":null,"metadata":null,"text":"6) 설정 후, 부팅 모드를 네트워크 가능한 안전모드로 변경하는 명령어 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_81":{"__typename":"Paragraph","id":"230c5f8520b0_81","name":"6aab","type":"ULI","href":null,"layout":null,"metadata":null,"text":"(Vista 이전) 명령어 : bootcfg \u002Fraw \u002Fa \u002Fsafeboot:network \u002Fid 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_82":{"__typename":"Paragraph","id":"230c5f8520b0_82","name":"859d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"(Vista 이후) 명령어 : bcdedit \u002Fset {current} safeboot network","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_83":{"__typename":"Paragraph","id":"230c5f8520b0_83","name":"8df3","type":"P","href":null,"layout":null,"metadata":null,"text":"7) 설정 완료 후 감염기기 재부팅","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_84":{"__typename":"Paragraph","id":"230c5f8520b0_84","name":"2883","type":"ULI","href":null,"layout":null,"metadata":null,"text":"명령어 : SHUTDOWN -r -f -t 02","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_85":{"__typename":"Paragraph","id":"230c5f8520b0_85","name":"53f4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"2초 후 시스템을 강제로 재부팅","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_86":{"__typename":"Paragraph","id":"230c5f8520b0_86","name":"5dad","type":"P","href":null,"layout":null,"metadata":null,"text":"-silent: 특정 서비스, 프로세스 종료 및 볼륨 섀도우 카피 삭제 수행하지 않음","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_87":{"__typename":"Paragraph","id":"230c5f8520b0_87","name":"c616","type":"P","href":null,"layout":null,"metadata":null,"text":"1) 파라미터로 주어지지 않은 경우, 특정 서비스와 프로세스 종료 및 볼륨 섀도우 카피 삭제","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_88":{"__typename":"Paragraph","id":"230c5f8520b0_88","name":"a209","type":"P","href":null,"layout":null,"metadata":null,"text":"2) Win32 API를 이용하여 현재 실행 중인 특정 프로세스 종료","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_89":{"__typename":"Paragraph","id":"230c5f8520b0_89","name":"1fad","type":"P","href":null,"layout":null,"metadata":null,"text":"3) WMI로 신규 프로세스 생성 Event를 모니터링하여 특정 프로세스 생성 시 종료","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_90":{"__typename":"Paragraph","id":"230c5f8520b0_90","name":"24df","type":"P","href":null,"layout":null,"metadata":null,"text":"4) 특정 프로세스 목록","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*f3vK27N8RDAn9ft4n5BYgw.png":{"__typename":"ImageMetadata","id":"1*f3vK27N8RDAn9ft4n5BYgw.png","originalHeight":664,"originalWidth":1568,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_91":{"__typename":"Paragraph","id":"230c5f8520b0_91","name":"858a","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*f3vK27N8RDAn9ft4n5BYgw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_92":{"__typename":"Paragraph","id":"230c5f8520b0_92","name":"a841","type":"P","href":null,"layout":null,"metadata":null,"text":"5) Win32 API를 이용하여 현재 실행 중인 특정 서비스 종료","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_93":{"__typename":"Paragraph","id":"230c5f8520b0_93","name":"84c4","type":"P","href":null,"layout":null,"metadata":null,"text":"6) WMI로 서비스 변동사항 Event를 모니터링하여 특정 서비스 실행 시 중지","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_94":{"__typename":"Paragraph","id":"230c5f8520b0_94","name":"b9e5","type":"P","href":null,"layout":null,"metadata":null,"text":"7) 특정 서비스 목록","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*I20lTr4W8WsHWurr4aL1tg.png":{"__typename":"ImageMetadata","id":"1*I20lTr4W8WsHWurr4aL1tg.png","originalHeight":658,"originalWidth":1540,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_95":{"__typename":"Paragraph","id":"230c5f8520b0_95","name":"096e","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*I20lTr4W8WsHWurr4aL1tg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_96":{"__typename":"Paragraph","id":"230c5f8520b0_96","name":"a705","type":"P","href":null,"layout":null,"metadata":null,"text":"8) WQL(SQL for WMI) 쿼리를 이용하여 감염된 기기의 Volume Shadow Copy를 모두 삭제","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_97":{"__typename":"Paragraph","id":"230c5f8520b0_97","name":"f2f3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"WQL Query : SELECT * FROM Win32_ShadowCopy","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_98":{"__typename":"Paragraph","id":"230c5f8520b0_98","name":"31b6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"이후 Win32_ShadowCopy.ID=[조회한 ID]에 대하여 DeleteInstance 작업 수행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_99":{"__typename":"Paragraph","id":"230c5f8520b0_99","name":"683f","type":"P","href":null,"layout":null,"metadata":null,"text":"-path: 특정 경로에 대해서만 암호화 진행","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_100":{"__typename":"Paragraph","id":"230c5f8520b0_100","name":"6124","type":"P","href":null,"layout":null,"metadata":null,"text":"1) 주어진 경로에 대해서만 파일 암호화 진행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_101":{"__typename":"Paragraph","id":"230c5f8520b0_101","name":"7529","type":"P","href":null,"layout":null,"metadata":null,"text":"2) 네트워크 및 로컬 경로 여부 확인하여 진행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_102":{"__typename":"Paragraph","id":"230c5f8520b0_102","name":"6920","type":"P","href":null,"layout":null,"metadata":null,"text":"3) 전체 파일 암호화 전에 공격자가 테스트 용도로 사용하는 기능","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_103":{"__typename":"Paragraph","id":"230c5f8520b0_103","name":"cffb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"-path로 실행될 경우 권한 상승, 정보유출, 바탕화면 변경 등을 수행하지 않음","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_104":{"__typename":"Paragraph","id":"230c5f8520b0_104","name":"8ee1","type":"P","href":null,"layout":null,"metadata":null,"text":"-fast: 빠른 암호화 모드","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_105":{"__typename":"Paragraph","id":"230c5f8520b0_105","name":"d335","type":"P","href":null,"layout":null,"metadata":null,"text":"1) -path와 함께 사용되며, 파일 암호화 시 상위 0x100000만 암호화를 수행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_106":{"__typename":"Paragraph","id":"230c5f8520b0_106","name":"ce4f","type":"P","href":null,"layout":null,"metadata":null,"text":"2) 상세 옵션 중 et가 1일 때와 동일","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_107":{"__typename":"Paragraph","id":"230c5f8520b0_107","name":"9d69","type":"P","href":null,"layout":null,"metadata":null,"text":"-full: 전체 암호화 모드","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_108":{"__typename":"Paragraph","id":"230c5f8520b0_108","name":"4215","type":"P","href":null,"layout":null,"metadata":null,"text":"1) -path와 함께 사용되며, 파일 암호화 시 파일 전체에 대해서 암호화를 수행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_109":{"__typename":"Paragraph","id":"230c5f8520b0_109","name":"15f9","type":"P","href":null,"layout":null,"metadata":null,"text":"2) 상세 옵션 중 et가 0일 때와 동일","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_110":{"__typename":"Paragraph","id":"230c5f8520b0_110","name":"c741","type":"H4","href":null,"layout":null,"metadata":null,"text":"7. 동작 과정","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_111":{"__typename":"Paragraph","id":"230c5f8520b0_111","name":"8e68","type":"P","href":null,"layout":null,"metadata":null,"text":"1) 뮤텍스 생성","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_112":{"__typename":"Paragraph","id":"230c5f8520b0_112","name":"68d0","type":"P","href":null,"layout":null,"metadata":null,"text":"악성코드의 중복 실행 방지를 위해 특정 문자열을 이용하여 뮤텍스 생성","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_113":{"__typename":"Paragraph","id":"230c5f8520b0_113","name":"914e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"뮤텍스 명 : Global\\\\F69C27FF-AB15-CCAA-A2D6–7F7ADA90E7E3","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_114":{"__typename":"Paragraph","id":"230c5f8520b0_114","name":"a2f2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"문자열은 악성코드마다 다른 값을 사용","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_115":{"__typename":"Paragraph","id":"230c5f8520b0_115","name":"7291","type":"ULI","href":null,"layout":null,"metadata":null,"text":"중복 실행 시 현재 프로세스를 종료","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_116":{"__typename":"Paragraph","id":"230c5f8520b0_116","name":"1efe","type":"P","href":null,"layout":null,"metadata":null,"text":"2) 상세 옵션 exp (Table 1. 상세 옵션표 참고)에 따른 행위 수행","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":9,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_117":{"__typename":"Paragraph","id":"230c5f8520b0_117","name":"f8fd","type":"ULI","href":null,"layout":null,"metadata":null,"text":"유저가 관리자 권한을 갖고 있지만, 프로세스가 관리자 권한을 갖지 않은 경우 프로세스 재실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_118":{"__typename":"Paragraph","id":"230c5f8520b0_118","name":"ad69","type":"ULI","href":null,"layout":null,"metadata":null,"text":"유저가 승낙할 때까지 관리자 권한으로 실행을 요구하는 UAC 수락 요청 창을 화면 상에 계속 표출","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_119":{"__typename":"Paragraph","id":"230c5f8520b0_119","name":"69f3","type":"P","href":null,"layout":null,"metadata":null,"text":"3) 암호화 작업 전 기타 행위","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_120":{"__typename":"Paragraph","id":"230c5f8520b0_120","name":"5dca","type":"ULI","href":null,"layout":null,"metadata":null,"text":"강제로 휴지통 비우기","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_121":{"__typename":"Paragraph","id":"230c5f8520b0_121","name":"320a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"프로세스의 CPU 스케줄링 우선순위를 일반 프로세스보다 한 단계 상승시켜 리소스 사용","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_122":{"__typename":"Paragraph","id":"230c5f8520b0_122","name":"c6f8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"프로세스가 실행되는 도중 절전 모드 전환 및 디스플레이 꺼짐 방지","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_123":{"__typename":"Paragraph","id":"230c5f8520b0_123","name":"d50f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"SeDebugPrivilege 권한을 할당하여 타 프로세스에 접근 가능하도록 권한 설정","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_124":{"__typename":"Paragraph","id":"230c5f8520b0_124","name":"b938","type":"P","href":null,"layout":null,"metadata":null,"text":"4) 상세 옵션 arn (Table 1. 상세 옵션표 참고) 에 따른 행위 수행","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":9,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_125":{"__typename":"Paragraph","id":"230c5f8520b0_125","name":"75e1","type":"P","href":null,"layout":null,"metadata":null,"text":"레지스트리를 변경하여 기기를 재부팅하더라도 악성코드가 실행되도록 설정","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_126":{"__typename":"Paragraph","id":"230c5f8520b0_126","name":"7a44","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Path : HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_127":{"__typename":"Paragraph","id":"230c5f8520b0_127","name":"76a0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Key : 3\"qZhotTgfr3 → value : 악성코드 파일 명","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_128":{"__typename":"Paragraph","id":"230c5f8520b0_128","name":"ea06","type":"ULI","href":null,"layout":null,"metadata":null,"text":"HKLM 경로에 등록 실패 시 HKCU로 변경","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_129":{"__typename":"Paragraph","id":"230c5f8520b0_129","name":"b92a","type":"P","href":null,"layout":null,"metadata":null,"text":"5) 바탕화면 변경","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_130":{"__typename":"Paragraph","id":"230c5f8520b0_130","name":"485b","type":"P","href":null,"layout":null,"metadata":null,"text":"1. 바탕화면을 파란색 배경에 자신들의 메시지가 담긴 이미지로 변경","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_131":{"__typename":"Paragraph","id":"230c5f8520b0_131","name":"2036","type":"ULI","href":null,"layout":null,"metadata":null,"text":"원본 이미지 파일 경로 : %temp%\\[랜덤 3~13개의 문자열].bmp","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_132":{"__typename":"Paragraph","id":"230c5f8520b0_132","name":"9d07","type":"ULI","href":null,"layout":null,"metadata":null,"text":"아래는 상세 옵션 img에 명시된 협박 메시지이며, 협박 메시지 상에 instuctions 은 instruction의 오타임","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_133":{"__typename":"Paragraph","id":"230c5f8520b0_133","name":"394f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"All of Your fiels are encrypted!\nFind [Random Extension]-readme.txt and follow instuctions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_134":{"__typename":"Paragraph","id":"230c5f8520b0_134","name":"6c18","type":"ULI","href":null,"layout":null,"metadata":null,"text":"실제 변경된 바탕화면","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*6k2-GLuhDZs36ZPdpBXQhQ.png":{"__typename":"ImageMetadata","id":"1*6k2-GLuhDZs36ZPdpBXQhQ.png","originalHeight":708,"originalWidth":1458,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_135":{"__typename":"Paragraph","id":"230c5f8520b0_135","name":"0890","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*6k2-GLuhDZs36ZPdpBXQhQ.png"},"text":"Compromised Background","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_136":{"__typename":"Paragraph","id":"230c5f8520b0_136","name":"105f","type":"P","href":null,"layout":null,"metadata":null,"text":"6) 상세 옵션 net 에 따른 행위 수행","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":9,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_137":{"__typename":"Paragraph","id":"230c5f8520b0_137","name":"c866","type":"OLI","href":null,"layout":null,"metadata":null,"text":"JSON 형태로 감염기기 정보 및 암호화에 사용된 정보 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_138":{"__typename":"Paragraph","id":"230c5f8520b0_138","name":"d1cb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"{\n    \"ver\": [REvil 랜섬웨어 버전],\n    \"pid\": [악성코드 식별자], (상세옵션에 명시됨)\n    \"sub\": [악성코드 식별자], (상세옵션에 명시됨)\n    \"pk\": [암호화에 사용된 공개키 정보], (상세옵션에 명시됨)\n    \"uid\": [Victim ID],\n    \"sk\": [sk_key struct(비밀키 구조체)],\n    \"unm\": [유저 명],\n    \"net\": [컴퓨터 명],\n    \"grp\": [도메인 명],\n    \"lng\": [지역 및 사용언어],\n    \"bro\": [CIS 국가 여부],\n    \"os\": [운영체제 버전],\n    \"bit\": [32bit 또는 64bit 여부],\n    \"dsk\": [디스크 별 전체 용량 및 사용 가능한 용량 정보],\n    \"ext\": [암호화 확장자]\"\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_139":{"__typename":"Paragraph","id":"230c5f8520b0_139","name":"69b0","type":"P","href":null,"layout":null,"metadata":null,"text":"2. 모든 정보를 취합한 뒤, 파일과 동일한 방식으로 데이터를 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_140":{"__typename":"Paragraph","id":"230c5f8520b0_140","name":"51d1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"데이터 암호화에는 악성코드 내에 별도로 하드코딩된 공개 key 사용","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_141":{"__typename":"Paragraph","id":"230c5f8520b0_141","name":"baa7","type":"P","href":null,"layout":null,"metadata":null,"text":"3. 암호화한 데이터를 레지스트리에 저장","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_142":{"__typename":"Paragraph","id":"230c5f8520b0_142","name":"ceeb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Path : HKLM\\SOFTWARE\\BlackLivesMatter","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_143":{"__typename":"Paragraph","id":"230c5f8520b0_143","name":"fece","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Key : XFx41h1r → value : [암호화 된 감염기기 정보 및 암호화에 사용된 정보]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_144":{"__typename":"Paragraph","id":"230c5f8520b0_144","name":"e204","type":"ULI","href":null,"layout":null,"metadata":null,"text":"HKLM 경로에 등록 실패 시 HKCU로 변경","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_145":{"__typename":"Paragraph","id":"230c5f8520b0_145","name":"e42e","type":"P","href":null,"layout":null,"metadata":null,"text":"4. 상세 옵션 중 dmn에 저장되어 있는 도메인 별로 아래 그림과 같이 특정 문자열을 조합하여 랜덤 URL 주소 생성하여 접속 시도","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":11,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":11,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*EeWJKnt3t_4G6s18mKnPLA.png":{"__typename":"ImageMetadata","id":"1*EeWJKnt3t_4G6s18mKnPLA.png","originalHeight":367,"originalWidth":1920,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_146":{"__typename":"Paragraph","id":"230c5f8520b0_146","name":"a9b9","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*EeWJKnt3t_4G6s18mKnPLA.png"},"text":"URL 주소 생성 방식","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_147":{"__typename":"Paragraph","id":"230c5f8520b0_147","name":"b71e","type":"P","href":null,"layout":null,"metadata":null,"text":"5. 도메인별로 생성된 URL주소로 수집한 감염기기 정보 목록 전송","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_148":{"__typename":"Paragraph","id":"230c5f8520b0_148","name":"e431","type":"ULI","href":null,"layout":null,"metadata":null,"text":"User-agent : Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F84.0.4147.125 Safari\u002F537.36","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_149":{"__typename":"Paragraph","id":"230c5f8520b0_149","name":"d528","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Method : POST","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_150":{"__typename":"Paragraph","id":"230c5f8520b0_150","name":"16a0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Header : Content-Type: application\u002Foctet-stream","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_151":{"__typename":"Paragraph","id":"230c5f8520b0_151","name":"599e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Header : Connection: close","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_152":{"__typename":"Paragraph","id":"230c5f8520b0_152","name":"3438","type":"P","href":null,"layout":null,"metadata":null,"text":"7) 메모리 정리","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_153":{"__typename":"Paragraph","id":"230c5f8520b0_153","name":"bd82","type":"P","href":null,"layout":null,"metadata":null,"text":"1. 감염정보 전송과 모든 파일 암호화를 마친 뒤 관련 데이터를 모두 정리","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_154":{"__typename":"Paragraph","id":"230c5f8520b0_154","name":"53ec","type":"P","href":null,"layout":null,"metadata":null,"text":"2. 상세 옵션 및 암호화에 사용된 키 정보, 감염기기 정보가 할당된 메모리를 모두 해제함","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_155":{"__typename":"Paragraph","id":"230c5f8520b0_155","name":"9aad","type":"P","href":null,"layout":null,"metadata":null,"text":"8) 파일 삭제","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_156":{"__typename":"Paragraph","id":"230c5f8520b0_156","name":"bd42","type":"OLI","href":null,"layout":null,"metadata":null,"text":"재부팅될 경우 악성코드가 삭제되도록 설정","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_157":{"__typename":"Paragraph","id":"230c5f8520b0_157","name":"05a3","type":"H4","href":null,"layout":null,"metadata":null,"text":"8. 파일 암호화 Thread","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_158":{"__typename":"Paragraph","id":"230c5f8520b0_158","name":"d8ed","type":"P","href":null,"layout":null,"metadata":null,"text":"1) Input\u002Foutput completion port (IOCP)를 이용한 암호화 작업 수행","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_159":{"__typename":"Paragraph","id":"230c5f8520b0_159","name":"1b02","type":"ULI","href":null,"layout":null,"metadata":null,"text":"REvil 랜섬웨어는 IOCP를 이용한 비동기 입출력 방식으로 빠른 암호화를 수행함","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_160":{"__typename":"Paragraph","id":"230c5f8520b0_160","name":"51f6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"감염 기기의 프로세서 갯수 * 2개의 암호화 전담 Thread 생성","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_161":{"__typename":"Paragraph","id":"230c5f8520b0_161","name":"aaae","type":"P","href":null,"layout":null,"metadata":null,"text":"2) ECIES(Elliptic Curve Integrated Encryption Scheme)를 이용한 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":9,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_162":{"__typename":"Paragraph","id":"230c5f8520b0_162","name":"d016","type":"ULI","href":null,"layout":null,"metadata":null,"text":"REvil 랜섬웨어는 ECC Diffie Hellman 키 교환 방식을 사용하여 키 교환을 시도함","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_163":{"__typename":"Paragraph","id":"230c5f8520b0_163","name":"2726","type":"ULI","href":null,"layout":null,"metadata":null,"text":"키 생성에는 Curve25519를 사용하는데, 이는 가장 빠른 곡선 중 하나로 알려짐","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_164":{"__typename":"Paragraph","id":"230c5f8520b0_164","name":"1f65","type":"ULI","href":null,"layout":null,"metadata":null,"text":"랜섬웨어 바이너리 내에 미리 포함되어 있는 pk (Attacker Key)를 이용하여 실제 파일 암호화에 사용되는 dk_key에 대한 암호화 진행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_165":{"__typename":"Paragraph","id":"230c5f8520b0_165","name":"95b8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"pk 외에 Master Key가 존재하는데, 이는 REvil 랜섬웨어의 메이저 버전마다 동일한 값을 가지며, REvil 랜섬웨어 제작자가 언제든지 파일을 복호화할 수 있는 용도로 사용됨","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*pufcgEgfDRqHNQXjuLsDWQ.png":{"__typename":"ImageMetadata","id":"1*pufcgEgfDRqHNQXjuLsDWQ.png","originalHeight":573,"originalWidth":1572,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_166":{"__typename":"Paragraph","id":"230c5f8520b0_166","name":"80e5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*pufcgEgfDRqHNQXjuLsDWQ.png"},"text":"Master key와 Attacke key를 이용한 dk_key 개별 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_167":{"__typename":"Paragraph","id":"230c5f8520b0_167","name":"3a34","type":"P","href":null,"layout":null,"metadata":null,"text":"3) 암호화 대상에서 특정 파일, 폴더 및 확장자 제외","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_168":{"__typename":"Paragraph","id":"230c5f8520b0_168","name":"901b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"운영체제와 관련되거나 중요도가 낮은 폴더를 암호화 대상에서 제외","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*JpMAfDGju0-osf3rwjE5Yg.png":{"__typename":"ImageMetadata","id":"1*JpMAfDGju0-osf3rwjE5Yg.png","originalHeight":1312,"originalWidth":4226,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_169":{"__typename":"Paragraph","id":"230c5f8520b0_169","name":"76c7","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JpMAfDGju0-osf3rwjE5Yg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_170":{"__typename":"Paragraph","id":"230c5f8520b0_170","name":"9699","type":"ULI","href":null,"layout":null,"metadata":null,"text":"부팅 또는 운영체제 관련 파일을 암호화 대상에서 제외","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*a7y0VFieYGSkEDeMWU45Bg.png":{"__typename":"ImageMetadata","id":"1*a7y0VFieYGSkEDeMWU45Bg.png","originalHeight":172,"originalWidth":1432,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_171":{"__typename":"Paragraph","id":"230c5f8520b0_171","name":"7218","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*a7y0VFieYGSkEDeMWU45Bg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_172":{"__typename":"Paragraph","id":"230c5f8520b0_172","name":"3cfa","type":"ULI","href":null,"layout":null,"metadata":null,"text":"실행 프로그램 또는 스크립트등과 같은 불필요한 확장자를 감염 대상에서 제외","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-4TYFT4z3GdhOaqfrSR4-A.png":{"__typename":"ImageMetadata","id":"1*-4TYFT4z3GdhOaqfrSR4-A.png","originalHeight":464,"originalWidth":1434,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_173":{"__typename":"Paragraph","id":"230c5f8520b0_173","name":"6505","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-4TYFT4z3GdhOaqfrSR4-A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_174":{"__typename":"Paragraph","id":"230c5f8520b0_174","name":"ae5d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"타겟 파일에 접근 중인 서비스 및 프로세스 중 아래 프로세스를 제외한 서비스와 프로세스를 모두 종료","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZLuKfBAG0ohUKkZWXeGi7w.png":{"__typename":"ImageMetadata","id":"1*ZLuKfBAG0ohUKkZWXeGi7w.png","originalHeight":160,"originalWidth":1444,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_175":{"__typename":"Paragraph","id":"230c5f8520b0_175","name":"8556","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZLuKfBAG0ohUKkZWXeGi7w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_176":{"__typename":"Paragraph","id":"230c5f8520b0_176","name":"0be8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"파일의 마지막 176byte위치의 32byte를 읽은 뒤 CRC32 checksum이 마지막 216byte위치의 4byte값과 동일한 경우, 이미 암호화가 된 파일로 판단하여 암호화 대상에서 제외","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_177":{"__typename":"Paragraph","id":"230c5f8520b0_177","name":"7e4a","type":"P","href":null,"layout":null,"metadata":null,"text":"4) 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_178":{"__typename":"Paragraph","id":"230c5f8520b0_178","name":"f089","type":"P","href":null,"layout":null,"metadata":null,"text":"상세 옵션 중 et에 따라 암호화 모드가 구분되며, 기본적으로 0x100000(1MB) 크기 단위로 파일 암호화가 이루어지고 아래와 같은 옵션에 따라 추가 암호화 크기가 정해짐","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":8,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":8,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_179":{"__typename":"Paragraph","id":"230c5f8520b0_179","name":"c950","type":"ULI","href":null,"layout":null,"metadata":null,"text":"et가 0일 때, 파일 전체 암호화","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_180":{"__typename":"Paragraph","id":"230c5f8520b0_180","name":"139f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"et가 1일 때, 파일의 상위 0x100000만 암호화","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_181":{"__typename":"Paragraph","id":"230c5f8520b0_181","name":"bfba","type":"ULI","href":null,"layout":null,"metadata":null,"text":"et가 2일 때, 파일의 상위 0x100000암호화. 이후, spize 옵션에 명시된 크기만큼 간격을 두어 0x100000씩 추가로 파일 암호화 (spsize에 주어진 크기는 MB단위)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3QMujS2Uv2SosUjlCusMVw.png":{"__typename":"ImageMetadata","id":"1*3QMujS2Uv2SosUjlCusMVw.png","originalHeight":764,"originalWidth":1920,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_182":{"__typename":"Paragraph","id":"230c5f8520b0_182","name":"36a0","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3QMujS2Uv2SosUjlCusMVw.png"},"text":"File Encryption Modes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_183":{"__typename":"Paragraph","id":"230c5f8520b0_183","name":"a6ac","type":"P","href":null,"layout":null,"metadata":null,"text":"파일 별로 4x4 key matrix를 생성하여 Salsa20 알고리즘으로 파일을 암호화하며, Salsa20에서 사용되는 key matrix 구조는 아래와 같음. REvil 랜섬웨어는 아래 Key영역에는 생성한 Shared Key의 SHA-3 해시 값을 사용하고, Nonce는 랜덤으로 생성한 8byte, Pos는 0으로 설정","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*JmWQqdiR3OupLZJY6_bYQQ.png":{"__typename":"ImageMetadata","id":"1*JmWQqdiR3OupLZJY6_bYQQ.png","originalHeight":1354,"originalWidth":2576,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_184":{"__typename":"Paragraph","id":"230c5f8520b0_184","name":"5432","type":"IMG","href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FSalsa20","layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JmWQqdiR3OupLZJY6_bYQQ.png"},"text":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FSalsa20","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":37,"href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FSalsa20","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_185":{"__typename":"Paragraph","id":"230c5f8520b0_185","name":"9a1d","type":"P","href":null,"layout":null,"metadata":null,"text":"et에 따라 파일 암호화를 마친 뒤, 암호화에 사용된 232byte의 메타데이터를 파일에 추가","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":2,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":2,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_186":{"__typename":"Paragraph","id":"230c5f8520b0_186","name":"580d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"sk_key struct : 공격자 공개키로 암호화된 비밀키 구조체","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_187":{"__typename":"Paragraph","id":"230c5f8520b0_187","name":"5996","type":"ULI","href":null,"layout":null,"metadata":null,"text":"0_key struct : 제작자 마스터키로 암호화된 비밀키 구조체","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_188":{"__typename":"Paragraph","id":"230c5f8520b0_188","name":"a773","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Meta data struct : 공개키, 암호화 모드 등이 포함된 암호화에 사용된 정보 구조체","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*v41UKPJy8htwZfFW0YVM1w.png":{"__typename":"ImageMetadata","id":"1*v41UKPJy8htwZfFW0YVM1w.png","originalHeight":810,"originalWidth":1920,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_189":{"__typename":"Paragraph","id":"230c5f8520b0_189","name":"6bfc","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*v41UKPJy8htwZfFW0YVM1w.png"},"text":"Key struct and Meta data struct","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_190":{"__typename":"Paragraph","id":"230c5f8520b0_190","name":"c2b8","type":"P","href":null,"layout":null,"metadata":null,"text":"4) 암호화 후 파일 확장자 변경","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_191":{"__typename":"Paragraph","id":"230c5f8520b0_191","name":"f9aa","type":"P","href":null,"layout":null,"metadata":null,"text":"파일의 암호화가 완료되면 원본 파일의 확장자를 기존에 생성한 랜덤 문자열로 변경","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_192":{"__typename":"Paragraph","id":"230c5f8520b0_192","name":"c9d2","type":"P","href":null,"layout":null,"metadata":null,"text":"5) 랜섬노트 생성","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_193":{"__typename":"Paragraph","id":"230c5f8520b0_193","name":"c8c1","type":"P","href":null,"layout":null,"metadata":null,"text":"1. 상세 옵션 및 기존에 생성한 랜덤 확장자를 이용하여 폴더마다 랜섬노트 생성","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_194":{"__typename":"Paragraph","id":"230c5f8520b0_194","name":"4377","type":"P","href":null,"layout":null,"metadata":null,"text":"2. nbody 옵션 : 랜섬노트 파일명 포맷 → [랜덤 확장자]-readme.txt","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":3,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":3,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_195":{"__typename":"Paragraph","id":"230c5f8520b0_195","name":"8cc3","type":"P","href":null,"layout":null,"metadata":null,"text":"3. nname 옵션 : 랜섬노트 내용 포맷","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":3,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":3,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_196":{"__typename":"Paragraph","id":"230c5f8520b0_196","name":"d742","type":"ULI","href":null,"layout":null,"metadata":null,"text":"{UID} : 감염 기기 식별 값","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_197":{"__typename":"Paragraph","id":"230c5f8520b0_197","name":"95be","type":"ULI","href":null,"layout":null,"metadata":null,"text":"{KEY} : 정보유출지로 전송한 수집된 정보의 base64 encoding 형태","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_198":{"__typename":"Paragraph","id":"230c5f8520b0_198","name":"dcdc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"{EXT} : 랜덤 확장자","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_199":{"__typename":"Paragraph","id":"230c5f8520b0_199","name":"1751","type":"P","href":null,"layout":null,"metadata":null,"text":"4. 랜섬노트 예시","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*k5N0jbWNXK9EL2mYKAiwcw.png":{"__typename":"ImageMetadata","id":"1*k5N0jbWNXK9EL2mYKAiwcw.png","originalHeight":1934,"originalWidth":3168,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_200":{"__typename":"Paragraph","id":"230c5f8520b0_200","name":"7e08","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*k5N0jbWNXK9EL2mYKAiwcw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_201":{"__typename":"Paragraph","id":"230c5f8520b0_201","name":"5cbb","type":"P","href":null,"layout":null,"metadata":null,"text":"5. 암호화 전체 과정","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IzAqp3ftCNIkzUEvn6YUrA.png":{"__typename":"ImageMetadata","id":"1*IzAqp3ftCNIkzUEvn6YUrA.png","originalHeight":1828,"originalWidth":1920,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_202":{"__typename":"Paragraph","id":"230c5f8520b0_202","name":"51eb","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IzAqp3ftCNIkzUEvn6YUrA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_203":{"__typename":"Paragraph","id":"230c5f8520b0_203","name":"86ca","type":"P","href":null,"layout":null,"metadata":null,"text":"6) 복호화 예시","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_204":{"__typename":"Paragraph","id":"230c5f8520b0_204","name":"e3c5","type":"P","href":null,"layout":null,"metadata":null,"text":"1. 공격자는 암호화된 파일로부터 sk_key struct에 있는 pk_new 추출","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_205":{"__typename":"Paragraph","id":"230c5f8520b0_205","name":"6291","type":"P","href":null,"layout":null,"metadata":null,"text":"2. 공격자가 가지고 있는 dk와 pk_new를 이용하여 shared key 생성","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_206":{"__typename":"Paragraph","id":"230c5f8520b0_206","name":"2419","type":"ULI","href":null,"layout":null,"metadata":null,"text":"이는 악성코드가 pk와 dk_new를 이용하여 생성한 shared key와 동일함","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_207":{"__typename":"Paragraph","id":"230c5f8520b0_207","name":"eae3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ECDH (Elliiptic Curve Diffie-Hellman)상 아래 수식이 성립하기 때문","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*WRmjvmWmZTHdP424IGwTUg.png":{"__typename":"ImageMetadata","id":"1*WRmjvmWmZTHdP424IGwTUg.png","originalHeight":90,"originalWidth":1310,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_208":{"__typename":"Paragraph","id":"230c5f8520b0_208","name":"f484","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*WRmjvmWmZTHdP424IGwTUg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_209":{"__typename":"Paragraph","id":"230c5f8520b0_209","name":"c3d3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"𝑑𝐴: 공격자의 private key (dk)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_210":{"__typename":"Paragraph","id":"230c5f8520b0_210","name":"5e8a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Q𝐴: 공격자의 public key (pk)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_211":{"__typename":"Paragraph","id":"230c5f8520b0_211","name":"01ef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"𝑑B: 악성코드의 private key (dk_key)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_212":{"__typename":"Paragraph","id":"230c5f8520b0_212","name":"ee75","type":"ULI","href":null,"layout":null,"metadata":null,"text":"QB: 악성코드의 public key (pk_key)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_213":{"__typename":"Paragraph","id":"230c5f8520b0_213","name":"4f07","type":"P","href":null,"layout":null,"metadata":null,"text":"3. 생성한 shared key와 sk_key struct에 있는 AES IV로 복호화하여 dk_key 추출","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_214":{"__typename":"Paragraph","id":"230c5f8520b0_214","name":"a326","type":"P","href":null,"layout":null,"metadata":null,"text":"4. 2와 동일한 방식으로 dk_key와 Meta data struct에 있는 pk_new_file로 shared key 생성","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_215":{"__typename":"Paragraph","id":"230c5f8520b0_215","name":"9585","type":"P","href":null,"layout":null,"metadata":null,"text":"5. 생성한 shared key와 Meta data struct에 있는 Salsa nonce를 이용하여 Matrix 생성 후, Salsa IV와 함께 암호화된 파일 데이터 복호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rYGI9oSynDJeuqynl7MaLA.png":{"__typename":"ImageMetadata","id":"1*rYGI9oSynDJeuqynl7MaLA.png","originalHeight":2213,"originalWidth":2600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_216":{"__typename":"Paragraph","id":"230c5f8520b0_216","name":"021c","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*rYGI9oSynDJeuqynl7MaLA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_217":{"__typename":"Paragraph","id":"230c5f8520b0_217","name":"6496","type":"H3","href":null,"layout":null,"metadata":null,"text":"공격 ATT&CK","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_218":{"__typename":"Paragraph","id":"230c5f8520b0_218","name":"02cc","type":"BQ","href":null,"layout":null,"metadata":null,"text":"출처 : Reference에 명시된 분석 블로그 내 IoC 취합","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_219":{"__typename":"Paragraph","id":"230c5f8520b0_219","name":"5064","type":"H4","href":null,"layout":null,"metadata":null,"text":"Initial Access","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_220":{"__typename":"Paragraph","id":"230c5f8520b0_220","name":"a444","type":"P","href":null,"layout":null,"metadata":null,"text":"1. 취약점을 통해 원격 명령어 실행 및 접속 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_221":{"__typename":"Paragraph","id":"230c5f8520b0_221","name":"cf96","type":"ULI","href":null,"layout":null,"metadata":null,"text":"오라클 WebLogic 취약점 (CVE-2019–2725)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_222":{"__typename":"Paragraph","id":"230c5f8520b0_222","name":"f2d2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Microsoft Exchange 서버 취약점 (정확한 CVE는 밝혀지지 않음)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_223":{"__typename":"Paragraph","id":"230c5f8520b0_223","name":"c164","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Sharepoint 취약점 (정확한 CVE는 밝혀지지 않음)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_224":{"__typename":"Paragraph","id":"230c5f8520b0_224","name":"cc82","type":"P","href":null,"layout":null,"metadata":null,"text":"2. VPN 취약점을 통한 내부 파일 탈취 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_225":{"__typename":"Paragraph","id":"230c5f8520b0_225","name":"3429","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Pulse Secure SSL VPN (CVE-2019–11510)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_226":{"__typename":"Paragraph","id":"230c5f8520b0_226","name":"7c1a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"FortiOS SSL VPN (CVE-2018–13379)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_227":{"__typename":"Paragraph","id":"230c5f8520b0_227","name":"03f3","type":"P","href":null,"layout":null,"metadata":null,"text":"3. RDP를 통한 침투","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_228":{"__typename":"Paragraph","id":"230c5f8520b0_228","name":"ec3d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"취약한 RDP 패스워드를 타겟하는 bruteforce 공격 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_229":{"__typename":"Paragraph","id":"230c5f8520b0_229","name":"888a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"원격 코드 실행이 가능한 RDP Bluegate 취약점 (CVE-2020–0609, CVE-2020–0610)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_230":{"__typename":"Paragraph","id":"230c5f8520b0_230","name":"3655","type":"P","href":null,"layout":null,"metadata":null,"text":"4. 취약한 Citrix 계정을 통한 침투","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_231":{"__typename":"Paragraph","id":"230c5f8520b0_231","name":"30b7","type":"P","href":null,"layout":null,"metadata":null,"text":"5. 스팸 메일을 통해 다운로드 기능의 악성 매크로가 포함된 XLSM 파일 유포","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_232":{"__typename":"Paragraph","id":"230c5f8520b0_232","name":"8a45","type":"ULI","href":null,"layout":null,"metadata":null,"text":"숙소 예약 사이트 (booking.com)를 위장한 피싱 메일","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_233":{"__typename":"Paragraph","id":"230c5f8520b0_233","name":"cb35","type":"ULI","href":null,"layout":null,"metadata":null,"text":"해외 배소 업체 (DHL)로 위장한 피싱 메일","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_234":{"__typename":"Paragraph","id":"230c5f8520b0_234","name":"a702","type":"ULI","href":null,"layout":null,"metadata":null,"text":"DocuSign 전자 서명 메일로 위장한 피싱 메일","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_235":{"__typename":"Paragraph","id":"230c5f8520b0_235","name":"3173","type":"P","href":null,"layout":null,"metadata":null,"text":"6. Supply chain","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_236":{"__typename":"Paragraph","id":"230c5f8520b0_236","name":"c9c8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"이탈리아의 WinRAR 설치 프로그램 공식 사이트(winrar.it)를 통해 배포","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_237":{"__typename":"Paragraph","id":"230c5f8520b0_237","name":"4467","type":"P","href":null,"layout":null,"metadata":null,"text":"7. RIG Exploit kit을 통해 배포","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_238":{"__typename":"Paragraph","id":"230c5f8520b0_238","name":"08be","type":"ULI","href":null,"layout":null,"metadata":null,"text":"RIG Exploit kit을 활용한 Malvertising 공격으로 감염 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_239":{"__typename":"Paragraph","id":"230c5f8520b0_239","name":"1b5a","type":"P","href":null,"layout":null,"metadata":null,"text":"8. MSSP 또는 MSP 업체를 장악 후, 경유하여 침투 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_240":{"__typename":"Paragraph","id":"230c5f8520b0_240","name":"765a","type":"P","href":null,"layout":null,"metadata":null,"text":"9. SEO-Poisoning 로 인해 검색엔진 상단에 노출되는 웹 사이트로부터 악성 파일 다운로드","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_241":{"__typename":"Paragraph","id":"230c5f8520b0_241","name":"956d","type":"P","href":null,"layout":null,"metadata":null,"text":"Execution","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_242":{"__typename":"Paragraph","id":"230c5f8520b0_242","name":"ed10","type":"P","href":null,"layout":null,"metadata":null,"text":"1. Powershell (.ps1) 스크립트를 이용하여 명령어 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_243":{"__typename":"Paragraph","id":"230c5f8520b0_243","name":"2946","type":"ULI","href":null,"layout":null,"metadata":null,"text":"DownloadFile 명령어를 통해 악성코드 다운로드 및 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_244":{"__typename":"Paragraph","id":"230c5f8520b0_244","name":"633b","type":"P","href":null,"layout":null,"metadata":null,"text":"2. 악성 코드를 드랍 및 실행하는 Javascript (.js) 스크립트","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_245":{"__typename":"Paragraph","id":"230c5f8520b0_245","name":"659e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"난독화 된 javascript 스크립트를 실행시켜 추가 악성코드 다운로드","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_246":{"__typename":"Paragraph","id":"230c5f8520b0_246","name":"99f0","type":"P","href":null,"layout":null,"metadata":null,"text":"3. WMI (Windows Management Instrumentation) 쿼리를 이용하여 명령어 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_247":{"__typename":"Paragraph","id":"230c5f8520b0_247","name":"798f","type":"P","href":null,"layout":null,"metadata":null,"text":"4. 배치 스크립트를 이용하여 다수의 명령어를 동시에 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_248":{"__typename":"Paragraph","id":"230c5f8520b0_248","name":"c4f8","type":"H4","href":null,"layout":null,"metadata":null,"text":"Persistence","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_249":{"__typename":"Paragraph","id":"230c5f8520b0_249","name":"c068","type":"P","href":null,"layout":null,"metadata":null,"text":"1. 클라우드 원격 데스크톱 소프트웨어 계정을 통한 지속성 유지","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_250":{"__typename":"Paragraph","id":"230c5f8520b0_250","name":"5cd6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ConnectWise Control (구 ScreenConnect)을 설치 후 지속성 유지","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_251":{"__typename":"Paragraph","id":"230c5f8520b0_251","name":"d5b5","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Cobalt Strike 비콘을 통한 지속성 유지","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_252":{"__typename":"Paragraph","id":"230c5f8520b0_252","name":"0687","type":"P","href":null,"layout":null,"metadata":null,"text":"3. VPN 취약점으로 지속성 유지","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_253":{"__typename":"Paragraph","id":"230c5f8520b0_253","name":"3527","type":"P","href":null,"layout":null,"metadata":null,"text":"4. On-premise virtual desktop appliances를 통한 지속성 유지","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_254":{"__typename":"Paragraph","id":"230c5f8520b0_254","name":"b79f","type":"P","href":null,"layout":null,"metadata":null,"text":"5. Scheduled Task를 이용하여 주기적으로 악성코드 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_255":{"__typename":"Paragraph","id":"230c5f8520b0_255","name":"bd32","type":"P","href":null,"layout":null,"metadata":null,"text":"6. 최초 침투 후 웹쉘을 삽입하여 지속성 유지","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_256":{"__typename":"Paragraph","id":"230c5f8520b0_256","name":"e2c2","type":"P","href":null,"layout":null,"metadata":null,"text":"7. REvil 랜섬웨어는 옵션에 따라 부팅 시 자동실행 되도록 레지스트리에 등록","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_257":{"__typename":"Paragraph","id":"230c5f8520b0_257","name":"b267","type":"H4","href":null,"layout":null,"metadata":null,"text":"Privilege Escalation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_258":{"__typename":"Paragraph","id":"230c5f8520b0_258","name":"4ccc","type":"P","href":null,"layout":null,"metadata":null,"text":"1. CVE-2018–8453 취약점을 이용하여 로컬 권한 상승 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_259":{"__typename":"Paragraph","id":"230c5f8520b0_259","name":"5ce9","type":"P","href":null,"layout":null,"metadata":null,"text":"2. GPO(Group Policy Preferences)내에 포함된 패스워드로 로그인하여 권한 상승","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_260":{"__typename":"Paragraph","id":"230c5f8520b0_260","name":"13d4","type":"P","href":null,"layout":null,"metadata":null,"text":"3. 내부 망에서 수집한 계정정보를 통해 권한 상승 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_261":{"__typename":"Paragraph","id":"230c5f8520b0_261","name":"0756","type":"P","href":null,"layout":null,"metadata":null,"text":"4. Metasploit의 UAC-TokenMagic 파워쉘 스크립트로 UAC 우회","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":15,"end":29,"href":"https:\u002F\u002Fgithub.com\u002FFuzzySecurity\u002FPowerShell-Suite\u002Fblob\u002Fmaster\u002FUAC-TokenMagic.ps1","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_262":{"__typename":"Paragraph","id":"230c5f8520b0_262","name":"9ff0","type":"P","href":null,"layout":null,"metadata":null,"text":"5. Invoke-SluiBypass 파워쉘 스크립트로 UAC 우회","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_263":{"__typename":"Paragraph","id":"230c5f8520b0_263","name":"c549","type":"P","href":null,"layout":null,"metadata":null,"text":"6. REvil 랜섬웨어는 SeDebugPrivilege 권한을 할당하여 타 프로세스에 접근 시도","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_264":{"__typename":"Paragraph","id":"230c5f8520b0_264","name":"7ad6","type":"H4","href":null,"layout":null,"metadata":null,"text":"Defense Evasion","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_265":{"__typename":"Paragraph","id":"230c5f8520b0_265","name":"faa4","type":"P","href":null,"layout":null,"metadata":null,"text":"1. rundll32.exe 라는 정상 프로세스를 이용하여 악성 DLL 파일 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_266":{"__typename":"Paragraph","id":"230c5f8520b0_266","name":"bdd8","type":"P","href":null,"layout":null,"metadata":null,"text":"2. BITSAdmin 이라는 정상 도구를 이용하여 내부에 랜섬웨어 배포","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_267":{"__typename":"Paragraph","id":"230c5f8520b0_267","name":"a21c","type":"P","href":null,"layout":null,"metadata":null,"text":"3. REvil 랜섬웨어는 옵션에 따라 안전모드로 재부팅하여 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_268":{"__typename":"Paragraph","id":"230c5f8520b0_268","name":"fdd1","type":"P","href":null,"layout":null,"metadata":null,"text":"4. GPO(Group Policy Preferences)를 통해 Windows Defender 및 백신 비활성화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_269":{"__typename":"Paragraph","id":"230c5f8520b0_269","name":"5aa3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"배치 스크립트 사용","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_270":{"__typename":"Paragraph","id":"230c5f8520b0_270","name":"ac8e","type":"H4","href":null,"layout":null,"metadata":null,"text":"Credential Access","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_271":{"__typename":"Paragraph","id":"230c5f8520b0_271","name":"3503","type":"P","href":null,"layout":null,"metadata":null,"text":"1. Mimikatz를 이용하여 크리덴셜 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_272":{"__typename":"Paragraph","id":"230c5f8520b0_272","name":"0882","type":"P","href":null,"layout":null,"metadata":null,"text":"2. ProcDump를 이용하여 lsass 프로세스 dump를 통해 크리덴셜 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_273":{"__typename":"Paragraph","id":"230c5f8520b0_273","name":"9a53","type":"H4","href":null,"layout":null,"metadata":null,"text":"Discovery","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_274":{"__typename":"Paragraph","id":"230c5f8520b0_274","name":"d33f","type":"P","href":null,"layout":null,"metadata":null,"text":"1. 윈도우 기본 제공 명령어를 통해 정보 탐색","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_275":{"__typename":"Paragraph","id":"230c5f8520b0_275","name":"8453","type":"ULI","href":null,"layout":null,"metadata":null,"text":"net : 네트워크 공유 및 워크스테이션 정보 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_276":{"__typename":"Paragraph","id":"230c5f8520b0_276","name":"e5f1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"nltest : 도메인 컨트롤러 및 신뢰할 수 있는 도메인 목록 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_277":{"__typename":"Paragraph","id":"230c5f8520b0_277","name":"d66e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ipconfig : 감염기기 전체 IP 정보 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_278":{"__typename":"Paragraph","id":"230c5f8520b0_278","name":"e5f0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"systeminfo : 감염기기 전체 시스템 정보 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_279":{"__typename":"Paragraph","id":"230c5f8520b0_279","name":"7c3f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ping : icmp 를 통한 포트스캔 수행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_280":{"__typename":"Paragraph","id":"230c5f8520b0_280","name":"e5e9","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Advanced Port Scanner 도구로 포트 스캐닝 수행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_281":{"__typename":"Paragraph","id":"230c5f8520b0_281","name":"c8cb","type":"P","href":null,"layout":null,"metadata":null,"text":"3. ADRecon을 이용하여 Active Directory 정보 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_282":{"__typename":"Paragraph","id":"230c5f8520b0_282","name":"ecbd","type":"P","href":null,"layout":null,"metadata":null,"text":"4. Everything을 이용하여 시스템 내 주요 파일 정보 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_283":{"__typename":"Paragraph","id":"230c5f8520b0_283","name":"e7ee","type":"P","href":null,"layout":null,"metadata":null,"text":"5. PoS Software 설치 여부 확인","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_284":{"__typename":"Paragraph","id":"230c5f8520b0_284","name":"dd67","type":"P","href":null,"layout":null,"metadata":null,"text":"6. SoftPerfect Network Scanner 도구로 내부 네트워크 스캔","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_285":{"__typename":"Paragraph","id":"230c5f8520b0_285","name":"b150","type":"P","href":null,"layout":null,"metadata":null,"text":"7. Bloodhound도구로 LDAP 쿼리를 이용하여 Active Directory정보 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_286":{"__typename":"Paragraph","id":"230c5f8520b0_286","name":"53db","type":"P","href":null,"layout":null,"metadata":null,"text":"8. ADfind 도구로 Active Directory 정보 수집","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_287":{"__typename":"Paragraph","id":"230c5f8520b0_287","name":"58da","type":"H4","href":null,"layout":null,"metadata":null,"text":"Lateral Movement","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_288":{"__typename":"Paragraph","id":"230c5f8520b0_288","name":"4974","type":"P","href":null,"layout":null,"metadata":null,"text":"1. Scheduled Task: 예약된 작업을 통해 측면 이동 수행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_289":{"__typename":"Paragraph","id":"230c5f8520b0_289","name":"3987","type":"P","href":null,"layout":null,"metadata":null,"text":"2. PsExec: 내부 대역에 악성코드 복사 후 원격으로 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_290":{"__typename":"Paragraph","id":"230c5f8520b0_290","name":"f945","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Admin share: 네트워크 공유 기능으로 파일 복사 후 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_291":{"__typename":"Paragraph","id":"230c5f8520b0_291","name":"367c","type":"P","href":null,"layout":null,"metadata":null,"text":"5. WMIExec: WMI 명령어를 통해 내부 대역에 악성코드 복사 후 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_292":{"__typename":"Paragraph","id":"230c5f8520b0_292","name":"aa51","type":"P","href":null,"layout":null,"metadata":null,"text":"6. CrackMapExec 도구로 측면 이동 수행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_293":{"__typename":"Paragraph","id":"230c5f8520b0_293","name":"50ef","type":"P","href":null,"layout":null,"metadata":null,"text":"7. RDP 계정을 수집하여 측면 이동 수행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_294":{"__typename":"Paragraph","id":"230c5f8520b0_294","name":"c08d","type":"P","href":null,"layout":null,"metadata":null,"text":"8. Cobalt Strike 기능으로 SMB를 통한 원격 서비스를 생성하여 측면 이동 수행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_295":{"__typename":"Paragraph","id":"230c5f8520b0_295","name":"459c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Command and Control","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_296":{"__typename":"Paragraph","id":"230c5f8520b0_296","name":"8c81","type":"P","href":null,"layout":null,"metadata":null,"text":"1. Cobalt Strike 비콘을 통한 감염기기 원격제어 수행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_297":{"__typename":"Paragraph","id":"230c5f8520b0_297","name":"5578","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Gootkit, Qbot, IcedId 와 같은 유명한 악성코드를 통해 원격제어 명령 및 랜섬웨어 다운로드","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_298":{"__typename":"Paragraph","id":"230c5f8520b0_298","name":"81e7","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Wget을 통해 추가 악성코드 다운로드","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_299":{"__typename":"Paragraph","id":"230c5f8520b0_299","name":"bca0","type":"P","href":null,"layout":null,"metadata":null,"text":"4. 파워쉘 스크립트로 pastebin의 특정 파일을 읽어와 디코딩 후 실행","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_300":{"__typename":"Paragraph","id":"230c5f8520b0_300","name":"e03a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Exfiltration","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_301":{"__typename":"Paragraph","id":"230c5f8520b0_301","name":"43d4","type":"P","href":null,"layout":null,"metadata":null,"text":"1. Rclone도구를 이용하여 공격자의 원격 서버로 파일 복사","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_302":{"__typename":"Paragraph","id":"230c5f8520b0_302","name":"00e2","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Mega 클라우드를 이용하여 탈취한 데이터 저장","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_303":{"__typename":"Paragraph","id":"230c5f8520b0_303","name":"49c4","type":"H4","href":null,"layout":null,"metadata":null,"text":"Impacts","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_304":{"__typename":"Paragraph","id":"230c5f8520b0_304","name":"4da2","type":"P","href":null,"layout":null,"metadata":null,"text":"1. 주요 파일 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_305":{"__typename":"Paragraph","id":"230c5f8520b0_305","name":"1606","type":"P","href":null,"layout":null,"metadata":null,"text":"2. 주요 백업 및 안티 바이러스 서비스 중지","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_306":{"__typename":"Paragraph","id":"230c5f8520b0_306","name":"3f68","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Volume Shadow Copy 삭제","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_307":{"__typename":"Paragraph","id":"230c5f8520b0_307","name":"2f26","type":"P","href":null,"layout":null,"metadata":null,"text":"4. VM Snapshot 삭제","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_308":{"__typename":"Paragraph","id":"230c5f8520b0_308","name":"7f9b","type":"P","href":null,"layout":null,"metadata":null,"text":"5. File backup 삭제","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_309":{"__typename":"Paragraph","id":"230c5f8520b0_309","name":"7ca8","type":"P","href":null,"layout":null,"metadata":null,"text":"6. 중요한 문서 삭제","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_310":{"__typename":"Paragraph","id":"230c5f8520b0_310","name":"fe81","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_311":{"__typename":"Paragraph","id":"230c5f8520b0_311","name":"f853","type":"P","href":null,"layout":null,"metadata":null,"text":"REvil 랜섬웨어는 2019년 4월에 최초 등장한 이후, 약 2년이 넘는 시간 동안 다크웹 내 RaaS(Ransomware as a Service) 시장에서 최정상의 자리를 지키고 있다. 지속적인 버전 업데이트, 다양한 기능 및 상세 옵션을 통한 쉬운 커스터마이징이 가능하기 때문이다. 다수의 구매자들 (또는 Operator)에 의해 개인부터 JBS와 같은 대형 기업 공격에까지 REvil 랜섬웨어를 이용한 광범위한 공격이 이루어지고 있다.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_312":{"__typename":"Paragraph","id":"230c5f8520b0_312","name":"03b2","type":"P","href":null,"layout":null,"metadata":null,"text":"REvil로부터 파생된 조직들이 계속 생겨나고, 인터뷰를 통해 앞으로 더욱 더 적극적으로 공격할 것임을 밝히기도 했다. REvil은 몸값을 받아내기 위해 기업 정보 유출, DDoS, 파트너사 협박 등과 같은 전략을 취하고 있기 때문에 실제로 감염될 경우, 기업 내 큰 타격을 입을 수 있다.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_313":{"__typename":"Paragraph","id":"230c5f8520b0_313","name":"382f","type":"P","href":null,"layout":null,"metadata":null,"text":"랜섬웨어의 코드는 2년 동안 크게 바뀌지 않았지만, 이를 사용하는 공격자들이 많은 만큼 매우 다양한 최초 침투 경로, 공격 도구로 배포되고 있다. 그렇기 때문에 랜섬웨어 자체에 대해서만 대응하는 것이 아닌, 전체적인 공격 시나리오를 이해하고 자신 또는 기업의 취약한 부분을 확인하여 점검 및 보완할 수 있어야 한다.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_314":{"__typename":"Paragraph","id":"230c5f8520b0_314","name":"73b3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Reference","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_315":{"__typename":"Paragraph","id":"230c5f8520b0_315","name":"eec6","type":"P","href":null,"layout":null,"metadata":null,"text":"1. https:\u002F\u002Fblog.talosintelligence.com\u002F2019\u002F04\u002Fsodinokibi-ransomware-exploits-weblogic.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":3,"end":90,"href":"https:\u002F\u002Fblog.talosintelligence.com\u002F2019\u002F04\u002Fsodinokibi-ransomware-exploits-weblogic.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_316":{"__typename":"Paragraph","id":"230c5f8520b0_316","name":"a5c6","type":"P","href":null,"layout":null,"metadata":null,"text":"2. https:\u002F\u002Fsymantec-enterprise-blogs.security.com\u002Fblogs\u002Fthreat-intelligence\u002Fsodinokibi-ransomware-cobalt-strike-pos","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":3,"end":115,"href":"https:\u002F\u002Fsymantec-enterprise-blogs.security.com\u002Fblogs\u002Fthreat-intelligence\u002Fsodinokibi-ransomware-cobalt-strike-pos","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_317":{"__typename":"Paragraph","id":"230c5f8520b0_317","name":"8517","type":"P","href":null,"layout":null,"metadata":null,"text":"3. https:\u002F\u002Fblog.amossys.fr\u002Fsodinokibi-malware-analysis.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":3,"end":59,"href":"https:\u002F\u002Fblog.amossys.fr\u002Fsodinokibi-malware-analysis.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_318":{"__typename":"Paragraph","id":"230c5f8520b0_318","name":"d959","type":"P","href":null,"layout":null,"metadata":null,"text":"4. https:\u002F\u002Fwww.tgsoft.it\u002Fimmagini\u002Fnews\u002F20190705Sodinokibi\u002FSodinokibi_eng.pdf","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":3,"end":76,"href":"https:\u002F\u002Fwww.tgsoft.it\u002Fimmagini\u002Fnews\u002F20190705Sodinokibi\u002FSodinokibi_eng.pdf","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_319":{"__typename":"Paragraph","id":"230c5f8520b0_319","name":"0398","type":"P","href":null,"layout":null,"metadata":null,"text":"5. https:\u002F\u002Fi.blackhat.com\u002Feu-20\u002FWednesday\u002Feu-20-Clarke-Its-Not-FINished-The-Evolving-Maturity-In-Ransomware-Operations.pdf","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":3,"end":122,"href":"https:\u002F\u002Fi.blackhat.com\u002Feu-20\u002FWednesday\u002Feu-20-Clarke-Its-Not-FINished-The-Evolving-Maturity-In-Ransomware-Operations.pdf","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_320":{"__typename":"Paragraph","id":"230c5f8520b0_320","name":"c0d3","type":"P","href":null,"layout":null,"metadata":null,"text":"6. https:\u002F\u002Fblog.malwarebytes.com\u002Fthreat-analysis\u002F2020\u002F11\u002Fgerman-users-targeted-with-gootkit-banker-or-revil-ransomware\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":3,"end":119,"href":"https:\u002F\u002Fblog.malwarebytes.com\u002Fthreat-analysis\u002F2020\u002F11\u002Fgerman-users-targeted-with-gootkit-banker-or-revil-ransomware\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_321":{"__typename":"Paragraph","id":"230c5f8520b0_321","name":"dbf8","type":"P","href":null,"layout":null,"metadata":null,"text":"7. https:\u002F\u002Fasec.ahnlab.com\u002Fko\u002F19640\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":3,"end":36,"href":"https:\u002F\u002Fasec.ahnlab.com\u002Fko\u002F19640\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_322":{"__typename":"Paragraph","id":"230c5f8520b0_322","name":"dce1","type":"P","href":null,"layout":null,"metadata":null,"text":"8. https:\u002F\u002Fthedfirreport.com\u002F2021\u002F03\u002F29\u002Fsodinokibi-aka-revil-ransomware\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":3,"end":72,"href":"https:\u002F\u002Fthedfirreport.com\u002F2021\u002F03\u002F29\u002Fsodinokibi-aka-revil-ransomware\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_323":{"__typename":"Paragraph","id":"230c5f8520b0_323","name":"d2a3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Appendix","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_324":{"__typename":"Paragraph","id":"230c5f8520b0_324","name":"7ca1","type":"H4","href":null,"layout":null,"metadata":null,"text":"Appendix #1 : REvil 랜섬웨어 탐지 야라 룰","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_325":{"__typename":"Paragraph","id":"230c5f8520b0_325","name":"73e9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"rule REvil_Ransomware_V2_5\n{\n    meta:\n        description = \"REvil ransomware v2.05 detection rule\"\n        author = \"S2WLAB TALON\"\n        date = \"2021-06-23\"\n        version = \"1.0\"\n    strings:\n        $pattern1 = \"ERR0R D0UBLE RUN!\" ascii wide nocase\n        $pattern2 = \"vmcompute.exe\" ascii wide nocase\n        $pattern3 = \"vmms.exe\" ascii wide nocase\n        $pattern4 = \"vmwp.exe\" ascii wide nocase\n        $pattern5 = \"svchost.exe\" ascii wide nocase\n        $pattern6 = \"DTrump4ever\" ascii wide nocase\n        $pattern7 = \"expand 32-byte k\" ascii wide nocase\n        $pattern8 = \"expand 16-byte k\" ascii wide nocase\n        $pattern9 = \"__ProviderArchitecture\" ascii wide nocase\n        $code1 = {83 EC 10 B9 5B 04 00 00 53 56 8B 75 08 [0-8] C1 E6 10 33 75 08 81 F6 ?? ?? ?? ?? 8B C6 C1 E8 15 57}\n        $code2 = {8B 55 08 40 0F B6 C8 8B 45 08 89 4D 10 8B 5D 10 8A 0C 01 0F B6 C1 03 C6 0F B6 F0 8B 45 08 8A 04 06 88 04 13 8B C2 8B D3 8B 5D 14 88 0C 06 0F B6 04 02 8B 55 0C 0F B6 C9 03 C8 0F B6 C1 8B 4D 08 8A 04 08 32 04 1A 88 03 43 8B 45 10 89 5D 14 83 EF 01 75} \u002F\u002F rc4\n    condition:\n        ( 8 of ($pattern*) and $code1 ) or\n        ( 8 of ($pattern*) and $code2 )\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_326":{"__typename":"Paragraph","id":"230c5f8520b0_326","name":"335b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"rule REvil_Ransomware_V1_6\n{\n    meta:\n        description = \"REvil ransomware v1.06 detection rule\"\n        author = \"S2WLAB TALON hypen\"\n        date = \"2021-06-23\"\n        version = \"1.0\"\n    strings:\n        $pattern1 = \"ServicesActive\" ascii wide nocase\n        $pattern2 = \"expand 32-byte k\" ascii wide nocase\n        $pattern3 = \"expand 16-byte k\" ascii wide nocase\n        $code1 = {11 f8 90 45 3a 1d d0 11 89 1f 00 aa 00 4b 2e 24 28 20 bd 49 23 15 d1 11 ad 79 00 c0 4f d8 fd ff 87 a6 12 dc 7f 73 cf 11 88 4d 00 aa 00     4b 2e     24} \u002F\u002F rscid\n        $code2 = {8B 55 08 40 0F B6 C8 8B 45 08 89 4D 10 8B 5D 10 8A 0C 01 0F B6 C1 03 C6 0F B6 F0 8B 45 08 8A 04 06 88 04 13 8B C2 8B D3 8B 5D 14 88 0C 06 0F     B6 04 02 8B 55 0C 0F B6 C9 03 C8 0F B6 C1 8B 4D 08 8A 04 08 32 04 1A 88 03 43 8B 45 10 89 5D 14 83 EF 01 75} \u002F\u002F rc4\n    condition:\n        all of them\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_327":{"__typename":"Paragraph","id":"230c5f8520b0_327","name":"88cb","type":"H4","href":null,"layout":null,"metadata":null,"text":"Appendix #2 : Sigma rule","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_328":{"__typename":"Paragraph","id":"230c5f8520b0_328","name":"9e7b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"출처 : https:\u002F\u002Fthedfirreport.com\u002F2021\u002F03\u002F29\u002Fsodinokibi-aka-revil-ransomware\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":5,"end":74,"href":"https:\u002F\u002Fthedfirreport.com\u002F2021\u002F03\u002F29\u002Fsodinokibi-aka-revil-ransomware\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_329":{"__typename":"Paragraph","id":"230c5f8520b0_329","name":"7943","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgithub.com\u002FNeo23x0\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_susp_powershell_enc_cmd.yml","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":107,"href":"https:\u002F\u002Fgithub.com\u002FNeo23x0\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_susp_powershell_enc_cmd.yml","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_330":{"__typename":"Paragraph","id":"230c5f8520b0_330","name":"879a","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgithub.com\u002FNeo23x0\u002Fsigma\u002Fblob\u002F084cd39505861188d9d8f2d5c0f2835e4f750a3f\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_malware_trickbot_recon_activity.yml","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":149,"href":"https:\u002F\u002Fgithub.com\u002FNeo23x0\u002Fsigma\u002Fblob\u002F084cd39505861188d9d8f2d5c0f2835e4f750a3f\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_malware_trickbot_recon_activity.yml","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_331":{"__typename":"Paragraph","id":"230c5f8520b0_331","name":"6f72","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgithub.com\u002FNeo23x0\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_susp_commands_recon_activity.yml","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":112,"href":"https:\u002F\u002Fgithub.com\u002FNeo23x0\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_susp_commands_recon_activity.yml","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_332":{"__typename":"Paragraph","id":"230c5f8520b0_332","name":"95f2","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fnetwork_connection\u002Fsysmon_rundll32_net_connections.yml","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":113,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fnetwork_connection\u002Fsysmon_rundll32_net_connections.yml","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_333":{"__typename":"Paragraph","id":"230c5f8520b0_333","name":"4c6f","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_process_creation_bitsadmin_download.yml","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":119,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_process_creation_bitsadmin_download.yml","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_334":{"__typename":"Paragraph","id":"230c5f8520b0_334","name":"b661","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_susp_adfind.yml","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":95,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_susp_adfind.yml","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_335":{"__typename":"Paragraph","id":"230c5f8520b0_335","name":"6093","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_susp_wmi_execution.yml","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":102,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_susp_wmi_execution.yml","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_336":{"__typename":"Paragraph","id":"230c5f8520b0_336","name":"ad9c","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fa08571be9107d1c0e216400ffbb89c394fcd2570\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_office_shell.yml","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":130,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fa08571be9107d1c0e216400ffbb89c394fcd2570\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fwin_office_shell.yml","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_337":{"__typename":"Paragraph","id":"230c5f8520b0_337","name":"04c3","type":"H4","href":null,"layout":null,"metadata":null,"text":"Appendix #3 : IoC","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_338":{"__typename":"Paragraph","id":"230c5f8520b0_338","name":"cca8","type":"P","href":null,"layout":null,"metadata":null,"text":"Click the below image then redirect to google spreadsheet","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_339":{"__typename":"Paragraph","id":"230c5f8520b0_339","name":"1fc1","type":"BQ","href":null,"layout":null,"metadata":null,"text":"출처 : Reference에 명시된 분석 블로그 내 IoC 취합","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7te_iRyIDNKSxUUWqI_mng.png":{"__typename":"ImageMetadata","id":"1*7te_iRyIDNKSxUUWqI_mng.png","originalHeight":1432,"originalWidth":1954,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_340":{"__typename":"Paragraph","id":"230c5f8520b0_340","name":"8bf0","type":"IMG","href":"https:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F1cssKIwZP0E1xv0YD1xx5GiEqb7e1I2Klt2nZm0A9FXk\u002Fedit?usp=sharing","layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*7te_iRyIDNKSxUUWqI_mng.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_341":{"__typename":"Paragraph","id":"230c5f8520b0_341","name":"1eb5","type":"H4","href":null,"layout":null,"metadata":null,"text":"Appendix #4 : REvil 협상 사이트 페이지 (최초 Key 입력 및 캡차 유도)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*BlqLh-gyypMlSPIcj0kZBg.png":{"__typename":"ImageMetadata","id":"1*BlqLh-gyypMlSPIcj0kZBg.png","originalHeight":1238,"originalWidth":1062,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_342":{"__typename":"Paragraph","id":"230c5f8520b0_342","name":"90ba","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*BlqLh-gyypMlSPIcj0kZBg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*s3vX43JuqF2cWhtM53NxTQ.png":{"__typename":"ImageMetadata","id":"1*s3vX43JuqF2cWhtM53NxTQ.png","originalHeight":1326,"originalWidth":1394,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:230c5f8520b0_343":{"__typename":"Paragraph","id":"230c5f8520b0_343","name":"6f0c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*s3vX43JuqF2cWhtM53NxTQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_344":{"__typename":"Paragraph","id":"230c5f8520b0_344","name":"479b","type":"H4","href":null,"layout":null,"metadata":null,"text":"Appendix #5 : v2.05와 v2.07 비교","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_345":{"__typename":"Paragraph","id":"230c5f8520b0_345","name":"82dc","type":"BQ","href":null,"layout":null,"metadata":null,"text":"현재까지 발견된 REvil 랜섬웨어의 가장 최신 버전은 2.07로 확인됨","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_346":{"__typename":"Paragraph","id":"230c5f8520b0_346","name":"6e81","type":"OLI","href":null,"layout":null,"metadata":null,"text":"로컬 드라이브 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_347":{"__typename":"Paragraph","id":"230c5f8520b0_347","name":"f45c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"2.07 버전에서는 로컬 드라이브 암호화 시, 드라이브 타입이 DRIVE_FIXED(일반 디스크)일 경우, NetShareAdd 함수로 로컬 공유 시작","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_348":{"__typename":"Paragraph","id":"230c5f8520b0_348","name":"1088","type":"ULI","href":null,"layout":null,"metadata":null,"text":"NetShareAdd 함수를 이용한 감염 단말 리소스 공유시 사용되는 comment (SHARE_INFO_2 구조체 내 shi2_remark 멤버 변수) 문자열 : “Share added by R”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_349":{"__typename":"Paragraph","id":"230c5f8520b0_349","name":"d19c","type":"P","href":null,"layout":null,"metadata":null,"text":"2. 네트워크 드라이브 암호화","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_350":{"__typename":"Paragraph","id":"230c5f8520b0_350","name":"788b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"2.07 버전에서는 네트워크 드라이브 암호화 함수를 Thread로 생성하지 않음","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_351":{"__typename":"Paragraph","id":"230c5f8520b0_351","name":"7693","type":"ULI","href":null,"layout":null,"metadata":null,"text":"기존에는 explorer.exe의 토큰을 impersonate하여 네트워크 공유 탐색 권한을 획득하였는데, 2.07 버전에서는 이에 더해 현재 Thread를 제외한 현재 프로세스 내 모든 Thread에 동일한 토큰 적용","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:230c5f8520b0_352":{"__typename":"Paragraph","id":"230c5f8520b0_352","name":"3315","type":"ULI","href":null,"layout":null,"metadata":null,"text":"이후 복제된 토큰으로 네트워크 드라이브 암호화를 시도하고, RevertToSelf로 impersonate 종료 후에 한번 더 네트워크 드라이브 암호화를 시도함","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:30a8766b5c42-viewerId:lo_8149ad905322":{"__typename":"CollectionViewerEdge","id":"collectionId:30a8766b5c42-viewerId:lo_8149ad905322","isEditor":false,"isMuting":false},"ImageMetadata:1*dAAOzI0wCWzr0K3RGg2Pzw.png":{"__typename":"ImageMetadata","id":"1*dAAOzI0wCWzr0K3RGg2Pzw.png","originalWidth":500,"originalHeight":500},"PostViewerEdge:postId:d1899c0e9317-viewerId:lo_8149ad905322":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:d1899c0e9317-viewerId:lo_8149ad905322"},"Tag:intelligence":{"__typename":"Tag","id":"intelligence","displayTitle":"Intelligence","normalizedTagSlug":"intelligence"},"Tag:ransomware":{"__typename":"Tag","id":"ransomware","displayTitle":"Ransomware","normalizedTagSlug":"ransomware"},"Tag:revil":{"__typename":"Tag","id":"revil","displayTitle":"Revil","normalizedTagSlug":"revil"},"Tag:darkweb":{"__typename":"Tag","id":"darkweb","displayTitle":"Darkweb","normalizedTagSlug":"darkweb"},"Tag:cybercrime":{"__typename":"Tag","id":"cybercrime","displayTitle":"Cybercrime","normalizedTagSlug":"cybercrime"},"Post:d1899c0e9317":{"__typename":"Post","id":"d1899c0e9317","collection":{"__ref":"Collection:30a8766b5c42"},"content({\"postMeteringOptions\":{\"referrer\":\"\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"00e0","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"940d","startIndex":21,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"c96c","startIndex":217,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"7e58","startIndex":310,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"50d9","startIndex":314,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:230c5f8520b0_0"},{"__ref":"Paragraph:230c5f8520b0_1"},{"__ref":"Paragraph:230c5f8520b0_2"},{"__ref":"Paragraph:230c5f8520b0_3"},{"__ref":"Paragraph:230c5f8520b0_4"},{"__ref":"Paragraph:230c5f8520b0_5"},{"__ref":"Paragraph:230c5f8520b0_6"},{"__ref":"Paragraph:230c5f8520b0_7"},{"__ref":"Paragraph:230c5f8520b0_8"},{"__ref":"Paragraph:230c5f8520b0_9"},{"__ref":"Paragraph:230c5f8520b0_10"},{"__ref":"Paragraph:230c5f8520b0_11"},{"__ref":"Paragraph:230c5f8520b0_12"},{"__ref":"Paragraph:230c5f8520b0_13"},{"__ref":"Paragraph:230c5f8520b0_14"},{"__ref":"Paragraph:230c5f8520b0_15"},{"__ref":"Paragraph:230c5f8520b0_16"},{"__ref":"Paragraph:230c5f8520b0_17"},{"__ref":"Paragraph:230c5f8520b0_18"},{"__ref":"Paragraph:230c5f8520b0_19"},{"__ref":"Paragraph:230c5f8520b0_20"},{"__ref":"Paragraph:230c5f8520b0_21"},{"__ref":"Paragraph:230c5f8520b0_22"},{"__ref":"Paragraph:230c5f8520b0_23"},{"__ref":"Paragraph:230c5f8520b0_24"},{"__ref":"Paragraph:230c5f8520b0_25"},{"__ref":"Paragraph:230c5f8520b0_26"},{"__ref":"Paragraph:230c5f8520b0_27"},{"__ref":"Paragraph:230c5f8520b0_28"},{"__ref":"Paragraph:230c5f8520b0_29"},{"__ref":"Paragraph:230c5f8520b0_30"},{"__ref":"Paragraph:230c5f8520b0_31"},{"__ref":"Paragraph:230c5f8520b0_32"},{"__ref":"Paragraph:230c5f8520b0_33"},{"__ref":"Paragraph:230c5f8520b0_34"},{"__ref":"Paragraph:230c5f8520b0_35"},{"__ref":"Paragraph:230c5f8520b0_36"},{"__ref":"Paragraph:230c5f8520b0_37"},{"__ref":"Paragraph:230c5f8520b0_38"},{"__ref":"Paragraph:230c5f8520b0_39"},{"__ref":"Paragraph:230c5f8520b0_40"},{"__ref":"Paragraph:230c5f8520b0_41"},{"__ref":"Paragraph:230c5f8520b0_42"},{"__ref":"Paragraph:230c5f8520b0_43"},{"__ref":"Paragraph:230c5f8520b0_44"},{"__ref":"Paragraph:230c5f8520b0_45"},{"__ref":"Paragraph:230c5f8520b0_46"},{"__ref":"Paragraph:230c5f8520b0_47"},{"__ref":"Paragraph:230c5f8520b0_48"},{"__ref":"Paragraph:230c5f8520b0_49"},{"__ref":"Paragraph:230c5f8520b0_50"},{"__ref":"Paragraph:230c5f8520b0_51"},{"__ref":"Paragraph:230c5f8520b0_52"},{"__ref":"Paragraph:230c5f8520b0_53"},{"__ref":"Paragraph:230c5f8520b0_54"},{"__ref":"Paragraph:230c5f8520b0_55"},{"__ref":"Paragraph:230c5f8520b0_56"},{"__ref":"Paragraph:230c5f8520b0_57"},{"__ref":"Paragraph:230c5f8520b0_58"},{"__ref":"Paragraph:230c5f8520b0_59"},{"__ref":"Paragraph:230c5f8520b0_60"},{"__ref":"Paragraph:230c5f8520b0_61"},{"__ref":"Paragraph:230c5f8520b0_62"},{"__ref":"Paragraph:230c5f8520b0_63"},{"__ref":"Paragraph:230c5f8520b0_64"},{"__ref":"Paragraph:230c5f8520b0_65"},{"__ref":"Paragraph:230c5f8520b0_66"},{"__ref":"Paragraph:230c5f8520b0_67"},{"__ref":"Paragraph:230c5f8520b0_68"},{"__ref":"Paragraph:230c5f8520b0_69"},{"__ref":"Paragraph:230c5f8520b0_70"},{"__ref":"Paragraph:230c5f8520b0_71"},{"__ref":"Paragraph:230c5f8520b0_72"},{"__ref":"Paragraph:230c5f8520b0_73"},{"__ref":"Paragraph:230c5f8520b0_74"},{"__ref":"Paragraph:230c5f8520b0_75"},{"__ref":"Paragraph:230c5f8520b0_76"},{"__ref":"Paragraph:230c5f8520b0_77"},{"__ref":"Paragraph:230c5f8520b0_78"},{"__ref":"Paragraph:230c5f8520b0_79"},{"__ref":"Paragraph:230c5f8520b0_80"},{"__ref":"Paragraph:230c5f8520b0_81"},{"__ref":"Paragraph:230c5f8520b0_82"},{"__ref":"Paragraph:230c5f8520b0_83"},{"__ref":"Paragraph:230c5f8520b0_84"},{"__ref":"Paragraph:230c5f8520b0_85"},{"__ref":"Paragraph:230c5f8520b0_86"},{"__ref":"Paragraph:230c5f8520b0_87"},{"__ref":"Paragraph:230c5f8520b0_88"},{"__ref":"Paragraph:230c5f8520b0_89"},{"__ref":"Paragraph:230c5f8520b0_90"},{"__ref":"Paragraph:230c5f8520b0_91"},{"__ref":"Paragraph:230c5f8520b0_92"},{"__ref":"Paragraph:230c5f8520b0_93"},{"__ref":"Paragraph:230c5f8520b0_94"},{"__ref":"Paragraph:230c5f8520b0_95"},{"__ref":"Paragraph:230c5f8520b0_96"},{"__ref":"Paragraph:230c5f8520b0_97"},{"__ref":"Paragraph:230c5f8520b0_98"},{"__ref":"Paragraph:230c5f8520b0_99"},{"__ref":"Paragraph:230c5f8520b0_100"},{"__ref":"Paragraph:230c5f8520b0_101"},{"__ref":"Paragraph:230c5f8520b0_102"},{"__ref":"Paragraph:230c5f8520b0_103"},{"__ref":"Paragraph:230c5f8520b0_104"},{"__ref":"Paragraph:230c5f8520b0_105"},{"__ref":"Paragraph:230c5f8520b0_106"},{"__ref":"Paragraph:230c5f8520b0_107"},{"__ref":"Paragraph:230c5f8520b0_108"},{"__ref":"Paragraph:230c5f8520b0_109"},{"__ref":"Paragraph:230c5f8520b0_110"},{"__ref":"Paragraph:230c5f8520b0_111"},{"__ref":"Paragraph:230c5f8520b0_112"},{"__ref":"Paragraph:230c5f8520b0_113"},{"__ref":"Paragraph:230c5f8520b0_114"},{"__ref":"Paragraph:230c5f8520b0_115"},{"__ref":"Paragraph:230c5f8520b0_116"},{"__ref":"Paragraph:230c5f8520b0_117"},{"__ref":"Paragraph:230c5f8520b0_118"},{"__ref":"Paragraph:230c5f8520b0_119"},{"__ref":"Paragraph:230c5f8520b0_120"},{"__ref":"Paragraph:230c5f8520b0_121"},{"__ref":"Paragraph:230c5f8520b0_122"},{"__ref":"Paragraph:230c5f8520b0_123"},{"__ref":"Paragraph:230c5f8520b0_124"},{"__ref":"Paragraph:230c5f8520b0_125"},{"__ref":"Paragraph:230c5f8520b0_126"},{"__ref":"Paragraph:230c5f8520b0_127"},{"__ref":"Paragraph:230c5f8520b0_128"},{"__ref":"Paragraph:230c5f8520b0_129"},{"__ref":"Paragraph:230c5f8520b0_130"},{"__ref":"Paragraph:230c5f8520b0_131"},{"__ref":"Paragraph:230c5f8520b0_132"},{"__ref":"Paragraph:230c5f8520b0_133"},{"__ref":"Paragraph:230c5f8520b0_134"},{"__ref":"Paragraph:230c5f8520b0_135"},{"__ref":"Paragraph:230c5f8520b0_136"},{"__ref":"Paragraph:230c5f8520b0_137"},{"__ref":"Paragraph:230c5f8520b0_138"},{"__ref":"Paragraph:230c5f8520b0_139"},{"__ref":"Paragraph:230c5f8520b0_140"},{"__ref":"Paragraph:230c5f8520b0_141"},{"__ref":"Paragraph:230c5f8520b0_142"},{"__ref":"Paragraph:230c5f8520b0_143"},{"__ref":"Paragraph:230c5f8520b0_144"},{"__ref":"Paragraph:230c5f8520b0_145"},{"__ref":"Paragraph:230c5f8520b0_146"},{"__ref":"Paragraph:230c5f8520b0_147"},{"__ref":"Paragraph:230c5f8520b0_148"},{"__ref":"Paragraph:230c5f8520b0_149"},{"__ref":"Paragraph:230c5f8520b0_150"},{"__ref":"Paragraph:230c5f8520b0_151"},{"__ref":"Paragraph:230c5f8520b0_152"},{"__ref":"Paragraph:230c5f8520b0_153"},{"__ref":"Paragraph:230c5f8520b0_154"},{"__ref":"Paragraph:230c5f8520b0_155"},{"__ref":"Paragraph:230c5f8520b0_156"},{"__ref":"Paragraph:230c5f8520b0_157"},{"__ref":"Paragraph:230c5f8520b0_158"},{"__ref":"Paragraph:230c5f8520b0_159"},{"__ref":"Paragraph:230c5f8520b0_160"},{"__ref":"Paragraph:230c5f8520b0_161"},{"__ref":"Paragraph:230c5f8520b0_162"},{"__ref":"Paragraph:230c5f8520b0_163"},{"__ref":"Paragraph:230c5f8520b0_164"},{"__ref":"Paragraph:230c5f8520b0_165"},{"__ref":"Paragraph:230c5f8520b0_166"},{"__ref":"Paragraph:230c5f8520b0_167"},{"__ref":"Paragraph:230c5f8520b0_168"},{"__ref":"Paragraph:230c5f8520b0_169"},{"__ref":"Paragraph:230c5f8520b0_170"},{"__ref":"Paragraph:230c5f8520b0_171"},{"__ref":"Paragraph:230c5f8520b0_172"},{"__ref":"Paragraph:230c5f8520b0_173"},{"__ref":"Paragraph:230c5f8520b0_174"},{"__ref":"Paragraph:230c5f8520b0_175"},{"__ref":"Paragraph:230c5f8520b0_176"},{"__ref":"Paragraph:230c5f8520b0_177"},{"__ref":"Paragraph:230c5f8520b0_178"},{"__ref":"Paragraph:230c5f8520b0_179"},{"__ref":"Paragraph:230c5f8520b0_180"},{"__ref":"Paragraph:230c5f8520b0_181"},{"__ref":"Paragraph:230c5f8520b0_182"},{"__ref":"Paragraph:230c5f8520b0_183"},{"__ref":"Paragraph:230c5f8520b0_184"},{"__ref":"Paragraph:230c5f8520b0_185"},{"__ref":"Paragraph:230c5f8520b0_186"},{"__ref":"Paragraph:230c5f8520b0_187"},{"__ref":"Paragraph:230c5f8520b0_188"},{"__ref":"Paragraph:230c5f8520b0_189"},{"__ref":"Paragraph:230c5f8520b0_190"},{"__ref":"Paragraph:230c5f8520b0_191"},{"__ref":"Paragraph:230c5f8520b0_192"},{"__ref":"Paragraph:230c5f8520b0_193"},{"__ref":"Paragraph:230c5f8520b0_194"},{"__ref":"Paragraph:230c5f8520b0_195"},{"__ref":"Paragraph:230c5f8520b0_196"},{"__ref":"Paragraph:230c5f8520b0_197"},{"__ref":"Paragraph:230c5f8520b0_198"},{"__ref":"Paragraph:230c5f8520b0_199"},{"__ref":"Paragraph:230c5f8520b0_200"},{"__ref":"Paragraph:230c5f8520b0_201"},{"__ref":"Paragraph:230c5f8520b0_202"},{"__ref":"Paragraph:230c5f8520b0_203"},{"__ref":"Paragraph:230c5f8520b0_204"},{"__ref":"Paragraph:230c5f8520b0_205"},{"__ref":"Paragraph:230c5f8520b0_206"},{"__ref":"Paragraph:230c5f8520b0_207"},{"__ref":"Paragraph:230c5f8520b0_208"},{"__ref":"Paragraph:230c5f8520b0_209"},{"__ref":"Paragraph:230c5f8520b0_210"},{"__ref":"Paragraph:230c5f8520b0_211"},{"__ref":"Paragraph:230c5f8520b0_212"},{"__ref":"Paragraph:230c5f8520b0_213"},{"__ref":"Paragraph:230c5f8520b0_214"},{"__ref":"Paragraph:230c5f8520b0_215"},{"__ref":"Paragraph:230c5f8520b0_216"},{"__ref":"Paragraph:230c5f8520b0_217"},{"__ref":"Paragraph:230c5f8520b0_218"},{"__ref":"Paragraph:230c5f8520b0_219"},{"__ref":"Paragraph:230c5f8520b0_220"},{"__ref":"Paragraph:230c5f8520b0_221"},{"__ref":"Paragraph:230c5f8520b0_222"},{"__ref":"Paragraph:230c5f8520b0_223"},{"__ref":"Paragraph:230c5f8520b0_224"},{"__ref":"Paragraph:230c5f8520b0_225"},{"__ref":"Paragraph:230c5f8520b0_226"},{"__ref":"Paragraph:230c5f8520b0_227"},{"__ref":"Paragraph:230c5f8520b0_228"},{"__ref":"Paragraph:230c5f8520b0_229"},{"__ref":"Paragraph:230c5f8520b0_230"},{"__ref":"Paragraph:230c5f8520b0_231"},{"__ref":"Paragraph:230c5f8520b0_232"},{"__ref":"Paragraph:230c5f8520b0_233"},{"__ref":"Paragraph:230c5f8520b0_234"},{"__ref":"Paragraph:230c5f8520b0_235"},{"__ref":"Paragraph:230c5f8520b0_236"},{"__ref":"Paragraph:230c5f8520b0_237"},{"__ref":"Paragraph:230c5f8520b0_238"},{"__ref":"Paragraph:230c5f8520b0_239"},{"__ref":"Paragraph:230c5f8520b0_240"},{"__ref":"Paragraph:230c5f8520b0_241"},{"__ref":"Paragraph:230c5f8520b0_242"},{"__ref":"Paragraph:230c5f8520b0_243"},{"__ref":"Paragraph:230c5f8520b0_244"},{"__ref":"Paragraph:230c5f8520b0_245"},{"__ref":"Paragraph:230c5f8520b0_246"},{"__ref":"Paragraph:230c5f8520b0_247"},{"__ref":"Paragraph:230c5f8520b0_248"},{"__ref":"Paragraph:230c5f8520b0_249"},{"__ref":"Paragraph:230c5f8520b0_250"},{"__ref":"Paragraph:230c5f8520b0_251"},{"__ref":"Paragraph:230c5f8520b0_252"},{"__ref":"Paragraph:230c5f8520b0_253"},{"__ref":"Paragraph:230c5f8520b0_254"},{"__ref":"Paragraph:230c5f8520b0_255"},{"__ref":"Paragraph:230c5f8520b0_256"},{"__ref":"Paragraph:230c5f8520b0_257"},{"__ref":"Paragraph:230c5f8520b0_258"},{"__ref":"Paragraph:230c5f8520b0_259"},{"__ref":"Paragraph:230c5f8520b0_260"},{"__ref":"Paragraph:230c5f8520b0_261"},{"__ref":"Paragraph:230c5f8520b0_262"},{"__ref":"Paragraph:230c5f8520b0_263"},{"__ref":"Paragraph:230c5f8520b0_264"},{"__ref":"Paragraph:230c5f8520b0_265"},{"__ref":"Paragraph:230c5f8520b0_266"},{"__ref":"Paragraph:230c5f8520b0_267"},{"__ref":"Paragraph:230c5f8520b0_268"},{"__ref":"Paragraph:230c5f8520b0_269"},{"__ref":"Paragraph:230c5f8520b0_270"},{"__ref":"Paragraph:230c5f8520b0_271"},{"__ref":"Paragraph:230c5f8520b0_272"},{"__ref":"Paragraph:230c5f8520b0_273"},{"__ref":"Paragraph:230c5f8520b0_274"},{"__ref":"Paragraph:230c5f8520b0_275"},{"__ref":"Paragraph:230c5f8520b0_276"},{"__ref":"Paragraph:230c5f8520b0_277"},{"__ref":"Paragraph:230c5f8520b0_278"},{"__ref":"Paragraph:230c5f8520b0_279"},{"__ref":"Paragraph:230c5f8520b0_280"},{"__ref":"Paragraph:230c5f8520b0_281"},{"__ref":"Paragraph:230c5f8520b0_282"},{"__ref":"Paragraph:230c5f8520b0_283"},{"__ref":"Paragraph:230c5f8520b0_284"},{"__ref":"Paragraph:230c5f8520b0_285"},{"__ref":"Paragraph:230c5f8520b0_286"},{"__ref":"Paragraph:230c5f8520b0_287"},{"__ref":"Paragraph:230c5f8520b0_288"},{"__ref":"Paragraph:230c5f8520b0_289"},{"__ref":"Paragraph:230c5f8520b0_290"},{"__ref":"Paragraph:230c5f8520b0_291"},{"__ref":"Paragraph:230c5f8520b0_292"},{"__ref":"Paragraph:230c5f8520b0_293"},{"__ref":"Paragraph:230c5f8520b0_294"},{"__ref":"Paragraph:230c5f8520b0_295"},{"__ref":"Paragraph:230c5f8520b0_296"},{"__ref":"Paragraph:230c5f8520b0_297"},{"__ref":"Paragraph:230c5f8520b0_298"},{"__ref":"Paragraph:230c5f8520b0_299"},{"__ref":"Paragraph:230c5f8520b0_300"},{"__ref":"Paragraph:230c5f8520b0_301"},{"__ref":"Paragraph:230c5f8520b0_302"},{"__ref":"Paragraph:230c5f8520b0_303"},{"__ref":"Paragraph:230c5f8520b0_304"},{"__ref":"Paragraph:230c5f8520b0_305"},{"__ref":"Paragraph:230c5f8520b0_306"},{"__ref":"Paragraph:230c5f8520b0_307"},{"__ref":"Paragraph:230c5f8520b0_308"},{"__ref":"Paragraph:230c5f8520b0_309"},{"__ref":"Paragraph:230c5f8520b0_310"},{"__ref":"Paragraph:230c5f8520b0_311"},{"__ref":"Paragraph:230c5f8520b0_312"},{"__ref":"Paragraph:230c5f8520b0_313"},{"__ref":"Paragraph:230c5f8520b0_314"},{"__ref":"Paragraph:230c5f8520b0_315"},{"__ref":"Paragraph:230c5f8520b0_316"},{"__ref":"Paragraph:230c5f8520b0_317"},{"__ref":"Paragraph:230c5f8520b0_318"},{"__ref":"Paragraph:230c5f8520b0_319"},{"__ref":"Paragraph:230c5f8520b0_320"},{"__ref":"Paragraph:230c5f8520b0_321"},{"__ref":"Paragraph:230c5f8520b0_322"},{"__ref":"Paragraph:230c5f8520b0_323"},{"__ref":"Paragraph:230c5f8520b0_324"},{"__ref":"Paragraph:230c5f8520b0_325"},{"__ref":"Paragraph:230c5f8520b0_326"},{"__ref":"Paragraph:230c5f8520b0_327"},{"__ref":"Paragraph:230c5f8520b0_328"},{"__ref":"Paragraph:230c5f8520b0_329"},{"__ref":"Paragraph:230c5f8520b0_330"},{"__ref":"Paragraph:230c5f8520b0_331"},{"__ref":"Paragraph:230c5f8520b0_332"},{"__ref":"Paragraph:230c5f8520b0_333"},{"__ref":"Paragraph:230c5f8520b0_334"},{"__ref":"Paragraph:230c5f8520b0_335"},{"__ref":"Paragraph:230c5f8520b0_336"},{"__ref":"Paragraph:230c5f8520b0_337"},{"__ref":"Paragraph:230c5f8520b0_338"},{"__ref":"Paragraph:230c5f8520b0_339"},{"__ref":"Paragraph:230c5f8520b0_340"},{"__ref":"Paragraph:230c5f8520b0_341"},{"__ref":"Paragraph:230c5f8520b0_342"},{"__ref":"Paragraph:230c5f8520b0_343"},{"__ref":"Paragraph:230c5f8520b0_344"},{"__ref":"Paragraph:230c5f8520b0_345"},{"__ref":"Paragraph:230c5f8520b0_346"},{"__ref":"Paragraph:230c5f8520b0_347"},{"__ref":"Paragraph:230c5f8520b0_348"},{"__ref":"Paragraph:230c5f8520b0_349"},{"__ref":"Paragraph:230c5f8520b0_350"},{"__ref":"Paragraph:230c5f8520b0_351"},{"__ref":"Paragraph:230c5f8520b0_352"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:b408bb1e7c46"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Fdeep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317","primaryTopic":null,"topics":[],"isLimitedState":false,"isPublished":true,"allowResponses":true,"responsesLocked":false,"visibility":"PUBLIC","latestPublishedVersion":"230c5f8520b0","postResponses":{"__typename":"PostResponses","count":0},"responseDistribution":"NOT_DISTRIBUTED","clapCount":1,"title":"Deep analysis of REvil Ransomware | Written in Korean","isSeries":false,"sequence":null,"uniqueSlug":"deep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1624591049195,"readingTime":31.358,"previewContent":{"__typename":"PreviewContent","subtitle":"Author: Sojun Ryu (hypen) @ S2WLAB Talon"},"previewImage":{"__ref":"ImageMetadata:1*Qs6ckloSB92wDYDACISQoA.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1624432976430,"updatedAt":1641468390110,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:d1899c0e9317-viewerId:lo_8149ad905322"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:intelligence"},{"__ref":"Tag:ransomware"},{"__ref":"Tag:revil"},{"__ref":"Tag:darkweb"},{"__ref":"Tag:cybercrime"}],"isFeaturedInPublishedPublication":false,"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"ko","wordCount":3503,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.73333ac4.js"></script><script src="https://cdn-client.medium.com/lite/static/js/7344.038740f6.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.1b286545.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.5bef8967.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8813.659c88d9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4505.7ab55d37.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9380.fb176dee.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.6c765447.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.9dbd56c7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3326.7adef0e5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4595.194fb775.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/803.5e656ff2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4737.c67e22e1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6372.5d5cd930.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7381.f7e0eb83.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7938.e6a42c55.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7753.6e7f01a2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3862.83422889.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5660.e6a07db3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4929.96d0563a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3623.555a945d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.cbce1d31.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7979.3a4df06b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.01a5e035.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8664.2e3faabf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3877.ac40f237.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/144.4a1cadca.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3666.cdb15b43.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1922.f1e703c7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1069.2fb4db3c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3523.80c399f0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3515.c7017256.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.51635eef.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2698.a5c8f865.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.6ff9e2e8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.af9dbc12.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.b6dc6f8b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.bb412220.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9451551769a9c9a7',t:'MTc0ODEzNzMwNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"9451551769a9c9a7","version":"2025.4.0-1-g37f21b1","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>