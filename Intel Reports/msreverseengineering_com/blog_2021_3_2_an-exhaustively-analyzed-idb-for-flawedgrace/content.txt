<!doctype html>
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US" >

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  
  <meta name="viewport" content="initial-scale=1">
  
  <!-- This is Squarespace. --><!-- rolf-rolles-bq5a -->
<base href="">
<meta charset="utf-8" />
<title>An Exhaustively-Analyzed IDB for FlawedGrace &mdash; Möbius Strip Reverse Engineering</title>
<meta http-equiv="Accept-CH" content="Sec-CH-UA-Platform-Version, Sec-CH-UA-Model" /><link rel="icon" type="image/x-icon" href="https://assets.squarespace.com/universal/default-favicon.ico"/>
<link rel="canonical" href="https://www.msreverseengineering.com/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace"/>
<meta property="og:site_name" content="Möbius Strip Reverse Engineering"/>
<meta property="og:title" content="An Exhaustively-Analyzed IDB for FlawedGrace &mdash; Möbius Strip Reverse Engineering"/>
<meta property="og:latitude" content="40.7207559"/>
<meta property="og:longitude" content="-74.0007613"/>
<meta property="og:locality" content=""/>
<meta property="og:url" content="https://www.msreverseengineering.com/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="This blog entry announces the release of an exhaustive analysis of FlawedGrace.  You can find the IDB for the main executable, and for the 64-bit password stealer module, here.  The sha1sum for the main executable is 9bb72ae1dc6c49806064992e0850dc8cb02571ed, and the md5sum is bc91e2c139369a1ae219a11"/>
<meta property="og:image" content="http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/603e8cf06e44e255f5c5a9c6/1614712052828/AnalysisComparison.png?format=1500w"/>
<meta property="og:image:width" content="1309"/>
<meta property="og:image:height" content="1234"/>
<meta itemprop="name" content="An Exhaustively-Analyzed IDB for FlawedGrace — Möbius Strip Reverse Engineering"/>
<meta itemprop="url" content="https://www.msreverseengineering.com/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace"/>
<meta itemprop="description" content="This blog entry announces the release of an exhaustive analysis of FlawedGrace.  You can find the IDB for the main executable, and for the 64-bit password stealer module, here.  The sha1sum for the main executable is 9bb72ae1dc6c49806064992e0850dc8cb02571ed, and the md5sum is bc91e2c139369a1ae219a11"/>
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/603e8cf06e44e255f5c5a9c6/1614712052828/AnalysisComparison.png?format=1500w"/>
<link rel="image_src" href="http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/603e8cf06e44e255f5c5a9c6/1614712052828/AnalysisComparison.png?format=1500w" />
<meta itemprop="image" content="http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/603e8cf06e44e255f5c5a9c6/1614712052828/AnalysisComparison.png?format=1500w"/>
<meta itemprop="author" content="Rolf Rolles"/>
<meta itemprop="datePublished" content="2021-03-02T11:47:11-0800"/>
<meta itemprop="dateModified" content="2021-03-02T11:47:12-0800"/>
<meta itemprop="headline" content="An Exhaustively-Analyzed IDB for FlawedGrace"/>
<meta itemprop="publisher" content="Möbius Strip Reverse Engineering"/>
<meta name="twitter:title" content="An Exhaustively-Analyzed IDB for FlawedGrace — Möbius Strip Reverse Engineering"/>
<meta name="twitter:image" content="http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/603e8cf06e44e255f5c5a9c6/1614712052828/AnalysisComparison.png?format=1500w"/>
<meta name="twitter:url" content="https://www.msreverseengineering.com/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="This blog entry announces the release of an exhaustive analysis of FlawedGrace.  You can find the IDB for the main executable, and for the 64-bit password stealer module, here.  The sha1sum for the main executable is 9bb72ae1dc6c49806064992e0850dc8cb02571ed, and the md5sum is bc91e2c139369a1ae219a11"/>
<meta name="description" content="" />
<link rel="preconnect" href="https://images.squarespace-cdn.com">
<link rel="preconnect" href="https://use.typekit.net" crossorigin>
<link rel="preconnect" href="https://p.typekit.net" crossorigin>
<script type="text/javascript" src="//use.typekit.net/ik/5WVm_KtEW5xuGFOxRM_pHbt0ouhorTX8IpdCwOAZF-bfezCgfFHN4UJLFRbh52jhWD9DjQjXjhwkZQsKwewhwhZRF2BywDwkwgToiaiaOcuDScmhZW4DZAm0Zh80ZAmk-Ao1OcFzdPUlSa48icmkShm8dciTdcm8Sc80ZkoRdhXCScNCZKukdhUCZWwlj1IujPoDSWmyScmDSeBRZPoRdhXCHKokdhUcOW4zdeU8SkuKSQmyO1FUiABkZWF3jAF8OcFzdPJwSY4zpe8ljPu0daZyH6qJtKGbMg62JMJ7fbKzMsMMeMb6MKG4fHXgIMMjgKMfH6qJK3IbMg6YJMJ7fbRRHyMMeMX6MKG4fHtgIMMjIfMfH6qJRMIbMg6sJMJ.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Varela+Round:ital,wght@0,400"><script type="text/javascript" crossorigin="anonymous" nomodule="nomodule" src="//assets.squarespace.com/@sqs/polyfiller/1.6/legacy.js"></script>
<script type="text/javascript" crossorigin="anonymous" src="//assets.squarespace.com/@sqs/polyfiller/1.6/modern.js"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-515ceed1bef6d0ff-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_runtime');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-515ceed1bef6d0ff-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-b60fc53b12f6d6c5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_moment_js_vendor');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-b60fc53b12f6d6c5-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-cfcd09cc211142f2-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-cfcd09cc211142f2-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-51880dc0d7a0158c-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-51880dc0d7a0158c-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-df1fd1183d9390fb-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-df1fd1183d9390fb-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-ec180c5432532e1c-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-ec180c5432532e1c-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/commerce-880642b2732c717f-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-commerce');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/commerce-880642b2732c717f-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].css = ["//assets.squarespace.com/universal/styles-compressed/commerce-9623d3d351c90321-min.en-US.css"]; })(SQUARESPACE_ROLLUPS, 'squarespace-commerce');</script>
<link rel="stylesheet" type="text/css" href="//assets.squarespace.com/universal/styles-compressed/commerce-9623d3d351c90321-min.en-US.css"><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/user-account-core-e3e47ef95318cccd-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-user_account_core');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/user-account-core-e3e47ef95318cccd-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].css = ["//assets.squarespace.com/universal/styles-compressed/user-account-core-32dec2abb821f895-min.en-US.css"]; })(SQUARESPACE_ROLLUPS, 'squarespace-user_account_core');</script>
<link rel="stylesheet" type="text/css" href="//assets.squarespace.com/universal/styles-compressed/user-account-core-32dec2abb821f895-min.en-US.css"><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-568466a7a45b7b65-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/performance-568466a7a45b7b65-min.en-US.js" defer ></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"betaFeatureFlags":["campaigns_new_image_layout_picker","i18n_beta_website_locales","campaigns_thumbnail_layout","campaigns_discount_section_in_automations","marketing_landing_page","campaigns_discount_section_in_blasts","marketing_automations","campaigns_import_discounts","order_status_page_checkout_landing_enabled","contacts_and_campaigns_redesign"],"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-929d54e21180185e-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-5d864aadea1060d1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-ff1ba4eebaf7b262-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-47a224f34e715983-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-2204db19701b2ebe-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-96b256171ee039c1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-ea68dbda5f388989-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-01eecf660cca1c8d-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-0a38891230aaac9c-min.en-US.js"},"squarespace-custom-css-popup":{"css":"//assets.squarespace.com/universal/styles-compressed/custom-css-popup-01f4ea53f1ef2e01-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/custom-css-popup-2554dff2468c87d7-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-f9093f2d526b94df-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-f6a1d5438a7c7c28-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-a51a0c508870ad93-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-67db9dfae13a802c-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-0afd3c6ac30bbab1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-96a9c00206ab47a1-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-de0dea92b161a99b-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-104246dd5ee81f93-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-71b95dc6a65ad0b0-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-b742b752f5880972-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-9f7a8269d25d75a5-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-0ba5bac716923b8e-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-c4e6ba83e5fe6729-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-d1bdb2ab433d5058-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-6676ab1a86064e26-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-90a67fc09b9b32c6-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-427f06a82a4c7a3d-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-a56885d30b3c3073-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-701bf8bbc05ec6aa-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-b76ae7bcbecc9533-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-95032e5fa98e47a5-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-476538637d19f94c-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-58c6d775dcd3c2e1-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-07ea5a4e004e6710-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-0ab5b1476f53fc55-min.en-US.js"}},"pageType":50,"website":{"id":"53a64cc2e4b0c63fc41a3320","identifier":"rolf-rolles-bq5a","websiteType":4,"contentModifiedOn":1724352448217,"cloneable":false,"hasBeenCloneable":false,"siteStatus":{},"language":"en-US","timeZone":"America/Los_Angeles","machineTimeZoneOffset":-25200000,"timeZoneOffset":-25200000,"timeZoneAbbr":"PDT","siteTitle":"M\u00F6bius Strip Reverse Engineering","fullSiteTitle":"An Exhaustively-Analyzed IDB for FlawedGrace \u2014 M\u00F6bius Strip Reverse Engineering","siteTagLine":"Reverse Engineering Training and Consulting Services","siteDescription":"","location":{"mapZoom":12.0,"mapLat":40.7207559,"mapLng":-74.0007613},"shareButtonOptions":{"6":true,"4":true,"7":true,"3":true,"8":true,"2":true,"1":true},"authenticUrl":"https://www.msreverseengineering.com","internalUrl":"https://rolf-rolles-bq5a.squarespace.com","baseUrl":"https://www.msreverseengineering.com","primaryDomain":"www.msreverseengineering.com","sslSetting":3,"isHstsEnabled":true,"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"1ab975037ccdff31fa158700002d4efcc43a3cb077534d7f9217074e3e2f3d24","showOwnerLogin":false},"websiteSettings":{"id":"53a64cc2e4b0c63fc41a3321","websiteId":"53a64cc2e4b0c63fc41a3320","type":"Business","subjects":[{"systemSubject":"tech"}],"country":"US","state":"CA","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":true,"contactPhoneNumber":"","storeSettings":{"returnPolicy":"","termsOfService":"","privacyPolicy":"","expressCheckout":true,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["USD","AUD","CAD","CHF","DKK","EUR","GBP","NOK","SEK"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":1,"showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false,"displayImportedProductReviewsEnabled":false,"hasOptedToCollectNativeReviews":false},"minimumOrderSubtotalEnabled":false,"isLive":true,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"userAccountsSettings":{"loginAllowed":true,"signupAllowed":true}},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":"","cookieBannerHasOptOut":false,"cookieBannerHasManageCookies":true,"cookieBannerManageCookiesLabel":"","cookieBannerSavedPreferencesText":"","cookieBannerSavedPreferencesLayout":"PILL"},"websiteCloneable":false,"collection":{"title":"Blog","id":"53a64ceee4b0d3d42b2c7856","fullUrl":"/blog","publicCommentCount":0,"type":1,"permissionType":1},"item":{"title":"An Exhaustively-Analyzed IDB for FlawedGrace","id":"603e8c2e21d04c15e6dece64","fullUrl":"/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace","publicCommentCount":0,"commentState":1,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":true,"tweakJSON":{"outerPadding":"100px","pagePadding":"80px","product-gallery-auto-crop":"true","product-image-auto-crop":"true","topPadding":"80px","tweak-v1-related-products-title-spacing":"50px"},"templateId":"50521cf884aeb45fa5cfdb80","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/5052176b84aeb45fa5cfcc83/961/scripts/","impersonatedSession":false,"demoCollections":[{"collectionId":"5052176b84aeb45fa5cfcc94","deleted":false}],"tzData":{"zones":[[-480,"US","P%sT",null]],"rules":{"US":[[1967,2006,null,"Oct","lastSun","2:00","0","S"],[1987,2006,null,"Apr","Sun>=1","2:00","1:00","D"],[2007,"max",null,"Mar","Sun>=8","2:00","1:00","D"],[2007,"max",null,"Nov","Sun>=1","2:00","0","S"]]}},"showAnnouncementBar":false,"recaptchaEnterpriseContext":{"recaptchaEnterpriseSiteKey":"6LdDFQwjAAAAAPigEvvPgEVbb7QBm-TkVJdDTlAv"},"i18nContext":{"timeZoneData":{"id":"America/Los_Angeles","name":"Pacific Time"}},"env":"PRODUCTION"};</script><script>Squarespace.load(window);</script>
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.msreverseengineering.com/blog?format=rss" />
<script type="application/ld+json">{"url":"https://www.msreverseengineering.com","name":"M\u00F6bius Strip Reverse Engineering","description":"","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"address":"","@context":"http://schema.org","@type":"LocalBusiness"}</script><script type="application/ld+json">{"name":"An Exhaustively-Analyzed IDB for FlawedGrace \u2014 M\u00F6bius Strip Reverse Engineering","url":"https://www.msreverseengineering.com/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace","datePublished":"2021-03-02T11:47:11-0800","dateModified":"2021-03-02T11:47:12-0800","headline":"An Exhaustively-Analyzed IDB for FlawedGrace","author":"Rolf Rolles","publisher":{"name":"M\u00F6bius Strip Reverse Engineering","logo":{"@type":"ImageObject"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/t/603e8cf06e44e255f5c5a9c6/1614712052828/AnalysisComparison.png?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="https://static1.squarespace.com/static/sitecss/53a64cc2e4b0c63fc41a3320/53/50521cf884aeb45fa5cfdb80/53a64cc2e4b0c63fc41a3324/961/site.css"/><script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53862034-1"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZjQwMz', true);gtag('config', 'UA-53862034-1');</script><!-- End of Squarespace Headers -->
  <script src="https://static1.squarespace.com/static/ta/5052176b84aeb45fa5cfcc83/961/scripts/site-bundle.js" type="text/javascript"></script>
</head>

<body class="show-products-category-navigation   page-borders-thick canvas-style-normal  header-subtitle-address banner-alignment-center blog-layout-center project-layout-left-sidebar thumbnails-on-open-page-show-all social-icon-style-round    hide-page-title       event-thumbnails event-thumbnail-size-32-standard event-date-label event-date-label-time event-list-show-cats event-list-date event-list-time event-list-address   event-icalgcal-links  event-excerpts  event-item-back-link    product-list-titles-under product-list-alignment-center product-item-size-32-standard product-image-auto-crop product-gallery-size-11-square product-gallery-auto-crop show-product-price show-product-item-nav product-social-sharing tweak-v1-related-products-image-aspect-ratio-11-square tweak-v1-related-products-details-alignment-center newsletter-style-dark  opentable-style-light small-button-style-solid small-button-shape-square medium-button-style-solid medium-button-shape-square large-button-style-solid large-button-shape-square image-block-poster-text-alignment-center image-block-card-dynamic-font-sizing image-block-card-content-position-center image-block-card-text-alignment-left image-block-overlap-dynamic-font-sizing image-block-overlap-content-position-center image-block-overlap-text-alignment-left image-block-collage-dynamic-font-sizing image-block-collage-content-position-top image-block-collage-text-alignment-left image-block-stack-dynamic-font-sizing image-block-stack-text-alignment-left button-style-outline button-corner-style-square tweak-product-quick-view-button-style-floating tweak-product-quick-view-button-position-bottom tweak-product-quick-view-lightbox-excerpt-display-truncate tweak-product-quick-view-lightbox-show-arrows tweak-product-quick-view-lightbox-show-close-button tweak-product-quick-view-lightbox-controls-weight-light native-currency-code-usd collection-53a64ceee4b0d3d42b2c7856 view-item collection-type-blog collection-layout-default mobile-style-available site-title" id="item-603e8c2e21d04c15e6dece64">

  <div id="canvas">

    <div id="mobileNav" class="">
      <div class="wrapper">
        <nav class="main-nav mobileNav"><ul>
  
    

        <li class="page-collection">

          

            
              <a href="/training-classes">Training Classes</a>
            

            


          

        </li>

    

        <li class="page-collection">

          

            
              <a href="/research">Research</a>
            

            


          

        </li>

    

        <li class="blog-collection active-link">

          

            
              <a href="/blog">Blog</a>
            

            


          

        </li>

    

        <li class="page-collection">

          

            
              <a href="/contact">Contact</a>
            

            


          

        </li>

    
    
      <li class="user-account-link">
        <a href="#">
          <span class="sign-in">Sign In</span>
          <span class="my-account">My Account</span>
        </a>
      </li>
    
  
</ul>
</nav>

      </div>
    </div>
    <div id="mobileMenuLink"><a>Menu</a></div>

    <header id="header" class="clear">

    

      <div id="upper-logo">
        <h1 class="logo" data-content-field="site-title">
          <a href="/">Möbius Strip Reverse Engineering</a>
        </h1>
      </div>
      <script type="module">
      if (parseInt(Y.one('body').getComputedStyle('width'),10) <= 640) {
        Y.use('squarespace-ui-base', function(Y) {
          Y.one("#upper-logo .logo").plug(Y.Squarespace.TextShrink, {
            parentEl: Y.one('#upper-logo')
          });
        });
      }
      </script>

      
      <div class="site-info" data-content-field="business-information">
        <div class="site-address">Street Address</div>
        <div class="site-city-state">City, State, Zip</div>
        <div class="site-phone">Phone Number</div>
      </div>
      

      <div class="site-tag-line">
        <span>Reverse Engineering Training and Consulting Services</span>
      </div>

      <div class="custom-info">
        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Header Subtitle: Custom Content" data-type="block-field" data-updated-on="1381761023501" id="customInfoBlock"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-81eee4bbda3d9efd0834"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="text-align-center">Your Custom Text Here</p>
</div>






















</div></div></div></div></div>
      </div>

      <div id="lower-logo">
        <h1 class="logo" data-content-field="site-title"><a href="/">Möbius Strip Reverse Engineering</a></h1>
      </div>
      <script type="module">
        Y.use('squarespace-ui-base', function(Y) {
          Y.one("#lower-logo .logo").plug(Y.Squarespace.TextShrink, {
            parentEl: Y.one('#lower-logo')
          });
        });
      </script>

    
      <div id="topNav">
  <nav class="main-nav" data-content-field="navigation">
    <ul>
    
      

          <li class="page-collection">

            

              
                <a href="/training-classes">Training Classes</a>
              

              


            

          </li>

      

          <li class="page-collection">

            

              
                <a href="/research">Research</a>
              

              


            

          </li>

      

          <li class="blog-collection active-link">

            

              
                <a href="/blog">Blog</a>
              

              


            

          </li>

      

          <li class="page-collection">

            

              
                <a href="/contact">Contact</a>
              

              


            

          </li>

      
      
        <li class="user-account-link">
          <a href="#">
            <span class="sign-in">Sign In</span>
            <span class="my-account">My Account</span>
          </a>
        </li>
      
    
  </ul>
  <div class="page-divider"></div>
  </nav>
</div>


    </header>

    <div class="page-divider top-divider"></div>

    <!-- // page image or divider -->
    
      
        
      
    

    <section id="page" class="clear" role="main" data-content-field="main-content" data-collection-id="53a64ceee4b0d3d42b2c7856" data-collection-id="53a64ceee4b0d3d42b2c7856" data-edit-main-image="Banner" >

      <!-- // CATEGORY NAV -->
      

      <div class="article-wrapper">



  <article class="hentry author-rolf-rolles post-type-text" id="article-603e8c2e21d04c15e6dece64" data-item-id="603e8c2e21d04c15e6dece64">

    <!--POST HEADER-->

    <header>
  		<h1 class="entry-title" itemprop="headline" data-content-field="title">
        
          <a href="/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace">An Exhaustively-Analyzed IDB for FlawedGrace</a>
        
      </h1>
      <div class="meta">
        <span class="date"><time class="published dt-published" datetime="2021-03-02" itemprop="datePublished" pubdate>March  2, 2021</time></span>
        <span class="author"><a href="/blog?author=5111cf9ee4b0a36262da10df" rel="author">Rolf Rolles</a></span>
      </div>
    </header>

    <!--SPECIAL CONTENT-->

    

    <!--POST BODY-->

    <div class="body entry-content"><div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1614714431739" id="item-603e8c2e21d04c15e6dece64"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-f1312d18138e1c5ba808"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">This blog entry announces the release of an exhaustive analysis of FlawedGrace. <a href="https://github.com/RolfRolles/IDBs/tree/master/FlawedGrace" target="_blank">You can find the IDB for the main executable, and for the 64-bit password stealer module, here.</a> The sha1sum for the main executable is 9bb72ae1dc6c49806064992e0850dc8cb02571ed, and the md5sum is bc91e2c139369a1ae219a11cbd9a243b.</p><p class="" style="white-space:pre-wrap;">Like the <a href="https://www.msreverseengineering.com/blog/2020/8/31/an-exhaustively-analyzed-idb-for-comrat-v4" target="_blank">previous entry in this series on ComRAT v4</a>, I did this analysis as part of my preparation for an upcoming class on C++ reverse engineering. The analysis took about a month, and made me enamored with FlawedGrace's architecture. I have personally never analyzed (nor read the source for) a program with such a sophisticated networking component. Were I ever to need a high-performance, robust, and flexible networking infrastructure, I'd probably find myself cribbing from FlawedGrace. This family is also notable for its custom, complex virtual filesystem used for configuration management and C2 communications. I would like to eventually write a treatise about all of the C++ malware family analyses that I performing during my research for the class, but that endeavor was distracting me from work on my course, and hence will have to wait.</p><p class="" style="white-space:pre-wrap;">(Note that if you are interested in the forthcoming C++ training class, it probably will be available in Q3/Q4 2021. More generally, remote public classes (where individual students can sign up) are temporarily suspended; remote private classes (multiple students on behalf of the same organization) are currently available. If you would like to be notified when public classes become available, or when the C++ course is ready, please sign up on our <a href="https://www.msreverseengineering.com/training-classes" target="_blank">no-spam, very low-volume, course notification mailing list</a>. (Click the button that says "Provide your email to be notified of public course availability".) )</p><p class="" style="white-space:pre-wrap;">(Note that I am looking for a fifth and final family (beyond ComRAT, FlawedGrace, XAgent, and Kelihos) to round out my analysis of C++ malware families. If you have suggestions -- and samples, or hashes I can download through <a href="https://www.hybrid-analysis.com/" target="_blank">Hybrid-Analysis</a> -- please send me an email at rolf@ my domain.)</p><h1 style="text-align:center;white-space:pre-wrap;">About the IDB</h1><p class="" style="white-space:pre-wrap;">Here are some screenshots. First, a comparison of the unanalyzed executable versus the analyzed one:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1614711839981_17269"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1309px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:94.27043914794922%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712048763-PUYUEV3SPYOQ0AALPDLC/AnalysisComparison.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712048763-PUYUEV3SPYOQ0AALPDLC/AnalysisComparison.png" data-image-dimensions="1309x1234" data-image-focal-point="0.5,0.5" alt="AnalysisComparison.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712048763-PUYUEV3SPYOQ0AALPDLC/AnalysisComparison.png" width="1309" height="1234" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712048763-PUYUEV3SPYOQ0AALPDLC/AnalysisComparison.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712048763-PUYUEV3SPYOQ0AALPDLC/AnalysisComparison.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712048763-PUYUEV3SPYOQ0AALPDLC/AnalysisComparison.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712048763-PUYUEV3SPYOQ0AALPDLC/AnalysisComparison.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712048763-PUYUEV3SPYOQ0AALPDLC/AnalysisComparison.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712048763-PUYUEV3SPYOQ0AALPDLC/AnalysisComparison.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712048763-PUYUEV3SPYOQ0AALPDLC/AnalysisComparison.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1614711839981_17582"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Next, IDA's function folders should make it easy to find the parts that interest you:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1614711839981_22655"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:572px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:209.26573181152344%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712191344-FYZBMPPTTKXFYFNAV1J6/Functions.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712191344-FYZBMPPTTKXFYFNAV1J6/Functions.png" data-image-dimensions="572x1197" data-image-focal-point="0.5,0.5" alt="Functions.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712191344-FYZBMPPTTKXFYFNAV1J6/Functions.png" width="572" height="1197" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712191344-FYZBMPPTTKXFYFNAV1J6/Functions.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712191344-FYZBMPPTTKXFYFNAV1J6/Functions.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712191344-FYZBMPPTTKXFYFNAV1J6/Functions.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712191344-FYZBMPPTTKXFYFNAV1J6/Functions.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712191344-FYZBMPPTTKXFYFNAV1J6/Functions.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712191344-FYZBMPPTTKXFYFNAV1J6/Functions.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712191344-FYZBMPPTTKXFYFNAV1J6/Functions.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1614711839981_22963"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Finally, the local types window contains all of the reconstructed data structures:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1614711839981_24747"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:994px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:114.6881332397461%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712228087-F6BN6M60R08QK5CUTFAS/LocalTypes.png" data-image="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712228087-F6BN6M60R08QK5CUTFAS/LocalTypes.png" data-image-dimensions="994x1140" data-image-focal-point="0.5,0.5" alt="LocalTypes.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712228087-F6BN6M60R08QK5CUTFAS/LocalTypes.png" width="994" height="1140" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712228087-F6BN6M60R08QK5CUTFAS/LocalTypes.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712228087-F6BN6M60R08QK5CUTFAS/LocalTypes.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712228087-F6BN6M60R08QK5CUTFAS/LocalTypes.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712228087-F6BN6M60R08QK5CUTFAS/LocalTypes.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712228087-F6BN6M60R08QK5CUTFAS/LocalTypes.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712228087-F6BN6M60R08QK5CUTFAS/LocalTypes.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/53a64cc2e4b0c63fc41a3320/1614712228087-F6BN6M60R08QK5CUTFAS/LocalTypes.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1614711839981_25056"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="text-align:center;white-space:pre-wrap;">About the Analysis</h1><p class="" style="white-space:pre-wrap;">Like the previous analysis of ComRAT v4, this analysis was conducted purely statically. Like the previous, I have reverse engineered every function in the binary that is not part of the C++ standard library, and some of those that are. Like the previous, all analysis was conducted in Hex-Rays, so you will not find anything particularly interesting in the plain disassembly listing. Unlike the previous, this binary had RTTI, meaning that I was given the names and inheritance relationships of classes with virtual functions.</p><p class="" style="white-space:pre-wrap;">Each C++ program that I devote significant time to analyzing seems to present me with unique challenges. With ComRAT, those were scale and usage of modern additions to the STL that had been previously unfamiliar to me. With XAgent, it was forcing myself to muddle through the subtleties of how MSVC implements multiple inheritance. For FlawedGrace, those challenges were: </p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">Extensive use of virtual functions and inheritance, beyond anything I've analyzed previously. Tracing the flow of data from point A to point B often involved around a dozen different object types and virtual function calls, sometimes more. You can see an example of this in the database notepad, where I describe the RDP tunneling implementation.</p></li><li><p class="" style="white-space:pre-wrap;">A type reconstruction burden that seemed to never end. FlawedGrace has one of the highest ratios of custom types to program size of anything I've analyzed. In total, I manually reconstructed 178 custom data types across 454 programmer-written functions, which you will find in the Local Types window.</p></li><li><p class="" style="white-space:pre-wrap;">Having to reverse engineer a complex virtual file system statically, with no sample data. You can find the relevant code in the functions window, under the folder path Modalities\Standalone\Virtual File System. I suspect this was written by a different team than the networking component, given the difference in coding styles: i.e., the VFS was written in plain C, with some features that mimic VTables.</p></li><li><p class="" style="white-space:pre-wrap;">Having to confront, as a user, the challenges that reverse engineering tools have with x86/Windows programs (in contrast to x64) with regards to stack pointer analysis and 64-bit integers.</p></li><li><p class="" style="white-space:pre-wrap;">Having to brush up on my network programming skills. For example, I had forgotten what the “Nagle algorithm” was. It’s clear that the server-side component is derived from the same codebase. However, the server portion of the code was not present in the binary, so I could not analyze it.</p></li></ul><p class="" style="white-space:pre-wrap;">FlawedGrace makes proficient use of C++ features and the STL, and its authors are experts in concurrent programming and networking. However, it is mostly written in an older style than ComRAT was; for example, it does not use &lt;memory&gt;. Here is a list of the STL data types used, in descending frequency of usage:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">&lt;atomic&gt;</p></li><li><p class="" style="white-space:pre-wrap;">thread</p></li><li><p class="" style="white-space:pre-wrap;">list&lt;T&gt;</p></li><li><p class="" style="white-space:pre-wrap;">map&lt;K,V&gt;</p></li><li><p class="" style="white-space:pre-wrap;">deque&lt;T&gt;</p></li><li><p class="" style="white-space:pre-wrap;">set&lt;T&gt;</p></li><li><p class="" style="white-space:pre-wrap;">vector&lt;T&gt;</p></li></ul><p class="" style="white-space:pre-wrap;">I hope you enjoy the IDB.</p>
</div>






















</div></div></div></div></div></div>
    


    <!--POST FOOTER-->

    <footer class="clear">
      <div class="meta">

        

        <div class="first meta-row">
          
          
        </div>

        <div class="second meta-row">
          <span class="squarespace-social-buttons inline-style" data-system-data-id="" data-asset-url="https://static1.squarespace.com/static/53a64cc2e4b0c63fc41a3320/53a64ceee4b0d3d42b2c7856/603e8c2e21d04c15e6dece64/1614714432987/" data-record-type="1" data-full-url="/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace" data-title="An Exhaustively-Analyzed IDB for FlawedGrace"></span>
          
  <span class="sqs-simple-like" data-item-id="603e8c2e21d04c15e6dece64" data-like-count="28">
    <span class="like-icon"></span>
    <span class="like-count"></span>
  </span>

        </div>

      </div>
    </footer>


  </article>



<!--PAGINATION-->


  <nav class="pagination clear">
      <a class="prev-item" href="/blog/2021/3/3/what-is-a-while2-loop-in-hex-rays">&larr; What is a while(2) loop in Hex-Rays?</a><a class="next-item" href="/blog/2020/8/31/an-exhaustively-analyzed-idb-for-comrat-v4">An Exhaustively-Analyzed IDB for ComRAT v4 &rarr;</a>
  </nav>



  <!-- COMMENTS -->

  <section id="comments-603e8c2e21d04c15e6dece64" class="comments-wrapper">
    
  <div class="squarespace-comments" id="comments-603e8c2e21d04c15e6dece64" data-item-id="603e8c2e21d04c15e6dece64" data-public-comment-count="0" data-comment-state="1"></div>

  </section>


</div><!-- /article-wrapper -->

<aside id="sidebar"><div class="sqs-layout sqs-grid-1 columns-1 empty" data-layout-label="Sidebar Content" data-type="block-field" id="sidebarBlocks"><div class="row sqs-row"><div class="col sqs-col-1 span-1"></div></div></div></aside>

    </section>

    <div class="sqs-layout sqs-grid-12 columns-12 empty" data-layout-label="Blog Footer Content" data-type="block-field" id="item-603e8c2e21d04c15e6dece64"><div class="row sqs-row"><div class="col sqs-col-12 span-12"></div></div></div>

    <!-- <div class="page-divider bottom-divider"></div> -->

    <div class="info-footer-wrapper clear">
      <div class="info-footer">
      <div class="sqs-layout sqs-grid-12 columns-12 empty" data-layout-label="Info Footer Content" data-type="block-field" data-updated-on="1403654631747" id="infoFooterBlock"><div class="row sqs-row"><div class="col sqs-col-12 span-12"></div></div></div>
      
        
      
      </div>
    </div>

    <footer id="footer" class="clear">
      <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Footer Content" data-type="block-field" data-updated-on="1357835131710" id="footerBlock"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-126febe67777dbcbc0b4"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="text-align-center">Powered by <a href="http://www.squarespace.com" data-link-type="external">Squarespace</a></p>
</div>






















</div></div></div></div></div>
    </footer>

  </div>

  <div></div>

  <script data-sqs-type="imageloader-bootstrapper">if(window.ImageLoader) window.ImageLoader.bootstrap({}, document);</script><script>Squarespace.afterBodyLoad(Y);</script>




</body>

</html>
