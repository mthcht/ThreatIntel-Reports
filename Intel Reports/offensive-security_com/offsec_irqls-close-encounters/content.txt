<!doctype html><html lang="en" dir="ltr" class="dark"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>IRQLs Close Encounters of the Rootkit Kind | OffSec</title>
<meta name="description" content="Content developer Matteo Malvica walks us through IRQLs and how hardware interrupts can be abused.">
<link rel="canonical" href="https://www.offsec.com/blog/irqls-close-encounters/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="IRQLs Close Encounters of the Rootkit Kind | OffSec">
<meta property="og:description" content="Content developer Matteo Malvica walks us through IRQLs and how hardware interrupts can be abused.">
<meta property="og:url" content="https://www.offsec.com/blog/irqls-close-encounters/">
<meta property="og:site_name" content="OffSec">
<meta property="article:publisher" content="https://www.facebook.com/offsec/">
<meta property="article:author" content="OffSec Team">
<meta property="article:published_time" content="2022-04-11T11:19:03+00:00">
<meta property="article:modified_time" content="2024-05-30T16:52:46+00:00">
<meta property="og:image" content="https://www.offsec.com/app/uploads/2022/03/IRQLs-Close-Encounters-of-the-Rootkit-Kind.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="628">
<meta property="og:image:type" content="image/png">
<meta name="author" content="OffSec Team">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@offsectraining">
<meta name="twitter:site" content="@offsectraining">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="OffSec">
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.offsec.com/blog/irqls-close-encounters/","url":"https://www.offsec.com/blog/irqls-close-encounters/","name":"IRQLs Close Encounters of the Rootkit Kind | OffSec","isPartOf":{"@id":"https://www.offsec.com/#website"},"primaryImageOfPage":{"@id":"https://www.offsec.com/blog/irqls-close-encounters/#primaryimage"},"image":{"@id":"https://www.offsec.com/blog/irqls-close-encounters/#primaryimage"},"thumbnailUrl":"https://manage.offsec.com/app/uploads/2022/03/IRQLs-Close-Encounters-of-the-Rootkit-Kind.png","datePublished":"2022-04-11T11:19:03+00:00","dateModified":"2024-05-30T16:52:46+00:00","description":"Content developer Matteo Malvica walks us through IRQLs and how hardware interrupts can be abused.","breadcrumb":{"@id":"https://www.offsec.com/blog/irqls-close-encounters/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.offsec.com/blog/irqls-close-encounters/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.offsec.com/blog/irqls-close-encounters/#primaryimage","url":"https://manage.offsec.com/app/uploads/2022/03/IRQLs-Close-Encounters-of-the-Rootkit-Kind.png","contentUrl":"https://manage.offsec.com/app/uploads/2022/03/IRQLs-Close-Encounters-of-the-Rootkit-Kind.png","width":1200,"height":628,"caption":"IRQLs-Close-Encounters-of-the-Rootkit-Kind"},{"@type":"BreadcrumbList","@id":"https://www.offsec.com/blog/irqls-close-encounters/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.offsec.com/"},{"@type":"ListItem","position":2,"name":"Research &amp; Tutorials","item":"https://www.offsec.com/blog/category/research-tutorials/"},{"@type":"ListItem","position":3,"name":"IRQLs Close Encounters of the Rootkit Kind"}]},{"@type":"WebSite","@id":"https://www.offsec.com/#website","url":"https://www.offsec.com/","name":"OffSec","description":"The Path to a Secure Future","publisher":{"@id":"https://www.offsec.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.offsec.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://www.offsec.com/#organization","name":"OffSec","url":"https://www.offsec.com/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.offsec.com/#/schema/logo/image/","url":"https://manage.offsec.com/app/uploads/2023/02/blog-header-brand-refresh.png","contentUrl":"https://manage.offsec.com/app/uploads/2023/02/blog-header-brand-refresh.png","width":1200,"height":628,"caption":"OffSec"},"image":{"@id":"https://www.offsec.com/#/schema/logo/image/"},"sameAs":["https://www.facebook.com/offsec/","https://x.com/offsectraining","https://www.linkedin.com/company/offensive-security/","https://www.instagram.com/offsectraining/","https://www.youtube.com/channel/UChYZsplz61SeG0olX6cMoAA","https://www.twitch.tv/offsecofficial"]},{"@type":"Person","@id":"https://www.offsec.com/#/schema/person/5ee0763f055891927a02d9a6cfad0263","name":"Kyle Olmstead","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.offsec.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/fe15c49535c7d416eb1cba64eb763a28?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/fe15c49535c7d416eb1cba64eb763a28?s=96&d=mm&r=g","caption":"Kyle Olmstead"}}]}</script><script type="module" src="/_astro/BaseLayout.astro_astro_type_script_index_0_lang.C4TuBb4o.js"></script>
<meta name="google-site-verification" content="orcPxI47GSa-cRvY11tUe6iGg2IO_RPvnA1q95iEM3M"> <link rel="shortcut icon" href="/_astro/favicon.BMs0eEax.ico"> <link rel="icon" type="image/svg+xml" href="/_astro/favicon.BMs0eEax.ico"> <link rel="mask-icon" href="/_astro/favicon.BMs0eEax.ico" color="#8D46E7"><script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="5cfe7093-608f-4f4e-80b4-925b1e9d949f" data-blockingmode="auto" type="text/javascript"></script><script type="module">(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-MFCR2NV")</script><script type="module">(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-MFCR2NV")</script><script type="module">(function(e,t,n,s,o,i,a){e.SLScoutObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://scout-cdn.salesloft.com/sl.js","slscout"),slscout(["init","eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0IjoxMTAwNzZ9.OBfAhM-I01D2b4iDew4tmzEpMbBrUcAfpyQYr97gs_E"])</script><script defer data-api="/api/event" data-domain="offsec.com" src="https://www.offsec.com/js/offsec.js"></script><link rel="stylesheet" href="/_astro/pen-200.ClIJurse.css">
<style>.wrapper:where(.astro-alw4reu2){border-radius:.5rem;display:flex;flex-direction:column;row-gap:1.25rem;width:100%;--tw-bg-opacity:1;background-color:rgb(37 33 43/var(--tw-bg-opacity,1));padding:1.5rem 1.25rem 2rem}@media(min-width:640px){.wrapper:where(.astro-alw4reu2){align-items:center;-moz-column-gap:2rem;column-gap:2rem;flex-direction:row;padding:1.75rem 2rem;row-gap:0}}@media(min-width:1024px){.wrapper:where(.astro-alw4reu2){-moz-column-gap:3rem;column-gap:3rem;padding-left:3rem;padding-right:3rem}}.social:where(.astro-alw4reu2){display:grid;height:2rem;place-content:center;width:2rem;--tw-bg-opacity:1;background-color:rgb(46 43 52/var(--tw-bg-opacity,1));color:rgb(237 236 238/var(--tw-text-opacity,1));transition-duration:.3s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.social:where(.astro-alw4reu2),.social:where(.astro-alw4reu2):hover{--tw-text-opacity:1}.social:where(.astro-alw4reu2):hover{color:rgb(200 168 245/var(--tw-text-opacity,1))}pre.wp-block-code{font-size:14px}code[class*=language-],pre[class*=language-]{background:0 0;color:#f8f8f2;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-break:normal;word-spacing:normal;word-wrap:normal;-webkit-hyphens:none;hyphens:none;line-height:1.5;overflow:overlay;-moz-tab-size:4;-o-tab-size:4;tab-size:4}code[class*=language-]::-webkit-scrollbar,pre[class*=language-]::-webkit-scrollbar{height:10px;width:10px}code[class*=language-]::-webkit-scrollbar-thumb,pre[class*=language-]::-webkit-scrollbar-thumb{background:#5a5a5a}code[class*=language-]::-webkit-scrollbar-track,pre[class*=language-]::-webkit-scrollbar-track{background:#0003}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1.5em 1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:var(--tw-prose-pre-bg,#0c0b10)}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#d4d0ab}.token.punctuation{color:#fefefe}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#ffa07a}.token.boolean,.token.number{color:#00e0e0}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#abe338}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#00e0e0}.token.atrule,.token.attr-value,.token.function{color:gold}.token.keyword{color:#00e0e0}.token.important,.token.regex{color:gold}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@media screen and (-ms-high-contrast:active){code[class*=language-],pre[class*=language-]{background:window;color:windowText}:not(pre)>code[class*=language-],pre[class*=language-]{background:window}.token.important{background:highlight;color:window;font-weight:400}.token.atrule,.token.attr-value,.token.function,.token.keyword,.token.operator,.token.selector{font-weight:700}.token.attr-value,.token.comment,.token.doctype,.token.function,.token.keyword,.token.operator,.token.property,.token.string{color:highlight}.token.attr-value,.token.url{font-weight:400}}</style>
<link rel="stylesheet" href="/_astro/_post_.CFaHkHel.css">
<style>.wrapper:where(.astro-hc4ydkeo){align-items:center;background-color:#fbfafb1a;border-radius:.25rem;display:flex;font-size:.875rem;gap:.5rem;justify-self:start;letter-spacing:0;line-height:1.5;padding:5px 1.5rem;width:-moz-fit-content;width:fit-content}.parent:where(.astro-hc4ydkeo){color:rgb(251 250 251/var(--tw-text-opacity,1));font-weight:400;transition-duration:.3s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.parent:where(.astro-hc4ydkeo),.parent:where(.astro-hc4ydkeo):hover{--tw-text-opacity:1}.parent:where(.astro-hc4ydkeo):hover{color:rgb(0 191 203/var(--tw-text-opacity,1))}.page-name:where(.astro-hc4ydkeo){display:-webkit-box;font-weight:600;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1}.recent-posts:where(.astro-o2bx5zug){align-items:center;display:flex;flex-direction:column;gap:2rem;margin-left:auto;margin-right:auto;max-width:72rem;padding-left:6%;padding-right:6%;width:100%}@media(min-width:640px){.recent-posts:where(.astro-o2bx5zug){padding-left:5%;padding-right:5%}}@media(min-width:1024px){.recent-posts:where(.astro-o2bx5zug){gap:2.5rem}}@media(min-width:1280px){.recent-posts:where(.astro-o2bx5zug){padding-left:0;padding-right:0}}.category-tag:where(.astro-qijqfjm2){background-color:#b183f033;border-radius:3px;font-size:.75rem;font-weight:600;letter-spacing:0;line-height:1.5;padding:.125rem .625rem;width:-moz-fit-content;width:fit-content;--tw-text-opacity:1;color:rgb(200 168 245/var(--tw-text-opacity,1))}@media(min-width:768px){.category-tag:where(.astro-qijqfjm2){font-size:.875rem;letter-spacing:0;line-height:1.5;padding-left:1rem;padding-right:1rem}}</style>
<link rel="stylesheet" href="/_astro/index.DjLSiqqc.css">
<link rel="stylesheet" href="/_astro/courses.DSaeJLWX.css">
<style>.wrapper:where(.astro-5kfhnqst){border-radius:.625rem;padding:1.5rem 1.75rem}@media(min-width:640px){.wrapper:where(.astro-5kfhnqst){padding-left:3rem;padding-right:3rem}}@media(min-width:768px){.wrapper:where(.astro-5kfhnqst){padding:2rem 1.5rem}}@media(min-width:1024px){.wrapper:where(.astro-5kfhnqst){padding-left:2.5rem;padding-right:2.5rem}}@media(min-width:1280px){.wrapper:where(.astro-5kfhnqst){padding:2.5rem 4rem}}.inner:where(.astro-5kfhnqst){align-items:center;display:flex;flex-direction:column;gap:2.5rem;margin-left:auto;margin-right:auto;width:100%}@media(min-width:768px){.inner:where(.astro-5kfhnqst){flex-direction:row;justify-content:center}}@media(min-width:1024px){.inner:where(.astro-5kfhnqst){gap:3rem;justify-content:space-between}}.inner:where(.astro-5kfhnqst) h2:where(.astro-5kfhnqst){font-size:1.25rem;font-weight:600;line-height:1.2;text-wrap:balance}@media(min-width:1024px){.inner:where(.astro-5kfhnqst) h2:where(.astro-5kfhnqst){font-size:1.5rem;line-height:1.2}}@media(min-width:768px){.inner:where(.astro-5kfhnqst) h2:where(.astro-5kfhnqst){text-wrap:pretty}}.inner:where(.astro-5kfhnqst) p:where(.astro-5kfhnqst){font-size:.875rem;letter-spacing:0;line-height:1.5;text-wrap:balance}@media(min-width:1024px){.inner:where(.astro-5kfhnqst) p:where(.astro-5kfhnqst){font-size:1rem;letter-spacing:0;line-height:1.5}}@media(min-width:768px){.inner:where(.astro-5kfhnqst) p:where(.astro-5kfhnqst){text-wrap:pretty}}.gradient:where(.astro-5kfhnqst){background:linear-gradient(0deg,#4c139ccc -110.07%,#4c139c14)}.shadow:where(.astro-5kfhnqst){filter:drop-shadow(0 4px 8px rgba(0,0,0,.2))}.footer-form.svelte-ea2y26,.footer-wrapper.svelte-ea2y26{display:flex;flex-direction:column;gap:.75rem;width:100%}@media(min-width:640px){.footer-form.svelte-ea2y26{flex-direction:row;gap:.5rem}}@media(min-width:1280px){.footer-form.svelte-ea2y26{gap:.75rem}}.footer-title.svelte-ea2y26{font-size:.875rem;font-weight:600;letter-spacing:0;line-height:1.5;--tw-text-opacity:1;color:rgb(240 254 255/var(--tw-text-opacity,1))}@media(min-width:1280px){.footer-title.svelte-ea2y26{font-size:1rem;letter-spacing:0;line-height:1.5}}.footer-legal.svelte-ea2y26{font-size:.75rem;letter-spacing:0;line-height:1.5;margin-top:-.125rem;--tw-text-opacity:1;color:rgb(224 222 226/var(--tw-text-opacity,1))}.footer-legal.svelte-ea2y26,.form.svelte-ea2y26{width:100%}.form.svelte-ea2y26{align-items:center;display:flex;flex-direction:column;gap:.75rem}@media(min-width:640px){.form.svelte-ea2y26{flex-direction:row}}.banner__container.svelte-ea2y26{display:flex;flex-direction:column;gap:.75rem}.banner__container.svelte-ea2y26,.field.svelte-ea2y26{width:100%}.field.svelte-ea2y26{border-radius:.25rem;border-width:1px;font-size:.875rem;letter-spacing:0;line-height:1.5;--tw-border-opacity:1;border-color:rgb(197 195 200/var(--tw-border-opacity,1));--tw-bg-opacity:1;background-color:rgb(237 236 238/var(--tw-bg-opacity,1));padding:7px .75rem;--tw-text-opacity:1;color:rgb(41 40 44/var(--tw-text-opacity,1));--tw-shadow:0 1px 2px 0 rgba(0,0,0,.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow);--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000);--tw-ring-offset-width:0px}@media(min-width:1024px){.field.svelte-ea2y26{font-size:1rem;letter-spacing:0;line-height:1.5}}.field.svelte-ea2y26::-moz-placeholder{--tw-text-opacity:1;color:rgb(83 79 87/var(--tw-text-opacity,1))}.field.svelte-ea2y26::placeholder{--tw-text-opacity:1;color:rgb(83 79 87/var(--tw-text-opacity,1))}.field.svelte-ea2y26:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000);--tw-ring-opacity:1;--tw-ring-color:rgb(102 25 208/var(--tw-ring-opacity,1))}.field.svelte-ea2y26:focus-visible{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000);--tw-ring-opacity:1;--tw-ring-color:rgb(102 25 208/var(--tw-ring-opacity,1))}</style>
<link rel="stylesheet" href="/_astro/_slug_.BOsDkXVx.css">
<style>.wrapper:where(.astro-vbuaafef){border-bottom-width:4px;border-radius:.25rem;display:grid;height:2.75rem;place-content:center;width:2.75rem;--tw-border-opacity:1;border-color:rgb(32 28 38/var(--tw-border-opacity,1));--tw-bg-opacity:1;background-color:rgb(37 33 43/var(--tw-bg-opacity,1));--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color);transition-duration:.5s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.wrapper:where(.astro-vbuaafef),.wrapper:where(.astro-vbuaafef):hover{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.wrapper:where(.astro-vbuaafef):hover{--tw-border-opacity:1;border-color:rgb(37 33 43/var(--tw-border-opacity,1));--tw-bg-opacity:1;background-color:rgb(46 43 52/var(--tw-bg-opacity,1));--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}@media(min-width:1024px){.wrapper:where(.astro-vbuaafef){height:3rem;width:3rem}}.icon:where(.astro-vbuaafef){color:rgb(200 168 245/var(--tw-text-opacity,1));height:1.5rem;transition-duration:.3s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);width:1.5rem}.group:where(.astro-vbuaafef):hover .icon:where(.astro-vbuaafef),.icon:where(.astro-vbuaafef){--tw-text-opacity:1}.group:where(.astro-vbuaafef):hover .icon:where(.astro-vbuaafef){color:rgb(0 191 203/var(--tw-text-opacity,1))}@media(min-width:1024px){.icon:where(.astro-vbuaafef){height:1.75rem;width:1.75rem}}.wrapper.svelte-109e7xd{border-bottom-width:10px;border-radius:.375rem;gap:0;overflow:hidden;width:100%;--tw-border-opacity:1;border-color:rgb(32 28 38/var(--tw-border-opacity,1));--tw-bg-opacity:1;background-color:rgb(37 33 43/var(--tw-bg-opacity,1));box-shadow:0 2px 10px 2px #0003;display:grid;grid-template-rows:var(--rows);transition-duration:.5s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.wrapper.svelte-109e7xd:hover{box-shadow:0 2px 10px 2px #0000004d}.img-wrap.svelte-109e7xd{aspect-ratio:2/1;overflow:hidden;width:100%}.img-wrap.svelte-109e7xd img{min-height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center;transition-duration:.5s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.group.svelte-109e7xd:hover .img-wrap:where(.svelte-109e7xd) img{--tw-scale-x:1.1;--tw-scale-y:1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.category.svelte-109e7xd{background-color:#c2fbff1a;font-size:.75rem;font-weight:600;height:-moz-fit-content;height:fit-content;letter-spacing:0;line-height:1.5;padding-bottom:.5rem;padding-top:.5rem;text-align:center;width:100%;--tw-text-opacity:1;color:rgb(194 251 255/var(--tw-text-opacity,1))}@media(min-width:768px){.category.svelte-109e7xd{font-size:.875rem;letter-spacing:0;line-height:1.5}}.info.svelte-109e7xd{gap:1.5rem;padding:1rem 1.25rem 1.5rem;width:100%}@media(min-width:768px){.info.svelte-109e7xd{padding:1.25rem 1.5rem 1.5rem}}.info.svelte-109e7xd{display:grid;grid-row:span 2;grid-template-rows:subgrid}.detail.svelte-109e7xd{display:flex;flex-direction:column;gap:.125rem;width:100%}.detail.svelte-109e7xd h3:where(.svelte-109e7xd){font-size:.875rem;font-weight:700;letter-spacing:0;line-height:1.5;text-wrap:pretty;width:100%;--tw-text-opacity:1;color:rgb(251 250 251/var(--tw-text-opacity,1))}@media(min-width:1024px){.detail.svelte-109e7xd h3:where(.svelte-109e7xd){font-size:1rem;letter-spacing:0;line-height:1.5}}.detail.svelte-109e7xd p:where(.svelte-109e7xd){display:none;font-size:.875rem;letter-spacing:0;line-height:1.5;overflow:hidden;text-wrap:pretty;width:100%;--tw-text-opacity:1;color:rgb(211 209 213/var(--tw-text-opacity,1))}@media(min-width:768px){.detail.svelte-109e7xd p:where(.svelte-109e7xd){display:block;display:-webkit-box;-webkit-box-orient:vertical;line-clamp:2;-webkit-line-clamp:2}}.card-grid.svelte-150pdda{display:grid;gap:1.25rem;grid-template-columns:repeat(1,minmax(0,1fr));width:100%}@media(min-width:640px){.card-grid.svelte-150pdda{grid-template-columns:repeat(2,minmax(0,1fr))}}@media(min-width:1280px){.card-grid.svelte-150pdda{gap:1.5rem;grid-template-columns:repeat(3,minmax(0,1fr))}}</style></head> <body class="text-page overflow-x-hidden antialiased dark:text-neutral-50 dark:bg-dark dark:bg-darkmode-900"> <noscript> <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MFCR2NV" height="0" width="0" style="display:none;visibility:hidden"></iframe> </noscript> <header class="sticky top-0 z-[999] h-16 bg-darkmode-900 xl:h-20 astro-odqmdjqa"> <div class="inner astro-odqmdjqa"> <a href="/" class="w-fit astro-odqmdjqa"> <span class="sr-only astro-odqmdjqa">Home</span> <img src="/_astro/offsec.BneoPeSq_Z1jF970.svg" alt="OffSec" loading="lazy" decoding="async" fetchpriority="auto" width="529" height="128" class="h-9 w-auto xl:h-12 astro-odqmdjqa"> </a> <div class="items-wrapper astro-odqmdjqa"> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async e=>{await(await e())()};(self.Astro||(self.Astro={})).load=e,window.dispatchEvent(new Event("astro:load"))})()</script><script>(()=>{var t=Object.defineProperty,n=(e,n,s)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,e=(e,t,s)=>n(e,typeof t!="symbol"?t+"":t,s);{let n={0:e=>o(e),1:e=>t(e),2:e=>new RegExp(e),3:e=>new Date(e),4:e=>new Map(t(e)),5:e=>new Set(t(e)),6:e=>BigInt(e),7:e=>new URL(e),8:e=>new Uint8Array(e),9:e=>new Uint16Array(e),10:e=>new Uint32Array(e),11:e=>1/0*e},s=e=>{let[t,s]=e;return t in n?n[t](s):void 0},t=e=>e.map(s),o=e=>typeof e!="object"||e===null?e:Object.fromEntries(Object.entries(e).map(([e,t])=>[e,s(t)]));class i extends HTMLElement{constructor(){super(...arguments),e(this,"Component"),e(this,"hydrator"),e(this,"hydrate",async()=>{var t;if(!this.hydrator||!this.isConnected)return;let n=(t=this.parentElement)==null?void 0:t.closest("astro-island[ssr]");if(n){n.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let i=this.querySelectorAll("astro-slot"),e={},a=this.querySelectorAll("template[data-astro-template]");for(let t of a){let n=t.closest(this.tagName);n!=null&&n.isSameNode(this)&&(e[t.getAttribute("data-astro-template")||"default"]=t.innerHTML,t.remove())}for(let t of i){let n=t.closest(this.tagName);n!=null&&n.isSameNode(this)&&(e[t.getAttribute("name")||"default"]=t.innerHTML)}let s;try{s=this.hasAttribute("props")?o(JSON.parse(this.getAttribute("props"))):{}}catch(e){let t=this.getAttribute("component-url")||"<unknown>",n=this.getAttribute("component-export");throw n&&(t+=` (export ${n})`),console.error(`[hydrate] Error parsing props for component ${t}`,this.getAttribute("props"),e),e}let r;await this.hydrator(this)(this.Component,s,e,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))}),e(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),t.disconnect(),this.childrenConnectedCallback()},t=new MutationObserver(()=>{var t;((t=this.lastChild)==null?void 0:t.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});t.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let t=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(Astro[e]===void 0){window.addEventListener(`astro:${e}`,()=>this.start(),{once:!0});return}try{await Astro[e](async()=>{let t=this.getAttribute("renderer-url"),[n,{default:s}]=await Promise.all([import(this.getAttribute("component-url")),t?import(t):()=>()=>{}]),e=this.getAttribute("component-export")||"default";if(e.includes(".")){this.Component=n;for(let t of e.split("."))this.Component=this.Component[t]}else this.Component=n[e];return this.hydrator=s,this.hydrate},t,this)}catch(e){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,e)}}attributeChangedCallback(){this.hydrate()}}e(i,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",i)}})()</script><astro-island uid="Z26zBv0" component-url="/_astro/TopItems.D72t_kAD.js" component-export="default" renderer-url="/_astro/client.svelte.CLqunBb9.js" props='{"class":[0,"astro-odqmdjqa"]}' ssr client="load" opts='{"name":"TopItems","value":true}' await-children><ul class="top-items svelte-1a0fu0j"><li><button type="button" class="top-item svelte-fxyybi">Learn</button></li><li><button type="button" class="top-item svelte-fxyybi">Individuals</button></li><li><button type="button" class="top-item svelte-fxyybi">Teams</button></li><li><button type="button" class="top-item svelte-fxyybi">Kali & Community</button></li><li><button type="button" class="top-item svelte-fxyybi">Resources</button></li> <li><a href="/pricing/" class="pricing plausible-event-name=Nav+Click plausible-event-position=top+nav plausible-event-title=Pricing svelte-1a0fu0j">Pricing</a></li></ul></astro-island> </div> <noscript> <style>.items-wrapper{display:none}</style> <p class="os-body-sm text-center astro-odqmdjqa">Please enable JavaScript.</p> </noscript> <astro-island uid="2m4cDA" component-url="/_astro/MenuButton.BtLjS2Ln.js" component-export="default" renderer-url="/_astro/client.svelte.CLqunBb9.js" props='{"class":[0,"astro-odqmdjqa"]}' ssr client="load" opts='{"name":"MenuButton","value":true}' await-children><button type="button" class="burger svelte-etlqy9"><p class="sr-only">Toggle menu</p> <span class="svelte-etlqy9"></span> <span class="svelte-etlqy9"></span> <span class="svelte-etlqy9"></span></button></astro-island> <div class="end-items astro-odqmdjqa"> <a href="/pre-registration/" class="plausible-event-name=Nav+Click plausible-event-position=top+nav plausible-event-title=Enroll+now btn btn-sm btn-primary h-[2.125rem] w-[7.5rem] astro-odqmdjqa">
Enroll now
</a> <a href="https://portal.offsec.com/sign-in/" class="btn btn-sm btn-secondary h-[2.125rem] w-[7.5rem] astro-odqmdjqa">
Sign in
</a> <a href="/search/" class="astro-odqmdjqa"> <span class="sr-only astro-odqmdjqa">Search</span> <span class="astro-odqmdjqa"><svg width="34" height="34" viewBox="0 0 34 34" fill="none"><path d="M16 24c4.4183.0 8-3.5817 8-8 0-4.4183-3.5817-8-8-8-4.4183.0-8 3.5817-8 8 0 4.4183 3.5817 8 8 8z" stroke="#fbfafb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M26.0001 26.0004l-4.35-4.35" stroke="#fbfafb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span> </a> <a href="/contact-us/" class="astro-odqmdjqa"> <span class="sr-only astro-odqmdjqa">Contact us</span> <span class="astro-odqmdjqa"><svg width="34" height="34" viewBox="0 0 34 34" fill="none"><path d="M26 16.5C26.0034 17.8199 25.6951 19.1219 25.1 20.3c-.7056 1.4118-1.7902 2.5992-3.1326 3.4293C20.6251 24.5594 19.0782 24.9994 17.5 25 16.1801 25.0035 14.8781 24.6951 13.7 24.1L8 26l1.9-5.7c-.59507-1.1781-.90344-2.4801-.9-3.8C9.00061 14.9218 9.44061 13.3749 10.2707 12.0326c.8301-1.3423 2.0176-2.42702 3.4293-3.13259 1.1781-.59507 2.4801-.90344 3.8-.9H18C20.0843 8.115 22.053 8.99477 23.5291 10.4709 25.0052 11.947 25.885 13.9157 26 16v.5z" stroke="#fbfafb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span> </a> </div> </div> <astro-island uid="Z12ygIs" component-url="/_astro/Wrapper.DKVxbbLM.js" component-export="default" renderer-url="/_astro/client.svelte.CLqunBb9.js" props='{"class":[0,"astro-odqmdjqa"]}' ssr client="load" opts='{"name":"Wrapper","value":true}' await-children></astro-island> <astro-island uid="Z27q2km" component-url="/_astro/MobileWrapper.CMSsdRub.js" component-export="default" renderer-url="/_astro/client.svelte.CLqunBb9.js" props='{"class":[0,"astro-odqmdjqa"]}' ssr client="load" opts='{"name":"MobileWrapper","value":true}' await-children></astro-island> </header> <main id="body-main"> <div data-pagefind-body> <main data-pagefind-sort="tag, weight[data-weight]" data-weight="1" data-pagefind-meta="tag:Blog" class="astro-fic66esg"> <article class="astro-fic66esg"> <section class="post-header astro-fic66esg"> <div class="wrapper mb-0 astro-hc4ydkeo"> <a href="/blog/" class="parent astro-hc4ydkeo">Blog</a> <p class="astro-hc4ydkeo">/</p> <p class="page-name astro-hc4ydkeo">IRQLs Close Encounters of the Rootkit Kind</p> </div> <section class="header-wrapper astro-tligyyw4"> <img src="https://www.offsec.com/app/uploads/2022/03/IRQLs-Close-Encounters-of-the-Rootkit-Kind.png" alt="IRQLs-Close-Encounters-of-the-Rootkit-Kind" loading="eager" class="post-img astro-tligyyw4" width="1030" height="539" data-pagefind-meta="image[src], image_alt[alt]"> <div class="row astro-tligyyw4" data-pagefind-ignore="all"> <a href="/blog/category/research-tutorials/" class="category-tag hover:bg-purple-300/40 astro-qijqfjm2">Research & Tutorials</a> <p class="astro-tligyyw4">Apr 11, 2022</p> </div> <div class="copy astro-tligyyw4"> <h1 data-pagefind-meta="title" class="astro-tligyyw4">IRQLs Close Encounters of the Rootkit Kind</h1> <p class="astro-tligyyw4">Content developer Matteo Malvica walks us through IRQLs and how hardware interrupts can be abused.</p> </div> <div class="row astro-tligyyw4"> <p class="author astro-tligyyw4"> <span class="astro-tligyyw4"> <img src="/_astro/byline.ClrL6n6g_1X3xi2.svg" alt="OffSec Team" loading="lazy" decoding="async" fetchpriority="auto" width="32" height="32" class="h-6 w-6 astro-tligyyw4"> </span> <span class="astro-tligyyw4">OffSec Team</span> </p> <p class="author astro-tligyyw4" data-pagefind-ignore="all"> <span class="astro-tligyyw4"> <svg width="18" height="18" class="astro-tligyyw4" data-icon="custom/watch"><symbol id="ai:local:custom/watch" viewBox="0 0 64 64"><g fill="none"><path d="M31.9999 50.6666C42.3092 50.6666 50.6666 42.3092 50.6666 31.9999 50.6666 21.6906 42.3092 13.3333 31.9999 13.3333c-10.3093.0-18.6666 8.3573-18.6666 18.6666.0 10.3093 8.3573 18.6667 18.6666 18.6667z" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M32 24v8l4 4" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M44.0268 46.2668 43.0934 56.4801C42.9733 57.8098 42.3588 59.0461 41.3713 59.9447 40.3838 60.8433 39.0952 61.3389 37.7601 61.3335H26.2134C24.8783 61.3389 23.5897 60.8433 22.6023 59.9447 21.6148 59.0461 21.0003 57.8098 20.8801 56.4801L19.9468 46.2668M19.9734 17.7335 20.9068 7.52012C21.0265 6.195 21.6373 4.96248 22.6191 4.06453c.9818-.89795 2.2638-1.39648 3.5943-1.39774h11.6C39.1486 2.66137 40.4372 3.15692 41.4246 4.05552 42.4121 4.95412 43.0266 6.19041 43.1468 7.52012L44.0801 17.7335" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></g></symbol><use href="#ai:local:custom/watch"/></svg> </span> <span class="astro-tligyyw4">0 min read</span> </p> </div> </section> </section> <section id="post-content" class="prose prose-invert"> <div>
<h2>IRQL Overview</h2>
<p>Present since the early stages of Windows NT, an <em>Interrupt Request Level</em> (IRQL) defines the current hardware priority at which a CPU runs at any given time. On a multi-processor architecture, each CPU can hold a different and independent IRQL value, which is stored inside the <strong>CR8</strong> register. We should keep this in mind as we are going to build our lab examples on a quad-core system.</p>
<p>Every hardware interrupt is mapped to a specific request level as depicted below.</p>
</div>
<div>
<h2 class="text-center">IRQL Values</h2>
<div style="width:400px;margin:25px;background:#fff;padding:20px;border-radius:6px;box-shadow:3px 8px 15px rgba(0,0,0,.45)">
<h2 style="font-size:2rem" class="text-center">x86</h2>
<table style="border:none;border-collapse:separate;margin:auto">
<tr>
<td style="background:#fff">31</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">High</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">30</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Power Fail</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">29</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Inter-Processor Interrupt</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">28</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Clock</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">27</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Profile/Synch</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;&nbsp;</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Device[n]</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;&nbsp;</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">.</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;5</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">CMCI</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;&nbsp;</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">.</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;&nbsp;</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Device[1]</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;2</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Dispatch/DPC</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;1</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">APC</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;0</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Passive/Low</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
</table></div>
<div style="width:400px;margin:25px;background:#fff;padding:20px;border-radius:6px;box-shadow:3px 8px 15px rgba(0,0,0,.45)">
<h2 style="font-size:2rem" class="text-center">x64/ARM</h2>
<table style="border:none;border-collapse:separate;margin:auto">
<tr>
<td style="background:#fff">15</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">High/Profile</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">14</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Inter-Processor Interrupt</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">13</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Clock</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">12</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Synch</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;&nbsp;</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Device[n]</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;&nbsp;</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">.</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;&nbsp;</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">.</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;&nbsp;</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Device[1]</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;2</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Dispatch/DPC</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;1</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">APC</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="background:#fff">&nbsp;0</td>
<td style="border:solid #000 1px;text-align:center;width:350px;background:#ebf5fb">Passive/Low</td>
<td style="background:#fff">&nbsp;&nbsp;</td>
</tr>
</table></div>
</div>
<div>
<p>A CPU is interrupted from completing its current task only when it receives an interrupt that is above the current IRQL value. The current running thread is responsible for handling these interrupts, which saves the current CPU state and then processes the <em>Interrupt Service Routine</em> (ISR) mapped to the incoming IRQL. Each interrupt routine is mapped inside the <em>Interrupt Description Table</em> (IDT), whose pointer is stored inside the <em>idtr</em> register. From the debugger, the IDT can be inspected through the <strong>!idt</strong> command, which automatically resolves pointers symbols and other details.</p>
<pre>kd&gt; !idt

Dumping IDT: fffff8015e262000 

00:	fffff8015b81fb00 nt!KiDivideErrorFault
01:	fffff8015b81fe40 nt!KiDebugTrapOrFault	Stack = 0xFFFFF8015E2A0000
02:	fffff8015b820340 nt!KiNmiInterrupt	Stack = 0xFFFFF8015E292000
03:	fffff8015b820800 nt!KiBreakpointTrap
04:	fffff8015b820b40 nt!KiOverflowTrap
05:	fffff8015b820e80 nt!KiBoundFault
06:	fffff8015b8213c0 nt!KiInvalidOpcodeFault
07:	fffff8015b8218c0 nt!KiNpxNotAvailableFault
08:	fffff8015b821bc0 nt!KiDoubleFaultAbort	Stack = 0xFFFFF8015E28B000
09:	fffff8015b821ec0 nt!KiNpxSegmentOverrunAbort
0a:	fffff8015b8221c0 nt!KiInvalidTssFault
...
d1:	fffff8015b817f18 nt!HalpTimerClockInterrupt (KINTERRUPT fffff8015c1119a0)
</pre>
<p id="irqls_windbg1" class="listing">Retrieving IRQL entries</p>
<p>Notice that the interrupt at index <em>d1</em> is mapped to the CPU clock. We can verify if its IRQL indeed corresponds to the 13th value from the table above. To do so, we dump the CPU clock&#8217;s <em>KINTERRUPT</em> structure that we found earlier in the IDT.</p>
<pre>kd&gt; dt _KINTERRUPT fffff8015c1119a0 Irql
nt!_KINTERRUPT
   +0x05c Irql : 0xd ''
</pre>
<p>The KINTERRUPT is a crucial structure that stores information related to interrupt dispatching.</p>
<p>Now that we&#8217;ve briefly discussed IRQLs, let&#8217;s explore their role and<br>
duties as kernel synchronization mechanisms.</p>
<h2>Synchronization at IRQL â¥ 2</h2>
<p>When two or more threads need to access a shared kernel resource, they must agree on how to access the shared object in a synchronous way to eliminate the chances of corrupting it.</p>
<p>A <em>mutex</em> (from <em>Mutual Exclusion</em>) is one way to accomplish such synchronization between threads. When the first thread wants to access a <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/introduction-to-synchcritsection-routines" target="_blank" rel="nofollow noopener">Critical Section</a> (the shared portion of code), it acquires a lock on the mutex. Once the thread has completed its tasks, it releases the mutex&#8217;s lock and only at that moment can another thread acquire it and access the shared resource. In layman&#8217;s terms, a mutex is <em>protecting</em> the critical section from being accessed or modified by multiple threads at the same time.</p>
<p>Since the Windows system scheduler runs at <em>DISPATCH_LEVEL</em> (IRQL 2), mutexes cannot be adopted at a level above or equal to 2. This is due to the fact that any thread-synchronization mechanism requires the scheduler to take scheduling action on those threads and thus, having a thread running at the same IRQL of the scheduler will ultimately prevent the scheduler from even starting.</p>
<p>Now, the pressing question from a rootkit developer&#8217;s perspective: why do we even need a synchronization primitive at IRQL â¥ 2 if the scheduler is already taking care of everything at lower priorities? Rootkits and alike, often access and modify shared kernel resources in order to subvert system properties or just to simply be less conspicuous. The rootkit synchronization technique we are going to analyze in this blog post has its very effectiveness in running at IRQL DISPATCH_LEVEL, thus enabling the rootkit code to modify kernel structures without risking any system crash.</p>
<p>Albeit this technique has been originally presented in the well-known <a href="https://www.amazon.com/Rootkits-Subverting-Windows-Greg-Hoglund/dp/0321294319" target="_blank" rel="nofollow noopener">Hoglund/Butler book</a> from 2005, it&#8217;s still equally effective on present systems.</p>
<p>The code reference for this project is available on <a href="https://github.com/uf0o/rootkit-arsenal-guacamole/tree/main/projects/IRQL" target="_blank" rel="nofollow noopener">GitHub</a>. It&#8217;s an x64 version of Bill Blunden&#8217;s Rootkit Arsenal project driver that implements the Hoglund/Butler synchronization mechanism.</p>
<h2>Idling CPUs &#8211; DPCs to the Rescue</h2>
<p>The goal of our rootkit project is to access a shared kernel resource while making sure that no other threads running on any CPU are going to step on our toes. As mentioned earlier, we are not allowed to rely on mutexes to perform our synchronization routine, so we need to resort to another kernel mechanism: <em>Deferred Procedure Calls</em> (DPC).</p>
<p>DPCs are normally used whenever a high hardware interrupt wants to hold up some of its routine to the lower DISPATCH (2) level. In this way, DPCs allow drivers to down-prioritize less critical tasks to a lower IRQL level. Once initialized, DPCs are then enqueued on a per-CPU queue and executed when all the remaining higher IRQLs are finished.</p>
<p>One complementary feature of DPCs is that, after initializing the DPC structure with the <em>KeInitializeDpc</em> routine, we can specify the exact target CPU where the DPC is going to be executed with the <em>KeSetTargetProcessorDpc</em> function. The reason this is critically important will become clear shortly.</p>
<p>Now that we&#8217;re armed with a basic understanding of DPCs, let&#8217;s determine how they fit in our project. Here&#8217;s the overall approach we are going to implement as our custom DISPATCH-LEVEL mutex:</p>
<ol style="padding:30px">
<li>Increase the current CPU&#8217;s IRQL to DISPATCH_LEVEL.</li>
<li>Initialize and enqueue DPCs so we set other CPUs to DISPATCH_LEVEL and perform an infinite NOP loop.</li>
<li>The current CPU accesses the shared resource.</li>
<li>We tell DPCs running on the other CPUs to exit the loop.</li>
<li>We restore the current CPU&#8217;s IRQL</li>
</ol>
<p>This way, we are able to safely access the shared resource by forcing the remaining CPUs to do nothing and just sit on their metaphorical hands. We&#8217;re now going to dissect the relevant code portion for each of these steps, and finally verify our assumptions with the debugger.</p>
<h2>Inspecting the Code</h2>
<p>From a high-level perspective, we already know <em>what</em> to do, so let&#8217;s investigate <em>how</em>. We can start by inspecting the <em>DriverEntry</em> routine.</p>
<pre>C
NTSTATUS DriverEntry(IN PDRIVER_OBJECT pDriverObject, IN PUNICODE_STRING regPath)
{
	NTSTATUS ntStatus;
	KIRQL irql;
	PKDPC dpcPtr;
	DBG_TRACE("Driver Entry", "Establishing other DriverObject function pointers");
	(*pDriverObject).DriverUnload = Unload;

	DBG_TRACE("Driver Entry", "Raising IRQL");
	irql = RaiseIRQL();

	DBG_TRACE("Driver Entry", "Acquiring Lock");
	dpcPtr = AcquireLock();

	AccessResource();
	
	DBG_TRACE("Driver Entry", "Releasing Lock");
	ReleaseLock(dpcPtr);

	DBG_TRACE("Driver Entry", "Lowering IRQL");
	LowerIRQL(irql);
	return (STATUS_SUCCESS);

}
</pre>
<p id="irqls_driver1" class="listing">Inspecting DriverEntry code</p>
<p>In the first step of our routine, we increase the current process IRQL through the <em>RaiseIRQL</em> function.</p>
<pre>C
KIRQL RaiseIRQL()
{
	KIRQL curr;
	KIRQL prev;
	/* Get the current interrupt irql level */
	curr = KeGetCurrentIrql();
	prev = curr;

	if (curr &lt; DISPATCH_LEVEL)
	{
		KeRaiseIrql(DISPATCH_LEVEL, &amp;prev);
	}
	return (prev);
}
</pre>
<p>We first retrieve the current CPU&#8217;s IRQL level through the <em>KeGetCurrentIrql</em> function and, interestingly enough, this <em>ntoskrnl</em> routine comprises only two instructions.</p>
<p class="text-center"><img decoding="async" id="ida-01" src="https://www.offsec.com/app/uploads/2022/03/ida1.png" alt="Inspecting KeGetCurrentIrql in IDA Pro"></p>
<p>This proves what we just learned earlier&#8211;that the current CPU IRQL value is stored in the <em>cr8</em> register and is then placed in <em>RAX</em> as a return value.</p>
<p>As a next step, <em>RaiseIRQL</em> checks if the current IRQL value is lower than DISPATCH_LEVEL and if so, it raises it to that IRQL through the <em>KeRaiseIrql</em> function. Inside <em>ntoskrnl</em>, this function is mapped as <em>KfRaiseIrql</em> and performs the following:</p>
<p class="text-center"><img decoding="async" id="ida-02" src="https://www.offsec.com/app/uploads/2022/03/ida2.png" alt="IDA 2"></p>
<p>The top-most block provides the main functionality. In the first three instructions, the desired IRQL level is saved in <em>r11</em>. The current IRQL is then placed in <em>rax</em> as a return value and finally, the requested IRQL is placed in <em>cr8</em>. The other three blocks are just checking that the requested IRQL is not 1 (APC), and that the current IRQL and requested ones are not above 0xF (max allowed value).</p>
<p>If all these conditions are false, on the bottom right block, the undocumented <em>SchedulerAssist</em> value from the <a href="https://www.geoffchappell.com/studies/windows/km/ntoskrnl/inc/ntos/amd64_x/kprcb/index.htm" target="_blank" rel="nofollow noopener">KPRCB</a> is modified accordingly.</p>
<blockquote style="margin:50px auto 60px;max-width:700px">
<p class="h3" style="font-weight:400;font-size:1.5rem;text-transform:initial">As there is no explicit check in the function, if we were to pass a value higher than 0xf to <em>KeRaiseIrql</em>, we could incur a SYSTEM_THREAD_EXCEPTION_NOT_HANDLED bug-check due to a <em>privileged instruction</em> exception.</p>
</blockquote>
<p>Having raised the current CPU&#8217;s IRQL, it is now time to perform the same operation for the other remaining CPUs. This is accomplished with the help of the <em>AcquireLock</em> function and through the use of DPCs. Let&#8217;s analyze this routine by decoupling it by functionality.</p>
<pre>C
PKDPC AcquireLock()
{
...
	InterlockedAnd(&amp;LockAcquired, 0);
	InterlockedAnd(&amp;nCPUsLocked, 0);

	DBG_PRINT2("[AcquiredLock]: nCPUs=%un", KeNumberProcessors);

	dpcArray = (PKDPC)ExAllocatePoolWithTag(NonPagedPool,KeNumberProcessors * sizeof(KDPC), 0x0F11);
	if (dpcArray == NULL) { return(NULL); }

	cpuID = KeGetCurrentProcessorNumber();
	
	for (i = 0; i &lt; KeNumberProcessors; i++)
	{
		PKDPC dpcPtr = &amp;(dpcArray[i]);
	
		if (i != cpuID)
		{
			KeInitializeDpc(dpcPtr, lockRoutine, NULL);
			KeSetTargetProcessorDpc(dpcPtr, i);
			KeInsertQueueDpc(dpcPtr, NULL, NULL);
		}
	}

	nOtherCPUs = KeNumberProcessors - 1;
	InterlockedCompareExchange64(&amp;nCPUsLocked, nOtherCPUs, nOtherCPUs);

	while (nCPUsLocked != nOtherCPUs)
	{
		NOP_FUNC();
		InterlockedCompareExchange64(&amp;nCPUsLocked, nOtherCPUs, nOtherCPUs);
	}

	return (dpcArray);
}
</pre>
<p id="irqls_driver3" class="listing">The AcquireLock function</p>
<p>Before dealing with anything related to DPCs, we first need some sort of synchronization mechanism that tells us that all the CPU are running at DISPATCH_LEVEL along with a method to signal the other CPUs when to exit the infinite NOP loop.</p>
<p>According to MSDN, the <em>Interlocked</em> function family provides exactly what we want:</p>
<blockquote style="margin:50px auto 60px;max-width:700px">
<p class="h3" style="font-weight:400;font-size:1.5rem;text-transform:initial">The interlocked functions provide a simple mechanism for synchronizing access to a variable that is shared by multiple threads. This function is atomic with respect to calls to other interlocked functions.</p>
</blockquote>
<p>These functions are generated as <em>intrinsics</em> by the compiler, so that the CPU can force <a href="https://en.wikipedia.org/wiki/Memory_barrier" target="_blank" rel="nofollow noopener">memory barriers</a> to guarantee mutual exclusion and order of operation between threads.</p>
<p>To this end, we are going to use <em>LockAcquired</em> as a boolean-like variable to notify <em>lockRoutine</em> when to exit the loop. We&#8217;ll also use <em>nCPUsLocked</em> as a counter variable to atomically increment it on every CPU, via the <em>InterlockedIncrement64(&amp;nCPUsLocked)</em> statement.</p>
<p>As a next step, we can now take care of DPCs creation. We first need to allocate a kernel pool via <em>ExAllocatePoolWithTag</em> of the size of a KDPC multiplied by the number of the running CPUs.</p>
<p>We then run a for-loop where we initialize on every other CPU the DPC via the <em>KeInitializeDpc</em> function, providing the respective KDPC and the <em>lockRoutine</em> as a function to be executed by the scheduled DPC. Next, we tell which CPU has to run the DPC with a call to <em>KeSetTargetProcessorDpc</em> and we finally enqueue it with <em>KeInsertQueueDpc</em>.</p>
<p>Once the DPC is running on the given CPU, it will execute the <em>lockRoutine</em> function that we have passed as an argument during DPC initialization, which has the following structure.</p>
<pre>C
void lockRoutine
...
{
	// Atomically increase the value of nCPUsLocked, which means that another CPU enters the nop cycle */
	InterlockedIncrement64(&amp;nCPUsLocked);

	// spin NOP until LockAcquired flag is set ( i.e., by ReleaseLockO))
	while (InterlockedCompareExchange64(&amp;LockAcquired, 1, 1) == 0)
	{
		NOP_FUNC();
	}
	// Exit the NOP loop 
	InterlockedDecrement64(&amp;nCPUsLocked);
	return;
}
</pre>
<p id="irqls_driver4" class="listing">The lockRoutine function</p>
<p>First, <em>InterlockedIncrement64</em> is called, so that the <em>nCPUsLocked</em> variable that was previously set to zero is now incremented to one. Since this routine will be executed by every other CPU, the variable will be incremented by each one and ultimately reach the &#8220;total CPU-1&#8221; value, which will force the while-loop in the <em>AcquireLock</em> function to exit.</p>
<p>As a next step, <em>lockRoutine</em> employs the <em>InterlockedCompareExchange64</em> function to check if the value of <em>LockAcquired</em> is set to &#8220;0&#8221; or &#8220;1&#8221;. If it&#8217;s 0, it will enter a while-loop and execute the standby <em>NOP_FUNC</em> routine, defined in the project&#8217;s <strong>lib.asm</strong> resource.</p>
<p>The purpose of this routine is to run on each other CPU that has been already raised at DISPATCH_LEVEL so that will prevent the execution of any thread that might undermine our operations.</p>
<p>Having all the other CPUs but ours stuck on an infinite loop allows us to safely access the shared resource with the current IRQL value of DISPATCH_LEVEL.</p>
<p>Normally, the shared resource that a rootkit wants to modify would be some kind of kernel table or structure like the EPROCESS <em>ActiveProcessLinks</em>. For the sake of this blog post, we are just going to demonstrate it with the following routine.</p>
<pre>C
void AccessResource()
{
	int i = 0;
    int max = 1 * 1000000000;
	DBG_TRACE("Accessing Shared Resource");
	for (i = 0; i &lt; max ; i++)
	{
		SHARED_FUNC();
	}
	return;
}
</pre>
<p id="irqls_driver5" class="listing">The AccessResource function</p>
<p><em>AccessResource</em> will in turn execute the following purposely pointless <em>SHARED_FUNC</em> routine one million times.</p>
<pre>SHARED_FUNC PROC
    xchg rax, rbx
    xchg rbx, rax
    ret
SHARED_FUNC ENDP
END
</pre>
<p id="irqls_driver6" class="listing">Simulating access to the shared resource</p>
<p>Running the above instructions in this very large for-loop will effectively render the system unusable for a few seconds thus, as a moral of the story, the rootkit should be swift when accessing a shared resource in the kernel.</p>
<h2>Debugging the Rootkit</h2>
<p>In the debugger, we can now verify what we took for granted in the above code listings. If we place a breakpoint at the <em>AcquireLock</em> routine, we can inspect the KDPC as it gets initialized by <em>KeInitializeDpc</em>.</p>
<pre>Breakpoint 1 hit
IRQL!AcquireLock:
fffff806`1d6a1080 4883ec58        sub     rsp,58h
...
2: kd&gt; pct
IRQL!AcquireLock+0x127:
fffff806`1d6a11a7 ff156b0e0000    call    qword ptr [IRQL!_imp_KeInitializeDpc (fffff806`1d6a2018)]
2: kd&gt; u fffff8061d6a1470
</pre>
<p>The first parameter passed to the function is the empty KDPC structure.</p>
<pre>1: kd&gt; dt _KDPC ffffb289db9035b0
nt!_KDPC
   +0x000 TargetInfoAsUlong : 0
   +0x000 Type             : 0 ''
   +0x001 Importance       : 0 ''
   +0x002 Number           : 0
   +0x008 DpcListEntry     : _SINGLE_LIST_ENTRY
   +0x010 ProcessorHistory : 0
   +0x018 DeferredRoutine  : (null) 
   +0x020 DeferredContext  : (null) 
   +0x028 SystemArgument1  : (null) 
   +0x030 SystemArgument2  : (null) 
   +0x038 DpcData          : (null) 
</pre>
<p>The structure gets populated once the function returns,</p>
<pre>1: kd&gt; t
nt!KeInitializeDpc:
fffff806`160e3ac0 33c0            xor     eax,eax

1: kd&gt; pt
nt!KeInitializeDpc+0x18:
fffff806`160e3ad8 c3              ret

1: kd&gt; dt _KDPC ffffb289db9035b0
nt!_KDPC
   +0x000 TargetInfoAsUlong : 0x113
   +0x000 Type             : 0x13 ''
   +0x001 Importance       : 0x1 ''
   +0x002 Number           : 0
   +0x008 DpcListEntry     : _SINGLE_LIST_ENTRY
   +0x010 ProcessorHistory : 0
   +0x018 DeferredRoutine  : 0xfffff806`1d6b1470     void  IRQL!lockRoutine+0
   +0x020 DeferredContext  : (null) 
   +0x028 SystemArgument1  : (null) 
   +0x030 SystemArgument2  : (null) 
   +0x038 DpcData          : (null) 
</pre>
<p>The <em>DeferredRoutine</em> is our defined DPC routine, while the <em>Number</em> value refers to the target CPU where it is going to be executed, which gets populated once <em>KeSetTargetProcessorDpc</em> returns.</p>
<pre>1: kd&gt; dt _KDPC ffffb289db9038b0
nt!_KDPC
   +0x000 TargetInfoAsUlong : 0x5030113
   +0x000 Type             : 0x13 ''
   +0x001 Importance       : 0x1 ''
   +0x002 Number           : 0x503
   +0x008 DpcListEntry     : _SINGLE_LIST_ENTRY
   +0x010 ProcessorHistory : 0
   +0x018 DeferredRoutine  : 0xfffff806`1d6d1470     void  IRQL!lockRoutine+0
   +0x020 DeferredContext  : (null) 
   +0x028 SystemArgument1  : (null) 
   +0x030 SystemArgument2  : (null) 
   +0x038 DpcData          : (null)
</pre>
<p>The resulting value is the result of the constant 0x500 plus the CPU index.</p>
<blockquote style="margin:50px auto 60px;max-width:700px">
<p class="h3" style="font-weight:400;font-size:1.5rem;text-transform:initial">If the 0x500 value is added to the CPU index, <em>KeInsertQueueDpc</em> can infer that the user called <em>KeSetTargetProcessorDpc</em> to set the target CPU</p>
</blockquote>
<p>We can also verify the enqueued DPCs through the <strong>!dpcs</strong> command.</p>
<pre>2: kd&gt; !dpcs
CPU Type      KDPC       Function
 0: Normal  : 0xffffb289db903b50 0xfffff8061d701470 IRQL!lockRoutine

 1: Normal  : 0xffffb289db903b90 0xfffff8061d701470 IRQL!lockRoutine
</pre>
<blockquote style="margin:50px auto 60px;max-width:700px">
<p class="h3" style="font-weight:400;font-size:1.5rem;text-transform:initial">Note that since DPCs are processed quite fast, it&#8217;s not always trivial to catch them enqueued on all the CPUs.</p>
</blockquote>
<p>Nice, then we can now enable a breakpoint on <em>IRQL!NOP_FUNC</em> and continue execution.</p>
<pre>2: kd&gt; g
Breakpoint 7 hit
IRQL!NOP_FUNC:
fffff806`1d691000 90              nop

1: kd&gt; g
Breakpoint 7 hit
IRQL!NOP_FUNC:
fffff806`1d691000 90              nop

3: kd&gt; t
Breakpoint 7 hit
IRQL!NOP_FUNC:
fffff806`1d691000 90              nop
</pre>
<p>And we have proven that the NOP function is running on every other CPU, as intended.</p>
<p>As a final check, we can now verify that all the other CPUs are executing the NOP routine while we are accessing the share resource. Let&#8217;s break on <em>IRQL!AccessResource</em> and verify the IRQL level for all the CPUs.</p>
<pre>Breakpoint 6 hit
IRQL!AccessResource:
fffff806`1d691020 4883ec38        sub     rsp,38h
0: kd&gt; t
IRQL!AccessResource+0x4:
fffff806`1d691024 c744242000000000 mov     dword ptr [rsp+20h],0

0: kd&gt; !irql 0
Debugger saved IRQL for processor 0x0 -- 2 (DISPATCH_LEVEL)

0: kd&gt; !irql 1
Debugger saved IRQL for processor 0x1 -- 2 (DISPATCH_LEVEL)

0: kd&gt; !irql 2
Debugger saved IRQL for processor 0x2 -- 2 (DISPATCH_LEVEL)

0: kd&gt; !irql 3
Debugger saved IRQL for processor 0x3 -- 2 (DISPATCH_LEVEL)</pre>
<p>Interested in delving into vulnerability research, exploit development, reverse engineering, and operating system internals?Â  Explore the following Learning Paths and courses: <a href="https://www.offsec.com/learning/paths/exploit-development-essentials/" target="_blank" rel="noopener">Exploit Development Essentials</a>, <a href="https://www.offsec.com/courses/exp-301/" target="_blank" rel="noopener">EXP-301</a>, <a href="https://www.offsec.com/courses/exp-312/" target="_blank" rel="noopener">EXP-312</a>, and <a href="https://www.offsec.com/courses/exp-401/" target="_blank" rel="noopener">EXP-401</a>.</p>
</div>
<div>
<hr>
<h6>About the Author</h6>
<p><small><i>Matteo Malvica is a content developer at Offensive Security focusing on vulnerability research, exploit development, reverse engineering and operating system internals. Matteo enjoys learning new exploitation techniques and exploring novel EDR/AV bypass avenues.</i></small></p>
</div>
</section> <script type="module" src="/_astro/PostContent.astro_astro_type_script_index_0_lang.D7t5-_g4.js"></script> <div class="flex w-full flex-col gap-6 md:gap-12 astro-myp6ngex"> <div class="flex w-full justify-center sm:justify-end astro-myp6ngex"> <div class="wrapper astro-v5bxvwp7"> <p class="os-body-sm hidden font-semibold uppercase tracking-[0.025rem] md:block astro-v5bxvwp7">Share</p> <a href="mailto:?subject=IRQLs Close Encounters of the Rootkit Kind&#38;body=Content developer Matteo Malvica walks us through IRQLs and how hardware interrupts can be abused.%0Ahttps://www.offsec.com/blog/irqls-close-encounters/" target="_blank" rel="noopener noreferrer" aria-label="Share via email" class="social-share-btn"> <svg width="22" height="22" data-icon="social/email"><symbol id="ai:local:social/email" viewBox="0 0 24 24"><g fill="none"><path d="M4 4H20c1.1.0 2 .9 2 2V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6c0-1.1.9-2 2-2z" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/><path d="M22 6 12 13 2 6" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/></g></symbol><use href="#ai:local:social/email"/></svg> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.offsec.com/blog/irqls-close-encounters/" target="_blank" rel="noopener noreferrer" aria-label="Share on LinkedIn" class="social-share-btn"> <svg width="22" height="22" data-icon="social/linkedin"><symbol id="ai:local:social/linkedin" viewBox="0 0 24 24"><g fill="none"><path d="M7 10.75V17M7 7V7.0125M12 17V10.75M2 4.5c0-.66304.26339-1.29893.73223-1.76777S3.83696 2 4.5 2h15c.663.0 1.2989.26339 1.7678.73223C21.7366 3.20107 22 3.83696 22 4.5v15C22 20.163 21.7366 20.7989 21.2678 21.2678 20.7989 21.7366 20.163 22 19.5 22H4.5C3.83696 22 3.20107 21.7366 2.73223 21.2678 2.26339 20.7989 2 20.163 2 19.5V4.5z" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/><path d="M17 17V13.25C17 12.587 16.7366 11.9511 16.2678 11.4822 15.7989 11.0134 15.163 10.75 14.5 10.75S13.2011 11.0134 12.7322 11.4822C12.2634 11.9511 12 12.587 12 13.25" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/></g></symbol><use href="#ai:local:social/linkedin"/></svg> </a> <a href="https://twitter.com/intent/tweet?url=https://www.offsec.com/blog/irqls-close-encounters/&via=offsectraining" target="_blank" rel="noopener noreferrer" aria-label="Share on X" class="social-share-btn"> <svg width="22" height="22" data-icon="social/x"><symbol id="ai:local:social/x" viewBox="0 0 24 24"><g fill="none"><path d="M4 20l6.768-6.768m2.46-2.46L20 4M4 4 15.733 20H20L8.267 4H4z" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/></g></symbol><use href="#ai:local:social/x"/></svg> </a> <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fwww.offsec.com%2Fblog%2Firqls-close-encounters%2F&title=IRQLs Close Encounters of the Rootkit Kind" target="_blank" rel="noopener noreferrer" aria-label="Share on Reddit" class="social-share-btn"> <svg width="22" height="22" data-icon="social/reddit"><symbol id="ai:local:social/reddit" viewBox="0 0 24 24"><g fill="none"><path d="M6.5 13.375C6.5 13.7397 6.64487 14.0894 6.90273 14.3473 7.16059 14.6051 7.51033 14.75 7.875 14.75S8.58941 14.6051 8.84727 14.3473C9.10513 14.0894 9.25 13.7397 9.25 13.375S9.10513 12.6606 8.84727 12.4027C8.58941 12.1449 8.23967 12 7.875 12S7.16059 12.1449 6.90273 12.4027C6.64487 12.6606 6.5 13.0103 6.5 13.375zm8.3163 2.9391C14.2491 16.7609 13.1246 17.2422 12 17.2422S9.75089 16.7609 9.1837 16.3141C8.83013 16.0366 8.31696 16.0955 8.03705 16.4491 7.75714 16.8027 7.81853 17.3158 8.1721 17.5958 9.15915 18.3741 10.6618 18.875 12 18.875S14.8408 18.3741 15.8279 17.5958C15.9979 17.4616 16.1076 17.2654 16.1329 17.0504 16.1582 16.8354 16.0971 16.6191 15.9629 16.4491 15.8288 16.2791 15.6326 16.1694 15.4176 16.1441 15.2025 16.1188 14.9863 16.1799 14.8163 16.3141zM23 10.625c0-1.51987-1.2301-2.75-2.75-2.75-1.0337.0-1.9324.56964-2.4038 1.41429C16.4319 8.51585 14.7107 8.01741 12.8348 7.90201l1.6427-3.68549 3.1404.90602C17.9002 5.92299 18.6638 6.5 19.5625 6.5c1.1393.0 2.0625-.92321 2.0625-2.0625S20.7018 2.375 19.5625 2.375C18.7768 2.375 18.0942 2.81451 17.7455 3.46027L14.2467 2.44866C14.0574 2.39367 13.8545 2.40915 13.6758 2.49221 13.497 2.57528 13.3544 2.72031 13.2743 2.90045L11.0449 7.90692C9.21562 8.0346 7.53616 8.53058 6.15379 9.28683 5.91541 8.85854 5.56683 8.50178 5.14417 8.25354 4.72152 8.0053 4.24016 7.87461 3.75 7.875 2.23013 7.875 1 9.10513 1 10.625c0 1.1246.67522 2.0895 1.64018 2.5167C2.46585 13.6574 2.375 14.1975 2.375 14.75c0 3.796 4.30915 6.875 9.625 6.875 5.3158.0 9.625-3.079 9.625-6.875.0-.5549-.0932999999999993-1.0926-.2652-1.6083C22.3248 12.7145 23 11.7496 23 10.625zM19.5625 3.66406C19.6641 3.66406 19.7646 3.68407 19.8585 3.72294 19.9523 3.76181 20.0376 3.81878 20.1094 3.8906 20.1812 3.96242 20.2382 4.04768 20.2771 4.14152 20.3159 4.23536 20.3359 4.33593 20.3359 4.4375S20.3159 4.63964 20.2771 4.73348C20.2382 4.82732 20.1812 4.91258 20.1094 4.9844S19.9523 5.11319 19.8585 5.15206C19.7646 5.19093 19.6641 5.21094 19.5625 5.21094 19.3574 5.21094 19.1606 5.12945 19.0156 4.9844 18.8705 4.83936 18.7891 4.64263 18.7891 4.4375S18.8705 4.03564 19.0156 3.8906C19.1606 3.74555 19.3574 3.66406 19.5625 3.66406zM2.375 10.625C2.375 9.86629 2.99129 9.25 3.75 9.25 4.01048 9.2502 4.26554 9.32439 4.4855 9.46393 4.70545 9.60346 4.88124 9.8026 4.99241 10.0382c-.71942.5451-1.31362 1.1736-1.75558 1.8636-.25426-.1031-.47203-.2796-.62553-.507C2.4578 11.1674 2.37553 10.8994 2.375 10.625zM12 19.9922c-4.41473.0-7.99219-2.3473-7.99219-5.2422S7.58527 9.50781 12 9.50781c4.4147.0 7.9922 2.34729 7.9922 5.24219S16.4147 19.9922 12 19.9922zm8.7607-8.0904C20.3212 11.2118 19.7246 10.5833 19.0051 10.0382 19.2261 9.57411 19.7 9.25 20.2475 9.25 21.0063 9.25 21.6225 9.86629 21.6225 10.625 21.625 11.202 21.2665 11.698 20.7607 11.9018zM14.75 13.375C14.75 13.7397 14.8949 14.0894 15.1527 14.3473 15.4106 14.6051 15.7603 14.75 16.125 14.75S16.8394 14.6051 17.0973 14.3473C17.3551 14.0894 17.5 13.7397 17.5 13.375S17.3551 12.6606 17.0973 12.4027C16.8394 12.1449 16.4897 12 16.125 12S15.4106 12.1449 15.1527 12.4027C14.8949 12.6606 14.75 13.0103 14.75 13.375z" fill="currentcolor"/></g></symbol><use href="#ai:local:social/reddit"/></svg> </a> <button type="button" class="social-share-btn" id="copy-link"> <svg width="22" height="22" id="link" data-icon="social/link"><symbol id="ai:local:social/link" viewBox="0 0 24 24"><g fill="none"><path d="M10.1898 12.9053C10.5785 13.425 11.0744 13.855 11.6439 14.1661c.5694.3111 1.1992.4962 1.8465.5425C14.1377 14.755 14.7873 14.6616 15.3954 14.4348 16.0034 14.208 16.5555 13.853 17.0143 13.3941l2.7153-2.7153C20.554 9.82524 21.0101 8.68208 20.9998 7.4955 20.9895 6.30891 20.5135 5.17385 19.6745 4.33478 18.8354 3.49571 17.7003 3.01976 16.5138 3.00945c-1.1866-.01031-2.3298.44584-3.1833 1.2702L11.7737 5.82739" stroke="currentcolor" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/><path d="M13.8102 11.0946C13.4215 10.575 12.9256 10.145 12.3561 9.83386c-.5695-.31113-1.1992-.49616-1.8465-.54251C9.86232 9.24499 9.21264 9.33838 8.60463 9.56519 7.99661 9.792 7.44449 10.1469 6.9857 10.6059L4.27037 13.3212c-.82436.8535-1.28051 1.9967-1.2702 3.1833.01031 1.1866.48626 2.3216 1.32533 3.1607C5.16457 20.5043 6.29964 20.9802 7.48622 20.9905S9.81596 20.5447 10.6695 19.7203l1.5477-1.5477" stroke="currentcolor" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/></g></symbol><use href="#ai:local:social/link"/></svg> <svg width="22" height="22" id="copied" class="hidden" data-icon="social/copied"><symbol id="ai:local:social/copied" viewBox="0 0 24 24"><g fill="none"><path d="M17.4 6.82471 7.50001 16.7247 3 12.2247" stroke="#fbfafb" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/><path d="M21 10.4248l-6.75 6.75-1.35-1.35" stroke="#fbfafb" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/></g></symbol><use href="#ai:local:social/copied"/></svg> <svg width="22" height="22" id="copy-error" class="hidden" data-icon="social/error"><symbol id="ai:local:social/error" viewBox="0 0 24 24"><g fill="none"><path d="M12 21c4.9706.0 9-4.0294 9-9 0-4.97056-4.0294-9-9-9-4.97056.0-9 4.02944-9 9 0 4.9706 4.02944 9 9 9z" stroke="#fbfafb" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/><path d="M14.7 9.30029 9.29999 14.7003" stroke="#fbfafb" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/><path d="M9.29999 9.30029 14.7 14.7003" stroke="#fbfafb" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/></g></symbol><use href="#ai:local:social/error"/></svg> </button> <script type="module">const n=document.getElementById("copy-link"),e=document.getElementById("link"),t=document.getElementById("copied"),d=document.getElementById("copy-error"),s=window.location.href,c=async()=>{try{await navigator.clipboard.writeText(s),e?.classList.add("hidden"),t?.classList.remove("hidden"),setTimeout(()=>{t?.classList.add("hidden"),e?.classList.remove("hidden")},10)}catch{e?.classList.add("hidden"),d?.classList.remove("hidden"),setTimeout(()=>{d?.classList.add("hidden"),e?.classList.remove("hidden")},10)}};n?.addEventListener("click",c)</script> </div> </div> <div class="gradient-divide w-full astro-myp6ngex"></div> <div class="flex w-full items-center justify-between astro-myp6ngex"> <a href="/blog/what-is-xss/" aria-disabled="false" class="navigation nav-active astro-myp6ngex"> <svg width="1em" height="1em" class="h-6 w-6 sm:h-5 sm:w-5 astro-myp6ngex" data-icon="custom/arrow-left-2"><symbol id="ai:local:custom/arrow-left-2" viewBox="0 0 20 20"><g fill="none"><path d="M15.8332 10H4.1665" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M9.99984 15.8333 4.1665 9.99999 9.99984 4.16666" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></g></symbol><use href="#ai:local:custom/arrow-left-2"/></svg> <p class="hidden sm:flex astro-myp6ngex">Previous</p> </a> <a href="/blog/pandemic-lessons/" aria-disabled="false" class="navigation nav-active astro-myp6ngex"> <p class="hidden sm:flex astro-myp6ngex">Next</p> <svg width="1em" height="1em" viewBox="0 0 20 20" class="h-6 w-6 rotate-180 sm:h-5 sm:w-5 astro-myp6ngex" data-icon="custom/arrow-left-2"><use href="#ai:local:custom/arrow-left-2"/></svg> </a> </div> <section class="wrapper shadow bg-darkmode-700 xl:px-14 astro-5kfhnqst"> <div class="inner astro-5kfhnqst"> <img src="/_astro/signup.BrHOE7VC_ZU04gx.svg" alt="Stay in the know: Become an OffSec Insider" loading="lazy" decoding="async" fetchpriority="auto" width="175" height="176" class="w-[10.9375rem] shrink-0 astro-5kfhnqst"> <div class="w-full space-y-5 text-center md:text-left astro-5kfhnqst"> <div class="space-y-2 md:space-y-0.5 astro-5kfhnqst"> <h2 class="astro-5kfhnqst">Stay in the know: Become an OffSec Insider</h2> <p class="astro-5kfhnqst">Get the latest updates about resources, events & promotions from OffSec!</p> </div> <div class="banner__container svelte-ea2y26"><form class="form lg:gap-5 2xl:gap-7 max-w-[28.25rem] svelte-ea2y26"><input type="email" placeholder="Email address*" class="field svelte-ea2y26" required> <button type="submit" class="btn btn-sm btn-secondary w-full shrink-0 text-nowrap py-1.5 sm:w-fit sm:px-12 md:px-8">Submit</button></form> <p class="footer-legal svelte-ea2y26">By submitting this form, I agree to the processing of my personal data by OffSec as described
in the <a href="/legal-docs/#privacy-policy" class="text-teal-500">Privacy Policy</a>.</p> <div id="form-message"></div></div> </div> </div> </section> <section class="recent-posts mt-20 w-full astro-o2bx5zug" data-pagefind-ignore="all"> <h2 class="os-h2 mx-auto max-w-[42.5rem] text-balance text-center font-semibold max-w-full sm:text-left astro-o2bx5zug">Latest from OffSec</h2> <script>(()=>{var e=async e=>{await(await e())()};(self.Astro||(self.Astro={})).only=e,window.dispatchEvent(new Event("astro:only"))})()</script><astro-island uid="oIbwf" component-url="/_astro/ResourceCards.B0Bw7Hue.js" component-export="default" renderer-url="/_astro/client.svelte.CLqunBb9.js" props='{"cards":[1,[[0,{"image":[0,"https://www.offsec.com/app/uploads/2025/08/CVE-2025-29891-860x450.png"],"title":[0,"CVE-2025-29891 â Apache Camel Exploit via CAmelExecCommandArgs Header Injection"],"excerpt":[0,"Discover how CVE-2025-29891 impacts Apache Camel via CAmelExecCommandArgs header injection. Learn how attackers exploit this misconfiguration for remote code execution and how to secure your systems."],"href":[0,"/blog/cve-2025-29891/"],"date":[0,"2025-08-08T13:08:38"],"readingTime":[0,2],"category":[0,"Research & Tutorials"]}],[0,{"image":[0,"https://www.offsec.com/app/uploads/2025/07/CVE-2025-30208-860x450.png"],"title":[0,"CVE-2025-30208 â Vite Arbitrary File Read via @fs Path Traversal Bypass"],"excerpt":[0,"Discover CVE-2025-30208, a critical arbitrary file read vulnerability in the Vite development server. Learn how remote attackers exploit @fs URL handling to access sensitive files."],"href":[0,"/blog/cve-2025-30208/"],"date":[0,"2025-07-31T16:51:27"],"readingTime":[0,1],"category":[0,"Research & Tutorials"]}],[0,{"image":[0,"https://www.offsec.com/app/uploads/2025/07/Our-5-Top-Tips_Blog-Image-1200x628-1-860x450.png"],"title":[0,"Get Noticed: 5 Cybersecurity Job Hunt Tips"],"excerpt":[0,"If youâve already set your heart on your chosen career path, you might understand that getting noticed by the right employer isnât always straightforward.&amp;nbsp; When we speak with OffSec learners, many will say that getting the first job is the hardest part. Some candidates will spend 6â12 months job-hunting, applying to hundreds of roles with"],"href":[0,"/blog/get-noticed-5-cybersecurity-job-hunt-tips/"],"date":[0,"2025-07-31T16:51:16"],"readingTime":[0,5],"category":[0,"OffSec News"]}]]],"class":[0,"astro-o2bx5zug"]}' ssr client="only" opts='{"name":"ResourceCards","value":"svelte"}'></astro-island> <div class="flex flex-col items-center astro-o2bx5zug"> <a href="/blog/" class="btn btn-sm btn-primary px-8 py-1.5 astro-o2bx5zug">View all blogs</a> </div> </section> </div> </article> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-SkmBfuA2hqjzEVpmnMt/LINrjop3GKWqsuLSSB3e7iBmYK7JuWw4ldmmxwD9mdm2IRTTi0OxSAfEGvgEi0i2Kw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js" integrity="sha512-st608h+ZqzliahyzEpETxzU0f7z7a9acN6AFvYmHvpFhmcFuKT8a22TT5TpKpjDa3pt3Wv7Z3SdQBCBdDPhyWA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js" integrity="sha512-/kVH1uXuObC0iYgxxCKY41JdWOkKOxorFVmip+YVifKsJ4Au/87EisD1wty7vxN2kAhnWh6Yc8o/dSAXj6Oz7A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> </main> </div> </main> <footer data-pagefind-ignore="all" class="astro-scinlfmn"> <div class="footer-row astro-scinlfmn"> <div class="form-section astro-scinlfmn"> <astro-island uid="24KjVp" component-url="/_astro/NewsletterForm.CDtveV2j.js" component-export="default" renderer-url="/_astro/client.svelte.CLqunBb9.js" props='{"class":[0,"astro-scinlfmn"]}' ssr client="load" opts='{"name":"NewsletterForm","value":true}' await-children><div class="footer-wrapper svelte-ea2y26"><p class="footer-title svelte-ea2y26">Get the latest updates around resources, events & promotions from OffSec</p> <form class="footer-form svelte-ea2y26"><input type="email" placeholder="Email address*" class="field svelte-ea2y26" required> <button type="submit" class="btn btn-sm btn-secondary w-full sm:w-fit py-1.5 sm:px-7">Submit</button></form> <p class="footer-legal svelte-ea2y26">By submitting this form, I agree to the processing of my personal data by OffSec as described
in the <a href="/legal-docs/#privacy-policy" class="text-teal-500">Privacy Policy</a>.</p> <div id="form-message"></div></div></astro-island> </div> <div class="groups astro-scinlfmn"> <div class="wrapper astro-335gxfk3"> <p class="astro-335gxfk3"> <a href="/learning/" class="plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Learn </a> </p> <ul class="astro-335gxfk3"> <li class="astro-335gxfk3"> <a href="https://www.offsec.com/products/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Products </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/courses/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Courses + Certifications </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/labs/individual/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Proving Grounds </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/learning/paths/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Learning Paths </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/pricing/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Pricing </a> </li> </ul> </div> <div class="wrapper astro-335gxfk3"> <p class="astro-335gxfk3"> <a href="/organizations/" class="plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> For Organizations </a> </p> <ul class="astro-335gxfk3"> <li class="astro-335gxfk3"> <a href="https://www.offsec.com/organizations/cyber-ranges/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Cyber Ranges </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/learning/industry-frameworks/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Industry Frameworks </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/organizations/penetration-testing/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Pentesting Services </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/use-cases/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Use Cases </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/industry/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Industries </a> </li> </ul> </div> <div class="wrapper astro-335gxfk3"> <p class="astro-335gxfk3"> OffSec </p> <ul class="astro-335gxfk3"> <li class="astro-335gxfk3"> <a href="https://www.offsec.com/careers/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Careers </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/leadership-team/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Leadership Team </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/press-room/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Press Room </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/resources/product-updates/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Product Updates </a> </li><li class="astro-335gxfk3"> <a href="https://help.offsec.com/hc/en-us/?utm_source=offsec/" target="_blank" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Help Center </a> </li> </ul> </div> <div class="wrapper astro-335gxfk3"> <p class="astro-335gxfk3"> <a href="/community/" class="plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Community </a> </p> <ul class="astro-335gxfk3"> <li class="astro-335gxfk3"> <a href="https://www.offsec.com/community/ugc/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> User Generated Content </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/community/bug-bounty/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Bug Bounty Program </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/learning/stories/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Learner Stories </a> </li> </ul> </div> <div class="wrapper astro-335gxfk3"> <p class="astro-335gxfk3"> <a href="/resources/" class="plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Resources </a> </p> <ul class="astro-335gxfk3"> <li class="astro-335gxfk3"> <a href="https://www.offsec.com/blog/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Blog </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/cyberversity/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Cyberversity </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/cybersecurity-roles/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Cybersecurity Job Roles </a> </li> </ul> </div> <div class="wrapper astro-335gxfk3"> <p class="astro-335gxfk3"> Partners </p> <ul class="astro-335gxfk3"> <li class="astro-335gxfk3"> <a href="https://www.offsec.com/global-partners/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Global Partner Program </a> </li><li class="astro-335gxfk3"> <a href="https://www.offsec.com/organizations/public-sector/" target="_self" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Public Sector </a> </li><li class="astro-335gxfk3"> <a href="https://partnerportal.offsec.com/?utm_source=offsec/" target="_blank" class="link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-335gxfk3"> Partner Portal Login </a> </li> </ul> </div> </div> </div> <div class="wrapper astro-3tk3c6pi"> <div class="footer-row astro-3tk3c6pi"> <a href="/" aria-label="Home" class="logo astro-3tk3c6pi"> <img src="/_astro/offsec.BneoPeSq_Z1jF970.svg" alt="OffSec logo" loading="lazy" decoding="async" fetchpriority="auto" width="529" height="128" class="w-full astro-3tk3c6pi"> </a> <div class="socials astro-3tk3c6pi"> <a href="https://www.twitch.tv/offsecofficial" class="wrapper group astro-vbuaafef" aria-label="OffSec Twitch"> <p class="icon astro-vbuaafef"><svg viewBox="0 0 32 32" fill="none"><path d="M14.6667 14.6665V9.33317m6.6666 5.33333V9.33317M28 2.6665H4V23.9998h6.6667v5.3334L16 23.9998h6.6667L28 18.6665v-16z" stroke="currentcolor" stroke-width="2.25" stroke-linecap="round" stroke-linejoin="round"/></svg>
</p> </a> <a href="https://www.instagram.com/offsectraining/" class="wrapper group astro-vbuaafef" aria-label="OffSec Instagram"> <p class="icon astro-vbuaafef"><svg viewBox="0 0 32 32" fill="none"><path d="M22.666 2.6665H9.33269c-3.6819.0-6.66667 2.98477-6.66667 6.66667V22.6665c0 3.6819 2.98477 6.6667 6.66667 6.6667H22.666c3.6819.0 6.6667-2.9848 6.6667-6.6667V9.33317c0-3.6819-2.9848-6.66667-6.6667-6.66667z" stroke="currentcolor" stroke-width="2.25" stroke-linecap="round" stroke-linejoin="round"/><path d="M21.3336 15.1599C21.4981 16.2696 21.3086 17.4029 20.7919 18.3986 20.2753 19.3943 19.4578 20.2018 18.4558 20.7061c-1.0021.5044-2.1376.6799-3.2452.5017-1.1075-.1782-2.1307-.7011-2.9239-1.4943C11.4935 18.9202 10.9706 17.8971 10.7924 16.7895 10.6141 15.682 10.7897 14.5464 11.294 13.5444c.5044-1.002 1.3118-1.8195 2.3076-2.3362C14.5973 10.6916 15.7306 10.502 16.8403 10.6666c1.1319.1678 2.1798.6953 2.9889 1.5044C20.6383 12.9801 21.1657 14.028 21.3336 15.1599z" stroke="currentcolor" stroke-width="2.25" stroke-linecap="round" stroke-linejoin="round"/><path d="M23.332 8.6665H23.3453" stroke="currentcolor" stroke-width="2.25" stroke-linecap="round" stroke-linejoin="round"/></svg>
</p> </a> <a href="https://www.youtube.com/channel/UChYZsplz61SeG0olX6cMoAA" class="wrapper group astro-vbuaafef" aria-label="OffSec YouTube"> <p class="icon astro-vbuaafef"><svg viewBox="0 0 32 32" fill="none"><path d="M3.33334 22.6667c-.93143-4.3957-.93143-8.9377.0-13.33337.12239-.44638.35885-.85323.68614-1.18052C4.34678 7.82552 4.75362 7.58905 5.20001 7.46667c7.15129-1.18473 14.44869-1.18473 21.59999.0C27.2464 7.58905 27.6532 7.82552 27.9805 8.15281S28.5443 8.88695 28.6667 9.33333c.9314 4.39567.9314 8.93767.0 13.33337C28.5443 23.1131 28.3078 23.5199 27.9805 23.8472 27.6532 24.1745 27.2464 24.4109 26.8 24.5333c-7.1512 1.185-14.4487 1.185-21.59999.0C4.75362 24.4109 4.34678 24.1745 4.01948 23.8472 3.69219 23.5199 3.45573 23.1131 3.33334 22.6667z" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/><path d="M13.332 20l6.6667-4-6.6667-4v8z" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/></svg>
</p> </a> <a href="https://www.linkedin.com/company/offensive-security/" class="wrapper group astro-vbuaafef" aria-label="OffSec LinkedIn"> <p class="icon astro-vbuaafef"><svg viewBox="0 0 32 32" fill="none"><path d="M21.332 10.6665c2.1217.0 4.1566.8429 5.6569 2.3431 1.5003 1.5003 2.3431 3.5352 2.3431 5.6569v9.3333H23.9987V18.6665C23.9987 17.9593 23.7177 17.281 23.2176 16.7809S22.0393 15.9998 21.332 15.9998C20.6248 15.9998 19.9465 16.2808 19.4464 16.7809S18.6653 17.9593 18.6653 18.6665v9.3333H13.332V18.6665c0-2.1217.842899999999998-4.1566 2.3432-5.6569 1.5002-1.5002 3.5351-2.3431 5.6568-2.3431z" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/><path d="M7.99936 12H2.66602V28H7.99936V12z" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/><path d="M5.33269 7.99984c1.47276.0 2.66667-1.19391 2.66667-2.66667S6.80545 2.6665 5.33269 2.6665c-1.47276.0-2.66667 1.19391-2.66667 2.66667S3.85993 7.99984 5.33269 7.99984z" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/></svg>
</p> </a> <a href="https://www.facebook.com/offsec/" class="wrapper group astro-vbuaafef" aria-label="OffSec Facebook"> <p class="icon astro-vbuaafef"><svg viewBox="0 0 32 32" fill="none"><path d="M24.0007 2.6665h-4c-1.7681.0-3.4638.70238-4.7141 1.95263-1.2502 1.25024-1.9526 2.94593-1.9526 4.71404V13.3332H9.33398v5.3333H13.334V29.3332h5.3333V18.6665h4l1.3334-5.3333H18.6673V9.33317C18.6673 8.97955 18.8078 8.64041 19.0579 8.39036 19.3079 8.14031 19.6471 7.99984 20.0007 7.99984h4V2.6665z" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/></svg>
</p> </a> <a href="https://x.com/offsectraining/" class="wrapper group astro-vbuaafef" aria-label="OffSec Twitter"> <p class="icon astro-vbuaafef"><svg width="32" height="32" viewBox="0 0 32 32" fill="none"><path d="M22.3263 6l-5.5589 6.3908L11.9611 6H5l8.3174 10.9384L5.43443 26H8.80996l6.08414-6.9918L20.2113 26H27L18.3297 14.4718 25.6998 6H22.3263zm-1.184 17.9692L8.93946 7.92411H10.9454L23.0116 23.9692H21.1423z" fill="currentcolor"/></svg>
</p> </a> <a href="https://discord.com/invite/offsec" class="wrapper group astro-vbuaafef" aria-label="OffSec Discord"> <p class="icon astro-vbuaafef"><svg viewBox="0 0 32 32" fill="none"><path d="M10.6641 16.0003C10.6641 16.3539 10.8046 16.6931 11.0546 16.9431 11.3047 17.1932 11.6438 17.3337 11.9974 17.3337 12.3511 17.3337 12.6902 17.1932 12.9403 16.9431 13.1903 16.6931 13.3308 16.3539 13.3308 16.0003S13.1903 15.3076 12.9403 15.0575C12.6902 14.8075 12.3511 14.667 11.9974 14.667 11.6438 14.667 11.3047 14.8075 11.0546 15.0575 10.8046 15.3076 10.6641 15.6467 10.6641 16.0003zm8 0C18.6641 16.3539 18.8046 16.6931 19.0546 16.9431 19.3047 17.1932 19.6438 17.3337 19.9974 17.3337 20.3511 17.3337 20.6902 17.1932 20.9403 16.9431 21.1903 16.6931 21.3308 16.3539 21.3308 16.0003S21.1903 15.3076 20.9403 15.0575C20.6902 14.8075 20.3511 14.667 19.9974 14.667 19.6438 14.667 19.3047 14.8075 19.0546 15.0575 18.8046 15.3076 18.6641 15.6467 18.6641 16.0003z" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/><path d="M20.6653 22.6668c0 1.3334 2 4 2.6666 4 2 0 3.7774-2.2226 4.6667-4C28.8879 20.4442 28.6653 14.8895 25.9986 7.3335c-1.9427-1.35334-4-1.78667-6-2l-1.296 2.564c-1.7881-.30902-3.6159-.30902-5.404.0l-1.3-2.564c-1.99997.21333-4.05731.64666-5.99997 2-2.66667 7.556-2.88934 13.1107-2 15.3333.88933 1.7774 2.66666 4 4.66666 4 .66667.0 2.66661-2.6666 2.66661-4" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/><path d="M9.33203 22c4.66667 1.3333 8.66667 1.3333 13.33327.0" stroke="currentcolor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"/></svg>
</p> </a> </div> </div> <div class="footer-row gap-2 astro-3tk3c6pi"> <ul class="tiny-links astro-3tk3c6pi"> <li class="astro-3tk3c6pi"> <a href="https://www.offsec.com/contact-us/" target="_blank" class="tiny-link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-3tk3c6pi"> Feedback </a> </li><li class="astro-3tk3c6pi"> <a href="https://www.offsec.com/legal-docs/" target="_blank" class="tiny-link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-3tk3c6pi"> Legal </a> </li><li class="astro-3tk3c6pi"> <a href="https://trust.offsec.com/?utm_source=offsec/" target="_blank" class="tiny-link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-3tk3c6pi"> Trust & Compliance </a> </li><li class="astro-3tk3c6pi"> <a href="https://www.offsec.com/feed/" target="_blank" class="tiny-link plausible-event-name=Nav+Click plausible-event-position=footer+nav astro-3tk3c6pi"> RSS Feed </a> </li> </ul> <p class="notice astro-3tk3c6pi">Â© OffSec Services Limited 2025 All rights reserved</p> </div> </div> </footer> <script>(function(){const t="dark:only";function e(e,t,n){const s=typeof e=="string"?document.querySelectorAll(e):e;s&&s.length&&s.forEach(e=>{e.addEventListener(t,t=>n(t,e),!1)})}window.onload=function(){let n=window.scrollY,s=!0;e("[data-aw-toggle-color-scheme]","click",function(){if(t.endsWith(":only"))return;document.documentElement.classList.toggle("dark"),localStorage.theme=document.documentElement.classList.contains("dark")?"dark":"light"}),e("[data-aw-social-share]","click",function(e,t){const a=t.getAttribute("data-aw-social-share"),s=encodeURIComponent(t.getAttribute("data-aw-url")),o=encodeURIComponent(t.getAttribute("data-aw-text"));let n;switch(a){case"facebook":n=`https://www.facebook.com/sharer.php?u=${s}`;break;case"twitter":n=`https://x.com/intent/tweet?url=${s}&text=${o}`;break;case"linkedin":n=`https://www.linkedin.com/shareArticle?mini=true&url=${s}&title=${o}`;break;case"whatsapp":n=`https://wa.me/?text=${o}%20${s}`;break;case"mail":n=`mailto:?subject=%22${o}%22&body=${o}%20${s}`;break;default:return}const i=document.createElement("a");i.target="_blank",i.href=n,i.click()});function o(){const e=document.getElementById("header");n>60&&!e.classList.contains("scroll")?document.getElementById("header").classList.add("scroll"):n<=60&&e.classList.contains("scroll")&&document.getElementById("header").classList.remove("scroll"),s=!1}e([document],"scroll",function(){n=window.scrollY,s||(window.requestAnimationFrame(()=>{o()}),s=!0)})},window.onpageshow=function(){document.documentElement.classList.add("motion-safe:scroll-smooth")}})()</script> <script defer src="/astro-assets/scripts/balancetext.min.js" onload="balanceText()"></script> </body> </html>