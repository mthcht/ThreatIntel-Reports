<!doctype html>
<html xmlns:svg="//www.w3.org/2000/svg">
<head>
    <meta http-equiv="Content-Type"
          content="text/html; charset=UTF-8"/>
    <meta name="viewport"
          content="width=device-width,  maximum-initial-scale=1,scale=12.0, minimum-scale=.25, user-scalable=yes"/>

    <meta name="HOSTNAME" content="alvin">

    <link rel="alternate"
          href="https://www.pentestpartners.com"
          hreflang="en-gb"/>

    

    <link rel="shortcut icon"
          href="https://www.pentestpartners.com/content/themes/pentestpartners2019/faviconx.ico"/>
    <link rel="apple-touch-icon"
          href="https://www.pentestpartners.com/content/themes/pentestpartners2019/apple-touch-icon.png">
    <link rel="apple-touch-icon-precomposed"
          href="https://www.pentestpartners.com/content/themes/pentestpartners2019/apple-touch-icon-precomposed.png">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,400,700'
          rel='stylesheet'
          type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Source+Serif+Pro'
          rel='stylesheet'
          type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Source+Code+Pro'
          rel='stylesheet'
          type='text/css'>

    <link rel="stylesheet"
          href="https://www.pentestpartners.com/content/themes/pentestpartners2019/style.css"
          type="text/css"
          media="screen"/>
    <link rel="alternate"
          type="application/rss+xml"
          title="Pen Test Partners RSS Feed"
          href="https://www.pentestpartners.com/feed/"/>

<!-- Google Tag Manager -->
<script type="947ea80add6883039db1f04e-text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-5CQ6NHF5');</script>
<!-- End Google Tag Manager -->

	<script type="947ea80add6883039db1f04e-text/javascript" src="https://app.termly.io/resource-blocker/b342aaba-f883-4d89-a6fa-d7868e2ada8f?autoBlock=on">
			</script>	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
		<!-- All in One SEO 4.7.8 - aioseo.com -->
		<title>Cobalt Strike. Walkthrough for Red Teamers | Pen Test Partners</title>
	<meta name="description" content="What is Cobalt Strike? Raphael Mudge is the creator of Cobalt Strike (CS), around 2010 he released a tool titled Armitage, which is described by wikipedia as a graphical cyber-attack management for the Metasploit Project, to put this more bluntly, Armitage is a gui that allows you to easily navigate and use MSF. Fast forward" />
	<meta name="robots" content="max-image-preview:large" />
	<meta name="author" content="Neil Lines"/>
	<link rel="canonical" href="https://www.pentestpartners.com/security-blog/cobalt-strike-walkthrough-for-red-teamers/" />
	<meta name="generator" content="All in One SEO (AIOSEO) 4.7.8" />

		<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-099PKGM7MZ" type="947ea80add6883039db1f04e-text/javascript"></script>
<script type="947ea80add6883039db1f04e-text/javascript">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-099PKGM7MZ');
</script>
		<meta name="google" content="nositelinkssearchbox" />
		<script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"Article","@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#article","name":"Cobalt Strike. Walkthrough for Red Teamers | Pen Test Partners","headline":"Cobalt Strike. Walkthrough for Red Teamers","author":{"@id":"https:\/\/www.pentestpartners.com\/security-blog\/author\/neil-lines\/#author"},"publisher":{"@id":"https:\/\/www.pentestpartners.com\/#organization"},"image":{"@type":"ImageObject","url":"https:\/\/www.pentestpartners.com\/content\/uploads\/2019\/04\/cobalt-strike-banner.png","width":1000,"height":500},"datePublished":"2019-04-15T07:59:55+01:00","dateModified":"2022-06-07T12:05:52+01:00","inLanguage":"en-GB","mainEntityOfPage":{"@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#webpage"},"isPartOf":{"@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#webpage"},"articleSection":"Red Teaming, Security Blog"},{"@type":"BreadcrumbList","@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/www.pentestpartners.com\/#listItem","position":1,"name":"Home","item":"https:\/\/www.pentestpartners.com\/","nextItem":{"@type":"ListItem","@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#listItem","name":"Cobalt Strike. Walkthrough for Red Teamers"}},{"@type":"ListItem","@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#listItem","position":2,"name":"Cobalt Strike. Walkthrough for Red Teamers","previousItem":{"@type":"ListItem","@id":"https:\/\/www.pentestpartners.com\/#listItem","name":"Home"}}]},{"@type":"Organization","@id":"https:\/\/www.pentestpartners.com\/#organization","name":"Pen Test Partners","url":"https:\/\/www.pentestpartners.com\/"},{"@type":"Person","@id":"https:\/\/www.pentestpartners.com\/security-blog\/author\/neil-lines\/#author","url":"https:\/\/www.pentestpartners.com\/security-blog\/author\/neil-lines\/","name":"Neil Lines","image":{"@type":"ImageObject","@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/0ff7b8bfb9cbe10fde73b90d78230830?s=96&d=mm&r=g","width":96,"height":96,"caption":"Neil Lines"}},{"@type":"WebPage","@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#webpage","url":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/","name":"Cobalt Strike. Walkthrough for Red Teamers | Pen Test Partners","description":"What is Cobalt Strike? Raphael Mudge is the creator of Cobalt Strike (CS), around 2010 he released a tool titled Armitage, which is described by wikipedia as a graphical cyber-attack management for the Metasploit Project, to put this more bluntly, Armitage is a gui that allows you to easily navigate and use MSF. Fast forward","inLanguage":"en-GB","isPartOf":{"@id":"https:\/\/www.pentestpartners.com\/#website"},"breadcrumb":{"@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#breadcrumblist"},"author":{"@id":"https:\/\/www.pentestpartners.com\/security-blog\/author\/neil-lines\/#author"},"creator":{"@id":"https:\/\/www.pentestpartners.com\/security-blog\/author\/neil-lines\/#author"},"image":{"@type":"ImageObject","url":"https:\/\/www.pentestpartners.com\/content\/uploads\/2019\/04\/cobalt-strike-banner.png","@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#mainImage","width":1000,"height":500},"primaryImageOfPage":{"@id":"https:\/\/www.pentestpartners.com\/security-blog\/cobalt-strike-walkthrough-for-red-teamers\/#mainImage"},"datePublished":"2019-04-15T07:59:55+01:00","dateModified":"2022-06-07T12:05:52+01:00"},{"@type":"WebSite","@id":"https:\/\/www.pentestpartners.com\/#website","url":"https:\/\/www.pentestpartners.com\/","name":"Pen Test Partners","inLanguage":"en-GB","publisher":{"@id":"https:\/\/www.pentestpartners.com\/#organization"}}]}
		</script>
		<!-- All in One SEO -->

<link rel='dns-prefetch' href='//static.addtoany.com' />
<link rel='dns-prefetch' href='//www.pentestpartners.com' />
<link rel='dns-prefetch' href='//www.googletagmanager.com' />
<script type="947ea80add6883039db1f04e-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.pentestpartners.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=1a449c781f1a1d71f3e58b9784308f79"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://www.pentestpartners.com/wp-includes/css/dist/block-library/style.min.css?ver=1a449c781f1a1d71f3e58b9784308f79' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='rotatingtweets-css' href='https://www.pentestpartners.com/content/plugins/rotatingtweets/css/style.css?ver=1a449c781f1a1d71f3e58b9784308f79' type='text/css' media='all' />
<link rel='stylesheet' id='ptp-css-css' href='https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/main.css?id=98fbd4c463348d03427e&#038;ver=1a449c781f1a1d71f3e58b9784308f79' type='text/css' media='all' />
<link rel='stylesheet' id='wp-pagenavi-css' href='https://www.pentestpartners.com/content/plugins/wp-pagenavi/pagenavi-css.css?ver=2.70' type='text/css' media='all' />
<link rel='stylesheet' id='addtoany-css' href='https://www.pentestpartners.com/content/plugins/add-to-any/addtoany.min.css?ver=1.16' type='text/css' media='all' />
<link rel="https://api.w.org/" href="https://www.pentestpartners.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://www.pentestpartners.com/wp-json/wp/v2/posts/15032" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.pentestpartners.com/xmlrpc.php?rsd" />

<link rel='shortlink' href='https://www.pentestpartners.com/?p=15032' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://www.pentestpartners.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.pentestpartners.com%2Fsecurity-blog%2Fcobalt-strike-walkthrough-for-red-teamers%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://www.pentestpartners.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.pentestpartners.com%2Fsecurity-blog%2Fcobalt-strike-walkthrough-for-red-teamers%2F&#038;format=xml" />
<meta name="generator" content="Site Kit by Google 1.148.0" /><meta name="tec-api-version" content="v1"><meta name="tec-api-origin" content="https://www.pentestpartners.com"><link rel="alternate" href="https://www.pentestpartners.com/wp-json/tribe/events/v1/" /><script type="947ea80add6883039db1f04e-text/javascript" src="https://www.pentestpartners.com/content/plugins/jquery-updater/js/jquery-3.7.1.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="947ea80add6883039db1f04e-text/javascript" src="https://www.pentestpartners.com/content/plugins/jquery-updater/js/jquery-migrate-3.5.2.min.js?ver=3.5.2" id="jquery-migrate-js"></script>

<!-- Google Tag Manager snippet added by Site Kit -->
<script type="947ea80add6883039db1f04e-text/javascript">
/* <![CDATA[ */

			( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', 'GTM-5CQ6NHF5' );
			
/* ]]> */
</script>

<!-- End Google Tag Manager snippet added by Site Kit -->
<link rel="icon" href="https://www.pentestpartners.com/content/uploads/2017/11/cropped-PTPsiteIcon-32x32.png" sizes="32x32" />
<link rel="icon" href="https://www.pentestpartners.com/content/uploads/2017/11/cropped-PTPsiteIcon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.pentestpartners.com/content/uploads/2017/11/cropped-PTPsiteIcon-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.pentestpartners.com/content/uploads/2017/11/cropped-PTPsiteIcon-270x270.png" />


</head>


<body class="post-template-default single single-post postid-15032 single-format-standard wp-embed-responsive tribe-no-js">

<!-- Google Tag Manager (noscript) -->
<noscript>
<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5CQ6NHF5" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->

<header id="site-header">

    <div class="container">

        <div id="site-logo">
            <a href="https://www.pentestpartners.com">
                <div class="inner">
                    <img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-ptp.png"
                         alt="Pen Test Partners Logo">
                    <p id="strapline">Security consulting and testing services</p>
                </div>
            </a>
        </div>

        <div id="header-phone">
				<a href="tel:+442030950500" style="text-decoration: none; color : #a93545" >
            <div class="inner">
                <i class="fas fa-phone"></i> +44 20 3095 0500
            </div>
				<a href="tel:+16466932501" style="text-decoration: none; color : #a93545" >
            <div class="inner">
                <i class="fas fa-phone"></i> +1 646 693 2501
            </div>
				</a>
        </div>

        <div id="header-nav">

            <div class="inner">

				<ul id="menu-main" class="menu"><li id="menu-item-3403" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3403"><a href="https://www.pentestpartners.com/about-us/">About</a>
<ul class="sub-menu">
	<li id="menu-item-25845" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-25845"><a href="https://www.pentestpartners.com/about-us/ptp-in-the-usa/">PTP in the USA</a></li>
	<li id="menu-item-8901" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8901"><a href="https://www.pentestpartners.com/about-us/careers/">Careers</a></li>
	<li id="menu-item-24949" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24949"><a href="https://www.pentestpartners.com/our-vision-and-values/">Our Vision and Values</a></li>
	<li id="menu-item-3484" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3484"><a href="https://www.pentestpartners.com/about-us/in-the-news/">In the news</a></li>
	<li id="menu-item-23880" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23880"><a href="https://www.pentestpartners.com/about-us/environmental-statement/">Environmental Statement</a></li>
	<li id="menu-item-18243" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-18243"><a href="https://www.pentestpartners.com/about-us/vulnerability-disclosure-policy/">Vulnerability Disclosure Policy</a></li>
</ul>
</li>
<li id="menu-item-3404" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3404"><a href="https://www.pentestpartners.com/penetration-testing-services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-17288" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-17288"><a href="https://www.pentestpartners.com/penetration-testing-services/red-teaming/">Red Teaming</a></li>
	<li id="menu-item-23851" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23851"><a href="https://www.pentestpartners.com/penetration-testing-services/purple-teaming/">Purple Teaming</a></li>
	<li id="menu-item-3486" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3486"><a href="https://www.pentestpartners.com/penetration-testing-services/penetration-testing/">Penetration Testing</a></li>
	<li id="menu-item-23176" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23176"><a href="https://www.pentestpartners.com/penetration-testing-services/agile-environment-testing/">Agile Environment Testing</a></li>
	<li id="menu-item-17515" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-17515"><a href="https://www.pentestpartners.com/penetration-testing-services/aviation-cyber-security-testing/">Aviation Cyber Security Testing</a></li>
	<li id="menu-item-8926" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8926"><a href="https://www.pentestpartners.com/penetration-testing-services/automotive-and-iot-testing/">Automotive &#038; IoT Testing</a></li>
	<li id="menu-item-10522" class="services-icon maritime menu-item menu-item-type-post_type menu-item-object-page menu-item-10522"><a href="https://www.pentestpartners.com/penetration-testing-services/maritime-cyber-security-testing/">Maritime Cyber Security Testing</a></li>
	<li id="menu-item-21980" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21980"><a href="https://www.pentestpartners.com/penetration-testing-services/cloud-services-security/">Cloud Services Security</a></li>
	<li id="menu-item-21846" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21846"><a href="https://www.pentestpartners.com/devops-lifecycle-assurance/">DevOps Lifecycle Assurance</a></li>
	<li id="menu-item-3489" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3489"><a href="https://www.pentestpartners.com/penetration-testing-services/social-engineering/">Social Engineering</a></li>
	<li id="menu-item-11000" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11000"><a href="https://www.pentestpartners.com/penetration-testing-services/physical-security/">Physical Security</a></li>
	<li id="menu-item-3488" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3488"><a href="https://www.pentestpartners.com/penetration-testing-services/security-training/">Security Training</a></li>
	<li id="menu-item-8534" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8534"><a href="https://www.pentestpartners.com/penetration-testing-services/papa/">Papa – Proactive Advanced Password Auditor</a></li>
	<li id="menu-item-14716" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14716"><a href="https://www.pentestpartners.com/penetration-testing-services/ics-iiot-scada-security-testing/">ICS, IIoT, SCADA Security Testing</a></li>
	<li id="menu-item-3520" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3520"><a href="https://www.pentestpartners.com/penetration-testing-services/cbest-threat-intelligence-led-red-teaming/">CBEST Red Teaming</a></li>
	<li id="menu-item-26093" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-26093"><a href="https://www.pentestpartners.com/crest-owasp-verification-standard-ovs-program/">CREST OVS Mobile &#038; Apps</a></li>
	<li id="menu-item-23691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23691"><a href="https://www.pentestpartners.com/penetration-testing-services/tiber-eu-assessments/">TIBER-EU Assessments</a></li>
	<li id="menu-item-23633" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23633"><a href="https://www.pentestpartners.com/penetration-testing-services/crest-star-fs-assessments/">CREST STAR-FS</a></li>
	<li id="menu-item-3519" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3519"><a href="https://www.pentestpartners.com/penetration-testing-services/cyber-essentials-testing/">Cyber Essentials Testing</a></li>
	<li id="menu-item-4602" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4602"><a href="https://www.pentestpartners.com/penetration-testing-services/cyber-security-consulting/">Cyber Security Consulting</a></li>
	<li id="menu-item-16872" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-16872"><a href="https://www.pentestpartners.com/compromise-assessment/">Compromise Assessment</a></li>
	<li id="menu-item-16871" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-16871"><a href="https://www.pentestpartners.com/digital-forensics-services/">Digital Forensics Services</a></li>
	<li id="menu-item-17151" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-17151"><a href="https://www.pentestpartners.com/incident-response-services/">Incident Response Services</a></li>
	<li id="menu-item-16873" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-16873"><a href="https://www.pentestpartners.com/incident-response-retained-service/">Incident Response Retained Service</a></li>
	<li id="menu-item-16869" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-16869"><a href="https://www.pentestpartners.com/incident-response-policy-assessment-development/">Incident Response Policy Assessment &#038; Development</a></li>
	<li id="menu-item-25330" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-25330"><a href="https://www.pentestpartners.com/attack-surface-assessment/">Attack Surface Assessment</a></li>
</ul>
</li>
<li id="menu-item-5677" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5677"><a href="https://www.pentestpartners.com/events-and-speaking/">Events</a></li>
<li id="menu-item-8172" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-8172"><a href="https://www.pentestpartners.com/security-blog/">Security Blog</a></li>
<li id="menu-item-3529" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3529"><a href="https://www.pentestpartners.com/resources/hack-demo-videos/">Demo Videos</a></li>
<li id="menu-item-3407" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3407"><a href="https://www.pentestpartners.com/contact-us/">Contact Us</a></li>
</ul>
                <div id="search-icon"><i class="fas fa-search"></i></div>

                <div id="menu-icon"><i class="fas fa-bars"></i></div>

            </div>
        </div>

        <div id="search-bar">
            <form role="search"
                  method="get"
                  class="search-form"
                  action="https://www.pentestpartners.com/">
                <input type="search"
                       class="search-field"
                       placeholder="Your search"
                       value=""
                       name="s"
                       title="Search for:"/>
                <input type="submit"
                       title="Search now"
                       class="search-submit"
                       value="Go"/>
            </form>
        </div>

    </div>

</header>

<div id="main" >
    <div class="browser-upgrade">
		For the best user experience please upgrade your browser    </div>
    <div class="container">


    <section class="content group">

		
            <article id="page" class="single-post">

                <div class="intro group">

                    <div class="heading-panel">
                        <p class="category-label">Blog: Red Teaming</p>
                        <h1 class="page-heading">Cobalt Strike. Walkthrough for Red Teamers</h1>
                    </div>
                    <div class="meta" id="author_meta">
                        <div>
																					
                            <span class="author">Neil Lines</span>
                            <span class="date">15 Apr 2019</span>
                        </div>
                    </div>
                </div>


                <div class="editor">
					<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobalt-strike-header.png" fetchpriority="high" decoding="async" class="alignnone wp-image-15183" alt width="800" height="224" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobalt-strike-header.png 1000w, https://www.pentestpartners.com/content/uploads/2019/04/cobalt-strike-header-300x84.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobalt-strike-header-768x215.png 768w" sizes="(max-width: 800px) 100vw, 800px"><noscript><img fetchpriority="high" decoding="async" class="alignnone wp-image-15183" src="https://www.pentestpartners.com/content/uploads/2019/04/cobalt-strike-header.png" alt="" width="800" height="224" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobalt-strike-header.png 1000w, https://www.pentestpartners.com/content/uploads/2019/04/cobalt-strike-header-300x84.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobalt-strike-header-768x215.png 768w" sizes="(max-width: 800px) 100vw, 800px" /></noscript></p>
<h3>What is Cobalt Strike?</h3>
<p>Raphael Mudge is the creator of Cobalt Strike (CS), around 2010 he released a tool titled Armitage, which is described by wikipedia as a graphical cyber-attack management for the <a href="https://en.wikipedia.org/wiki/Metasploit_Project">Metasploit Project</a>, to put this more bluntly, Armitage is a gui that allows you to easily navigate and use MSF.</p>
<p>Fast forward to 2012 and Raphael released Armitage’s big brother: <strong>Cobalt Strike</strong>, what was initially perceived as an enhanced version of Armitage, would a few years later become regarded as one of the most used command and control or as it’s commonly referred to as a C2 in red teaming today.</p>
<p>Raphael is a legend in the industry, search for his name on YouTube alone, and you will find over 180+ videos. And he is someone I have personally looked up to in the sec world for many years.</p>
<p>Quick note, IT security did not invent the term red team or C2, we have borrowed these terms from the United States Army, which is referenced in 1999 as using the word C2 in a released field manual.</p>
<p>So, what’s this blog all about then? Well initially I thought it would be great to write a blog, showing people how to get a trial version of CS, install and test it out in your own lab, but I must admit I did start to waver half way through, and question why am I writing this, Raphael has released a YouTube video for nearly every function, problem, and question you may ever have with CS, the freely available support is second to none, but then I thought, well it’s nice to research and write something from a fresh prospective, and secondly from a more selfish point, repeating what we have learned helps ourselves to learn more. I will admit going back and testing with the trial version of CS has taught me more, and I hope this blogpost is also of use to others.</p>
<p>Right dull intro over, let’s get hacking!</p>
<p>Ingredients required for this recipe.</p>
<ul>
<li>1 x Trial copy of Cobalt Strike</li>
<li>1 x VMware or Virtualbox for the lab</li>
<li>1 x Copy of Kali</li>
<li>1 x Copy of Windows 7 or 10, both if you can afford the RAM</li>
</ul>
<p>The following ingredients can be sourced from the directly below links.</p>
<ul>
<li>Cobalt Strike Trial &#8211; https://trial.cobaltstrike.com/</li>
<li>Virtualbox &#8211; https://www.virtualbox.org/wiki/Downloads</li>
<li>Kali &#8211; https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-image-download/</li>
<li>Windows VM/VB Images &#8211; https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/</li>
</ul>
<h3>Index<a name="index"></a></h3>
<ul>
<li><a href="#howtostart">How to start</a></li>
<li><a href="#testingcsinalab">Testing CS in a lab</a></li>
<li><a href="#usefulbasiccscommands">Useful Basic CS Commands</a></li>
<li><a href="#tokillanimplant">To Kill an Implant</a></li>
<li><a href="#unicornandcobaltpayloads">Unicorn and Cobalt Payloads</a></li>
<li><a href="#malleableprofiles">Malleable Profiles</a></li>
<li><a href="#pivoting">Pivoting</a></li>
</ul>
<h3>How to start<a name="howtostart"></a></h3>
<p><a href="#index">Back To Index▲</a></p>
<p>To download your twenty one day CS trial browse the following link <a href="https://trial.cobaltstrike.com/">https://trial.cobaltstrike.com/</a> you are required to complete a form and submit a legitimate email address (unfortunately google, yahoo and other free mail providers are not accepted) you also need to provide a postal  address, for this I requirement I used my employers address.</p>
<p>Also worth noting, Raphael is a busy person, so don’t expect to submit your details and get a trial copy that second, as a reference I submitted for a trial copy and it took three days till I got an email with the download link.</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri-trial-email.png" decoding="async" class="alignnone wp-image-15107" alt width="824" height="667" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri-trial-email.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri-trial-email-300x243.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri-trial-email-768x622.png 768w" sizes="(max-width: 824px) 100vw, 824px"><noscript><img decoding="async" class="alignnone wp-image-15107" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri-trial-email.png" alt="" width="824" height="667" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri-trial-email.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri-trial-email-300x243.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri-trial-email-768x622.png 768w" sizes="(max-width: 824px) 100vw, 824px" /></noscript></p>
<p>So, once you receive your download link, what do you do? I will be honest the process following is so simple it will surprise you.</p>
<p>Click (or copy and paste the hyperlink to the download files, into your browser of choice) the hyperlink. You must then accept the end user licence, followed by choosing your download flavour.</p>
<p>This post is based on the Linux version, but I must admit the idea of running CS in Windows has caught my attention. I may write a follow-up covering that, but for now we&#8217;ll go with Linux:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri1.png" decoding="async" class="alignnone wp-image-15043" alt width="695" height="583" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri1.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri1-300x252.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri1-768x645.png 768w" sizes="(max-width: 695px) 100vw, 695px"><noscript><img decoding="async" class="alignnone wp-image-15043" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri1.png" alt="" width="695" height="583" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri1.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri1-300x252.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri1-768x645.png 768w" sizes="(max-width: 695px) 100vw, 695px" /></noscript></p>
<p>Following clicking “Download Cobalt Strike” now!” you will receive the following file in your selected download directory:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri2.png" loading="lazy" decoding="async" class="alignnone wp-image-15044" alt width="731" height="35" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri2.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri2-300x14.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri2-768x37.png 768w" sizes="auto, (max-width: 731px) 100vw, 731px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15044" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri2.png" alt="" width="731" height="35" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri2.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri2-300x14.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri2-768x37.png 768w" sizes="auto, (max-width: 731px) 100vw, 731px" /></noscript></p>
<p>Now, wove the compressed file over to Kali Linux:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri3.png" loading="lazy" decoding="async" class="alignnone wp-image-15045" alt width="768" height="112" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri3.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri3-300x44.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri3-768x112.png 768w" sizes="auto, (max-width: 768px) 100vw, 768px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15045" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri3.png" alt="" width="768" height="112" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri3.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri3-300x44.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri3-768x112.png 768w" sizes="auto, (max-width: 768px) 100vw, 768px" /></noscript></p>
<p>To access the contents of the compressed file, simply double click it, and after it open define your chosen location to extract the contents there:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri4.png" loading="lazy" decoding="async" class="alignnone wp-image-15046" alt width="601" height="191" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri4.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri4-300x95.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri4-768x244.png 768w" sizes="auto, (max-width: 601px) 100vw, 601px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15046" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri4.png" alt="" width="601" height="191" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri4.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri4-300x95.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri4-768x244.png 768w" sizes="auto, (max-width: 601px) 100vw, 601px" /></noscript></p>
<p>Following the extraction, you can then cd to the containing files via terminal.</p>
<pre>root@kali:~/Desktop# cd cobaltstrike/</pre>
<p>To view the contents of the directory run the ls command.</p>
<pre>root@kali:~/Desktop/cobaltstrike# ls
agscript  cobaltstrike      icon.jpg     peclone     releasenotes.txt  third-party  update.jar c2lint    cobaltstrike.jar  license.pdf  readme.txt  teamserver        update</pre>
<p>Here&#8217;s the contents of the extracted CS directory:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri5.png" loading="lazy" decoding="async" class="alignnone wp-image-15047" alt width="874" height="106" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri5.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri5-300x36.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri5-768x93.png 768w" sizes="auto, (max-width: 874px) 100vw, 874px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15047" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri5.png" alt="" width="874" height="106" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri5.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri5-300x36.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri5-768x93.png 768w" sizes="auto, (max-width: 874px) 100vw, 874px" /></noscript></p>
<p>The first requirement is to start the Cobalt team server, this is the C2 server were all compromised targets will beacon back to, and secondly it is where you also connect to for management and control of compromised targets.</p>
<p>To start your CS team server run the following command.</p>
<pre>root@kali:~/Desktop/cobaltstrike#./teamserver IP-address-of-your-server Your-selected-password</pre>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri6.png" loading="lazy" decoding="async" class="alignnone wp-image-15048" alt width="713" height="25" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri6.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri6-300x11.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri6-768x27.png 768w" sizes="auto, (max-width: 713px) 100vw, 713px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15048" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri6.png" alt="" width="713" height="25" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri6.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri6-300x11.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri6-768x27.png 768w" sizes="auto, (max-width: 713px) 100vw, 713px" /></noscript></p>
<p>The screenshot below shows an extract the CS team server been started for the first time, you will note that the trial is defined to twenty one days and that the EICAR string is added to any traffic sent via the malleable profile, the trial is for lab use only, with regards to malleable profiles, this will be detailed later in the blogpost.</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri7.png" loading="lazy" decoding="async" class="alignnone wp-image-15049" alt width="740" height="156" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri7.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri7-300x63.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri7-768x162.png 768w" sizes="auto, (max-width: 740px) 100vw, 740px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15049" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri7.png" alt="" width="740" height="156" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri7.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri7-300x63.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri7-768x162.png 768w" sizes="auto, (max-width: 740px) 100vw, 740px" /></noscript></p>
<p>Now you are now ready to start the CS client, which provides the user with GUI control to connect and manage their team server.</p>
<p>To start the CS client simply run</p>
<pre>root@kali:~/Desktop/cobaltstrike#./cobaltstrike</pre>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri8.png" loading="lazy" decoding="async" class="alignnone wp-image-15050" alt width="632" height="259" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri8.png 810w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri8-300x123.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri8-768x315.png 768w" sizes="auto, (max-width: 632px) 100vw, 632px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15050" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri8.png" alt="" width="632" height="259" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri8.png 810w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri8-300x123.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri8-768x315.png 768w" sizes="auto, (max-width: 632px) 100vw, 632px" /></noscript></p>
<p>Following click OK you will be prompted to create a connection profile, for the host IP address, you can type in loopback address or if the team server is not locally hosted type in an IP address. The port you can tweak and in real world it should be, you can add your own username but the default one of Neo is great, love the reference to Matrix! And finally, the corresponding password as defined when you started the team server:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri9.png" loading="lazy" decoding="async" class="alignnone wp-image-15051" alt width="516" height="230" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri9.png 766w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri9-300x134.png 300w" sizes="auto, (max-width: 516px) 100vw, 516px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15051" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri9.png" alt="" width="516" height="230" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri9.png 766w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri9-300x134.png 300w" sizes="auto, (max-width: 516px) 100vw, 516px" /></noscript></p>
<p>After hitting “Connect” for the first time you will be prompted to verify the hash, this references the hash created while starting the team server, check it matches, then click Yes:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri10.png" loading="lazy" decoding="async" class="alignnone wp-image-15052" alt width="590" height="153" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri10.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri10-300x78.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri10-768x199.png 768w" sizes="auto, (max-width: 590px) 100vw, 590px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15052" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri10.png" alt="" width="590" height="153" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri10.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri10-300x78.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri10-768x199.png 768w" sizes="auto, (max-width: 590px) 100vw, 590px" /></noscript></p>
<p>And that’s it from downloading to starting, you will now have a running trial version of Cobalt, no messing around, no installing stuff, its’ all very simple and clean:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri11.png" loading="lazy" decoding="async" class="alignnone wp-image-15053" alt width="703" height="363" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri11.png 936w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri11-300x155.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri11-768x396.png 768w" sizes="auto, (max-width: 703px) 100vw, 703px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15053" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri11.png" alt="" width="703" height="363" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri11.png 936w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri11-300x155.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri11-768x396.png 768w" sizes="auto, (max-width: 703px) 100vw, 703px" /></noscript></p>
<h3>Testing CS in a lab<a name="testingcsinalab"></a></h3>
<p><a href="#index">Back To Index▲</a></p>
<p>And now the games begin</p>
<p>So, you want to test CS out, so how do you do it? first off spin up a Windows VM you can opt for a Windows 7 or 10 host. This VM will become your target machine, which you will run CS payloads in.</p>
<p>I would recommend while your VM is downloading, spinning up, updating or whatever its doing, you should take a look at the taskbars on the top of you CS client GUI, click on the options, it’s a trial version so even if you brake it (Which I suspect you won’t, as its very stable), just start again.</p>
<p>Quick note &#8211; This would be a good point to take a snapshot of your kali VM or VB.</p>
<p><strong>Give me the shells!</strong></p>
<p>Yep I get it, you most likely just want to see the raining shells, right so let’s get to the fun part. To create your first payload, right click on Cobalt Strike top left, and select Listeners, this allows you to define, were your targets can dial back to:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri12.png" loading="lazy" decoding="async" class="alignnone wp-image-15054" alt width="462" height="205" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri12.png 806w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri12-300x133.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri12-768x341.png 768w" sizes="auto, (max-width: 462px) 100vw, 462px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15054" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri12.png" alt="" width="462" height="205" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri12.png 806w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri12-300x133.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri12-768x341.png 768w" sizes="auto, (max-width: 462px) 100vw, 462px" /></noscript></p>
<p>Clicking Listeners will prompt you to fill in your requirements for this new listener, add the IP address of your team server, required port and click save:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri13.png" loading="lazy" decoding="async" class="alignnone wp-image-15055" alt width="344" height="248" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri13.png 648w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri13-300x216.png 300w" sizes="auto, (max-width: 344px) 100vw, 344px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15055" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri13.png" alt="" width="344" height="248" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri13.png 648w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri13-300x216.png 300w" sizes="auto, (max-width: 344px) 100vw, 344px" /></noscript></p>
<p>If you wish to Wireshark, your traffic I would recommend you opt for port 80 HTTP over HTTPS which by default will encrypt all your traffic flows.</p>
<p>While setting up the listener you will be prompted for a domain, for internal lab use you can use an IP address, while on an offensive engagement you would replace your defined IP address with a domain of choice:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri14.png" loading="lazy" decoding="async" class="alignnone wp-image-15056" alt width="451" height="161" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri14.png 800w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri14-300x107.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri14-768x275.png 768w" sizes="auto, (max-width: 451px) 100vw, 451px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15056" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri14.png" alt="" width="451" height="161" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri14.png 800w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri14-300x107.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri14-768x275.png 768w" sizes="auto, (max-width: 451px) 100vw, 451px" /></noscript></p>
<p>After clicking OK and saving your listener parameters you will see a tab at the bottom open, which details your listener settings:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri15.png" loading="lazy" decoding="async" class="alignnone wp-image-15057" alt width="663" height="98" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri15.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri15-300x44.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri15-768x114.png 768w" sizes="auto, (max-width: 663px) 100vw, 663px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15057" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri15.png" alt="" width="663" height="98" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri15.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri15-300x44.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri15-768x114.png 768w" sizes="auto, (max-width: 663px) 100vw, 663px" /></noscript></p>
<p>You are now ready to create the payload. CS comes with an extensive payload creation offering, it covers nearly all commonly used techniques, and are incredibly simple to create, unfortunately (or fortunately depending on your view point), all common antivirus software has a signature for each one of the available payloads, in addition to this, the trial version of CS also injects the EICAR string into the payload, but for a trial lab, you can still use them, secondly you can use other provider solutions such as Dave Kennedy’s amazing unicorn which will take the CS generated payload and obfuscate the code, which will increase your chance of the payload bypassing AV, this more advanced payload process will be covered later in the blogpost.</p>
<p>To create your first CS payload, click on Attacks / Packages / Payload Generator:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri16.png" loading="lazy" decoding="async" class="alignnone wp-image-15058" alt width="455" height="203" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri16.png 669w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri16-300x134.png 300w" sizes="auto, (max-width: 455px) 100vw, 455px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15058" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri16.png" alt="" width="455" height="203" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri16.png 669w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri16-300x134.png 300w" sizes="auto, (max-width: 455px) 100vw, 455px" /></noscript></p>
<p>Select the listener you wish the payload to dial back to, followed by the output format. For this demo the PowerShell Command has been opted for:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri17.png" loading="lazy" decoding="async" class="alignnone wp-image-15059" alt width="355" height="198" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri17.png 591w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri17-300x168.png 300w" sizes="auto, (max-width: 355px) 100vw, 355px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15059" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri17.png" alt="" width="355" height="198" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri17.png 591w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri17-300x168.png 300w" sizes="auto, (max-width: 355px) 100vw, 355px" /></noscript></p>
<p>It creates a single PowerShell one liner, which can be copied in to a CMD or PS terminal then run. This payload can also be placed into a .bat file and used as an OLE attack, which I may cover later on in this post.</p>
<p>After clicking generate you will be prompted for a location to save the payload to:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri18.png" loading="lazy" decoding="async" class="alignnone wp-image-15060" alt width="461" height="174" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri18.png 930w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri18-300x113.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri18-768x290.png 768w" sizes="auto, (max-width: 461px) 100vw, 461px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15060" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri18.png" alt="" width="461" height="174" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri18.png 930w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri18-300x113.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri18-768x290.png 768w" sizes="auto, (max-width: 461px) 100vw, 461px" /></noscript></p>
<p>Once you have downloaded the payload, open it using gedit or your preferred editor:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri19.png" loading="lazy" decoding="async" class="alignnone wp-image-15061" alt width="645" height="81" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri19.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri19-300x38.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri19-768x96.png 768w" sizes="auto, (max-width: 645px) 100vw, 645px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15061" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri19.png" alt="" width="645" height="81" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri19.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri19-300x38.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri19-768x96.png 768w" sizes="auto, (max-width: 645px) 100vw, 645px" /></noscript></p>
<p>Note – I have seen formatting issues when using nano and the such to copy and paste payloads.</p>
<pre>root@kali:~/Desktop/cobaltstrike# gedit /root/Desktop/Payloads/payload.txt</pre>
<p>Highlight all of the payload text Ctrl+a, then copy it Ctrl+c and move it across to your Windows machine, then open CMD and paste Ctrl+v it in, finally press enter:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri20.png" loading="lazy" decoding="async" class="alignnone wp-image-15062" alt width="539" height="231" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri20.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri20-300x129.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri20-768x329.png 768w" sizes="auto, (max-width: 539px) 100vw, 539px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15062" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri20.png" alt="" width="539" height="231" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri20.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri20-300x129.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri20-768x329.png 768w" sizes="auto, (max-width: 539px) 100vw, 539px" /></noscript></p>
<p>A few seconds later you should see the windows machine dialling back and you should receive your session:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri21.png" loading="lazy" decoding="async" class="alignnone wp-image-15063" alt width="766" height="123" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri21.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri21-300x48.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri21-768x123.png 768w" sizes="auto, (max-width: 766px) 100vw, 766px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15063" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri21.png" alt="" width="766" height="123" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri21.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri21-300x48.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri21-768x123.png 768w" sizes="auto, (max-width: 766px) 100vw, 766px" /></noscript></p>
<p>It is worth noting at this point the use of the * after the user name parameter, this reveals that the session is running in an elevated position with system rights. Typically you would not gain access to such a position from your initial foothold, but for lab use it doesn’t harm to start at this level.</p>
<p>To be able to send any commands to the target you are require to enable interact mode, to do this click on the chosen target and select Interact:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri22.png" loading="lazy" decoding="async" class="alignnone wp-image-15064" alt width="188" height="188" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri22.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri22-150x150.png 150w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri22-45x45.png 45w" sizes="auto, (max-width: 188px) 100vw, 188px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15064" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri22.png" alt="" width="188" height="188" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri22.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri22-150x150.png 150w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri22-45x45.png 45w" sizes="auto, (max-width: 188px) 100vw, 188px" /></noscript></p>
<p>This will open a new tab and you can then input your desired commands next to the beacon prompt:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri23.png" loading="lazy" decoding="async" class="alignnone wp-image-15065" alt width="545" height="119" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri23.png 824w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri23-300x66.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri23-768x168.png 768w" sizes="auto, (max-width: 545px) 100vw, 545px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15065" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri23.png" alt="" width="545" height="119" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri23.png 824w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri23-300x66.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri23-768x168.png 768w" sizes="auto, (max-width: 545px) 100vw, 545px" /></noscript></p>
<p>During a red team engagement, you control the rate that you communicate to and from the target host, typically you slow this communication down, in an aim to reduce the chances of your flows been spotted by the blue team, but while working in a lab environment, you may find the slow responses to requests frustrating, and as such you can set the beacon to respond instantly by typing in sleep 0 and pressing enter:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri24.png" loading="lazy" decoding="async" class="alignnone wp-image-15066" alt width="548" height="101" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri24.png 825w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri24-300x55.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri24-768x141.png 768w" sizes="auto, (max-width: 548px) 100vw, 548px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15066" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri24.png" alt="" width="548" height="101" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri24.png 825w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri24-300x55.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri24-768x141.png 768w" sizes="auto, (max-width: 548px) 100vw, 548px" /></noscript></p>
<p>Secondly all cmd / powershell commands can be used natively within beacon, but you do require to append the word “shell” before to enable beacon to understand your request.</p>
<p>The screenshot directly below shows the command error resulting from an attempt to run the cmd command “ipconfig” without appending the word shell before it:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri25.png" loading="lazy" decoding="async" class="alignnone wp-image-15067" alt width="321" height="57" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri25.png 406w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri25-300x53.png 300w" sizes="auto, (max-width: 321px) 100vw, 321px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15067" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri25.png" alt="" width="321" height="57" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri25.png 406w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri25-300x53.png 300w" sizes="auto, (max-width: 321px) 100vw, 321px" /></noscript></p>
<p>Repeating the above command request but this time appending the word &#8216;shell&#8217; before it results in the command being sent to the target machine and the responding reply being received as can be seen in this screenshot:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri26.png" loading="lazy" decoding="async" class="alignnone wp-image-15068" alt width="596" height="279" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri26.png 884w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri26-300x140.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri26-768x360.png 768w" sizes="auto, (max-width: 596px) 100vw, 596px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15068" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri26.png" alt="" width="596" height="279" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri26.png 884w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri26-300x140.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri26-768x360.png 768w" sizes="auto, (max-width: 596px) 100vw, 596px" /></noscript></p>
<p>While initially having to use the “shell” command feels unnatural, you quickly become used to it.</p>
<h3>Useful Basic CS commands<a name="usefulbasiccscommands"></a></h3>
<p><a href="#index">Back To Index▲</a></p>
<p><strong>Screenshot</strong></p>
<p>The screenshot function allows you to take a snapshot of the target’s desktop, you should become comfortable using this function, as targets often leave open spreadsheets, outlook mails, and it’s not unheard of to spot a useful username or even a password via a screenshot on an active engagement.</p>
<p>To take a screenshot of a targets desktop right click on the machine in question and Explore / Screenshot or alternatively just type screenshot in the beacon prompt and press enter:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri27.png" loading="lazy" decoding="async" class="alignnone wp-image-15069" alt width="344" height="247" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri27.png 450w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri27-300x215.png 300w" sizes="auto, (max-width: 344px) 100vw, 344px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15069" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri27.png" alt="" width="344" height="247" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri27.png 450w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri27-300x215.png 300w" sizes="auto, (max-width: 344px) 100vw, 344px" /></noscript></p>
<p>All commands and additional data that is collected by CS such as the screenshot jpg files are stored in the active log’s directory, which in this example was located at /root/Desktop/cobaltstrike/logs/190329/192.168.1.20/screenshots:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri28.png" loading="lazy" decoding="async" class="alignnone wp-image-15070" alt width="494" height="372" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri28.png 699w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri28-300x226.png 300w" sizes="auto, (max-width: 494px) 100vw, 494px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15070" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri28.png" alt="" width="494" height="372" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri28.png 699w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri28-300x226.png 300w" sizes="auto, (max-width: 494px) 100vw, 494px" /></noscript></p>
<p>There is a misconception that CS is very GUI driven, it can be, but attentively if you wish you can use the command prompt as equally, it is down to user preference on how they wish to use it.</p>
<p><strong>Process List</strong></p>
<p>To view the targets running process list, right click on the host, Explore / Process List:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri29.png" loading="lazy" decoding="async" class="alignnone wp-image-15071" alt width="221" height="237" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri29.png 366w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri29-279x300.png 279w" sizes="auto, (max-width: 221px) 100vw, 221px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15071" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri29.png" alt="" width="221" height="237" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri29.png 366w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri29-279x300.png 279w" sizes="auto, (max-width: 221px) 100vw, 221px" /></noscript></p>
<p>A tab will open detailing the running processes:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri30.png" loading="lazy" decoding="async" class="alignnone wp-image-15072" alt width="577" height="199" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri30.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri30-300x103.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri30-768x265.png 768w" sizes="auto, (max-width: 577px) 100vw, 577px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15072" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri30.png" alt="" width="577" height="199" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri30.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri30-300x103.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri30-768x265.png 768w" sizes="auto, (max-width: 577px) 100vw, 577px" /></noscript></p>
<p>If you want to inject into another process and have system rights on the target host, highlight the process you want to inject into, following this you will then be prompted to define the listener, select the desired one and click Inject:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri31.png" loading="lazy" decoding="async" class="alignnone wp-image-15073" alt width="628" height="274" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri31.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri31-300x131.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri31-768x335.png 768w" sizes="auto, (max-width: 628px) 100vw, 628px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15073" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri31.png" alt="" width="628" height="274" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri31.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri31-300x131.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri31-768x335.png 768w" sizes="auto, (max-width: 628px) 100vw, 628px" /></noscript></p>
<p>Below shows the result of injecting into a different process, a new session is started on a different PID, this can be useful for temporary resilience, as if the initial process is closed your secondary one should still be active.</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri32.png" loading="lazy" decoding="async" class="alignnone wp-image-15074" alt width="629" height="159" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri32.png 898w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri32-300x76.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri32-768x194.png 768w" sizes="auto, (max-width: 629px) 100vw, 629px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15074" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri32.png" alt="" width="629" height="159" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri32.png 898w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri32-300x76.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri32-768x194.png 768w" sizes="auto, (max-width: 629px) 100vw, 629px" /></noscript></p>
<p><strong>Hashdump</strong></p>
<p>Seems some commands from MSF have still survive ;0) typing hashdump when run with system privileges results in the targets hashes been collected and presented as can be seen in this screenshot:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri33.png" loading="lazy" decoding="async" class="alignnone wp-image-15075" alt width="729" height="159" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri33.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri33-300x65.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri33-768x167.png 768w" sizes="auto, (max-width: 729px) 100vw, 729px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15075" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri33.png" alt="" width="729" height="159" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri33.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri33-300x65.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri33-768x167.png 768w" sizes="auto, (max-width: 729px) 100vw, 729px" /></noscript></p>
<h3>To kill an implant<a name="tokillanimplant"></a></h3>
<p><a href="#index">Back To Index▲</a></p>
<p>You can remove a target once you have finished with it by performing the following process.</p>
<p>Click on Session / Exit:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri34.png" loading="lazy" decoding="async" class="alignnone wp-image-15076" alt width="315" height="213" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri34.png 454w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri34-300x203.png 300w" sizes="auto, (max-width: 315px) 100vw, 315px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15076" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri34.png" alt="" width="315" height="213" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri34.png 454w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri34-300x203.png 300w" sizes="auto, (max-width: 315px) 100vw, 315px" /></noscript></p>
<p>&#8230;or alternatively via beacon interact with the target you wish to remove and type exit:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri35.png" loading="lazy" decoding="async" class="alignnone wp-image-15077" alt width="358" height="97" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri35.png 483w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri35-300x81.png 300w" sizes="auto, (max-width: 358px) 100vw, 358px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15077" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri35.png" alt="" width="358" height="97" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri35.png 483w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri35-300x81.png 300w" sizes="auto, (max-width: 358px) 100vw, 358px" /></noscript></p>
<p>You can now remove the target from your CS client window, simply click Session / Remove:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri36.png" loading="lazy" decoding="async" class="alignnone wp-image-15078" alt width="228" height="229" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri36.png 318w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri36-150x150.png 150w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri36-300x300.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri36-45x45.png 45w" sizes="auto, (max-width: 228px) 100vw, 228px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15078" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri36.png" alt="" width="228" height="229" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri36.png 318w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri36-150x150.png 150w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri36-300x300.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri36-45x45.png 45w" sizes="auto, (max-width: 228px) 100vw, 228px" /></noscript></p>
<p>&#8230;and the target is gone:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri37.png" loading="lazy" decoding="async" class="alignnone wp-image-15079" alt width="557" height="101" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri37.png 827w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri37-300x54.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri37-768x139.png 768w" sizes="auto, (max-width: 557px) 100vw, 557px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15079" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri37.png" alt="" width="557" height="101" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri37.png 827w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri37-300x54.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri37-768x139.png 768w" sizes="auto, (max-width: 557px) 100vw, 557px" /></noscript></p>
<h3>Unicorn and Cobalt payloads<a name="unicornandcobaltpayloads"></a></h3>
<p><a href="#index">Back To Index▲</a></p>
<p>Let’s go deeper</p>
<p>So, say you want to simulate a more sophisticated payload creation technique?</p>
<p>There are a few options but the quickest is trustedsec’s unicorn https://github.com/trustedsec/unicorn</p>
<p>Quick note: Unicorn, as listed on the git hub page “Unicorn is a simple tool for using a PowerShell downgrade attack and inject shellcode straight into memory.”</p>
<p>Personally, I have used it for a few years, and I will happily say I’m a fan of it, but and there always is a small but, with every other update or so the odd thing does brake, before anyone complains, unicorn is free, it’s amazing and the level of support / commitment David Kennedy and his team put into it is incredible.</p>
<p>A neat tip I learned recently (respect to @ZephrFish for this tip) is, if you suspect the version of unicorn you are using is broken in some way, you can download the previous versions here <a href="https://github.com/trustedsec/unicorn/releases">https://github.com/trustedsec/unicorn/releases</a> an example of this is as such, version 3.6.8 to v3.6.11 looks to no longer support windows 7, which is not ideal due to mass support of this aging OS is still prevalent, now while the support for unicorn have been informed of this https://github.com/trustedsec/unicorn/issues/118 and I suspect the next release will address this, but for this next blog section, if you wish to use windows 7 as a target, you will have to opt for unicorn version 3.6.7 https://github.com/trustedsec/unicorn/releases/tag/3.6.7 for it to work.</p>
<p>Below details how to git clone the most recent version of unicorn</p>
<pre>root@kali:~/Desktop# git clone https://github.com/trustedsec/unicorn.git
Cloning into 'unicorn'...
remote: Enumerating objects: 50, done.
remote: Counting objects: 100% (50/50), done.
remote: Compressing objects: 100% (22/22), done.
remote: Total 538 (delta 30), reused 47 (delta 28), pack-reused 488
Receiving objects: 100% (538/538), 271.34 KiB | 723.00 KiB/s, done.
Resolving deltas: 100% (349/349), done.</pre>
<p>The following will detail how to use unicorn with CS.</p>
<p>Move into the unicorn directory</p>
<pre>root@kali:~/Desktop# cd unicorn/</pre>
<p>Review all files in the directory.</p>
<pre>root@kali:~/Desktop/unicorn# ls
CHANGELOG.txt  CREDITS.txt  LICENSE.txt  README.md  templates  unicorn.py</pre>
<p>To run unicorn in its default syntax, which will result in a response showing all possible commands</p>
<pre>root@kali:~/Desktop/unicorn# ./unicorn.py</pre>
<p><strong>CS and Unicorn Macro Fun</strong></p>
<p>The following section details using Unicorn with a C# CS payload to make a VBA office macro with an increased chance of bypassing AV.</p>
<p>For lab use I opt to use Office 2010, this version of office is still a widely used flavour in the wild and as such makes a good base of testing.</p>
<p>By default, the office ribbon does not show the developer tab, this is required for the creation of macro’s and as such the following directly below section details how to enable the developer tab.</p>
<p>Open MS word and go to File / Options / Customise Ribbon – and make sure the developer tab is ticked under Customise Ribbon:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri39.png" loading="lazy" decoding="async" class="alignnone wp-image-15081" alt width="501" height="637" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri39.png 795w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri39-236x300.png 236w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri39-768x977.png 768w" sizes="auto, (max-width: 501px) 100vw, 501px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15081" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri39.png" alt="" width="501" height="637" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri39.png 795w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri39-236x300.png 236w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri39-768x977.png 768w" sizes="auto, (max-width: 501px) 100vw, 501px" /></noscript></p>
<p>An alternative way to enable the developer tab is to right click on any space on the ribbon, and select Customize the Ribbon, and tick Developer:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri38.png" loading="lazy" decoding="async" class="alignnone wp-image-15080" alt width="393" height="287" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri38.png 695w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri38-300x219.png 300w" sizes="auto, (max-width: 393px) 100vw, 393px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15080" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri38.png" alt="" width="393" height="287" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri38.png 695w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri38-300x219.png 300w" sizes="auto, (max-width: 393px) 100vw, 393px" /></noscript></p>
<p>Ticking the developer function and saving the profile should now enable you to see the developer tab on the end of the ribbon:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri40.png" loading="lazy" decoding="async" class="alignnone wp-image-15082" alt width="567" height="40" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri40.png 936w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri40-300x21.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri40-768x54.png 768w" sizes="auto, (max-width: 567px) 100vw, 567px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15082" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri40.png" alt="" width="567" height="40" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri40.png 936w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri40-300x21.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri40-768x54.png 768w" sizes="auto, (max-width: 567px) 100vw, 567px" /></noscript></p>
<p>Click on the Developer tab, then on Visual Basic:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri41.png" loading="lazy" decoding="async" class="alignnone wp-image-15083" alt width="627" height="144" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri41.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri41-300x69.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri41-768x176.png 768w" sizes="auto, (max-width: 627px) 100vw, 627px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15083" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri41.png" alt="" width="627" height="144" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri41.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri41-300x69.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri41-768x176.png 768w" sizes="auto, (max-width: 627px) 100vw, 627px" /></noscript></p>
<p>This will start Visual Basic for Applications (VBA), right click on ThisDocument / Insert / Module, to create the Modual1 (Code) area:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri42.png" loading="lazy" decoding="async" class="alignnone wp-image-15084" alt width="484" height="352" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri42.png 878w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri42-300x218.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri42-768x558.png 768w" sizes="auto, (max-width: 484px) 100vw, 484px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15084" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri42.png" alt="" width="484" height="352" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri42.png 878w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri42-300x218.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri42-768x558.png 768w" sizes="auto, (max-width: 484px) 100vw, 484px" /></noscript></p>
<p>This will create the Document1 – Module1 (Code) area, this will be were you paste your Cobalt Strike / Unicorn VBA Macro into:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri43.png" loading="lazy" decoding="async" class="alignnone wp-image-15085" alt width="516" height="184" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri43.png 889w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri43-300x107.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri43-768x274.png 768w" sizes="auto, (max-width: 516px) 100vw, 516px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15085" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri43.png" alt="" width="516" height="184" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri43.png 889w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri43-300x107.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri43-768x274.png 768w" sizes="auto, (max-width: 516px) 100vw, 516px" /></noscript></p>
<p>It is very simple to make the C# payload which is required as the base of your macro payload in CS, the following section details this process.</p>
<p>Click on Attacks / Packages / Payload Generator.</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri44.png" loading="lazy" decoding="async" class="alignnone wp-image-15086" alt width="342" height="236" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri44.png 408w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri44-300x207.png 300w" sizes="auto, (max-width: 342px) 100vw, 342px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15086" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri44.png" alt="" width="342" height="236" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri44.png 408w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri44-300x207.png 300w" sizes="auto, (max-width: 342px) 100vw, 342px" /></noscript></p>
<p>Select your Listener and set output to C#:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri45.png" loading="lazy" decoding="async" class="alignnone wp-image-15087" alt width="377" height="211" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri45.png 589w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri45-300x168.png 300w" sizes="auto, (max-width: 377px) 100vw, 377px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15087" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri45.png" alt="" width="377" height="211" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri45.png 589w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri45-300x168.png 300w" sizes="auto, (max-width: 377px) 100vw, 377px" /></noscript></p>
<p>Save the payload in its default format of payload.cs:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri46.png" loading="lazy" decoding="async" class="alignnone wp-image-15088" alt width="510" height="325" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri46.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri46-300x191.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri46-768x489.png 768w" sizes="auto, (max-width: 510px) 100vw, 510px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15088" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri46.png" alt="" width="510" height="325" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri46.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri46-300x191.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri46-768x489.png 768w" sizes="auto, (max-width: 510px) 100vw, 510px" /></noscript></p>
<p>CS will prompt you to where it has been saved:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri47.png" loading="lazy" decoding="async" class="alignnone wp-image-15089" alt width="320" height="122" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri47.png 480w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri47-300x114.png 300w" sizes="auto, (max-width: 320px) 100vw, 320px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15089" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri47.png" alt="" width="320" height="122" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri47.png 480w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri47-300x114.png 300w" sizes="auto, (max-width: 320px) 100vw, 320px" /></noscript></p>
<p>Now take a note of the payload location and move over to terminal and move into the unicorn directory, while referencing the downloaded payload.cs file you can create a uniquely tweaked VBA macro automatically. The directly below syntax shows you all you require to perform this.</p>
<pre>python unicorn.py /root/Desktop/Payloads/payload.cs cs macro</pre>
<p>The result of the above command is the creation of a file titled “powershell_attack.txt” in your unicorn directory which contains a VBA office macro script:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri48.png" loading="lazy" decoding="async" class="alignnone wp-image-15090" alt width="395" height="247" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri48.png 747w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri48-300x188.png 300w" sizes="auto, (max-width: 395px) 100vw, 395px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15090" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri48.png" alt="" width="395" height="247" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri48.png 747w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri48-300x188.png 300w" sizes="auto, (max-width: 395px) 100vw, 395px" /></noscript></p>
<p>Open the “powershell_attack.txt” using your preferred editor, gedit because I’m “hu-man” ;0) and copy the full contents Ctrl+a, Ctrl+c</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri49.png" loading="lazy" decoding="async" class="alignnone wp-image-15091" alt width="749" height="405" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri49.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri49-300x162.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri49-768x415.png 768w" sizes="auto, (max-width: 749px) 100vw, 749px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15091" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri49.png" alt="" width="749" height="405" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri49.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri49-300x162.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri49-768x415.png 768w" sizes="auto, (max-width: 749px) 100vw, 749px" /></noscript></p>
<p>Move back to the windows VM and in the open Word Document1 – Module1 (Code) area and paste the unicorn macro in full, an extract of this can be seen in the screenshot directory below:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri50.png" loading="lazy" decoding="async" class="alignnone wp-image-15092" alt width="592" height="286" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri50.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri50-300x145.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri50-768x371.png 768w" sizes="auto, (max-width: 592px) 100vw, 592px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15092" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri50.png" alt="" width="592" height="286" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri50.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri50-300x145.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri50-768x371.png 768w" sizes="auto, (max-width: 592px) 100vw, 592px" /></noscript></p>
<p>Final tweak, you need to delete the underscore from between Auto_Open on the 1<sup>st</sup> line as can be seen below, without doing this the macro will not auto run on the opening of the document.</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri51.png" loading="lazy" decoding="async" class="alignnone wp-image-15093" alt width="294" height="131" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri51.png 422w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri51-300x134.png 300w" sizes="auto, (max-width: 294px) 100vw, 294px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15093" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri51.png" alt="" width="294" height="131" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri51.png 422w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri51-300x134.png 300w" sizes="auto, (max-width: 294px) 100vw, 294px" /></noscript></p>
<p>To test the macro, you can run it by clicking on the following “run” arrow on the tool bar:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri52-300x49.png" loading="lazy" decoding="async" class="alignnone size-medium wp-image-15094" alt width="300" height="49" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri52-300x49.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri52.png 420w" sizes="auto, (max-width: 300px) 100vw, 300px"><noscript><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-15094" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri52-300x49.png" alt="" width="300" height="49" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri52-300x49.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri52.png 420w" sizes="auto, (max-width: 300px) 100vw, 300px" /></noscript></p>
<p>This should make the word doc move from the developer window back to the default work page, you will see an error. This error is intentional and can be tweaked in the outputted “powershell_attack.txt”. The result of the error is, it forces the document to close when the OK is clicked, this makes it trickery for a standard user to nose around the document, and can even result in the user forwarding it to others, to ask if they can open the document, double shells ;0)</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri53.png" loading="lazy" decoding="async" class="alignnone wp-image-15095" alt width="511" height="349" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri53.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri53-300x205.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri53-768x525.png 768w" sizes="auto, (max-width: 511px) 100vw, 511px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15095" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri53.png" alt="" width="511" height="349" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri53.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri53-300x205.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri53-768x525.png 768w" sizes="auto, (max-width: 511px) 100vw, 511px" /></noscript></p>
<p>If all works as expected you should receive the session back in CS.</p>
<h3>Malleable profiles<a name="malleableprofiles"></a></h3>
<p><a href="#index">Back To Index▲</a></p>
<p>Malleable C2 is defied by Raphael as a domain specific language to redefine indicators in Beacon&#8217;s communication. Put bluntly, it allows you to manipulate the useragent used by the C2 traffic in an aim to help it blend into normal traffic under the disguise of being a legitimate source.</p>
<p>Take a look at <a href="https://github.com/rsmudge/Malleable-C2-Profiles" target="_blank" rel="noopener noreferrer">https://github.com/rsmudge/Malleable-C2-Profiles</a> as it details some created by Raphael that are available for you can use.</p>
<p>To download the above profiles in kali simply git clone the directory by performing the following.</p>
<pre>root@kali:~/Desktop/cobaltstrike# git clone https://github.com/rsmudge/Malleable-C2-Profiles.git

Cloning into 'Malleable-C2-Profiles'...
remote: Enumerating objects: 221, done.
remote: Total 221 (delta 0), reused 0 (delta 0), pack-reused 221
Receiving objects: 100% (221/221), 49.16 KiB | 535.00 KiB/s, done.
Resolving deltas: 100% (113/113), done.</pre>
<p>To view all files in the directory simply run ls.</p>
<pre>root@kali:~/Desktop/cobaltstrike# ls

agscript  c2lint  cobaltstrike  cobaltstrike.jar  cobaltstrike.store  data  icon.jpg  license.pdf  logs  Malleable-C2-Profiles  peclone  readme.txt  releasenotes.txt  teamserver  third-party  update  update.jar</pre>
<p>The c2lint program checks the syntax of the defined malleable profile, it is recommended that you do this with each profile you wish to use to verify that it will work.</p>
<pre>root@kali:~/Desktop/cobaltstrike# ./c2lint Malleable-C2-Profiles/normal/amazon.profile

[+] Profile compiled OK

http-get
--------
GET /s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books HTTP/1.1
Accept: */*
Host: www.amazon.com
Cookie: skin=noskin;session-token=NbpB9E/faGd2tZXtRbXh9g==csm-hit=s-24KU11BB82RZSYGJ3BDK|1419899012996
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko

HTTP/1.1 200 OK
Server: Server
x-amz-id-1: THKUYEZKCKPGY5T42PZT
x-amz-id-2: a21yZ2xrNDNtdGRsa212bGV3YW85amZuZW9ydG5rZmRuZ2tmZGl4aHRvNDVpbgo=
X-Frame-Options: SAMEORIGIN
Content-Encoding: gzip
Content-Length: 64

.7..y...........0%.ARW.K..h.H.p=.......cB.. ..|.d.W7f......CO$..

http-post
---------
POST /N4215/adj/amzn.us.sr.aps?sz=160x600&amp;oe=oe&amp;sn=43985&amp;s=3717&amp;dc_ref=http%3A%2F%2Fwww.amazon.com HTTP/1.1
Accept: */*
Content-Type: text/xml
X-Requested-With: XMLHttpRequest
Host: www.amazon.com
Content-Length: 24
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko

66/7wTq/D3ql+bBKT4i3rQ==

HTTP/1.1 200 OK
Server: Server
x-amz-id-1: THK9YEZJCKPGY5T42OZT
x-amz-id-2: a21JZ1xrNDNtdGRsa219bGV3YW85amZuZW9zdG5rZmRuZ2tmZGl4aHRvNDVpbgo=
X-Frame-Options: SAMEORIGIN
x-ua-compatible: IE=edge
Content-Length: 0

[+] POST 3x check passed
[+] .http-get.server.output size is good
[+] .http-get.client size is good
[+] .http-post.client size is good
[+] .http-get.client.metadata transform+mangle+recover passed (1 byte[s])
[+] .http-get.client.metadata transform+mangle+recover passed (100 byte[s])
[+] .http-get.client.metadata transform+mangle+recover passed (128 byte[s])
[+] .http-get.client.metadata transform+mangle+recover passed (256 byte[s])
[+] .http-get.server.output transform+mangle+recover passed (0 byte[s])
[+] .http-get.server.output transform+mangle+recover passed (1 byte[s])
[+] .http-get.server.output transform+mangle+recover passed (48248 byte[s])
[+] .http-get.server.output transform+mangle+recover passed (1048576 byte[s])
[+] .http-post.client.id transform+mangle+recover passed (4 byte[s])
[+] .http-post.client.output transform+mangle+recover passed (0 byte[s])
[+] .http-post.client.output transform+mangle+recover passed (1 byte[s])
[+] .http-post.client.output POSTs results
[+] .http-post.client.output transform+mangle+recover passed (48248 byte[s])
[+] .http-post.client.output transform+mangle+recover passed (1048576 byte[s])
[+] .host_stage: Will host payload stage (HTTP/DNS)
[!] .spawnto_x86 is '%windir%\syswow64\rundll32.exe'. This is a *really* bad OPSEC choice.
[!] .spawnto_x64 is '%windir%\sysnative\rundll32.exe'. This is a *really* bad OPSEC choice.
[!] .code-signer.keystore is missing. Will not sign executables and DLLs
[!] .https-certificate options are missing [will use built-in SSL cert]
root@kali:~/Desktop/cobaltstrike#</pre>
<p>You load the defined malleable profile at the same time as starting the CS team server, this accomplished by running the following.</p>
<pre>root@kali:~/Desktop/cobaltstrike# ./teamserver 192.168.1.18 TestmeUP3  Malleable-C2-Profiles/normal/amazon.profile</pre>
<p>Once it&#8217;s loaded start the Cobalt Strike client as mentioned earlier in this post, to enable you access to communicate with the server.</p>
<p>Set the listener as HTTP so the traffic is sent unencrypted, this will allow you to view the traffic with wireshark in the lab environment.</p>
<p>Here&#8217;s the listener set to HTTP:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri54.png" loading="lazy" decoding="async" class="alignnone wp-image-15096" alt width="597" height="75" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri54.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri54-300x38.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri54-768x96.png 768w" sizes="auto, (max-width: 597px) 100vw, 597px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15096" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri54.png" alt="" width="597" height="75" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri54.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri54-300x38.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri54-768x96.png 768w" sizes="auto, (max-width: 597px) 100vw, 597px" /></noscript></p>
<p>Go to your windows host and install <a href="https://www.wireshark.org/" target="_blank" rel="noopener noreferrer">Wireshark</a> once installed, start it listening on the interface that connects to your virtual lab.</p>
<p>Then on CS create some traffic by running a command such as “shell ipconfig” to the target machine:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri55.png" loading="lazy" decoding="async" class="alignnone wp-image-15097" alt width="742" height="386" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri55.png 836w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri55-300x156.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri55-768x400.png 768w" sizes="auto, (max-width: 742px) 100vw, 742px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15097" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri55.png" alt="" width="742" height="386" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri55.png 836w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri55-300x156.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri55-768x400.png 768w" sizes="auto, (max-width: 742px) 100vw, 742px" /></noscript></p>
<p>On the target machine filter Wireshark to look for HTTP traffic, then right click on a GET request and select follow:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri56.png" loading="lazy" decoding="async" class="alignnone wp-image-15098" alt width="811" height="202" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri56.png 939w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri56-300x75.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri56-768x191.png 768w" sizes="auto, (max-width: 811px) 100vw, 811px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15098" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri56.png" alt="" width="811" height="202" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri56.png 939w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri56-300x75.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri56-768x191.png 768w" sizes="auto, (max-width: 811px) 100vw, 811px" /></noscript></p>
<p>This screenshot shows the results of using the amazon malleable profile:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri57.png" loading="lazy" decoding="async" class="alignnone wp-image-15099" alt width="636" height="351" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri57.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri57-300x166.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri57-768x424.png 768w" sizes="auto, (max-width: 636px) 100vw, 636px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15099" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri57.png" alt="" width="636" height="351" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri57.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri57-300x166.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri57-768x424.png 768w" sizes="auto, (max-width: 636px) 100vw, 636px" /></noscript></p>
<p>The remains of this section detail the results of trying different malleable profile out.</p>
<p>Here&#8217;s the results identified while using the Gmail malleable profile:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri58.png" loading="lazy" decoding="async" class="alignnone wp-image-15100" alt width="716" height="201" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri58.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri58-300x84.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri58-768x216.png 768w" sizes="auto, (max-width: 716px) 100vw, 716px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15100" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri58.png" alt="" width="716" height="201" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri58.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri58-300x84.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri58-768x216.png 768w" sizes="auto, (max-width: 716px) 100vw, 716px" /></noscript></p>
<p>And finally using the Bing malleable profile:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri59.png" loading="lazy" decoding="async" class="alignnone wp-image-15101" alt width="664" height="219" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri59.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri59-300x99.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri59-768x253.png 768w" sizes="auto, (max-width: 664px) 100vw, 664px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15101" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri59.png" alt="" width="664" height="219" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri59.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri59-300x99.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri59-768x253.png 768w" sizes="auto, (max-width: 664px) 100vw, 664px" /></noscript></p>
<h3>Pivoting<a name="pivoting"></a></h3>
<p><a href="#index">Back To Index▲</a></p>
<p>With CS most users opt to live off the land with CMD or PowerShell commands and scripts, or as becoming more popular C#, but there are times when you just miss your old school techniques and tools, and CS allows you to use these via the use of a socks server.</p>
<p>The following section details using other tools via CS.</p>
<p>To enable the socks server click on Pivoting followed by selecting Socks Server:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri60.png" loading="lazy" decoding="async" class="alignnone wp-image-15102" alt width="607" height="179" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri60.png 810w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri60-300x89.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri60-768x227.png 768w" sizes="auto, (max-width: 607px) 100vw, 607px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15102" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri60.png" alt="" width="607" height="179" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri60.png 810w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri60-300x89.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri60-768x227.png 768w" sizes="auto, (max-width: 607px) 100vw, 607px" /></noscript></p>
<p>This will result in you been prompted to provide a port to run the server on, it will default fill this for you, and for this demo I use that setting.</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri61.png" loading="lazy" decoding="async" class="alignnone wp-image-15103" alt width="318" height="113" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri61.png 428w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri61-300x107.png 300w" sizes="auto, (max-width: 318px) 100vw, 318px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15103" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri61.png" alt="" width="318" height="113" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri61.png 428w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri61-300x107.png 300w" sizes="auto, (max-width: 318px) 100vw, 318px" /></noscript></p>
<p>Alternatively, you can type in socks followed by your defined port via beacon and press enter:</p>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri62.png" loading="lazy" decoding="async" class="alignnone wp-image-15104" alt width="412" height="138" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri62.png 531w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri62-300x101.png 300w" sizes="auto, (max-width: 412px) 100vw, 412px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15104" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri62.png" alt="" width="412" height="138" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri62.png 531w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri62-300x101.png 300w" sizes="auto, (max-width: 412px) 100vw, 412px" /></noscript></p>
<p>Now under a Kali terminal open the proxychains.conf and set socks4 127.0.0.1 port number to match the one you set under CS.</p>
<pre>root@kali:~/Desktop/cobaltstrike# gedit /etc/proxychains.conf</pre>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri63.png" loading="lazy" decoding="async" class="alignnone wp-image-15105" alt width="691" height="378" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri63.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri63-300x164.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri63-768x420.png 768w" sizes="auto, (max-width: 691px) 100vw, 691px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15105" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri63.png" alt="" width="691" height="378" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri63.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri63-300x164.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri63-768x420.png 768w" sizes="auto, (max-width: 691px) 100vw, 691px" /></noscript></p>
<p>Save and then you can use proxychains with your desired tool.</p>
<p>For the following demo I will show using RDP through the compromised target and pivoting to a connected Windows 10 box.</p>
<pre>root@kali:~/Desktop/cobaltstrike# proxychains rdesktop 192.168.1.17

ProxyChains-3.1 (http://proxychains.sf.net)
Autoselected keyboard map en-gb
|S-chain|-&lt;&gt;-127.0.0.1:37279-&lt;&gt;&lt;&gt;-192.168.1.17:3389-&lt;&gt;&lt;&gt;-OK
ERROR: CredSSP: Initialize failed, do you have correct kerberos tgt initialized ?
|S-chain|-&lt;&gt;-127.0.0.1:37279-&lt;&gt;&lt;&gt;-192.168.1.17:3389-&lt;&gt;&lt;&gt;-OK
Connection established using SSL.</pre>
<p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri64.png" loading="lazy" decoding="async" class="alignnone wp-image-15106" alt width="714" height="695" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri64.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri64-300x292.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri64-768x748.png 768w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri64-45x45.png 45w" sizes="auto, (max-width: 714px) 100vw, 714px"><noscript><img loading="lazy" decoding="async" class="alignnone wp-image-15106" src="https://www.pentestpartners.com/content/uploads/2019/04/cobstri64.png" alt="" width="714" height="695" srcset="https://www.pentestpartners.com/content/uploads/2019/04/cobstri64.png 940w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri64-300x292.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri64-768x748.png 768w, https://www.pentestpartners.com/content/uploads/2019/04/cobstri64-45x45.png 45w" sizes="auto, (max-width: 714px) 100vw, 714px" /></noscript></p>

					
					                </div>


            </article>


		

		<aside id="sidebar">

    <!-- call to action box -->

	

	


	

	


	
        <!-- share for page-->

        <div class="widget share-widget">

            <h3>Share</h3>

				<div class="addtoany_shortcode"><div class="a2a_kit a2a_kit_size_32 addtoany_list" data-a2a-url="https://www.pentestpartners.com/security-blog/cobalt-strike-walkthrough-for-red-teamers/" data-a2a-title="Cobalt Strike. Walkthrough for Red Teamers"><a class="a2a_button_twitter" href="https://www.addtoany.com/add_to/twitter?linkurl=https%3A%2F%2Fwww.pentestpartners.com%2Fsecurity-blog%2Fcobalt-strike-walkthrough-for-red-teamers%2F&amp;linkname=Cobalt%20Strike.%20Walkthrough%20for%20Red%20Teamers" title="Twitter" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_facebook" href="https://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fwww.pentestpartners.com%2Fsecurity-blog%2Fcobalt-strike-walkthrough-for-red-teamers%2F&amp;linkname=Cobalt%20Strike.%20Walkthrough%20for%20Red%20Teamers" title="Facebook" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_linkedin" href="https://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fwww.pentestpartners.com%2Fsecurity-blog%2Fcobalt-strike-walkthrough-for-red-teamers%2F&amp;linkname=Cobalt%20Strike.%20Walkthrough%20for%20Red%20Teamers" title="LinkedIn" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_slashdot" href="https://www.addtoany.com/add_to/slashdot?linkurl=https%3A%2F%2Fwww.pentestpartners.com%2Fsecurity-blog%2Fcobalt-strike-walkthrough-for-red-teamers%2F&amp;linkname=Cobalt%20Strike.%20Walkthrough%20for%20Red%20Teamers" title="Slashdot" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_reddit" href="https://www.addtoany.com/add_to/reddit?linkurl=https%3A%2F%2Fwww.pentestpartners.com%2Fsecurity-blog%2Fcobalt-strike-walkthrough-for-red-teamers%2F&amp;linkname=Cobalt%20Strike.%20Walkthrough%20for%20Red%20Teamers" title="Reddit" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_email" href="https://www.addtoany.com/add_to/email?linkurl=https%3A%2F%2Fwww.pentestpartners.com%2Fsecurity-blog%2Fcobalt-strike-walkthrough-for-red-teamers%2F&amp;linkname=Cobalt%20Strike.%20Walkthrough%20for%20Red%20Teamers" title="Email" rel="nofollow noopener" target="_blank"></a><a class="a2a_dd addtoany_share_save addtoany_share" href="https://www.addtoany.com/share"></a></div></div>
        </div>

	


	
        <div class="widget widget_categories">

            <h3>Categories</h3>

            <form id="category-select"
                  class="category-select"
                  action="https://www.pentestpartners.com/"
                  method="get">

				
												
				<select name='cat' id='cat' class='postform' onchange="if (!window.__cfRLUnblockHandlers) return false; return this.form.submit()" data-cf-modified-947ea80add6883039db1f04e-="">
	<option value='0' selected='selected'>Show all</option>
	<option class="level-0" value="21">Android&nbsp;&nbsp;(71)</option>
	<option class="level-0" value="54">Automotive Security&nbsp;&nbsp;(24)</option>
	<option class="level-0" value="56">Aviation Cyber Security&nbsp;&nbsp;(45)</option>
	<option class="level-0" value="52">Blockchain&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="58">Breach Handling&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="65">Careers At PTP&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="62">Cloud Security&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="25">Code Repository&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="74">Consultancy advice&nbsp;&nbsp;(8)</option>
	<option class="level-0" value="53">Consumer Advice&nbsp;&nbsp;(35)</option>
	<option class="level-0" value="63">Cyber Essentials&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="27">Cyber Liability Insurance&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="70">DFIR&nbsp;&nbsp;(30)</option>
	<option class="level-0" value="48">Hardware Hacking&nbsp;&nbsp;(21)</option>
	<option class="level-0" value="20">Heartbleed&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="19">Honeypots&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="11">How-Tos&nbsp;&nbsp;(267)</option>
	<option class="level-0" value="39">In the news&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="38">Internet Of Things&nbsp;&nbsp;(169)</option>
	<option class="level-0" value="16">Macs / Apple&nbsp;&nbsp;(31)</option>
	<option class="level-0" value="50">Maritime Cyber Security&nbsp;&nbsp;(49)</option>
	<option class="level-0" value="75">Medical Device Security&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="14">Opinions&nbsp;&nbsp;(107)</option>
	<option class="level-0" value="76">OPSEC&nbsp;&nbsp;(9)</option>
	<option class="level-0" value="49">OT, ICS, IIoT, SCADA&nbsp;&nbsp;(23)</option>
	<option class="level-0" value="18">Passwords&nbsp;&nbsp;(39)</option>
	<option class="level-0" value="61">PCI Advice&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="67">Ransomware&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="55">Red Teaming&nbsp;&nbsp;(26)</option>
	<option class="level-0" value="13">Reverse Engineering&nbsp;&nbsp;(12)</option>
	<option class="level-0" value="5">Security Blog&nbsp;&nbsp;(810)</option>
	<option class="level-0" value="22">Shameless Self Promotion&nbsp;&nbsp;(11)</option>
	<option class="level-0" value="31">Show on homepage&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="24">Social Engineering&nbsp;&nbsp;(12)</option>
	<option class="level-0" value="66">Sustainability&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="23">Virtual Environments&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="69">Vulnerabilities that aren&#8217;t&nbsp;&nbsp;(4)</option>
	<option class="level-0" value="45">Vulnerability Advisory&nbsp;&nbsp;(45)</option>
	<option class="level-0" value="68">Vulnerability Disclosure&nbsp;&nbsp;(20)</option>
</select>

                <noscript>
                    <input type="submit"
                           value="View"/>
                </noscript>

            </form>

        </div>

        <div class="widget_recent-blogs">

            <div class="bg-red">
                <a href="/blog/">
                    <div class="block-text cta-block">
                        <h1>See the other cool stuff we've been doing&hellip;</h1>
                    </div>
                </a>
            </div>

			
			
				
				

                <div class="bg-image bg-">
                    <a href="https://www.pentestpartners.com/security-blog/take-control-of-cache-control-and-local-caching/"
                       rel="nofollow">
						                            <div class="block-bg"
                                 style="background-image: url(https://www.pentestpartners.com/content/uploads/2025/03/cache-control-headline.png);"></div>
						                        <div class="block-text">
                            <p class="meta">How-Tos</p>
                            <h1>Take control of Cache-Control and local caching</h1>
                            <p class="date">12 Mar 2025</p>
                        </div>
                    </a>
                </div>

			
				
				

                <div class="bg-image bg-">
                    <a href="https://www.pentestpartners.com/security-blog/how-i-became-a-cyber-essentials-plus-assessor/"
                       rel="nofollow">
						                            <div class="block-bg"
                                 style="background-image: url(https://www.pentestpartners.com/content/uploads/2023/03/CEassessorHow-headline.png);"></div>
						                        <div class="block-text">
                            <p class="meta">Consultancy advice</p>
                            <h1>How I became a Cyber Essentials Plus assessor</h1>
                            <p class="date">06 Mar 2025</p>
                        </div>
                    </a>
                </div>

			
				
				

                <div class="bg-image bg-">
                    <a href="https://www.pentestpartners.com/security-blog/dnssec-nsec-the-accidental-treasure-map-to-your-subdomains/"
                       rel="nofollow">
						                            <div class="block-bg"
                                 style="background-image: url(https://www.pentestpartners.com/content/uploads/2023/03/dnssec-headline.png);"></div>
						                        <div class="block-text">
                            <p class="meta">Show on homepage</p>
                            <h1>DNSSEC NSEC. The accidental treasure map to your subdomains</h1>
                            <p class="date">04 Mar 2025</p>
                        </div>
                    </a>
                </div>

			
				
				

                <div class="bg-image bg-">
                    <a href="https://www.pentestpartners.com/security-blog/a-dive-into-the-rockchip-bootloader/"
                       rel="nofollow">
						                            <div class="block-bg"
                                 style="background-image: url(https://www.pentestpartners.com/content/uploads/2023/02/bootloader-rockchip-headline.png);"></div>
						                        <div class="block-text">
                            <p class="meta">Hardware Hacking</p>
                            <h1>A dive into the Rockchip Bootloader</h1>
                            <p class="date">26 Feb 2025</p>
                        </div>
                    </a>
                </div>

			
				
				

                <div class="bg-image bg-">
                    <a href="https://www.pentestpartners.com/security-blog/pen-testing-avionics-under-ed-203a/"
                       rel="nofollow">
						                            <div class="block-bg"
                                 style="background-image: url(https://www.pentestpartners.com/content/uploads/2023/02/pentestavionics-headline.png);"></div>
						                        <div class="block-text">
                            <p class="meta">Aviation Cyber Security</p>
                            <h1>Pen testing avionics under ED-203a</h1>
                            <p class="date">21 Feb 2025</p>
                        </div>
                    </a>
                </div>

			

        </div>

		
        <div class="widget bg-image ptp-uber_widget bg-green">
            <a href="https://www.pentestpartners.com/penetration-testing-services/penetration-testing/"
               target="_self">
                <div class="block-bg"
                     style="background-image: url(https://www.pentestpartners.com/content/uploads/2016/11/AC4.png);"></div>
                <div class="block-text">
                    <p class="meta">Services</p>
                    <h3>Penetration Testing</h3>
                </div>
                <p class="cta">Find out more »</p>
            </a>
        </div>

		<div class="widget bg-image  ptp-uber_widget grid-item col2 row2 bg-grey"><a href="" target="_self"><div class="block-bg" style="background-image: url(https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/home-people.jpg);"></div><div class="block-text"><h3>Our People</h3><p class="excerpt">Being introduced to, and getting to know your tester is an often overlooked part of the process. Yes, our work is über technical, but faceless relationships do nobody any good.</p></div></a></div>
	


	

	    <div id="sidebar-spacer"></div>
</aside>



    </section>



    <section id="hot-topics--footer">

        <article>
            <a href="https://www.pentestpartners.com/penetration-testing-services/suffered-a-security-breach/">
                <img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-alert.svg"/>
                <h2>Suffered a Security breach?</h2>
            </a>
        </article>
        <article>
            <a href="https://www.pentestpartners.com/penetration-testing-services/mobile-security/">
                <img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-mobile-security.svg"/>
                <h2>Mobile Security</h2>
            </a>
        </article>
        <article>
            <a href="https://www.pentestpartners.com/penetration-testing-services/social-engineering/">
                <img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-social-engineering-grey.svg"/>
                <h2>Social Engineering</h2>
            </a>
        </article>
        <article>
            <a href="https://www.pentestpartners.com/penetration-testing-services/web-application-testing/">
                <img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-webapp.svg"/>
                <h2>Web application testing</h2>
            </a>
        </article>
		 <article class="grid-item">
       	<a href="https://www.pentestpartners.com/penetration-testing-services/security-consulting/"
         	class="row1">
            	<img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-data-compliance-grey.svg"/>
	            <h2>Security Consulting</h2>
   	     </a>
    	</article>
    	<article class="grid-item">
        <a href="https://www.pentestpartners.com/penetration-testing-services/papa/"
           class="row1">
            <img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-papa-grey.svg"/>
            <h2>Papa - PTP Advance Password Auditor</h2>
        </a>
    </article>

    </section>


</div>
</div>

<footer id="site-footer">

    <div class="container">

        <div id="contact">
            <div id="get-in-touch"
                 class="grid-item bg-grey-dark">
					<div>
						<h3>Get in touch</h3>
						<p class="address">
                       <strong class="office">UK Office:</strong><br />
                       Pen Test Partners LLP<br />
                       Unit 2, Verney Junction Business Park<br>
                       Buckingham<br>
                       MK18 2LB<br>
                       United Kingdom
						</p>
						<a class="phone" href="tel:+442030950500">+44 20 3095 0500</a>

						<a class="form" href="/contact-us/">Contact Us &raquo;</a>
					</div>
					<div>
						<h3>&nbsp;</h3>
                  <p class="address-us">
                        <strong class="office">US Office:</strong><br />
                        Pen Test Partners Inc.<br />
                        222 Broadway 22nd Floor, Suite 2525<br />
                        New York<br />
                        NY 10038<br />
                        United States
                  </p>
						<a class="phone" href="tel:+16466932501">+1 646 693 2501</a>

						<a class="email" href="/cdn-cgi/l/email-protection#fb92959d94bb8b9e958f9e888f8b9a898f959e8988d5989496"><span class="__cf_email__" data-cfemail="9df4f3fbf2ddedf8f3e9f8eee9edfcefe9f3f8efeeb3fef2f0">[email&#160;protected]</span></a>
				</div>
<!--
                <div>
                    <h3>Get in touch</h3>
                    <div>
                        <a class="phone"
                           href="tel:+442030950500">+44 20 3095 0500</a>
                        <a class="phone"
                           href="tel:+16466932501">+1 646 693 2501</a>
                        <a class="email"
                           href="mailto:info@pentestpartners.com">info@pentestpartners.com</a>
                        <a class="form"
                           href="/contact-us/">Contact Us &raquo;</a>
                    </div>
                </div>
                <div>
                    <p class="address">
                        Unit 2, Verney Junction Business Park<br>
                        Verney Junction<br>
                        Buckingham<br>
                        MK18 2LB<br>
                        United Kingdom
                    </p>
                    <p class="address-us">
								Pen Test Partners Inc.<br />
								222 Broadway 22nd Floor, Suite 2525<br />
								New York<br />
								NY 10038<br />
								United States
                    </p>
                </div>
-->
            </div>
            <div id="connect"
                 class="grid-item bg-green">
                <div>
                    <h3>Connect</h3>
                    <a href="https://twitter.com/PentestPartners"
                       class="twitter"
                       target="_blank"><i class="fab fa-twitter"></i>Twitter</a>
                    <a href="https://www.linkedin.com/company/pen-test-partners"
                       class="linkedin"
                       target="_blank"><i class="fab fa-linkedin"></i>LinkedIn</a>
                    <a href="https://www.youtube.com/channel/UC2HCAhj6JiOsV_PcMFrjykw"
                       class="youtube"
                       target="_blank"><i class="fab fa-youtube"></i>YouTube</a>
                </div>
            </div>
        </div>

        <div id="accreditations">
            <div class="grid-item">
                <div>
                    <a href="https://www.crest-approved.org/member_companies/pen-test-partners/" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-logo-22.png"></a>
                </div>
				</div>
            <div class="grid-item">
                <div>
                    <a href="https://www.crest-approved.org/member_companies/pen-test-partners/" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-pentest-logo-22.png"></a>
                </div>
            </div>
            <div class="grid-item">
                <div>
                    <a href="https://www.crest-approved.org/member_companies/pen-test-partners/" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-logo-22.png"></a>
                </div>
            </div>
            <div class="grid-item">
                <div>
                    <a href="https://www.crest-approved.org/member_companies/pen-test-partners/" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-fs-logo-22.png"></a>
                </div>
            </div>
            <div class="grid-item">
                <div>
                    <a href="https://www.crest-approved.org/member_companies/pen-test-partners/" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/csir-logo-22.png"></a>
                </div>
            </div>
            <div class="grid-item">
                <div>
                    <a href="https://www.crest-approved.org/member_companies/pen-test-partners/" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-ovs-logo-22.png"></a>
                </div>
            </div>
        </div>

        <div id="accreditations">
            <div class="grid-item">
                <div>
                    <a href="https://www.crest-approved.org/member_companies/pen-test-partners/"
                       rel="nofollow"
                       target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cbest.png"
                                            alt="logo-cbest"></a>
                </div>
            </div>
            <div class="grid-item">
                <div>
                    <a href="https://www.ncsc.gov.uk/organisations/pen-test-partners" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-check-ncsc.png"></a>
                </div>
            </div>
            <div class="grid-item">
                <div>
                    <a href="https://www.crest-approved.org/member_companies/pen-test-partners/" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-assure.png"></a>
                </div>
            </div>
            <div class="grid-item">
                <div>
                    <a href="https://iasme.co.uk/cyber-essentials/" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cyber-essentials2023.png"></a>
                </div>
            </div>
            <div class="grid-item">
                <div>
                    <a href="/content/uploads/2025/03/PTP-ISO27001-v2022-Certificate-2024.pdf" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/bsi-iso27001-logo-22.png"></a>
                </div>
            </div>
            <div class="grid-item">
                <div>
                    <a href="https://www.pcisecuritystandards.org/assessors_and_solutions/qualified_security_assessors" rel="nofollow" target="_blank"><img src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-pci-certified.png"></a>
                </div>
            </div>
        </div>
        <div id="copyright">
            <div>
                <p><a href="/privacy-policy/">Privacy Policy</a></p>
                <p><a href="/terms-of-website-use/">Terms of Service</a></p>
					 <p><a onclick="if (!window.__cfRLUnblockHandlers) return false; displayPreferenceModal()" data-cf-modified-947ea80add6883039db1f04e-="">Manage Cookies</a></p>
            </div>
            <div>
                <p>Company number: OC353362</p>
                <p>VAT reg number: GB825526427</p>
                <p>&copy; 2025 Pen Test Partners</p>
            </div>
        </div>

    </div>

</footer>

		<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="947ea80add6883039db1f04e-text/javascript">
		( function ( body ) {
			'use strict';
			body.className = body.className.replace( /\btribe-no-js\b/, 'tribe-js' );
		} )( document.body );
		</script>
		<script type="947ea80add6883039db1f04e-text/javascript"> /* <![CDATA[ */var tribe_l10n_datatables = {"aria":{"sort_ascending":": activate to sort column ascending","sort_descending":": activate to sort column descending"},"length_menu":"Show _MENU_ entries","empty_table":"No data available in table","info":"Showing _START_ to _END_ of _TOTAL_ entries","info_empty":"Showing 0 to 0 of 0 entries","info_filtered":"(filtered from _MAX_ total entries)","zero_records":"No matching records found","search":"Search:","all_selected_text":"All items on this page were selected. ","select_all_link":"Select all pages","clear_selection":"Clear Selection.","pagination":{"all":"All","next":"Next","previous":"Previous"},"select":{"rows":{"0":"","_":": Selected %d rows","1":": Selected 1 row"}},"datepicker":{"dayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"dayNamesShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dayNamesMin":["S","M","T","W","T","F","S"],"monthNames":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthNamesShort":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthNamesMin":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"nextText":"Next","prevText":"Prev","currentText":"Today","closeText":"Done","today":"Today","clear":"Clear"}};/* ]]> */ </script>		<!-- Google Tag Manager (noscript) snippet added by Site Kit -->
		<noscript>
			<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5CQ6NHF5" height="0" width="0" style="display:none;visibility:hidden"></iframe>
		</noscript>
		<!-- End Google Tag Manager (noscript) snippet added by Site Kit -->
		<script type="947ea80add6883039db1f04e-text/javascript" id="addtoany-core-js-before">
/* <![CDATA[ */
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};a2a_localize = {
	Share: "Share",
	Save: "Save",
	Subscribe: "Subscribe",
	Email: "Email",
	Bookmark: "Bookmark",
	ShowAll: "Show All",
	ShowLess: "Show less",
	FindServices: "Find service(s)",
	FindAnyServiceToAddTo: "Instantly find any service to add to",
	PoweredBy: "Powered by",
	ShareViaEmail: "Share via email",
	SubscribeViaEmail: "Subscribe via email",
	BookmarkInYourBrowser: "Bookmark in your browser",
	BookmarkInstructions: "Press Ctrl+D or \u2318+D to bookmark this page",
	AddToYourFavorites: "Add to your favourites",
	SendFromWebOrProgram: "Send from any email address or email program",
	EmailProgram: "Email program",
	More: "More&#8230;",
	ThanksForSharing: "Thanks for sharing!",
	ThanksForFollowing: "Thanks for following!"
};
/* ]]> */
</script>
<script type="947ea80add6883039db1f04e-text/javascript" defer src="https://static.addtoany.com/menu/page.js" id="addtoany-core-js"></script>
<script type="947ea80add6883039db1f04e-text/javascript" defer src="https://www.pentestpartners.com/content/plugins/add-to-any/addtoany.min.js?ver=1.1" id="addtoany-jquery-js"></script>
<script type="947ea80add6883039db1f04e-text/javascript" id="ptp-js-js-extra">
/* <![CDATA[ */
var ajax_url = "https:\/\/www.pentestpartners.com\/wp-admin\/admin-ajax.php";
/* ]]> */
</script>
<script type="947ea80add6883039db1f04e-text/javascript" src="https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/main.js?id=685b9096a5cb2d5d2c37&amp;ver=1" id="ptp-js-js"></script>
<script type="947ea80add6883039db1f04e-text/javascript" src="https://www.pentestpartners.com/content/plugins/lazy-load/js/jquery.sonar.min.js?ver=0.6.1" id="jquery-sonar-js"></script>
<script type="947ea80add6883039db1f04e-text/javascript" src="https://www.pentestpartners.com/content/plugins/lazy-load/js/lazy-load.js?ver=0.6.1" id="wpcom-lazy-load-images-js"></script>

<!-- Google tag (gtag.js) snippet added by Site Kit -->

<!-- Google Analytics snippet added by Site Kit -->
<script type="947ea80add6883039db1f04e-text/javascript" src="https://www.googletagmanager.com/gtag/js?id=GT-NMLD95V" id="google_gtagjs-js" async></script>
<script type="947ea80add6883039db1f04e-text/javascript" id="google_gtagjs-js-after">
/* <![CDATA[ */
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}
gtag("set","linker",{"domains":["www.pentestpartners.com"]});
gtag("js", new Date());
gtag("set", "developer_id.dZTNiMT", true);
gtag("config", "GT-NMLD95V");
/* ]]> */
</script>

<!-- End Google tag (gtag.js) snippet added by Site Kit -->

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="947ea80add6883039db1f04e-|49" defer></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"922955bc2fcd5e60","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"a26c850231bd4a09a2ef2674ae01af15","b":1}' crossorigin="anonymous"></script>
</body>
</html>
