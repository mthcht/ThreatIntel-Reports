

<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="preload" href="//opt.rapid7.com/edge-client/v1/13222550/21485331595" referrerpolicy="no-referrer-when-downgrade" as="script">
    <link rel="preconnect" href="//logx.optimizely.com">
    <title>Automating Qakbot Detection at Scale With Velociraptor | Rapid7 Blog</title>


    <meta property="og:url" content="http://www.rapid7.com/blog/post/2023/04/18/automating-qakbot-detection-at-scale-with/" />
    <link rel="canonical" href="http://www.rapid7.com/blog/post/2023/04/18/automating-qakbot-detection-at-scale-with/" />
    <link rel="alternate" href="http://www.rapid7.com/blog/post/2023/04/18/automating-qakbot-detection-at-scale-with/" hreflang="en" />

    
    <meta name="robots" content="index, follow" />
    <meta name="title" content="Automating Qakbot Detection at Scale With Velociraptor | Rapid7 Blog" />
    <meta name="description" content="This blog offers a practical methodology to extract configuration data from recent Qakbot samples. " />
    <meta property="og:title" content="Automating Qakbot Detection at Scale With Velociraptor | Rapid7 Blog" />
    <meta property="og:image" content="https://blog.rapid7.com/content/images/2023/04/GettyImages-1367656936.jpg" />
    <meta name="twitter:image" content="https://blog.rapid7.com/content/images/2023/04/GettyImages-1367656936.jpg" />
    <meta name="twitter:title" content="Automating Qakbot Detection at Scale With Velociraptor | Rapid7 Blog">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="og:site_name" content="Rapid7" />
    <meta property="og:description" content="This blog offers a practical methodology to extract configuration data from recent Qakbot samples. " />
    <link rel="stylesheet" href="/includes/css/all.min.css?cb=1736875731824">



     <link rel="stylesheet" href="/includes/css/bundles/pages/page.blog-resources.min.css?cb=1736875731824" />
     <link rel="stylesheet" href="/includes/css/bundles/blocks/block.blog-featured-posts.min.css?cb=1736875731824" />
     <link rel="stylesheet" href="/includes/css/bundles/blocks/block.blog-single-post.min.css?cb=1736875731824" />
     <link rel="stylesheet" href="/includes/css/bundles/blocks/block.blog-related-posts.min.css?cb=1736875731824" />





    <meta name="facetcat" content="blog" />


    <script>
        var gIp = {"countryIsoCode":"DE","subdivisionIsoCode":null,"continentIsoCode":"EU"};

        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
'conversionType': 'secondary',                    });
        window.dataLayer.push({ 'auth': false });
	         window.dataLayer.push({ 'ip': '***.***.***.**' });
        window.dataLayer.push({ 'isTrialUser': false, 'isCustomer': false });
    </script>
    
    
        <script>
        window.dataLayer.push({ 'blog_post_tag': 'Velociraptor' });
        </script>



    
        <script src="https://opt.rapid7.com/edge-client/v1/13222550/21485331595" referrerpolicy="no-referrer-when-downgrade"></script>




<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || []; w[l].push({
            'gtm.start':
                new Date().getTime(), event: 'gtm.js'
        }); var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-WBTPTVC');</script>


    <link rel="icon" type="image/x-icon" href="/includes/img/favicon.ico">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Mulish:wght@800;900&family=Roboto:wght@300;400;700">
    <link rel="preload" href="/includes/fonts/FFGoodProCompressedBlack/FFGoodProCompressedBlack.woff2" as="font" type="font/woff2" crossorigin="anonymous" />
    <link rel="preload" href="/includes/fonts/FFGoodProCompressedBlack/FFGoodProCompressedBlack.woff" as="font" type="font/woff" crossorigin="anonymous" />

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"
            integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8="
            crossorigin="anonymous"></script>


    <script src="/includes/js/populateCountryState.js"></script>



	 <script src="https://information.rapid7.com/js/forms2/js/forms2.min.js" ></script>




    
    
    <meta property="og:type" content="article" />
        <meta property="article:published_time" content="2023-04-18T13:00:00" />
            <meta property="article:modified_time" content="2023-05-09T14:07:06" />

        <meta property="article:tag" content="Velociraptor" />

        <script src="//app-sj20.marketo.com/js/forms2/js/forms2.min.js"></script>

    <script type="application/ld+json">
        {
           "@context":"https://schema.org",
           "@type":"Article",
           "publisher":{
              "@type":"Organization",
              "name":"Rapid7 Blog",
              "logo":{
                 "@type":"ImageObject",
                 "url":"https://www.rapid7.com/favicon.ico",
                 "width":60,
                 "height":60
              }
           },
           "author":{
              "@type":"Person",
              "name":"Matthew Green",
              "image":{
                 "@type":"ImageObject",
                 "url":"https://blog.rapid7.com/assets/images/default-author-image.png"
              },
              "url":"http://www.rapid7.com/blog/author/mgreen27/",
              "sameAs":[]
           },
           "headline": "Automating Qakbot Detection at Scale With Velociraptor",
           "url":"http://www.rapid7.com/blog/post/2023/04/18/automating-qakbot-detection-at-scale-with/",
           "image":{
              "@type":"ImageObject",
              "url":"https://blog.rapid7.com/content/images/2023/04/GettyImages-1367656936.jpg"
           },
           "keywords":"Velociraptor",
           "description": "This blog offers a practical methodology to extract configuration data from recent Qakbot samples. ",
           "mainEntityOfPage":{
              "@type":"WebPage",
              "@id":"http://www.rapid7.com/"
           },
                 "datePublished":"2023-04-18T13:00:00",
                             "dateModified":"2023-05-09T14:07:06"
        }
    </script>

    <style type="text/css">
        body .mktoForm .mktoFormCol,
        body .mktoForm .mktoFormRow {
            float: none;
        }

        #modal-subscribe h2 {
            padding-bottom: .25rem;
        }
    </style>

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/a11y-dark.min.css">


</head>
<body  class="pg-id-29536" data-page="29536">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WBTPTVC" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <div id="__"></div>
    <!--[if lte IE 9]>
    <div id="ie-conditional"><spa>Your IE browser is out of date - Upgrade to the latest version of IE or Chrome for an optimal website experience.</span> <a href="https://support.microsoft.com/en-us/help/17621/internet-explorer-downloads" title="Upgrade IE Now" class="button smBtn darkClear" target="_blank">Upgrade IE Now</a>
    <button class="close-button" type="button" id="closeIEBar">
        <img src="../includes/img/close_white.svg">
    </button>
    </div>
    <![endif]-->

    



<div class="off-canvas-wrapper">
    <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>
        
        <div id="r7-global-nav">
            <header class="r7-nav mobile show-main--init "><section class="search-bar search-bar--mobile hide animate-out"><form action="/search"><div class="container flex flex-jc-c flex-ai-c"><div class="search-content flex flex-jc-fs flex-ai-c"><i class="r7-icon r7-icon-search-magnify"></i><input type="search" class="search-input" name="q" placeholder="Search"/><input type="submit" class="search-submit button blue" value="Search"/><a id="btnSearchCloseMobile" class="search-close"><i class="r7-icon r7-icon-delete-x"></i></a></div></div></form></section><div class="search-overlay search-overlay--mobile overlay "></div><nav class="main-nav "><div class="container flex flex-jc-sb flex-ai-c"><div class="flex flex-jc-c flex-ai-c"><a class="main-nav__toggle"><i class="r7-icon text-white"></i></a></div><a class="main-nav__logo flex flex-jc-c flex-ai-c text-center" href="https://www.rapid7.com/" target=""><img src="/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg" alt="Rapid7 Home"/></a><a class="search flex flex-jc-c flex-ai-c"><i class="r7-icon r7-icon-search-magnify text-white"></i></a></div><div class="main-nav__links flex flex-jc-c"><ul><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="" aria-role="button" aria-haspopup="dialog" aria-controls="0a0b0e71-3076-41d7-b5e7-7b3b7fede7bd">Platform</a><div id="0a0b0e71-3076-41d7-b5e7-7b3b7fede7bd" class="dropdown-content two-col" role="dialog" aria-labelledby="Platform"><div class="dropdown-view-all"><ul class="dropdown-footer"><li class="dropdown-item"><div class="dropdown-text column-pad"><div class="dropdown-footer-pretitle">TECHNOLOGY</div><div class="dropdown-footer-title">The Rapid7 Command Platform</div><div class="dropdown-footer-subtitle">AI-Powered Cybersecurity Platform</div></div><div class="dropdown-button column-pad"><a href="/products/command/attack-surface-management-asm/trial/" class="button" aria-role="button">Start Trial</a></div></li></ul></div><ul class="dropdown-menu"><li class="dropdown-title">PLATFORM</li><li class="dropdown-item"><a href="/platform/"><div class="dropdown-text">Platform<div class="dropdown-category">ELITE TECHNOLOGY</div></div></a></li><li class="dropdown-item"><a href="/platform/artificial-intelligence-features/"><div class="dropdown-text">AI-Engine<div class="dropdown-category">INTELLIGENT TOOLS</div></div></a></li><li class="dropdown-item"><a href="/research/"><div class="dropdown-text">Rapid7 Labs<div class="dropdown-category">TRUSTED INTELLIGENCE</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">SOLUTIONS</li><li class="dropdown-item"><a href="/services/managed-detection-and-response-mdr/"><div class="dropdown-text">Managed Threat Complete<div class="dropdown-category">MANAGED XDR</div></div></a></li><li class="dropdown-item"><a href="/products/command/attack-surface-management-asm/"><div class="dropdown-text">Surface Command<div class="dropdown-category">ATTACK SURFACE MANAGEMENT</div></div></a></li><li class="dropdown-item"><a href="/products/command/exposure-management/"><div class="dropdown-text">Exposure Command<div class="dropdown-category">EXPOSURE MANAGEMENT</div></div></a></li></ul></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="/products/" aria-role="button" aria-haspopup="dialog" aria-controls="e6abadf9-2a40-44df-b872-4255d64f8f25">Products</a><div id="e6abadf9-2a40-44df-b872-4255d64f8f25" class="dropdown-content two-col" role="dialog" aria-labelledby="Products"><div class="dropdown-view-all"><ul class="dropdown-footer"><li class="dropdown-item"><div class="dropdown-text column-pad"><div class="dropdown-footer-pretitle">NEW!</div><div class="dropdown-footer-title">Surface Command</div><div class="dropdown-footer-subtitle">Unlock a continuous 360° view of your attack surface</div></div><div class="dropdown-button column-pad"><a href="/products/command/attack-surface-management-asm/trial/" class="button" aria-role="button">FREE TRIAL</a></div></li></ul></div><ul class="dropdown-menu"><li class="dropdown-title">DETECTION &amp; RESPONSE</li><li class="dropdown-item"><a href="/products/insightidr/"><div class="dropdown-text">Next-Gen SIEM<div class="dropdown-category">INSIGHTIDR</div></div></a></li><li class="dropdown-item"><a href="/products/threat-command/"><div class="dropdown-text">Threat Intelligence<div class="dropdown-category">THREAT COMMAND</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">EXPOSURE MANAGEMENT</li><li class="dropdown-item"><a href="/products/command/exposure-management/"><div class="dropdown-text">Exposure Management<div class="dropdown-category">EXPOSURE COMMAND</div></div></a></li><li class="dropdown-item"><a href="/products/command/attack-surface-management-asm/"><div class="dropdown-text">Attack Surface Management<div class="dropdown-category">SURFACE COMMAND</div></div></a></li><li class="dropdown-item"><a href="/products/insightvm/"><div class="dropdown-text">Vulnerability Management<div class="dropdown-category">INSIGHTVM</div></div></a></li><li class="dropdown-item"><a href="/products/insightcloudsec/"><div class="dropdown-text">Cloud-Native Application Protection<div class="dropdown-category">INSIGHTCLOUDSEC</div></div></a></li><li class="dropdown-item"><a href="/products/insightappsec/"><div class="dropdown-text">Application Security Testing<div class="dropdown-category">INSIGHTAPPSEC</div></div></a></li></ul></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="/services/" aria-role="button" aria-haspopup="dialog" aria-controls="bc596dd7-4ce4-40c5-b736-5a2cb7fd412f">Services</a><div id="bc596dd7-4ce4-40c5-b736-5a2cb7fd412f" class="dropdown-content two-col" role="dialog" aria-labelledby="Services"><div class="dropdown-view-all"><ul class="dropdown-footer"><li class="dropdown-item"><div class="dropdown-text column-pad"><div class="dropdown-footer-pretitle">MXDR</div><div class="dropdown-footer-title">Managed Threat Complete</div><div class="dropdown-footer-subtitle">24x7 MXDR to secure your extended ecosystem</div></div><div class="dropdown-button column-pad"><a href="/services/managed-detection-and-response-mdr/demo/" class="button" aria-role="button">Request Demo</a></div></li></ul></div><ul class="dropdown-menu"><li class="dropdown-title">DETECTION &amp; RESPONSE</li><li class="dropdown-item"><a href="/services/managed-detection-and-response-mdr/"><div class="dropdown-text">Managed XDR<div class="dropdown-category">MANAGED THREAT COMPLETE</div></div></a></li><li class="dropdown-item"><a href="/services/incident-response-customer-escalation/"><div class="dropdown-text">Incident Response Services<div class="dropdown-category">EXPERIENCING A BREACH?</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">EXPOSURE MANAGEMENT</li><li class="dropdown-item"><a href="/services/managed-vulnerability-management/"><div class="dropdown-text">Managed Vulnerability Management<div class="dropdown-category">OPTIMIZED RISK ASSESSMENT</div></div></a></li><li class="dropdown-item"><a href="/services/managed-application-security/"><div class="dropdown-text">Managed Application Security<div class="dropdown-category">MANAGED DAST</div></div></a></li><li class="dropdown-item"><a href="/services/continuous-red-team-service/"><div class="dropdown-text">Continuous Red Teaming<div class="dropdown-category">VECTOR COMMAND</div></div></a></li><li class="dropdown-item"><a href="/services/penetration-testing/"><div class="dropdown-text">Penetration Testing Services<div class="dropdown-category">TEST YOUR DEFENSES</div></div></a></li></ul></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="" aria-role="button" aria-haspopup="dialog" aria-controls="db2ef2ac-facd-4544-a941-c2f524502d88">Resources</a><div id="db2ef2ac-facd-4544-a941-c2f524502d88" class="dropdown-content two-col" role="dialog" aria-labelledby="Resources"><div class="dropdown-view-all"><ul class="dropdown-footer"><li class="dropdown-item"><div class="dropdown-text column-pad"><div class="dropdown-footer-pretitle">NEW</div><div class="dropdown-footer-title">The Take Command Summit is back!</div><div class="dropdown-footer-subtitle">Our largest virtual event returns Apr. 9</div></div><div class="dropdown-button column-pad"><a href="https://rapid7.brighttalk.com/?utm_source=referral&amp;utm_medium=website&amp;utm_campaign=global-pla-take-command-summit-prospect-eng" class="button" aria-role="button">Register</a></div></li></ul></div><ul class="dropdown-menu"><li class="dropdown-title">STAY CURRENT</li><li class="dropdown-item"><a href="/research/"><div class="dropdown-text">About Rapid7 Labs<div class="dropdown-category">MEET THE RESEARCH TEAM</div></div></a></li><li class="dropdown-item"><a href="/about/events-webcasts/"><div class="dropdown-text">Events &amp; Webinars<div class="dropdown-category">CATCH US LIVE</div></div></a></li><li class="dropdown-item"><a href="/resources/"><div class="dropdown-text">Resources Library<div class="dropdown-category">DIVE INTO THE DETAILS</div></div></a></li><li class="dropdown-item"><a href="/blog/"><div class="dropdown-text">The Rapid7 Blog<div class="dropdown-category">STAY UP-TO-DATE</div></div></a></li><li class="dropdown-item"><a href="/db/"><div class="dropdown-text">Exploit Database<div class="dropdown-category">SEARCH THOUSANDS OF CVES</div></div></a></li><li class="dropdown-item"><a href="/fundamentals/"><div class="dropdown-text">Cybersecurity Fundamentals<div class="dropdown-category">LEARN THE BASICS</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">PRODUCT SUPPORT</li><li class="dropdown-item"><a href="/contact/"><div class="dropdown-text">Contact Sales<div class="dropdown-category">TALK TO AN EXPERT</div></div></a></li><li class="dropdown-item"><a href="/for-customers/"><div class="dropdown-text">Customer Support Portal<div class="dropdown-category">CONTACT SUPPORT</div></div></a></li><li class="dropdown-item"><a href="https://extensions.rapid7.com/"><div class="dropdown-text">Product Integrations<div class="dropdown-category">CONNECT EVERYTHING</div></div></a></li><li class="dropdown-item"><a href="https://docs.rapid7.com/"><div class="dropdown-text">Product Documentation<div class="dropdown-category">PRODUCT AND SERVICES GUIDES</div></div></a></li><li class="dropdown-item"><a href="https://docs.rapid7.com/release-notes/"><div class="dropdown-text">Product Release Notes<div class="dropdown-category">LATEST FEATURES</div></div></a></li><li class="dropdown-item"><a href="/product-tours/"><div class="dropdown-text">Interactive Product Tours<div class="dropdown-category">TAKE TOUR</div></div></a></li></ul></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="/about/company/" aria-role="button" aria-haspopup="dialog" aria-controls="fb71e4de-90c6-4478-926e-8237f92838b0">Company</a><div id="fb71e4de-90c6-4478-926e-8237f92838b0" class="dropdown-content two-col" role="dialog" aria-labelledby="Company"><ul class="dropdown-menu"><li class="dropdown-title">OVERVIEW</li><li class="dropdown-item"><a href="/about/company/"><div class="dropdown-text">About Us<div class="dropdown-category">OUR STORY</div></div></a></li><li class="dropdown-item"><a href="/about/leadership/"><div class="dropdown-text">Leadership<div class="dropdown-category">EXECUTIVE TEAM &amp; BOARD</div></div></a></li><li class="dropdown-item"><a href="/about/news/"><div class="dropdown-text">News &amp; Press Releases<div class="dropdown-category">THE LATEST FROM OUR NEWSROOM</div></div></a></li><li class="dropdown-item"><a href="https://careers.rapid7.com/"><div class="dropdown-text">Careers<div class="dropdown-category">JOIN RAPID7</div></div></a></li><li class="dropdown-item"><a href="/customers/"><div class="dropdown-text">Our Customers<div class="dropdown-category">Their Success Stories</div></div></a></li><li class="dropdown-item"><a href="/partners/"><div class="dropdown-text">Partners<div class="dropdown-category">Rapid7 Partner Ecosystem</div></div></a></li><li class="dropdown-item"><a href="https://investors.rapid7.com/"><div class="dropdown-text">Investors<div class="dropdown-category">Investor Relations</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">COMMUNITY &amp; CULTURE</li><li class="dropdown-item"><a href="/about/social-good/"><div class="dropdown-text">Social Good<div class="dropdown-category">OUR COMMITMENT &amp; APPROACH</div></div></a></li><li class="dropdown-item"><a href="/about/rapid7-foundation/"><div class="dropdown-text">Rapid7 Cybersecurity Foundation<div class="dropdown-category">BUILDING THE FUTURE</div></div></a></li><li class="dropdown-item"><a href="/about/diversity-equity-and-inclusion/"><div class="dropdown-text">Diversity, Equity &amp; Inclusion<div class="dropdown-category">EMPOWERING PEOPLE</div></div></a></li><li class="dropdown-item"><a href="/open-source/"><div class="dropdown-text">Open Source<div class="dropdown-category">STRENGTHENING CYBERSECURITY</div></div></a></li><li class="dropdown-item"><a href="/about/public-policy/"><div class="dropdown-text">Public Policy<div class="dropdown-category">ENGAGEMENT &amp; ADVOCACY</div></div></a></li><li class="dropdown-item"><a href="/about/rapid7-cybersecurity-partner-boston-bruins/"><div class="dropdown-text">Boston Bruins<div class="dropdown-category">Our Partnership</div></div></a></li></ul></div></li><li class="main-nav__link   "><a class="" href="/partners/" aria-role="button" aria-haspopup="" aria-controls="e4ca0e6e-5830-4b04-bdd4-d0dcbb520ba9">Partners</a></li><li class="dropdown  main-nav__link main-nav__link--sep"><a href="#" class="dropdown-trigger has-toggle ">en</a><div class="dropdown-content right-align"><ul class="dropdown-menu"><li class="dropdown-item selected"><a href="#">English</a></li></ul></div></li><li class="main-nav__link"><a href="https://insight.rapid7.com/saml/SSO" class="has-icon"><img src="/Areas/Docs/includes/img/r7-nav/icon-lock.svg" alt=""/> Sign In</a></li></ul></div></nav><nav class="sub-nav container flex flex-ai-c"><div class="sub-nav__title"><a href="/blog/" title="Blog">Blog</a></div><ul><li class="sub-nav__link dropdown "><a class="dropdown-trigger has-toggle">Select</a><div class="dropdown-content"><ul class="dropdown-menu"><li class="dropdown-item"><a href="/blog/tag/vulnerability-management/">Vulnerability Management</a></li><li class="dropdown-item"><a href="/blog/tag/mdr-managed-detection-response/">MDR</a></li><li class="dropdown-item"><a href="/blog/tag/detection-and-response/">Detection &amp; Response</a></li><li class="dropdown-item"><a href="/blog/tag/cloud-security/">Cloud Security</a></li><li class="dropdown-item"><a href="/blog/tag/application-security/">App Security</a></li><li class="dropdown-item"><a href="/blog/tag/metasploit/">Metasploit</a></li><li class="dropdown-item"><a href="/blog/tags/">All Topics</a></li></ul></div></li></ul><a class="button button--primary" href="/trial/insight/">Start Trial</a></nav></header><div class="dropdown-overlay overlay false"></div><header class="r7-nav stuck show-main--init "><nav class="main-nav"><div class="container flex flex-jc-sb flex-ai-c"><div class="main-nav__logo"><a class="flex" href="https://www.rapid7.com/" target=""><img src="/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg" alt="Rapid7 Home"/></a></div><div class="main-nav__links flex flex-jc-c"><ul><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="" aria-role="button" aria-haspopup="dialog" aria-controls="0a0b0e71-3076-41d7-b5e7-7b3b7fede7bd">Platform</a><div id="0a0b0e71-3076-41d7-b5e7-7b3b7fede7bd" class="dropdown-content two-col" role="dialog" aria-labelledby="Platform"><div class="dropdown-view-all"><ul class="dropdown-footer"><li class="dropdown-item"><div class="dropdown-text column-pad"><div class="dropdown-footer-pretitle">TECHNOLOGY</div><div class="dropdown-footer-title">The Rapid7 Command Platform</div><div class="dropdown-footer-subtitle">AI-Powered Cybersecurity Platform</div></div><div class="dropdown-button column-pad"><a href="/products/command/attack-surface-management-asm/trial/" class="button" aria-role="button">Start Trial</a></div></li></ul></div><ul class="dropdown-menu"><li class="dropdown-title">PLATFORM</li><li class="dropdown-item"><a href="/platform/"><div class="dropdown-text">Platform<div class="dropdown-category">ELITE TECHNOLOGY</div></div></a></li><li class="dropdown-item"><a href="/platform/artificial-intelligence-features/"><div class="dropdown-text">AI-Engine<div class="dropdown-category">INTELLIGENT TOOLS</div></div></a></li><li class="dropdown-item"><a href="/research/"><div class="dropdown-text">Rapid7 Labs<div class="dropdown-category">TRUSTED INTELLIGENCE</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">SOLUTIONS</li><li class="dropdown-item"><a href="/services/managed-detection-and-response-mdr/"><div class="dropdown-text">Managed Threat Complete<div class="dropdown-category">MANAGED XDR</div></div></a></li><li class="dropdown-item"><a href="/products/command/attack-surface-management-asm/"><div class="dropdown-text">Surface Command<div class="dropdown-category">ATTACK SURFACE MANAGEMENT</div></div></a></li><li class="dropdown-item"><a href="/products/command/exposure-management/"><div class="dropdown-text">Exposure Command<div class="dropdown-category">EXPOSURE MANAGEMENT</div></div></a></li></ul></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="/products/" aria-role="button" aria-haspopup="dialog" aria-controls="e6abadf9-2a40-44df-b872-4255d64f8f25">Products</a><div id="e6abadf9-2a40-44df-b872-4255d64f8f25" class="dropdown-content two-col" role="dialog" aria-labelledby="Products"><div class="dropdown-view-all"><ul class="dropdown-footer"><li class="dropdown-item"><div class="dropdown-text column-pad"><div class="dropdown-footer-pretitle">NEW!</div><div class="dropdown-footer-title">Surface Command</div><div class="dropdown-footer-subtitle">Unlock a continuous 360° view of your attack surface</div></div><div class="dropdown-button column-pad"><a href="/products/command/attack-surface-management-asm/trial/" class="button" aria-role="button">FREE TRIAL</a></div></li></ul></div><ul class="dropdown-menu"><li class="dropdown-title">DETECTION &amp; RESPONSE</li><li class="dropdown-item"><a href="/products/insightidr/"><div class="dropdown-text">Next-Gen SIEM<div class="dropdown-category">INSIGHTIDR</div></div></a></li><li class="dropdown-item"><a href="/products/threat-command/"><div class="dropdown-text">Threat Intelligence<div class="dropdown-category">THREAT COMMAND</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">EXPOSURE MANAGEMENT</li><li class="dropdown-item"><a href="/products/command/exposure-management/"><div class="dropdown-text">Exposure Management<div class="dropdown-category">EXPOSURE COMMAND</div></div></a></li><li class="dropdown-item"><a href="/products/command/attack-surface-management-asm/"><div class="dropdown-text">Attack Surface Management<div class="dropdown-category">SURFACE COMMAND</div></div></a></li><li class="dropdown-item"><a href="/products/insightvm/"><div class="dropdown-text">Vulnerability Management<div class="dropdown-category">INSIGHTVM</div></div></a></li><li class="dropdown-item"><a href="/products/insightcloudsec/"><div class="dropdown-text">Cloud-Native Application Protection<div class="dropdown-category">INSIGHTCLOUDSEC</div></div></a></li><li class="dropdown-item"><a href="/products/insightappsec/"><div class="dropdown-text">Application Security Testing<div class="dropdown-category">INSIGHTAPPSEC</div></div></a></li></ul></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="/services/" aria-role="button" aria-haspopup="dialog" aria-controls="bc596dd7-4ce4-40c5-b736-5a2cb7fd412f">Services</a><div id="bc596dd7-4ce4-40c5-b736-5a2cb7fd412f" class="dropdown-content two-col" role="dialog" aria-labelledby="Services"><div class="dropdown-view-all"><ul class="dropdown-footer"><li class="dropdown-item"><div class="dropdown-text column-pad"><div class="dropdown-footer-pretitle">MXDR</div><div class="dropdown-footer-title">Managed Threat Complete</div><div class="dropdown-footer-subtitle">24x7 MXDR to secure your extended ecosystem</div></div><div class="dropdown-button column-pad"><a href="/services/managed-detection-and-response-mdr/demo/" class="button" aria-role="button">Request Demo</a></div></li></ul></div><ul class="dropdown-menu"><li class="dropdown-title">DETECTION &amp; RESPONSE</li><li class="dropdown-item"><a href="/services/managed-detection-and-response-mdr/"><div class="dropdown-text">Managed XDR<div class="dropdown-category">MANAGED THREAT COMPLETE</div></div></a></li><li class="dropdown-item"><a href="/services/incident-response-customer-escalation/"><div class="dropdown-text">Incident Response Services<div class="dropdown-category">EXPERIENCING A BREACH?</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">EXPOSURE MANAGEMENT</li><li class="dropdown-item"><a href="/services/managed-vulnerability-management/"><div class="dropdown-text">Managed Vulnerability Management<div class="dropdown-category">OPTIMIZED RISK ASSESSMENT</div></div></a></li><li class="dropdown-item"><a href="/services/managed-application-security/"><div class="dropdown-text">Managed Application Security<div class="dropdown-category">MANAGED DAST</div></div></a></li><li class="dropdown-item"><a href="/services/continuous-red-team-service/"><div class="dropdown-text">Continuous Red Teaming<div class="dropdown-category">VECTOR COMMAND</div></div></a></li><li class="dropdown-item"><a href="/services/penetration-testing/"><div class="dropdown-text">Penetration Testing Services<div class="dropdown-category">TEST YOUR DEFENSES</div></div></a></li></ul></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="" aria-role="button" aria-haspopup="dialog" aria-controls="db2ef2ac-facd-4544-a941-c2f524502d88">Resources</a><div id="db2ef2ac-facd-4544-a941-c2f524502d88" class="dropdown-content two-col" role="dialog" aria-labelledby="Resources"><div class="dropdown-view-all"><ul class="dropdown-footer"><li class="dropdown-item"><div class="dropdown-text column-pad"><div class="dropdown-footer-pretitle">NEW</div><div class="dropdown-footer-title">The Take Command Summit is back!</div><div class="dropdown-footer-subtitle">Our largest virtual event returns Apr. 9</div></div><div class="dropdown-button column-pad"><a href="https://rapid7.brighttalk.com/?utm_source=referral&amp;utm_medium=website&amp;utm_campaign=global-pla-take-command-summit-prospect-eng" class="button" aria-role="button">Register</a></div></li></ul></div><ul class="dropdown-menu"><li class="dropdown-title">STAY CURRENT</li><li class="dropdown-item"><a href="/research/"><div class="dropdown-text">About Rapid7 Labs<div class="dropdown-category">MEET THE RESEARCH TEAM</div></div></a></li><li class="dropdown-item"><a href="/about/events-webcasts/"><div class="dropdown-text">Events &amp; Webinars<div class="dropdown-category">CATCH US LIVE</div></div></a></li><li class="dropdown-item"><a href="/resources/"><div class="dropdown-text">Resources Library<div class="dropdown-category">DIVE INTO THE DETAILS</div></div></a></li><li class="dropdown-item"><a href="/blog/"><div class="dropdown-text">The Rapid7 Blog<div class="dropdown-category">STAY UP-TO-DATE</div></div></a></li><li class="dropdown-item"><a href="/db/"><div class="dropdown-text">Exploit Database<div class="dropdown-category">SEARCH THOUSANDS OF CVES</div></div></a></li><li class="dropdown-item"><a href="/fundamentals/"><div class="dropdown-text">Cybersecurity Fundamentals<div class="dropdown-category">LEARN THE BASICS</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">PRODUCT SUPPORT</li><li class="dropdown-item"><a href="/contact/"><div class="dropdown-text">Contact Sales<div class="dropdown-category">TALK TO AN EXPERT</div></div></a></li><li class="dropdown-item"><a href="/for-customers/"><div class="dropdown-text">Customer Support Portal<div class="dropdown-category">CONTACT SUPPORT</div></div></a></li><li class="dropdown-item"><a href="https://extensions.rapid7.com/"><div class="dropdown-text">Product Integrations<div class="dropdown-category">CONNECT EVERYTHING</div></div></a></li><li class="dropdown-item"><a href="https://docs.rapid7.com/"><div class="dropdown-text">Product Documentation<div class="dropdown-category">PRODUCT AND SERVICES GUIDES</div></div></a></li><li class="dropdown-item"><a href="https://docs.rapid7.com/release-notes/"><div class="dropdown-text">Product Release Notes<div class="dropdown-category">LATEST FEATURES</div></div></a></li><li class="dropdown-item"><a href="/product-tours/"><div class="dropdown-text">Interactive Product Tours<div class="dropdown-category">TAKE TOUR</div></div></a></li></ul></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="/about/company/" aria-role="button" aria-haspopup="dialog" aria-controls="fb71e4de-90c6-4478-926e-8237f92838b0">Company</a><div id="fb71e4de-90c6-4478-926e-8237f92838b0" class="dropdown-content two-col" role="dialog" aria-labelledby="Company"><ul class="dropdown-menu"><li class="dropdown-title">OVERVIEW</li><li class="dropdown-item"><a href="/about/company/"><div class="dropdown-text">About Us<div class="dropdown-category">OUR STORY</div></div></a></li><li class="dropdown-item"><a href="/about/leadership/"><div class="dropdown-text">Leadership<div class="dropdown-category">EXECUTIVE TEAM &amp; BOARD</div></div></a></li><li class="dropdown-item"><a href="/about/news/"><div class="dropdown-text">News &amp; Press Releases<div class="dropdown-category">THE LATEST FROM OUR NEWSROOM</div></div></a></li><li class="dropdown-item"><a href="https://careers.rapid7.com/"><div class="dropdown-text">Careers<div class="dropdown-category">JOIN RAPID7</div></div></a></li><li class="dropdown-item"><a href="/customers/"><div class="dropdown-text">Our Customers<div class="dropdown-category">Their Success Stories</div></div></a></li><li class="dropdown-item"><a href="/partners/"><div class="dropdown-text">Partners<div class="dropdown-category">Rapid7 Partner Ecosystem</div></div></a></li><li class="dropdown-item"><a href="https://investors.rapid7.com/"><div class="dropdown-text">Investors<div class="dropdown-category">Investor Relations</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">COMMUNITY &amp; CULTURE</li><li class="dropdown-item"><a href="/about/social-good/"><div class="dropdown-text">Social Good<div class="dropdown-category">OUR COMMITMENT &amp; APPROACH</div></div></a></li><li class="dropdown-item"><a href="/about/rapid7-foundation/"><div class="dropdown-text">Rapid7 Cybersecurity Foundation<div class="dropdown-category">BUILDING THE FUTURE</div></div></a></li><li class="dropdown-item"><a href="/about/diversity-equity-and-inclusion/"><div class="dropdown-text">Diversity, Equity &amp; Inclusion<div class="dropdown-category">EMPOWERING PEOPLE</div></div></a></li><li class="dropdown-item"><a href="/open-source/"><div class="dropdown-text">Open Source<div class="dropdown-category">STRENGTHENING CYBERSECURITY</div></div></a></li><li class="dropdown-item"><a href="/about/public-policy/"><div class="dropdown-text">Public Policy<div class="dropdown-category">ENGAGEMENT &amp; ADVOCACY</div></div></a></li><li class="dropdown-item"><a href="/about/rapid7-cybersecurity-partner-boston-bruins/"><div class="dropdown-text">Boston Bruins<div class="dropdown-category">Our Partnership</div></div></a></li></ul></div></li><li class="main-nav__link   "><a class="" href="/partners/" aria-role="button" aria-haspopup="" aria-controls="e4ca0e6e-5830-4b04-bdd4-d0dcbb520ba9">Partners</a></li></ul></div><div class="main-nav__utility"><ul><li class="dropdown  language"><a href="#" class="dropdown-trigger has-toggle ">en</a><div class="dropdown-content right-align"><ul class="dropdown-menu"><li class="dropdown-item selected"><a href="#">English</a></li></ul></div></li><li class="signin"><a href="https://insight.rapid7.com/saml/SSO"><img src="/Areas/Docs/includes/img/r7-nav/icon-lock.svg" alt=""/>Sign In</a></li></ul></div></div></nav><section class="search-bar hide"><div class="container flex flex-jc-c flex-ai-c"><form action="/search" class="search-content flex flex-jc-c flex-ai-c"><i class="r7-icon r7-icon-search-magnify"></i><input type="search" class="search-input" name="q" autoComplete="off" placeholder="Search"/><input type="submit" class="search-submit button blue" value="Search"/><a class="search-close"><i class="r7-icon r7-icon-delete-x"></i></a></form></div></section><div class="search-overlay overlay "></div><nav class="sub-nav "><div class="container flex flex-jc-sb"><a class="logo circle-button" href="https://www.rapid7.com/"><img src="/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg" alt="Rapid7 logo"/></a><div class="sub-nav__links flex"><ul class="flex flex-ai-c"><li class="sub-nav__title"><a href="/blog/" title="Blog">Blog</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/vulnerability-management/">Vulnerability Management</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/mdr-managed-detection-response/">MDR</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/detection-and-response/">Detection &amp; Response</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/cloud-security/">Cloud Security</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/application-security/">App Security</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/metasploit/">Metasploit</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tags/">All Topics</a></li></ul></div><div class="sub-nav__utility"><a class="search" role="button" tabindex="0"><i class="r7-icon r7-icon-search-magnify"></i></a><a class="button button--primary" href="/trial/insight/">Start Trial</a><a class="to-top circle-button" tabindex="0"><i class="r7-icon r7-icon-arrow-chevron-up-solid"></i></a></div></div></nav></header>
        </div>

        
        <div class="off-canvas-content" data-off-canvas-content>
            <div id="menuOverlay" class="reveal-overlay"></div>
                                <section class="longhero">
                        <div class="grid-container">
                            <div class="grid-x grid-padding-x expanded">
                                <div class="medium-12 cell"></div>
                            </div>
                        </div>
                    </section>
            




<div class="pageContent">
    <section class="blog-single-post">
        <div class="grid-container">
            <div class="grid-x grid-padding-x">
                <div class="small-12 medium-6 medium-offset-1 large-7 large-offset-1 cell blog-single-post__main-column">
                    <div class="grid-y">
                        <div class="blog-single-post__main-column--heading">
                            <h1>Automating Qakbot Detection at Scale With Velociraptor</h1>
                            <div>
                                <ul class="blog-post-info">
                                        <li class="date">Apr 18, 2023</li>
                                                                            <li class="time">6 min read</li>
                                    <li class="name">
                                        <a href="/blog/author/mgreen27/">Matthew Green</a>
                                    </li>
                                </ul>
                                <ul class="blog-post-social float-right">
                                    <li><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.rapid7.com/blog/post/2023/04/18/automating-qakbot-detection-at-scale-with/&amp;title=Automating+Qakbot+Detection+at+Scale+With+Velociraptor&amp;summary=This+blog+offers+a+practical+methodology+to+extract+configuration+data+from+recent+Qakbot+samples." class="linkedin" onclick="window.open(this.href, 'linkedin-share', 'width=520,height=570');return false;"></a></li>
                                    <li><a href="https://twitter.com/intent/tweet?text=Automating+Qakbot+Detection+at+Scale+With+Velociraptor&amp;url=http%3a%2f%2fwww.rapid7.com%2fblog%2fpost%2f2023%2f04%2f18%2fautomating-qakbot-detection-at-scale-with%2f" class="twitter-x" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"></a></li>
                                    <li><a href="https://www.facebook.com/sharer/sharer.php?u=http://www.rapid7.com/blog/post/2023/04/18/automating-qakbot-detection-at-scale-with/" class="facebook" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"></a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="post-content">
                                <p><i class="updated-at">Last updated at Tue, 09 May 2023 14:07:06 GMT</i></p>
                            <p>In this blog, you will learn a practical methodology to extract configuration data from recent Qakbot samples. I will provide some background on Qakbot, then walk through decode themes in an easy to visualize manner. Additionally, I'll share a <a href="https://www.rapid7.com/products/velociraptor/">Velociraptor</a> artifact to detect and automate the decode process at scale.</p><p>QakBot or QBot, is a modular malware first observed in 2007 that has been historically known as a banking Trojan. Qakbot is used to steal credentials, financial, or other endpoint data, and in recent years, regularly a loader for other malware leading to hands-on-keyboard ransomware.</p><p>Malicious emails typically include a zipped attachment, LNK, Javascript, Documents, or an embedded executable. The example shown in this post was delivered by an email with an attached pdf file:<br></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh4.googleusercontent.com/bFo4eGRtvuQ7ySZvdIWi9JQlXlxM3KurakVDZXNKhBmxspbW8d8zmjCwMP1dlqU00x5oK2bOXrJIpcS9TW0P8x4suUhS-znEvuyZ81tGWFtPPrA91g0MtkNBIOJd4ybe-2XN4VYlZw1eeSSqIQ7OEI0" class="kg-image"><figcaption>An example Qakbot infection chain</figcaption></figure><p></p><p>Qakbot has some notable defense evasion capabilities including:</p><ol><li>Checking for Windows Defender sandbox and terminating on discovery.</li><li>Checking for the presence of running anti-virus or analysis tools, then modifying its later stage behavior for evasion.</li><li>Dynamic corruption of payload on startup and rewrite on system shutdown.</li></ol><p>Due to the commodity nature of Qakbot delivery, capabilities, and end game,  it is worth extracting configuration from observed samples to scope impact from a given campaign. Hunting enterprise-wide and finding a previously missed machine or discovering an ineffective control can prevent a domain-wide ransomware event or similar cyber attacks.</p><h2 id="configuration">Configuration</h2><p>Qakbot has an RC4 encoded configuration, located inside two resources of the unpacked payload binary. The decryption process has not changed significantly in recent times, but for some minor key changes. It uses a SHA1 of a hard coded key that can typically be extracted as an encoded string in the .data section of the payload binary. This key often remains static across campaigns, which can speed up analysis if we maintain a recent key list.</p><p>Current samples undergo two rounds of RC4 decryption with validation built in. The validation bytes dropped from the data for the second round.</p><p>After the first round:</p><ul><li>The first 20 bytes in hex is for validation and is compared with the SHA1 of the remaining decoded data</li><li>Bytes [20:40] is the key used for the second round of decoding.</li><li>The Data to decode is byte [40:] onwards</li><li>The same validation process occurs for the second round decoded data</li><li>Verification = data[:20]</li><li>DecodedData = data[20:]</li></ul><p></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh5.googleusercontent.com/evG3uVwqv7xIdOHE3WEjIV2sUhWJ9RWdDNEY-vTu-CZmlayciaivpQN1UpMZi9xRmvOWs40cZE5gINgpCHMcgXzyeMHig-pq8uOB_B_BIzjDQQAUJYQKGr675GkKBsxp8_sGyvhV-BS0Z9Y__r3GbSA" class="kg-image"><figcaption>First round of Qakbot decode and verification</figcaption></figure><p><br>Campaign information is located inside the smaller resource where, after this decoding and verification process, data is clear text.</p><figure class="kg-card kg-image-card"><img src="https://lh6.googleusercontent.com/HJMPh-6JtB7uAJ7JWxVW2yee4Uf8vOvGEEyFEu9FWrnw51hf6ebN3HXB-O9igoj4MzZbR2MxmUFw5Arrkt8LCGTAE8RbFJrlH3HKZ_grrDqoLhKHAVkk1s7mcqS7BQz3zd0R2gAyYb6O6tsLEHgLDLE" class="kg-image"></figure><p><br>The larger resource stores Command and Control configuration. This is typically stored in netaddress format with varying separators. A common technique for finding the correct method is searching for common ports and separator patterns in the decoded data.<br></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh6.googleusercontent.com/yiIVnv8jFHh4RNdt0cYa2YMI07CK_BR_Gsbd-B1bkuv5ES9uxZyfsDOYfCCqSrZ7OVZa-mAOeZnt9DYeqlSzF9JeorkIrD2jhfEwGmL_-puILK0nUie9LUJ3PpJbn6Ei7VVauYIGSzbzscKOC9jCKcM" class="kg-image"><figcaption>Easy to spot C2 patterns: port 443</figcaption></figure><h2 id="encoded-strings"><br>Encoded strings</h2><p>Qakbot stores blobs of xor encoded strings inside the .data section of its payload binary. The current methodology is to extract blobs of key and data from the referenced key offset which similarly is reused across samples.</p><p>Current samples start at offset 0x50, with an xor key, followed by a separator of 0x0000 before encoded data. In recent samples, we have observed more than one string blob and these have occurred in the same format after the separator.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh6.googleusercontent.com/az7KcdRMS-jHCq4CFjO0HM-6u7Bj1k-FCvHTSj7BZBruiDwNIKnB-589BCFMcxYDT-CZU5xo36YPqlg4NPLqpFT2mAyBu8LoTyIsEDzkICyUmw68XRWgrjIkYLet9iLjh4MsTGLg4f7xRwO1qDIuBao" class="kg-image"><figcaption>Encoded strings .data</figcaption></figure><p><br>Next steps are splitting on separators, decode expected blob pairs and drop any non printable. Results are fairly obvious when decoding is successful as Qakbot produces clean strings. I typically have seen two well defined groups with strings aligning to Qakbot capabilities.</p><p></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh4.googleusercontent.com/SzUQWMEWV02_0-5nZtshwUaQmyI9gvqll0cl-jAtxrUClwVPgtTUs07vc2RX4rS14FNvw1VryvNJTxLKHujWHis2mlk0lfOK3ooOWRWRxG1BsswHIUmCTtsMKRWaEn54wJUAKJNnXvyjAcJFSeikvWk" class="kg-image"><figcaption>Decoded strings: RC4 key highlighted<span class="-mobiledoc-kit__atom">‌‌</span></figcaption></figure><h2 id="payload"><br>Payload</h2><p>Qakbot samples are typically packed and need execution or manual unpacking to retrieve the payload for analysis. It's very difficult to obtain this payload remotely at scale, in practice the easiest way is to execute the sample in a VM or sandbox that enables extracting the payload with correct PE offsets.</p><p>When executing locally Qakbot typically injects its payload into a Windows process, and can be detected with yara targeting the process for an unbacked section with `PAGE_EXECUTE_READWRITE` protections.</p><p>Below, we have an example of running PE-Sieve / Hollows Hunter tool from Hasherezade. This helpful tool enables detection of several types of process injection, and the dumping of injected sections with appropriately aligned headers. In this case, the injected process is `wermgr.exe` but it's worth to note, depending on variant and process footprint, your injected process may vary.<br></p><figure class="kg-card kg-image-card"><img src="https://lh3.googleusercontent.com/HitEoq0WJd3bDa3XpkKicncTFFZ68Gxg2-LJdGbiO5AqVfAg7nXzxM6zDRqY4Hd-YrC5_m4cLQYVe0l7OMmvGYE83nglx5TLfl8GwOPk_UM83rX9rY0g38IUdldPnCvp1PJWRP6R1FRfqqttqlwZEcE" class="kg-image"></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh3.googleusercontent.com/w-BNGFSSN0ZgpvqpBCL1AcrMYdFFQdBmPVLgDNWGRbUYj5S55p7GwohMsZiUMeVrCHgk14iIcXnB_lKnwE655q2kh_614U_QlpEpMPv74g60YhYM7ZJcD1BORkh7uFqQ4Xe0fbdnm6XdS_P_9DbjUow" class="kg-image"><figcaption>Dumping Qakbot payload using pe-sieve</figcaption></figure><p></p><h2 id="automation-at-scale">Automation at scale</h2><p>Now I have explained the decode process, time to enable both detection and decode automation in Velociraptor.</p><p>I have recently released <a href="https://docs.velociraptor.app/exchange/artifacts/pages/qakbot/">Windows.Carving.Qakbot</a> which leverages a PE dump capability in Velociraptor 0.6.8 to enable live memory analysis. The goal of the artifact was to automate my decoding workflow for a generic Qakbot parser and save time for a common analysis. I also wanted an easy to update parser to add additional keys or decode nuances when changes are discovered.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh6.googleusercontent.com/L3d1ogIOu6LaZ0q8SthPTDuVMVJDyYIij5OEretIRmmgf9bWEBUD5NMu1CLm14LWJgW4opgxZcv4nRpp72d5sbCfjiilPAYaFsj55S9JdZ6AC-QQb3Znd4EWoDwjPo86-9AHZC_jlELreuhX4XjnTfY" class="kg-image"><figcaption>Windows.Carving.Qakbot: parameters</figcaption></figure><p></p><p>This artifact uses Yara to detect an injected Qakbot payload, then attempts to parse the payload configuration and strings. Some of the features in the artifact cover changes observed in the past in the decryption process to allow a simplified extraction workflow:</p><ul><li>Automatic PE extraction and offset alignment for memory detections.</li><li>StringOffset: the offset of the string xor key and encoded strings is reused regularly.</li><li>PE resource type: the RC4 encoded configuration is typically inside 2 resources, I’ve observed BITMAP and RCDATA</li><li>Unescaped key string: this field is typically reused over samples.</li><li>Type of encoding: single or double, double being the more recent.</li><li>Hidden TargetBytes parameter to enable piping payload in for analysis.</li><li>Worker threads: for bulk analysis / research use cases.<br></li></ul><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh3.googleusercontent.com/bUoYOd2i48lrP_AKH52uUUPrZvVczW2xt4z12N0qYo_WlJ0l6HS6RoOipo-ePrJitE_0jJsNpPyMWeh1NTUwKxKiUIG0NukkjTThysQv331B7yjJAon6NEwV_Ifp_PXvyvGIKRgt0kiF-1-dyevdAQ" class="kg-image"><figcaption>Windows.Carving.Qakbot: live decode&nbsp;</figcaption></figure><p></p><h2 id="research">Research</h2><p>The Qakbot parser can also be leveraged for research and run bulk analysis. One caveat is the content requires payload files that have been dumped with offsets intact. This typically requires some post collection filtering or PE offset realignment but enables Velociraptor notebook to manipulate post processed data.</p><p>Some techniques I have used to bulk collect samples:</p><ul><li>Sandbox with PE dumping features: api based collection</li><li>Virustotal search: <em>crowdsourced_yara_rule:0083a00b09|win_qakbot_auto AND tag:pedll AND NOT tag:corrupt </em>(not this will collect some broken payloads)</li></ul><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh5.googleusercontent.com/g64ccgbEneut21Eb0WTjeTDs4IDS9nCMHKjSky39LBNJaqL4PY8D1ReE1My6gpMYGKVIt5RUm23axJKMYFzQy7kZnTy3DlX0C03XZ1FGcVYrMj81qMo34z6xogAiwATWh2ATxYgbAzxZN0GbZmblq34" class="kg-image"><figcaption>Bulk collection: IPs seen across multiple campaign names and ports</figcaption></figure><p></p><p>Some findings from a small data set ~60 samples:</p><ul><li>Named campaigns are typically short and not longer than a few samples over a few days.</li><li>IP addresses are regularly reused and shared across campaigns</li><li>Most prevalent campaigns are “BB” and  “obama” prefixed</li><li>Minor campaigns observed: “azd”, “tok”  and “rds” with only one or two observed payload samples each.</li></ul><p>Strings analysis can also provide insights to sample behavior over time to assist analysis. A great example is the adding to process name list for anti-analysis checks.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh5.googleusercontent.com/hSRMBCPXtMdzTtGB7vbtCjomsu1omgylxBVAW3goEqT7ScBGizq2PUP7BeUCzs1PQeVb5FMTHFpjDf-a-ZH2GrFPnzy_PiCwI_nch4sigA_--TgGH6l0DZVHHNRtPLMMknEk3DPiFeUBZgWTKFiLU20" class="kg-image"><figcaption>Bulk collection: Strings highlighting anti-analysis check additions over time</figcaption></figure><p></p><h2 id="conclusion">Conclusion</h2><p>PE dumping, which is not available in expensive paid tools, is a useful capability and enables advanced capability at enterprise scale. For widespread threats like Qakbot, this kind of content can significantly improve response for blue teams, or even provide insights into threats when analyzed in bulk. In the coming months, we will be publishing a series of similar blog posts, offering a sneak peek at some of the types of memory analysis enabled by Velociraptor and incorporated into our training courses.</p><p>I also would like to thank Jakob Denlinger and James Dunne for their assistance in writing this post.<br><br></p><p><strong>References</strong></p><ol><li><a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.qakbot">Malpedia, QakBot</a></li><li><a href="https://www.elastic.co/security-labs/qbot-malware-analysis">Elastic, QBOT Malware Analysis</a></li><li>@hasherezade.  Hollows Hunter, <a href="https://github.com/hasherezade/hollows_hunter">https://github.com/hasherezade/hollows_hunter</a></li></ol>
                        </div>
                    </div>
                    <div class="grid-y post-bottom-info__wrapper">
                        <div class="cell-padding">
                            <div class="post-bottom-info" id="post-bottom-info">
                                <div class="grid-x">
                                    <div class="medium-12 large-6 cell text-center large-text-left smpad-btm">
                                        <h4>POST TAGS</h4>
                                        <div class="tag-row wrapper-item">
                                            <div class="blog-resources__tags">
                                                <ul>
                                                        <li>
                                                            <a href="/blog/tag/velociraptor/" title="Velociraptor">Velociraptor</a>
                                                        </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <h4>SHARING IS CARING</h4>
                                        <ul class="blog-post-social">
                                            <li>
                                                <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.rapid7.com/blog/post/2023/04/18/automating-qakbot-detection-at-scale-with/&amp;title=Automating+Qakbot+Detection+at+Scale+With+Velociraptor&amp;summary=This+blog+offers+a+practical+methodology+to+extract+configuration+data+from+recent+Qakbot+samples."
                                                   onclick="window.open(this.href, 'linkedin-share', 'width=520,height=570');return false;"
                                                   class="linkedin"></a>
                                            </li>
                                            <li>
                                                <a href="https://twitter.com/intent/tweet?text=Automating+Qakbot+Detection+at+Scale+With+Velociraptor&amp;url=http%3a%2f%2fwww.rapid7.com%2fblog%2fpost%2f2023%2f04%2f18%2fautomating-qakbot-detection-at-scale-with%2f"
                                                   onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"
                                                   class="twitter-x"></a>
                                            </li>
                                            <li>
                                                <a href="https://www.facebook.com/sharer/sharer.php?u=http://www.rapid7.com/blog/post/2023/04/18/automating-qakbot-detection-at-scale-with/"
                                                   onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"
                                                   class="facebook"></a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="cell medium-12 large-6 end">
                                        <div class="author-box text-center large-text-left">
                                            <div class="content">
                                                <div class="column-left">
                                                    <h4>AUTHOR</h4>
                                                </div>
                                                <div class="column-right">
                                                    <a href="/blog/author/mgreen27/" class="post-author" data-bg="https://blog.rapid7.com/assets/images/default-author-image.png">
                                                    </a>
                                                </div>
                                                <a class="name" href="/blog/author/mgreen27/" title="Matthew Green">
                                                    Matthew Green
                                                </a>
                                            </div>
                                            <p>
                                                
                                            </p>
                                            <a href="/blog/author/mgreen27/" class=" button smBtn clear">View Matthew's Posts</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="small-12 medium-4 large-3 cell blog-single-post__right-column medium-order-1 small-order-2">
                    <div class="blog-post-img hide-for-small-only">
                        <img loading="lazy" src="https://blog.rapid7.com/content/images/2023/04/GettyImages-1367656936.jpg" alt="">
                    </div>
                    <section class="blog-resources">
                        


    <div class="blog-resources__topics">
        <div class="text-center large-text-left blog-resources__heading">
            <h2>Topics</h2>
        </div>
        <ul>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/metasploit/">
                        Metasploit
                        &nbsp;<i>(670)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/vulnerability-management/">
                        Vulnerability Management
                        &nbsp;<i>(371)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/research/">
                        Research
                        &nbsp;<i>(247)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/detection-and-response/">
                        Detection and Response
                        &nbsp;<i>(207)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/vulnerability-disclosure/">
                        Vulnerability Disclosure
                        &nbsp;<i>(151)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/emergent-threat-response/">
                        Emergent Threat Response
                        &nbsp;<i>(147)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/cloud-security/">
                        Cloud Security
                        &nbsp;<i>(137)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/secops/">
                        Security Operations
                        &nbsp;<i>(20)</i>
                    </a>
                </li>
        </ul>
    </div>


    <div class="blog-resources__tags">
        <div class="text-center large-text-left blog-resources__heading">
            <h2>Popular Tags</h2>
        </div>
        <div class="search">
            <div class="search-wrapper">
                <input class="search-input" placeholder="Search Tags" disabled>
                <i class="r7-icon r7-icon-search-magnify"></i>
            </div>
        </div>
        <div class="blog-resources__tags-no-search">
            <ul class="text-center medium-text-left large-text-left">
                    <li><a href="/blog/tag/metasploit/">Metasploit</a></li>
                    <li><a href="/blog/tag/metasploit-weekly-wrapup/">Metasploit Weekly Wrapup</a></li>
                    <li><a href="/blog/tag/vulnerability-management/">Vulnerability Management</a></li>
                    <li><a href="/blog/tag/research/">Research</a></li>
                    <li><a href="/blog/tag/detection-and-response/">Detection and Response</a></li>
                    <li><a href="/blog/tag/logentries/">Logentries</a></li>
            </ul>
        </div>
        <div class="blog-resources__tags-search hide"></div>
    </div>

                    </section>

                        <section class="blog-related-posts hide-for-small-only">
                            <div class="text-center large-text-left blog-resources__heading">
                                <h2>Related Posts</h2>
                            </div>
                            <div class="blog-related-posts__wrapper">
                                    <div class="blog-related-posts__wrapper--item">
                                        <p class="left">
                                            Finding the LNK: Techniques and methodology for advanced analysis with Velociraptor
                                        </p>
                                        <p class="right"><a href="/blog/post/2024/11/01/finding-the-lnk-techniques-and-methodology-for-advanced-analysis-with-velociraptor/">Read More</a></p>
                                    </div>
                                    <div class="blog-related-posts__wrapper--item">
                                        <p class="left">
                                            Enhancing Velociraptor with the Cado Security Platform
                                        </p>
                                        <p class="right"><a href="/blog/post/2024/06/11/enhancing-velociraptor-with-the-cado-security-platform/">Read More</a></p>
                                    </div>
                                    <div class="blog-related-posts__wrapper--item">
                                        <p class="left">
                                            Velociraptor 0.7.2 Release: Digging Deeper than Ever with EWF Support, Dynamic DNS and More
                                        </p>
                                        <p class="right"><a href="/blog/post/2024/04/30/velociraptor-0-7-2-release-digging-deeper-than-ever-with-ewf-support-dynamic-dns-and-more/">Read More</a></p>
                                    </div>
                                    <div class="blog-related-posts__wrapper--item">
                                        <p class="left">
                                            How To Hunt For UEFI Malware Using Velociraptor
                                        </p>
                                        <p class="right"><a href="/blog/post/2024/02/29/how-to-hunt-for-uefi-malware-using-velociraptor/">Read More</a></p>
                                    </div>
                            </div>
                        </section>
                </div>

                    <div class="medium-10 medium-offset-1 cell small-12 medium-order-2 small-order-1">
                        <section class="blog-featured-posts">
                            <div class="grid-container blog-section-wrapper">
                                <div class="grid-x grid-padding-x">
                                    <div class="text-center large-text-left blog-featured-posts__heading">
                                        <h2>Related Posts</h2>
                                    </div>
                                    <div class="grid-x grid-padding-y grid-padding-x--sm">
                                            <div class="small-12 medium-6 large-3 cell blog-featured-posts__wrapper">
                                                <div class="blog-featured-posts__wrapper--item" data-bg="https://blog.rapid7.com/content/images/2024/10/GettyImages-1340424095.jpg">
                                                    <a href="/blog/post/2024/11/01/finding-the-lnk-techniques-and-methodology-for-advanced-analysis-with-velociraptor/" class="slide" role="button" aria-label="Finding the LNK: Techniques and methodology for advanced analysis with Velociraptor">
                                                        <div class="top-banner">
                                                        </div>
                                                        <div class="slide__content">
                                                            <div class="slide__content--title">
                                                                    <span class="topic">Velociraptor</span>
                                                            </div>
                                                            <div class="slide__content--headline">
                                                                Finding the LNK: Techniques and methodology for advanced analysis with Velociraptor
                                                            </div>
                                                            <div class="view-more">
                                                                <span class="button btn-secondary smBtn">Read Full Post</span>
                                                            </div>
                                                        </div>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="small-12 medium-6 large-3 cell blog-featured-posts__wrapper">
                                                <div class="blog-featured-posts__wrapper--item" data-bg="https://blog.rapid7.com/content/images/2024/06/GettyImages-1489413775.jpg">
                                                    <a href="/blog/post/2024/06/11/enhancing-velociraptor-with-the-cado-security-platform/" class="slide" role="button" aria-label="Enhancing Velociraptor with the Cado Security Platform">
                                                        <div class="top-banner">
                                                        </div>
                                                        <div class="slide__content">
                                                            <div class="slide__content--title">
                                                                    <span class="topic">Velociraptor</span>
                                                            </div>
                                                            <div class="slide__content--headline">
                                                                Enhancing Velociraptor with the Cado Security Platform
                                                            </div>
                                                            <div class="view-more">
                                                                <span class="button btn-secondary smBtn">Read Full Post</span>
                                                            </div>
                                                        </div>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="small-12 medium-6 large-3 cell blog-featured-posts__wrapper">
                                                <div class="blog-featured-posts__wrapper--item" data-bg="https://blog.rapid7.com/content/images/2024/04/Screenshot-2023-09-28-at-11.18.37-AM.png">
                                                    <a href="/blog/post/2024/04/30/velociraptor-0-7-2-release-digging-deeper-than-ever-with-ewf-support-dynamic-dns-and-more/" class="slide" role="button" aria-label="Velociraptor 0.7.2 Release: Digging Deeper than Ever with EWF Support, Dynamic DNS and More">
                                                        <div class="top-banner">
                                                        </div>
                                                        <div class="slide__content">
                                                            <div class="slide__content--title">
                                                                    <span class="topic">Velociraptor</span>
                                                            </div>
                                                            <div class="slide__content--headline">
                                                                Velociraptor 0.7.2 Release: Digging Deeper than Ever with EWF Support, Dynamic DNS and More
                                                            </div>
                                                            <div class="view-more">
                                                                <span class="button btn-secondary smBtn">Read Full Post</span>
                                                            </div>
                                                        </div>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="small-12 medium-6 large-3 cell blog-featured-posts__wrapper">
                                                <div class="blog-featured-posts__wrapper--item" data-bg="https://blog.rapid7.com/content/images/2024/02/GettyImages-1128503636-1.jpg">
                                                    <a href="/blog/post/2024/02/29/how-to-hunt-for-uefi-malware-using-velociraptor/" class="slide" role="button" aria-label="How To Hunt For UEFI Malware Using Velociraptor">
                                                        <div class="top-banner">
                                                        </div>
                                                        <div class="slide__content">
                                                            <div class="slide__content--title">
                                                                    <span class="topic">Velociraptor</span>
                                                            </div>
                                                            <div class="slide__content--headline">
                                                                How To Hunt For UEFI Malware Using Velociraptor
                                                            </div>
                                                            <div class="view-more">
                                                                <span class="button btn-secondary smBtn">Read Full Post</span>
                                                            </div>
                                                        </div>
                                                    </a>
                                                </div>
                                            </div>
                                    </div>
                                </div>
                                    <div class="cell text-center">
                                        <a class="button mdBtn btn-secondary" href="/blog/posts/">View All Posts</a>
                                    </div>
                            </div>
                        </section>
                    </div>
            </div>
        </div>
    </section>
</div>



<footer >

        <section class="search-scroll">
            <div class="grid-container">
                <div class="grid-x grid-padding-x">
                    <div class="medium-5 medium-offset-1 cell footer__search">
                        <form action="/search/">
                        <label for="search" class="sr-only">Search</label>
                            <input class="sb-search-input" placeholder="Search all the things" type="search" value="" name="q" id="search">
                            <input class="sb-search-submit" type="submit" value="Submit Search" alt="Search all the things">
                        </form>
                    </div>
                    <div class="medium-5 cell footer__scroll">
                        <a href="#__" class="smooth">
                            <span>BACK TO TOP</span>
                            <picture><source sizes="(max-width: 480px) 100vw, (max-width: 640px) 95vw, (max-width: 1024px) 95vw, 90vw" srcset="/includes/img/up-arrow-lightgray.png?format=webp&width=1200&quality=90 1200w, /includes/img/up-arrow-lightgray.png?format=webp&width=1024&quality=90 1024w, /includes/img/up-arrow-lightgray.png?format=webp&width=640&quality=90 640w, /includes/img/up-arrow-lightgray.png?format=webp&width=480&quality=90 480w" type="image/webp" /><source sizes="(max-width: 480px) 100vw, (max-width: 640px) 95vw, (max-width: 1024px) 95vw, 90vw" srcset="/includes/img/up-arrow-lightgray.png?width=1200 1200w, /includes/img/up-arrow-lightgray.png?width=1024 1024w, /includes/img/up-arrow-lightgray.png?width=640 640w, /includes/img/up-arrow-lightgray.png?width=480 480w" /><img alt="" decoding="async" loading="lazy" src="/includes/img/up-arrow-lightgray.png?width=1200" /></picture>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <div class="grid-container">
            <section class="footer__links grid-x grid-padding-x">
                <div class="medium-10 medium-offset-1 cell footer__links-wrapper">
                    <div class="footer__links-col">
                        <div class="footer__links-section footer__contact">
                            <a href="/">
                                <picture><source sizes="(max-width: 480px) 100vw, (max-width: 640px) 95vw, (max-width: 1024px) 95vw, 90vw" srcset="/includes/img/Rapid7_logo.svg?format=webp&width=1200&quality=90 1200w, /includes/img/Rapid7_logo.svg?format=webp&width=1024&quality=90 1024w, /includes/img/Rapid7_logo.svg?format=webp&width=640&quality=90 640w, /includes/img/Rapid7_logo.svg?format=webp&width=480&quality=90 480w" type="image/webp" /><source sizes="(max-width: 480px) 100vw, (max-width: 640px) 95vw, (max-width: 1024px) 95vw, 90vw" srcset="/includes/img/Rapid7_logo.svg?width=1200&quality=90 1200w, /includes/img/Rapid7_logo.svg?width=1024&quality=90 1024w, /includes/img/Rapid7_logo.svg?width=640&quality=90 640w, /includes/img/Rapid7_logo.svg?width=480&quality=90 480w" /><img alt="Rapid7 logo" class="logo" decoding="async" loading="lazy" src="/includes/img/Rapid7_logo.svg?width=1200&quality=90" /></picture>
                            </a>
                            
                <div class="footer__links-title">CUSTOMER SUPPORT</div>
                <a class="link" href="tel:1-866-390-8113">+1-866-390-8113 (Toll Free)</a>
                <div class="footer__links-title">SALES SUPPORT</div>
                <a class="link" href="tel:866-772-7437">+1-866-772-7437 (Toll Free)</a>

                                <div class="footer__breach">
                                    <div class="footer__breach-title">Need to report an Escalation or a Breach?</div>
                                    <div class="footer__breach-contact">
                                        <a aria-role="button" href="/services/incident-response-customer-escalation/" class="button mdBtn btn-primary r7-icon-lightning-bolt">Get Help</a>
                                    </div>
                                </div>
                        </div>
                        <div class="footer__links-section footer__solutions">
                                            <div class="footer__links-title">SOLUTIONS</div>
                <a class="link" href="/platform/">The Command Platform</a>
                <a class="link" href="/products/command/exposure-management/">Exposure Command</a>
                <a class="link" href="/services/managed-detection-and-response-mdr/">Managed Threat Complete</a>

                        </div>
                    </div>
                    <div class="footer__links-col">
                        <div class="footer__links-section footer__support">
                                            <div class="footer__links-title">SUPPORT & RESOURCES</div>
                <a class="link" href="https://www.rapid7.com/for-customers/">Product Support</a>
                <a class="link" href="https://www.rapid7.com/resources/">Resource Library</a>
                <a class="link" href="https://www.rapid7.com/customers/">Our Customers</a>
                <a class="link" href="https://www.rapid7.com/about/events-webcasts/">Events & Webcasts</a>
                <a class="link" href="https://www.rapid7.com/services/training-certification/">Training & Certification</a>
                <a class="link" href="https://www.rapid7.com/fundamentals/">Cybersecurity Fundamentals</a>
                <a class="link" href="https://www.rapid7.com/db/">Vulnerability & Exploit Database</a>

                        </div>
                        <div class="footer__links-section footer__about">
                                            <div class="footer__links-title">ABOUT US</div>
                <a class="link" href="https://www.rapid7.com/about/company/">Company</a>
                <a class="link" href="https://www.rapid7.com/about/diversity-equity-and-inclusion/">Diversity, Equity, and Inclusion</a>
                <a class="link" href="https://www.rapid7.com/about/leadership/">Leadership</a>
                <a class="link" href="https://www.rapid7.com/about/news/">News & Press Releases</a>
                <a class="link" href="https://www.rapid7.com/about/public-policy/">Public Policy</a>
                <a class="link" href="https://www.rapid7.com/open-source/">Open Source</a>
                <a class="link" href="https://investors.rapid7.com/overview/default.aspx">Investors</a>

                        </div>
                    </div>

                    <div class="footer__links-col">
                        <div class="footer__links-section footer__connect">
                                            <div class="footer__links-title">CONNECT WITH US</div>
                <a class="link" href="https://www.rapid7.com/contact/">Contact</a>
                <a class="link" href="https://www.rapid7.com/blog/">Blog</a>
                <a class="link" href="https://insight.rapid7.com/login">Support Login</a>
                <a class="link" href="https://careers.rapid7.com/careers-home">Careers</a>

                            <div class="footer__links-social">
                                <a class="linkedin no-new-open" aria-label="LinkedIn" href="https://www.linkedin.com/company/39624" target="_blank"></a>
                                <a class="twitter-x no-new-open" aria-label="Twitter" href="https://twitter.com/Rapid7" target="_blank"></a>
                                <a class="facebook no-new-open" aria-label="Facebook" href="https://www.facebook.com/rapid7" target="_blank"></a>
                                <a class="instagram no-new-open" aria-label="Instagram" href="https://www.instagram.com/rapid7/" target="_blank"></a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

    <section class="footer__legal">
        <div class="grid-container">
            <div class="grid-x grid-padding-x">
                <div class="medium-10 medium-offset-1 cell">
                    <div class="footer__legal-copyright">&copy; Rapid7</div>

                            <div class="footer__legal-link"><a href="/legal/">Legal Terms</a></div>
&nbsp; | &nbsp;                            <div class="footer__legal-link"><a href="/privacy-policy/">Privacy Policy</a></div>
&nbsp; | &nbsp;                            <div class="footer__legal-link"><a href="/export-notice/">Export Notice</a></div>
&nbsp; | &nbsp;                            <div class="footer__legal-link"><a href="/trust/">Trust</a></div>
&nbsp; | &nbsp;                            <div class="footer__legal-link"><a href=""><a href="#" onclick="OneTrust.ToggleInfoDisplay(); return false;"> Do Not Sell or Share My Personal Information</a></a></div>
&nbsp; | &nbsp;                            <div class="footer__legal-link"><a href=""><a href="#" onclick="OneTrust.ToggleInfoDisplay(); return false;">Cookie Preferences</a></a></div>
                </div>
            </div>
        </div>
    </section>

            <section class="contact-sticky">
                <div class="grid-container">
                    <div class="grid-x grid-padding-x expanded">
                        <div id="stickyButtons" class="cell driftInit">
                            <div class="contactBtn">
                                <a id="sticky_contact_btn" role="button" tabindex="0" class="gray button">
                                    Contact Us
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <div class="reveal light hasSidebar" id="stickyContact" data-reveal>
                <section class="contactForm">
                    <div class="grid-container">
                        <div class="grid-x grid-padding-x">
                            <div class="large-9 cell">
                                


<div>
    <h2>Submit your information and we will get in touch with you.</h2>
</div>


<script src="//information.rapid7.com/js/forms2/js/forms2.min.js"></script>

        <div id="thankyouText2" style="display:none;" class="messageBox green" userlang="en">
            <div class="inner-wrapper">
                <div class="img-wrapper">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                         viewBox="0 0 32 32" fill="none">
                        <circle cx="16" cy="16" r="16" fill="white"></circle>
                        <path d="M22.4 12L13.6 20.8L9.59998 16.8" stroke="#3B454A" stroke-width="2.5"
                              stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                </div>
                <h4 class="title">Thank you for contacting us.</h4>
                <h5 class="sub-title">We will be in touch shortly.</h5>
            </div>
        </div>
        <form id="mktoForm_8347"></form>
        <script>
            MktoForms2.loadForm("//information.rapid7.com", "411-NAK-970", 8347, function (form) {
                form.onSuccess(function (values, followUpUrl) {
                    $('#thankyouText2').show();
                    form.getFormElem().hide();
                    return false;
                });
            });
        </script>

<script src="//www.google.com/recaptcha/api.js?hl=en&render=6Lc2JFwaAAAAAI4X5Ix2Jxu7lyXDUVm1U3sATX7a"></script>
                            </div>
                            <div class="large-3 cell sidebar">
                                <p><img class="logo" src="/includes/img/logo-black.png" alt="Rapid7 logo" data-src="/includes/img/logo-black.png"></p>
<h3>General:</h3>
<p><a href="mailto:info@rapid7.com">info@rapid7.com</a></p>
<h3>Sales:</h3>
<p><a href="tel:1-866-772-7437">+1-866-772-7437</a><br><a href="mailto:sales@rapid7.com">sales@rapid7.com</a></p>
<h3>Support:</h3>
<p><a href="tel:1-866-390-8113">+1&ndash;866&ndash;390&ndash;8113 (toll free)</a><br><a href="mailto:support@rapid7.com">support@rapid7.com</a></p>
<h3>Incident Response:</h3>
<p><a href="tel:1-844-787-4937">1-844-727-4347</a></p>
<p><a class="view_more" href="/contact/">More Contact Info</a></p>
                            </div>
                        </div>
                    </div>

                </section>
                <button class="close-button" data-close="" aria-label="Close reveal" type="button"></button>
            </div>
</footer>



    <div class="reveal light" id="modal-subscribe" data-reveal>
        <h2>Never miss a blog</h2>
        <p>Get the latest stories, expertise, and news about security today.</p>
        <form id="mktoForm_4144"></form>
        <div id="thankyou" style="display: none;">You’re almost done! <br> Check your email to confirm your subscription.</div>
        <script>
            if (typeof MktoForms2 === 'undefined') {
                $('body').addClass('load');
            } else {
                MktoForms2.loadForm("//information.rapid7.com", "411-NAK-970", 4144, function (form) {
                    form.onSuccess(function (values, followUpUrl) {
                        window.dataLayer.push({ 'event': 'form_submit_success' });
                        form.getFormElem().hide();
                        document.getElementById("thankyou").style.display = "block";
                        return false;
                    });
                });
            }
        </script>
        <button class="close-button" data-close="" aria-label="Close reveal" type="button"></button>
    </div>


        </div>
    </div>
</div>








    <!-- scripts -->
    <script src="/includes/js/all.min.js?cb=1736875731824"></script>
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
    <script>
        (function ($) {
            $(document).ready(function () {
                // Handle subscribe button click
                $('.subscribe-btn').on('click', function () {
                    $('#modal-subscribe').foundation('open');
                });

            });

            $(window).on("load", function () {
                // Highlight Metasploit console snippets
                hljs.registerLanguage('msf', function () {
                    return {
                        name: 'msf',
                        keywords: {},
                        contains: [
                            { scope: 'prompt.name', begin: '^(msf\\d?|meterpreter)', relevance: 10 },
                            {
                                begin: ' (exploit|payload|auxiliary|encoder|evasion|post|nop)\\(',
                                end: '>',
                                scope: 'test',
                                contains: [
                                    { scope: 'prompt.mod', begin: '(?!\\()([\\w/]+)(?=\\))' },
                                ]
                            },
                            { scope: 'error', begin: '^\\[\\-\\]' },
                            { scope: 'good', begin: '^\\[\\+\\]' },
                            { scope: 'status', begin: '^\\[\\*\\]' },
                            { scope: 'warning', begin: '^\\[\\!\\]' },
                            hljs.QUOTE_STRING_MODE
                        ],
                        illegal: '\\S'
                    };
                });

                hljs.highlightAll();
            });


        })(jQuery);
    </script>

    <script></script>



	 <script src="/includes/js/bundles/shared/vidyard.min.js?cb=1736875731824" async defer></script>

	 <script src="/includes/js/bundles/blocks/block.blog-tags-list.min.js?cb=1736875731824" async defer></script>



    <style type="text/css">
.blog-single-post__main-column .post-content a.subscribe-btn { color:#fff; }
</style>
</body>
</html>
