<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en-GB'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://www.secfreaks.gr/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://www.secfreaks.gr/2019/12/in-depth-analysis-of-an-infostealer-raccoon.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Secfreaks - Atom" href="https://www.secfreaks.gr/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Secfreaks - RSS" href="https://www.secfreaks.gr/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Secfreaks - Atom" href="https://www.blogger.com/feeds/1385596801881783511/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Secfreaks - Atom" href="https://www.secfreaks.gr/feeds/6078476001348773709/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCAXNtXE2B1shKS52TxJQ0X1wBKOF7d9vdFnxN9WMDq_M95HHt-Zq3z5O2TX19rjWFQ9hODcdwmefXLzvrlx-TkvEwEWvD2Df-r2yAZxq8KR6YX5ijkGjbpi_LpaN9xDEzyrUXgDx9SlNF/s640/fakenet_mod.png' rel='image_src'/>
<meta content='https://www.secfreaks.gr/2019/12/in-depth-analysis-of-an-infostealer-raccoon.html' property='og:url'/>
<meta content='In depth analysis of an infostealer: Raccoon' property='og:title'/>
<meta content='  General Info     Raccoon is a malware written in C++. It came to my attention while looking at my twitter feed and spotting a tweet from @...' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCAXNtXE2B1shKS52TxJQ0X1wBKOF7d9vdFnxN9WMDq_M95HHt-Zq3z5O2TX19rjWFQ9hODcdwmefXLzvrlx-TkvEwEWvD2Df-r2yAZxq8KR6YX5ijkGjbpi_LpaN9xDEzyrUXgDx9SlNF/w1200-h630-p-k-no-nu/fakenet_mod.png' property='og:image'/>
<title>Secfreaks: In depth analysis of an infostealer: Raccoon</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Awesome Inc.
Designer: Tina Chen
URL:      tinachen.org
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: #eeeeee none repeat scroll top left;
}
html body .content-outer {
min-width: 0;
max-width: 100%;
width: 100%;
}
a:link {
text-decoration: none;
color: #3778cd;
}
a:visited {
text-decoration: none;
color: #4d469c;
}
a:hover {
text-decoration: underline;
color: #3778cd;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 276px;
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
/* Columns
----------------------------------------------- */
.content-inner {
padding: 0;
}
.header-inner .section {
margin: 0 16px;
}
.tabs-inner .section {
margin: 0 16px;
}
.main-inner {
padding-top: 30px;
}
.main-inner .column-center-inner,
.main-inner .column-left-inner,
.main-inner .column-right-inner {
padding: 0 5px;
}
*+html body .main-inner .column-center-inner {
margin-top: -30px;
}
#layout .main-inner .column-center-inner {
margin-top: 0;
}
/* Header
----------------------------------------------- */
.header-outer {
margin: 0 0 0 0;
background: transparent none repeat scroll 0 0;
}
.Header h1 {
font: normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
text-shadow: 0 0 -1px #000000;
}
.Header h1 a {
color: #444444;
}
.Header .description {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.header-inner .Header .titlewrapper,
.header-inner .Header .descriptionwrapper {
padding-left: 0;
padding-right: 0;
margin-bottom: 0;
}
.header-inner .Header .titlewrapper {
padding-top: 22px;
}
/* Tabs
----------------------------------------------- */
.tabs-outer {
overflow: hidden;
position: relative;
background: #eeeeee url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
#layout .tabs-outer {
overflow: visible;
}
.tabs-cap-top, .tabs-cap-bottom {
position: absolute;
width: 100%;
border-top: 1px solid #999999;
}
.tabs-cap-bottom {
bottom: 0;
}
.tabs-inner .widget li a {
display: inline-block;
margin: 0;
padding: .6em 1.5em;
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
border-left: 1px solid #999999;
height: 16px;
line-height: 16px;
}
.tabs-inner .widget li:last-child a {
border-right: 1px solid #999999;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
background: #666666 url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat-x scroll 0 -100px;
color: #ffffff;
}
/* Headings
----------------------------------------------- */
h2 {
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
/* Widgets
----------------------------------------------- */
.main-inner .section {
margin: 0 27px;
padding: 0;
}
.main-inner .column-left-outer,
.main-inner .column-right-outer {
margin-top: 0;
}
#layout .main-inner .column-left-outer,
#layout .main-inner .column-right-outer {
margin-top: 0;
}
.main-inner .column-left-inner,
.main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
#layout .main-inner .column-left-inner,
#layout .main-inner .column-right-inner {
margin-top: 0;
}
.sidebar .widget {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.sidebar .widget a:link {
color: #3778cd;
}
.sidebar .widget a:visited {
color: #4d469c;
}
.sidebar .widget a:hover {
color: #3778cd;
}
.sidebar .widget h2 {
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget {
background-color: #ffffff;
border: 1px solid #eeeeee;
padding: 0 15px 15px;
margin: 20px -16px;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.main-inner .widget h2 {
margin: 0 -15px;
padding: .6em 15px .5em;
border-bottom: 1px solid transparent;
}
.footer-inner .widget h2 {
padding: 0 0 .4em;
border-bottom: 1px solid transparent;
}
.main-inner .widget h2 + div, .footer-inner .widget h2 + div {
border-top: 1px solid #eeeeee;
padding-top: 8px;
}
.main-inner .widget .widget-content {
margin: 0 -15px;
padding: 7px 15px 0;
}
.main-inner .widget ul, .main-inner .widget #ArchiveList ul.flat {
margin: -8px -15px 0;
padding: 0;
list-style: none;
}
.main-inner .widget #ArchiveList {
margin: -8px 0 0;
}
.main-inner .widget ul li, .main-inner .widget #ArchiveList ul.flat li {
padding: .5em 15px;
text-indent: 0;
color: #666666;
border-top: 1px solid #eeeeee;
border-bottom: 1px solid transparent;
}
.main-inner .widget #ArchiveList ul li {
padding-top: .25em;
padding-bottom: .25em;
}
.main-inner .widget ul li:first-child, .main-inner .widget #ArchiveList ul.flat li:first-child {
border-top: none;
}
.main-inner .widget ul li:last-child, .main-inner .widget #ArchiveList ul.flat li:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.main-inner .widget .post-body ul {
padding: 0 2.5em;
margin: .5em 0;
list-style: disc;
}
.main-inner .widget .post-body ul li {
padding: 0.25em 0;
margin-bottom: .25em;
color: #444444;
border: none;
}
.footer-inner .widget ul {
padding: 0;
list-style: none;
}
.widget .zippy {
color: #666666;
}
/* Posts
----------------------------------------------- */
body .main-inner .Blog {
padding: 0;
margin-bottom: 1em;
background-color: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
box-shadow: 0 0 0 rgba(0, 0, 0, 0);
}
.main-inner .section:last-child .Blog:last-child {
padding: 0;
margin-bottom: 1em;
}
.main-inner .widget h2.date-header {
margin: 0 -15px 1px;
padding: 0 0 0 0;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: transparent none no-repeat scroll top left;
border-top: 0 solid #eeeeee;
border-bottom: 1px solid transparent;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
position: static;
bottom: 100%;
right: 15px;
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget h2.date-header span {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
display: block;
padding: .5em 15px;
border-left: 0 solid #eeeeee;
border-right: 0 solid #eeeeee;
}
.date-outer {
position: relative;
margin: 30px 0 20px;
padding: 0 15px;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.date-outer:first-child {
margin-top: 0;
}
.date-outer:last-child {
margin-bottom: 20px;
-moz-border-radius-bottomleft: 0;
-moz-border-radius-bottomright: 0;
-webkit-border-bottom-left-radius: 0;
-webkit-border-bottom-right-radius: 0;
-goog-ms-border-bottom-left-radius: 0;
-goog-ms-border-bottom-right-radius: 0;
border-bottom-left-radius: 0;
border-bottom-right-radius: 0;
}
.date-posts {
margin: 0 -15px;
padding: 0 15px;
clear: both;
}
.post-outer, .inline-ad {
border-top: 1px solid #eeeeee;
margin: 0 -15px;
padding: 15px 15px;
}
.post-outer {
padding-bottom: 10px;
}
.post-outer:first-child {
padding-top: 0;
border-top: none;
}
.post-outer:last-child, .inline-ad:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.post-body img {
padding: 8px;
background: transparent;
border: 1px solid transparent;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
border-radius: 0;
}
h3.post-title, h4 {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a:hover {
color: #3778cd;
text-decoration: underline;
}
.post-header {
margin: 0 0 1em;
}
.post-body {
line-height: 1.4;
}
.post-outer h2 {
color: #444444;
}
.post-footer {
margin: 1.5em 0 0;
}
#blog-pager {
padding: 15px;
font-size: 120%;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius-topright: 0;
margin-top: 1em;
}
.blog-feeds, .post-feeds {
margin: 1em 0;
text-align: center;
color: #444444;
}
.blog-feeds a, .post-feeds a {
color: #3778cd;
}
.blog-feeds a:visited, .post-feeds a:visited {
color: #4d469c;
}
.blog-feeds a:hover, .post-feeds a:hover {
color: #3778cd;
}
.post-outer .comments {
margin-top: 2em;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Footer
----------------------------------------------- */
.footer-outer {
margin: -20px 0 -1px;
padding: 20px 0 0;
color: #444444;
overflow: hidden;
}
.footer-fauxborder-left {
border-top: 1px solid #eeeeee;
background: #ffffff none repeat scroll 0 0;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
margin: 0 -20px;
}
/* Mobile
----------------------------------------------- */
body.mobile {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
*+html body.mobile .main-inner .column-center-inner {
margin-top: 0;
}
.mobile .main-inner .widget {
padding: 0 0 15px;
}
.mobile .main-inner .widget h2 + div,
.mobile .footer-inner .widget h2 + div {
border-top: none;
padding-top: 0;
}
.mobile .footer-inner .widget h2 {
padding: 0.5em 0;
border-bottom: none;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile .main-inner .widget ul,
.mobile .main-inner .widget #ArchiveList ul.flat {
margin: 0 -15px 0;
}
.mobile .main-inner .widget h2.date-header {
right: 0;
}
.mobile .date-header span {
padding: 0.4em 0;
}
.mobile .date-outer:first-child {
margin-bottom: 0;
border: 1px solid #eeeeee;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
}
.mobile .date-outer {
border-color: #eeeeee;
border-width: 0 1px 1px;
}
.mobile .date-outer:last-child {
margin-bottom: 0;
}
.mobile .main-inner {
padding: 0;
}
.mobile .header-inner .section {
margin: 0;
}
.mobile .post-outer, .mobile .inline-ad {
padding: 5px 0;
}
.mobile .tabs-inner .section {
margin: 0 10px;
}
.mobile .main-inner .widget h2 {
margin: 0;
padding: 0;
}
.mobile .main-inner .widget h2.date-header span {
padding: 0;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile #blog-pager {
border: 1px solid transparent;
background: #ffffff none repeat scroll 0 0;
}
.mobile .main-inner .column-left-inner,
.mobile .main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: none;
-webkit-box-shadow: none;
-goog-ms-box-shadow: none;
box-shadow: none;
}
.mobile .date-posts {
margin: 0;
padding: 0;
}
.mobile .footer-fauxborder-left {
margin: 0;
border-top: inherit;
}
.mobile .main-inner .section:last-child .Blog:last-child {
margin-bottom: 0;
}
.mobile-index-contents {
color: #444444;
}
.mobile .mobile-link-button {
background: #3778cd url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content {
background: transparent;
border-top: 1px solid;
border-color: #999999;
color: #444444;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #999999;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1100px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1100px;
max-width: 1100px;
_width: 1100px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 260px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 260px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("260px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 260px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 260px;
margin-right: -260px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=1385596801881783511&amp;zx=8b894b29-b36f-42f1-a558-0967dda6ac00' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=1385596801881783511&amp;zx=8b894b29-b36f-42f1-a558-0967dda6ac00' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

<script type="text/javascript" language="javascript">
  // Supply ads personalization default for EEA readers
  // See https://www.blogger.com/go/adspersonalization
  adsbygoogle = window.adsbygoogle || [];
  if (typeof adsbygoogle.requestNonPersonalizedAds === 'undefined') {
    adsbygoogle.requestNonPersonalizedAds = 1;
  }
</script>


</head>
<body class='loading variant-light'>
<div class='navbar no-items section' id='navbar' name='Navbar'>
</div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://www.secfreaks.gr/'>
Secfreaks
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs section' id='crosscol' name='Cross-column'><div class='widget PageList' data-version='1' id='PageList1'>
<h2>Pages</h2>
<div class='widget-content'>
<ul>
<li>
<a href='https://www.secfreaks.gr/'>Home</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Tuesday, 3 December 2019</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCAXNtXE2B1shKS52TxJQ0X1wBKOF7d9vdFnxN9WMDq_M95HHt-Zq3z5O2TX19rjWFQ9hODcdwmefXLzvrlx-TkvEwEWvD2Df-r2yAZxq8KR6YX5ijkGjbpi_LpaN9xDEzyrUXgDx9SlNF/s640/fakenet_mod.png' itemprop='image_url'/>
<meta content='1385596801881783511' itemprop='blogId'/>
<meta content='6078476001348773709' itemprop='postId'/>
<a name='6078476001348773709'></a>
<h3 class='post-title entry-title' itemprop='name'>
In depth analysis of an infostealer: Raccoon
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-6078476001348773709' itemprop='description articleBody'>
<br />
<h1 class="western">
General Info</h1>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in;">
Raccoon is a malware written in C++. It
came to my attention while looking at my twitter feed and spotting a
tweet from @tkanalyst. I was not aware of it, and as a malware
analyst working at a sandbox company(<a href="http://tria.ge/">tria.ge</a>), I wanted immediately
to analyze it and develop signatures. Also, I have not any
background in Threat Intel or attribution, so the name was chosen due
to @tkanalyst tweet.</div>
<div style="margin-bottom: 0in;">
The sample that was analyzed has the
following information:</div>
<ul>
<li><div style="margin-bottom: 0in;">
MD5 HASH (Packed) : 
 126ed436b3531dd857b25b9da2c80462</div>
</li>
<li><div style="margin-bottom: 0in;">
MD5 HASH (Unpacked): 
 3367E9FC3CDBE03D65460E5BF86EE16B</div>
</li>
<li><div style="margin-bottom: 0in;">
Raccoon Version: 1.2</div>
</li>
</ul>
<div style="margin-bottom: 0in;">
Generally, the sample is a typical
infostealer malware. It checks for the existence of various types of
applications such as browsers, email clients, coin wallets and
attempts to steal their data by reading their configuration files or
databases. The execution of the malware is closely related with the
configuration that the CnC server will send, thus there is an
obstacle during the dynamic analysis if the CnC domain is down. In
our case this was solved by writing a module in Fakenet-NG and
emulating the responses of the CnC(Figure 1).</div>
<div style="margin-bottom: 0in;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCAXNtXE2B1shKS52TxJQ0X1wBKOF7d9vdFnxN9WMDq_M95HHt-Zq3z5O2TX19rjWFQ9hODcdwmefXLzvrlx-TkvEwEWvD2Df-r2yAZxq8KR6YX5ijkGjbpi_LpaN9xDEzyrUXgDx9SlNF/s1600/fakenet_mod.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="320" data-original-width="710" height="288" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCAXNtXE2B1shKS52TxJQ0X1wBKOF7d9vdFnxN9WMDq_M95HHt-Zq3z5O2TX19rjWFQ9hODcdwmefXLzvrlx-TkvEwEWvD2Df-r2yAZxq8KR6YX5ijkGjbpi_LpaN9xDEzyrUXgDx9SlNF/s640/fakenet_mod.png" width="640" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
1</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in; page-break-before: always;">
<br /></div>
<h1 class="western">
Static Analysis</h1>
<div style="margin-bottom: 0in;">
While I am not that fond of malware
written in C++ for obvious reasons, Raccoon was not that complicated
- it does not have any ANTI - methods, and its execution is straight
forward. With the help of FLIRT signatures if correctly applied, the
static analysis can become a lot easier. While spending some time
doing static analysis, I noticed some patterns for string decryption.
The majority of the strings are encrypted with a combination of
bitwise NOT/XOR (depending on the sample)(Figure 2,3). To make my
life easier and to practice my IDApython skills, I created a script
in order to search and decrypt these strings: [7]. Some
main points from the script:</div>
<ul>
<li><div style="margin-bottom: 0in;">
It has two major functions
 responsible for reading ASM instructions and gathering the data and
 decrypting it.</div>
</li>
<li><div style="margin-bottom: 0in;">
It is based on pre-defined regex
 for deciding whether there is potential encrypted data. There is
 often overlap between the addresses which is solved by checking the
 decrypted strings and deciding which one is valid.</div>
</li>
<li><div style="margin-bottom: 0in;">
It's really easy to fix a
 decrypted string that it is wrong or was overwritten by another
 pattern - you just call one of the two available functions having as
 a parameter the address of the instruction that one believes to move
 data needed for the decryption of the string.</div>
</li>
</ul>
<div align="CENTER" style="margin-bottom: 0in; margin-left: 0.5in; page-break-after: avoid;">
</div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjYDmAdFaem0uFelSzDuossF0g8LXvl6V-FwslxVY3yDvj5-naFnjD4JVZKLWTF9YF-BTkincpsSbMFvX6RB2uxsPUFzJAkWYPOeNnASYa6-fIl6oJmJG5s-L48X3KUU-tBrpYxEP8-a4N0/s1600/xor_enc_pat_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="330" data-original-width="510" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjYDmAdFaem0uFelSzDuossF0g8LXvl6V-FwslxVY3yDvj5-naFnjD4JVZKLWTF9YF-BTkincpsSbMFvX6RB2uxsPUFzJAkWYPOeNnASYa6-fIl6oJmJG5s-L48X3KUU-tBrpYxEP8-a4N0/s1600/xor_enc_pat_1.png" /></a></div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
2</b></span></span></div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhMVnioHysxEVrJwOv2UzO22T6EWDiH8Tm0VlQNg-i4xSJh_47rsCKHyiOstHUZFncB-7MrJGFz9FzctvKz531XpOpU011qyvvq8_6wmvMB3Wf5F_oWzg1kCg4h-U2H1jJP9tCKYaszSjVr/s1600/xor_enc_pat_2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="457" data-original-width="727" height="401" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhMVnioHysxEVrJwOv2UzO22T6EWDiH8Tm0VlQNg-i4xSJh_47rsCKHyiOstHUZFncB-7MrJGFz9FzctvKz531XpOpU011qyvvq8_6wmvMB3Wf5F_oWzg1kCg4h-U2H1jJP9tCKYaszSjVr/s640/xor_enc_pat_2.png" width="640" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
3</b></span></span></div>
<div align="CENTER" style="margin-bottom: 0in; margin-left: 0.5in;">
<br /></div>
<h1 class="western">
Dynamic Analysis</h1>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in;">
Starting to analyze the malware
dynamically, the malware first checks for a mutex, in order to
determine if an instance of it is already running. Specifically, the
mutex's name is a result of a string decryption and concatenation
with the current user's name. If the mutex does not exist, it is
created and the function returns 1, else it returns 0. (Figure 4)</div>
<div style="margin-bottom: 0in;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhtn6RoZCdomJrf9-uwuph3up7ngLU-F7h8l6O7S_mtCgMyFnCFUeHqGqvnIlUVgEzvz0A_ArFxhW4jCINRklbXKm0a0rumOdinNUg39It4kmQOH1R6Sh7C0317hjNnWhHBXhKZe4qY-mki/s1600/mutex_check.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="428" data-original-width="562" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhtn6RoZCdomJrf9-uwuph3up7ngLU-F7h8l6O7S_mtCgMyFnCFUeHqGqvnIlUVgEzvz0A_ArFxhW4jCINRklbXKm0a0rumOdinNUg39It4kmQOH1R6Sh7C0317hjNnWhHBXhKZe4qY-mki/s1600/mutex_check.PNG" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
4</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in;">
Immediately after that, the malware
check the privilege that is executed with. Specifically, with the
help of the token is determined whether the process is run from Local
System group. If that's the case, then a snapshot of running
processes is acquired, and it will try to duplicate a token(with
higher privileges) from another one in order to call
<b>CreateProcessWithTokenW</b> API, restarting with higher
privileges.(Figure 5)</div>
<div style="margin-bottom: 0in;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEimhx6zCb7Pma3c2XdNY6PSI5wXSgmVVSOxXHNHA0PD3C-K0YXh3sPNFgz3h96EFtDXL_TQuTWEKkE4hxduZvP3Ba0CD1ZskBAJpePhY9Ccl71XfgZBHI8grGKgvzbgI5sj_pfy5v34JgKM/s1600/group_check.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="469" data-original-width="769" height="390" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEimhx6zCb7Pma3c2XdNY6PSI5wXSgmVVSOxXHNHA0PD3C-K0YXh3sPNFgz3h96EFtDXL_TQuTWEKkE4hxduZvP3Ba0CD1ZskBAJpePhY9Ccl71XfgZBHI8grGKgvzbgI5sj_pfy5v34JgKM/s640/group_check.PNG" width="640" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
5</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in;">
As it was mentioned in Cybereason's
post[1], the malware checks the locale of the system against various
other values such as: <i>Russian</i>, <i>Ukrainian</i>, <i>Belarussian</i>,
<i>Kazakh</i>, <i>Kyrgyz</i>, <i>Armenian</i>, <i>Tajik</i>, and
<i>Uzbek</i>.</div>
<div style="margin-bottom: 0in;">
In order to continue the execution, the
malware needs to get its JSON config. The CnC server serving the
config does not exist inside the sample - instead, the sample
dynamically acquires its CnC via another request. The samples firstly
proceeds into decrypting a RC4 key (<b>1@zFg08*@45</b>) which is
further used to decrypt a URL and sample's Config ID. (Figure 6)</div>
<div style="margin-bottom: 0in;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgI6TCYOfnEFlVgIwtuBt4AbMCl4qFLepDn070N3e3HeROXAbFnpLW8t1uAGdk4OvlxAXi4-XKFw4Gbhbm_7mD0NnABmPgqH5e5DxKC9LCGMx_AZz6FQyFb4R_RbOB-NXBgIoBXEgKSs4rj/s1600/rc4_key.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="438" data-original-width="574" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgI6TCYOfnEFlVgIwtuBt4AbMCl4qFLepDn070N3e3HeROXAbFnpLW8t1uAGdk4OvlxAXi4-XKFw4Gbhbm_7mD0NnABmPgqH5e5DxKC9LCGMx_AZz6FQyFb4R_RbOB-NXBgIoBXEgKSs4rj/s1600/rc4_key.png" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
6</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in;">
There are 2 hardcoded strings,
encrypted with RC4 and encoded with base64 encoding .They also have
multiple newline and space characters (probably to break static
tool?). These strings are the URL of  the first domain and the Config
ID of the current sample. (Figure 7)</div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjm9dq2RsnrGGfWViO6lbjzbFOY7blLiwHetxgAqfFQWTcIAFWrzKAz_6kzu9Rg17WS6xxMDHKLma0nT9nstiQGpL3k4mbu6DJIUfBkfTCm96NENyM8e92e6IiLkhHLrUIkn0-P17S_1JPO/s1600/key_and_domain_b64.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="207" data-original-width="867" height="152" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjm9dq2RsnrGGfWViO6lbjzbFOY7blLiwHetxgAqfFQWTcIAFWrzKAz_6kzu9Rg17WS6xxMDHKLma0nT9nstiQGpL3k4mbu6DJIUfBkfTCm96NENyM8e92e6IiLkhHLrUIkn0-P17S_1JPO/s640/key_and_domain_b64.PNG" width="640" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
7</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in;">
In the current sample, a request is
performed towards a drive.google.com url followed, by a lookup  in
the response headers in order to locate two substrings:
'.<b>txt";filename*=UTF-8</b>' and <b>'attachment;filename=</b>'(Figure
 8,10). Their values are the RC4 encrypted CnC that is ought to
respond later with a valid JSON configuration. (Figure 9). It should
be noted that, the key RC4 key for decrypting the CnC domain is
different than the one used before, but it is hardcoded in the sample
(<b>7effd829b15db71f1e5431670f17da25</b>).<br />
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2MMU2pMZ6MejnZikiHC91gSgobZVCnJKBHXqtt00Va5QTyhxtfjcIDaBsbPxnlM8DA2D7s03EwQdQCBO7BZHtDkz4gj5ksITwqbQJNoOx4QYID5hyHce6Dj5ZtMqgNBoEjSNmA1wHQvE7/s1600/headers_rsp.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="172" data-original-width="799" height="136" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2MMU2pMZ6MejnZikiHC91gSgobZVCnJKBHXqtt00Va5QTyhxtfjcIDaBsbPxnlM8DA2D7s03EwQdQCBO7BZHtDkz4gj5ksITwqbQJNoOx4QYID5hyHce6Dj5ZtMqgNBoEjSNmA1wHQvE7/s640/headers_rsp.png" width="640" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
8</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHM8Bm20HPonPslS1mTe_InX1-19oGbsusU5sCSuzCHUa7wx_59z6vfqX1ZIrCNsfKCyCI6qDS4hBj1AL1ftFnwhYt2c1V7EJVxzq1ml_SE_UwKK3DXH4ObT1ck_-bx-cX-LMp23LdyGvx/s1600/replay_req.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="179" data-original-width="685" height="167" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHM8Bm20HPonPslS1mTe_InX1-19oGbsusU5sCSuzCHUa7wx_59z6vfqX1ZIrCNsfKCyCI6qDS4hBj1AL1ftFnwhYt2c1V7EJVxzq1ml_SE_UwKK3DXH4ObT1ck_-bx-cX-LMp23LdyGvx/s640/replay_req.png" width="640" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
9</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgnSW-3o1MBcGT836TpA4w4FYM2XJAN0FgDIR54NSwsM-XXpwDP4ncB9sKpsbodQXhXyMDCny1Lht6bZncDOvY4T2KOUDYY_sBu6qLrk5pvJx9JGGjaXBd4yCdov3HJVQSUzjeiubafio1t/s1600/properties_from_http_rsp.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="623" data-original-width="721" height="553" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgnSW-3o1MBcGT836TpA4w4FYM2XJAN0FgDIR54NSwsM-XXpwDP4ncB9sKpsbodQXhXyMDCny1Lht6bZncDOvY4T2KOUDYY_sBu6qLrk5pvJx9JGGjaXBd4yCdov3HJVQSUzjeiubafio1t/s640/properties_from_http_rsp.PNG" width="640" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
10</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div style="margin-bottom: 0in;">
After that, it's time for the UUID of
the infected workstation to be built. This is done by getting the
machine GUID, user's name and the previously encrypted config in the
sample all together concentrated. The parameter  is encoded with
base64 encoding and a POST request is performed to the previously
decrypted CnC domain. (Figure 11, 12)<br />
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhos2kreXl-bUmjvCTOf17l0UtV6lieXsZpilanTczv8FYcT-KQlU-x_Sq7zRoPoe8e-41GdhWsK_oL2Tl6tM7IY6jovlmTvYkhwZp_o-Yk2W3Db7evg6XgDDSifyyXjER5o747m2znVnpW/s1600/bot_id_creation.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="330" data-original-width="583" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhos2kreXl-bUmjvCTOf17l0UtV6lieXsZpilanTczv8FYcT-KQlU-x_Sq7zRoPoe8e-41GdhWsK_oL2Tl6tM7IY6jovlmTvYkhwZp_o-Yk2W3Db7evg6XgDDSifyyXjER5o747m2znVnpW/s1600/bot_id_creation.PNG" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
11</b></span></span></div>
<div class="separator" style="clear: both; text-align: center;">
</div>
<div class="separator" style="clear: both; text-align: center;">
<br /></div>
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrITpYyYTttheb2KGchqgWnry93VhedV2pBcW-OGSMXG6_v8mGWV1DZURKM0Sj9V_RBmqOCCJT0JYFaR3nTyIc9LvvPB6I068zMdNPB6L7iRZVYwmMiKuclLs9g-ERt7zh8HGikVS8ixs2/s1600/config_creation.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="340" data-original-width="567" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrITpYyYTttheb2KGchqgWnry93VhedV2pBcW-OGSMXG6_v8mGWV1DZURKM0Sj9V_RBmqOCCJT0JYFaR3nTyIc9LvvPB6I068zMdNPB6L7iRZVYwmMiKuclLs9g-ERt7zh8HGikVS8ixs2/s1600/config_creation.PNG" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
12</b></span></span></div>
<div style="margin-bottom: 0in;">
<br />
<br /></div>
<div style="margin-bottom: 0in; page-break-before: always;">
The malware
ensures that a response is valid by either checking for the existence
of the string 'Wrong config id' or by the string 'url'. Also, if the
response does not contain the 'Wrong config id' but somehow contains
the string 'url', will later fail during the parsing of the
configuration. (C++ exceptions). (Figure 13) 
</div>
<div class="separator" style="clear: both; text-align: center;">
</div>
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDb-5W3PQ58c1tLdHX1HSgvPc6OyCeaa2IC2mdBbJeeQogScjV4dML6LmCwC_tGkLsyFPal3HvZJBU3v8yrhoox38WNG2z2bLhLzOEF1DB1E39TliK_zKTtompx9UA-a_qpIe7DVkS7KQL/s1600/wrong_config_check.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="301" data-original-width="622" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDb-5W3PQ58c1tLdHX1HSgvPc6OyCeaa2IC2mdBbJeeQogScjV4dML6LmCwC_tGkLsyFPal3HvZJBU3v8yrhoox38WNG2z2bLhLzOEF1DB1E39TliK_zKTtompx9UA-a_qpIe7DVkS7KQL/s1600/wrong_config_check.PNG" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
13</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div style="margin-bottom: 0in;">
If the JSON config is valid, then the
the value of 'url' json property is acquired. Also, a folder is
created in TEMP with named 'TrashCan' which was not used during
execution. (Figure 14). It should be also noted that, all the file
operations are performed via transactions, something that Fumiko[5],
another malware researcher has described in one of his blog posts.</div>
<div style="margin-bottom: 0in;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidyLHtTiQns56BcCf_BM7APGjek-QTd0_qT4qvjqDg8u6g1fCi2OddgwQOz3I0q9nu4IEA4hbXhp7xk_ApvGV_eVkKZdFcsNDW_8S1hDwb6Ri9T9iuZgzLx-hk5c__GO39jxSwMf4I4QVp/s1600/creation_of_folder.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="514" data-original-width="726" height="453" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidyLHtTiQns56BcCf_BM7APGjek-QTd0_qT4qvjqDg8u6g1fCi2OddgwQOz3I0q9nu4IEA4hbXhp7xk_ApvGV_eVkKZdFcsNDW_8S1hDwb6Ri9T9iuZgzLx-hk5c__GO39jxSwMf4I4QVp/s640/creation_of_folder.PNG" width="640" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
14</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div style="margin-bottom: 0in;">
Another check of properties in the
confiq occurs, for 'config' and 'mask'. If succesfull located the
sample continues to create a string
'C:\\Users\\user\\AppData\\Local\\Temp\\Log.zip' for future usage.
Another property check happens, for 'attachment_url'. If it exists,
its value will be acquired, which in our case is a .dll. The malware
will start preparing the ground to download and load the particular
library.As it is common with Raccoon, a string is decrypted in memory
and in this case it is 'sqlite3.dll'. Later, a full TEMP path will be
built in order to be used by UrlDownloadToFileA to download and save
the file.( Figure 15)<br />
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiIh_7jCNqJjTgggIDBjF5Py9iy9t8A7LpLWnLqfzJb-f8YyzSzpp3UjPIyw3s6TSOUqnODC4cuzehVoTlEvNsnL9iEFJdH7IDdpH6rbvKNnMLZVvEI7V0S0tzdkYImcKXsWzWy_1sXyO-j/s1600/download_sqlite3.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="187" data-original-width="612" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiIh_7jCNqJjTgggIDBjF5Py9iy9t8A7LpLWnLqfzJb-f8YyzSzpp3UjPIyw3s6TSOUqnODC4cuzehVoTlEvNsnL9iEFJdH7IDdpH6rbvKNnMLZVvEI7V0S0tzdkYImcKXsWzWy_1sXyO-j/s1600/download_sqlite3.PNG" /></a></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
15</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div style="margin-bottom: 0in;">
Then it proceeds into checking the
value of the 'history_is_enabled' property and begins its first
stealing operation - loading the dropped sqlite3.dll library getting
the data from Chrome-like browsers by searching in specific folders.
This is done by iterating an array of structures with size 18h,
containing 4 offsets to various paths like Login Data, Cookies, Web
Data and User Data for various browsers descendant of Chrome. The
index is saved in ESI register while accessing the various members of
the structures holding the information about the browsers. (Figure
16, 17)<br />
<br /></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjg_qpY-q7-Rz5eD9aYHebCFDpXraKuRA9up028Xe_bbsU9uMPvkpuKBS1SHqOsXZzTLjNSSE-ecCGa_F_USJYPGjUGCYCqf04TVCAi0WVNoj2pd35i4YMn1hL-LqMUBFjZMZaucymsQhYW/s1600/steal_data.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="580" data-original-width="636" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjg_qpY-q7-Rz5eD9aYHebCFDpXraKuRA9up028Xe_bbsU9uMPvkpuKBS1SHqOsXZzTLjNSSE-ecCGa_F_USJYPGjUGCYCqf04TVCAi0WVNoj2pd35i4YMn1hL-LqMUBFjZMZaucymsQhYW/s1600/steal_data.png" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
16</b></span></span></div>
<div style="margin-bottom: 0in;">
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgiaoIZ9cqh_21rv8g6vhXMK0U0dhaW4N-B984btZ17jOLeHQ88pwZPZGBGaG3tiaK_AE9nPcpXlowrKcc762bcvtn5QkaXS9ROOZdqxjtR5j3J9bmqPIfFD5ajw_I6DMnJq5Mj8OpzA8Q8/s1600/steal_data_from_chrome_other.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="512" data-original-width="656" height="499" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgiaoIZ9cqh_21rv8g6vhXMK0U0dhaW4N-B984btZ17jOLeHQ88pwZPZGBGaG3tiaK_AE9nPcpXlowrKcc762bcvtn5QkaXS9ROOZdqxjtR5j3J9bmqPIfFD5ajw_I6DMnJq5Mj8OpzA8Q8/s640/steal_data_from_chrome_other.PNG" width="640" /></a></div>
</div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
17</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div style="margin-bottom: 0in;">
Next, the sample attempts to steal all
the data associated with Internet Explorer. This is done by calling
three different functions, each aimed at stealing different data such
as auto complete information, http basic authentication passwords
stored in credentials store and finally data from Vault. The methods
used here are known to the public and were detailed explained
here[2]. (Figure 18)</div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjeYv0dWrwzYRpZkKUnVD500FtI50PGkMydQ8W1TTFjuc6bLIOKlDKwJz0uNfhJtCDNMkt5Nz7R-G4Gzcb6WJt2YHybqdHhwdxkQ9qEaEUnAfasfEFDNrqxdIwvT-KlhQYivS73HaZBkD53/s1600/dump_ie_data.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="375" data-original-width="629" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjeYv0dWrwzYRpZkKUnVD500FtI50PGkMydQ8W1TTFjuc6bLIOKlDKwJz0uNfhJtCDNMkt5Nz7R-G4Gzcb6WJt2YHybqdHhwdxkQ9qEaEUnAfasfEFDNrqxdIwvT-KlhQYivS73HaZBkD53/s1600/dump_ie_data.png" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
18</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in; page-break-before: always;">
Lastly,
another string is decrypted in memory 'libraries' and again its
existence is checked against the response. If the property exists
then the its value will be acquired resulting in a URL containing
additional libraries. The sample will attempt to perform its next
stealing operation targeting Firefox - like browsers by downloading
the additional libraries, loading them and resolving the needed APIs
in order to steal the data. It should be noted that, the path that
the additional libraries were extracted is added as a value in the
enviromental variable 'PATH'. (Figure 19)<br />
<br /></div>
<div style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgFu_tNBQmmt_B6yzJmsLFz5dc-92cgvbVovpnN5zvZIUszXMruuuqZx3Zh8QcI1GwLJTjZO7J2Af_SH6xWrL_uQWP7RDhOq2y6wTtYYKPFdvXJJ7eydNKIAhjxISzo-T_PzkBs0LMeS8I9/s1600/steal_data_from_firefox.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="638" data-original-width="656" height="622" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgFu_tNBQmmt_B6yzJmsLFz5dc-92cgvbVovpnN5zvZIUszXMruuuqZx3Zh8QcI1GwLJTjZO7J2Af_SH6xWrL_uQWP7RDhOq2y6wTtYYKPFdvXJJ7eydNKIAhjxISzo-T_PzkBs0LMeS8I9/s640/steal_data_from_firefox.PNG" width="640" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
19</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div style="margin-bottom: 0in;">
Firstly the malware checks if the
"C:\\Users\\user\\AppData\\Local\\Temp\\AdLibs\\nss3.dll"
(Figure 20 ) exists in disk and if not, it then proceeds into
downloading the set of libraries to the path
"C:\\Users\\user\\AppData\\Local\\Temp\\AdLibs\\ff-funcs.zip"
and unzip the libraries at
"C:\\Users\\user\\AppData\\Local\\Temp\\AdLibs\\". Finally,
the 'nss3.dll' library will be loaded and the associated APIs will be
resolved in order to be used in the next function (Figure 21). The
malware attempts to steal <b>History</b>, <b>Signons</b>, cookies,
<b>places.sqlite</b> by looping again against an array of structures
holding information for Firefox-like browsers. 
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgDYrCROkhLtS3bWSGQgelh5yxam-hEETfpkuWgbeqQf51-Ufow2nyNhwFeA4BIAKjYi9ICYqBVdExRIYhVN8ymC7MqftNcERD2TpezBn11zwgZD8J0GcUoP0b0fx6ZjbtuTE_8xgxsVg6s/s1600/unzip_and_res_0.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="498" data-original-width="657" height="485" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgDYrCROkhLtS3bWSGQgelh5yxam-hEETfpkuWgbeqQf51-Ufow2nyNhwFeA4BIAKjYi9ICYqBVdExRIYhVN8ymC7MqftNcERD2TpezBn11zwgZD8J0GcUoP0b0fx6ZjbtuTE_8xgxsVg6s/s640/unzip_and_res_0.PNG" width="640" /></a></div>
</div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
20</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span>
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjsgNANBQdFAz9UO0XOXovM9zwdVyg4dOba7aO5kFxefHjrqVrkIUCD0sDf50LXewvmNmgI-ku4rpZXx-IxsF0U7OZgc6TMcucXieNARL7IgJtXWa-_7nkWjQR5CKR2Qbw2ZKGywuz2HGm8/s1600/resolve_api_0.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="281" data-original-width="657" height="273" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjsgNANBQdFAz9UO0XOXovM9zwdVyg4dOba7aO5kFxefHjrqVrkIUCD0sDf50LXewvmNmgI-ku4rpZXx-IxsF0U7OZgc6TMcucXieNARL7IgJtXWa-_7nkWjQR5CKR2Qbw2ZKGywuz2HGm8/s640/resolve_api_0.PNG" width="640" /></a></div>
</div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
21</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div align="JUSTIFY" style="margin-bottom: 0in;">
Finishing with the
browsers, the sample proceeds into stealing email data associated
with Outlook browser. This was covered by Cybereason's blogspot so we
will proceed into the next stealing operation - taking data from
FoxMail client. It is thourogly checks for the existence of( Figure
22):</div>
<ol>
<li><div style="margin-bottom: 0in;">
D:\\Program Files\\Foxmail
 7.2\\Storage</div>
</li>
<li><div style="margin-bottom: 0in;">
D:\\Program Files (x86)\\Foxmail
 7.2\\Storage</div>
</li>
<li><div style="margin-bottom: 0in;">
D:\\Foxmail 7.2\\Storage</div>
</li>
<li><div style="margin-bottom: 0in;">
C:\\Program Files\\Foxmail
 7.2\\Storage</div>
</li>
<li><div style="margin-bottom: 0in;">
C:\\Program Files (x86)\\Foxmail
 7.2\\Storage</div>
</li>
<li><div style="margin-bottom: 0in;">
C:\\Foxmail 7.2\\Storage</div>
</li>
</ol>
<div style="margin-bottom: 0in;">
and collects all the relative data.</div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhrSa4IHmawmzCJzH1JopohoQcEhV7yl33joaDd3GCJuv7SYRCTO7QYY7dr0v0BhdWrhAuIZlDqJktDRKEEogm8jsHt5PMd7RcY3DXSGzCp_p4VJc5acA0McgSibfb1lwCVS7AzwwZpf98e/s1600/steal_data_from_foxmail.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="653" data-original-width="756" height="552" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhrSa4IHmawmzCJzH1JopohoQcEhV7yl33joaDd3GCJuv7SYRCTO7QYY7dr0v0BhdWrhAuIZlDqJktDRKEEogm8jsHt5PMd7RcY3DXSGzCp_p4VJc5acA0McgSibfb1lwCVS7AzwwZpf98e/s640/steal_data_from_foxmail.PNG" width="640" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
22</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in; page-break-before: always;">
Finishing
from stealing data from Email clients, next thing is to collect
information from the infected workstation. The value of the 'IP'
property is being parsed from the JSON response and then a function
is responsible for gathering and writing to a file named
'machineinfo.txt' information. The installed programs are being
determined by looping through the entries of 
'SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall'(Table 1) . The information that is collected and written is the following
(Figure 23, 24):<br />
<br /></div>
<dl>
 <dd><table border="1" bordercolor="#000001" cellpadding="7" cellspacing="0" style="width: 590px;">
  <colgroup><col width="184"></col>
  <col width="376"></col>
  </colgroup><tbody>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
<b>Property</b></div>
</td>
   <td width="376"><div align="CENTER">
<b>Value</b></div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
Raccoon's version</div>
</td>
   <td width="376"><div align="CENTER">
Hardcoded</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
Build Time:</div>
</td>
   <td width="376"><div align="CENTER">
Hardcoded</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
Bot ID</div>
</td>
   <td width="376"><div align="CENTER">
Concatenation of strings
    (SOFTWARE\Microsoft\Cryptography\ MachineGuid + '_' +
    GetComputerNameA()</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
System Language</div>
</td>
   <td width="376"><div align="CENTER">
GetLocaleInfoA()</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
Username</div>
</td>
   <td width="376"><div align="CENTER">
GetUserNameA()</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
External IP</div>
</td>
   <td width="376"><div align="CENTER">
(Returned by the configuration)</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
Windows version</div>
</td>
   <td width="376"><div align="CENTER">
SOFTWARE\Microsoft\Windows NT\CurrentVersion\
    ProductName</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
System arch</div>
</td>
   <td width="376"><div align="CENTER">
GetSystemWow64DirectoryW()</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
CPU</div>
</td>
   <td width="376"><div align="CENTER">
CPUID</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
RAM (MB Used etc etc)</div>
</td>
   <td width="376"><div align="CENTER">
GlobalMemoryStatusEx()</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
Display Devices</div>
</td>
   <td width="376"><div align="CENTER">
EnumDisplayDevicesA()</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
Screen Resolution</div>
</td>
   <td width="376"><div align="CENTER">
GetSystemMetrics()</div>
</td>
  </tr>
<tr valign="TOP">
   <td width="184"><div align="CENTER">
Installed APPs</div>
</td>
   <td width="376"><div align="CENTER">
SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersi
    on\Uninstall</div>
</td>
  </tr>
</tbody></table>
<div style="text-align: center;">
<span style="color: #3d85c6;"><b>(Table 1)</b></span></div>
</dd><dd><div style="text-align: center;">
<span style="color: #3d85c6;"><b><br /></b></span></div>
</dd></dl>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div style="line-height: 100%; margin-bottom: 0in; text-align: center;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEigH26cUiDfOT4qBi-lDJpllTnZKGk1OaWjyZX2_0dH2KMDScADMOyehZilDJq0gSuvRMaGzRsZjM5Do82UHp-vhunwANjf7ugiaFHzlLtw7W_XO_3LSCpCjIwjCwv4ZiNwWN0ExbVSsBl3/s1600/raccoon_ver.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="501" data-original-width="710" height="451" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEigH26cUiDfOT4qBi-lDJpllTnZKGk1OaWjyZX2_0dH2KMDScADMOyehZilDJq0gSuvRMaGzRsZjM5Do82UHp-vhunwANjf7ugiaFHzlLtw7W_XO_3LSCpCjIwjCwv4ZiNwWN0ExbVSsBl3/s640/raccoon_ver.PNG" width="640" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
23</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span>
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhCN1lxu4kMSi5LlsxY02bSSx3SuZHefqn1o033FyDT0mVl4POYY7o3_lTmq12XgkFNzHZ_opQYbKnyY0dNMRqvu-sjleKT98y-yu2P71evS8Vuvo28PIYUlJG0zMBxTi2vb7UqoFuKLyyS/s1600/collect_info_example.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="568" data-original-width="752" height="483" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhCN1lxu4kMSi5LlsxY02bSSx3SuZHefqn1o033FyDT0mVl4POYY7o3_lTmq12XgkFNzHZ_opQYbKnyY0dNMRqvu-sjleKT98y-yu2P71evS8Vuvo28PIYUlJG0zMBxTi2vb7UqoFuKLyyS/s640/collect_info_example.PNG" width="640" /></a></div>
</div>
<div style="break-after: avoid; margin-bottom: 0in; text-align: center;">
</div>
<div style="line-height: 100%; margin-bottom: 0in; text-align: center;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
24</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div style="margin-bottom: 0in;">
The malware also has the capability of
taking a screenshot[1]. If the 'is_screen_enabled' property exists in
the JSON config and its value is 1, then the malware will take a
screenshot and saved it as screen.png in TEMP. (Figure 25)</div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgzLrZHkjZiLKYmYCwj4mxd1dqcARR0kcQVmRJPEjEdcpNW5FGcTbHQKOZVRKL1LQ6Q1vQScysR9B-jvD93UEv5giLt-RXEeJkVJv-_Yb6_Qf4K3WdQSVoSbGKduF3oJxOyl7YimlxeuXl_/s1600/check_is_screen.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="265" data-original-width="557" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgzLrZHkjZiLKYmYCwj4mxd1dqcARR0kcQVmRJPEjEdcpNW5FGcTbHQKOZVRKL1LQ6Q1vQScysR9B-jvD93UEv5giLt-RXEeJkVJv-_Yb6_Qf4K3WdQSVoSbGKduF3oJxOyl7YimlxeuXl_/s1600/check_is_screen.PNG" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
25</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div style="margin-bottom: 0in;">
Last but not least the sample looks for
various crypto coin wallets and attempt to steal their data. There is
a general search in the APPDATA for files named as 'wallet.dat' and
after that, famous wallets are targeted such as (Figures 26,27):</div>
<ul>
<li><div style="margin-bottom: 0in;">
Electrum</div>
</li>
<li><div style="margin-bottom: 0in;">
Ethereum Wallet</div>
</li>
<li><div style="margin-bottom: 0in;">
Exodus</div>
</li>
<li><div style="margin-bottom: 0in;">
Jaxx</div>
</li>
<li><div style="margin-bottom: 0in;">
Monero</div>
</li>
<li><div style="margin-bottom: 0in;">
Bither</div>
</li>
</ul>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhZSYQSbYwbY2sfr4ZNpCwgZbWB9JMmixZ0SwV2ORBrB78he6spDb3R1hunKGCfU6kDa_tSR6rPdXRskD6OT_bOH3qtPkQIV25TN5yGOFGE7OSXbAvMv_q7Sxi6tj7TycnGTbYTS5UFc-SL/s1600/steal_wallets.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="147" data-original-width="634" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhZSYQSbYwbY2sfr4ZNpCwgZbWB9JMmixZ0SwV2ORBrB78he6spDb3R1hunKGCfU6kDa_tSR6rPdXRskD6OT_bOH3qtPkQIV25TN5yGOFGE7OSXbAvMv_q7Sxi6tj7TycnGTbYTS5UFc-SL/s1600/steal_wallets.png" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
26</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKWbgAHB-jzskhQd2AHaLHeDdQD8rCZ5qUnDjlHx0a6weMfQIjrZ0qJHAQ27DqbIJnpXtLGTHi7Vrp18_JxlpOakpF1SLGHXq-CIoquEyBrwzWu3LFPFJxhHvoGSRTNow2NpSWXf16b7Bo/s1600/steal_wallet_example.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="472" data-original-width="694" height="435" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKWbgAHB-jzskhQd2AHaLHeDdQD8rCZ5qUnDjlHx0a6weMfQIjrZ0qJHAQ27DqbIJnpXtLGTHi7Vrp18_JxlpOakpF1SLGHXq-CIoquEyBrwzWu3LFPFJxhHvoGSRTNow2NpSWXf16b7Bo/s640/steal_wallet_example.png" width="640" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
27</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span></div>
<div style="margin-bottom: 0in;">
Finally, the sample is preparing for
the exfiltration phase. That means collecting all the information
that was written to Temp and zipping them up to a zip file named
'Log.zip'. The following files are searched up to be included in the
zip and are products of the previous attempts to steal data:</div>
<ol>
<li><div style="margin-bottom: 0in;">
password.txt</div>
</li>
<li><div style="margin-bottom: 0in;">
CC.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
browsers\\firefox_cookie.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
browsers\\firefox_urls.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
browsers\\chrome_urls.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
browsers\\chrome_cookie.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
browsers\\chrome_autofill.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
browsers\\ie_autofill.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
browsers\\ie_ftp_data.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
mails\\outlook.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
mails\\thunderbird.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
mails\\foxmail.txt 
 </div>
</li>
<li><div style="margin-bottom: 0in;">
Wallets\\Electrum</div>
</li>
<li><div style="margin-bottom: 0in;">
Wallets\\Ethereum</div>
</li>
<li><div style="margin-bottom: 0in;">
Wallets\\Exodus</div>
</li>
<li><div style="margin-bottom: 0in;">
Wallets\\Jaxx</div>
</li>
<li><div style="margin-bottom: 0in;">
Wallets\\Monero</div>
</li>
<li><div style="margin-bottom: 0in;">
machineinfo.txt but included in
 the zip as System Info.txt</div>
</li>
</ol>
<div style="margin-bottom: 0in;">
The additional libraries that were
dropped in disk are deleted, and so all the files that were included
in the zip file. Before the sample deletes itself and terminate its
execution[1] it does something interesting: it checks for the
existence of property 'loader_urls' in the JSON config. If it exists,
then the sample will generate a random 10 letter name, part of an
executable path.(Picture). This will be the location that the
executable will be downloaded from the URL, which is the value of the
'loader_urls'. The executable then will be executed. The file will be
executed with the ShellExecuteW Windows API. (Figure 28)<br />
<br /></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLOUq3pagdyg-dL_4JexruvRUP2V70FLjfRPi2YxkvM8T35ccu-QGOpUotvrFhNnjHspy40s6lS_F-_KZpIlkHd3xzrKgb9WDXg72AzMIS7dcmvOsx0NDCvkgZLdF5o6zTNPLaK-hufCjJ/s1600/download_file_loc.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="536" data-original-width="685" height="500" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLOUq3pagdyg-dL_4JexruvRUP2V70FLjfRPi2YxkvM8T35ccu-QGOpUotvrFhNnjHspy40s6lS_F-_KZpIlkHd3xzrKgb9WDXg72AzMIS7dcmvOsx0NDCvkgZLdF5o6zTNPLaK-hufCjJ/s640/download_file_loc.png" width="640" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
28</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in; page-break-before: always;">
Lastly, the
malware deletes itself from the infected workstation by executing
'cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 &gt; Nul &amp; Del /f /q "%s"'
as it was stated in Cybereason's blogspot[1]. One thing that comes in
mind immediately after finishing the analysis is - did we miss to
locate the way that the malware is acquiring persistence in the
system, or it does not have any persistence method at all? In the
next blogspot, we will discuss and analyze the PE file which was
downloaded earlier and the way it is enforcing a persistence across
the system. (Figure 29)<br />
<br /></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRnU2TPQNqVGtoZ10R7Bgbam3hd1GTqlD0-hFQljk3bK3YVDT9DxeIN-ldZrbpqoDIH0hG3qrrP3nNvPeI1Vkp4gy0um6oLJB5CzAvy05KopkLDx6G_kvz51lh_qGbnKij6XiDmrtY4aMr/s1600/delete_file.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="733" data-original-width="754" height="622" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRnU2TPQNqVGtoZ10R7Bgbam3hd1GTqlD0-hFQljk3bK3YVDT9DxeIN-ldZrbpqoDIH0hG3qrrP3nNvPeI1Vkp4gy0um6oLJB5CzAvy05KopkLDx6G_kvz51lh_qGbnKij6XiDmrtY4aMr/s640/delete_file.png" width="640" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
29</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<h1 class="western">
Evolution</h1>
<div style="margin-bottom: 0in;">
As it is normal for that kind of
malware, there was a new version while this article was written.
Another malware researcher&nbsp;<a href="https://twitter.com/fumik0_" target="_blank">Fumiko</a>, was kind enough to point me to
another Raccoon sample found in his tracker (
MD5:<b>121f7cba18bcb38e68bd4fc4f2e71815 </b>). During a quick static
analysis by running our IDAPython script, it was revealed that there
was indeed a new version, specifically called '[Raccoon Stealer] -
v1.3.2 UC-International Release'(Figure 30)</div>
<div style="margin-bottom: 0in;">
<br /></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhusSIWufa8LitJ63FxI1iFGOi5klVutfUMYUBlvVC3_umeU5WdshYeaNJYYPB4SBDQdg-lcRlwJqiso93QeQ1ZI5u024qD6agkwJzHn61A8wcqakwHOhaCx7vKO-WMQx6cMdpk-I5LbvAJ/s1600/new_version.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="334" data-original-width="656" height="325" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhusSIWufa8LitJ63FxI1iFGOi5klVutfUMYUBlvVC3_umeU5WdshYeaNJYYPB4SBDQdg-lcRlwJqiso93QeQ1ZI5u024qD6agkwJzHn61A8wcqakwHOhaCx7vKO-WMQx6cMdpk-I5LbvAJ/s640/new_version.png" width="640" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
30</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in; page-break-before: always;">
While a
responsible analyst would take a closer look, diff the functions in
order to discover new changes etc etc, we are of the lazy type. So
instead of all that, all the strings from a sample with version 1.2
were dumped to a .txt file and diffed against all the strings from
the new version. This resulted in the following :</div>
<ul>
<li><div style="margin-bottom: 0in;">
Some new targets were added and
 specifically FileZilla (Figure 31)</div>
</li>
<li><div style="margin-bottom: 0in;">
There was some new SQLITE queries
 added (maybe to support newer browser versions?) (Figure 32)</div>
</li>
</ul>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhJiy7Rsw3cmG36DGJlZGVidKZVIxzy6zpANMTZzeVYlH_xz4yuPJltHVIzDETvhGxyksMYa_Iu9kkhnX2V5rK9u-yXkrht0ixoGykiUPLBBC_vq_hOFzdBFmsy4JMH_XulzccwEXAz8koq/s1600/diff_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="259" data-original-width="441" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhJiy7Rsw3cmG36DGJlZGVidKZVIxzy6zpANMTZzeVYlH_xz4yuPJltHVIzDETvhGxyksMYa_Iu9kkhnX2V5rK9u-yXkrht0ixoGykiUPLBBC_vq_hOFzdBFmsy4JMH_XulzccwEXAz8koq/s1600/diff_1.png" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
31</b></span></span></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span>
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhSGnoPInG9pPK7HR45J0Ot_CkqZZ1DaYHZ_KFe45KO6N1BbbPKb4dJSkrvkgJ5nS2glxYQLUWYYt9Tadwhzifw1RXb4LuMRuO1KfL-hB7NdCBw8uH3DFf-IOiITsuZyfES660oiI8htW3e/s1600/diff_2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="177" data-original-width="969" height="116" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhSGnoPInG9pPK7HR45J0Ot_CkqZZ1DaYHZ_KFe45KO6N1BbbPKb4dJSkrvkgJ5nS2glxYQLUWYYt9Tadwhzifw1RXb4LuMRuO1KfL-hB7NdCBw8uH3DFf-IOiITsuZyfES660oiI8htW3e/s640/diff_2.png" width="640" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
32</b></span></span></div>
<div style="margin-bottom: 0in;">
<br />
In order to confirm our findings, we
would have to execute the malware and monitor specific API calls to
verify the above. What's the point of working in a sandboxing company
if not using the sandbox for that kind of things (Well, apart from
malware classification)? Executing the malware[8] and inspecting the
logs revealed that indeed the samples is checking for that kind of
paths. (Figure 33) Also, a new directory called (TempDir-Extended) is
created and the two files are potentially stored there. The new
directory also exists in our diffing thus further verifying the
validity of our results. (Figure 34)<br />
<br /></div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjsHbTlUBD18STzV4sG1eJmSwOexpxyrzMDvcTL1rEGU__4dpibdA93df6g1j4IUx7-r_95_zrystTRo4REh5AxfFEPuccB4_u5rVQBVjRPwDXq7E80a-ZcLFan3bQH2pG9L4jnSHzcVupq/s1600/diff_4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="92" data-original-width="1514" height="38" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjsHbTlUBD18STzV4sG1eJmSwOexpxyrzMDvcTL1rEGU__4dpibdA93df6g1j4IUx7-r_95_zrystTRo4REh5AxfFEPuccB4_u5rVQBVjRPwDXq7E80a-ZcLFan3bQH2pG9L4jnSHzcVupq/s640/diff_4.png" width="640" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
33</b></span></span><br />
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b><br /></b></span></span>
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhmaWs8PpIugVz-yqiLcv4lSbHDVvt5Tg_T-PiVB7Ndg12IT8FtI9fN7LRO2R7e_9JOT1x0sABB3UWNvd7jS3s29OknznwMddKqgC7HGLfClP9FSiLMcfmumYVxCDOkhS6Hi8Y2sJXMv4e_/s1600/diff_3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="72" data-original-width="321" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhmaWs8PpIugVz-yqiLcv4lSbHDVvt5Tg_T-PiVB7Ndg12IT8FtI9fN7LRO2R7e_9JOT1x0sABB3UWNvd7jS3s29OknznwMddKqgC7HGLfClP9FSiLMcfmumYVxCDOkhS6Hi8Y2sJXMv4e_/s1600/diff_3.png" /></a></div>
</div>
<div align="CENTER" style="margin-bottom: 0in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in; page-break-before: always;">
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure 34</b></span></span></div>
<div style="margin-bottom: 0in;">
<br /></div>
<div style="margin-bottom: 0in;">
From a quick look of the static code
and based on the execution logs taken from the sandbox execution we
concluded that:</div>
<ul>
<li><div style="margin-bottom: 0in;">
The content of the wallets that
 were stolen is stored in new files based on the type of the coin (
 trevor, ledge ) also in a new path but will be added to the Log.zip
 file with the same name.</div>
</li>
<li><div style="margin-bottom: 0in;">
There seems to be a change in the
 way that the dumped passwords are stored in the associate .txt files
 based on static code compare to the older versions. (Couldn't verify
 that as I have a VM without pre-configured data)</div>
</li>
<li><div style="margin-bottom: 0in;">
Seems that in the System Info.txt
 was added the information of the computer's name. This was later
 verified by inspecting the dropped .txt file before being deleted by
 the sample. (Figure 35)</div>
</li>
</ul>
<div style="margin-bottom: 0in; margin-left: 0.5in;">
<br /></div>
<div align="CENTER" style="margin-bottom: 0in; margin-left: 0.5in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgpV-w4VZaJe2Rsmlubl9CK2EDN6T5x4S59l7jdFI8uk8mQesSOzfFVLsjGKj6M9PC8mL5oVQYvWDrliP__usG98Q_tZjLg_YjMdWnBwsnhiyPnbFMUDnrZ3mYG9hE1rBYdJeA4Rf39Qlib/s1600/added_info.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="68" data-original-width="376" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgpV-w4VZaJe2Rsmlubl9CK2EDN6T5x4S59l7jdFI8uk8mQesSOzfFVLsjGKj6M9PC8mL5oVQYvWDrliP__usG98Q_tZjLg_YjMdWnBwsnhiyPnbFMUDnrZ3mYG9hE1rBYdJeA4Rf39Qlib/s1600/added_info.png" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
35</b></span></span></div>
<h1 class="western">
Conclusion</h1>
<div style="margin-bottom: 0in;">
Raccoon is a infostealer capable of
performing a variety of actions, justifying its price and its heavy
usage from a variety of criminals. From the above analysis, one must
remember that:</div>
<ul>
<li><div style="margin-bottom: 0in;">
The CnC domain is acquired
 dynamically - there is an HTTP request beforehand to get the CnC
 encrypted with RC4 ( It is not hardcoded in the sample)</div>
</li>
<li><div style="margin-bottom: 0in;">
The credentials that were grabbed
 are saved in TEMP folder with specific names - easy to keep in mind
 during a IR assessment.</div>
</li>
<li><div style="margin-bottom: 0in;">
In version 1.2/1.3.2 there is not
 a persistence method - in this particular case thought, the response
 did have an EXE to be executed which would create a scheduled task
 but in general, there isn't one.</div>
</li>
<li><div style="margin-bottom: 0in;">
Some numeric constants did not
 change - if we carefully examine the code, most of the tags used
 during the completion of the machineinfo.txt file are 128bit
 constants hardcoded in the sample. Apart from the constant used to
 define the new version of the malware, the other ones are the same.
 ( With the addition of one used to decrypt <b>'ComputerName'</b> 
 string ). (Figure 36)</div>
</li>
</ul>
<div>
<br /></div>
<div align="CENTER" style="margin-bottom: 0in; margin-left: 0.5in; page-break-after: avoid;">
</div>
<div align="CENTER" style="line-height: 100%; margin-bottom: 0in;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj9EriqyIEWwvZ9fJOTYfNe2leqkCDYxPCCNE6KJ4TKTCWmL0jmkae1uf8I6wE6El0tBLEJEzwEYkp1SRnV_uEq3inpSElBwWwU4jTwgTbzq0NH7oMZXvD0C1qxG0l0_5HPchEmpdap4gm0/s1600/computer_name_decr.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="183" data-original-width="653" height="179" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj9EriqyIEWwvZ9fJOTYfNe2leqkCDYxPCCNE6KJ4TKTCWmL0jmkae1uf8I6wE6El0tBLEJEzwEYkp1SRnV_uEq3inpSElBwWwU4jTwgTbzq0NH7oMZXvD0C1qxG0l0_5HPchEmpdap4gm0/s640/computer_name_decr.png" width="640" /></a></div>
<span style="color: #4f81bd;"><span style="font-size: x-small;"><b>Figure
36</b></span></span></div>
<div style="margin-bottom: 0in;">
<br />
Lastly, there are some more things to
figure out and improve during the analysis of this family such as:</div>
<ul>
<li><div style="margin-bottom: 0in;">
There is not a clear explanation
 for the width property in the JSON - the same applies for the mask
 property too. It could be a placeholder for a future capability
 maybe?</div>
</li>
<li><div style="margin-bottom: 0in;">
By inspecting strings, it was
 revealed that the author is using a famous open source JSON[6]
 library for C++, and specifically the version 3.4.0. There was an
 attempt to produce a .lib file in order to use IDA's way of
 producing FLIRT signatures and make the analysis easier but was not
 successful. ( There were problems compiling a .hpp header with
 template definitions and no useful information was generated. )</div>
</li>
<li><div style="margin-bottom: 0in;">
There was not further exploration
 of the properties of the JSON thus there is no guarantee that this
 analysis covered all the potential capabilities of the malware.</div>
</li>
</ul>
<div>
<br /></div>
<span style="font-size: x-large;"><b>Special Thanks:</b></span><br />
<br />
<ul>
<li><a href="https://twitter.com/xorsthingsv2" target="_blank">xorsthingsv2</a>&nbsp;for taking the time to review the analysis and the doc.</li>
<li>Fumiko, for showing me the new sample</li>
<li><a href="https://twitter.com/tkanalyst" target="_blank">@tkanalyst</a>, for posting the raccoon samples</li>
</ul>
<br />
<h1 class="western">
Appendix</h1>
<div style="margin-bottom: 0in;">
<span style="font-size: small;"><b>Configurations (Table 2):</b></span><br />
<span style="font-size: small;"><b><br /></b></span></div>
<table border="1" bordercolor="#000001" cellpadding="7" cellspacing="0" style="width: 638px;">
 <colgroup><col width="124"></col>
 <col width="106"></col>
 <col width="364"></col>
 </colgroup><tbody>
<tr>
  <td width="124"><div align="CENTER">
MD5 HASH</div>
</td>
  <td width="106"><div align="CENTER">
Version</div>
</td>
  <td width="364"><div align="CENTER">
CnC Response</div>
</td>
 </tr>
<tr>
  <td width="124"><div align="CENTER">
f7bcb18e5814db9fd51d0ab05f2d7ee9</div>
</td>
  <td width="106"><div align="CENTER">
V1.2</div>
</td>
  <td width="364"><div align="CENTER">
<span style="font-size: x-small;">{"url":"http://34.89.185.248/file_handler/file.php?hash=252c0d60af493e46d25e7da5e10207c77b5627de&amp;js=1f192856af8a097533d9b8f13e1d168af9f585ca&amp;callback=http://34.89.185.248/gate","attachment_url":"http://34.89.185.248/gate/sqlite3.dll","libraries":"http://34.89.185.248/gate/libs.zip","ip":"xxx","config":{"masks":null,"loader_urls":null},"is_screen_enabled":0,"is_history_enabled":0,"depth":3}</span></div>
</td>
 </tr>
<tr>
  <td width="124"><div align="CENTER">
6556a3467ec8e58756af772aa72da99f</div>
</td>
  <td width="106"><div align="CENTER">
V1.2</div>
</td>
  <td width="364"><div align="CENTER">
<span style="font-size: x-small;">{"url":"http://34.77.197.252/file_handler/file.php?hash=7a48136f8f459660ec43988e0eb8bf0f77a00f0d&amp;js=2de257efd687492ea3537ea0beed2f3e026413c7&amp;callback=http://34.77.197.252/gate","attachment_url":"http://34.77.197.252/gate/sqlite3.dll","libraries":"http://34.77.197.252/gate/libs.zip","ip":"xxx","config":{"masks":null,"loader_urls":null},"is_screen_enabled":0,"is_history_enabled":0,"depth":3}</span></div>
</td>
 </tr>
<tr>
  <td width="124"><div align="CENTER">
121f7cba18bcb38e68bd4fc4f2e71815</div>
</td>
  <td width="106"><div align="CENTER">
V1.3.2</div>
</td>
  <td width="364"><div align="CENTER">
<span style="font-size: x-small;">{"url":"http://34.76.145.229/file_handler/file.php?hash=48b77b41f7e1cb233dc4592900244912bdfe7892&amp;js=429835ce099536a23c41ea48c6907cc616a76273&amp;callback=http://34.76.145.229/gate","attachment_url":"http://34.76.145.229/gate/sqlite3.dll","libraries":"http://34.76.145.229/gate/libs.zip","ip":"xxx","config":{"masks":null,"loader_urls":null},"is_screen_enabled":1,"is_history_enabled":1,"depth":3}</span></div>
</td>
 </tr>
<tr>
  <td width="124"><div align="CENTER">
80072d5f4bfa1ff22c87be610438792e</div>
</td>
  <td width="106"><div align="CENTER">
V1.2</div>
</td>
  <td width="364"><div align="CENTER">
<span style="font-size: x-small;">{"url":"http://34.65.76.39/file_handler/file.php?hash=27c70127350a34268baf46dc23eb4e09fd24f547&amp;js=a044f29dbf33cf8013c2cb40b27fa7e8c07cc4d7&amp;callback=http://34.65.76.39/gate","attachment_url":"http://34.65.76.39/gate/sqlite3.dll","libraries":"http://34.65.76.39/gate/libs.zip","ip":"xxx","config":{"masks":null,"loader_urls":null},"is_screen_enabled":0,"is_history_enabled":0,"depth":3}</span></div>
</td>
 </tr>
<tr>
  <td width="124"><div align="CENTER">
126ed436b3531dd857b25b9da2c80462</div>
</td>
  <td width="106"><div align="CENTER">
V1.2</div>
</td>
  <td width="364"><div align="CENTER">
<span style="font-size: x-small;">{"url":"http://35.197.207.160/file_handler/file.php?hash=2dfe29b8560662cbd03e409e04c32eb0a3e65028&amp;js=47de3ce52e822b60cd7e21a1d31dfb7a9a904ddf&amp;callback=http://35.197.207.160/gate","attachment_url":"http://35.197.207.160/gate/sqlite3.dll","libraries":"http://35.197.207.160/gate/libs.zip","ip":"xxx","config":{"masks":null,"loader_urls":["http://185.161.210.244/signed.exe"]},"is_screen_enabled":0,"is_history_enabled":0,"depth":3}</span></div>
</td>
 </tr>
</tbody></table>
<div style="margin-bottom: 0in;">
<div style="text-align: center;">
<span style="color: #3d85c6;"><b><br />(Table 2)</b></span></div>
</div>
<h1 class="western">
References</h1>
<div style="margin-bottom: 0in;">
[0]
https://support.microsoft.com/en-au/help/243330/well-known-security-identifiers-in-windows-operating-systems</div>
<div style="margin-bottom: 0in;">
[1]
https://www.cybereason.com/blog/hunting-raccoon-stealer-the-new-masked-bandit-on-the-block</div>
<div style="margin-bottom: 0in;">
[2]
https://securityxploded.com/iepasswordsecrets.php</div>
<div style="margin-bottom: 0in;">
[3]
https://www.codeproject.com/Articles/1167943/The-Secrets-of-Internet-Explorer-Credentials</div>
<div style="margin-bottom: 0in;">
[4]
<a href="https://cofense.com/raccoon-stealer-found-rummaging-past-symantec-microsoft-gateways/">https://cofense.com/raccoon-stealer-found-rummaging-past-symantec-microsoft-gateways/</a></div>
<div style="margin-bottom: 0in;">
[5]
<a href="https://fumik0.com/2019/05/24/overview-of-proton-bot-another-loader-in-the-wild/">https://fumik0.com/2019/05/24/overview-of-proton-bot-another-loader-in-the-wild/</a></div>
<div style="margin-bottom: 0in;">
[6] <a href="https://github.com/nlohmann/json">https://github.com/nlohmann/json</a><br />
[7]&nbsp;<a href="https://github.com/Secfreaks/analysis/tree/master/raccoon/idascript">https://github.com/Secfreaks/analysis/tree/master/raccoon/idascript</a><br />
[8]&nbsp;<a href="https://tria.ge/reports/191129-bykghah8ge/task1">https://tria.ge/reports/191129-bykghah8ge/task1</a></div>
<br />
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/09781003942180099981' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/09781003942180099981' rel='author' title='author profile'>
<span itemprop='name'>Secfreaks</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='https://www.secfreaks.gr/2019/12/in-depth-analysis-of-an-infostealer-raccoon.html' itemprop='url'/>
<a class='timestamp-link' href='https://www.secfreaks.gr/2019/12/in-depth-analysis-of-an-infostealer-raccoon.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2019-12-03T13:50:00-08:00'>13:50:00</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-1050397114'>
<a href='https://www.blogger.com/post-edit.g?blogID=1385596801881783511&postID=6078476001348773709&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=1385596801881783511&postID=6078476001348773709&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=1385596801881783511&postID=6078476001348773709&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=1385596801881783511&postID=6078476001348773709&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=1385596801881783511&postID=6078476001348773709&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=1385596801881783511&postID=6078476001348773709&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<a class='home-link' href='https://www.secfreaks.gr/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget Label' data-version='1' id='Label1'>
<h2>Categorized Malwares</h2>
<div class='widget-content list-label-widget-content'>
<ul>
<li>
<a dir='ltr' href='https://www.secfreaks.gr/search/label/idascript'>idascript</a>
</li>
<li>
<a dir='ltr' href='https://www.secfreaks.gr/search/label/infostealer'>infostealer</a>
</li>
<li>
<a dir='ltr' href='https://www.secfreaks.gr/search/label/raccoon'>raccoon</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://www.secfreaks.gr/2019/'>
2019
</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://www.secfreaks.gr/2019/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='posts'>
<li><a href='https://www.secfreaks.gr/2019/12/in-depth-analysis-of-an-infostealer-raccoon.html'>In depth analysis of an infostealer: Raccoon</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Awesome Inc. theme. Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<!--It is your responsibility to notify your visitors about cookies used and data collected on your blog. Blogger makes a standard notification available for you to use on your blog, and you can customize it or replace with your own notice. See http://www.blogger.com/go/cookiechoices for more details.-->
<script defer='' src='/js/cookienotice.js'></script>
<script>
    document.addEventListener('DOMContentLoaded', function(event) {
      window.cookieChoices && cookieChoices.showCookieConsentBar && cookieChoices.showCookieConsentBar(
          (window.cookieOptions && cookieOptions.msg) || 'This site uses cookies from Google to deliver its services and to analyze traffic. Your IP address and user-agent are shared with Google along with performance and security metrics to ensure quality of service, generate usage statistics, and to detect and address abuse.',
          (window.cookieOptions && cookieOptions.close) || 'Got it',
          (window.cookieOptions && cookieOptions.learn) || 'Learn More',
          (window.cookieOptions && cookieOptions.link) || 'https://www.blogger.com/go/blogspot-cookies');
    });
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/1812387825-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY5motMAc6bjLF4GQJxSsLD4mY5cCA:1742609434995';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d1385596801881783511','//www.secfreaks.gr/2019/12/in-depth-analysis-of-an-infostealer-raccoon.html','1385596801881783511');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '1385596801881783511', 'title': 'Secfreaks', 'url': 'https://www.secfreaks.gr/2019/12/in-depth-analysis-of-an-infostealer-raccoon.html', 'canonicalUrl': 'https://www.secfreaks.gr/2019/12/in-depth-analysis-of-an-infostealer-raccoon.html', 'homepageUrl': 'https://www.secfreaks.gr/', 'searchUrl': 'https://www.secfreaks.gr/search', 'canonicalHomepageUrl': 'https://www.secfreaks.gr/', 'blogspotFaviconUrl': 'https://www.secfreaks.gr/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en-GB', 'localeUnderscoreDelimited': 'en_gb', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Secfreaks - Atom\x22 href\x3d\x22https://www.secfreaks.gr/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Secfreaks - RSS\x22 href\x3d\x22https://www.secfreaks.gr/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Secfreaks - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/1385596801881783511/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Secfreaks - Atom\x22 href\x3d\x22https://www.secfreaks.gr/feeds/6078476001348773709/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/459db401c2dc748e', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en_GB\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '6078476001348773709', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCAXNtXE2B1shKS52TxJQ0X1wBKOF7d9vdFnxN9WMDq_M95HHt-Zq3z5O2TX19rjWFQ9hODcdwmefXLzvrlx-TkvEwEWvD2Df-r2yAZxq8KR6YX5ijkGjbpi_LpaN9xDEzyrUXgDx9SlNF/s72-c/fakenet_mod.png', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCAXNtXE2B1shKS52TxJQ0X1wBKOF7d9vdFnxN9WMDq_M95HHt-Zq3z5O2TX19rjWFQ9hODcdwmefXLzvrlx-TkvEwEWvD2Df-r2yAZxq8KR6YX5ijkGjbpi_LpaN9xDEzyrUXgDx9SlNF/s640/fakenet_mod.png', 'pageName': 'In depth analysis of an infostealer: Raccoon', 'pageTitle': 'Secfreaks: In depth analysis of an infostealer: Raccoon'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard', 'ok': 'Ok', 'postLink': 'Post link'}}, {'name': 'template', 'data': {'name': 'Awesome Inc.', 'localizedName': 'Awesome Inc.', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'light', 'variantId': 'light'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'In depth analysis of an infostealer: Raccoon', 'description': '  General Info     Raccoon is a malware written in C++. It came to my attention while looking at my twitter feed and spotting a tweet from @...', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCAXNtXE2B1shKS52TxJQ0X1wBKOF7d9vdFnxN9WMDq_M95HHt-Zq3z5O2TX19rjWFQ9hODcdwmefXLzvrlx-TkvEwEWvD2Df-r2yAZxq8KR6YX5ijkGjbpi_LpaN9xDEzyrUXgDx9SlNF/s640/fakenet_mod.png', 'url': 'https://www.secfreaks.gr/2019/12/in-depth-analysis-of-an-infostealer-raccoon.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 6078476001348773709}}]);
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'crosscol', document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'isCurrentPage': false, 'href': 'https://www.secfreaks.gr/', 'title': 'Home'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/2172000626-lbx__en_gb.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LabelView', new _WidgetInfo('Label1', 'sidebar-right-1', document.getElementById('Label1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>