<!doctype html>
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US"  class="touch-styles">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- This is Squarespace. --><!-- stratosphere-ips -->
<base href="">
<meta charset="utf-8" />
<title>Dark Nexus: the old, the new and the ugly &mdash; Stratosphere IPS</title>
<meta http-equiv="Accept-CH" content="Sec-CH-UA-Platform-Version, Sec-CH-UA-Model" /><link rel="icon" type="image/x-icon" href="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510076526263-H5676DRO9FLHCI9DST2F/favicon.ico?format=100w"/>
<link rel="canonical" href="https://www.stratosphereips.org/blog/2020/6/8/dark-nexus-the-old-the-new-and-the-ugly"/>
<meta property="og:site_name" content="Stratosphere IPS"/>
<meta property="og:title" content="Dark Nexus: the old, the new and the ugly &mdash; Stratosphere IPS"/>
<meta property="og:latitude" content="50.0757517"/>
<meta property="og:longitude" content="14.419946699999969"/>
<meta property="og:locality" content=""/>
<meta property="og:url" content="https://www.stratosphereips.org/blog/2020/6/8/dark-nexus-the-old-the-new-and-the-ugly"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="In this blog post we were able to take a sneak peek of what is Dark Nexus capable of and its details. We explored this by presenting it via three characteristics we named the old, the new and the ugly."/>
<meta property="og:image" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5edd480128c2346bbd6d18e9/1591560205929/image.png?format=1500w"/>
<meta property="og:image:width" content="1295"/>
<meta property="og:image:height" content="771"/>
<meta itemprop="name" content="Dark Nexus: the old, the new and the ugly — Stratosphere IPS"/>
<meta itemprop="url" content="https://www.stratosphereips.org/blog/2020/6/8/dark-nexus-the-old-the-new-and-the-ugly"/>
<meta itemprop="description" content="In this blog post we were able to take a sneak peek of what is Dark Nexus capable of and its details. We explored this by presenting it via three characteristics we named the old, the new and the ugly."/>
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5edd480128c2346bbd6d18e9/1591560205929/image.png?format=1500w"/>
<link rel="image_src" href="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5edd480128c2346bbd6d18e9/1591560205929/image.png?format=1500w" />
<meta itemprop="image" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5edd480128c2346bbd6d18e9/1591560205929/image.png?format=1500w"/>
<meta itemprop="author" content="Stratosphere IPS"/>
<meta itemprop="datePublished" content="2020-06-08T10:30:26-0400"/>
<meta itemprop="dateModified" content="2020-06-08T10:30:27-0400"/>
<meta itemprop="headline" content="Dark Nexus: the old, the new and the ugly"/>
<meta itemprop="publisher" content="Stratosphere IPS"/>
<meta name="twitter:title" content="Dark Nexus: the old, the new and the ugly — Stratosphere IPS"/>
<meta name="twitter:image" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5edd480128c2346bbd6d18e9/1591560205929/image.png?format=1500w"/>
<meta name="twitter:url" content="https://www.stratosphereips.org/blog/2020/6/8/dark-nexus-the-old-the-new-and-the-ugly"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="In this blog post we were able to take a sneak peek of what is Dark Nexus capable of and its details. We explored this by presenting it via three characteristics we named the old, the new and the ugly."/>
<meta name="description" content="In this blog post we were able to take a sneak peek of what is Dark Nexus 
capable of and its details. We explored this by presenting it via three 
characteristics we named the old, the new and the ugly." />
<link rel="preconnect" href="https://images.squarespace-cdn.com">
<link rel="preconnect" href="https://use.typekit.net" crossorigin>
<link rel="preconnect" href="https://p.typekit.net" crossorigin>
<script type="text/javascript" src="//use.typekit.net/ik/7S7aiE_3ARNLZHBfVF5QpfYr3D_L04qpJYjAtrEXszqfeCvffFHN4UJLFRbh52jhWDmyw2IUw2gcFRqkZA48w2bu5AIU529oZy7pMPG0SaskjWszSagGZW48OA83SkoDSWmyScmDSeBRZPoRdhXCdeNRjAUGdaFXOYFXScBXdaF3-emkZPuTSYw0SaBujW48Sagyjh90jhNlOYFXScBXdaF3-emkZA83SkozScSCiaiaO1FXScBXdaF3-emkZPuTSYw0SaBujW48Sagyjh90jhNlOYiaikoDiY4yieNDSey8ScmTSYw0da41J6iRjAUCiAoyJ6Z8iW4zSeI7fbKbwgMMeMw6MKG4fwXVIMMjgfMfH6qJD3vbMg6YJMJ7fbRb2UMMegI6MKG4fH8oIMIjMkMfH6qJ71qbMs6IJMJ7fbKGpsMgeMS6MKGHf55eMsMgeMX6MKGHf5PeMsMgeMt6MKGHf5AeMsMgegI6MTMglZptv39.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700"><script type="text/javascript" crossorigin="anonymous" defer="true" nomodule="nomodule" src="//assets.squarespace.com/@sqs/polyfiller/1.6/legacy.js"></script>
<script type="text/javascript" crossorigin="anonymous" defer="true" src="//assets.squarespace.com/@sqs/polyfiller/1.6/modern.js"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-8a6929b857b57fd1-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_runtime');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-8a6929b857b57fd1-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-b60fc53b12f6d6c5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_moment_js_vendor');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-b60fc53b12f6d6c5-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-4c50d377dd2c3266-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-4c50d377dd2c3266-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-51880dc0d7a0158c-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-51880dc0d7a0158c-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-25a6a9f67fbc7995-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-25a6a9f67fbc7995-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-eaf81719645c39ea-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-eaf81719645c39ea-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-641ed7033c6b0b5a-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/performance-641ed7033c6b0b5a-min.en-US.js" defer ></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"betaFeatureFlags":["campaigns_new_image_layout_picker","campaigns_thumbnail_layout","i18n_beta_website_locales","campaigns_import_discounts","order_status_page_checkout_landing_enabled","marketing_landing_page","campaigns_discount_section_in_blasts","marketing_automations","contacts_and_campaigns_redesign","campaigns_discount_section_in_automations"],"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-da53f22272c0f60d-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-5d864aadea1060d1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-e72461374205e066-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-47a224f34e715983-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-54badd2a3c7a1ca8-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-96b256171ee039c1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-ea68dbda5f388989-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-01eecf660cca1c8d-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-7b8bd6df03e1d0fd-min.en-US.js"},"squarespace-custom-css-popup":{"css":"//assets.squarespace.com/universal/styles-compressed/custom-css-popup-01f4ea53f1ef2e01-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/custom-css-popup-8bc9d49de38206f2-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-f9093f2d526b94df-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-29b32239953401ea-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-d6b0fafb2db5f0f2-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-b050d5cb37e54287-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-0afd3c6ac30bbab1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-26761529c74e14c4-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-de0dea92b161a99b-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-104246dd5ee81f93-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-999ae888ced44ad2-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-b742b752f5880972-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-eb97a22a748d7326-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-0ba5bac716923b8e-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-63d71ad5d1438e3c-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-d1bdb2ab433d5058-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-6676ab1a86064e26-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-90a67fc09b9b32c6-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-a1ac365b6124a586-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-28c3804d6764d558-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-701bf8bbc05ec6aa-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-b76ae7bcbecc9533-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-95032e5fa98e47a5-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-44a9624f2158f353-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-a7865865735d59fc-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-07ea5a4e004e6710-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-1b83c634e75bffd0-min.en-US.js"}},"pageType":50,"website":{"id":"5a01100f692ebe0459a1859f","identifier":"stratosphere-ips","websiteType":1,"contentModifiedOn":1741599218675,"cloneable":false,"hasBeenCloneable":false,"siteStatus":{},"language":"en-US","timeZone":"America/New_York","machineTimeZoneOffset":-14400000,"timeZoneOffset":-14400000,"timeZoneAbbr":"EDT","siteTitle":"Stratosphere IPS","fullSiteTitle":"Dark Nexus: the old, the new and the ugly \u2014 Stratosphere IPS","siteTagLine":"","siteDescription":"<p><span style=\"font-size:16px\">The Stratosphere </span><span style=\"font-size:16px\">IPS</span><span style=\"font-size:16px\">&nbsp;project was born in the </span><span style=\"font-size:16px\">CTU</span><span style=\"font-size:16px\">&nbsp;University of Prague in Czech Republic, as part of the PhD work of Sebastian Garc\u00EDa. Currently the project is being funded by the NLnet Foundation from Netherlands, to whom we are greatly thankful. Sebastian did his PhD in the </span><span style=\"font-size:16px\">ISISTAN</span><span style=\"font-size:16px\">&nbsp;Institute of</span><span style=\"font-size:16px\">UNICEN</span><span style=\"font-size:16px\">&nbsp;University in Argentina.</span></p>","location":{"mapLat":50.0757517,"mapLng":14.419946699999969,"addressTitle":"","addressLine1":"Karlovo n\u00E1m\u011Bst\u00ED","addressLine2":"Praha","addressCountry":"Czech Republic"},"logoImageId":"5a01f28c652dea59e99249e1","socialLogoImageId":"5a0111498165f56ac4a11d93","shareButtonOptions":{"4":true,"1":true},"logoImageUrl":"//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510077068933-2L2JCU07QZVDWC0Q7142/Logo-blue-header.png","socialLogoImageUrl":"//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510019401957-BZZD6BHIYSZHJO8KSNKG/StratosphereIPS+logo+1.png","authenticUrl":"https://www.stratosphereips.org","internalUrl":"https://stratosphere-ips.squarespace.com","baseUrl":"https://www.stratosphereips.org","primaryDomain":"www.stratosphereips.org","sslSetting":3,"isHstsEnabled":false,"socialAccounts":[{"serviceId":62,"screenname":"Twitter","addedOn":1580913754185,"profileUrl":"https://twitter.com/StratosphereIPS","iconEnabled":true,"serviceName":"twitter-unauth"}],"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"0a79fb1ba57f3eed2545bd138ee53d4c5132eaa4b6b3957737b03ff5a1628ef3","showOwnerLogin":false},"websiteSettings":{"id":"5a01100f692ebe0459a185a1","websiteId":"5a01100f692ebe0459a1859f","type":"Non-Profit","subjects":[],"country":"CZ","state":"B","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":true,"contactPhoneNumber":"","businessHours":{"monday":{"text":"","ranges":[{}]},"tuesday":{"text":"","ranges":[{}]},"wednesday":{"text":"","ranges":[{}]},"thursday":{"text":"","ranges":[{}]},"friday":{"text":"","ranges":[{}]},"saturday":{"text":"","ranges":[{}]},"sunday":{"text":"","ranges":[{}]}},"storeSettings":{"returnPolicy":null,"termsOfService":null,"privacyPolicy":null,"expressCheckout":false,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["CHF","HKD","MXN","EUR","DKK","USD","CAD","MYR","NOK","THB","AUD","SGD","ILS","PLN","GBP","CZK","SEK","NZD","PHP","RUB"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":2,"showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsSuccessText":"","restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false,"displayImportedProductReviewsEnabled":false,"hasOptedToCollectNativeReviews":false},"minimumOrderSubtotalEnabled":false,"minimumOrderSubtotal":{"currency":"USD","value":"0.00"},"isLive":false,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"ampEnabled":false,"userAccountsSettings":{"loginAllowed":false,"signupAllowed":false}},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":"","cookieBannerHasOptOut":false,"cookieBannerHasManageCookies":true,"cookieBannerManageCookiesLabel":"","cookieBannerSavedPreferencesText":"","cookieBannerSavedPreferencesLayout":"PILL"},"websiteCloneable":false,"collection":{"title":"Stratosphere IPS Research Blog","id":"5a01202be2c48324aeddc117","fullUrl":"/blog","type":1,"permissionType":1},"item":{"title":"Dark Nexus: the old, the new and the ugly","id":"5edd45033a11483ae76f7e3d","fullUrl":"/blog/2020/6/8/dark-nexus-the-old-the-new-and-the-ugly","publicCommentCount":0,"commentState":1,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":true,"tweakJSON":{"aspect-ratio":"Auto","banner-slideshow-controls":"Arrows","gallery-arrow-style":"No Background","gallery-aspect-ratio":"3:2 Standard","gallery-auto-crop":"true","gallery-autoplay":"false","gallery-design":"Grid","gallery-info-overlay":"Show on Hover","gallery-loop":"false","gallery-navigation":"Bullets","gallery-show-arrows":"true","gallery-transitions":"Fade","galleryArrowBackground":"rgba(34,34,34,1)","galleryArrowColor":"rgba(255,255,255,1)","galleryAutoplaySpeed":"3","galleryCircleColor":"rgba(255,255,255,1)","galleryInfoBackground":"rgba(0, 0, 0, .7)","galleryThumbnailSize":"100px","gridSize":"280px","gridSpacing":"10px","logoContainerWidth":"140px","product-gallery-auto-crop":"false","product-image-auto-crop":"true","siteTitleContainerWidth":"360px","tweak-v1-related-products-title-spacing":"50px"},"templateId":"52a74dafe4b073a80cd253c5","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/52a74d9ae4b0253945d2aee9/1053/scripts/","impersonatedSession":false,"tzData":{"zones":[[-300,"US","E%sT",null]],"rules":{"US":[[1967,2006,null,"Oct","lastSun","2:00","0","S"],[1987,2006,null,"Apr","Sun>=1","2:00","1:00","D"],[2007,"max",null,"Mar","Sun>=8","2:00","1:00","D"],[2007,"max",null,"Nov","Sun>=1","2:00","0","S"]]}},"showAnnouncementBar":false,"recaptchaEnterpriseContext":{"recaptchaEnterpriseSiteKey":"6LdDFQwjAAAAAPigEvvPgEVbb7QBm-TkVJdDTlAv"},"i18nContext":{"timeZoneData":{"id":"America/New_York","name":"Eastern Time"}},"env":"PRODUCTION"};</script><script type="module">Squarespace.load(window);</script>
<script data-sqs-type="imageloader-bootstrapper" type="module">if(window.ImageLoader) window.ImageLoader.bootstrap({}, document);</script>
<script type="module">Squarespace.afterBodyLoad(Y);</script>
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.stratosphereips.org/blog?format=rss" />
<script type="application/ld+json">{"url":"https://www.stratosphereips.org","name":"Stratosphere IPS","description":"<p><span style=\"font-size:16px\">The Stratosphere </span><span style=\"font-size:16px\">IPS</span><span style=\"font-size:16px\">&nbsp;project was born in the </span><span style=\"font-size:16px\">CTU</span><span style=\"font-size:16px\">&nbsp;University of Prague in Czech Republic, as part of the PhD work of Sebastian Garc\u00EDa. Currently the project is being funded by the NLnet Foundation from Netherlands, to whom we are greatly thankful. Sebastian did his PhD in the </span><span style=\"font-size:16px\">ISISTAN</span><span style=\"font-size:16px\">&nbsp;Institute of</span><span style=\"font-size:16px\">UNICEN</span><span style=\"font-size:16px\">&nbsp;University in Argentina.</span></p>","image":"//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510077068933-2L2JCU07QZVDWC0Q7142/Logo-blue-header.png","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"legalName":"","address":"Karlovo n\u00E1m\u011Bst\u00ED\nPraha\nCzech Republic","email":"stratosphere@aic.fel.cvut.cz","telephone":"","sameAs":["https://twitter.com/StratosphereIPS"],"@context":"http://schema.org","@type":"Organization"}</script><script type="application/ld+json">{"address":"Karlovo n\u00E1m\u011Bst\u00ED\nPraha\nCzech Republic","image":"https://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5a01f28c652dea59e99249e1/1741599218675/","name":"","openingHours":", , , , , , ","@context":"http://schema.org","@type":"LocalBusiness"}</script><script type="application/ld+json">{"name":"Dark Nexus: the old, the new and the ugly \u2014 Stratosphere IPS","url":"https://www.stratosphereips.org/blog/2020/6/8/dark-nexus-the-old-the-new-and-the-ugly","datePublished":"2020-06-08T10:30:26-0400","dateModified":"2020-06-08T10:30:27-0400","headline":"Dark Nexus: the old, the new and the ugly","author":"Stratosphere IPS","publisher":{"name":"Stratosphere IPS","logo":{"@type":"ImageObject","url":"https://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5a01f28c652dea59e99249e1/1741599218675/"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5edd480128c2346bbd6d18e9/1591560205929/image.png?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="https://static1.squarespace.com/static/sitecss/5a01100f692ebe0459a1859f/47/52a74dafe4b073a80cd253c5/5a01100f692ebe0459a185b3/1053/site.css"/><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-59793876-1"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZjQwMz', true);gtag('config', 'UA-59793876-1');</script><!-- End of Squarespace Headers -->
    <script>/* Must be below squarespace-headers */(function(){var e='ontouchstart'in window||navigator.msMaxTouchPoints;var t=document.documentElement;if(!e&&t){t.className=t.className.replace(/touch-styles/,'')}})()
    </script>
  </head>
  <body id="item-5edd45033a11483ae76f7e3d" class="enable-nav-button nav-button-style-solid nav-button-corner-style-square banner-button-style-solid banner-button-corner-style-square banner-slideshow-controls-arrows meta-priority-date  hide-entry-author hide-list-entry-footer    hide-blog-sidebar center-navigation--info     event-thumbnails event-thumbnail-size-32-standard event-date-label event-date-label-time event-list-show-cats event-list-date event-list-time event-list-address   event-icalgcal-links  event-excerpts  event-item-back-link    gallery-design-grid aspect-ratio-auto lightbox-style-light gallery-navigation-bullets gallery-info-overlay-show-on-hover gallery-aspect-ratio-32-standard gallery-arrow-style-no-background gallery-transitions-fade gallery-show-arrows gallery-auto-crop   product-list-titles-under product-list-alignment-center product-item-size-11-square product-image-auto-crop product-gallery-size-11-square  show-product-price show-product-item-nav product-social-sharing tweak-v1-related-products-image-aspect-ratio-11-square tweak-v1-related-products-details-alignment-center newsletter-style-light  opentable-style-light small-button-style-solid small-button-shape-square medium-button-style-solid medium-button-shape-square large-button-style-solid large-button-shape-square image-block-poster-text-alignment-center image-block-card-dynamic-font-sizing image-block-card-content-position-center image-block-card-text-alignment-left image-block-overlap-dynamic-font-sizing image-block-overlap-content-position-center image-block-overlap-text-alignment-left image-block-collage-dynamic-font-sizing image-block-collage-content-position-top image-block-collage-text-alignment-left image-block-stack-dynamic-font-sizing image-block-stack-text-alignment-left button-style-solid button-corner-style-square tweak-product-quick-view-button-style-floating tweak-product-quick-view-button-position-bottom tweak-product-quick-view-lightbox-excerpt-display-truncate tweak-product-quick-view-lightbox-show-arrows tweak-product-quick-view-lightbox-show-close-button tweak-product-quick-view-lightbox-controls-weight-light native-currency-code-usd view-item collection-type-blog collection-layout-default collection-5a01202be2c48324aeddc117 mobile-style-available">
    <div class="body-overlay"></div>
    <div class="sqs-announcement-bar-dropzone"></div>
    <div id="sidecarNav">
      

  <div id="mobileNavWrapper" class="nav-wrapper" data-content-field="navigation-mobileNav">
    <nav id="mobileNavigation">
      

      
        
          
          <div class="index homepage">
            <a href="/">
              Home
            </a>
          </div>
          
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about">About</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/team">
                  Our Team
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/contact">
                  Contact
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/sebastian-garcia">
                  Sebastian Garcia
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/veronica-valeros">
                  Veronica Valeros
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about-datasets">Datasets</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/datasets-ctu13">
                  CTU-13 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot23">
                  IoT-23 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hornet-network-dataset-of-geographically-placed-honeypots">
                  Hornet: Network Dataset of Geographically Placed Honeypots
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-overview">
                  Datasets Overview
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-malware">
                  Malware Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-normal">
                  Normal Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-mixed">
                  Mixed Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot">
                  Malware on IoT Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/android-mischief-dataset">
                  Android Mischief Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-faq">
                  F.A.Q.
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/stratosphere-ips">Stratosphere IPS</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/technology">
                  Technology
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-ips-for-linux">
                  Stratosphere IPS for Linux
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-testing-framework">
                  Stratosphere Testing Framework
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/download">
                  Download
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/kalipso">
                  Kalipso
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/projects">Projects</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/ai-dojo">
                  AI Dojo
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/gsoc">
                  GSoC
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/defensive-llms">
                  Defensive LLMs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/cybercrime-research">
                  Cybercrime Research
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aposemat">
                  Aposemat Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere">
                  Civilsphere
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere-aivpn">
                  Civilsphere AI-VPN
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ludus">
                  Project Ludus
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/manati">
                  ManaTI
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/nomad">
                  Nomad
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/thesis-projects">
                  Thesis Projects
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-rats">
                  A Study of RATs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-iot-malware">
                  A Study of IoT Malware
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/icarus-project">
                  Icarus Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ad-honeypot-game">
                  AD-Honeypot Evasion Game
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/the-blocklist-generation-project">
                  The Blocklist Generation Project
                </a>
              </div>
              
              
            

              
              
              <div class="external">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
            

              
              <div class="collection">
                <a href="/feel-project">
                  FEEL Project
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/tools">Tools</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/should-i-click">
                  Should I Click
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hexa-payload-decoder">
                  Hexa Payload Decoder
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-anomaly-detector">
                  Zeek Anomaly Detector
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-irc-feature-extractor">
                  Zeek IRC Feature Extractor
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aip-tool">
                  AIP Tool
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/publications-overview">
                Publications
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/job-openings">
                Open Positions
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection active">
              <a href="/blog">
                Research Blog
              </a>
            </div>
            

          
        
        

      
    </nav>
  </div>



    </div>
    <div id="siteWrapper" class="clearfix">

      <div class="sqs-cart-dropzone"></div>

      <header id="header" class="show-on-scroll" data-offset-el=".index-section" data-offset-behavior="bottom" role="banner">
        <div class="header-inner">
          <div id="logoWrapper" class="wrapper" data-content-field="site-title">
            
              <h1 id="logoImage"><a href="/"><img src="//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510077068933-2L2JCU07QZVDWC0Q7142/Logo-blue-header.png?format=1500w" alt="Stratosphere IPS" /></a></h1>
            
          </div><!--
          --><div class="mobile-nav-toggle"><div class="top-bar"></div><div class="middle-bar"></div><div class="bottom-bar"></div></div><div class="mobile-nav-toggle fixed-nav-toggle"><div class="top-bar"></div><div class="middle-bar"></div><div class="bottom-bar"></div></div><!--
          --><div id="headerNav">

  <div id="mainNavWrapper" class="nav-wrapper" data-content-field="navigation-mainNav">
    <nav id="mainNavigation" data-content-field="navigation-mainNav">
      

      
        
          
          <div class="index homepage">
            <a href="/">
              Home
            </a>
          </div>
          
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about">About</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/team">
                  Our Team
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/contact">
                  Contact
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/sebastian-garcia">
                  Sebastian Garcia
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/veronica-valeros">
                  Veronica Valeros
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about-datasets">Datasets</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/datasets-ctu13">
                  CTU-13 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot23">
                  IoT-23 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hornet-network-dataset-of-geographically-placed-honeypots">
                  Hornet: Network Dataset of Geographically Placed Honeypots
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-overview">
                  Datasets Overview
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-malware">
                  Malware Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-normal">
                  Normal Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-mixed">
                  Mixed Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot">
                  Malware on IoT Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/android-mischief-dataset">
                  Android Mischief Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-faq">
                  F.A.Q.
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/stratosphere-ips">Stratosphere IPS</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/technology">
                  Technology
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-ips-for-linux">
                  Stratosphere IPS for Linux
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-testing-framework">
                  Stratosphere Testing Framework
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/download">
                  Download
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/kalipso">
                  Kalipso
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/projects">Projects</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/ai-dojo">
                  AI Dojo
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/gsoc">
                  GSoC
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/defensive-llms">
                  Defensive LLMs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/cybercrime-research">
                  Cybercrime Research
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aposemat">
                  Aposemat Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere">
                  Civilsphere
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere-aivpn">
                  Civilsphere AI-VPN
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ludus">
                  Project Ludus
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/manati">
                  ManaTI
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/nomad">
                  Nomad
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/thesis-projects">
                  Thesis Projects
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-rats">
                  A Study of RATs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-iot-malware">
                  A Study of IoT Malware
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/icarus-project">
                  Icarus Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ad-honeypot-game">
                  AD-Honeypot Evasion Game
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/the-blocklist-generation-project">
                  The Blocklist Generation Project
                </a>
              </div>
              
              
            

              
              
              <div class="external">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
            

              
              <div class="collection">
                <a href="/feel-project">
                  FEEL Project
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/tools">Tools</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/should-i-click">
                  Should I Click
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hexa-payload-decoder">
                  Hexa Payload Decoder
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-anomaly-detector">
                  Zeek Anomaly Detector
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-irc-feature-extractor">
                  Zeek IRC Feature Extractor
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aip-tool">
                  AIP Tool
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/publications-overview">
                Publications
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/job-openings">
                Open Positions
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection active">
              <a href="/blog">
                Research Blog
              </a>
            </div>
            

          
        
        

      
    </nav>
  </div>
  <!-- style below blocks out the mobile nav toggle only when nav is loaded -->
  <style>.mobile-nav-toggle-label { display: inline-block !important; }</style>


</div>
        </div>
      </header>

      
        
          
            
              
            
          
        
      


      
      
      

      <main id="page" role="main">
        
        <!--
        --><!--
        --><div id="content" class="main-content" data-content-field="main-content" data-collection-id="5a01202be2c48324aeddc117" data-edit-main-image="">
         <div class="blog-item">

  
  <article class="entry h-entry hentry category-aposemat-project category-malware-analysis tag-malware-analysis tag-iot tag-reverse-engineering author-stratosphere-ips post-type-text clear" id="article-5edd45033a11483ae76f7e3d" data-item-id="5edd45033a11483ae76f7e3d">

    <header class="entry-header">
      <div class="meta-above-title">
        
        <div class="entry-byline">
          <span class="entry-author"><a href="/blog?author=5a010fd25e0ed880ec22749f" class="p-author author entry-byline-link" rel="author">Stratosphere IPS</a></span>
        </div>
        
        <div class="entry-dateline">
          <time class="dt-published published entry-date" datetime="2020-06-08" pubdate><a href="/blog/2020/6/8/dark-nexus-the-old-the-new-and-the-ugly" class="entry-dateline-link">June 8, 2020</a></time>
          <time class="dt-updated updated" datetime="2020-06-08"></time>
        </div>
        
        <div class="entry-morefrom">
          <span class="entry-category"><a href="/blog/category/Aposemat+Project" class="entry-morefrom-link" rel="tag">Aposemat Project</a>, <a href="/blog/category/malware+analysis" class="entry-morefrom-link" rel="tag">malware analysis</a></span>
        </div>
        
      </div>
      <h1 data-content-field="title" class="entry-title p-name">
      
        <a href="/blog/2020/6/8/dark-nexus-the-old-the-new-and-the-ugly" class="u-url" rel="bookmark">Dark Nexus: the old, the new and the ugly</a>
      
      </h1>
      <div class="meta-below-title ">
        
        <div class="entry-byline">
          <span class="entry-author"><a href="/blog?author=5a010fd25e0ed880ec22749f" class="p-author author entry-byline-link" rel="author">Stratosphere IPS</a></span>
        </div>
        
        <div class="entry-dateline">
          <time class="dt-published published entry-date" datetime="2020-06-08" pubdate><a href="/blog/2020/6/8/dark-nexus-the-old-the-new-and-the-ugly" class="entry-dateline-link">June 8, 2020</a></time>
          <time class="dt-updated updated" datetime="2020-06-08"></time>
        </div>
        
        <div class="entry-morefrom">
          <span class="entry-category"><a href="/blog/category/Aposemat+Project" class="entry-morefrom-link" rel="tag">Aposemat Project</a>, <a href="/blog/category/malware+analysis" class="entry-morefrom-link" rel="tag">malware analysis</a></span>
        </div>
        
      </div>
    </header>

    <div class="entry-content e-content">
      
        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1591561937650" id="item-5edd45033a11483ae76f7e3d"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-65ead48e5b5451a7c7ba"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">In this blog post we will focus on an ARM7 Dark Nexus sample [1] and version <strong>v5</strong> of this malware to highlight its functionality, both old and new, and to explore more invasive (or <em>ugly</em>) and innovative techniques. This sample was statically linked but not stripped making it easy to reverse and analyze.</p><p class="" style="white-space:pre-wrap;">Dark Nexus is an IoT botnet found by Bitdefender at the end of 2019 and beginning of 2020  [2]. According to their findings, this botnet had approximately 1,300 bots and was very prominent in Asia. Along with a white paper the company also released a list of 327 sample hashes related to this bot [3]. From this list, 231 sample files were actually found on Virus Total, showing these binary architectures:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_26961"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1295px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:59.536678314208984%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560195244-Q75OZ1QD7ULXEN3VWM15/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560195244-Q75OZ1QD7ULXEN3VWM15/image.png" data-image-dimensions="1295x771" data-image-focal-point="0.5,0.5" alt="image.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560195244-Q75OZ1QD7ULXEN3VWM15/image.png" width="1295" height="771" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560195244-Q75OZ1QD7ULXEN3VWM15/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560195244-Q75OZ1QD7ULXEN3VWM15/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560195244-Q75OZ1QD7ULXEN3VWM15/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560195244-Q75OZ1QD7ULXEN3VWM15/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560195244-Q75OZ1QD7ULXEN3VWM15/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560195244-Q75OZ1QD7ULXEN3VWM15/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560195244-Q75OZ1QD7ULXEN3VWM15/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1591559403592_30957"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="white-space:pre-wrap;">The Old</h1><p class="" style="white-space:pre-wrap;">Part of its code was based in Mirai. By comparing this unstripped sample to the codebase of Mirai we can see what was reused:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">static ipv4_t <strong>get_random_ip</strong>(void)</p></li><li><p class="" style="white-space:pre-wrap;">void <strong>attack_udp_plain</strong>(uint8_t targs_len, struct attack_target *targs, uint8_t opts_len, struct attack_option *opts)</p></li><li><p class="" style="white-space:pre-wrap;">BOOL <strong>killer_kill_by_port</strong>(port_t port)</p></li><li><p class="" style="white-space:pre-wrap;">uint16_t <strong>checksum_generic</strong>(uint16_t *addr, uint32_t count)</p></li><li><p class="" style="white-space:pre-wrap;">uint16_t <strong>checksum_tcpudp</strong>(struct iphdr *iph, void *buff, uint16_t data_len, int len)</p></li><li><p class="" style="white-space:pre-wrap;">void <strong>resolv_entries_free</strong>(struct resolv_entries *entries)</p></li><li><p class="" style="white-space:pre-wrap;">struct resolv_entries *<strong>resolv_lookup</strong>(char *domain)</p></li></ul><p class="" style="white-space:pre-wrap;">These functions were scrapped verbatim from the original Mirai source code and the matches have been found by comparing the function symbols from both the source code and the binary sample. Other functions (eg. <strong>rand_port, retrieve_c2_server </strong>or <strong>attack_tcp_raw</strong>) are based on original Mirai functions but modified to fit the necessities of the author.</p><p class="" style="white-space:pre-wrap;">The downside of reusing Mirai’s codebase is that some of the favorable aspects of its code are often ignored. That’s the case of the encrypted data table. This table is the one in charge of converting encrypted or obfuscated strings and data to its normal state, be it integers or strings. Dark Nexus on the other hand shows passwords, usernames, command-and-control endpoints, etc. are in plain-text or deobfuscated. For example, the function <strong>retrieve_c2_server</strong> (Mirai’s <strong>retireve_cnc_addr</strong>) was adapted to resolve more than one C&amp;C address. These addresses are in plain-text in the main function of the bot (Figure 1).</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_33254"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:321px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:25.5451717376709%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560322375-IAVXHTR8HPNBFKI1KA9D/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560322375-IAVXHTR8HPNBFKI1KA9D/image.png" data-image-dimensions="321x82" data-image-focal-point="0.5,0.5" alt="Figure 1. Hardcoded C&amp;amp;C list populated to later be used by the bot." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560322375-IAVXHTR8HPNBFKI1KA9D/image.png" width="321" height="82" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560322375-IAVXHTR8HPNBFKI1KA9D/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560322375-IAVXHTR8HPNBFKI1KA9D/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560322375-IAVXHTR8HPNBFKI1KA9D/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560322375-IAVXHTR8HPNBFKI1KA9D/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560322375-IAVXHTR8HPNBFKI1KA9D/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560322375-IAVXHTR8HPNBFKI1KA9D/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560322375-IAVXHTR8HPNBFKI1KA9D/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class=""><strong>Figure 1. </strong>Hardcoded C&amp;C list populated to later be used by the bot.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1591559403592_40955"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Another old method still used by this malware and many others is the Telnet brute forcing as a method of growing its botnet. Insecure Telnet services are nothing new among IoT malware and attacking them keeps being effective nowadays as devices with weak credentials are accessible from the internet. Dark Nexus does this by calling <strong>spreader_init</strong> to populate its username/password structures and&nbsp; then <strong>init_syn_bruter</strong>. The latest will start the attack against telnet services across the Internet and try to infect as many devices as possible under these CPU architectures:</p><ol data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">arm</p></li><li><p class="" style="white-space:pre-wrap;">rce</p></li><li><p class="" style="white-space:pre-wrap;">sh4</p></li><li><p class="" style="white-space:pre-wrap;">arc</p></li><li><p class="" style="white-space:pre-wrap;">ppc</p></li><li><p class="" style="white-space:pre-wrap;">mk68</p></li><li><p class="" style="white-space:pre-wrap;">spc</p></li><li><p class="" style="white-space:pre-wrap;">x86</p></li><li><p class="" style="white-space:pre-wrap;">i586</p></li><li><p class="" style="white-space:pre-wrap;">mpsl / mips</p></li></ol>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_41479"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:458px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:21.397380828857422%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560455106-KJ5NC8OJBBCYS2TSZSPN/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560455106-KJ5NC8OJBBCYS2TSZSPN/image.png" data-image-dimensions="458x98" data-image-focal-point="0.5,0.5" alt="Figure 2. Hardcoded domain name and IP address in init_syn_bruter function." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560455106-KJ5NC8OJBBCYS2TSZSPN/image.png" width="458" height="98" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560455106-KJ5NC8OJBBCYS2TSZSPN/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560455106-KJ5NC8OJBBCYS2TSZSPN/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560455106-KJ5NC8OJBBCYS2TSZSPN/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560455106-KJ5NC8OJBBCYS2TSZSPN/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560455106-KJ5NC8OJBBCYS2TSZSPN/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560455106-KJ5NC8OJBBCYS2TSZSPN/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560455106-KJ5NC8OJBBCYS2TSZSPN/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class=""><strong>Figure 2.</strong> Hardcoded domain name and IP address in <strong>init_syn_bruter</strong> function.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_45803"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:401px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:184.28927612304688%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560488665-E77NXKDWW4ECJN7NGAF0/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560488665-E77NXKDWW4ECJN7NGAF0/image.png" data-image-dimensions="401x739" data-image-focal-point="0.5,0.5" alt="Figure 3. The malware spreads on multiple architectures to have a wider range of infection." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560488665-E77NXKDWW4ECJN7NGAF0/image.png" width="401" height="739" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560488665-E77NXKDWW4ECJN7NGAF0/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560488665-E77NXKDWW4ECJN7NGAF0/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560488665-E77NXKDWW4ECJN7NGAF0/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560488665-E77NXKDWW4ECJN7NGAF0/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560488665-E77NXKDWW4ECJN7NGAF0/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560488665-E77NXKDWW4ECJN7NGAF0/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560488665-E77NXKDWW4ECJN7NGAF0/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class=""><strong>Figure 3. </strong>The malware spreads on multiple architectures to have a wider range of infection.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1591559403592_51701"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="white-space:pre-wrap;">The New</h1><p class="" style="white-space:pre-wrap;">Dark Nexus presents new techniques as well. Here we are going to mention two that we consider interesting to show and describe: Reverse Proxy and Killer functions. These functions were already seen on other malware but have a twist that’s worth mentioning.</p><h2 style="white-space:pre-wrap;">Reverse Proxy</h2><p class="" style="white-space:pre-wrap;">One technique employed by this malware is reverse proxying requests to always be able to deliver malware to new infections. It does this by first identifying <em>who</em> executed the malware, saving the IP and port addresses from the command line used during the execution (Figure 4). After this, the function <strong>init_reverse_proxy</strong>. This function is one improvement to common IoT malware, giving autonomy and self reliance to its bots. It starts by forking and connecting to its C&amp;C servers to download the multiple binaries that belong to each supported architecture. If the malware wasn’t able to connect to any C&amp;C server it will reach out to the IP and port registered during execution (Figure 4) to perform that action. After arming itself with multiple bot variants, it will listen to a random port for GET requests to serve its binaries, acting as a pseudo-HTTP server (Figure 5).</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_56001"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:613px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:37.35725784301758%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560686821-9R8M3JX6WJUTJUU20M6C/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560686821-9R8M3JX6WJUTJUU20M6C/image.png" data-image-dimensions="613x229" data-image-focal-point="0.5,0.5" alt="Figure 4. IP and port reported by the bot that infected and ran the malware sample. This will later be used as a replacement for it’s C&amp;amp;Cs if needed." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560686821-9R8M3JX6WJUTJUU20M6C/image.png" width="613" height="229" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560686821-9R8M3JX6WJUTJUU20M6C/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560686821-9R8M3JX6WJUTJUU20M6C/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560686821-9R8M3JX6WJUTJUU20M6C/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560686821-9R8M3JX6WJUTJUU20M6C/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560686821-9R8M3JX6WJUTJUU20M6C/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560686821-9R8M3JX6WJUTJUU20M6C/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560686821-9R8M3JX6WJUTJUU20M6C/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class=""><strong>Figure 4.</strong> IP and port reported by the bot that infected and ran the malware sample. This will later be used as a replacement for it’s C&amp;Cs if needed.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_52274"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:448px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:18.973215103149414%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560644214-L64UOA6I43E52N6OFPNA/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560644214-L64UOA6I43E52N6OFPNA/image.png" data-image-dimensions="448x85" data-image-focal-point="0.5,0.5" alt="Figure 5. User-Agent used by the malware is: hoho_fastflux/v5. The string “hoho” is commonly used throughout this malware." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560644214-L64UOA6I43E52N6OFPNA/image.png" width="448" height="85" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560644214-L64UOA6I43E52N6OFPNA/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560644214-L64UOA6I43E52N6OFPNA/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560644214-L64UOA6I43E52N6OFPNA/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560644214-L64UOA6I43E52N6OFPNA/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560644214-L64UOA6I43E52N6OFPNA/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560644214-L64UOA6I43E52N6OFPNA/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560644214-L64UOA6I43E52N6OFPNA/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class=""><strong>Figure 5. </strong>User-Agent used by the malware is: <strong>hoho_fastflux/v5</strong>. The string “hoho” is commonly used throughout this malware.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1591559403592_60081"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h2 style="white-space:pre-wrap;">Killer</h2><p class="" style="white-space:pre-wrap;">The idea of a <em>killer</em> comes straight from its Mirai codebase. The purpose of the killer is to block ports utilized by services like SSH and Telnet to avoid further invasion by other malware or clients. Also, it kills any previous invasion in order to do a full takeover of the device.</p><p class="" style="white-space:pre-wrap;">The killer process is initialized by Dark Nexus by the <strong>killer</strong> function by forking into another process while saving its own process ID (PID) ina variable called <strong>lockdown_pid</strong>, which will be discussed later. After that it will create an structure called <strong>suspect_list</strong> that will keep track of the processes being analyzed and <em>judged</em> by the malware (Figure 6). This structure is based on the PID of the analyzed process in the device and a “weight” which is an attribute that will define if the process is a threat to the bot and needs to be terminated. The The function <strong>killer_run</strong> is then called and it will read all the process IDs from the <em>/proc</em> directory and weight the threat of the current process (<strong><em>PID</em></strong>) being analyzed by:</p><p class="" style="white-space:pre-wrap;">1) Reading <em>/proc/</em><strong><em>PID</em></strong><em>/exec</em> and check if the executable of the process exists on the filesystem. If it was deleted and appears as "(deleted)" then add +100 of weight</p><p class="" style="white-space:pre-wrap;">2) Check <em>/proc/</em><strong><em>PID</em></strong><em>/exec</em> real path by using the <strong>readlink </strong>function. If binary is running in one of these paths to kill then add +90 of weight:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">/tmp/</p></li><li><p class="" style="white-space:pre-wrap;">/var/</p></li><li><p class="" style="white-space:pre-wrap;">/dev//var/tmp/</p></li><li><p class="" style="white-space:pre-wrap;">/var/run/</p></li><li><p class="" style="white-space:pre-wrap;">/</p></li></ul><p class="" style="white-space:pre-wrap;">The paths to kill list is hardcoded in the binary.<br>3) Open the directory <em>/proc/</em><strong><em>PID</em></strong><em>/fd</em> to read list of open files. If the list is greater than 250 then add +10 weight.</p><p class="" style="white-space:pre-wrap;">4) Open <em>/proc/</em><strong><em>PID</em></strong><em>/cmdline</em> to read the command line of the process. If starts with "./" it will add +10 weight.</p><p class="" style="white-space:pre-wrap;">5) Open <em>/proc/</em><strong><em>PID</em></strong><em>/status</em> and check if it has the string "Groups:\t0". It will add +50 weight if it does.</p><p class="" style="white-space:pre-wrap;">6) Open the process’ binary in <em>/proc/</em><strong><em>PID</em></strong><em>/exe</em> and read its strings. If ".dynamic" was not found meaning that is a possible static binary then add +50 weight. If the string "UPX" is found then add +90 weight, as it is possible that the binary was also packed.</p><p class="" style="white-space:pre-wrap;">At the end of this process the malware will check the suspects list and, if the weight is above 99 points it will kill the process as it imposes a threat to the bot (Figure 7).</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_60796"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:547px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:45.1553955078125%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560807139-73HJ7I3ZLIW1KZOMWXMH/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560807139-73HJ7I3ZLIW1KZOMWXMH/image.png" data-image-dimensions="547x247" data-image-focal-point="0.5,0.5" alt="Figure 6. Function (and process) killer is initialized along with the structure in charge of keeping track of the processes being analyzed." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560807139-73HJ7I3ZLIW1KZOMWXMH/image.png" width="547" height="247" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560807139-73HJ7I3ZLIW1KZOMWXMH/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560807139-73HJ7I3ZLIW1KZOMWXMH/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560807139-73HJ7I3ZLIW1KZOMWXMH/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560807139-73HJ7I3ZLIW1KZOMWXMH/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560807139-73HJ7I3ZLIW1KZOMWXMH/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560807139-73HJ7I3ZLIW1KZOMWXMH/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560807139-73HJ7I3ZLIW1KZOMWXMH/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class=""><strong>Figure 6. </strong>Function (and process) <strong>killer</strong> is initialized along with the structure in charge of keeping track of the processes being analyzed.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_64771"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:674px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:31.30563735961914%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560846017-WDPMFMSFQZCV8ZJHERH3/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560846017-WDPMFMSFQZCV8ZJHERH3/image.png" data-image-dimensions="674x211" data-image-focal-point="0.5,0.5" alt="Figure 7. Bot recursively checks all the processes’ weight and calls kill() to terminate whoever it finds threatening for its functioning." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560846017-WDPMFMSFQZCV8ZJHERH3/image.png" width="674" height="211" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560846017-WDPMFMSFQZCV8ZJHERH3/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560846017-WDPMFMSFQZCV8ZJHERH3/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560846017-WDPMFMSFQZCV8ZJHERH3/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560846017-WDPMFMSFQZCV8ZJHERH3/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560846017-WDPMFMSFQZCV8ZJHERH3/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560846017-WDPMFMSFQZCV8ZJHERH3/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591560846017-WDPMFMSFQZCV8ZJHERH3/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class=""><strong>Figure 7.</strong> Bot recursively checks all the processes’ weight and calls <strong>kill()</strong> to terminate whoever it finds threatening for its functioning.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1591559403592_68667"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="white-space:pre-wrap;">The Ugly</h1><p class="" style="white-space:pre-wrap;">The final purpose of an IoT malware is the complete take over of the device and to persist without intervention. Or <em>digital</em> intervention at least, as you can always just pull the plug in most of the cases. Dark Nexus has a set of functions that ensure that no intervention is made in order to stop the bot from doing its botmaster’s work.</p><h2 style="white-space:pre-wrap;">Persistence</h2><p class="" style="white-space:pre-wrap;">In case of the persistence, Dark Nexus chooses to disable all ways for an intruder or legitimate user to reestablish the device normal behaviour by limiting execution of system commands (Figure 8). It does this by changing the file permissions to <strong>0</strong>, thus removing the read and execute permissions to avoid them being utilized (Figure 9).</p><p class="" style="white-space:pre-wrap;">The bot will also flush the iptables (firewall) rules and stop the “crond” daemon, the one in charge of execute scheduled commands on the system. To ensure its correct functioning when scanning for victims, and also reading process IDs during the killer function, the bot will set the limit of open file descriptors to 0x1000 (or 4096 in decimal numbers).</p>
</div>






















</div></div><div class="row sqs-row"><div class="col sqs-col-6 span-6"><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_69217"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:308px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:75.9740219116211%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561041284-P7J2OZF13FZCM2CR4NOF/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561041284-P7J2OZF13FZCM2CR4NOF/image.png" data-image-dimensions="308x234" data-image-focal-point="0.5,0.5" alt="Figure 8. Methods used by the bot to impede the system from being restored." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561041284-P7J2OZF13FZCM2CR4NOF/image.png" width="308" height="234" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 50vw, 50vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561041284-P7J2OZF13FZCM2CR4NOF/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561041284-P7J2OZF13FZCM2CR4NOF/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561041284-P7J2OZF13FZCM2CR4NOF/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561041284-P7J2OZF13FZCM2CR4NOF/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561041284-P7J2OZF13FZCM2CR4NOF/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561041284-P7J2OZF13FZCM2CR4NOF/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561041284-P7J2OZF13FZCM2CR4NOF/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class=""><strong>Figure 8.</strong> Methods used by the bot to impede the system from being restored.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div></div><div class="col sqs-col-6 span-6"><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_73134"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:226px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:21.238937377929688%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561085455-NF4PZIF1F5USKJ4JB5LQ/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561085455-NF4PZIF1F5USKJ4JB5LQ/image.png" data-image-dimensions="226x48" data-image-focal-point="0.5,0.5" alt="Figure 9. The bot removes all permissions on specific executables so no restoration of the device is possible." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561085455-NF4PZIF1F5USKJ4JB5LQ/image.png" width="226" height="48" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 50vw, 50vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561085455-NF4PZIF1F5USKJ4JB5LQ/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561085455-NF4PZIF1F5USKJ4JB5LQ/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561085455-NF4PZIF1F5USKJ4JB5LQ/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561085455-NF4PZIF1F5USKJ4JB5LQ/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561085455-NF4PZIF1F5USKJ4JB5LQ/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561085455-NF4PZIF1F5USKJ4JB5LQ/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561085455-NF4PZIF1F5USKJ4JB5LQ/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class=""><strong>Figure 9. </strong>The bot removes all permissions on specific executables so no restoration of the device is possible.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div></div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1591559403592_89975"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">One interesting side note on this section is that, in the case of BusyBox [4], all those binaries are symbolic links to <strong>/bin/busybox</strong>. Meaning that if the bot changes the permissions of any of those binaries it will be ultimately changing the permissions of the latter. If that happens the whole system renders useless.</p><h2 style="white-space:pre-wrap;">Lockdown</h2><p class="" style="white-space:pre-wrap;">Dark Nexus performs a lockdown of the devices and ensures that it stays that way during its execution. Lockdown is performed after the persistence procedure is in place to add an extra layer of control over the device. This lockdown phase starts with the <strong>init_lockdown</strong> function that counts the amount of PIDs currently existing in the device and then saves those PIDs into a list called <strong>lockdown_pidlist</strong>. After the bot starts its normal execution and every 2 seconds the function <strong>ensure_lockdown</strong> is called.</p><p class="" style="white-space:pre-wrap;">The <strong>ensure_lockdown </strong>function is the one in charge of killing any new process being created after the bot was executed. What it will do is to open the directory <em>/proc</em> and read the existent PIDs, and kill those PIDs that match this criteria (Figure 10):</p><ol data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">Is not one of the attack processes.</p></li><li><p class="" style="white-space:pre-wrap;">Is not the process ID of one of these processes: bot, lockdown, scanner and reverse proxy.</p></li><li><p class="" style="white-space:pre-wrap;">PID is greater than 799.</p></li></ol>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1591559403592_91748"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:643px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:72.4727783203125%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561263097-Y00E7GPB8PFXBET1WUUD/image.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561263097-Y00E7GPB8PFXBET1WUUD/image.png" data-image-dimensions="643x466" data-image-focal-point="0.5,0.5" alt="Figure 10. Main part of the lockdown process. This ensures no intruder or legitimate process is started as it gets killed if is not present in the lockdown PID list." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561263097-Y00E7GPB8PFXBET1WUUD/image.png" width="643" height="466" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561263097-Y00E7GPB8PFXBET1WUUD/image.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561263097-Y00E7GPB8PFXBET1WUUD/image.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561263097-Y00E7GPB8PFXBET1WUUD/image.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561263097-Y00E7GPB8PFXBET1WUUD/image.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561263097-Y00E7GPB8PFXBET1WUUD/image.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561263097-Y00E7GPB8PFXBET1WUUD/image.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1591561263097-Y00E7GPB8PFXBET1WUUD/image.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class=""><strong>Figure 10.</strong> Main part of the lockdown process. This ensures no intruder or legitimate process is started as it gets killed if is not present in the lockdown PID list.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1591559403592_97348"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="white-space:pre-wrap;">Conclusion</h1><p class="" style="white-space:pre-wrap;">In this blog post we were able to take a sneak peek of what is Dark Nexus capable of and its details. We explored this by presenting it via three characteristics we named <em>the old, the new and the ugly</em>. In <em>The Old</em> we showed how this malware imported a great deal of ideas and code from a well-known IoT malware: Mirai. This is done regularly as Mirai source code was made public since 2016 and its well structured, and easy to modify, code is the perfect fit for any new malware. A good side of this is that it makes the malware easy to identify as well as to analyze.</p><p class="" style="white-space:pre-wrap;">On the other hand, in <em>The New</em> we presented new ideas that were adapted to work with this “old” code. Ideas like the reverse proxy that enables the bot to be more independent from it’s C&amp;C or distribution endpoints. Or the killer function which evolved from it’s more primitive variant seen in Mirai to a more intuitive one, analyzing and judging the processes being executed in the device by its characteristics.</p><p class="" style="white-space:pre-wrap;">Finally, we present two functions that are of a questionable nature in <em>The Ugly</em>. These procedures, like persistence and lockdown, turn the device being infected into a “brick”, inaccessible and unrecoverable from the outside world. And a device that cannot be accessed is a device that cannot be fixed.</p><p class="" style="white-space:pre-wrap;">All these characteristics show that IoT malware is improving while retaining its roots, and Dark Nexus is the clear sign of this.</p><h2 style="white-space:pre-wrap;">References</h2><p class="" style="white-space:pre-wrap;">[1] VirusTotal (2020, April 09). <strong><em>bc0457d7935e29aecb338756bde213cd18aa1b617b00d30c4deedd5eef9ba877</em></strong>. <a href="https://www.virustotal.com/gui/file/bc0457d7935e29aecb338756bde213cd18aa1b617b00d30c4deedd5eef9ba877/details">https://www.virustotal.com/gui/file/bc0457d7935e29aecb338756bde213cd18aa1b617b00d30c4deedd5eef9ba877/details</a> <br>[2] Liviu Arsene, Bitdefender (2020, April 08). <strong><em>New dark_nexus IoT Botnet Puts Others to Shame</em></strong>. <a href="https://labs.bitdefender.com/2020/04/new-dark_nexus-iot-botnet-puts-others-to-shame/￼[3]">https://labs.bitdefender.com/2020/04/new-dark_nexus-iot-botnet-puts-others-to-shame/<br></a>[3] Bitdefender Investigations and Forensics Unit, Bitdefender (2020). <strong><em>New dark_nexus IoT Botnet Puts Others to Shame (Whitepaper)</em></strong>. <a href="https://www.bitdefender.com/files/News/CaseStudies/study/319/Bitdefender-PR-Whitepaper-DarkNexus-creat4349-en-EN-interactive.pdf">https://www.bitdefender.com/files/News/CaseStudies/study/319/Bitdefender-PR-Whitepaper-DarkNexus-creat4349-en-EN-interactive.pdf</a> <br>[4] Denys Vlasenko. <strong><em>BusyBox: The Swiss Army Knife of Embedded Linux</em></strong>. <a href="https://busybox.net/">https://busybox.net/</a> <br>[5] jgamblin, GitHub (2020, October 23). <strong><em>Mirai-Source-Code</em></strong>. <a href="https://github.com/jgamblin/Mirai-Source-Code">https://github.com/jgamblin/Mirai-Source-Code</a> </p>
</div>






















</div></div></div></div></div>
      
    </div>

    <footer class="entry-footer clear">
      
      
      <p class="entry-tags">
        Tagged: <a href="/blog/tag/malware+analysis" rel="tag">malware analysis</a>, <a href="/blog/tag/iot" rel="tag">iot</a>, <a href="/blog/tag/reverse+engineering" rel="tag">reverse engineering</a>
      </p>
      
      <div class="entry-actions">
        
  <span class="sqs-simple-like" data-item-id="5edd45033a11483ae76f7e3d" data-like-count="4">
    <span class="like-icon"></span>
    <span class="like-count"></span>
  </span>
<span class="squarespace-social-buttons inline-style" data-system-data-id="" data-asset-url="https://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/5edd45033a11483ae76f7e3d/1591626627138/" data-record-type="1" data-full-url="/blog/2020/6/8/dark-nexus-the-old-the-new-and-the-ugly" data-title="Dark Nexus: the old, the new and the ugly"></span>
      </div>
    </footer>

    

  </article>

  <div id="comments-5edd45033a11483ae76f7e3d" class="p-comment">
    
  <div class="squarespace-comments" id="comments-5edd45033a11483ae76f7e3d" data-item-id="5edd45033a11483ae76f7e3d" data-public-comment-count="0" data-comment-state="1"></div>

  </div>

  

  
  <nav class="pagination clear">
    <div class="newer"><span class="prev-label">Newer Post</span><a href="/blog/2020/8/12/machine-learning-leaks-and-where-to-find-them" rel="prev"><span>Machine Learning Leaks and Where to Find Them</span></a></div><!-- comment the linebreak between these two elements because science
  --><div class="older"><span class="next-label">Older Post</span><a href="/blog/2020/5/5/cybersec-and-ai-connected-workshops" rel="next"><span>CYBERSEC &amp; AI Connected Workshops: Call for Presentations</span></a></div>
  </nav>
  

</div>
        </div><!--
        --><aside id="rightSidebar" role="complementary">
          <div class="sqs-layout sqs-grid-12 columns-12 open-block-field empty" data-layout-label="Blog Sidebar Content" data-type="block-field" id="blogBlocks-5a01202be2c48324aeddc117"><div class="row sqs-row"><div class="col sqs-col-12 span-12"></div></div></div>
        </aside>
        
        
      </main>

      <div id="preFooter">
        <div class="pre-footer-inner">
          <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Pre-Footer Content" data-type="block-field" data-updated-on="1510062674452" id="preFooterBlocks"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1410979096848_3228"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 class="text-align-center">Protecting the civil society through high quality research</h1>
</div>






















</div></div></div></div></div>
        </div>
      </div>

      <footer id="footer" role="contentinfo">
        <div class="footer-inner">
          <div class="nav-wrapper back-to-top-nav"><nav><div class="back-to-top"><a href="#header">Back to Top</a></div></nav></div>
          


          <div id="siteInfo"><span class="site-address">Karlovo náměstí, Praha, Czech Republic</span><a href="mailto:stratosphere@aic.fel.cvut.cz" class="site-email"><span>stratosphere@aic.fel.cvut.cz</span></a></div>
          <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Footer Content" data-type="block-field" data-updated-on="1531498156355" id="footerBlocks"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block socialaccountlinks-v2-block sqs-block-socialaccountlinks-v2" data-block-type="54" id="block-yui_3_17_2_4_1519219355521_4463"><div class="sqs-block-content">



<div class="sqs-svg-icon--outer social-icon-alignment-center social-icons-color-white social-icons-size-extra-large social-icons-style-regular " >
  <style>
    #block-yui_3_17_2_4_1519219355521_4463 .social-icons-style-border .sqs-svg-icon--wrapper {
      
        box-shadow: 0 0 0 2px inset;
      
      border: none; 
    }
  </style>
  <nav class="sqs-svg-icon--list">
    <a href="https://twitter.com/StratosphereIPS" target="_blank" class="sqs-svg-icon--wrapper twitter-unauth" aria-label="Twitter">
      <div>
        <svg class="sqs-svg-icon--social" viewBox="0 0 64 64">
          <use class="sqs-use--icon" xlink:href="#twitter-unauth-icon"></use>
          <use class="sqs-use--mask" xlink:href="#twitter-unauth-mask"></use>
        </svg>
      </div>
    </a>
  </nav>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-713fe491a2c303b33937"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="text-align-center">Powered by <a target="_blank" href="http://www.squarespace.com?channel=word_of_mouth&amp;subchannel=customer&amp;source=footer&amp;campaign=4fd1028ee4b02be53c65dfb3">Squarespace</a></p>
</div>






















</div></div></div></div></div>
        </div>
      </footer>

    </div>

    <script defer="true" src="https://static1.squarespace.com/static/ta/52a74d9ae4b0253945d2aee9/1053/scripts/site-bundle.js" type="text/javascript"></script>
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="display:none" data-usage="social-icons-svg"><symbol id="twitter-unauth-icon" viewBox="0 0 64 64"><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"/></symbol><symbol id="twitter-unauth-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M44.7,25.5c0,0.3,0,0.6,0,0.8C44.7,35,38.1,45,26.1,45c-3.7,0-7.2-1.1-10.1-2.9 c0.5,0.1,1,0.1,1.6,0.1c3.1,0,5.9-1,8.2-2.8c-2.9-0.1-5.3-2-6.1-4.6c0.4,0.1,0.8,0.1,1.2,0.1c0.6,0,1.2-0.1,1.7-0.2 c-3-0.6-5.3-3.3-5.3-6.4c0,0,0-0.1,0-0.1c0.9,0.5,1.9,0.8,3,0.8c-1.8-1.2-2.9-3.2-2.9-5.5c0-1.2,0.3-2.3,0.9-3.3 c3.2,4,8.1,6.6,13.5,6.9c-0.1-0.5-0.2-1-0.2-1.5c0-3.6,2.9-6.6,6.6-6.6c1.9,0,3.6,0.8,4.8,2.1c1.5-0.3,2.9-0.8,4.2-1.6 c-0.5,1.5-1.5,2.8-2.9,3.6c1.3-0.2,2.6-0.5,3.8-1C47.1,23.4,46,24.5,44.7,25.5z"/></symbol></svg>

  </body>
</html>
