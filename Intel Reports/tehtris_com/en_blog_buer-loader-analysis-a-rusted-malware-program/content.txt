<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="preconnect" href="//www.google-analytics.com" />
<link rel="preconnect" href="//www.googletagmanager.com" />
<link rel="preconnect" href="//static.axept.io" />
<link rel="preconnect" href="//client.axept.io" />
<link rel="preconnect" href="//apis.google.com" />
<link rel="preconnect" href="//www.gartner.com" />
<link rel="preconnect" href="//static.hotjar.com" />
<link rel="preconnect" href="//linkedin.com" />
<link rel="alternate" href="https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/" hreflang="en" />
<link rel="alternate" href="https://tehtris.com/fr/blog/analyse-malware-buer-loader/" hreflang="fr" />

	<!-- This site is optimized with the Yoast SEO plugin v24.7 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Buer Loader Analysis, a Rusted malware program - TEHTRIS</title>
	<link rel="canonical" href="https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:locale:alternate" content="fr_FR" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Buer Loader Analysis, a Rusted malware program - TEHTRIS" />
	<meta property="og:description" content="Malware analysis is part of the CTI team&#8217;s daily routine. This article presents the analysis of a Rust strain of Buer Loader from the reception of the samples to the writing of a stage2* extraction script. Despite several protection mechanisms, it was possible to extract all the samples in different ways. TEHTRIS provides the code [&hellip;]" />
	<meta property="og:url" content="https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/" />
	<meta property="og:site_name" content="TEHTRIS" />
	<meta property="article:published_time" content="2022-01-20T08:00:00+00:00" />
	<meta property="article:modified_time" content="2023-06-06T10:18:24+00:00" />
	<meta property="og:image" content="https://tehtris.com/wp-content/uploads/2022/01/COVER-ARTICLES-BUER-EN.jpg" />
	<meta property="og:image:width" content="1200" />
	<meta property="og:image:height" content="630" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Laurent Oudot" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:image" content="https://tehtris.com/wp-content/uploads/2022/01/COVER-ARTICLES-BUER-EN.jpg" />
	<meta name="twitter:creator" content="@tehtris" />
	<meta name="twitter:site" content="@tehtris" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Laurent Oudot" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="11 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/","url":"https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/","name":"Buer Loader Analysis, a Rusted malware program - TEHTRIS","isPartOf":{"@id":"https://tehtris.com/en/#website"},"primaryImageOfPage":{"@id":"https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/#primaryimage"},"image":{"@id":"https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/#primaryimage"},"thumbnailUrl":"https://tehtris.com/wp-content/uploads/2022/01/COVER-ARTICLES-BUER-GEN.jpg","datePublished":"2022-01-20T08:00:00+00:00","dateModified":"2023-06-06T10:18:24+00:00","author":{"@id":"https://tehtris.com/en/#/schema/person/ac467449c37a50545ccfa49613abdca5"},"breadcrumb":{"@id":"https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/#primaryimage","url":"https://tehtris.com/wp-content/uploads/2022/01/COVER-ARTICLES-BUER-GEN.jpg","contentUrl":"https://tehtris.com/wp-content/uploads/2022/01/COVER-ARTICLES-BUER-GEN.jpg","width":1200,"height":630},{"@type":"BreadcrumbList","@id":"https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Accueil","item":"https://tehtris.com/en/"},{"@type":"ListItem","position":2,"name":"Blog [EN]","item":"https://tehtris.com/en/blog/"},{"@type":"ListItem","position":3,"name":"Buer Loader Analysis, a Rusted malware program"}]},{"@type":"WebSite","@id":"https://tehtris.com/en/#website","url":"https://tehtris.com/en/","name":"TEHTRIS","description":"FACE THE UNPREDICTABLE","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://tehtris.com/en/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Person","@id":"https://tehtris.com/en/#/schema/person/ac467449c37a50545ccfa49613abdca5","name":"Laurent Oudot"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='stylesheet' id='ugb-style-css-css' href='https://tehtris.com/wp-content/plugins/stackable-ultimate-gutenberg-blocks/dist/frontend_blocks.css?ver=3.14.2' media='all' />
<style id='ugb-style-css-inline-css'>
#start-resizable-editor-section{display:none}@media only screen and (min-width:1280px){:where(.has-text-align-left) .stk-block-divider{--stk-dots-margin-left:0;--stk-dots-margin-right:auto}:where(.has-text-align-right) .stk-block-divider{--stk-dots-margin-right:0;--stk-dots-margin-left:auto}:where(.has-text-align-center) .stk-block-divider{--stk-dots-margin-right:auto;--stk-dots-margin-left:auto}.stk-block.stk-block-divider.has-text-align-center{--stk-dots-margin-right:auto;--stk-dots-margin-left:auto}.stk-block.stk-block-divider.has-text-align-right{--stk-dots-margin-right:0;--stk-dots-margin-left:auto}.stk-block.stk-block-divider.has-text-align-left{--stk-dots-margin-left:0;--stk-dots-margin-right:auto}.stk-block-feature>*>.stk-row{flex-wrap:var(--stk-feature-flex-wrap,nowrap)}.stk-row{flex-wrap:nowrap}.stk--hide-desktop,.stk--hide-desktop.stk-block{display:none!important}}@media only screen and (min-width:781px){:where(body:not(.wp-admin) .stk-block-column:first-child:nth-last-child(2)){flex:1 1 calc(50% - var(--stk-column-gap, 0px)*1/2)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(2):last-child){flex:1 1 calc(50% - var(--stk-column-gap, 0px)*1/2)!important}:where(body:not(.wp-admin) .stk-block-column:first-child:nth-last-child(3)){flex:1 1 calc(33.33333% - var(--stk-column-gap, 0px)*2/3)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(2):nth-last-child(2)){flex:1 1 calc(33.33333% - var(--stk-column-gap, 0px)*2/3)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(3):last-child){flex:1 1 calc(33.33333% - var(--stk-column-gap, 0px)*2/3)!important}:where(body:not(.wp-admin) .stk-block-column:first-child:nth-last-child(4)){flex:1 1 calc(25% - var(--stk-column-gap, 0px)*3/4)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(2):nth-last-child(3)){flex:1 1 calc(25% - var(--stk-column-gap, 0px)*3/4)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(3):nth-last-child(2)){flex:1 1 calc(25% - var(--stk-column-gap, 0px)*3/4)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(4):last-child){flex:1 1 calc(25% - var(--stk-column-gap, 0px)*3/4)!important}:where(body:not(.wp-admin) .stk-block-column:first-child:nth-last-child(5)){flex:1 1 calc(20% - var(--stk-column-gap, 0px)*4/5)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(2):nth-last-child(4)){flex:1 1 calc(20% - var(--stk-column-gap, 0px)*4/5)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(3):nth-last-child(3)){flex:1 1 calc(20% - var(--stk-column-gap, 0px)*4/5)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(4):nth-last-child(2)){flex:1 1 calc(20% - var(--stk-column-gap, 0px)*4/5)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(5):last-child){flex:1 1 calc(20% - var(--stk-column-gap, 0px)*4/5)!important}:where(body:not(.wp-admin) .stk-block-column:first-child:nth-last-child(6)){flex:1 1 calc(16.66667% - var(--stk-column-gap, 0px)*5/6)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(2):nth-last-child(5)){flex:1 1 calc(16.66667% - var(--stk-column-gap, 0px)*5/6)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(3):nth-last-child(4)){flex:1 1 calc(16.66667% - var(--stk-column-gap, 0px)*5/6)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(4):nth-last-child(3)){flex:1 1 calc(16.66667% - var(--stk-column-gap, 0px)*5/6)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(5):nth-last-child(2)){flex:1 1 calc(16.66667% - var(--stk-column-gap, 0px)*5/6)!important}:where(body:not(.wp-admin) .stk-block-column:nth-child(6):last-child){flex:1 1 calc(16.66667% - var(--stk-column-gap, 0px)*5/6)!important}.stk-block-tabs>.stk-inner-blocks.stk-block-tabs--vertical{grid-template-columns:auto 1fr auto}.stk-block-tabs>.stk-inner-blocks.stk-block-tabs--vertical>.stk-block-tab-labels:first-child{grid-column:1/2}.stk-block-tabs>.stk-inner-blocks.stk-block-tabs--vertical>.stk-block-tab-content:last-child{grid-column:2/4}.stk-block-tabs>.stk-inner-blocks.stk-block-tabs--vertical>.stk-block-tab-content:first-child{grid-column:1/3}.stk-block-tabs>.stk-inner-blocks.stk-block-tabs--vertical>.stk-block-tab-labels:last-child{grid-column:3/4}.stk-block .stk-block.aligncenter,.stk-block:is(.aligncenter,.alignwide,.alignfull)>.stk-content-align:not(.alignwide):not(.alignfull){margin-left:auto;margin-right:auto;max-width:var(--stk-block-default-width,var(--stk-block-width-default-detected,900px));width:100%}.stk-block .stk-block.alignwide,.stk-block:is(.aligncenter,.alignwide,.alignfull)>.stk-content-align.alignwide{margin-left:auto;margin-right:auto;max-width:var(--stk-block-wide-width,var(--stk-block-width-wide-detected,80vw));width:100%}.stk-row.stk-columns-2>.stk-column{flex:1 1 50%;max-width:50%}.stk-row.stk-columns-3>.stk-column{flex:1 1 33.3333333333%;max-width:33.3333333333%}.stk-row.stk-columns-4>.stk-column{flex:1 1 25%;max-width:25%}.stk-row.stk-columns-5>.stk-column{flex:1 1 20%;max-width:20%}.stk-row.stk-columns-6>.stk-column{flex:1 1 16.6666666667%;max-width:16.6666666667%}.stk-row.stk-columns-7>.stk-column{flex:1 1 14.2857142857%;max-width:14.2857142857%}.stk-row.stk-columns-8>.stk-column{flex:1 1 12.5%;max-width:12.5%}.stk-row.stk-columns-9>.stk-column{flex:1 1 11.1111111111%;max-width:11.1111111111%}.stk-row.stk-columns-10>.stk-column{flex:1 1 10%;max-width:10%}}@media only screen and (min-width:781px) and (max-width:1279px){.stk-button-group:is(.stk--collapse-on-tablet)>.block-editor-inner-blocks>.block-editor-block-list__layout>[data-block]{margin-inline-end:var(--stk-alignment-margin-right);margin-inline-start:var(--stk-alignment-margin-left)}:where(.has-text-align-left-tablet) .stk-block-divider{--stk-dots-margin-left:0;--stk-dots-margin-right:auto}:where(.has-text-align-right-tablet) .stk-block-divider{--stk-dots-margin-right:0;--stk-dots-margin-left:auto}:where(.has-text-align-center-tablet) .stk-block-divider{--stk-dots-margin-right:auto;--stk-dots-margin-left:auto}.stk--hide-tablet,.stk--hide-tablet.stk-block{display:none!important}.stk-button-group:is(.stk--collapse-on-tablet) .stk-block:is(.stk-block-button,.stk-block-icon-button){margin-inline-end:var(--stk-alignment-margin-right);margin-inline-start:var(--stk-alignment-margin-left)}}@media only screen and (max-width:1279px){.stk-block-button{min-width:-moz-fit-content;min-width:fit-content}.stk-block.stk-block-divider.has-text-align-center-tablet{--stk-dots-margin-right:auto;--stk-dots-margin-left:auto}.stk-block.stk-block-divider.has-text-align-right-tablet{--stk-dots-margin-right:0;--stk-dots-margin-left:auto}.stk-block.stk-block-divider.has-text-align-left-tablet{--stk-dots-margin-left:0;--stk-dots-margin-right:auto}.stk-block-timeline.stk-block-timeline__ios-polyfill{--fixed-bg:linear-gradient(to bottom,var(--line-accent-bg-color,#000) 0,var(--line-accent-bg-color-2,#000) var(--line-accent-bg-location,50%))}.has-text-align-center-tablet{--stk-alignment-padding-left:0;--stk-alignment-justify-content:center;--stk-alignment-text-align:center;--stk-alignment-margin-left:auto;--stk-alignment-margin-right:auto;text-align:var(--stk-alignment-text-align,start)}.has-text-align-left-tablet{--stk-alignment-justify-content:flex-start;--stk-alignment-text-align:start;--stk-alignment-margin-left:0;--stk-alignment-margin-right:auto;text-align:var(--stk-alignment-text-align,start)}.has-text-align-right-tablet{--stk-alignment-justify-content:flex-end;--stk-alignment-text-align:end;--stk-alignment-margin-left:auto;--stk-alignment-margin-right:0;text-align:var(--stk-alignment-text-align,start)}.has-text-align-justify-tablet{--stk-alignment-text-align:justify}.has-text-align-space-between-tablet{--stk-alignment-justify-content:space-between}.has-text-align-space-around-tablet{--stk-alignment-justify-content:space-around}.has-text-align-space-evenly-tablet{--stk-alignment-justify-content:space-evenly}}@media only screen and (max-width:780px){.stk-button-group:is(.stk--collapse-on-mobile)>.block-editor-inner-blocks>.block-editor-block-list__layout>[data-block],.stk-button-group:is(.stk--collapse-on-tablet)>.block-editor-inner-blocks>.block-editor-block-list__layout>[data-block]{margin-inline-end:var(--stk-alignment-margin-right);margin-inline-start:var(--stk-alignment-margin-left)}.stk-block-carousel.stk--hide-mobile-arrows>.stk-block-carousel__content-wrapper>*>.stk-block-carousel__buttons,.stk-block-carousel.stk--hide-mobile-dots>.stk-block-carousel__content-wrapper>.stk-block-carousel__dots{display:none}:where(.has-text-align-left-mobile) .stk-block-divider{--stk-dots-margin-left:0;--stk-dots-margin-right:auto}:where(.has-text-align-right-mobile) .stk-block-divider{--stk-dots-margin-right:0;--stk-dots-margin-left:auto}:where(.has-text-align-center-mobile) .stk-block-divider{--stk-dots-margin-right:auto;--stk-dots-margin-left:auto}.stk-block.stk-block-divider.has-text-align-center-mobile{--stk-dots-margin-right:auto;--stk-dots-margin-left:auto}.stk-block.stk-block-divider.has-text-align-right-mobile{--stk-dots-margin-right:0;--stk-dots-margin-left:auto}.stk-block.stk-block-divider.has-text-align-left-mobile{--stk-dots-margin-left:0;--stk-dots-margin-right:auto}.stk-block.stk-block-feature:is(.is-style-default,.is-style-horizontal)>.stk-container>.stk-inner-blocks.stk-block-content{flex-direction:column-reverse}.stk-block-posts{--stk-columns:1}.stk-block-tab-labels:not(.stk-block-tab-labels--wrap-mobile){overflow-x:auto!important;width:100%}.stk-block-tab-labels:not(.stk-block-tab-labels--wrap-mobile)::-webkit-scrollbar{height:0!important}.stk-block-tab-labels:not(.stk-block-tab-labels--wrap-mobile) .stk-block-tab-labels__wrapper{flex-wrap:nowrap;min-width:-webkit-fill-available;min-width:fill-available;width:max-content}.stk-block-tabs>.stk-inner-blocks{grid-template-columns:1fr}.stk-block-tabs>.stk-inner-blocks>.stk-block-tab-labels:last-child{grid-row:1/2}.stk-block.stk-block-timeline{--content-line:0!important;padding-top:0}.stk-block-timeline>.stk-inner-blocks{align-items:flex-start;grid-template-columns:var(--line-dot-size,16px) 1fr;grid-template-rows:auto 1fr;padding-left:16px}.stk-block-timeline>.stk-inner-blocks:after{inset-inline-start:calc(var(--line-dot-size, 16px)/2 - var(--line-bg-width, 3px)/2 + 16px)}.stk-block-timeline .stk-block-timeline__middle{inset-block-start:8px;inset-inline-start:16px;position:absolute}.stk-block-timeline .stk-block-timeline__content{grid-column:2/3;grid-row:2/3;text-align:start}.stk-block-timeline .stk-block-timeline__date{grid-column:2/3;grid-row:1/2;text-align:start}.stk-block-timeline>.stk-inner-blocks:after{bottom:calc(100% - var(--line-dot-size, 16px)/2 - .5em);top:calc(var(--line-dot-size, 16px)/2 + .5em)}.stk-block-timeline+.stk-block-timeline>.stk-inner-blocks:after{top:-16px}:root{--stk-block-margin-bottom:16px;--stk-container-padding:24px 24px;--stk-container-padding-large:32px 24px;--stk-container-padding-small:8px 24px;--stk-column-margin:8px;--stk-block-background-padding:16px 16px}.stk-block .stk-block:is(.aligncenter,.alignwide),.stk-block:is(.aligncenter,.alignwide,.alignfull)>.stk-content-align.alignwide,.stk-block:is(.aligncenter,.alignwide,.alignfull)>.stk-content-align:not(.alignwide):not(.alignfull){width:100%}.stk-column{flex:1 1 100%;max-width:100%}.stk--hide-mobile,.stk--hide-mobile.stk-block{display:none!important}.stk-button-group:is(.stk--collapse-on-mobile) .stk-block:is(.stk-block-button,.stk-block-icon-button),.stk-button-group:is(.stk--collapse-on-tablet) .stk-block:is(.stk-block-button,.stk-block-icon-button){margin-inline-end:var(--stk-alignment-margin-right);margin-inline-start:var(--stk-alignment-margin-left)}.has-text-align-center-mobile{--stk-alignment-padding-left:0;--stk-alignment-justify-content:center;--stk-alignment-text-align:center;--stk-alignment-margin-left:auto;--stk-alignment-margin-right:auto;text-align:var(--stk-alignment-text-align,start)}.has-text-align-left-mobile{--stk-alignment-justify-content:flex-start;--stk-alignment-text-align:start;--stk-alignment-margin-left:0;--stk-alignment-margin-right:auto;text-align:var(--stk-alignment-text-align,start)}.has-text-align-right-mobile{--stk-alignment-justify-content:flex-end;--stk-alignment-text-align:end;--stk-alignment-margin-left:auto;--stk-alignment-margin-right:0;text-align:var(--stk-alignment-text-align,start)}.has-text-align-justify-mobile{--stk-alignment-text-align:justify}.has-text-align-space-between-mobile{--stk-alignment-justify-content:space-between}.has-text-align-space-around-mobile{--stk-alignment-justify-content:space-around}.has-text-align-space-evenly-mobile{--stk-alignment-justify-content:space-evenly}.entry-content .stk-block.stk-has-top-separator{padding-top:23vw}.entry-content .stk-block.stk-has-bottom-separator{padding-bottom:23vw}.entry-content .stk-block .stk-separator__wrapper{height:23vw}}#end-resizable-editor-section{display:none}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://tehtris.com/wp-includes/css/dist/block-library/style.min.css?ver=16c39f4bf80b66d542b8e42788693bdc' media='all' />
<link rel='stylesheet' id='tehtris-blocks-css' href='https://tehtris.com/wp-content/themes/tehtris/dist/blocks/style-blocks.css?ver=1723039927' media='all' />
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--tehtris-white: #ffffff;--wp--preset--color--tehtris-black: #1b1b26;--wp--preset--color--tehtris-brand-blue-1: #21307d;--wp--preset--color--tehtris-brand-blue-2: #0000ff;--wp--preset--color--tehtris-brand-blue-3: #005590;--wp--preset--color--tehtris-brand-blue-4: #00bcff;--wp--preset--color--tehtris-brand-blue-5: #00d3ff;--wp--preset--color--tehtris-web-blue-1: #1a295c;--wp--preset--color--tehtris-web-blue-2: #18244e;--wp--preset--color--tehtris-web-blue-3: #0f1838;--wp--preset--color--tehtris-pink: #f71ea9;--wp--preset--color--tehtris-pink-dark: #de4290;--wp--preset--color--tehtris-grey: #3d3d43;--wp--preset--color--tehtris-grey-medium: #54545e;--wp--preset--color--tehtris-grey-medium-light: #bcc1cd;--wp--preset--color--tehtris-grey-light: #cfcfd5;--wp--preset--color--tehtris-grey-extralight: #f3f3f5;--wp--preset--color--tehtris-blurred-light: #ffffff17;--wp--preset--color--tehtris-transparent-bleu: #0B024442;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--gradient--tehtris-blue: linear-gradient(40deg, #078ab8 0%, #103482 60%);--wp--preset--gradient--tehtris-blue-contrast: linear-gradient(90deg, #2139b0 0%, #01b7fc 100%);--wp--preset--gradient--tehtris-blue-dark: linear-gradient(45deg, #192E6A 0%, #1D3285 100%);--wp--preset--gradient--tehtris-electric-blue: linear-gradient(150deg, #2138af 0%, #0000ff 100%);--wp--preset--gradient--tehtris-blue-pink: linear-gradient(45deg, #00d3ff 50%, 80%, #ff00ff 98%);--wp--preset--gradient--tehtris-light-blue: linear-gradient(40deg, #d3f0f8 0%, #f0f0f0 50%);--wp--preset--gradient--tehtris-light-blue-alt: linear-gradient(80deg, #d3f0f8 0%, #f0f0f0 50%);--wp--preset--gradient--tehtris-light-blue-radial: radial-gradient(farthest-side at -50% 50%, #d3f0f8, #f0f0f0);--wp--preset--font-size--small: clamp(0.75rem, 0.75rem + ((1vw - 0.48rem) * 1.592), 0.875rem);--wp--preset--font-size--medium: clamp(1.125rem, 1.125rem + ((1vw - 0.48rem) * 1.592), 1.25rem);--wp--preset--font-size--large: clamp(1.25rem, 1.25rem + ((1vw - 0.48rem) * 1.592), 1.75rem);--wp--preset--font-size--x-large: clamp(2rem, 2rem + ((1vw - 0.48rem) * 1.592), 2.25rem);--wp--preset--font-size--xsmall: clamp(0.625rem, 0.625rem + ((1vw - 0.48rem) * 1.592), 0.75rem);--wp--preset--font-size--regular: clamp(0.875rem, 0.875rem + ((1vw - 0.48rem) * 1.592), 1rem);--wp--preset--font-size--normal: clamp(1rem, 1rem + ((1vw - 0.48rem) * 1.592), 1.125rem);--wp--preset--font-size--larger: clamp(1.125rem, 1.125rem + ((1vw - 0.48rem) * 1.592), 1.5rem);--wp--preset--font-size--xx-large: clamp(2.5rem, 2.5rem + ((1vw - 0.48rem) * 1.592), 3rem);--wp--preset--font-size--xxx-large: clamp(3rem, 3rem + ((1vw - 0.48rem) * 1.592), 3.75rem);--wp--preset--font-size--huge: clamp(4rem, 4rem + ((1vw - 0.48rem) * 1.592), 5rem);--wp--preset--font-size--heavy: clamp(6rem, 6rem + ((1vw - 0.48rem) * 1.592), 8rem);--wp--preset--font-size--super-heavy: clamp(12rem, 12rem + ((1vw - 0.48rem) * 1.592), 16rem);--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: clamp(1.5rem, 5vw, 2rem);--wp--preset--spacing--40: clamp(1.8rem, 1.8rem + ((1vw - 0.48rem) * 2.885), 3rem);--wp--preset--spacing--50: clamp(2.5rem, 8vw, 4.5rem);--wp--preset--spacing--60: clamp(3.75rem, 10vw, 7rem);--wp--preset--spacing--70: clamp(5rem, 5.25rem + ((1vw - 0.48rem) * 9.096), 8rem);--wp--preset--spacing--80: clamp(7rem, 14vw, 11rem);--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:root { --wp--style--global--content-size: 1148px;--wp--style--global--wide-size: 1288px; }:where(body) { margin: 0; }.wp-site-blocks > .alignleft { float: left; margin-right: 2em; }.wp-site-blocks > .alignright { float: right; margin-left: 2em; }.wp-site-blocks > .aligncenter { justify-content: center; margin-left: auto; margin-right: auto; }:where(.wp-site-blocks) > * { margin-block-start: 2rem; margin-block-end: 0; }:where(.wp-site-blocks) > :first-child { margin-block-start: 0; }:where(.wp-site-blocks) > :last-child { margin-block-end: 0; }:root { --wp--style--block-gap: 2rem; }:root :where(.is-layout-flow) > :first-child{margin-block-start: 0;}:root :where(.is-layout-flow) > :last-child{margin-block-end: 0;}:root :where(.is-layout-flow) > *{margin-block-start: 2rem;margin-block-end: 0;}:root :where(.is-layout-constrained) > :first-child{margin-block-start: 0;}:root :where(.is-layout-constrained) > :last-child{margin-block-end: 0;}:root :where(.is-layout-constrained) > *{margin-block-start: 2rem;margin-block-end: 0;}:root :where(.is-layout-flex){gap: 2rem;}:root :where(.is-layout-grid){gap: 2rem;}.is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}.is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}.is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}.is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}.is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}body{padding-top: 0px;padding-right: 0px;padding-bottom: 0px;padding-left: 0px;}a:where(:not(.wp-element-button)){text-decoration: underline;}:root :where(.wp-element-button, .wp-block-button__link){background-color: #32373c;border-width: 0;color: #fff;font-family: inherit;font-size: inherit;line-height: inherit;padding: calc(0.667em + 2px) calc(1.333em + 2px);text-decoration: none;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-tehtris-white-color{color: var(--wp--preset--color--tehtris-white) !important;}.has-tehtris-black-color{color: var(--wp--preset--color--tehtris-black) !important;}.has-tehtris-brand-blue-1-color{color: var(--wp--preset--color--tehtris-brand-blue-1) !important;}.has-tehtris-brand-blue-2-color{color: var(--wp--preset--color--tehtris-brand-blue-2) !important;}.has-tehtris-brand-blue-3-color{color: var(--wp--preset--color--tehtris-brand-blue-3) !important;}.has-tehtris-brand-blue-4-color{color: var(--wp--preset--color--tehtris-brand-blue-4) !important;}.has-tehtris-brand-blue-5-color{color: var(--wp--preset--color--tehtris-brand-blue-5) !important;}.has-tehtris-web-blue-1-color{color: var(--wp--preset--color--tehtris-web-blue-1) !important;}.has-tehtris-web-blue-2-color{color: var(--wp--preset--color--tehtris-web-blue-2) !important;}.has-tehtris-web-blue-3-color{color: var(--wp--preset--color--tehtris-web-blue-3) !important;}.has-tehtris-pink-color{color: var(--wp--preset--color--tehtris-pink) !important;}.has-tehtris-pink-dark-color{color: var(--wp--preset--color--tehtris-pink-dark) !important;}.has-tehtris-grey-color{color: var(--wp--preset--color--tehtris-grey) !important;}.has-tehtris-grey-medium-color{color: var(--wp--preset--color--tehtris-grey-medium) !important;}.has-tehtris-grey-medium-light-color{color: var(--wp--preset--color--tehtris-grey-medium-light) !important;}.has-tehtris-grey-light-color{color: var(--wp--preset--color--tehtris-grey-light) !important;}.has-tehtris-grey-extralight-color{color: var(--wp--preset--color--tehtris-grey-extralight) !important;}.has-tehtris-blurred-light-color{color: var(--wp--preset--color--tehtris-blurred-light) !important;}.has-tehtris-transparent-bleu-color{color: var(--wp--preset--color--tehtris-transparent-bleu) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-tehtris-white-background-color{background-color: var(--wp--preset--color--tehtris-white) !important;}.has-tehtris-black-background-color{background-color: var(--wp--preset--color--tehtris-black) !important;}.has-tehtris-brand-blue-1-background-color{background-color: var(--wp--preset--color--tehtris-brand-blue-1) !important;}.has-tehtris-brand-blue-2-background-color{background-color: var(--wp--preset--color--tehtris-brand-blue-2) !important;}.has-tehtris-brand-blue-3-background-color{background-color: var(--wp--preset--color--tehtris-brand-blue-3) !important;}.has-tehtris-brand-blue-4-background-color{background-color: var(--wp--preset--color--tehtris-brand-blue-4) !important;}.has-tehtris-brand-blue-5-background-color{background-color: var(--wp--preset--color--tehtris-brand-blue-5) !important;}.has-tehtris-web-blue-1-background-color{background-color: var(--wp--preset--color--tehtris-web-blue-1) !important;}.has-tehtris-web-blue-2-background-color{background-color: var(--wp--preset--color--tehtris-web-blue-2) !important;}.has-tehtris-web-blue-3-background-color{background-color: var(--wp--preset--color--tehtris-web-blue-3) !important;}.has-tehtris-pink-background-color{background-color: var(--wp--preset--color--tehtris-pink) !important;}.has-tehtris-pink-dark-background-color{background-color: var(--wp--preset--color--tehtris-pink-dark) !important;}.has-tehtris-grey-background-color{background-color: var(--wp--preset--color--tehtris-grey) !important;}.has-tehtris-grey-medium-background-color{background-color: var(--wp--preset--color--tehtris-grey-medium) !important;}.has-tehtris-grey-medium-light-background-color{background-color: var(--wp--preset--color--tehtris-grey-medium-light) !important;}.has-tehtris-grey-light-background-color{background-color: var(--wp--preset--color--tehtris-grey-light) !important;}.has-tehtris-grey-extralight-background-color{background-color: var(--wp--preset--color--tehtris-grey-extralight) !important;}.has-tehtris-blurred-light-background-color{background-color: var(--wp--preset--color--tehtris-blurred-light) !important;}.has-tehtris-transparent-bleu-background-color{background-color: var(--wp--preset--color--tehtris-transparent-bleu) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-tehtris-white-border-color{border-color: var(--wp--preset--color--tehtris-white) !important;}.has-tehtris-black-border-color{border-color: var(--wp--preset--color--tehtris-black) !important;}.has-tehtris-brand-blue-1-border-color{border-color: var(--wp--preset--color--tehtris-brand-blue-1) !important;}.has-tehtris-brand-blue-2-border-color{border-color: var(--wp--preset--color--tehtris-brand-blue-2) !important;}.has-tehtris-brand-blue-3-border-color{border-color: var(--wp--preset--color--tehtris-brand-blue-3) !important;}.has-tehtris-brand-blue-4-border-color{border-color: var(--wp--preset--color--tehtris-brand-blue-4) !important;}.has-tehtris-brand-blue-5-border-color{border-color: var(--wp--preset--color--tehtris-brand-blue-5) !important;}.has-tehtris-web-blue-1-border-color{border-color: var(--wp--preset--color--tehtris-web-blue-1) !important;}.has-tehtris-web-blue-2-border-color{border-color: var(--wp--preset--color--tehtris-web-blue-2) !important;}.has-tehtris-web-blue-3-border-color{border-color: var(--wp--preset--color--tehtris-web-blue-3) !important;}.has-tehtris-pink-border-color{border-color: var(--wp--preset--color--tehtris-pink) !important;}.has-tehtris-pink-dark-border-color{border-color: var(--wp--preset--color--tehtris-pink-dark) !important;}.has-tehtris-grey-border-color{border-color: var(--wp--preset--color--tehtris-grey) !important;}.has-tehtris-grey-medium-border-color{border-color: var(--wp--preset--color--tehtris-grey-medium) !important;}.has-tehtris-grey-medium-light-border-color{border-color: var(--wp--preset--color--tehtris-grey-medium-light) !important;}.has-tehtris-grey-light-border-color{border-color: var(--wp--preset--color--tehtris-grey-light) !important;}.has-tehtris-grey-extralight-border-color{border-color: var(--wp--preset--color--tehtris-grey-extralight) !important;}.has-tehtris-blurred-light-border-color{border-color: var(--wp--preset--color--tehtris-blurred-light) !important;}.has-tehtris-transparent-bleu-border-color{border-color: var(--wp--preset--color--tehtris-transparent-bleu) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-tehtris-blue-gradient-background{background: var(--wp--preset--gradient--tehtris-blue) !important;}.has-tehtris-blue-contrast-gradient-background{background: var(--wp--preset--gradient--tehtris-blue-contrast) !important;}.has-tehtris-blue-dark-gradient-background{background: var(--wp--preset--gradient--tehtris-blue-dark) !important;}.has-tehtris-electric-blue-gradient-background{background: var(--wp--preset--gradient--tehtris-electric-blue) !important;}.has-tehtris-blue-pink-gradient-background{background: var(--wp--preset--gradient--tehtris-blue-pink) !important;}.has-tehtris-light-blue-gradient-background{background: var(--wp--preset--gradient--tehtris-light-blue) !important;}.has-tehtris-light-blue-alt-gradient-background{background: var(--wp--preset--gradient--tehtris-light-blue-alt) !important;}.has-tehtris-light-blue-radial-gradient-background{background: var(--wp--preset--gradient--tehtris-light-blue-radial) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-xsmall-font-size{font-size: var(--wp--preset--font-size--xsmall) !important;}.has-regular-font-size{font-size: var(--wp--preset--font-size--regular) !important;}.has-normal-font-size{font-size: var(--wp--preset--font-size--normal) !important;}.has-larger-font-size{font-size: var(--wp--preset--font-size--larger) !important;}.has-xx-large-font-size{font-size: var(--wp--preset--font-size--xx-large) !important;}.has-xxx-large-font-size{font-size: var(--wp--preset--font-size--xxx-large) !important;}.has-huge-font-size{font-size: var(--wp--preset--font-size--huge) !important;}.has-heavy-font-size{font-size: var(--wp--preset--font-size--heavy) !important;}.has-super-heavy-font-size{font-size: var(--wp--preset--font-size--super-heavy) !important;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='tehtris-dep-splide-css' href='https://tehtris.com/wp-content/themes/tehtris/libs/splide/dist/css/splide-core.min.css?ver=16c39f4bf80b66d542b8e42788693bdc' media='all' />
<link rel='stylesheet' id='tehtris-css' href='https://tehtris.com/wp-content/themes/tehtris/dist/styles/front.css?ver=16c39f4bf80b66d542b8e42788693bdc' media='all' />
<link rel='stylesheet' id='cf7cf-style-css' href='https://tehtris.com/wp-content/plugins/cf7-conditional-fields/style.css?ver=2.5.10' media='all' />
<script src="https://tehtris.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://tehtris.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://tehtris.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://tehtris.com/wp-json/wp/v2/posts/91633" /><link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://tehtris.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ftehtris.com%2Fen%2Fblog%2Fbuer-loader-analysis-a-rusted-malware-program%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://tehtris.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ftehtris.com%2Fen%2Fblog%2Fbuer-loader-analysis-a-rusted-malware-program%2F&#038;format=xml" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TCLZCSN');</script>
<!-- End Google Tag Manager -->
		<script>
			document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
		</script>
				<style>
			.no-js img.lazyload {
				display: none;
			}

			figure.wp-block-image img.lazyloading {
				min-width: 150px;
			}

						.lazyload {
				opacity: 0;
			}

			.lazyloading {
				border: 0 !important;
				opacity: 1;
				background: rgba(255, 255, 255, 0) url('https://tehtris.com/wp-content/plugins/wp-smush-pro/app/assets/images/smush-lazyloader-2.gif') no-repeat center !important;
				background-size: 16px auto !important;
				min-width: 16px;
			}

			.lazyload,
			.lazyloading {
				--smush-placeholder-width: 100px;
				--smush-placeholder-aspect-ratio: 1/1;
				width: var(--smush-placeholder-width) !important;
				aspect-ratio: var(--smush-placeholder-aspect-ratio) !important;
			}

					</style>
		
<style class="stk-block-styles">.stk-db464ce li,.stk-db464ce ul li a,.stk-db464ce ol li a{color:#f71ea9 !important}.stk-db464ce{border-style:dashed !important;border-color:#4b4b4b !important;border-top-width:2px !important;border-right-width:0px !important;border-bottom-width:2px !important;border-left-width:0px !important;padding-top:2em !important;padding-bottom:2em !important;margin-top:40px !important;margin-bottom:40px !important}</style><link rel="icon" href="https://tehtris.com/wp-content/uploads/2021/06/cropped-cropped-chevrons-bleu-32x32.png" sizes="32x32" />
<link rel="icon" href="https://tehtris.com/wp-content/uploads/2021/06/cropped-cropped-chevrons-bleu-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://tehtris.com/wp-content/uploads/2021/06/cropped-cropped-chevrons-bleu-180x180.png" />
<meta name="msapplication-TileImage" content="https://tehtris.com/wp-content/uploads/2021/06/cropped-cropped-chevrons-bleu-270x270.png" />
</head>

<body class="post-template-default single single-post postid-91633 single-format-standard no-js blog single-blog">
<div id="page" class="page-blog">
    <a class="skip-link visually-hidden" href="#content">Skip to content</a>

    <header class="main-header">

        <div class="top-navbar">
            <div class="top-navbar-wrap container">
                <div class="menu-top-menu-en-container"><ul id="top-navmenu" class="menu top-navmenu"><li id="menu-item-24854" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24854"><a href="https://tehtris.com/en/contact/">Contact</a></li>
<li id="menu-item-24857" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-24857"><a href="https://tehtris.com/en/blog/">Blog</a></li>
<li id="menu-item-108381" class="menu-item menu-item-type-post_type_archive menu-item-object-cpt_glossary menu-item-108381"><a href="https://tehtris.com/en/glossary/">Glossary</a></li>
</ul></div><select name="lang_choice_1" id="lang_choice_1" class="pll-switcher-select">
	<option value="https://tehtris.com/en/blog/buer-loader-analysis-a-rusted-malware-program/" lang="en-US" selected='selected'>English</option>
	<option value="https://tehtris.com/fr/blog/analyse-malware-buer-loader/" lang="fr-FR">Français</option>
	<option value="https://tehtris.com/de/" lang="de-DE">Deutsch</option>
	<option value="https://tehtris.com/es/" lang="es-ES">Español</option>

</select>
<script>
					document.getElementById( "lang_choice_1" ).addEventListener( "change", function ( event ) { location.href = event.currentTarget.value; } )
				</script>            </div>
        </div>
                    <div id="header" class="site-header blog-header main-header--blog">
    <div class="main-header-wrap--blog container">
        <div class="site-branding">
                                                <a class="site-logo" href="https://tehtris.com/en" rel="home">
                        <img src="https://tehtris.com/wp-content/themes/tehtris/dist/images/TEHTRIS-logo-blue.svg" alt="Logo" class="site-logo-img">
                    </a>
                    <span class="site-logo-separator">/</span>
                    <a class="blog-logo" href="https://tehtris.com/en/blog/">
                        <img data-src="https://tehtris.com/wp-content/themes/tehtris/dist/images/blog-logo.png" alt="Blog logo" class="blog-logo-img lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
                    </a>
                                    </div>

        <nav id="site-navigation" class="main-navigation">
            <button type="button" id="btn-menu-toggle" class="main-navigation-toggle btn-control" aria-hidden="true" data-menu="Menu" data-close="Close">
                <svg aria-hidden="true" class="nav-toggle-pct">
                    <use class="burger" href="https://tehtris.com/wp-content/themes/tehtris/dist/images/pictos/sprite.svg#pct-burger"></use>
                    <use class="close" href="https://tehtris.com/wp-content/themes/tehtris/dist/images/pictos/sprite.svg#pct-close"></use>
                </svg>
                <span class="visually-hidden">Toggle menu</span>
            </button>

            <div class="main-navigation-menu js-menu">
                <div class="menu-blog-menu-en-container"><ul id="blog-menu" class="blog-menu menu"><li id="menu-item-13611" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-13611"><a href="https://tehtris.com/en/blog/">Articles</a></li>
<li id="menu-item-100511" class="menu-item menu-item-type-post_type_archive menu-item-object-cpt_glossary menu-item-100511"><a href="https://tehtris.com/en/glossary/">Glossary</a></li>
</ul></div>
                <a href="https://tehtris.com/en/" class="btn main-navigation-cta">
                    Go to TEHTRIS website                </a>
            </div>
        </nav>


    </div>
</div>
        
    </header>

    <div id="content" class="site-content">

    <div id="primary" class="content-area container">

        <article class="blog-single post js-bind-progress">


    <header class="blog-single-header">
        <div class="blog-single-image">
            <img width="1024" height="538" src="https://tehtris.com/wp-content/uploads/2022/01/COVER-ARTICLES-BUER-GEN-1024x538.jpg" class="attachment-large size-large wp-post-image" alt="" decoding="async" fetchpriority="high" srcset="https://tehtris.com/wp-content/uploads/2022/01/COVER-ARTICLES-BUER-GEN-1024x538.jpg 1024w, https://tehtris.com/wp-content/uploads/2022/01/COVER-ARTICLES-BUER-GEN-300x158.jpg 300w, https://tehtris.com/wp-content/uploads/2022/01/COVER-ARTICLES-BUER-GEN-768x403.jpg 768w, https://tehtris.com/wp-content/uploads/2022/01/COVER-ARTICLES-BUER-GEN.jpg 1200w" sizes="(max-width: 1024px) 100vw, 1024px" />        </div>

        <div class="blog-single-header-wrap">
            <div class="blog-single-header-meta">
                <p class="blog-single-date"><span class="posted-on"><time class="entry-date published" datetime="2022-01-20T08:00:00+00:00">January 20, 2022</time></span></p>

                <div class="post-item-tags">
                    <span class="post-item-tags-item">CTI</span>                </div>
            </div>

            <h1 class="blog-single-title">Buer Loader Analysis, a Rusted malware program</h1>

            <div class="social-share">
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ftehtris.com%2Fen%2Fblog%2Fbuer-loader-analysis-a-rusted-malware-program%2F&t=Buer+Loader+Analysis%2C+a+Rusted+malware+program" title="Share on Facebook" class="social-share-item facebook" target="_blank">
        <svg aria-hidden="true" class="social-share-pct">
            <use href="https://tehtris.com/wp-content/themes/tehtris/dist/images/social/sprite.svg#facebook"></use>
        </svg>
        <span class="visually-hidden">Share on Facebook</span>
    </a>

    <a href="https://twitter.com/share?url=https%3A%2F%2Ftehtris.com%2Fen%2Fblog%2Fbuer-loader-analysis-a-rusted-malware-program%2F&text=Buer+Loader+Analysis%2C+a+Rusted+malware+program" title="Share on Twitter" class="social-share-item twitter" target="_blank">
        <svg aria-hidden="true" class="social-share-pct">
            <use href="https://tehtris.com/wp-content/themes/tehtris/dist/images/social/sprite.svg#x"></use>
        </svg>
        <span class="visually-hidden">Share on Twitter</span>
    </a>

    <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftehtris.com%2Fen%2Fblog%2Fbuer-loader-analysis-a-rusted-malware-program%2F" title="Share on LinkedIn" class="social-share-item linkedin" target="_blank">
        <svg aria-hidden="true" class="social-share-pct">
            <use href="https://tehtris.com/wp-content/themes/tehtris/dist/images/social/sprite.svg#linkedin"></use>
        </svg>
        <span class="visually-hidden">Share on LinkedIn</span>
    </a>
</div>
        </div>
    </header>


    <main class="blog-single-main">
        <div class="blog-single-content entry-content">
            
<p>Malware analysis is part of the CTI team&#8217;s daily routine. This article presents the analysis of a Rust strain of Buer Loader from the reception of the samples to the writing of a stage2* extraction script. Despite several protection mechanisms, it was possible to extract all the samples in different ways. TEHTRIS provides the code for such an extraction.</p>



<nav class="wp-block-stackable-table-of-contents stk-block-table-of-contents stk-block stk-51d14px" data-block-id="51d14px"><style>.stk-51d14px li,.stk-51d14px ul li a,.stk-51d14px ol li a{color:#f71ea9 !important}.stk-51d14px{border-style:dashed !important;border-color:#4b4b4b !important;border-top-width:2px !important;border-right-width:0px !important;border-bottom-width:2px !important;border-left-width:0px !important;padding-top:2em !important;padding-bottom:2em !important;margin-top:40px !important;margin-bottom:40px !important}</style><ul class="stk-table-of-contents__table has-text-color has-tehtris-pink-color"><li><a href="#introduction">Introduction</a></li><li><a href="#analysis">Analysis</a></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#bibliography">BIBLIOGRAPHY</a></li></ul></nav>



<h2 class="wp-block-heading" id="introduction">Introduction</h2>



<p>The Rust language [1] is more and more used [2] by developers. Indeed, the philosophy of this language is to maximize security while offering performances close to C++ in a pleasant syntax. Many ambitious projects like Kerla [3] aim at offering an operating system that is compatible with any Linux binary, without modification. This gives Rust a lot of credibility and explains its adoption by developers. From a low-level point of view, this language generates a more complex binary code to sign and analyze compared to C by offering more instructions and adding obfuscation at low cost, which is of interest to malware authors.</p>



<p>If still few adopt it, it is however not surprising to note that this language is starting to make a name for itself in the malware bestiary, as shown by Buer Loader [3] which includes variants developed in this language.</p>



<p>If this malware program has already been analyzed [3], it remains interesting to study its &#8220;stage1*&#8221; to identify the protection mechanisms and the evolutions concerning its obfuscation over time. Indeed, sandbox bypass techniques [5] and memory loading of offended binaries [6] by an unknown mechanism have been observed. This was enough to trigger the interest of a retro-analysis of the loader in question.</p>



<p>The goal is to characterize and extract the main load of the malware that was specifically spotted in computing environments between July and August 2021.</p>



<p>An emulation-based extraction method was presented at the Hack-It-N conference in December 2021. A replay of the presentation is available on Youtube [16].</p>



<h2 class="wp-block-heading" id="analysis">Analysis</h2>



<p>The retrieved samples work on the same model, i.e. a base in Rust loading in memory a stage2, itself written in Rust. Here is the list of these samples:</p>



<figure class="wp-block-table"><table><tbody><tr><td><strong>Sha256</strong></td><td><strong>Compile time</strong></td><td><strong>Size</strong></td></tr><tr><td>001405ded84e227092bafe165117888d423719d7d75554025ec410d1d6558925</td><td>2021-07-28 17:59:19</td><td>3.4 MB</td></tr><tr><td>4421dbc01ddc5ed959419fe2a3a0f1c7b48f92b880273b481eb249cd17d59b91</td><td>2021-08-11 15:35:55</td><td>6.6 MB</td></tr><tr><td>52d8316b0765c147558aecbda686d076783f3a08b2741b8c9e3e717cc56e8a92</td><td>2021-07-19 13:57:22</td><td>7.3 MB</td></tr><tr><td>580d55f1e51465b697d46e67561f3161d4534a73e8aa47e18b9bae344d46bcf4</td><td>2021-07-19 13:57:22</td><td>7.3 MB</td></tr><tr><td>578dc62dfa0203080da262676f28c679114d6b1c90a4ab6c07b736d9ce64e43e</td><td>2021-07-15 16:28:54</td><td>7.1 MB</td></tr><tr><td>5ac6766680c8c06a4b0b4e6a929ec4f5404fca75aa774f3eb986f81b1b30622b</td><td>2021-08-05 14:47:25</td><td>4.9 MB</td></tr><tr><td>64dd547546394e1d431a25a671892c7aca9cf57ed0733a7435028792ad42f4a7</td><td>2021-08-16 18:54:29</td><td>4.1 MB</td></tr><tr><td>88689636f4b2287701b63f42c12e7e2387bf4c3ecc45eeb8a61ea707126bad9b</td><td>2021-08-03 15:46:42</td><td>3.3 MB</td></tr><tr><td>afb5cbe324865253c7a9dcadbe66c66746ea360f0cd184a2f4e1bbf104533ccd</td><td>2021-06-25 17:49:48</td><td>7.1 MB</td></tr><tr><td>c425264f34fa8574c7e4321020eb374b9364a094cda9647e557b97d5e2b8c17b</td><td>2021-08-16 18:54:29</td><td>4.1 MB</td></tr><tr><td>d3a486d3b032834b1203adefd25d0bf0b36fae7f9e72071c21ccc266e1e1f893</td><td>2021-07-19 14:14:54</td><td>4.3 MB</td></tr></tbody></table></figure>



<p>The compilation dates seem consistent with each other. Indeed, they match approximately the submission dates on Virus Total [15] (with a small delay). The binaries are stripped (i.e. symbols unnecessary for the binary to work have been removed, especially function names and debugging symbols) but still contain information about the used source code:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image1.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 2364px; --smush-placeholder-aspect-ratio: 2364/112;" /></figure>



<p>Unfortunately, BinDiff [7] is not able to compare binaries. The control flow is too complex for it. Therefore, the code comparisons were done manually by our experts.</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image2-300x161.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 300px; --smush-placeholder-aspect-ratio: 300/161;" /><figcaption class="wp-element-caption">BinDiff error</figcaption></figure>



<p>Our analysis determined that there seem to be only 2 source files outside of the open source (mainly cryptographic) libraries used. A first anti-sandbox technique consists in wasting time by performing an unnecessary loop. The order of magnitude of the time needed (and lost) is about one minute with a 100% occupied CPU.</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image3.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 1166px; --smush-placeholder-aspect-ratio: 1166/2052;" /><figcaption class="wp-element-caption">Anti-sandbox by waste of time</figcaption></figure>



<p>After passing through this loop, we arrive at the decryption function of stage2. This one contains a large number of successive calls to useless functions, among which we find:</p>



<ul class="wp-block-list">
<li><strong>GetCommandLineA;</strong></li>



<li><strong>GetCurrentProcess;</strong></li>



<li><strong>GetEnvironmentStrings;</strong></li>



<li><strong>GetLastError;</strong></li>



<li><strong>GetProcessHeap;</strong></li>



<li><strong>GetTickCount;</strong></li>
</ul>



<p>It is probably a saturation mechanism using calls (call to a Windows library) and not taking any argument to override possible sandboxes, which complicates code emulation. It seems that a script generates all the calls. This technique also has the advantage of adding a credible call/instruction ratio compared to a legitimate program. Counting the calls sometimes allows to find decryption or unpacking routines:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image4.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 494px; --smush-placeholder-aspect-ratio: 494/1726;" /><figcaption class="wp-element-caption">Decoys variant 1</figcaption></figure>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image5.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 478px; --smush-placeholder-aspect-ratio: 478/1012;" /></figure>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image6.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 610px; --smush-placeholder-aspect-ratio: 610/738;" /></figure>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image7.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 2350px; --smush-placeholder-aspect-ratio: 2350/896;" /><figcaption class="wp-element-caption">Decoys variant 2</figcaption></figure>



<p>These calls are repeated throughout the desobfuscation routine. The data are successively pushed on the stack, then in the heap with the help of kernel32 !HeapAlloc, in the form of DWORD:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image8.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 1890px; --smush-placeholder-aspect-ratio: 1890/582;" /><figcaption class="wp-element-caption">Stage2 buffer reconstruction</figcaption></figure>



<p>The call graph is very different across samples, reinforcing our hypothesis that the code is generated from a script. The mix of calls and desobfuscation involves a special effort to blend in a behavior that appears to be legitimate.</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/Sans-titre1.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 290px; --smush-placeholder-aspect-ratio: 290/778;" /><figcaption class="wp-element-caption">Control flow Variant1</figcaption></figure>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/Sans-titre.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 418px; --smush-placeholder-aspect-ratio: 418/778;" /><figcaption class="wp-element-caption">Control flow Variant2</figcaption></figure>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/Sans-titre2.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 372px; --smush-placeholder-aspect-ratio: 372/778;" /><figcaption class="wp-element-caption">Control flow Variant3</figcaption></figure>



<p>This technique allows to include binary data by limiting the entropy between 0.5 and 0.8, very close to what one would expect from legitimate instructions.</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image12.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 3976px; --smush-placeholder-aspect-ratio: 3976/2162;" /><figcaption class="wp-element-caption">Entropy of the malware program</figcaption></figure>



<p>This data, once reconstituted, is placed in a buffer which is decrypted. We then recognize a Key Schedule type mechanism, followed by a generator reminiscent of RC4:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image13.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 3090px; --smush-placeholder-aspect-ratio: 3090/782;" /><figcaption class="wp-element-caption">KSA block</figcaption></figure>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image14.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 2020px; --smush-placeholder-aspect-ratio: 2020/910;" /><figcaption class="wp-element-caption">RC4 Random generator</figcaption></figure>



<p>The Rust paradigm makes these decryption routines difficult to identify. Tools such as findcrypt [8] do not detect them. The following check identifies the entire desobfuscation chain:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image15.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 2224px; --smush-placeholder-aspect-ratio: 2224/104;" /><figcaption class="wp-element-caption">Decryption in python</figcaption></figure>



<p>The decompression is performed by the version 0.1.3 of the lzma-rs library [9], and the decryption keys are easily visible in the code. The following script allows its extraction:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image16.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 2834px; --smush-placeholder-aspect-ratio: 2834/294;" /><figcaption class="wp-element-caption">Key extraction script</figcaption></figure>



<p>The list of RC4 keys for the samples is as follows:</p>



<ul class="wp-block-list">
<li><strong>YDVHHCYTCH&nbsp;;</strong></li>



<li><strong>DQOQHMLGYU&nbsp;;</strong></li>



<li><strong>BWSCVQZXOB&nbsp;;</strong></li>



<li><strong>SIMHIDVSCR&nbsp;;</strong></li>



<li><strong>RGZPMAAQRP&nbsp;;</strong></li>



<li><strong>YVMOOVSIOF&nbsp;;</strong></li>



<li><strong>KSQKGUUTXZ&nbsp;;</strong></li>



<li><strong>EUWPUQYDTT&nbsp;;</strong></li>



<li><strong>KHBXNNHKNN&nbsp;;</strong></li>
</ul>



<p>Unfortunately, the number of keys is insufficient to evaluate the quality of the PRNG [10]. Note that the charset is very small, which does not matter since the key is in plain text in the &#8220;.rdata&#8221; section. Given the extremely variable and complex call graph, writing a generic data extraction script that works for all samples is tedious. Now that we know the key (cf. previous extraction script), we need to find the encrypted data. These, once desobfuscated, have a header with invariant data:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image17.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 1344px; --smush-placeholder-aspect-ratio: 1344/402;" /><figcaption class="wp-element-caption">3 blocks of encrypted buffer header</figcaption></figure>



<p>The following script then allows to find the extracted data in memory, provided that the program has performed the decryption phase by carrying out an Egg-hunting search:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image18.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 1480px; --smush-placeholder-aspect-ratio: 1480/364;" /><figcaption class="wp-element-caption">Encrypted data recovery script</figcaption></figure>



<p>The only thing missing to automate the extraction is to find an address or to set a breakpoint, which is done in a fairly logical way by finding the references to the RC4 key:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image19.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 1504px; --smush-placeholder-aspect-ratio: 1504/548;" /><figcaption class="wp-element-caption">Malware launching script</figcaption></figure>



<p>And the script works on the first try for all samples. The source code of the tool is available on the TEHTRIS github [19].</p>


<div class="embed-wrapper wp-embed-aspect-16-9 wp-has-aspect-ratio"><div class="embed-lazy embed-youtube" data-embed="g7MGDVC5jJg"><div class="embed-play-button"></div></div></div>


<p>An alternative method was presented at the Hack-it-N conference [16]. It consists in extracting the stage2 by emulation using the unicorn lib [17]. The source code is available on the TEHTRIS github [18].</p>



<p>The extraction of stage2 from the studied samples gives the following list:</p>



<figure class="wp-block-table"><table><tbody><tr><td><strong>Sha256</strong></td><td><strong>Stage1 compile time</strong></td><td><strong>Stage 2</strong>
<p>&nbsp;</p>
<p><strong>compile time</strong></p>
</td></tr><tr><td>edc3b5f8d45d7a1cceee144e57fc5ddfaf8c0c7407a1514d2f3bab4f3c9f18b8</td><td>2021-07-28 17:59:19</td><td>2021-07-28 17:39:31</td></tr><tr><td>d7ec38c0e89a749a7727e5644328835b50e19302e9f3a4688809403ebcbd03d2</td><td>2021-08-11 15:35:55</td><td>2021-08-11 15:30:38</td></tr><tr><td>6578db32dc78ef7f41213557cf894d03b97ed6974ae7a72bec9b7c7ac08c4ba9</td><td>2021-07-19 13:57:22</td><td>2021-07-19 13:44:11</td></tr><tr><td>d48d91451b9594eadc0d1ef6e379bbce9a6033bd337e06d46613a70187c9c5ef</td><td>2021-07-15 16:28:54</td><td>2021-07-15 16:20:18</td></tr><tr><td>54109b12cbbd223f5ad79a9f87bfe50ef05a80e5551a3c1931748c3698900496</td><td>2021-08-05 14:47:25</td><td>2021-08-05 14:38:43</td></tr><tr><td>2d8a2bcc45daedd343eadb4222885d12a221bebbf7f1d98f92cb233df0a4c1d4</td><td>2021-08-16 18:54:29</td><td>2021-08-16 18:45:22</td></tr><tr><td>16feaed6222ce4a1941ae0c32eabaf0ecf68c33c49544f71d431d1b70c4247fd</td><td>2021-08-03 15:46:42</td><td>2021-08-03 15:38:18</td></tr><tr><td>7af554fb260817350d33b801d9f0b8a638b831992f4b1b31c2bbdab875b211df</td><td>2021-06-25 17:49:48</td><td>2021-06-25 17:43:23</td></tr><tr><td>2d8a2bcc45daedd343eadb4222885d12a221bebbf7f1d98f92cb233df0a4c1d4</td><td>2021-08-16 18:54:29</td><td>2021-08-16 18:45:22</td></tr><tr><td>039d63a07372e6e17f9779ccffbafbf9a06a9402ade58fbec3b0b2f8d2038175</td><td>2021-07-19 13:57:22</td><td>2021-07-19 13:46:46</td></tr></tbody></table></figure>



<p>The timestamps seem coherent between themselves and we note that the compilation dates correspond with a gap of 5 to 10 minutes, suggesting a manual packing step.</p>



<p>We note that stage2 verifies the presence of a virtual machine by testing the presence of the following executables:</p>



<p><strong>&gt; vboxservice.exe ;</strong><br><strong>&gt; vboxtray.exe ;</strong><br><strong>&gt; vmtoolsd.exe ;</strong><br><strong>&gt; vmwaretray.exe ;</strong><br><strong>&gt; vmwareuser.exe ;</strong><br><strong>&gt; vmacthlp.exe ;</strong><br><strong>&gt; vmsrvc.exe ;</strong><br><strong>&gt; vmusrvc.exe ;</strong><br><strong>&gt; prl_cc.exe ;</strong><br><strong>&gt; prl_tools.exe ;</strong><br><strong>&gt; xenservice.exe ;</strong><br><strong>&gt; qemu-ga.exe ;</strong><br><strong>&gt; windanr.exe.</strong></p>



<p>Once the desobfuscation step is done, the binary is no longer obfuscated and easily delivers its secrets. For example C2 [11]:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image20.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 2096px; --smush-placeholder-aspect-ratio: 2096/408;" /><figcaption class="wp-element-caption">List of C2 URLs</figcaption></figure>



<p>Or encrypts list of files constituting the source code:</p>



<figure class="wp-block-image"><img decoding="async" data-src="https://tehtris.com/wp-content/uploads/2022/01/image21.png" alt="" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" style="--smush-placeholder-width: 3824px; --smush-placeholder-aspect-ratio: 3824/2486;" /><figcaption class="wp-element-caption">Source code metadata</figcaption></figure>



<p>The analysis of the stage2 has already been done, however, and we will not describe it here.</p>



<h2 class="wp-block-heading" id="conclusion">Conclusion</h2>



<p>Evading automated malware detection systems is a balancing act between binary entropy, hiding encryption functions, slowing down the analysis time, obtaining a consistent call/instruction ratio&#8230;</p>



<p>The use of Rust adds a machine code overlay which is however much less than what a Go [12], delphi [13], cython [14], etc. compiler would do, making a manual analysis quite reasonable.</p>



<p>However, these techniques are no match for a reverser or a well-configured sandbox. The manual analysis of the most known and least traceable threats is a plus in the continuous improvement of our sandbox and EDR products. It is very likely that in the future, more and more malware programs will be developed in Rust.</p>



<p>* The use of stageN consists in separating the malware program into several specialized sub-parts in order to escape antivirus detection. In this case, stage1 is the malware program as sent to victims and stage2 is the payload encapsulated in stage1.</p>



<h2 class="wp-block-heading" id="bibliography">BIBLIOGRAPHY</h2>



<p>[1] <a href="https://www.rust-lang.org/" target="_blank" rel="noopener">https://www.rust-lang.org/</a></p>



<p>[2] <a href="https://www.tiobe.com/tiobe-index/rust/" target="_blank" rel="noopener">https://www.tiobe.com/tiobe-index/rust/</a></p>



<p>[3] <a href="https://github.com/nuta/kerla" target="_blank" rel="noopener">https://github.com/nuta/kerla</a></p>



<p>[4] <a href="https://www.proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust" target="_blank" rel="noopener">https://www.proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust</a></p>



<p>[5] <a href="https://fr.wikipedia.org/wiki/Sandbox_(s%C3%A9curit%C3%A9_informatique)" target="_blank" rel="noopener">https://fr.wikipedia.org/wiki/Sandbox_(s%C3%A9curit%C3%A9_informatique)</a></p>



<p>[6] <a href="https://fr.wikipedia.org/wiki/Offuscation" target="_blank" rel="noopener">https://fr.wikipedia.org/wiki/Offuscation</a></p>



<p>[7] <a href="https://www.zynamics.com/bindiff.html" target="_blank" rel="noopener">https://www.zynamics.com/bindiff.html</a></p>



<p>[8] <a href="https://github.com/you0708/ida/tree/master/idapython_tools/findcrypt" target="_blank" rel="noopener">https://github.com/you0708/ida/tree/master/idapython_tools/findcrypt</a></p>



<p>[9] <a href="https://github.com/gendx/lzma-rs" target="_blank" rel="noopener">https://github.com/gendx/lzma-rs</a></p>



<p>[10] <a href="https://fr.wikipedia.org/wiki/G%C3%A9n%C3%A9rateur_de_nombres_pseudo-al%C3%A9atoires" target="_blank" rel="noopener">https://fr.wikipedia.org/wiki/G%C3%A9n%C3%A9rateur_de_nombres_pseudo-al%C3%A9atoires</a></p>



<p>[11] <a href="https://www.trendmicro.com/vinfo/us/security/definition/command-and-control-server" target="_blank" rel="noopener">https://www.trendmicro.com/vinfo/us/security/definition/command-and-control-server</a></p>



<p>[12] <a href="https://golang.org/" target="_blank" rel="noopener">https://golang.org/</a></p>



<p>[13] <a href="https://www.embarcadero.com/fr/products/delphi" target="_blank" rel="noopener">https://www.embarcadero.com/fr/products/delphi</a></p>



<p>[14] <a href="https://cython.org/">https://cython.org/</a></p>



<p>[15] <a href="https://www.virustotal.com">https://www.virustotal.com</a></p>



<p>[16] <a href="https://www.youtube.com/watch?v=4Lux_0IROMY">https://www.youtube.com/watch?v=4Lux_0IROMY</a></p>



<p>[17] <a href="https://www.unicorn-engine.org/" target="_blank" rel="noopener">https://www.unicorn-engine.org/</a></p>



<p>[18] <a href="https://github.com/tehtris-hub/MalwareTool/blob/main/Buer/extract_buer.py">https://github.com/tehtris-hub/MalwareTool/blob/main/Buer/extract_buer.py</a></p>



<p>[19] <a href="https://github.com/tehtris-hub/MalwareTool/blob/main/Buer/extract_buer_debug.py">https://github.com/tehtris-hub/MalwareTool/blob/main/Buer/extract_buer_debug.py</a></p>
        </div>
        <aside class="blog-single-sidebar">
            

    <div class="latest-articles">
        <h2 class="aside-title">Our latest articles</h2>

                    <div class="latest-article-item">
                <a href="https://tehtris.com/en/blog/healthcare-and-cybersecurity-why-the-industry-remains-a-prime-target-in-2025/" title="Read more : Healthcare and cybersecurity:  Why the industry remains a prime target in 2025">
                    <img width="150" height="150" data-src="https://tehtris.com/wp-content/uploads/2025/03/Healthcare-and-Cybersecurity-1-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" decoding="async" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="--smush-placeholder-width: 150px; --smush-placeholder-aspect-ratio: 150/150;" />                </a>

                <div class="latest-article-content">
                    <p class="latest-article-date">March 6, 2025</p>

                    <h3 class="latest-article-title">
                        <a class="latest-article-title-link" href="https://tehtris.com/en/blog/healthcare-and-cybersecurity-why-the-industry-remains-a-prime-target-in-2025/" title="Read more">
                            Healthcare and cybersecurity:  Why the industry remains a prime target in 2025                        </a>
                    </h3>
                </div>
            </div>

                    <div class="latest-article-item">
                <a href="https://tehtris.com/en/blog/cybersecurity-best-practices-for-small-medium-sized-businesses-smbs/" title="Read more : Cybersecurity best practices for Small Medium-sized Businesses (SMBs)">
                    <img width="150" height="150" data-src="https://tehtris.com/wp-content/uploads/2025/02/Cybersecurity-Best-Practices-for-SMBs-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" decoding="async" data-srcset="https://tehtris.com/wp-content/uploads/2025/02/Cybersecurity-Best-Practices-for-SMBs-150x150.jpg 150w, https://tehtris.com/wp-content/uploads/2025/02/Cybersecurity-Best-Practices-for-SMBs-300x300.jpg 300w, https://tehtris.com/wp-content/uploads/2025/02/Cybersecurity-Best-Practices-for-SMBs-1024x1024.jpg 1024w, https://tehtris.com/wp-content/uploads/2025/02/Cybersecurity-Best-Practices-for-SMBs-768x768.jpg 768w, https://tehtris.com/wp-content/uploads/2025/02/Cybersecurity-Best-Practices-for-SMBs.jpg 1200w" data-sizes="(max-width: 150px) 100vw, 150px" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="--smush-placeholder-width: 150px; --smush-placeholder-aspect-ratio: 150/150;" />                </a>

                <div class="latest-article-content">
                    <p class="latest-article-date">February 26, 2025</p>

                    <h3 class="latest-article-title">
                        <a class="latest-article-title-link" href="https://tehtris.com/en/blog/cybersecurity-best-practices-for-small-medium-sized-businesses-smbs/" title="Read more">
                            Cybersecurity best practices for Small Medium-sized Businesses (SMBs)                        </a>
                    </h3>
                </div>
            </div>

                    <div class="latest-article-item">
                <a href="https://tehtris.com/en/blog/why-focusing-on-chokepoints-can-help-soc-teams-to-do-more-with-less/" title="Read more : Why focusing on chokepoints can help SOC teams to do more with less">
                    <img width="150" height="150" data-src="https://tehtris.com/wp-content/uploads/2025/02/Why-focusing-on-chokepoints-can-help-SOC-teams-to-do-more-with-less--150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" decoding="async" data-srcset="https://tehtris.com/wp-content/uploads/2025/02/Why-focusing-on-chokepoints-can-help-SOC-teams-to-do-more-with-less--150x150.jpg 150w, https://tehtris.com/wp-content/uploads/2025/02/Why-focusing-on-chokepoints-can-help-SOC-teams-to-do-more-with-less--300x300.jpg 300w, https://tehtris.com/wp-content/uploads/2025/02/Why-focusing-on-chokepoints-can-help-SOC-teams-to-do-more-with-less--1024x1024.jpg 1024w, https://tehtris.com/wp-content/uploads/2025/02/Why-focusing-on-chokepoints-can-help-SOC-teams-to-do-more-with-less--768x768.jpg 768w, https://tehtris.com/wp-content/uploads/2025/02/Why-focusing-on-chokepoints-can-help-SOC-teams-to-do-more-with-less-.jpg 1200w" data-sizes="(max-width: 150px) 100vw, 150px" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="--smush-placeholder-width: 150px; --smush-placeholder-aspect-ratio: 150/150;" />                </a>

                <div class="latest-article-content">
                    <p class="latest-article-date">February 10, 2025</p>

                    <h3 class="latest-article-title">
                        <a class="latest-article-title-link" href="https://tehtris.com/en/blog/why-focusing-on-chokepoints-can-help-soc-teams-to-do-more-with-less/" title="Read more">
                            Why focusing on chokepoints can help SOC teams to do more with less                        </a>
                    </h3>
                </div>
            </div>

            </div>


            <div class="aside-subscribe">
                <h2 class="aside-title">Subscribe to the TEHTRIS newsletter.</h2>
                <p>Once a month, receive the essential news and cyber watch by subscribing to the TEHTRIS newsletter.</p>
                <a href="https://tehtris.com/en/forms/subscribe-to-our-newsletter/" class="btn btn-pink">Subscribe to the newsletter</a>
            </div>
        </aside>
    </main>


    <footer class="blog-single-featured">
        
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://tehtris.com/en/blog/how-to-keep-control-of-your-life-on-the-internet/" rel="prev"><span class="nav-link-label">Previous article</span> Keep control of your life on the Internet</a></div><div class="nav-next"><a href="https://tehtris.com/en/blog/ukraine-what-is-this-destructive-malware-disguised-as-ransomware/" rel="next"><span class="nav-link-label">Next article</span> Ukraine: what is this destructive malware disguised as ransomware?</a></div></div>
	</nav>
        

    <div class="similar-articles">
        <p class="similar-articles-subtitle">To explore the subject</p>
        <h2>Similar publications</h2>

        <div class="similar-articles-grid">
            
                
<article class="post-item ">
    <div class="post-item-content">
        <div class="post-item-tags">
            <span class="post-item-tags-item">CTI</span><span class="post-item-tags-item">Malware</span><span class="post-item-tags-item">Phishing</span>        </div>

        <h2 class="post-item-title">
            <a class="post-item-title-link" href="https://tehtris.com/en/blog/legionloader-exposed/">&#8220;LegionLoader&#8221; exposed !</a>
        </h2>

        <p class="post-item-excerpt">The hidden threat no one is talking about... Yet! Lefebvre Fabien (CTI), Pezier Pierre-Henri (CTI) LegionLoader,... <a class="post-item-excerpt-readmore" href="https://tehtris.com/en/blog/legionloader-exposed/">Read more</a></p>

        <p class="post-item-date"><span class="posted-on"><time class="entry-date published" datetime="2025-02-03T13:11:38+00:00">February 3, 2025</time></span></p>
    </div>

    <a class="post-item-image" href="https://tehtris.com/en/blog/legionloader-exposed/">
        <img width="768" height="768" data-src="https://tehtris.com/wp-content/uploads/2025/02/Legion-loader-blog-1-768x768.jpg" class="attachment-medium_large size-medium_large wp-post-image lazyload" alt="" decoding="async" data-srcset="https://tehtris.com/wp-content/uploads/2025/02/Legion-loader-blog-1-768x768.jpg 768w, https://tehtris.com/wp-content/uploads/2025/02/Legion-loader-blog-1-300x300.jpg 300w, https://tehtris.com/wp-content/uploads/2025/02/Legion-loader-blog-1-1024x1024.jpg 1024w, https://tehtris.com/wp-content/uploads/2025/02/Legion-loader-blog-1-150x150.jpg 150w, https://tehtris.com/wp-content/uploads/2025/02/Legion-loader-blog-1.jpg 1200w" data-sizes="(max-width: 768px) 100vw, 768px" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="--smush-placeholder-width: 768px; --smush-placeholder-aspect-ratio: 768/768;" />    </a>


</article>

            
                
<article class="post-item ">
    <div class="post-item-content">
        <div class="post-item-tags">
            <span class="post-item-tags-item">CTI</span><span class="post-item-tags-item">Malware</span><span class="post-item-tags-item">White Paper</span>        </div>

        <h2 class="post-item-title">
            <a class="post-item-title-link" href="https://tehtris.com/en/blog/cryptbot-downloader-a-deep-cryptanalysis/">Cryptbot downloader: A deep cryptanalysis</a>
        </h2>

        <p class="post-item-excerpt">Cryptbot is an advanced malware tool used in cyber-attacks, primarily targeting credentials, personal data, and cryptocurrency... <a class="post-item-excerpt-readmore" href="https://tehtris.com/en/blog/cryptbot-downloader-a-deep-cryptanalysis/">Read more</a></p>

        <p class="post-item-date"><span class="posted-on"><time class="entry-date published" datetime="2024-11-18T11:54:39+00:00">November 18, 2024</time></span></p>
    </div>

    <a class="post-item-image" href="https://tehtris.com/en/blog/cryptbot-downloader-a-deep-cryptanalysis/">
        <img width="768" height="768" data-src="https://tehtris.com/wp-content/uploads/2024/11/Cryptbot-blog-768x768.jpg" class="attachment-medium_large size-medium_large wp-post-image lazyload" alt="Cryptbot Downloader: a deep malware analysis" decoding="async" data-srcset="https://tehtris.com/wp-content/uploads/2024/11/Cryptbot-blog-768x768.jpg 768w, https://tehtris.com/wp-content/uploads/2024/11/Cryptbot-blog-300x300.jpg 300w, https://tehtris.com/wp-content/uploads/2024/11/Cryptbot-blog-1024x1024.jpg 1024w, https://tehtris.com/wp-content/uploads/2024/11/Cryptbot-blog-150x150.jpg 150w, https://tehtris.com/wp-content/uploads/2024/11/Cryptbot-blog.jpg 1200w" data-sizes="(max-width: 768px) 100vw, 768px" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="--smush-placeholder-width: 768px; --smush-placeholder-aspect-ratio: 768/768;" />    </a>


</article>

            
                
<article class="post-item ">
    <div class="post-item-content">
        <div class="post-item-tags">
            <span class="post-item-tags-item">CTI</span><span class="post-item-tags-item">Malware</span><span class="post-item-tags-item">Uncategorized</span>        </div>

        <h2 class="post-item-title">
            <a class="post-item-title-link" href="https://tehtris.com/en/blog/cracking-formbook-malware-blind-deobfuscation-and-quick-response-techniques/">Cracking Formbook malware: Blind deobfuscation and quick response techniques</a>
        </h2>

        <p class="post-item-excerpt">Threat analysts have to respond quickly to an attack. When dealing with well‐obfuscated code, shortcuts sometimes... <a class="post-item-excerpt-readmore" href="https://tehtris.com/en/blog/cracking-formbook-malware-blind-deobfuscation-and-quick-response-techniques/">Read more</a></p>

        <p class="post-item-date"><span class="posted-on"><time class="entry-date published" datetime="2024-11-13T09:06:18+00:00">November 13, 2024</time> - Updated on <time class="updated" datetime="2024-11-13T00:00:00+00:00">November 13, 2024</time></span></p>
    </div>

    <a class="post-item-image" href="https://tehtris.com/en/blog/cracking-formbook-malware-blind-deobfuscation-and-quick-response-techniques/">
        <img width="768" height="768" data-src="https://tehtris.com/wp-content/uploads/2024/09/TEHTRIS-Blog-Formbook-malware-768x768.jpg" class="attachment-medium_large size-medium_large wp-post-image lazyload" alt="" decoding="async" data-srcset="https://tehtris.com/wp-content/uploads/2024/09/TEHTRIS-Blog-Formbook-malware-768x768.jpg 768w, https://tehtris.com/wp-content/uploads/2024/09/TEHTRIS-Blog-Formbook-malware-300x300.jpg 300w, https://tehtris.com/wp-content/uploads/2024/09/TEHTRIS-Blog-Formbook-malware-1024x1024.jpg 1024w, https://tehtris.com/wp-content/uploads/2024/09/TEHTRIS-Blog-Formbook-malware-150x150.jpg 150w, https://tehtris.com/wp-content/uploads/2024/09/TEHTRIS-Blog-Formbook-malware.jpg 1200w" data-sizes="(max-width: 768px) 100vw, 768px" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="--smush-placeholder-width: 768px; --smush-placeholder-aspect-ratio: 768/768;" />    </a>


</article>

                    </div>
    </div>


    </footer>

</article>
    </div>

    </div>

    <footer id="footer" class="site-footer">
        <div class="site-footer-wrap container">

            <div class="footer-xdr">
                <div class="footer-xdr-products">
                    <p class="footer-xdr-products-title">TEHTRIS XDR AI PLATFORM</p>

                    <div class="footer-xdr-products-platform">
                                                    <a href="https://tehtris.com/en/platform/edr-endpoint-detection-response/" title="XDR/ EDR OPTIMUS" class="footer-product-item">
                                <img class="footer-product-pct" src="https://tehtris.com/wp-content/themes/tehtris/dist/images/products/gradient/pct-edr.svg" />
                                EDR OPTIMUS                            </a>
                                                    <a href="https://tehtris.com/en/platform/mtd-mobile-threat-defense/" title="XDR/ MTD" class="footer-product-item">
                                <img class="footer-product-pct" src="https://tehtris.com/wp-content/themes/tehtris/dist/images/products/gradient/pct-mtd.svg" />
                                MTD                            </a>
                                                    <a href="https://tehtris.com/en/platform/tehtris-siem/" title="XDR/ SIEM" class="footer-product-item">
                                <img class="footer-product-pct" src="https://tehtris.com/wp-content/themes/tehtris/dist/images/products/gradient/pct-siem.svg" />
                                SIEM                            </a>
                                                    <a href="https://tehtris.com/en/platform/tehtris-nta/" title="XDR/ NTA" class="footer-product-item">
                                <img class="footer-product-pct" src="https://tehtris.com/wp-content/themes/tehtris/dist/images/products/gradient/pct-nta.svg" />
                                NTA                            </a>
                                                    <a href="https://tehtris.com/en/platform/tehtris-deceptive-response/" title="XDR/ Honeypots" class="footer-product-item">
                                <img class="footer-product-pct" src="https://tehtris.com/wp-content/themes/tehtris/dist/images/products/gradient/pct-dr.svg" />
                                Honeypots                            </a>
                                                    <a href="https://tehtris.com/en/platform/soar-security-orchestration-automation-and-response/" title="XDR/ SOAR" class="footer-product-item">
                                <img class="footer-product-pct" src="https://tehtris.com/wp-content/themes/tehtris/dist/images/products/gradient/pct-soar.svg" />
                                SOAR                            </a>
                                                    <a href="https://tehtris.com/en/platform/cti-cyber-threat-intelligence/" title="XDR/ Threat Intelligence" class="footer-product-item">
                                <img class="footer-product-pct" src="https://tehtris.com/wp-content/themes/tehtris/dist/images/products/gradient/pct-cti.svg" />
                                CTI                            </a>
                                                    <a href="https://tehtris.com/en/platform/artificial-intelligence/" title="CYBERIA: Artificial intelligence" class="footer-product-item">
                                <img class="footer-product-pct" src="https://tehtris.com/wp-content/themes/tehtris/dist/images/products/gradient/pct-cyberia.svg" />
                                CYBERIA                            </a>
                                                    <a href="https://tehtris.com/en/platform/tehtris-ztr/" title="XDR/ ZTR" class="footer-product-item">
                                <img class="footer-product-pct" src="https://tehtris.com/wp-content/themes/tehtris/dist/images/products/gradient/pct-ztr.svg" />
                                ZTR                            </a>
                                            </div>
                </div>
                <div class="footer-xdr-label">
                    <img class="footer-xdr-label-logo lazyload" data-src="https://tehtris.com/wp-content/themes/tehtris/dist/images/logos/logo-afaq-27001.png" alt="ISO 27001" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
                    
                </div>

            </div>

            <div class="footer-main">

                <div class="footer-sitemap">
                    <nav class="menu-container"><ul class="sitemap-menu menu"><li id="sitemap-item-25512" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><span  class="lvl-0 sitemap-item-separator">XDR AI Platform</span>
<ul class="sub-menu">
	<li id="sitemap-item-107322" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><span  class="lvl-1 sitemap-item-separator">TEHTRIS XDR AI PLATFORM</span>
	<ul class="sub-menu">
		<li id="sitemap-item-111613" class="menu-item menu-item-type-post_type menu-item-object-cpt_products"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/platform/xdr-extended-detection-response/">TEHTRIS XDR AI PLATFORM</a></li>
		<li id="sitemap-item-111619" class="menu-item menu-item-type-post_type menu-item-object-cpt_products"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/platform/soar-security-orchestration-automation-and-response/">SOAR</a></li>
		<li id="sitemap-item-111620" class="menu-item menu-item-type-post_type menu-item-object-cpt_products"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/platform/cti-cyber-threat-intelligence/">Threat Intelligence</a></li>
		<li id="sitemap-item-111612" class="menu-item menu-item-type-post_type menu-item-object-cpt_products"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/platform/artificial-intelligence/">CYBERIA</a></li>
	</ul>
</li>
	<li id="sitemap-item-107355" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><span  class="lvl-1 sitemap-item-separator">Solutions</span>
	<ul class="sub-menu">
		<li id="sitemap-item-111614" class="menu-item menu-item-type-post_type menu-item-object-cpt_products"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/platform/edr-endpoint-detection-response/">EDR OPTIMUS</a></li>
		<li id="sitemap-item-111616" class="menu-item menu-item-type-post_type menu-item-object-cpt_products"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/platform/mtd-mobile-threat-defense/">MTD</a></li>
		<li id="sitemap-item-111618" class="menu-item menu-item-type-post_type menu-item-object-cpt_products"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/platform/tehtris-siem/">SIEM</a></li>
		<li id="sitemap-item-111617" class="menu-item menu-item-type-post_type menu-item-object-cpt_products"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/platform/tehtris-nta/">NTA</a></li>
		<li id="sitemap-item-111615" class="menu-item menu-item-type-post_type menu-item-object-cpt_products"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/platform/tehtris-deceptive-response/">Honeypots</a></li>
	</ul>
</li>
	<li id="sitemap-item-107362" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><a  class="lvl-1 sitemap-item-separator sitemap-item-link" href="https://tehtris.com/en/our-partners/ecosystem-by-tehtris/">ECOSYSTEM</a>
	<ul class="sub-menu">
		<li id="sitemap-item-107365" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/our-partners/ecosystem-by-tehtris/">Discover our ECOSYSTEM</a></li>
		<li id="sitemap-item-111621" class="menu-item menu-item-type-post_type menu-item-object-cpt_products"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/platform/tehtris-ztr/">ZTR</a></li>
	</ul>
</li>
	<li id="sitemap-item-107366" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><a  class="lvl-1 sitemap-item-separator sitemap-item-link" href="https://tehtris.com/en/use-cases/">Use cases</a>
	<ul class="sub-menu">
		<li id="sitemap-item-107371" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/use-cases/industry/">Industry</a></li>
		<li id="sitemap-item-107368" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/use-cases/critical-infrastructures/">Critical infrastructures</a></li>
		<li id="sitemap-item-107372" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/use-cases/public-administrations/">Public administrations</a></li>
		<li id="sitemap-item-107370" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/use-cases/healthcare/">Healthcare</a></li>
		<li id="sitemap-item-107367" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/use-cases/banking-insurance/">Banking &amp; Insurance</a></li>
		<li id="sitemap-item-107375" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/use-cases/transportation/">Transportation</a></li>
		<li id="sitemap-item-107374" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/use-cases/service-providers/">Service providers</a></li>
		<li id="sitemap-item-107373" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/use-cases/retail/">Retail</a></li>
		<li id="sitemap-item-107369" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/use-cases/education/">Education</a></li>
	</ul>
</li>
</ul>
</li>
<li id="sitemap-item-25401" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><span  class="lvl-0 sitemap-item-separator">Choosing TEHTRIS</span>
<ul class="sub-menu">
	<li id="sitemap-item-107381" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><a  class="lvl-1 sitemap-item-separator sitemap-item-link" href="https://tehtris.com/en/why-tehtris/">Why choose TEHTRIS?</a>
	<ul class="sub-menu">
		<li id="sitemap-item-107380" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/why-tehtris/">Why choose TEHTRIS?</a></li>
		<li id="sitemap-item-107382" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/why-tehtris/awards/">Awards &#038; certifications</a></li>
		<li id="sitemap-item-110237" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/why-tehtris/tehtris-cert/">TEHTRIS CERT </a></li>
	</ul>
</li>
	<li id="sitemap-item-107386" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><span  class="lvl-1 sitemap-item-separator">References</span>
	<ul class="sub-menu">
		<li id="sitemap-item-107385" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/why-tehtris/references/">References &#038; testimonials</a></li>
		<li id="sitemap-item-107384" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/why-tehtris/mitre-attack/">MITRE ATTACK</a></li>
		<li id="sitemap-item-107383" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/why-tehtris/gartner/">Gartner</a></li>
	</ul>
</li>
</ul>
</li>
<li id="sitemap-item-25467" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><span  class="lvl-0 sitemap-item-separator">Services</span>
<ul class="sub-menu">
	<li id="sitemap-item-111809" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><span  class="lvl-1 sitemap-item-separator">Services</span>
	<ul class="sub-menu">
		<li id="sitemap-item-111807" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/services/tehtris-cybersphere-mdr/">CyberSphere</a></li>
		<li id="sitemap-item-111808" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/services/tehtris-cybersphere-configurations/">CyberSphere Configurations</a></li>
	</ul>
</li>
	<li id="sitemap-item-107349" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><span  class="lvl-1 sitemap-item-separator">Cyber Intelligence</span>
	<ul class="sub-menu">
		<li id="sitemap-item-107346" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/services/expertise-cyber-renseignement/">Cyber &amp; Intelligence Expertise</a></li>
	</ul>
</li>
	<li id="sitemap-item-107350" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><span  class="lvl-1 sitemap-item-separator">Run et deployment support</span>
	<ul class="sub-menu">
		<li id="sitemap-item-107347" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/services/cybersecurity-academy/">Cybersecurity Academy</a></li>
	</ul>
</li>
</ul>
</li>
<li id="sitemap-item-107377" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><span  class="lvl-0 sitemap-item-separator">Partners</span>
<ul class="sub-menu">
	<li id="sitemap-item-107378" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><a  class="lvl-1 sitemap-item-separator sitemap-item-link" href="https://tehtris.com/en/our-partners/service-partners/">Service partners</a>
	<ul class="sub-menu">
		<li id="sitemap-item-107379" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/our-partners/service-partners/">MSSP</a></li>
		<li id="sitemap-item-110253" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/our-partners/distributing-partners/">Distributing partners</a></li>
		<li id="sitemap-item-107341" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/our-partners/tehtris-xcelerity/">TEHTRIS XCelerity</a></li>
	</ul>
</li>
	<li id="sitemap-item-107339" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><a  class="lvl-1 sitemap-item-separator sitemap-item-link" href="https://tehtris.com/en/our-partners/technology-partners/">Technology partners</a>
	<ul class="sub-menu">
		<li id="sitemap-item-107340" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/our-partners/ecosystem-by-tehtris/">ECOSYSTEM</a></li>
		<li id="sitemap-item-107342" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/our-partners/technology-partners/">Technology partners</a></li>
	</ul>
</li>
	<li id="sitemap-item-110285" class="menu-item menu-item-type-post_type_archive menu-item-object-cpt_affiliations"><a  class="lvl-1 sitemap-item-link" href="https://tehtris.com/en/affiliations/">Affiliations</a></li>
	<li id="sitemap-item-107337" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-1 sitemap-item-link" href="https://tehtris.com/en/our-partners/become-partner/">Becoming a partner</a></li>
</ul>
</li>
<li id="sitemap-item-107327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><span  class="lvl-0 sitemap-item-separator">Company</span>
<ul class="sub-menu">
	<li id="sitemap-item-107334" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><a  class="lvl-1 sitemap-item-separator sitemap-item-link" href="https://tehtris.com/en/company/">About us</a>
	<ul class="sub-menu">
		<li id="sitemap-item-107335" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/company/">Discover TEHTRIS</a></li>
		<li id="sitemap-item-107332" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/company/board-members/">Board Members</a></li>
		<li id="sitemap-item-107329" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/company/comex/">Comex</a></li>
		<li id="sitemap-item-107333" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/company/tehtris-teams/">TEHTRIS’ teams</a></li>
	</ul>
</li>
	<li id="sitemap-item-109871" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><span  class="lvl-1 sitemap-item-separator">Careers</span>
	<ul class="sub-menu">
		<li id="sitemap-item-107328" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/company/careers/">Our values</a></li>
		<li id="sitemap-item-110345" class="menu-item menu-item-type-custom menu-item-object-custom"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/company/careers/#join-us">Join us</a></li>
	</ul>
</li>
	<li id="sitemap-item-110343" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><span  class="lvl-1 sitemap-item-separator">News</span>
	<ul class="sub-menu">
		<li id="sitemap-item-108386" class="menu-item menu-item-type-post_type_archive menu-item-object-cpt_press"><a  class="lvl-2 sitemap-item-link" href="https://tehtris.com/en/press-releases/">TEHTRIS news</a></li>
	</ul>
</li>
	<li id="sitemap-item-107330" class="menu-item menu-item-type-post_type menu-item-object-page"><a  class="lvl-1 sitemap-item-link" href="https://tehtris.com/en/company/csr/">CSR</a></li>
</ul>
</li>
<li id="sitemap-item-108382" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><span  class="lvl-0 sitemap-item-separator">Resources</span>
<ul class="sub-menu">
	<li id="sitemap-item-108384" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent"><a  class="lvl-1 sitemap-item-link" href="https://tehtris.com/en/blog/">Blog</a></li>
	<li id="sitemap-item-109870" class="menu-item menu-item-type-custom menu-item-object-custom"><a  class="lvl-1 sitemap-item-link" href="https://tehtris.com/en/blog/#products">Products news</a></li>
	<li id="sitemap-item-108383" class="menu-item menu-item-type-post_type_archive menu-item-object-cpt_glossary"><a  class="lvl-1 sitemap-item-link" href="https://tehtris.com/en/glossary/">Glossary</a></li>
	<li id="sitemap-item-108387" class="menu-item menu-item-type-taxonomy menu-item-object-tax_assets"><a  class="lvl-1 sitemap-item-link" href="https://tehtris.com/en/assets/white-papers/">White papers</a></li>
	<li id="sitemap-item-108385" class="menu-item menu-item-type-post_type_archive menu-item-object-cpt_press"><a  class="lvl-1 sitemap-item-link" href="https://tehtris.com/en/press-releases/">Press releases</a></li>
</ul>
</li>
</ul></nav>                </div>

                <div class="footer-newsletter">

                    <p class="footer-newsletter-title">Cyber or not cyber ?</p>

                    <p class="footer-newsletter-subtile">Once a month, receive the essential news and cyber watch by subscribing to the TEHTRIS newsletter.</p>

                    <a href="https://tehtris.com/en/forms/subscribe-to-our-newsletter/" class="btn btn-pink">Subscribe to the newsletter</a>
                </div>
            </div>


            <div class="footer-nav">
    <div class="footer-menu">
        <div class="menu-footer-legal-en-container"><ul id="footer-navmenu" class="menu footer-navmenu"><li id="menu-item-32482" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32482"><a href="https://tehtris.com/en/legal-notice/">Legal notice</a></li>
<li id="menu-item-32483" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32483"><a href="https://tehtris.com/en/privacy-and-cookies-policy/">Privacy and cookies policy</a></li>
<li id="menu-item-35112" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35112"><a href="https://tehtris.com/en/legal-2/">Legal documents</a></li>
<li id="menu-item-32486" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32486"><a href="https://tehtris.com/en/contact/">Contact</a></li>
<li id="menu-item-34958" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-34958"><a href="https://tehtris.com/en/contact-dpo/">Contact DPO</a></li>
<li id="menu-item-35075" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35075"><a href="https://tehtris.com/en/forms/false-positives-false-negatives/">False positive/False negative</a></li>
</ul></div>    </div>
    <div class="social-link">
                        <a href="https://fr.linkedin.com/company/tehtris" title="LinkedIn" class="social-link-item" target="_blank">
                    <svg aria-hidden="true" class="social-link-pct">
                        <use href="https://tehtris.com/wp-content/themes/tehtris/dist/images/social/sprite.svg#linkedin-circle"></use>
                    </svg>
                    LinkedIn                </a>
                        <a href="https://twitter.com/tehtris" title="X" class="social-link-item" target="_blank">
                    <svg aria-hidden="true" class="social-link-pct">
                        <use href="https://tehtris.com/wp-content/themes/tehtris/dist/images/social/sprite.svg#x-circle"></use>
                    </svg>
                    X                </a>
                        <a href="https://www.youtube.com/channel/UCx-jYK12BPrEiMAX3V8K6dQ" title="YouTube" class="social-link-item" target="_blank">
                    <svg aria-hidden="true" class="social-link-pct">
                        <use href="https://tehtris.com/wp-content/themes/tehtris/dist/images/social/sprite.svg#youtube-circle"></use>
                    </svg>
                    YouTube                </a>
            </div>
</div>

        </div>
    </footer><!-- #footer -->
</div><!-- #page -->


<script>

function getCookie(name) {
    var dc = document.cookie;
    var prefix = name + "=";
    var begin = dc.indexOf("; " + prefix);
    if (begin == -1) {
        begin = dc.indexOf(prefix);
        if (begin != 0) return null;
    }
    else
    {
        begin += 2;
        var end = document.cookie.indexOf(";", begin);
        if (end == -1) {
        end = dc.length;
        }
    }
    // because unescape has been deprecated, replaced with decodeURI
    //return unescape(dc.substring(begin + prefix.length, end));
    return decodeURI(dc.substring(begin + prefix.length, end));
}

document.addEventListener( 'wpcf7mailsent', function ( event ) {
    //Retrieve form data
    var redirect_url;
    var contact_reason;
    var email;
    for (var i = 0; i < event.detail.inputs.length; i++) {
        var input = event.detail.inputs[i];
        if (input.name == "redirect") {
            redirect_url = input.value;
        }
        if (input.name == "contact_reason") {
            contact_reason = input.value;
        }
        if (input.name == "email") {
            email = input.value;
        }
    }

    var authorized_vendors = getCookie('axeptio_authorized_vendors');

    //If Google cookie accepted,set user_data and send event to gtag -> Update No check needed here, the check is made later in GTM
    //if (authorized_vendors.indexOf('google_ads') != -1) {

        var email = document.getElementById('text-email').value;
        email = email.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
        email = email.toLowerCase();
        gtag('set', 'user_data', {"email" : email});

        var event_name = 'wpcf7_submission_'+event.detail.formData.get('cf7_key');
        if (!!contact_reason && contact_reason != '') {
           event_name = 'wpcf7_submission_'+event.detail.formData.get('cf7_key')+'_'+contact_reason;
        }
        gtag( 'event', event_name, {
        'event_category': event.detail.contactFormId,
        'event_label': event.detail.unitTag,
        'form': event.detail.formData.get('cf7_key'),
        'contact_reason': contact_reason,
        } );
    //}
    //Redirect to Thank you Page (and if Salesforce cookie accepted, add email to the url)
    var complete_redirect_url = redirect_url;
    if (authorized_vendors.indexOf('salesforce') != -1) {
       complete_redirect_url = redirect_url+'?pi_list_email='+email;
    }
    setTimeout( () => {
        location = complete_redirect_url;
    }, 2000 ); // Wait for 2 seconds to redirect.

}, false );
</script>
<script src="https://tehtris.com/wp-content/themes/tehtris/libs/splide/dist/js/splide.min.js?ver=4.0.1" id="tehtris-dep-splide-js"></script>
<script src="https://tehtris.com/wp-content/themes/tehtris/dist/js/app.js?ver=1.0" id="tehtris-app-js"></script>
<script src="https://tehtris.com/wp-content/themes/tehtris/dist/js/navigation.js?ver=1.0" id="tehtris-nav-js"></script>
<script src="https://tehtris.com/wp-content/themes/tehtris/dist/js/blocks-control.js?ver=1.0" id="tehtris-blocks-js"></script>
<script src="https://tehtris.com/wp-content/themes/tehtris/dist/js/motions.js?ver=1.0" id="tehtris-motions-js"></script>
<script id="tehtris-ajax-posts-js-extra">
var ajax_posts_url = {"ajax_url":"https:\/\/tehtris.com\/wp-admin\/admin-ajax.php","nonce":"fbde8c5eca"};
</script>
<script src="https://tehtris.com/wp-content/themes/tehtris/dist/js/ajax-posts.js?ver=1.0" id="tehtris-ajax-posts-js"></script>
<script src="https://tehtris.com/wp-includes/js/dist/hooks.min.js?ver=4d63a3d491d11ffd8ac6" id="wp-hooks-js"></script>
<script src="https://tehtris.com/wp-includes/js/dist/i18n.min.js?ver=5e580eb46a90c2b997e6" id="wp-i18n-js"></script>
<script id="wp-i18n-js-after">
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>
<script src="https://tehtris.com/wp-content/plugins/contact-form-7/includes/swv/js/index.js?ver=6.0.5" id="swv-js"></script>
<script id="contact-form-7-js-before">
var wpcf7 = {
    "api": {
        "root": "https:\/\/tehtris.com\/wp-json\/",
        "namespace": "contact-form-7\/v1"
    }
};
</script>
<script src="https://tehtris.com/wp-content/plugins/contact-form-7/includes/js/index.js?ver=6.0.5" id="contact-form-7-js"></script>
<script id="wpcf7cf-scripts-js-extra">
var wpcf7cf_global_settings = {"ajaxurl":"https:\/\/tehtris.com\/wp-admin\/admin-ajax.php"};
</script>
<script src="https://tehtris.com/wp-content/plugins/cf7-conditional-fields/js/scripts.js?ver=2.5.10" id="wpcf7cf-scripts-js"></script>
<script src="https://www.google.com/recaptcha/api.js?render=6LeNj8oaAAAAADZWDUPxYlLzWVTpwSzX8q_wXfSC&amp;ver=3.0" id="google-recaptcha-js"></script>
<script src="https://tehtris.com/wp-includes/js/dist/vendor/wp-polyfill.min.js?ver=3.15.0" id="wp-polyfill-js"></script>
<script id="wpcf7-recaptcha-js-before">
var wpcf7_recaptcha = {
    "sitekey": "6LeNj8oaAAAAADZWDUPxYlLzWVTpwSzX8q_wXfSC",
    "actions": {
        "homepage": "homepage",
        "contactform": "contactform"
    }
};
</script>
<script src="https://tehtris.com/wp-content/plugins/contact-form-7/modules/recaptcha/index.js?ver=6.0.5" id="wpcf7-recaptcha-js"></script>
<script src="https://tehtris.com/wp-content/plugins/wp-smush-pro/app/assets/js/smush-lazy-load.min.js?ver=3.18.0" id="smush-lazy-load-js"></script>

</body>
</html>

