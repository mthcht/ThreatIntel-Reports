<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>Another Confluence Bites the Dust: Falling to ELPACO-team Ransomware &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='preconnect' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="afd0aa762872d24a6b1b3cf2-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.8.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\ud83d\udd25","\ud83d\udc26\u200b\ud83d\udd25")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/14.6/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.8.1/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.8.1/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.8.1/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.8.1' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<style id='akismet-widget-style-inline-css' type='text/css'>

			.a-stats {
				--akismet-color-mid-green: #357b49;
				--akismet-color-white: #fff;
				--akismet-color-light-grey: #f6f7f7;

				max-width: 350px;
				width: auto;
			}

			.a-stats * {
				all: unset;
				box-sizing: border-box;
			}

			.a-stats strong {
				font-weight: 600;
			}

			.a-stats a.a-stats__link,
			.a-stats a.a-stats__link:visited,
			.a-stats a.a-stats__link:active {
				background: var(--akismet-color-mid-green);
				border: none;
				box-shadow: none;
				border-radius: 8px;
				color: var(--akismet-color-white);
				cursor: pointer;
				display: block;
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen-Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', sans-serif;
				font-weight: 500;
				padding: 12px;
				text-align: center;
				text-decoration: none;
				transition: all 0.2s ease;
			}

			/* Extra specificity to deal with TwentyTwentyOne focus style */
			.widget .a-stats a.a-stats__link:focus {
				background: var(--akismet-color-mid-green);
				color: var(--akismet-color-white);
				text-decoration: none;
			}

			.a-stats a.a-stats__link:hover {
				filter: brightness(110%);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 0 2px rgba(0, 0, 0, 0.16);
			}

			.a-stats .count {
				color: var(--akismet-color-white);
				display: block;
				font-size: 1.5em;
				line-height: 1.4;
				padding: 0 13px;
				white-space: nowrap;
			}
		
</style>
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/14.6/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/14.6/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://c0.wp.com/p/jetpack/14.6/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://c0.wp.com/c/6.8.1/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://c0.wp.com/c/6.8.1/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/43853" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.8.1" />
<link rel="canonical" href="https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=43853' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2025%2F05%2F19%2Fanother-confluence-bites-the-dust-falling-to-elpaco-team-ransomware%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2025%2F05%2F19%2Fanother-confluence-bites-the-dust-falling-to-elpaco-team-ransomware%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="afd0aa762872d24a6b1b3cf2-text/javascript"></script>
		<script type="afd0aa762872d24a6b1b3cf2-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="afd0aa762872d24a6b1b3cf2-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=AF418ED4E93E1EA252CAE6F08A587E9C');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Another Confluence Bites the Dust: Falling to ELPACO-team Ransomware" />
<meta property="og:url" content="https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/" />
<meta property="og:description" content="Key Takeaways The threat actor first gained entry by exploiting a known vulnerability (CVE-2023-22527) on an internet-facing Confluence server, allowing for remote code execution. Using this access…" />
<meta property="article:published_time" content="2025-05-19T00:05:39+00:00" />
<meta property="article:modified_time" content="2025-05-19T11:09:45+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2025/05/30043_069-scaled.png" />
<meta property="og:image:width" content="2560" />
<meta property="og:image:height" content="1399" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Another Confluence Bites the Dust: Falling to ELPACO-team Ransomware" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2025/05/30043_069-scaled.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="wp-singular post-template-default single single-post postid-43853 single-format-standard custom-background wp-theme-freenews has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
		<li id="menu-item-43478" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-43478"><a href="https://thedfirreport.com/services/dfir-labs/testimonials/">Testimonials</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://dfirlabs.thedfirreport.com/">Access DFIR Labs</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	<li id="menu-item-43480" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-43480"><a href="https://thedfirreport.com/services/dfir-labs/testimonials/">Testimonials</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-43478"><a href="https://thedfirreport.com/services/dfir-labs/testimonials/">Testimonials</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://dfirlabs.thedfirreport.com/">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Thursday, May 22, 2025</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-43480"><a href="https://thedfirreport.com/services/dfir-labs/testimonials/">Testimonials</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-43853" class="post-43853 post type-post status-publish format-standard hentry category-elpacoteam category-mimic category-ransomware entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-141" href="https://thedfirreport.com/category/ransomware/elpacoteam/">elpacoteam</a>
		
			<a class="category-color-140" href="https://thedfirreport.com/category/ransomware/mimic/">mimic</a>
		
			<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">Another Confluence Bites the Dust: Falling to ELPACO-team Ransomware</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/" rel="bookmark"><time class="entry-date published" datetime="2025-05-19T00:05:39+00:00">May 19, 2025</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		
<h2 id="key" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#key">Key Takeaways</a></h2>



<ul class="wp-block-list">
<li>The threat actor first gained entry by exploiting a known vulnerability (CVE-2023-22527) on an internet-facing Confluence server, allowing for remote code execution.</li>



<li>Using this access, the threat actor executed a consistent sequence of commands (installing AnyDesk, adding admin users, and enabling RDP) multiple times, suggesting the use of automation scripts or a playbook.</li>



<li>Tools like Mimikatz, ProcessHacker, and Impacket Secretsdump were used to harvest credentials.</li>



<li>The intrusion culminated in the deployment of ELPACO-team ransomware, a Mimic variant, approximately 62 hours after the initial Confluence exploitation.</li>



<li>While ransomware was deployed and some event logs were deleted, no significant exfiltration of data was observed during the intrusion.</li>
</ul>
<p>This case was featured in our December 2024 <a href="https://thedfirreport.com/services/dfir-labs/ctf/" target="_blank" rel="noreferrer noopener">DFIR Labs CTF</a> and is available as a lab today <a href="https://store.thedfirreport.com/products/alpaca-ransomware-private-case-30043" target="_blank" rel="noreferrer noopener">here</a>. It was originally published as a <a href="https://thedfirreport.com/services/threat-intelligence/#threat-brief" target="_blank" rel="noreferrer noopener">Threat Brief</a> to customers in October 2024.</p>



<h2 class="wp-block-heading"><a href="https://thedfirreport.com/services/" target="_blank" rel="noreferrer noopener">The DFIR Report Services</a></h2>





<ul class="wp-block-list">
<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-brief" target="_blank" rel="noreferrer noopener">Private Threat Briefs</a>: 20+ private DFIR reports annually.</li>



<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-feed" target="_blank" rel="noreferrer noopener">Threat Feed</a>: Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc.</li>



<li><a href="https://thedfirreport.com/services/threat-intelligence/#all-intel" target="_blank" rel="noreferrer noopener">All Intel</a>: Includes everything from Private Threat Briefs and Threat Feed, plus private events, Threat Actor Insights reports, long-term tracking, data clustering, and other curated intel.</li>



<li><a href="https://thedfirreport.com/services/detection-rules/" target="_blank" rel="noreferrer noopener">Private Sigma Ruleset</a>: Features 170+ Sigma rules derived from 50+ cases, mapped to ATT&amp;CK with test examples.</li>



<li><a href="https://thedfirreport.com/services/dfir-labs/" target="_blank" rel="noreferrer noopener">DFIR Labs</a>: Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds.</li>
</ul>
<p><a href="https://thedfirreport.com/contact/" target="_blank" rel="noopener"><span style="font-size: 12.0pt;">Contact us</span></a><span style="font-size: 12.0pt;"> today for pricing or a demo!</span></p>



<h4 class="wp-block-heading">Table of Contents:</h4>



<ul class="wp-block-list">
<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#case-summary">Case Summary</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#analysts">Analysts</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#initial-access">Initial Access</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#execution">Execution</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#persistence">Persistence</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#privilege-escalation">Privilege Escalation</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#defense-evasion">Defense Evasion</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#credential-access">Credential Access</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#discovery">Discovery</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#lateral-movement">Lateral Movement</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#command-and-control">Command and Control</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#exfiltration">Exfiltration</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#impact">Impact</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#timeline">Timeline</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#diamond-model">Diamond Model</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#indicators">Indicators</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#detections">Detections</a></li>



<li><a href="https://thedfirreport.com/?p=43853&amp;preview=true#mitre">MITRE ATT&amp;CK</a></li>
</ul>



<h2 id="case-summary" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#case-summary">Case Summary</a></h2>



<p>In late June 2024, an unpatched Confluence server was compromised via CVE-2023-22527, a template injection vulnerability, first from IP address 45.227.254[.]124, which just ran whoami and exited. Shortly thereafter, a different IP address used the same exploit, running curl to deploy a Metasploit payload (Meterpreter) and establish a C2 channel to 91.191.209[.]46. The same IP address that delivered the initial Confluence exploit (used to run whoami) was later used to establish a direct AnyDesk connection.</p>



<p>On the second day of the intrusion, the threat actor initiated multiple AnyDesk sessions, each lasting only a few seconds to just under two minutes. No commands were executed, and no meaningful activity occurred during these brief connections. It remains unclear whether these short sessions were the result of technical issues with their AnyDesk server or a deliberate tactic.</p>



<p>On the fourth day, the threat actor started by focusing on privilege escalation. The threat actor first performed several unsuccessful attempts using various named pipe impersonation and token duplication techniques, they then successfully escalated to SYSTEM using the RPCSS variant of named pipe impersonation. This allowed the creation of a local administrator account (“noname”) and the re-installation of AnyDesk as a service (delivered via the Metasploit C2) for persistent remote access.</p>



<p>Having established an alternative means of access running as system, which then became their primary vector for the remainder of the intrusion, the threat actor pivoted to widespread discovery. This involved scanning the network and enumerating SMB shares using SoftPerfect’s NetScan to identify potential targets for lateral movement. After identifying the domain controllers the threat actor executed an unsuccessful series of attempts to exploit Zerologon (CVE-2020-1472) against them.</p>



<p>The threat actor then dropped tools focused on credential access, including Mimikatz, ProcessHacker, and Impacket’s Secretsdump. Minutes after utilizing these tools, the threat actor managed to compromise a domain administrator account, granting them widespread access and control within the target environment. That domain admin account was likely compromised through LSASS dumping, as evidenced by later use of NTLM hashes during lateral movement. The threat actor was also observed attempting to exploit PrintNightmare (CVE-2021-34527) using rpcdump.exe; this failed due to not meeting requirements, which we detail in this report.</p>



<p>Leveraging the compromised domain administrator credentials, the threat actor initiated lateral movement within the network, utilizing Impacket wmiexec and RDP to access additional systems. The threat actor also created a new SMB share on the initially compromised Confluence server to facilitate the next steps of the intrusion. This share contained a number of tools used for lateral movement and subsequent ransomware deployment.</p>



<p>The final stage of the intrusion involved the deployment of ransomware. Approximately 62 hours after the initial compromise of the Confluence server, the threat actor deployed ELPACO-team.exe, identified as a variant of Mimic ransomware, onto multiple servers, including backup and file servers by RDPing into them and executing the exe locally after copying it over SMB. While some data transfer was observed via the AnyDesk traffic, there was no evidence of collection or widespread data exfiltration prior to ransomware deployment.</p>



<p>If you would like to get an email when we publish a new report, please subscribe <a href="https://thedfirreport.com/subscribe/" target="_blank" rel="noreferrer noopener">here</a>.</p>



<h2 id="analysts" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#analysts">Analysts</a></h2>



<p>Analysis and reporting completed by <a href="https://bsky.app/profile/did:plc:gmu6ekgtpjtvt2g6go6yxrau" target="_blank" rel="noreferrer noopener">pcsc0ut</a>, <a href="https://bsky.app/profile/irishdeath.bsky.social" target="_blank" rel="noreferrer noopener">IrishDeath</a>, and <a href="https://twitter.com/0xtornado" target="_blank" rel="noreferrer noopener">Tornado</a></p>



<h2 id="initial-access" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#initial-access">Initial Access</a></h2>



<p>The intrusion began in June 2024 when a threat actor exploited CVE-2023-22527 against an unpatched Atlassian Confluence server that accepted incoming connection requests from the internet. The network traffic triggered a Suricata alert from the Emerging Threats open ruleset which was released in January 2024:</p>



<pre class="wp-block-preformatted">ET EXPLOIT Atlassian Confluence RCE Attempt Observed (CVE-2023-22527) M2 (sid 2050543) 
</pre>



<p>Logs from the server indicated that many other attempts to exploit this vulnerability against this server had been made over months from many other IP addresses. The most common command that was run was “whoami”. One such exploitation to run “whoami” occurred 20 minutes before this intrusion started, and came from IP address 45.227.254[.]124, evidenced in the network traffic capture below, and the Sysmon event logs from the Confluence server at the same time showing whoami.exe starting from parent process tomcat9.exe.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_001-scaled.png"><img fetchpriority="high" decoding="async" width="2560" height="1329" class="wp-image-43949" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_001-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_001-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_001-300x156.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_001-1024x532.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_001-768x399.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_001-1536x797.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_001-2048x1063.png 2048w" sizes="(max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: PCAP of network traffic showing Confluence exploitation of CVE-2023-22527</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_002.png"><img decoding="async" width="2380" height="183" class="wp-image-43948" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_002.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_002.png 2380w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_002-300x23.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_002-1024x79.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_002-768x59.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_002-1536x118.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_002-2048x157.png 2048w" sizes="(max-width: 2380px) 100vw, 2380px" /></a></figure></div>


<p style="text-align: center;">Figure: Sysmon logs of whoami.exe process starting with a parent process of tomcat9.exe</p>



<p>Approximately 20 minutes after the initial successful whoami command execution from 45.227.254[.]124, the intrusion commenced from a new IP address, 91.191.209[.]46, utilizing a slightly modified version of the exploit. It’s plausible that the exploitation script used in the second instance, which downloaded and executed the Metasploit payload, could have been derived from or inspired by publicly available proof-of-concept as seen <a href="https://github.com/rapid7/metasploit-framework/blob/9379a2af4f7dfd0e1f194a35fbc5d95483a89180/modules/exploits/multi/http/atlassian_confluence_rce_cve_2023_22527.rb" target="_blank" rel="noreferrer noopener">from this GitHub Repository</a>. The intruder exploited the vulnerability a second time to run the command:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_003.png"><img decoding="async" class="aligncenter size-full wp-image-43947" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_003.png" alt="" width="1855" height="132" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_003.png 1855w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_003-300x21.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_003-1024x73.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_003-768x55.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_003-1536x109.png 1536w" sizes="(max-width: 1855px) 100vw, 1855px" /></a></figure></div>

<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_004-scaled.png"><img loading="lazy" decoding="async" width="2560" height="602" class="wp-image-43946" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_004-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_004-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_004-300x71.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_004-1024x241.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_004-768x181.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_004-1536x361.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_004-2048x481.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: PCAP showing exploit to run curl and start the downloaded payload</p>



<p>The close timing of these events, coupled with the subsequent use of the original IP (45.227.254[.]124) as the intruder’s self-hosted AnyDesk server, strongly suggests these were not coincidental.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_005-scaled.png"><img loading="lazy" decoding="async" width="2560" height="215" class="wp-image-43945" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_005-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_005-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_005-300x25.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_005-1024x86.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_005-768x65.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_005-1536x129.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_005-2048x172.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Sysmon log showing child process of tomcat9.exe that started the intrusion</p>



<p>The download of the executable HAHLGiDDb.exe triggered several Suricata alerts, providing initial possible identification of the payload as either a Cobalt Strike Stager or Metasploit</p>



<pre class="wp-block-preformatted">ETPRO MALWARE Cobalt Strike Stager Payload
ET HUNTING PE EXE Download over raw TCP
ETPRO HUNTING Suspicious Offset PE EXE or DLL Download on Non-Standard Ports
ET MALWARE Possible Metasploit Payload Common Construct Bind_API (from server)
</pre>



<p>The file HAHLGiDDb.exe was saved to a path which is a suspicious location for executable files to be saved to or executed from:</p>



<pre class="wp-block-preformatted">C:\Windows\ServiceProfiles\NetworkService\AppData\Local\Temp\
</pre>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_006-scaled.png"><img loading="lazy" decoding="async" width="2560" height="162" class="wp-image-43944" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_006-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_006-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_006-300x19.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_006-1024x65.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_006-768x49.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_006-1536x97.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_006-2048x129.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Malicious exe file saved to NetworkService temp folder</p>



<p>The portable executable file HAHLGiDDb.exe was unusual in that it only imported two Windows API functions: VirtualAlloc and ExitProcess, and contained only the main entry point function and one other function.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_007.png"><img loading="lazy" decoding="async" width="1738" height="316" class="wp-image-43943" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_007.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_007.png 1738w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_007-300x55.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_007-1024x186.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_007-768x140.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_007-1536x279.png 1536w" sizes="auto, (max-width: 1738px) 100vw, 1738px" /></a></figure></div>


<p>Reverse engineering the binary using a debugger confirmed that it resolves the Windows library functions it requires dynamically at runtime, using hashes for obfuscation, and it closely matches the behavior and code patterns of a Metasploit shellcode loader as described in <a href="https://blog.nviso.eu/2021/09/02/anatomy-and-disruption-of-metasploit-shellcode/" target="_blank" rel="noreferrer noopener">this blog by Nviso</a>. This sample is different from that in the Nviso blog in that this sample is 64-bit code that downloads and attempts to inject a Meterpreter DLL into other processes, and the Nviso blog describes a 32-bit version that spawns a remote cmd shell.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_008.png"><img loading="lazy" decoding="async" width="2152" height="1460" class="wp-image-43942" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_008.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_008.png 2152w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_008-300x204.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_008-1024x695.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_008-768x521.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_008-1536x1042.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_008-2048x1389.png 2048w" sizes="auto, (max-width: 2152px) 100vw, 2152px" /></a></figure></div>


<p style="text-align: center;">Figure: Disassembled instructions from HAHLGiDDb.exe show patterns of Metasploit loader</p>



<h2 id="execution" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#execution">Execution</a></h2>



<p>The Metasploit loader, HAHLGiDDb.exe, connected to the same IP address that exploited the Confluence vulnerability to deliver the payload, 91.191.209[.]46 on TCP port 12385 to download the next stage payload. The payload, a Portable Executable (PE) file, was not encrypted and was easy to identify in network traffic.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_009-scaled.png"><img loading="lazy" decoding="async" width="2560" height="652" class="wp-image-43941" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_009-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_009-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_009-300x76.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_009-1024x261.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_009-768x196.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_009-1536x391.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_009-2048x522.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Downloading 2nd stage PE file (starting bytes 4d5a) from 91.191.209.46 port 12385</p>



<p>The PE file that was downloaded over port 12385 was a 64-bit Windows DLL format that had zero exported functions other than DllMain, which is the function that runs whenever a process loads the DLL. It is somewhat unusual for a legitimate DLL to have no exported functions, because the main point of a software library is to provide functions that the programs calling them can use.</p>



<p>The Metasploit loader saved the next stage payload as a DLL named nbjlop.dll in the same folder that the Metasploit loader ran from.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_010-scaled.png"><img loading="lazy" decoding="async" width="2560" height="151" class="wp-image-43940" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_010-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_010-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_010-300x18.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_010-1024x60.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_010-768x45.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_010-1536x90.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_010-2048x120.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Sysmon File Create log showing nbjlop.dll created by Metasploit loader</p>



<p>The Metasploit loader created a named pipe with the same name as the DLL file without the extension, \\nbjlop</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_011.png"><img loading="lazy" decoding="async" width="2471" height="174" class="wp-image-43939" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_011.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_011.png 2471w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_011-300x21.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_011-1024x72.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_011-768x54.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_011-1536x108.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_011-2048x144.png 2048w" sizes="auto, (max-width: 2471px) 100vw, 2471px" /></a></figure></div>


<p style="text-align: center;">Figure: Sysmon Event ID 17: pipe creation event</p>



<p>Throughout the intrusion, several new Metasploit loaders were delivered via the Confluence exploit and executed at different times. In every instance, the same pattern was observed: a randomly-named DLL file was dropped to disk followed by a pipe event at close to the same time using a pipe name that was the same as the DLL filename, without the .dll extension. The events are shown in the table below.</p>



<figure class="wp-block-table">
<table class="has-fixed-layout">
<tbody>
<tr>
<td>DLL File Path (Sysmon Event ID 11)</td>
<td>Pipe Name (Event ID 17)</td>
</tr>
<tr>
<td>C:\Windows\SERVIC~1\NETWOR~1\AppData\Local\Temp\nbjlop.dll</td>
<td>\\nbjlop</td>
</tr>
<tr>
<td>C:\Windows\SERVIC~1\NETWOR~1\AppData\Local\Temp\npixmw.dll</td>
<td>\\npixmw</td>
</tr>
<tr>
<td>C:\Windows\SERVIC~1\NETWOR~1\AppData\Local\Temp\cjlodi.dll</td>
<td>\\cjlodi</td>
</tr>
<tr>
<td>C:\Windows\SERVIC~1\NETWOR~1\AppData\Local\Temp\wucnic.dll</td>
<td>\\wucnic</td>
</tr>
</tbody>
</table>
</figure>



<p>Using Sigma, it is not possible to express a detection query that matches parts of strings between two types of events. However, many threat detection query languages include a JOIN query type and string manipulation functions. Consider crafting a threat hunting query to match DLL file creation events with pipe creation events after removing the extension from the DLL filename and removing the backslashes from the pipe name. In the investigation of this case, such a query yielded clean results including only the Metasploit activity, even though there were many DLL file creation events and many pipe creation events.</p>



<p>Approximately three minutes after the Metasploit loader process started, it downloaded AnyDesk.exe and saved it to the Atlassian Confluence program directory.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_012-scaled.png"><img loading="lazy" decoding="async" width="2560" height="143" class="wp-image-43938" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_012-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_012-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_012-300x17.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_012-1024x57.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_012-768x43.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_012-1536x86.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_012-2048x114.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Sysmon Event ID 11: AnyDesk.exe file created by Metasploit loader</p>



<p>Just over four minutes after the initial Metasploit payload was delivered, the threat actor again exploited Confluence to deliver another Metasploit loader and Meterpreter, following the same pattern as above, with the Metasploit EXE and DLL filenames randomized. The loader name this time was RfHBBgXXYF.exe, and it was downloaded to the same user profile temp folder as before.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_013-scaled.png"><img loading="lazy" decoding="async" width="2560" height="218" class="wp-image-43937" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_013-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_013-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_013-300x26.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_013-1024x87.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_013-768x65.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_013-1536x131.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_013-2048x174.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: curl command executed via Confluence exploit to deliver and execute Metasploit loader</p>



<p>One difference between the first Metasploit process and the second is that on the second attempt, the Metasploit loader created a cmd.exe process with no command line arguments, then proceeded to access that process and was granted access 0x1fffff, which means <strong><em>PROCESS_ALL_ACCESS. </em></strong>The Metasploit loader then created the batch file u1.bat in the Atlassian\Confluence folder in Program Files. The purpose of u1.bat is described in the Persistence section below.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_014-scaled.png"><img loading="lazy" decoding="async" width="2560" height="513" class="wp-image-43936" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_014-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_014-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_014-300x60.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_014-1024x205.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_014-768x154.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_014-1536x308.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_014-2048x410.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Metasploit loader starting cmd.exe and creating u1.bat</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_015-scaled.png"><img loading="lazy" decoding="async" width="2560" height="400" class="wp-image-43935" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_015-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_015-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_015-300x47.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_015-1024x160.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_015-768x120.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_015-1536x240.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_015-2048x320.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: PROCESS_ALL_ACCESS granted when Metasploit loader accessed cmd.exe</p>



<p>Less than eight minutes after the second Metasploit loader process was created, Confluence was exploited a third time and another Metasploit loader was delivered from the same IP address as the first two, this time with the randomized filename ZqYeqEZtohD.exe.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_016-scaled.png"><img loading="lazy" decoding="async" width="2560" height="307" class="wp-image-43934" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_016-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_016-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_016-300x36.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_016-1024x123.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_016-768x92.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_016-1536x184.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_016-2048x246.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Three commands from Confluence exploits delivering three Metasploit loaders</p>



<h2 id="persistence" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#persistence">Persistence</a></h2>



<p><strong>New User Accounts Created</strong></p>



<p>Less than one second after the Metasploit loader accessed the lsass process, a batch file named u1.bat was created in the Confluence folder C:\Program Files\Atlassian\Confluence\u1.bat. This file creation time was retrieved from a live memory snapshot of the infected system. The purpose of the u1.bat file was to create a new user account named “noname” with the password “Slepoy_123”, then use WMIC to find an administrators group, use net.exe (which calls net1.exe) to add the user to the admin group, then use WMIC to set the user’s password to never expire.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_017-scaled.png"><img loading="lazy" decoding="async" width="2560" height="443" class="wp-image-43933" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_017-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_017-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_017-300x52.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_017-1024x177.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_017-768x133.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_017-1536x266.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_017-2048x354.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Contents of the u1.bat file used to create a new user account and make it a local admin</p>



<p>Sysmon recorded the execution of the commands in this batch file. The local group name that matched SID ‘S-1-5-32-544’ was the default local “Administrators” group.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_018.png"><img loading="lazy" decoding="async" width="1602" height="561" class="wp-image-43932" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_018.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_018.png 1602w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_018-300x105.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_018-1024x359.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_018-768x269.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_018-1536x538.png 1536w" sizes="auto, (max-width: 1602px) 100vw, 1602px" /></a></figure></div>


<p>The Security event log recorded the user creation, enabling, modification, and password set events for user “noname” in event ID 4720, 4722, 4738, and 4724. Although it wasn’t observed during this intrusion, event ID 4741, which records the creation of computer accounts, is also essential, as threat actors can interactively use a computer account to log on and execute commands in the same manner that a user account can be utilized.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_019.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-43931" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_019.png" alt="" width="1851" height="408" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_019.png 1851w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_019-300x66.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_019-1024x226.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_019-768x169.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_019-1536x339.png 1536w" sizes="auto, (max-width: 1851px) 100vw, 1851px" /></a></p>





<p><strong>AnyDesk Service</strong></p>



<p>Within minutes of the new user account creation, the threat actor was observed dropping an AnyDesk binary into the Confluence installation directory (C:\Program Files\Atlassian\Confluence) from the HAHLGiDDb.exe process. Interestingly, the second Metasploit loader process also downloaded and saved AnyDesk.exe to the same folder a few minutes later. This suggests that these actions were part of an automation script.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_020.png"><img loading="lazy" decoding="async" width="714" height="212" class="wp-image-43930" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_020.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_020.png 714w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_020-300x89.png 300w" sizes="auto, (max-width: 714px) 100vw, 714px" /></a></figure></div>


<p>This initial AnyDesk binary was then executed via the command line, also spawned from the HAHLGiDDb.exe process, to install AnyDesk on the system as a service in the ProgramData directory:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_021.png"><img loading="lazy" decoding="async" width="1805" height="507" class="wp-image-43929" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_021.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_021.png 1805w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_021-300x84.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_021-1024x288.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_021-768x216.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_021-1536x431.png 1536w" sizes="auto, (max-width: 1805px) 100vw, 1805px" /></a></figure></div>


<p>Sysmon logs captured the creation of the newly installed AnyDesk service</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_022.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-43928" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_022.png" alt="" width="1502" height="201" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_022.png 1502w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_022-300x40.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_022-1024x137.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_022-768x103.png 768w" sizes="auto, (max-width: 1502px) 100vw, 1502px" /></a></figure></div>


<p>Installation triggered several Sysmon ‘FileCreate’ events as well when dropping new configuration files in the ‘<em>C:\Windows\SysWOW64\config\systemprofile\AppData\Roaming\AnyDesk\</em>‘ directory</p>



<p>Files Created:</p>



<ul class="wp-block-list">
<li>user.conf</li>



<li>ad.trace</li>



<li>system.conf</li>



<li>service.conf</li>
</ul>



<p>After the installation was completed, several more commands were run to finish the setup, including a command line to start the service immediately:</p>



<pre class="wp-block-preformatted">CommandLine: anydesk.exe  --start-service
</pre>



<p>The <a href="https://support.anydesk.com/knowledge/command-line-interface-for-windows" target="_blank" rel="noreferrer noopener">AnyDesk documentation</a> shows how command line arguments can be used to set up unattended access.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_023.png"><img loading="lazy" decoding="async" width="2036" height="841" class="wp-image-43927" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_023.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_023.png 2036w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_023-300x124.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_023-1024x423.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_023-768x317.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_023-1536x634.png 1536w" sizes="auto, (max-width: 2036px) 100vw, 2036px" /></a></figure></div>


<p>An argument to set the unattended access password for AnyDesk, as well as an echo command to provide the password “P@ssword1” to the AnyDesk password prompt:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_024.png"><img loading="lazy" decoding="async" width="769" height="755" class="wp-image-43926" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_024.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_024.png 769w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_024-300x295.png 300w" sizes="auto, (max-width: 769px) 100vw, 769px" /></a></figure></div>


<p style="text-align: center;">Figure: AnyDesk Command line to set unattended access password</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_025.png"><img loading="lazy" decoding="async" width="832" height="485" class="wp-image-43925" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_025.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_025.png 832w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_025-300x175.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_025-768x448.png 768w" sizes="auto, (max-width: 832px) 100vw, 832px" /></a></figure></div>


<p style="text-align: center;">Figure: Command line echo to send password “P@ssword1” to AnyDesk unattended password prompt.</p>



<p>Finally – as a part of the observed tradecraft, the threat actor ran a command to get the AnyDesk ID of the newly installed system (to be able to reconnect later):</p>



<pre class="wp-block-preformatted">ANYDESK.EXE  --GET-ID 
</pre>



<p>This sequence of events to set the AnyDesk unattended password occurred three times during the intrusion. The first two occurrences were just two minutes apart on day one, and the last time was on day three. The same password was set each time.</p>



<p><strong>Spider.dll</strong></p>



<p>On the third day of the intrusion, the threat actor, using an AnyDesk session, transferred a folder named “Attacker” from their host to the Desktop folder of a user on the Confluence server. A subfolder named “share” inside the “Attacker” folder contained two DLL files named “spider.dll” and “spider_32.dll”. Many other files were also in this folder.</p>



<p>The process that created the DLLs was explorer.exe. Reverse-engineering this DLL revealed its purpose. It contains a hard-coded username “Crackenn” and a hard-coded password “*aaa111Cracke” which are passed to the NetUserAdd Windows API function to add a local user account, then it adds the newly-created user account to the Administrators local group and the Remote Desktop Users local group. This username, password, and functionality match a <a href="https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/" target="_blank" rel="noreferrer noopener">report published by SentinelOne</a> about an intrusion that led to BlackBasta ransomware.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_026.png"><img loading="lazy" decoding="async" width="2455" height="1104" class="wp-image-43924" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_026.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_026.png 2455w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_026-300x135.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_026-1024x460.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_026-768x345.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_026-1536x691.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_026-2048x921.png 2048w" sizes="auto, (max-width: 2455px) 100vw, 2455px" /></a></figure></div>


<p style="text-align: center;">Figure: DllMain function of spider.dll</p>



<p>Note that no evidence was found in the security logs indicating that a user named “Crackenn” was created, authenticated, or used to run any programs during this incident, nor was there any evidence of spider.dll being executed using rundll32 or regsvr32.</p>



<h2 id="privilege-escalation" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#privilege-escalation">Privilege Escalation</a></h2>



<p><strong>Initial Exploit</strong></p>



<p>Upon initial access, the threat actor already had obtained NETWORK SERVICE level access as the Confluence web server (Tomcat) exploited was running under this more limited privilege:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_027.png"><img loading="lazy" decoding="async" width="992" height="580" class="wp-image-43923" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_027.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_027.png 992w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_027-300x175.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_027-768x449.png 768w" sizes="auto, (max-width: 992px) 100vw, 992px" /></a></figure></div>


<p><strong>Metasploit ‘getsystem’</strong></p>



<p>It appears in this case, the threat actor either attempted to getsystem using all methods, or at the very least attempted several methods that were observed in the logs.</p>



<p>With this initial limited privilege, the threat actor attempted two methods to escalate access. The first of which observed in the logs was the ‘ELEVATE_TECHNIQUE_SERVICE_NAMEDPIPE2’ method- or <strong>Named Pipe Impersonation (DLL Dropper Variant)</strong>. This elevation method was observed (as documented in the execution section) with the creation of a DLL/Named Pipe under the same name</p>



<ul class="wp-block-list">
<li>DLL Dropped: nbjlop.dll</li>



<li>Named Pipe: \nbjlop</li>
</ul>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_028.png"><img loading="lazy" decoding="async" width="1041" height="195" class="wp-image-43922" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_028.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_028.png 1041w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_028-300x56.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_028-1024x192.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_028-768x144.png 768w" sizes="auto, (max-width: 1041px) 100vw, 1041px" /></a></figure></div>


<p>Source code confirms that this module will use the ‘cpServiceName’ field to create the DLL and the Named Pipe fields:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_029.png"><img loading="lazy" decoding="async" width="1079" height="700" class="wp-image-43921" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_029.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_029.png 1079w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_029-300x195.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_029-1024x664.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_029-768x498.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_029-1000x650.png 1000w" sizes="auto, (max-width: 1079px) 100vw, 1079px" /></a></figure></div>


<p>This did not work, as the requirements for this to succeed is the initial shell must already be running under Administrator rights.</p>



<p>The second method observed in the logs was the <strong>Token Duplication </strong>method. From the documents, this method only requires the SeDebugPrivilege privilege (which the NETWORK SERVICE account does have), and iterates through all services to find one running under SYSTEM, then attempts to use reflective DLL Injection to run the elevator.dll in the memory of that service. We can see this activity in the logs with several SYSMON process access events, which stop at the first service accessed running under SYSTEM (lsass.exe):</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_030.png"><img loading="lazy" decoding="async" width="1689" height="208" class="wp-image-43920" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_030.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_030.png 1689w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_030-300x37.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_030-1024x126.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_030-768x95.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_030-1536x189.png 1536w" sizes="auto, (max-width: 1689px) 100vw, 1689px" /></a></figure></div>


<p>This also appears to have failed, despite having the correct permissions. According to <a href="https://docs.rapid7.com/metasploit/meterpreter-getsystem/#elevate_technique_service_tokendup" target="_blank" rel="noreferrer noopener">Rapid7’s documentation</a> – this method only currently works on x86 systems.</p>



<p>The final method observed, which worked, was the Named Pipe Impersonation (RPCSS Variant); this was observed with the creation of a second named pipe:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_031.png"><img loading="lazy" decoding="async" width="736" height="178" class="wp-image-43919" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_031.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_031.png 736w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_031-300x73.png 300w" sizes="auto, (max-width: 736px) 100vw, 736px" /></a></figure></div>


<p>From Rapid7’s documentation:</p>



<p><em>This technique will open a named pipe on the target, connects to and then impersonates itself. Due to how LSASS functions if the Meterpreter process is running as NT AUTHORITY\NETWORK SERVICE, this can yield the necessary privileges to open the RPCSS process which itself contains handles to NT AUTHORITY\SYSTEM tokens. Using the access to the RPCSS process, one of these tokens is selected and duplicated.</em></p>



<p>Shortly after the creation of this named pipe, the Metasploit payload (HAHLGiDDb.exe) was observed creating two cmd.exe sub-processes running under the SYSTEM privilege indicating successful escalation was obtained.</p>



<p>On day three of the intrusion, the threat actor used AnyDesk to drop Mimikatz and run it, as described later in the Credential Access section. Within 15 minutes of execution of Mimikatz, the threat actor was able to create a new interactive AnyDesk session session running under an existing domain administrator level account, potentially obtained from the Mimikatz output providing the final escalation required.</p>



<p><strong>Zerologon</strong></p>



<p>The threat actor made an unsuccessful attempt to escalate privileges by exploiting the Zerologon vulnerability (CVE-2020-1472). They utilized a tool named zero.exe, directing it against several domain controllers. The objective was to leverage the critical flaw in the Netlogon Remote Protocol to gain domain administrator privileges. The executed commands, aimed to verify successful exploitation by running the whoami command in an elevated context. Despite these efforts against the domain controllers, the Zerologon exploitation attempt was unsuccessful.</p>



<pre class="wp-block-preformatted">zero.exe [TARGET_DC_NETBIOS_NAME] [TARGET_DC_MACHINE_ACCOUNT$] administrator -c "whoami"
</pre>



<p>Suricata alerts fired during these attempts. If a successful exploit occurs then a total of three ET EXPLOIT rules will fire, in each instance only the first two of the three were recorded confirming failed exploit attempts.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_032.png"><img loading="lazy" decoding="async" width="1065" height="294" class="wp-image-43918" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_032.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_032.png 1065w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_032-300x83.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_032-1024x283.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_032-768x212.png 768w" sizes="auto, (max-width: 1065px) 100vw, 1065px" /></a></figure></div>


<h2 id="defense-evasion" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#defense-evasion">Defense Evasion</a></h2>



<p>The Metasploit loader process then accessed several other processes that were already running, including tomcat9.exe, conhost.exe, mysqld.exe, java.exe, and finally svchost.exe, as evidenced by Sysmon event ID 10 logs. The granted access for each event was 0x1f3fff, which indicates that full access was granted to the process. That access flag is used by many Sigma rules as an indication of suspicious process access preceding injection.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_033-scaled.png"><img loading="lazy" decoding="async" width="2560" height="491" class="wp-image-43917" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_033-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_033-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_033-300x58.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_033-1024x197.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_033-768x147.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_033-1536x295.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_033-2048x393.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Sysmon log: Metasploit loader accessing a svchost.exe process with full access 0x1f3fff</p>



<p>Near the end of the intrusion, the threat actor executed Defender Control, an executable they had previously downloaded to the Confluence server as “DC.exe”</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_034.png"><img loading="lazy" decoding="async" width="789" height="349" class="wp-image-43916" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_034.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_034.png 789w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_034-300x133.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_034-768x340.png 768w" sizes="auto, (max-width: 789px) 100vw, 789px" /></a></figure></div>


<p>This tool was used to stop Windows Defender Antivirus Service by setting the registry value to 1 at the following key:</p>



<pre class="wp-block-preformatted">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware
</pre>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_035.png"><img loading="lazy" decoding="async" width="2184" height="691" class="wp-image-43915" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_035.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_035.png 2184w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_035-300x95.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_035-1024x324.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_035-768x243.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_035-1536x486.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_035-2048x648.png 2048w" sizes="auto, (max-width: 2184px) 100vw, 2184px" /></a></figure></div>


<p>Following their initial activities, the threat actor took steps to ensure Remote Desktop Protocol (RDP) access to the compromised system. They began by querying the registry to identify the configured RDP port:</p>



<pre class="wp-block-preformatted">reg query "HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v PortNumber
</pre>



<p>Subsequently, they modified a key registry value to explicitly enable RDP connections by setting fDenyTSConnections to 0 :</p>



<pre class="wp-block-preformatted">reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0
</pre>



<p>To guarantee network connectivity, the actor then adjusted Windows Firewall settings using netsh advfirewall commands. This involved enabling the predefined “Remote Desktop” group of rules and adding a new specific inbound rule named “allow RDP” for TCP port 3389:</p>



<pre class="wp-block-preformatted">netsh advfirewall firewall set rule group="remote desktop" new enable=yes
netsh advfirewall firewall add rule name="allow RDP" dir=in protocol=TCP localport=3389 action=allow
</pre>



<p>These actions collectively aimed to establish reliable and unimpeded RDP access for the threat actor.</p>



<h2 id="credential-access" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#credential-access">Credential Access</a></h2>



<p>Just 30 seconds after the first Metasploit loader process started running, it created a remote thread in the Local Security Authority Subsystem (lsass.exe) process, detected in Sysmon event ID 8.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_036.png"><img loading="lazy" decoding="async" width="1598" height="869" class="wp-image-43914" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_036.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_036.png 1598w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_036-300x163.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_036-1024x557.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_036-768x418.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_036-1536x835.png 1536w" sizes="auto, (max-width: 1598px) 100vw, 1598px" /></a></figure></div>


<p style="text-align: center;">Figure: Sysmon Event ID 8: Remote Thread created in lsass.exe</p>



<p>Several SIGMA rules detected this activity:</p>



<pre class="wp-block-preformatted">Potential Shellcode Injection - proc_access_win_susp_potential_shellcode_injection.yml
Potentially Suspicious GrantedAccess Flags On LSASS - proc_access_win_lsass_susp_access_flag.yml
LSASS Access From Program In Potentially Suspicious Folder - proc_access_win_lsass_susp_source_process.yml
</pre>



<p><strong>Access to Domain User Credentials</strong></p>



<p>Once system privilege was obtained, AnyDesk was installed to obtain remote command and control. Upon connecting to an AnyDesk session on day three of the intrusion, the threat actor was able to obtain interactive access to a logged-on domain user account. Access to this user’s profile was used to drop additional tools into the Desktop folder and start the enumeration activity.</p>



<p>The threat actor used the AnyDesk session to drop mimikatz.exe (both 32-bit and 64-bit versions) and its associated drivers and library files on the Confluence server, as the SYSTEM user:</p>



<ul class="wp-block-list">
<li>mimikatz.exe</li>



<li>mimidrv.sys</li>



<li>mimilove.exe</li>



<li>mimilib.dll</li>
</ul>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_037-scaled.png"><img loading="lazy" decoding="async" width="2560" height="794" class="wp-image-43913" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_037-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_037-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_037-300x93.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_037-1024x318.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_037-768x238.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_037-1536x476.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_037-2048x635.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Sysmon FileCreate events showing Mimikatz files being created on the beachhead server</p>



<p>Along with these files, a simple batch script named !start.cmd which detects the OS architecture and runs the appropriate version of Mimikatz with command line arguments was also dropped.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_038-scaled.png"><img loading="lazy" decoding="async" width="2560" height="1622" class="wp-image-43912" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_038-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_038-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_038-300x190.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_038-1024x649.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_038-768x487.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_038-1536x973.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_038-2048x1298.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Contents of !start.cmd batch script</p>



<p>Just 30 seconds after dropping these files, the threat actor used the batch script to execute the 64-bit version with the following command line arguments:</p>



<pre class="wp-block-preformatted">.\mimikatz\x64\mimikatz.exe  "privilege::debug" "log .\!logs\Result.txt" "sekurlsa::logonPasswords" "token::elevate" "lsadump::sam" exit
</pre>



<p>The mimikatz.exe process accessed the Local Security Authority Subsystem Service (lsass.exe) to access credentials, and was granted access.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_039-scaled.png"><img loading="lazy" decoding="async" width="2560" height="145" class="wp-image-43911" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_039-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_039-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_039-300x17.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_039-1024x58.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_039-768x43.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_039-1536x87.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_039-2048x116.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Process Access event ID 10 showing mimikatz.exe accessing lsass.exe</p>



<p>The access granted flags 0x1010 translates to:</p>



<ul class="wp-block-list">
<li>PROCESS_QUERY_LIMITED_INFORMATION (0x1000)</li>



<li>PROCESS_VM_READ (0x0010)</li>
</ul>



<p>About 20 seconds after the 64-bit version of mimikatz.exe ran, the 32-bit version executed from the same folder, because the !start.cmd batch file runs both 64-bit and 32-bit versions when a 64-bit OS is detected. Then, about 24 minutes later, the 64-bit version of mimikatz.exe was run again from a different user account (a local administrator), followed by the 32-bit version 20 seconds later.</p>



<p>In all four executions of mimikatz, a Sysmon ProcessAccess event ID 10 was generated targeting lsass.exe with the granted access flags 0x1010.</p>



<p>Each time after running mimikatz, the threat actor used notepad.exe one or more times to view the contents of the “!logs\Result.txt” file containing the credential hashes dumped by mimikatz.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_040-scaled.png"><img loading="lazy" decoding="async" width="2560" height="722" class="wp-image-43910" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_040-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_040-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_040-300x85.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_040-1024x289.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_040-768x217.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_040-1536x433.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_040-2048x578.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: Notepad was used to view the Mimikatz output file after each execution</p>



<p>Further activity potentially related to credential access involved ProcessHacker, which was installed and run on a backup server 12 minutes after Mimikatz execution, and again on a file server 15 minutes thereafter. Sysmon logs (event ID 10) showed ProcessHacker.exe accessing lsass.exe as SYSTEM and being granted 0x1010 access on both occasions. Although this level of access is typical for tools attempting to dump credentials from LSASS, we did not observe corresponding file creation events to confirm an LSASS dump via ProcessHacker.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_041-scaled.png"><img loading="lazy" decoding="async" width="2560" height="211" class="wp-image-43909" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_041-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_041-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_041-300x25.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_041-1024x84.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_041-768x63.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_041-1536x127.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_041-2048x169.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p>Shortly after running Mimikatz, the threat actor ran a program named secretsdump.exe on the compromised Confluence server, providing NTLM hashes as authentication for user accounts. Most likely, the NTLM hashes came from the output of Mimikatz.</p>



<pre class="wp-block-preformatted">C:\Windows\system32\cmd.exe secretsdump.exe -hashes :[HASH REDACTED] [USERNAME REDACTED]@[IP ADDRESS REDACTED]
</pre>



<p>In a timespan of less than two minutes, the threat actor ran secretsdump.exe eight times, using combinations of two different usernames, two different IP addresses, and two different hashes.</p>



<p>Analysis of the secretsdump.exe file revealed it was a Python 2.7 script built into a Windows Portable Executable using PyInstaller. Using pyinstxtractor and uncompyle6, the embedded Python script secretsdump[.]py was extracted, and found to be the <a href="https://github.com/fortra/impacket/blob/master/examples/secretsdump.py" target="_blank" rel="noreferrer noopener">secretsdump.py</a> script from the <a href="https://github.com/fortra/impacket/tree/master" target="_blank" rel="noreferrer noopener">Impacket</a> suite of tools.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_042.png"><img loading="lazy" decoding="async" width="2124" height="1242" class="wp-image-43908" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_042.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_042.png 2124w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_042-300x175.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_042-1024x599.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_042-768x449.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_042-1536x898.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_042-2048x1198.png 2048w" sizes="auto, (max-width: 2124px) 100vw, 2124px" /></a></figure></div>


<p style="text-align: center;">Figure: Python script extracted from secretsdump.exe and decompiled</p>



<p>According to the comments in the latest secretsdump[.]py file on GitHub, the purpose of the script is to dump hashes from a remote machine without executing an agent on the remote machine:</p>



<pre class="wp-block-preformatted"># Description:
#   Performs various techniques to dump hashes from the
#   remote machine without executing any agent there.
#   For SAM and LSA Secrets (including cached creds)
#   we try to read as much as we can from the registry
#   and then we save the hives in the target system
#   (%SYSTEMROOT%\\Temp dir) and read the rest of the
#   data from there.
#   For NTDS.dit we either:
#       a. Get the domain users list and get its hashes
#          and Kerberos keys using [MS-DRDS] DRSGetNCChanges()
#          call, replicating just the attributes we need.
#       b. Extract NTDS.dit via vssadmin executed  with the
#          smbexec approach.
#          It's copied on the temp dir and parsed remotely.
#
#   The script initiates the services required for its working
#   if they are not available (e.g. Remote Registry, even if it is
#   disabled). After the work is done, things are restored to the
#   original state.
</pre>



<p>The command-line arguments handled by the version of the secretsdump[.]py that was embedded in the secretsdump.exe file are shown in the screenshot below. Even if the executable file had not so obviously been named secretsdump.exe, threat hunting or writing detections for the unique command line arguments used by common post-exploitation tools can be a powerful technique to detect malicious activity. The suite of tools in Impacket have been observed in many intrusions. Red Canary published a <a href="https://redcanary.com/threat-detection-report/threats/impacket/" target="_blank" rel="noreferrer noopener">useful blog on detection of Impacket tools</a>.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_043-scaled.png"><img loading="lazy" decoding="async" width="2560" height="1164" class="wp-image-43907" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_043-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_043-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_043-300x136.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_043-1024x466.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_043-768x349.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_043-1536x698.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_043-2048x931.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p>Another artifact produced by secretsdump.exe was a file named starting with “sessionresume_” followed by random characters, and no file extension:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_044-scaled.png"><img loading="lazy" decoding="async" width="2560" height="403" class="wp-image-43906" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_044-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_044-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_044-300x47.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_044-1024x161.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_044-768x121.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_044-1536x242.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_044-2048x322.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p>This artifact filename pattern is found in the Impacket secretsdump[.]py source code, which shows that the filename will always start with “sessionresume_” and end in 8 random ASCII letters:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_045.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-43905" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_045.png" alt="" width="2335" height="580" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_045.png 2335w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_045-300x75.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_045-1024x254.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_045-768x191.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_045-1536x382.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_045-2048x509.png 2048w" sizes="auto, (max-width: 2335px) 100vw, 2335px" /></a></figure></div>


<h2 id="discovery" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#discovery">Discovery</a></h2>



<p>Several discovery methods were observed in use throughout the attack chain to assist the threat actor in enumerating information about the environment. Many of the discovery commands were issued as a direct result of the initial Confluence exploit, originating from the Tomcat process itself.  These commands included running whoami, as well as directory listings of the host running the Confluence application:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_046.png"><img loading="lazy" decoding="async" width="782" height="794" class="wp-image-43904" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_046.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_046.png 782w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_046-295x300.png 295w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_046-768x780.png 768w" sizes="auto, (max-width: 782px) 100vw, 782px" /></a></figure></div>


<p>Figure: Web server sub-processes spawned from exploitation.</p>



<p><strong>Account Discovery Using DIR, WHOAMI, and NET</strong></p>



<p>On the second day of the intrusion, Confluence was exploited multiple times over a roughly twenty-minute period from the IP address 109.160.16.68. No link was found from this IP to the other activity detailed so far in the report leading us to assess this was likely a separate threat actor.The initial exploit attempts from this IP appeared designed to run the whoami command, likely to ascertain the Tomcat web server’s privileges. Interestingly, a typographical error was noted (“cmd.exe /c whaomi”), hinting at the possibility of manual input, though the direct attribution of this specific activity to the primary threat actor is uncertain. This was followed by several commands used to perform directory listings under the ‘c:\Users\’ path to identify valid account names:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_047.png"><img loading="lazy" decoding="async" width="1232" height="405" class="wp-image-43903" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_047.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_047.png 1232w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_047-300x99.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_047-1024x337.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_047-768x252.png 768w" sizes="auto, (max-width: 1232px) 100vw, 1232px" /></a></figure></div>


<p style="text-align: center;">Figure: PCAP of Confluence Exploit using DIR command to list user directories</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_048.png"><img loading="lazy" decoding="async" width="871" height="513" class="wp-image-43902" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_048.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_048.png 871w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_048-300x177.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_048-768x452.png 768w" sizes="auto, (max-width: 871px) 100vw, 871px" /></a></figure></div>


<p style="text-align: center;">Figure: Full listing of commands issued during a twenty-minute span of Discovery commands, including the “whaomi” typo</p>



<p>During this process, the threat actor also used the net.exe command to list members of the local ‘Administrators’ group, presumably to determine if any of the discovered users would be directly listed.</p>



<p>There were two other exploits of Confluence to run “whoami” also on day two, from these two IP addresses: 185.228.19[.]244, and 185.220.101[.]185. Because there were no follow-up commands from either of these IP addresses beyond the initial “whoami”, it is not possible to tell whether this activity was discovery related to the same threat actor or if it was random vulnerability scanning.</p>



<p><strong>NetScan</strong></p>



<p>On the third day of the intrusion – the threat actor dropped netscan in a users Desktop folder on the beachhead while connected to an interactive session via AnyDesk. Shortly after the file was created, the threat actor then initiated a scan of the local subnet, scanning ports:</p>



<ul class="wp-block-list">
<li>88/tcp (kerberos)</li>



<li>137/tcp (nbns)</li>



<li>445/tcp (smb)</li>



<li>3389/tcp (rdp)</li>



<li>6160/tcp (veeam agent)</li>
</ul>



<p>Additionally, during this scan, netscan was configured to check SMB access (read/write) on any network shares discovered. This generated a Security log event 5145, with the tell-tale netscan file ‘delete[.]me’ being created, and tripped a DFIR Report Sigma rule ‘NetScan Share Enumeration Write Access Check’:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_049.png"><img loading="lazy" decoding="async" width="1122" height="380" class="wp-image-43901" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_049.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_049.png 1122w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_049-300x102.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_049-1024x347.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_049-768x260.png 768w" sizes="auto, (max-width: 1122px) 100vw, 1122px" /></a></figure></div>


<p>This process was repeated later in the same day by the threat actor once a ‘Domain Admin’ level account was acquired using a similar pattern (netscan being dropped to the desktop, same scanning profile and same targets).</p>



<p><strong>RPCDUMP (PrintNightmare Vulnerability Discovery)</strong></p>



<p>On the third day of the intrusion, the threat actor attempted to enumerate RCP endpoints available on two IP addresses, both associated with Domain Controller systems, using a tool named rpcdump.exe, <a href="https://github.com/fortra/impacket/blob/master/examples/rpcdump.py" target="_blank" rel="noreferrer noopener">which is a component of the impacket tool </a>designed to map DCE/RPC endpoints compiled for Windows. In this particular case, the rpcdump.exe was automated with a batch script, combined to look for specific output (as indicated by the findstr /C:”MS-RPRN” /C:”MS-PAR” string) that could show if either of the two RPC endpoints is available on the target systems:</p>



<ul class="wp-block-list">
<li>MS-RPRN – The Print System Remote Protocol</li>



<li>MS-PAR – The Print System Asynchronous Remote Protocol</li>
</ul>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_050.png"><img loading="lazy" decoding="async" width="1012" height="216" class="wp-image-43900" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_050.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_050.png 1012w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_050-300x64.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_050-768x164.png 768w" sizes="auto, (max-width: 1012px) 100vw, 1012px" /></a></figure></div>


<p style="text-align: center;">Figure: CheckVuln.bat Script Contents</p>



<p>Because the systems targeted with this script were observed to be Domain Controllers, the threat actor was likely looking for systems vulnerable to the PrintNightmare (CVE-2021-34527) vulnerability.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_051.png"><img loading="lazy" decoding="async" width="1124" height="509" class="wp-image-43899" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_051.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_051.png 1124w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_051-300x136.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_051-1024x464.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_051-768x348.png 768w" sizes="auto, (max-width: 1124px) 100vw, 1124px" /></a></figure></div>


<p>Figure: Process Tree Created when CheckVuln.bat was run</p>



<p>An analysis of the DCE/RPC Lookup response from the DC indicated that neither of these endpoints seemed to be active among the 473 returned entries.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_052.png"><img loading="lazy" decoding="async" width="937" height="527" class="wp-image-43898" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_052.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_052.png 937w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_052-300x169.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_052-768x432.png 768w" sizes="auto, (max-width: 937px) 100vw, 937px" /></a></figure></div>


<p style="text-align: center;">Figure: DCE/RCP Endpoint Mapper Lookup Response from Domain Controller</p>



<h2 id="lateral-movement" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#lateral-movement">Lateral Movement</a></h2>



<p>The threat actor heavily used wmiexec to run commands remotely on a domain controller from the Confluence server initially exploited. All the commands on the domain controller were child processes of wmiprvse.exe.</p>



<p><strong>WMIEXEC</strong></p>



<p>Shortly after executing mimikatz and testing the credentials with secretsdump.exe, the threat actor dropped a secondary tool (wmiexec.exe) from the Explorer process (from AnyDesk copy/paste session capability which supports both file and text) – this is confirmed in the ad.trace file located in the user directory (<em>c:\users\%USERNAME%\AppData\Roaming\AnyDesk\ad.trace</em>). For each tool/file transfer event initiated via the copy/paste functionality in AnyDesk, there are a set of corresponding logs that indicate a file transfer has been initiated from the threat actor’s machine to the victim machine:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_053.png"><img loading="lazy" decoding="async" width="1386" height="210" class="wp-image-43897" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_053.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_053.png 1386w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_053-300x45.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_053-1024x155.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_053-768x116.png 768w" sizes="auto, (max-width: 1386px) 100vw, 1386px" /></a></figure></div>


<p>This corresponds with a sysmon ‘FileCreate’ event type for the creation of the wmiexec.exe tool:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_054.png"><img loading="lazy" decoding="async" width="637" height="189" class="wp-image-43896" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_054.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_054.png 637w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_054-300x89.png 300w" sizes="auto, (max-width: 637px) 100vw, 637px" /></a></figure></div>


<p>Initially, the threat actor issued two commands to test hashes using a Pass-the-Hash technique obtained against two domain controllers:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_055.png"><img loading="lazy" decoding="async" width="557" height="47" class="wp-image-43895" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_055.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_055.png 557w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_055-300x25.png 300w" sizes="auto, (max-width: 557px) 100vw, 557px" /></a></figure></div>


<p>After the threat actor obtained access to an account with domain administrator rights, the wmiexec.exe command was slightly altered to create an interactive command prompt on the remote domain controller:</p>



<pre class="wp-block-preformatted">C:\Windows\system32\cmd.exe wmiexec.exe :NTLM_HASH domain_admind@dc_ip
</pre>



<p>On the domain controller – this interactive command prompt was used to issue several commands, which included listing current user (whoami), and eventually adding a new user (NONAME) to the domain (and to several privileged groups):</p>



<pre class="wp-block-preformatted">C:\WINDOWS\SYSTEM32\NET1  USER NONAME SLEPOY_123 /DOMAIN /ADD 
C:\WINDOWS\SYSTEM32\NET1  GROUP "DOMAIN ADMINS" NONAME /DOMAIN /ADD 
C:\WINDOWS\SYSTEM32\NET1  GROUP "ENTERPRISE ADMINS" NONAME /DOMAIN /ADD 
</pre>



<p>These wmiexec commands were observed on the remote side (domain controller) as a type of redirection command to the local admin share. For example, when running the ‘whoami’ command, the command was redirected to a local file created in the ADMIN$ directory:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_056.png"><img loading="lazy" decoding="async" width="524" height="358" class="wp-image-43894" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_056.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_056.png 524w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_056-300x205.png 300w" sizes="auto, (max-width: 524px) 100vw, 524px" /></a></figure></div>


<p>There was a corresponding “FileCreate” event in the sysmon logs, which matched the redirect file name that was created (file name was the epoch timestamp for when the command was issued):</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_057.png"><img loading="lazy" decoding="async" width="859" height="178" class="wp-image-43893" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_057.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_057.png 859w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_057-300x62.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_057-768x159.png 768w" sizes="auto, (max-width: 859px) 100vw, 859px" /></a></figure></div>


<p>On the remote target side (domain controller) – several existing SIGMA rules detected this activity:</p>



<pre class="wp-block-preformatted">proc_creation_win_wmiprvse_spawning_process.yml
proc_creation_win_cmd_redirect.yml
proc_creation_win_hktl_impacket_lateral_movement.yml
proc_creation_win_susp_redirect_local_admin_share.yml
</pre>



<p><strong>Create Share/Enable SMBv2</strong></p>



<p>From the beachhead – the threat actor uploaded a tool set that included several exploits as well as batch scripts to automate running these tools:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_058.png"><img loading="lazy" decoding="async" width="537" height="614" class="wp-image-43892" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_058.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_058.png 537w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_058-262x300.png 262w" sizes="auto, (max-width: 537px) 100vw, 537px" /></a></figure></div>


<p>In order to make these tools accessible to other targets on the network, one of these batch scripts automated setting up an SMB share on the beachhead. This script created a local share (named ‘share’), set permissions to enable/ensure access, and rebooted the machine:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_059.png"><img loading="lazy" decoding="async" width="1336" height="1028" class="wp-image-43891" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_059.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_059.png 1336w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_059-300x231.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_059-1024x788.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_059-768x591.png 768w" sizes="auto, (max-width: 1336px) 100vw, 1336px" /></a></figure></div>


<p>Windows Security Event ID 5142 can be used to identify the creation of new network shares:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_060.png"><img loading="lazy" decoding="async" width="621" height="518" class="wp-image-43890" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_060.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_060.png 621w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_060-300x250.png 300w" sizes="auto, (max-width: 621px) 100vw, 621px" /></a></figure></div>


<p>Shortly after the execution of the batch script, the threat actor was observed restarting the system to ensure all the changes took effect:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_061.png"><img loading="lazy" decoding="async" width="793" height="432" class="wp-image-43889" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_061.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_061.png 793w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_061-300x163.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_061-768x418.png 768w" sizes="auto, (max-width: 793px) 100vw, 793px" /></a></figure></div>


<p>Additionally, several SIGMA rules tripped when the batch script was run that can be useful in detecting this activity:</p>



<pre class="wp-block-preformatted">proc_creation_win_net_share_unmount.yml (deletion of existing share)
proc_creation_win_susp_file_permission_modifications.yml (creation of share)
proc_creation_win_net_start_service.yml (Starting LanManServer and LanManWorkstation)
</pre>



<p><strong>Remote Desktop Protocol</strong></p>



<p>After the threat actor obtained a domain account with administrative privilege, they were observed using RDP to move laterally to a file server as well as a backup server.</p>



<p>Of note, in at least one instance, the threat actor used the discovery mapping conducted from the Netscan discovery tool to launch the RDP session. This is GUI feature offered in Netscan that allows the user to choose options on a discovered host and launch any number of pre-configured commands:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_062.png"><img loading="lazy" decoding="async" width="1095" height="635" class="wp-image-43888" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_062.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_062.png 1095w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_062-300x174.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_062-1024x594.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_062-768x445.png 768w" sizes="auto, (max-width: 1095px) 100vw, 1095px" /></a></figure></div>

<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_063.png"><img loading="lazy" decoding="async" width="1005" height="788" class="wp-image-43887" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_063.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_063.png 1005w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_063-300x235.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_063-768x602.png 768w" sizes="auto, (max-width: 1005px) 100vw, 1005px" /></a></figure></div>


<p>This can be observed on the beachhead side in process creation events – Security Event Logs (event ID 4688) or Sysmon Event Logs (event ID 1) – when netscan.exe is observed spawning a sub-process of mstsc when the threat actor clicked the “Remote Desktop” option and launched a RDP session with the backup server:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_064.png"><img loading="lazy" decoding="async" width="1003" height="429" class="wp-image-43886" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_064.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_064.png 1003w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_064-300x128.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_064-768x328.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_064-1000x429.png 1000w" sizes="auto, (max-width: 1003px) 100vw, 1003px" /></a></figure></div>


<p>SIGMA rule to detect mstsc.exe being spawned by netscan.exe</p>



<h2 id="command-and-control" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#command-and-control">Command and Control</a></h2>



<p><strong>Metasploit and Meterpreter</strong></p>



<p>Metasploit was used to exploit the Confluence server and deliver a Meterpreter executable payload via curl, which was then immediately executed. This was repeated three times during the intrusion. Each time, the executable payload was downloaded from IP address 91.191.209[.]46, and the Meterpreter payload connected to the same IP address on port 12385. This IP address appears on many threat feeds including Open Threat Exchange associated with vulnerability scanning and RDP scanning.</p>



<p>The client (Meterpreter running on the victim) started many of its connections to the server by sending a consistent pattern of 27 bytes, exactly the same each time, then one byte that was different, then 4 bytes that were consistent each time the client sent a packet to the server. This is illustrated in the screenshot below. The consistent bytes are outlined in a red box and the byte that was different each time is outlined in a blue box.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_065.png"><img loading="lazy" decoding="async" width="1773" height="1239" class="wp-image-43885" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_065.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_065.png 1773w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_065-300x210.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_065-1024x716.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_065-768x537.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_065-1536x1073.png 1536w" sizes="auto, (max-width: 1773px) 100vw, 1773px" /></a></figure></div>


<p>Figure: Screenshot from Wireshark showing client communication (in red shading) and server replies (in blue shading) between the victim Confluence host and the Metasploit server 91.191.209[.]46 on port 12385</p>



<p>The network communication with the Metasploit server triggered the following Suricata signature from the Emerging Threats ruleset (sid 2025644):</p>



<p>ET MALWARE Possible Metasploit Payload Common Construct Bind_API (from server)</p>



<p>The Command and Control traffic to the Metasploit server used raw TCP sockets, not HTTP or other common protocols. The connections did not last very long, only about 13 minutes between Confluence exploitation and closing the Metasploit C2 connection, and the threat actor appeared to favor using Metasploit just to run an initial set of commands, and to deliver AnyDesk, then continued most of the intrusion activity over AnyDesk.</p>



<p><strong>AnyDesk</strong></p>



<p>AnyDesk software can be used with either Cloud servers, or “On-Prem” (self-hosted) servers. The threat actor hosted their own On-Prem AnyDesk server at IP address 45.227.254[.]124 (port 443), which was the same IP address that exploited the Confluence vulnerability to run “whoami” 20 minutes before the Metasploit payload was delivered using the same vulnerability.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_066.png"><img loading="lazy" decoding="async" width="2029" height="1400" class="wp-image-43884" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_066.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_066.png 2029w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_066-300x207.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_066-1024x707.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_066-768x530.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_066-1536x1060.png 1536w" sizes="auto, (max-width: 2029px) 100vw, 2029px" /></a></figure></div>


<p style="text-align: center;">Figure: AnyDesk Certificate Exchange with Threat Actor’s AnyDesk server 45.227.254.124</p>



<p>Neither Censys nor Shodan had any history of scan data for this IP address. Neither VirusTotal nor AlienVault Open Threat Exchange had any reporting of threat activity associated with this IP. However, scan results from <a href="http://fofa.info" target="_blank" rel="noreferrer noopener">fofa.info</a> showed that less than one month after the intrusion activity, this host was presenting a self-signed certificate on port 3389 with certificate serial number 104770999709883145161872575332968665437 and common name “D-422”</p>



<p>During the intrusion, the threat actor utilized AnyDesk’s <a href="https://support.anydesk.com/knowledge/settings" target="_blank" rel="noreferrer noopener">Direct Connection</a> feature to establish a connection to a threat actor’s controlled server at IP address 45.227.254.124, bypassing AnyDesk’s relay servers. This direct connection method suggests an attempt to evade detection by network security tools that might otherwise monitor traffic routed through AnyDesk’s central infrastructure. Connecting directly to an external server under their control allows the threat actor to exfiltrate data or control the compromised system more discreetly.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_067.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-43883" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_067.png" alt="" width="1723" height="590" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_067.png 1723w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_067-300x103.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_067-1024x351.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_067-768x263.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_067-1536x526.png 1536w" sizes="auto, (max-width: 1723px) 100vw, 1723px" /></a></p>





<h2 id="exfiltration" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#exfiltration">Exfiltration</a></h2>



<p>In an unusual turn for a ransomware incident, there was no extensive file exfiltration before the ransomware was deployed to encrypt files. While some individual files might have been taken through AnyDesk, there were no large archives created, nor was there a significant data transfer to external IP addresses, as indicated by netflow records. A total of just under 70 MB was exchanged in both directions between the threat actor’s AnyDesk server and the compromised network, including all remote desktop screen images, as well as the ransomware and other tools sent to the affected systems.</p>



<h2 id="impact" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#impact">Impact</a></h2>



<p>On the third day of the intrusion, about 62 hours after the initial exploit of the Confluence server, the threat actor used an AnyDesk session to drop a file named ELPACO-team.exe on the Confluence server, but did not immediately execute it. Less than one minute later, the threat actor used RDP to connect from the Confluence server to a backup server, using the “noname” user account that they had previously created using the “u1.bat” script, and using the RDP session, they copied the ELPACO-team.exe file to the backup server in the folder D:\Admin\, then executed it on the backup server.</p>



<p>During sandbox execution, we found that the ransomware binary executes with a graphical user interface as depicted in the screenshots below:</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_068-scaled.png"><img loading="lazy" decoding="async" width="2560" height="1407" class="wp-image-43882" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_068-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_068-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_068-300x165.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_068-1024x563.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_068-768x422.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_068-1536x844.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_068-2048x1125.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: ELPACO-team ransomware GUI interface 1</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_069-scaled.png"><img loading="lazy" decoding="async" width="2560" height="1399" class="wp-image-43881" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_069-scaled.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_069-scaled.png 2560w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_069-300x164.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_069-1024x560.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_069-768x420.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_069-1536x840.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_069-2048x1119.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px" /></a></figure></div>


<p style="text-align: center;">Figure: ELPACO-team ransomware GUI interface 2</p>



<p>The ELPACO-team.exe file was a self-extracting 7-zip SFX file, which expanded the following files, all in the path “C:\Users\noname\AppData\Local\Temp\5\7ZipSfx.000\”. The 7za.exe file was created and executed. The 7za.exe file then created the rest of the files.</p>



<ul class="wp-block-list">
<li>7za.exe</li>



<li>Everything.exe</li>



<li>Everything32.dll</li>



<li>DC.exe</li>



<li>ELPACO-team.exe</li>



<li><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e9aca7aab68d8c8f889c859db68d8c8f889c859db6dbd9dbdac4d8dbc4dbdeb6d9d0c4dbdec4ddd9d4bd8c858c8e9b8884a98d889d888d8c8a9b90999dc78c918c">[email&#160;protected]</a></li>



<li>gui35.exe</li>



<li>gui40.exe</li>



<li>xdel.exe</li>
</ul>



<p>This pattern of file creation is consistent with <a href="https://www.cyfirma.com/research/elpaco-team-ransomware-a-new-variant-of-the-mimic-ransomware-family/" target="_blank" rel="noreferrer noopener">a ransomware analysis blog</a> published by Cyfirma in November 2024. The blog describes ELPACO-team ransomware as a variant of Mimic ransomware.</p>



<p>The ELPACO-team.exe file in the 7ZipSfx.000 folder was executed, and it created a new folder:</p>



<p>C:\Users\noname\AppData\Local\F6A3737E-E3B0-8956-8261-0121C68105F3\</p>



<p>Then, it copied all the files listed above to the new folder, while also creating new files in that folder:</p>



<ul class="wp-block-list">
<li>svhostss.exe</li>



<li>Everything.ini</li>



<li>Everything2.ini</li>



<li>Everything32.dll</li>



<li>Everything64.dll</li>



<li>global_options.ini</li>
</ul>



<p>The svhostss.exe file hash matched the hash of the ELPACO-team.exe file that was extracted to the C:\Users\noname\AppData\Local\F6A3737E-E3B0-8956-8261-0121C68105F3\ by 7za.exe, showing that it was just a renamed copy of the same file. A second version of the ransomware binary was also observed with a different hash.</p>



<figure class="wp-block-table">
<table class="has-fixed-layout">
<tbody>
<tr>
<td>Filename</td>
<td>SHA256</td>
</tr>
<tr>
<td>svhostss.exe</td>
<td>0b83f2667abff814bb724808c404396e6ad417591165f1762a8e99ec108d4996</td>
</tr>
<tr>
<td>ELPACO-team.exe</td>
<td>0b83f2667abff814bb724808c404396e6ad417591165f1762a8e99ec108d4996  </td>
</tr>
<tr>
<td>ELPACO-team.exe</td>
<td>a710ed9e008326b981ff0fadb1c75d89deca2b52451d4677a8fd808b4ac0649b</td>
</tr>
</tbody>
</table>
</figure>



<p>The Everything64.dll file was extracted using the password “7595128543001923103”</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_070.png"><img loading="lazy" decoding="async" width="2108" height="192" class="wp-image-43880" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_070.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_070.png 2108w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_070-300x27.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_070-1024x93.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_070-768x70.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_070-1536x140.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_070-2048x187.png 2048w" sizes="auto, (max-width: 2108px) 100vw, 2108px" /></a></figure></div>


<p>After extracting the files, the “svhostss.exe” file was executed as a child process of ELPACO-team.exe</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_071.png"><img loading="lazy" decoding="async" width="2063" height="191" class="wp-image-43879" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_071.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_071.png 2063w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_071-300x28.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_071-1024x95.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_071-768x71.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_071-1536x142.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_071-2048x190.png 2048w" sizes="auto, (max-width: 2063px) 100vw, 2063px" /></a></figure></div>


<p>The svhostss.exe process then executed itself as a child process several more times, about 45 seconds later, with command line arguments “-e u1” and “-e u2” and “-e watch -pid 5544 -!”</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_072.png"><img loading="lazy" decoding="async" width="2507" height="399" class="wp-image-43878" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_072.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_072.png 2507w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_072-300x48.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_072-1024x163.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_072-768x122.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_072-1536x244.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_072-2048x326.png 2048w" sizes="auto, (max-width: 2507px) 100vw, 2507px" /></a></figure></div>


<p>Persistence was established by setting the value of the registry Windows Run key: “HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\svhostss”</p>



<p>to the path of the svhostss.exe file:</p>



<p>“C:\\Users\\noname\\AppData\\Local\\F6A3737E-E3B0-8956-8261-0121C68105F3\\svhostss.exe\”</p>



<p>The ransomware process created two files in the C:\temp\ folder on every system it ran on, one called “MIMIC_LOG.txt” and the other named “session.tmp”</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_073.png"><img loading="lazy" decoding="async" width="2344" height="255" class="wp-image-43877" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_073.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_073.png 2344w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_073-300x33.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_073-1024x111.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_073-768x84.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_073-1536x167.png 1536w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_073-2048x223.png 2048w" sizes="auto, (max-width: 2344px) 100vw, 2344px" /></a></figure></div>


<p>The svhostss.exe ransomware process accessed other processes over 12000 times in less than 10 minutes. Most of the process access events targeted lsass.exe (granted access 0x40) and svchost.exe (granted access 0x40 and 0x121411)</p>



<p>Process access granted 0x40 means <strong>PROCESS_DUP_HANDLE </strong>which is required to call the DuplicateHandle Windows API.</p>



<p>Process access granted 0x121411 means the combination of:</p>



<ul class="wp-block-list">
<li><strong>PROCESS_QUERY_INFORMATION</strong></li>



<li><strong>PROCESS_VM_READ</strong></li>



<li><strong>PROCESS_TERMINATE</strong></li>



<li><strong>PROCESS_QUERY_LIMITED_INFORMATION</strong></li>



<li><strong>SYNCHRONIZE</strong></li>



<li><strong>READ_CONTROL</strong></li>
</ul>



<p>Analysis of command-line activity reveals the threat actor’s use of specific PowerShell cmdlets for discovering and interacting with virtual machines. They initiated powershell.exe with the -ExecutionPolicy Bypass flag to execute sequences such as Get-VM for VM enumeration, followed by Get-VHD to identify associated virtual disk files. The pipeline further extended to Get-DiskImage -ImagePath $_.Path and Dismount-DiskImage, suggesting a process of accessing and then unlinking VHD contents. Commands to halt virtual machine operations (Get-VM | Stop-VM) were also noted as.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_074.png"><img loading="lazy" decoding="async" width="1407" height="489" class="wp-image-43876" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_074.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_074.png 1407w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_074-300x104.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_074-1024x356.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_074-768x267.png 768w" sizes="auto, (max-width: 1407px) 100vw, 1407px" /></a></figure></div>


<p style="text-align: center;">Figure: Virtual machine discovery commands</p>



<p>After encrypting, files were appended with the .ELPACO-team extension.</p>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_075.png"><img loading="lazy" decoding="async" width="854" height="349" class="wp-image-43875" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_075.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_075.png 854w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_075-300x123.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_075-768x314.png 768w" sizes="auto, (max-width: 854px) 100vw, 854px" /></a></figure></div>


<p>Following execution on the backup server, the threat actor was observed opening and presumably checking the ransom note, C:\Decryption_INFO.txt, using Notepad.</p>



<pre class="wp-block-preformatted">"%WINDIR%\system32\NOTEPAD.EXE" C:\Decryption_INFO.txt 
</pre>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_076.png"><img loading="lazy" decoding="async" width="1335" height="505" class="wp-image-43874" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_076.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_076.png 1335w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_076-300x113.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_076-1024x387.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_076-768x291.png 768w" sizes="auto, (max-width: 1335px) 100vw, 1335px" /></a></figure></div>


<p>The threat actor then repeated this process on a key file server, including preliminary steps such as disabling security tools with DefenderControl and installing Process Hacker before running the ELPACO-team.exe payload. While these two servers were the primary targets for ransomware execution and file encryption, further impact was observed through limited SMB share scanning and which affected a domain controller. To cover their tracks, the threat actor performed some file deletions on the beachhead host before ceasing their activity.</p>



<h2 id="timeline" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#timeline">Timeline</a></h2>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_077_1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-44030" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_077_1.png" alt="" width="1209" height="1920" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_077_1.png 1209w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_077_1-189x300.png 189w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_077_1-645x1024.png 645w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_077_1-768x1220.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_077_1-967x1536.png 967w" sizes="auto, (max-width: 1209px) 100vw, 1209px" /></a></figure></div>


<h2 id="diamond-model" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#diamond-model">Diamond Model</a></h2>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_078.png"><img loading="lazy" decoding="async" width="1670" height="768" class="wp-image-43872" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_078.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_078.png 1670w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_078-300x138.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_078-1024x471.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_078-768x353.png 768w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_078-1536x706.png 1536w" sizes="auto, (max-width: 1670px) 100vw, 1670px" /></a></figure></div>


<h2 id="indicators" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#indicators">Indicators</a></h2>



<h3 class="wp-block-heading">Network</h3>



<pre class="wp-block-preformatted">45.227.254.124
91.191.209.46
</pre>



<h3 class="wp-block-heading">File</h3>



<pre class="wp-block-preformatted">elpaco-team.exe
be8f00c11010e4e6078d383026833c07
32f9259285bb3425b67633d73bc74b93859f40a7
a710ed9e008326b981ff0fadb1c75d89deca2b52451d4677a8fd808b4ac0649b

logs_delete.cmd
35893c46af1af2089498b062379c039f
238424b26da6e53738aa28a46ba007a195ad608c
36d3b20e9380aaaac9151280b4ac3e047a0871efbb158f04344946ff67176a48

runassystem.exe
3f7d6e5a541aad1a52beb823f1576f6a
69519da0edeb9ad6ed739982a05b638d3fee20fb
085ad59bb8d32981ea590a7884da55d4b0a3f5e89a9632530c0c8ef2f379e471

defendercontrol.exe
0a50081a6cd37aea0945c91de91c5d97
755309c6d9fa4cd13b6c867cde01cc1e0d415d00
6606d759667fbdfaa46241db7ffb4839d2c47b88a20120446f41e916cad77d0b

defendercontrol.ini
c9bc430ea5bd0289cf3a6acdb69efac4
79d3fbde198ffa575904998b92285e3815a860c2
6e5a6629b5ec2eea276fe93553d31f3d23885b214db0a4c2c9201f65180d767f

fast.ex_
127fe6658efb06e77b674fdb9db7d6d5
4790bde7c2d233c07165caaab0f5b7d69a60c950
d5746d9f3284dadf60180f7f7332a08895c609520e0c2327918f259d182cbaf6

ns v.2.exe
597de376b1f80c06d501415dd973dcec
629c9649ced38fd815124221b80c9d9c59a85e74
f47e3555461472f23ab4766e4d5b6f6fd260e335a6abc31b860e569a720a5446

processhacker-2.39-setup.exe
54daad58cce5003bee58b28a4f465f49
162b08b0b11827cc024e6b2eed5887ec86339baa
28042dd4a92a0033b8f1d419b9e989c5b8e32d1d2d881f5c8251d58ce35b9063

!start.cmd
92fd70f19771360bd820091025107382
dda90a452cc1540657606e5d40d304b1e58da751
6b93e585479a3c5b9a8edbe2b11a8371cb028e8b196acb1c16a425e8d8530cd7

hahlgiddb.exe
77ef2cad0de20482a6bb6cfcdc5d94d1
f46fa1fbab35f0d697ea896e81c4504de0487e57
abbe5619e1d7a08f807b57d0949a7f97108a546a415778f25ed35f31ee2cd2f5

secretsdump.exe
96ec8798bba011d5be952e0e6398795d
af7c73c47c62d70c546b62c8e1cc707841ec10e3
c3405d9c9d593d75d773c0615254e69d0362954384058ee970a3ec0944519c37

u1.bat
9a875116622272a7f0fb32ce6cc12040
02c264691764f3c7ab9492dcb443e52b0ee66229
15348e1401fe18b83e30a7e7f6b4de40b9981a0e133c22958324a89c188f2c49

wmiexec.exe
47e001253af2003985f15282cdc90a1c
6ee6664df9bfb47d97090492b6cde68bf056a42a
14f0c4ce32821a7d25ea5e016ea26067d6615e3336c3baa854ea37a290a462a8

ypnppsft.exe
e703ffdf065094f30b8b9c107a64736b
7314f85595ab4496abe02c48b476f57cb6b96804
9b1df0db16b3b73fe3549856fb4a74414faecffabee0d001865e05b93dda14ec

checkvuln.bat
1b1e95ea1d26da394688f4c8883721d1
9e22f5e394ffd8df94b1601fe73f2ae14df731ba
2c656109db6d2059c41a50e623ceb5e656ff764c44b1e1dbf41131f0206f8238

create share runasadministrator2.bat / step1-runasadmin.bat / create-share-runasadmin.bat
96fc8c743f6ba38a69bf866b7fa9e4d1
5bef86615c8bd715c794505127a6d5245bba9206
51f2d5fba3d02cba1c99cf2dfd9968b98d0047f501b54b9531e7ad2719706e47

lpe-exploit-runasuser.bat
3e872ca0ac6261b85dd9524a8f3a83db
b8551ef02737bc7801d2077d7d8aca168eb79b0d
c7440e621d1c5e90ca4963a4b3b52d27bac05a44248ca88dd51510489d1171bb

rce-exploit-runasuser.bat
09ba9214257381231934a0115d7af8be
89e3247d2940d78ab13f060761f0c79afa806f39
22436fe549d791caa3007b567d28d51c8c75869519019c40564af4de53490fa2

step2-runasuser.bat
6fbf6350c52d2f2e6f61530d05148562
1217a97009eb86249e6c8010d3024f050f62c40d
3e92ca5b4069eba89d9fcfd7885924282fdf6ca26d0ff8d0502973d9c9bc1fef

rpcdump.exe
91625f7f5d590534949ebe08cc728380
bf1b0ab5a2c49bde5b5dbe828df3e69af5d724c2
3c300726a6cdd8a39230f0775ea726c2d42838ac7ff53bfdd7c58d28df4182d5

sharpprintnightmare.exe
96a1e516cef1ff4791d8785886d56cce
241f9d2495b0b437813d8cf31fe4e4de8be203ec
9875d1947b8d18974c938721c273d9322fc9af36be96e0ec696daac2929bb802

sharpprintnightmare_nf3.exe
ee8d08b380bf3d3fe9961a0ab428549f
8900b1ef864eb390bf99b801d78a0b8dbd5d90b6
ff547a7803cd989f9f09a22323ec3f7079266b9a20a07f2c6f353547318ff172

spn.exe
44c031e3c922e711f7e3784f6d90b10f
5f13d476e9fabdf2ac6f805a98d62f3027c473c2
9e18fcc595d4e158ac7aa9250e45145445b31018b35d6ed91239da2b931b5c37

spn_nf3.exe
53e2e8ce119e2561bb6065b1a42f1085
d01f72d0a4609be76a83ac76a760485d29be854b
e5f985b5a1f4f351616516553295e1224a02219825c35e3c64b55ecdc8a0d699

spider.dll
30a6cd2673ef5b2cb18f142780a5b4a3
1e0ec6994400413c7899cd5c59bdbd6397dea7b5
90cdcf54bbaeb9c5c4afc9b74b48b13e293746ee8858c033fc9d365fd4074018

spider_32.dll
f635d1c916a7c56678f08d1d998e7ce4
35ff55bcf493e1b936dc6e978a981ee2a75543a1
4f4864a1d5f19a3c5552d80483526f3413497835549dce8c61fef116b666fa09

netscan.exe
e7aa5608c81ba4fcd8d166501b90fc06
5c714fda5b78726541301672a44eaf886728f88c
5748bfb17e662fb6d197886a69df47f1071052c3381eb1c609a2bc5dba8c2992

netscan.exe
a75de4c4fd88d94642ad30310c641252
f7e11585ee968ad256be5a2e4c43a73c07034759
6492e765829974c4a636bff0e305261b18eea92fcb1df6fff69890366efc972d

</pre>



<h2 id="detections" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#detections">Detections</a></h2>



<h3 class="wp-block-heading">Network</h3>



<pre class="wp-block-preformatted">SID 2026033: ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt
SID 2025644: ET MALWARE Possible Metasploit Payload Common Construct Bind_API (from server)
SID 2027762: ET USER_AGENTS AnyDesk Remote Desktop Software User-Agent
SID 2025701: ET POLICY SMB2 NT Create AndX Request For an Executable File
SID 2025705: ET POLICY SMB2 NT Create AndX Request For a Powershell .ps1 File
SID 2027204: ET HUNTING Possible Powershell .ps1 Script Use Over SMB
SID 2025699: ET POLICY SMB Executable File Transfer
SID 2050543: ET EXPLOIT Atlassian Confluence RCE Attempt Observed (CVE-2023-22527) M2
SID 2851878: ETPRO MALWARE Cobalt Strike Stager Payload
SID 2035480: ET HUNTING PE EXE Download over raw TCP
SID 2844488: ETPRO HUNTING Suspicious Offset PE EXE or DLL Download on Non-Standard Ports
SID 2025644: ET MALWARE Possible Metasploit Payload Common Construct Bind_API (from server)
SID 2030870: ET EXPLOIT Possible Zerologon Phase 1/3 - NetrServerReqChallenge with 0x00 Client Challenge (CVE-2020-1472)
SID 2035258: ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate2 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M1
</pre>



<h3 class="wp-block-heading">Sigma</h3>



<p>Search rules on <a href="https://detection.fyi/" target="_blank" rel="noreferrer noopener">detection.fyi</a> or <a href="https://sigmasearchengine.com/" target="_blank" rel="noreferrer noopener">sigmasearchengine.com</a></p>



<pre class="wp-block-preformatted">5cb299fc-5fb1-4d07-b989-0644c68b6043 : Suspicious File Download From IP Via Curl.EXE
1ddaa9a4-eb0b-4398-a9fe-7b018f9e23db : CVE-2023-22518 Exploitation Attempt - Suspicious Confluence Child Process (Windows)
0eb46774-f1ab-4a74-8238-1155855f2263 : Disable Windows Defender Functionalities Via Registry Keys
6e2a900a-ced9-4e4a-a9c2-13e706f9518a : HackTool - Potential Remote Credential Dumping Activity Via CrackMapExec Or Impacket-Secretsdump
10c14723-61c7-4c75-92ca-9af245723ad2 : HackTool - Potential Impacket Lateral Movement Activity
962fe167-e48d-4fd6-9974-11e5b9a5d6d1 : LSASS Access From Non System Account
06d71506-7beb-4f22-8888-e2e5e2ca7fd8 : Mimikatz Use
4627c6ae-6899-46e2-aa0c-6ebcb1becd19 : HackTool - Impacket Tools Execution
8202070f-edeb-4d31-a010-a26c72ac5600 : Suspicious Process By Web Server Process
ca387a8e-1c84-4da3-9993-028b45342d30 : PUA - SoftPerfect Netscan Execution
</pre>



<p>DFIR Public Rules Repo:</p>



<pre class="wp-block-preformatted">03f4ca17-de95-428d-a75a-4ee78b047256 : HackTool - Impacket File Indicators
</pre>



<p>DFIR Private Rules:</p>



<pre class="wp-block-preformatted">62095f03-ba2a-45d7-bce9-204dcb574c0c : Detect Suspicious Curl Download and Execution
d8bbf664-f1f0-4eed-adec-118d7d116e2b : Potential Impacket Usage via Command Line
</pre>



<h3 class="wp-block-heading">Yara</h3>



<p>Rules from <a href="https://yarahq.github.io/" target="_blank" rel="noreferrer noopener">https://yarahq.github.io/</a> and <a href="https://github.com/elastic/protections-artifacts/" target="_blank" rel="noreferrer noopener">https://github.com/elastic/protections-artifacts/</a></p>



<pre class="wp-block-preformatted">BINARYALERT_Hacktool_Windows_Mimikatz_Files
DITEKSHEN_INDICATOR_KB_CERT_C2Cbbd946Bc3Fdb944D522931D61D51A
DITEKSHEN_INDICATOR_TOOL_EXP_Sharpprintnightmare
DITEKSHEN_INDICATOR_TOOL_PET_Defendercontrol
ELASTIC_Windows_Ransomware_Phobos_11Ea7Be5
ELASTIC_Windows_Trojan_Metasploit_91Bc5D7D
ELASTIC_Windows_Trojan_Metasploit_A91A6571
Impacket_Keyword
Impacket_Lateral_Movement
Impacket_Tools_Generic_1
Impacket_Tools_rpcdump
Impacket_Tools_secretsdump
Impacket_Tools_wmiexec
Mimikatz_Memory_Rule_1
SEKOIA_Ransomware_Win_Eking_Rich_Header
SIGNATURE_BASE_Impacket_Keyword
SIGNATURE_BASE_Impacket_Lateral_Movement
SIGNATURE_BASE_Impacket_Tools_Generic_1
SIGNATURE_BASE_Impacket_Tools_Rpcdump
SIGNATURE_BASE_Impacket_Tools_Secretsdump
SIGNATURE_BASE_Impacket_Tools_Wmiexec
SIGNATURE_BASE_Mimikatz_Memory_Rule_1
SIGNATURE_BASE_Wiltedtulip_Tools_Clrlg
WiltedTulip_Tools_clrlg
</pre>



<h2 id="mitre" class="wp-block-heading"><a href="https://thedfirreport.com/?p=43853&amp;preview=true#mitre">MITRE ATT&amp;CK</a></h2>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://thedfirreport.com/wp-content/uploads/2025/05/30043_079_1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-44029" src="https://thedfirreport.com/wp-content/uploads/2025/05/30043_079_1.png" alt="" width="1096" height="1039" srcset="https://thedfirreport.com/wp-content/uploads/2025/05/30043_079_1.png 1096w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_079_1-300x284.png 300w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_079_1-1024x971.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/05/30043_079_1-768x728.png 768w" sizes="auto, (max-width: 1096px) 100vw, 1096px" /></a></figure></div>


<pre class="wp-block-preformatted">Application Layer Protocol - T1071
Create Account - T1136
Create Process with Token - T1134.002
Data Encrypted for Impact - T1486
Disable or Modify System Firewall - T1562.004
Disable or Modify Tools - T1562.001
Exploitation for Privilege Escalation - T1068
Exploit Public-Facing Application - T1190
Ingress Tool Transfer - T1105
Local Account - T1136.001
LSASS Memory - T1003.001
Modify Registry - T1112
NTDS - T1003.003
PowerShell - T1059.001
Process Discovery - T1057
Query Registry - T1012
Remote Access Software - T1219
Remote Desktop Protocol - T1021.001
Remote System Discovery - T1018
System Network Configuration Discovery - T1016
Windows Command Shell - T1059.003
Windows Management Instrumentation - T1047
Windows Service - T1543.003
</pre>



<p>Internal case #TB30043 #PR35928</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-twitter-43853"
				class="share-twitter sd-button share-icon"
				href="https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/?share=twitter"
				target="_blank"
				aria-labelledby="sharing-twitter-43853"
				>
				<span id="sharing-twitter-43853" hidden>Click to share on X (Opens in new window)</span>
				<span>X</span>
			</a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-linkedin-43853"
				class="share-linkedin sd-button share-icon"
				href="https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/?share=linkedin"
				target="_blank"
				aria-labelledby="sharing-linkedin-43853"
				>
				<span id="sharing-linkedin-43853" hidden>Click to share on LinkedIn (Opens in new window)</span>
				<span>LinkedIn</span>
			</a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-reddit-43853"
				class="share-reddit sd-button share-icon"
				href="https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/?share=reddit"
				target="_blank"
				aria-labelledby="sharing-reddit-43853"
				>
				<span id="sharing-reddit-43853" hidden>Click to share on Reddit (Opens in new window)</span>
				<span>Reddit</span>
			</a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-facebook-43853"
				class="share-facebook sd-button share-icon"
				href="https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/?share=facebook"
				target="_blank"
				aria-labelledby="sharing-facebook-43853"
				>
				<span id="sharing-facebook-43853" hidden>Click to share on Facebook (Opens in new window)</span>
				<span>Facebook</span>
			</a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer"
				data-shared="sharing-whatsapp-43853"
				class="share-jetpack-whatsapp sd-button share-icon"
				href="https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/?share=jetpack-whatsapp"
				target="_blank"
				aria-labelledby="sharing-whatsapp-43853"
				>
				<span id="sharing-whatsapp-43853" hidden>Click to share on WhatsApp (Opens in new window)</span>
				<span>WhatsApp</span>
			</a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-43853 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2025/04/28/navigating-through-the-fog/" rel="prev">Navigating Through The Fog</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="cebe310cf4" /><input type="hidden" name="_wp_http_referer" value="/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/" /><input type="hidden" name="post_id" value="43853"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/freenews\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>

	<script type="afd0aa762872d24a6b1b3cf2-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2025\/05\/19\/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware\/":43853};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.8.1" id="freenews-navigation-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.8.1" id="freenews-skip-link-focus-fix-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.8.1" id="ResizeSensor-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.8.1" id="theia-sticky-sidebar-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.8.1" id="slick-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.8.1" id="freenews-slick-settings-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.8.1" id="jquery-sticky-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.8.1" id="freenews-sticky-settings-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.8.1" id="marquee-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.8.1" id="freenews-marquee-settings-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" id="jetpack-stats-js-before">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"43853\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:14.6\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "43853" ]);
/* ]]> */
</script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://stats.wp.com/e-202521.js" id="jetpack-stats-js" defer="defer" data-wp-strategy="defer"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://c0.wp.com/p/jetpack/14.6/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=14.6" id="google-translate-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://c0.wp.com/c/6.8.1/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://c0.wp.com/c/6.8.1/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=14.6" id="jetpack-block-subscriptions-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" src="https://c0.wp.com/p/jetpack/14.6/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="afd0aa762872d24a6b1b3cf2-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="afd0aa762872d24a6b1b3cf2-|49" defer></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"94380ddebce0e847","version":"2025.4.0-1-g37f21b1","r":1,"serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"e6611380fbbe475a97dc9cf0a0e9fd2b","b":1}' crossorigin="anonymous"></script>
</body>
</html>
