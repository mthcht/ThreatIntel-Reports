<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="generator" content="HTMLy" />
<link rel="icon" type="image/png" href="https://threat.boutique/favicon.png" />
<link rel="sitemap" href="https://threat.boutique/sitemap.xml" />
<link rel="alternate" type="application/rss+xml" title="Cybersecurity threat portal Feed" href="https://threat.boutique/feed/rss" />
    <title>Investigating Malicious Activity in WSL Environments - Cybersecurity threat portal</title>
<meta name="author" content="Jok3r" />
<meta name="article:published_time" content="2025-09-13T17:54:12+04:00" />
<meta name="article:modified_time" content="2025-09-13T18:46:29+04:00" />
<meta name="article:section" content="Threat Analyze" />
<meta name="article:section_url" content="https://threat.boutique/category/threat-analyze" />
<link rel="canonical" href="https://threat.boutique/2025/09/investigating-malicious-activity-in-wsl-environments" />
<meta name="description" content="Background: Some XDR and EDR solutions are not effective when dealing with threats hidden inside WSL. In certain cases, it can also be challenging"/>
<meta name="twitter:creator" content="@Watch3r755" />
<meta name="twitter:site" content="@Watch3r755" />
<meta property="og:locale" content="en_US" />
<meta property="og:site_name" content="Cybersecurity threat portal" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Investigating Malicious Activity in WSL Environments" />
<meta property="og:url" content="https://threat.boutique/2025/09/investigating-malicious-activity-in-wsl-environments" />
<meta property="og:description" content="Background: Some XDR and EDR solutions are not effective when dealing with threats hidden inside WSL. In certain cases, it can also be challenging" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="og:image" content="https://threat.boutique/content/images/20250913175817-terminal.png" />
    <link href="https://threat.boutique/themes/logs/css/style.css?v=1" rel="stylesheet"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body class="in-post category-threat-analyze type-image" itemscope="itemscope" itemtype="http://schema.org/Blog">
<div class="hide">
    <meta content="Cybersecurity threat portal" itemprop="name"/>
    <meta content="All the published articles data express my own conclusion" itemprop="description"/>
</div>
<div id="cover">
    <div id="header-wrapper">
        <header id="header" class="responsive">
            <div id="branding">
                                    <h2 class="blog-title"><a rel="home" href="https://threat.boutique/">Cybersecurity threat portal</a></h2>
                                <div class="blog-tagline"><p>Blog related to cybersecurity threat</p></div>
            </div>
        </header>
    </div>
    <div id="menu-wrapper">
        <nav id="menu" class="responsive">
            <ul class="nav "><li class="item nav-item first"><a class="nav-link" href="https://threat.boutique/">Home</a></li><li class="item nav-item"><a class="nav-link" href="https://threat.boutique/blog">Blog</a></li></ul>                <form id="search-form" method="get">
        <input type="text" class="search-input" name="search" value="Search" onfocus="if (this.value == 'Search') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search';}">
        <input type="submit" value="Search" class="search-button">
    </form>        </nav>
    </div>
    <div id="main-wrapper">
        <div id="main" class="responsive">
            <section id="content">
                <div class="breadcrumb" xmlns:v="http://rdf.data-vocabulary.org/#"><style>.breadcrumb-list {margin:0; padding:0;} .breadcrumb-list li {display: inline-block; list-style: none;}</style><ol class="breadcrumb-list" itemscope itemtype="http://schema.org/BreadcrumbList"><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" href="https://threat.boutique/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1" /></li> &#187; <li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" href="https://threat.boutique/blog"><span itemprop="name">Blog</span></a><meta itemprop="position" content="2" /></li> &#187; <li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" href="https://threat.boutique/category/threat-analyze"><span itemprop="name">Threat Analyze</span></a><meta itemprop="position" content="3" /></li> &#187; Investigating Malicious Activity in WSL Environments</ol></div>
<div class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    <div class="main">
        <a name="more"></a>
                            <h1 class="title-post" itemprop="name">Investigating Malicious Activity in WSL Environments</h1>
                    <div class="date">
            <span itemprop="datePublished"><a href="https://threat.boutique/archive/2025-09" title="Show all posts made on this month">13 September 2025</a></span>
            - Posted in            <span itemprop="articleSection"><a href="https://threat.boutique/category/threat-analyze">Threat Analyze</a></span> by            <span itemprop="author"><a href="https://threat.boutique/author/b3vSclAuunBMsdt">Jok3r</a></span> -
            <span><a href="https://threat.boutique/2025/09/investigating-malicious-activity-in-wsl-environments" rel="permalink">Permalink</a></span>
        </div>
                    <div class="featured-image">
                <a href="https://threat.boutique/2025/09/investigating-malicious-activity-in-wsl-environments"><img src="https://threat.boutique/content/images/20250913175817-terminal.png" alt="Investigating Malicious Activity in WSL Environments"/></a>
            </div>
                                        <div class="post-body post-1757771652" itemprop="articleBody">
            <p>Background:
Some XDR and EDR solutions are not effective when dealing with threats hidden inside WSL. In certain cases, it can also be challenging for digital forensic specialists to detect threats within WSL or to analyze the behavior of malware operating inside it.</p>

<p>For this reason, our article will be divided into two parts:</p>

<ul>
<li>How to identify threats in a running WSL instance from the Windows host through correlation</li>
<li>How to detect malicious files even if WSL has been removed from the system</li>
</ul>

<p>When WSL is running processes, you can detect suspicious activity from the Windows side without entering the WSL instance. For example, an administrator inspecting the Windows process tree may notice a process invoking network calls that appear to originate from WSL. Because Netcat (nc) is not installed on Windows by default, seeing network behavior tied to a non-Windows binary is a strong indicator of activity inside WSL.</p>

<p>To investigate, correlate any observed “living-off-the-land” binaries (LOLBINs) and unexpected child processes with the Windows components that spawned them. If you observe processes or binaries that are not native to Windows (or not normally present on the host), treat that as suspicious and investigate further — they may represent a hidden threat running inside WSL.</p>

<p><img src="https://threat.boutique/content/images/20250913182755-nc.png" alt="enter image description here" /></p>

<p>Let’s now deep dive into artifact discovery. When a user removes or interacts with WSL, the related data remains in an unencrypted form under:
C:\Users\<CurrentUser>\AppData\Local\Packages\<WSL_PACKAGE_NAME>\LocalState</p>

<p>This state can appear in two formats:
As a .vhdx file,
As a regular folder tree</p>

<p>To analyze the .vhdx, simply copy it to another location and open it with a tool such as 7-Zip. This allows you to view all artifacts related to the Linux filesystem directly.</p>

<p><img src="https://threat.boutique/content/images/20250913183652-rootfs.png" alt="enter image description here" /></p>

<p>Conclusion:
WSL is one of the most widely used implementations, relied on by millions of software engineers worldwide. However, it also introduces significant risks if a threat actor gains a foothold inside it. For example, an attacker could steal SSH keys or other sensitive credentials.</p>

<p>In many cases, WSL-related threats can arise from supply chain attacks, especially through the daily use of package managers and dependencies across different programming languages.</p>
        </div>
        <div class="tags"><strong>Tags:</strong> <a rel="tag" href="https://threat.boutique/tag/forensic-os">forensic_os</a> <a rel="tag" href="https://threat.boutique/tag/windows-os">windows_os</a> <a rel="tag" href="https://threat.boutique/tag/linux">linux</a> <a rel="tag" href="https://threat.boutique/tag/dital-forensic">dital_forensic</a> <a rel="tag" href="https://threat.boutique/tag/incident-response">incident_response</a> <a rel="tag" href="https://threat.boutique/tag/threat-analyze">threat_analyze</a></div>
    </div>
    <div class="separator">&rarr;</div>
    <div class="share-box">
        <div class="author-info">
            <h4>Post by <strong>Jok3r</strong></h4>
            <p>It's just a matter of time when you will be faced with incident</p>
        </div>
                <div class="share">
            <a class="twitter" target="_blank"
               href="https://twitter.com/share?url=https://threat.boutique/2025/09/investigating-malicious-activity-in-wsl-environments&text=Investigating Malicious Activity in WSL Environments">Twitter</a>
            <a class="facebook" target="_blank"
               href="https://www.facebook.com/sharer.php?u=https://threat.boutique/2025/09/investigating-malicious-activity-in-wsl-environments&t=Investigating Malicious Activity in WSL Environments">Facebook</a>
        </div>
    </div>
    <div class="related">
        <h4>Related posts</h4>
        <ul><li><a href="https://threat.boutique/2024/11/from-interviews-to-infections-the-dangerous-trend-of-cybercriminals-in-job-recruitment">From Interviews to Infections: The Dangerous Trend of Cybercriminals in Job Recruitment</a></li><li><a href="https://threat.boutique/2025/07/knock-knock-why-the-recent-announcement-about-mobile-spyware-leak-was-fake">Knock, knock: Why the recent announcement about mobile spyware leak was fake</a></li><li><a href="https://threat.boutique/2025/01/abusing-trusted-relationships-t1199-delivering-malicious-emails-by-compromising-historical-recipients">Abusing Trusted Relationships (T1199): Delivering Malicious Emails by Compromising Historical Recipients</a></li></ul>    </div>
    <div id="comments" class="comments border">
                    </div>
    <div class="postnav">
                            <span class="older"><a href="https://threat.boutique/2025/09/supply-chain-risk-exploiting-abandoned-domains-of-package-maintainers" rel="prev">Supply Chain Risk: Exploiting Abandoned Domains of Linux Package Maintainers</a> &raquo;</span>
            </div>
    </div>            </section>
            <aside id="sidebar">
                <div class="about">
                    <h3>About</h3>
                    <p>All the published articles data express my own conclusion</p>
                </div>
                <div class="social">
                    <h3>Follow</h3>
                    <div class="social-logo "><link rel="stylesheet" id="social-logo-style" href="https://threat.boutique/system/resources/css/social-logos.css" type="text/css" media="all"><a class="social-logo-x" href="https://x.com/Watch3r755" target="_blank" rel="nofollow"><span class="screen-reader-text">Twitter</span></a><a class="social-logo-linkedin" href="https://www.linkedin.com/in/levon-isajanyan-09b90b130/" target="_blank" rel="nofollow"><span class="screen-reader-text">Linkedin</span></a><a class="social-logo-mastodon" href="https://infosec.exchange/@j0K3r" target="_blank" rel="nofollow"><span class="screen-reader-text">Mastodon</span></a><a class="social-logo-feed" href="https://threat.boutique/feed/rss" target="_blank"><span class="screen-reader-text">RSS</span></a></div>                </div>
                <div class="recent">
                    <h3>Recent posts</h3>
                    <ul><li><a href="https://threat.boutique/2025/09/investigating-malicious-activity-in-wsl-environments">Investigating Malicious Activity in WSL Environments</a></li><li><a href="https://threat.boutique/2025/09/supply-chain-risk-exploiting-abandoned-domains-of-package-maintainers">Supply Chain Risk: Exploiting Abandoned Domains of Linux Package Maintainers</a></li><li><a href="https://threat.boutique/2025/08/adversarial-nation-it-talent">Adversarial nation IT talent</a></li><li><a href="https://threat.boutique/2025/08/linux-volatile-memory-forensics-key-caveats-in-acquisition-and-analysis-part2">Linux Volatile Memory Forensics: Key Caveats in Acquisition and Analysis [PART 2 Final]</a></li><li><a href="https://threat.boutique/2025/08/state-linked-hacker-toolset-analysis">State-Linked Hacker Toolset Analysis &amp; Defense Blueprint</a></li></ul>                </div>
                                <div class="archive">
                    <h3>Archives</h3>
                    <ul class="archivegroup"><li class="expanded"><a href="javascript:void(0)" class="toggle" onclick="                        if (this.parentNode.className.indexOf('expanded') > -1){this.parentNode.className = 'collapsed';this.innerHTML = '&#9658;';} else {this.parentNode.className = 'expanded';this.innerHTML = '&#9660;';}">&#9660;</a> <a href="https://threat.boutique/archive/2025">2025</a> <span class="count">(37)</span><ul class="month"><li class="item"><a href="https://threat.boutique/archive/2025-09">September</a> <span class="count">(2)</span></li><li class="item"><a href="https://threat.boutique/archive/2025-08">August</a> <span class="count">(4)</span></li><li class="item"><a href="https://threat.boutique/archive/2025-07">July</a> <span class="count">(4)</span></li><li class="item"><a href="https://threat.boutique/archive/2025-06">June</a> <span class="count">(5)</span></li><li class="item"><a href="https://threat.boutique/archive/2025-05">May</a> <span class="count">(5)</span></li><li class="item"><a href="https://threat.boutique/archive/2025-04">April</a> <span class="count">(4)</span></li><li class="item"><a href="https://threat.boutique/archive/2025-03">March</a> <span class="count">(5)</span></li><li class="item"><a href="https://threat.boutique/archive/2025-02">February</a> <span class="count">(4)</span></li><li class="item"><a href="https://threat.boutique/archive/2025-01">January</a> <span class="count">(4)</span></li></ul></li></ul><ul class="archivegroup"><li class="collapsed"><a href="javascript:void(0)" class="toggle" onclick="                        if (this.parentNode.className.indexOf('expanded') > -1){this.parentNode.className = 'collapsed';this.innerHTML = '&#9658;';} else {this.parentNode.className = 'expanded';this.innerHTML = '&#9660;';}">&#9658;</a> <a href="https://threat.boutique/archive/2024">2024</a> <span class="count">(26)</span><ul class="month"><li class="item"><a href="https://threat.boutique/archive/2024-12">December</a> <span class="count">(2)</span></li><li class="item"><a href="https://threat.boutique/archive/2024-11">November</a> <span class="count">(5)</span></li><li class="item"><a href="https://threat.boutique/archive/2024-10">October</a> <span class="count">(4)</span></li><li class="item"><a href="https://threat.boutique/archive/2024-09">September</a> <span class="count">(4)</span></li><li class="item"><a href="https://threat.boutique/archive/2024-08">August</a> <span class="count">(5)</span></li><li class="item"><a href="https://threat.boutique/archive/2024-07">July</a> <span class="count">(4)</span></li><li class="item"><a href="https://threat.boutique/archive/2024-06">June</a> <span class="count">(2)</span></li></ul></li></ul>                </div>
                                <div class="category-list">
                    <h3>Category</h3>
                    <ul><li><a href="https://threat.boutique/category/hardenings">Hardenings</a> <span>(9)</span></li><li><a href="https://threat.boutique/category/incident-response">Incident Response</a> <span>(21)</span></li><li><a href="https://threat.boutique/category/leak">Leak</a> <span>(2)</span></li><li><a href="https://threat.boutique/category/other">Other</a> <span>(15)</span></li><li><a href="https://threat.boutique/category/threat-analyze">Threat Analyze</a> <span>(16)</span></li></ul>                </div>
                <div class="tagcloud">
                    <h3>Tags</h3>
					<div class="tag-cloud">
						 <a class="tag-cloud-link" href="https://threat.boutique/tag/acquire" style="font-size:8.8235294117647pt;">acquire</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/apt" style="font-size:11.294117647059pt;">APT</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/assesment" style="font-size:8pt;">assesment</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/attack" style="font-size:8pt;">attack</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/browser-extension" style="font-size:10.470588235294pt;">browser_extension</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/compromisation" style="font-size:10.470588235294pt;">compromisation</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/cve" style="font-size:8pt;">CVE</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/cve-analyze" style="font-size:9.6470588235294pt;">CVE_Analyze</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/deanonymize" style="font-size:8pt;">deanonymize</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/decryption" style="font-size:8pt;">decryption</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/detection" style="font-size:8.8235294117647pt;">detection</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/dital-forensic" style="font-size:8pt;">dital_forensic</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/domain" style="font-size:8.8235294117647pt;">domain</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/email" style="font-size:8pt;">email</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/evidence-collection" style="font-size:8pt;">evidence_collection</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/forensic-os" style="font-size:13.764705882353pt;">forensic_os</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/forensic-preparation" style="font-size:11.294117647059pt;">forensic_preparation</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/fraud" style="font-size:8pt;">fraud</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/hardening" style="font-size:8pt;">hardening</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/incident-response" style="font-size:20.352941176471pt;">incident_response</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/infostealer" style="font-size:8.8235294117647pt;">infostealer</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/insider-threat" style="font-size:8pt;">insider_threat</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/javascript" style="font-size:8pt;">javascript</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/leak" style="font-size:12.117647058824pt;">leak</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/linux" style="font-size:11.294117647059pt;">linux</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/malware" style="font-size:15.411764705882pt;">malware</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/metadata" style="font-size:8.8235294117647pt;">metadata</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/package" style="font-size:8.8235294117647pt;">package</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/ransomware" style="font-size:8.8235294117647pt;">ransomware</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/risk" style="font-size:8.8235294117647pt;">risk</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/software" style="font-size:9.6470588235294pt;">software</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/source-code" style="font-size:9.6470588235294pt;">source_code</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/supply-chain" style="font-size:11.294117647059pt;">supply_chain</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/threat" style="font-size:13.764705882353pt;">threat</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/threat-analyze" style="font-size:22pt;">threat_analyze</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/threat-intelligence" style="font-size:12.941176470588pt;">threat_intelligence</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/threat-landscape" style="font-size:8.8235294117647pt;">threat_landscape</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/typosquatting-domain" style="font-size:8.8235294117647pt;">typosquatting_domain</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/volatility-memory" style="font-size:10.470588235294pt;">volatility_memory</a>  <a class="tag-cloud-link" href="https://threat.boutique/tag/windows-os" style="font-size:9.6470588235294pt;">windows_os</a> 					</div>
                </div>
            </aside>
        </div>
    </div>
    <div id="copyright-wrapper">
        <footer id="copyright" class="responsive">
            <span class="copyright">Levon Isajanyan</span> <span class="credit">Powered by <a href="http://www.htmly.com" target="_blank" rel="nofollow">HTMLy</a></span>        </footer>
    </div>
</div>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"0c553c27d016408780f858bd42bdfd6c","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>