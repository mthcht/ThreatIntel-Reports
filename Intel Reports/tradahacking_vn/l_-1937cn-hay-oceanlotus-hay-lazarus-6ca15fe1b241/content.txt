<!doctype html><html lang="en"><head><title data-rh="true">Là 1937CN hay OceanLotus hay Lazarus … | by m4n0w4r | tradahacking | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" name="apple-itunes-app" content="app-id=828256236, app-argument=/tradahacking/l%C3%A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241, affiliate-data=pt=698524&amp;ct=smart_app_banner&amp;mt=8"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2018-11-03T16:17:24.832Z"/><meta data-rh="true" name="title" content="Là 1937CN hay OceanLotus hay Lazarus … | by m4n0w4r | tradahacking | Medium"/><meta data-rh="true" property="og:title" content="Là 1937CN hay OceanLotus hay Lazarus …"/><meta data-rh="true" property="al:android:url" content="medium://p/6ca15fe1b241"/><meta data-rh="true" property="al:ios:url" content="medium://p/6ca15fe1b241"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Là 1937CN hay OceanLotus hay Lazarus … Vô tình bắt gặp trên twitter của @blu3_team (Tôi không rõ sao acc này lại rất hay có được những mẫu target vào VN), tôi tò mò …"/><meta data-rh="true" property="og:description" content="Vô tình bắt gặp trên twitter của @blu3_team (Tôi không rõ sao acc này lại rất hay có được những mẫu target vào VN), tôi tò mò muốn biết kĩ…"/><meta data-rh="true" property="og:url" content="https://medium.com/tradahacking/l%C3%A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241"/><meta data-rh="true" property="al:web:url" content="https://medium.com/tradahacking/l%C3%A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:624/1*utkVDcocvYLgno9vgjM-_w.png"/><meta data-rh="true" property="article:author" content="https://kienbigmummy.medium.com"/><meta data-rh="true" name="author" content="m4n0w4r"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Là 1937CN hay OceanLotus hay Lazarus …"/><meta data-rh="true" name="twitter:site" content="@tradahackingvn"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/6ca15fe1b241"/><meta data-rh="true" property="twitter:description" content="Vô tình bắt gặp trên twitter của @blu3_team (Tôi không rõ sao acc này lại rất hay có được những mẫu target vào VN), tôi tò mò muốn biết kĩ…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:624/1*utkVDcocvYLgno9vgjM-_w.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="15 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/resize:fill:256:256/1*cODlhCaSuYZ5NVUo_EgEtg.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" rel="manifest" href="/manifest.json"/><link data-rh="true" rel="preconnect" href="https://www.google.com"/><link data-rh="true" rel="preconnect" href="https://www.gstatic.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://kienbigmummy.medium.com"/><link data-rh="true" rel="canonical" href="https://medium.com/tradahacking/là-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/6ca15fe1b241"/><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@id":"https://medium.com/tradahacking/là-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241","@type":"SocialMediaPosting","image":["https://miro.medium.com/1*utkVDcocvYLgno9vgjM-_w.png"],"url":"https://medium.com/tradahacking/là-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241","dateCreated":"2018-11-03T15:59:47Z","datePublished":"2018-11-03T15:59:47Z","dateModified":"2018-11-03T16:17:24Z","headline":"Là 1937CN hay OceanLotus hay Lazarus …","name":"Là 1937CN hay OceanLotus hay Lazarus …","description":"Là 1937CN hay OceanLotus hay Lazarus … Vô tình bắt gặp trên twitter của @blu3_team (Tôi không rõ sao acc này lại rất hay có được những mẫu target vào VN), tôi tò mò …","identifier":"6ca15fe1b241","author":{"@context":"https://schema.org","@id":"https://medium.com/@kienbigmummy","@type":"Person","identifier":"kienbigmummy","name":"m4n0w4r","url":"https://medium.com/@kienbigmummy"},"creator":{"@context":"https://schema.org","@id":"https://medium.com/@kienbigmummy","@type":"Person","identifier":"kienbigmummy","name":"m4n0w4r","url":"https://medium.com/@kienbigmummy"},"publisher":{"@context":"https://schema.org","@type":"Organization","@id":"https://medium.com/tradahacking","name":"tradahacking","description":"Chia sẻ kiến thức An Toàn Thông Tin","url":"https://medium.com/tradahacking","sameAs":["https://twitter.com/tradahackingvn","https://facebook.com/tradahackingvn"],"logo":{"@type":"ImageObject","width":274,"height":206,"url":"https://miro.medium.com/v2/resize:fit:274/1%2AaPmV4ykveVMK7Gn2z0_xKg.png"}},"mainEntityOfPage":"https://medium.com/tradahacking/là-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241","isAccessibleForFree":true}</script><script data-rh="true" src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" async="true"></script><style type="text/css" data-fela-rehydration="589" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="589" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.d{display:none}.m{display:block}.n{position:sticky}.o{top:0}.p{z-index:500}.q{padding:0 24px}.r{align-items:center}.s{border-bottom:solid 1px #F2F2F2}.z{height:41px}.ab{line-height:20px}.ac{display:flex}.ae{gap:32px}.af{height:57px}.ag{flex:1 0 auto}.ah{color:inherit}.ai{fill:inherit}.aj{font-size:inherit}.ak{border:none}.al{font-family:inherit}.am{letter-spacing:inherit}.an{font-weight:inherit}.ao{padding:0}.ap{margin:0}.aq{cursor:pointer}.ar:disabled{cursor:not-allowed}.as:disabled{color:#6B6B6B}.at:disabled{fill:#6B6B6B}.aw{width:auto}.ax path{fill:#242424}.ay{height:25px}.az{margin-left:24px}.ba{border-radius:20px}.bb{width:240px}.bc{background:#F9F9F9}.bd path{fill:#6B6B6B}.bf{outline:none}.bg{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bh{font-size:14px}.bi{width:100%}.bj{padding:10px 20px 10px 0}.bk{background-color:transparent}.bl{color:#242424}.bm::placeholder{color:#6B6B6B}.bn{display:inline-block}.bo{margin-left:12px}.bp{margin-right:12px}.bq{border-radius:4px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{flex:0 0 auto}.cd{flex:1 1 auto}.ci{justify-content:center}.co{max-width:680px}.cp{min-width:0}.cq{animation:k1 1.2s ease-in-out infinite}.cr{height:100vh}.cs{margin-bottom:16px}.ct{margin-top:48px}.cu{align-items:flex-start}.cv{flex-direction:column}.cw{justify-content:space-between}.cx{margin-bottom:24px}.dd{width:80%}.de{background-color:#F2F2F2}.dk{height:44px}.dl{width:44px}.dm{margin:auto 0}.dn{margin-bottom:4px}.do{height:16px}.dp{width:120px}.dq{width:80px}.dw{margin-bottom:8px}.dx{width:96%}.dy{width:98%}.dz{width:81%}.ea{margin-left:8px}.eb{color:#6B6B6B}.ec{font-size:13px}.ed{height:100%}.ew{color:#FFFFFF}.ex{fill:#FFFFFF}.ey{background:#1A8917}.ez{border-color:#1A8917}.fd:disabled{cursor:inherit !important}.fe:disabled{opacity:0.3}.ff:disabled:hover{background:#1A8917}.fg:disabled:hover{border-color:#1A8917}.fh{border-radius:99em}.fi{border-width:1px}.fj{border-style:solid}.fk{box-sizing:border-box}.fl{text-decoration:none}.fm{text-align:center}.fn{margin-left:16px}.fo{border:inherit}.fr{position:relative}.fs{fill:#6B6B6B}.ft{gap:8px}.fw{position:absolute}.fx{width:1px}.fy{height:1px}.fz{margin:-1px}.ga{overflow:hidden}.gb{clip:rect(0, 0, 0, 0)}.gc{white-space:nowrap}.gd{border-width:0}.ge{margin-right:32px}.gf{background:transparent}.gg svg{margin-left:4px}.gh svg{fill:#6B6B6B}.gj{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.gl{max-width:100%}.gm{text-overflow:ellipsis}.gn{border-bottom:1px solid #F2F2F2}.go{height:3px}.gp{background-color:#112233}.gq{max-width:1192px}.gw{font-weight:500}.hk{margin:0 8px}.hl{display:inline}.hm{font-size:16px}.hn{line-height:24px}.ho{pointer-events:none}.hp{will-change:opacity, transform}.hq{width:calc(100% - 0px)}.ht{opacity:0}.hu{transform:translateY(89px)}.hv{width:148px}.hw{border-radius:2px}.hx{height:38px}.hy{width:38px}.ia{margin-top:16px}.ib{word-break:break-word}.ih{margin:0 24px}.il{background:rgba(255, 255, 255, 1)}.im{border:1px solid #F2F2F2}.in{box-shadow:0 1px 4px #F2F2F2}.io{max-height:100vh}.ip{overflow-y:auto}.iq{left:0}.ir{top:calc(100vh + 100px)}.is{bottom:calc(100vh + 100px)}.it{width:10px}.iu{word-wrap:break-word}.iv:after{display:block}.iw:after{content:""}.ix:after{clear:both}.iy{line-height:1.23}.iz{letter-spacing:0}.ja{font-style:normal}.jb{font-weight:700}.kl{gap:12px}.km{align-items:baseline}.kn{width:36px}.ko{height:36px}.kp{border:2px solid rgba(255, 255, 255, 1)}.kq{z-index:0}.kr{box-shadow:none}.ks{border:1px solid rgba(0, 0, 0, 0.05)}.kt{margin-bottom:2px}.ku{flex-wrap:nowrap}.kw{width:12px}.kx{flex-wrap:wrap}.ky{padding-left:8px}.kz{padding-right:8px}.ma> *{flex-shrink:0}.mb{overflow-x:scroll}.mc::-webkit-scrollbar{display:none}.md{scrollbar-width:none}.me{-ms-overflow-style:none}.mf{width:74px}.mg{flex-direction:row}.mh{z-index:2}.mi{margin-right:4px}.ml{-webkit-user-select:none}.mm{border:0}.mn{fill:rgba(117, 117, 117, 1)}.mq{outline:0}.mr{user-select:none}.ms> svg{pointer-events:none}.nb{cursor:progress}.nc{margin-left:4px}.nd{margin-top:0px}.ne{opacity:1}.nf{padding:4px 0}.ni{width:16px}.nk{padding:8px 2px}.nl svg{color:#6B6B6B}.oc{margin-left:auto}.od{margin-right:auto}.oe{max-width:624px}.ok{clear:both}.ol{height:auto}.om{box-shadow:inset 3px 0 0 0 #242424}.on{padding-left:23px}.oo{margin-left:-20px}.op{line-height:1.58}.oq{letter-spacing:-0.004em}.or{font-style:italic}.os{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.pk{margin-bottom:-0.46em}.pl{text-decoration:underline}.pm{max-width:587px}.ps{line-height:1.12}.pt{letter-spacing:-0.022em}.pu{font-weight:600}.qn{margin-bottom:-0.28em}.qt{max-width:504px}.qu{max-width:1657px}.qw{cursor:zoom-in}.qx{z-index:auto}.qz{margin-top:10px}.ra{max-width:728px}.rd{max-width:589px}.re{max-width:613px}.rf{max-width:277px}.rg{max-width:602px}.rh{max-width:608px}.ri{max-width:600px}.rj{max-width:349px}.rk{max-width:485px}.rl{max-width:605px}.rm{max-width:316px}.rn{max-width:377px}.ro{max-width:617px}.rp{max-width:497px}.rq{max-width:401px}.rr{max-width:501px}.rs{max-width:556px}.rt{max-width:590px}.ru{max-width:247px}.rv{max-width:538px}.rw{max-width:327px}.rx{max-width:592px}.ry{max-width:525px}.rz{max-width:426px}.sa{max-width:539px}.sb{max-width:593px}.sc{max-width:623px}.sd{margin-bottom:26px}.se{margin-top:6px}.sf{margin-top:8px}.sg{margin-right:8px}.sh{padding:8px 16px}.si{border-radius:100px}.sj{transition:background 300ms ease}.sl{border-top:none}.sm{margin-bottom:50px}.sn{height:52px}.so{max-height:52px}.sp{box-sizing:content-box}.sq{position:static}.sr{z-index:1}.st{max-width:155px}.sz{margin-right:20px}.ta{margin-bottom:64px}.tb{margin-bottom:48px}.to{height:48px}.tp{width:48px}.tq{height:64px}.tr{width:64px}.ts{align-self:flex-end}.ty{padding-right:4px}.uf{white-space:pre-wrap}.ul{height:0px}.um{gap:18px}.un{fill:rgba(61, 61, 61, 1)}.up{padding-bottom:20px}.uv{margin-top:32px}.uw{fill:#242424}.ux{background:0}.uy{border-color:#242424}.va:disabled:hover{color:#242424}.vb:disabled:hover{fill:#242424}.vc:disabled:hover{border-color:#242424}.vn{border-bottom:solid 1px #E5E5E5}.vo{margin-top:72px}.vp{padding:24px 0}.vq{margin-bottom:0px}.vr{margin-right:16px}.au:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.av:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.fa:hover{background:#156D12}.fb:hover{border-color:#156D12}.fc:hover{cursor:pointer}.fu:hover{color:#242424}.fv:hover{fill:#242424}.gi:hover svg{fill:#242424}.gk:hover{background-color:rgba(0, 0, 0, 0.1)}.hz:hover{background-color:none}.kv:hover{text-decoration:underline}.mp:hover{fill:rgba(8, 8, 8, 1)}.ng:hover{fill:#000000}.nh:hover p{color:#000000}.nj:hover{color:#000000}.nm:hover svg{color:#000000}.sk:hover{background-color:#F2F2F2}.uo:hover{fill:rgba(25, 25, 25, 1)}.uz:hover{border-color:#242424}.be:focus-within path{fill:#242424}.mo:focus{fill:rgba(8, 8, 8, 1)}.nn:focus svg{color:#000000}.qy:focus{transform:scale(1.01)}.mt:active{border-style:none}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (min-width: 1080px)">.e{display:none}.bw{width:64px}.cc{display:block}.cn{margin:0 64px}.dc{height:48px}.dj{margin-bottom:52px}.dv{margin-bottom:48px}.em{font-size:14px}.eo{line-height:20px}.eu{font-size:13px}.ev{padding:5px 12px}.fq{display:flex}.gv{max-width:250px}.hh{font-size:20px}.hi{line-height:24px}.hj{letter-spacing:0}.ig{margin-bottom:50px}.ik{max-width:680px}.jw{font-size:42px}.jx{margin-top:1.19em}.jy{margin-bottom:32px}.jz{line-height:52px}.ka{letter-spacing:-0.011em}.kj{align-items:center}.kk{flex-direction:row}.lm{border-top:solid 1px #F2F2F2}.ln{border-bottom:solid 1px #F2F2F2}.lo{margin:32px 0 0}.lp{padding:3px 8px}.ly> *{margin-right:24px}.lz> :last-child{margin-right:0}.na{margin-top:0px}.oj{margin-top:40px}.ph{margin-top:2.14em}.pi{line-height:32px}.pj{letter-spacing:-0.003em}.pr{margin-top:56px}.qj{font-size:24px}.qk{margin-top:1.95em}.ql{line-height:30px}.qm{letter-spacing:-0.016em}.qs{margin-top:0.94em}.sy{display:inline-block}.te{margin-bottom:0}.tf{margin-right:20px}.tt{max-width:500px}.uk{margin-bottom:88px}.uu{margin:40px 0 16px}.vh{width:min-width}.vm{padding-top:72px}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.f{display:none}.mz{margin-top:0px}.rb{margin-left:auto}.rc{text-align:center}.sx{display:inline-block}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (max-width: 903.98px)">.g{display:none}.my{margin-top:0px}.sw{display:inline-block}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (max-width: 727.98px)">.h{display:none}.mw{margin-top:0px}.mx{margin-right:0px}.sv{display:inline-block}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (max-width: 551.98px)">.i{display:none}.t{display:flex}.u{justify-content:space-between}.bs{width:24px}.ce{min-width:100%}.cj{margin:0 24px}.cy{height:40px}.df{margin-bottom:44px}.dr{margin-bottom:32px}.ee{font-size:13px}.ef{line-height:20px}.ep{padding:0px 8px 1px}.gr{max-width:150px}.gx{font-size:16px}.gy{letter-spacing:0}.ic{margin-bottom:2px}.jc{font-size:32px}.jd{margin-top:1.01em}.je{margin-bottom:24px}.jf{line-height:38px}.jg{letter-spacing:-0.014em}.kb{align-items:flex-start}.kc{flex-direction:column-reverse}.la{margin:24px -24px 0}.lb{padding:0}.lq> *{margin-right:8px}.lr> :last-child{margin-right:24px}.mj{margin-left:0px}.mu{margin-top:0px}.mv{margin-right:0px}.no{border:1px solid #F2F2F2}.np{border-radius:99em}.nq{padding:0px 16px 0px 12px}.nr{height:38px}.ns{align-items:center}.nu svg{margin-right:8px}.of{margin-top:32px}.ot{font-size:18px}.ou{margin-top:1.56em}.ov{line-height:28px}.ow{letter-spacing:-0.003em}.pn{margin-top:40px}.pv{font-size:20px}.pw{margin-top:1.2em}.px{line-height:24px}.qo{margin-top:0.67em}.su{display:inline-block}.td{flex-direction:column}.tm{margin-bottom:20px}.tn{margin-right:0}.tx{max-width:100%}.tz{font-size:24px}.ua{line-height:30px}.ub{letter-spacing:-0.016em}.ug{margin-bottom:64px}.uq{margin:32px 0 16px}.vd{width:100%}.vi{padding-top:48px}.nt:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.j{display:none}.bv{width:64px}.ch{min-width:100%}.cm{margin:0 64px}.db{height:48px}.di{margin-bottom:52px}.du{margin-bottom:48px}.ek{font-size:14px}.el{line-height:20px}.es{font-size:13px}.et{padding:5px 12px}.fp{display:flex}.gu{max-width:250px}.he{font-size:20px}.hf{line-height:24px}.hg{letter-spacing:0}.if{margin-bottom:50px}.ij{max-width:680px}.jr{font-size:42px}.js{margin-top:1.19em}.jt{margin-bottom:32px}.ju{line-height:52px}.jv{letter-spacing:-0.011em}.kh{align-items:center}.ki{flex-direction:row}.li{border-top:solid 1px #F2F2F2}.lj{border-bottom:solid 1px #F2F2F2}.lk{margin:32px 0 0}.ll{padding:3px 8px}.lw> *{margin-right:24px}.lx> :last-child{margin-right:0}.oi{margin-top:40px}.pe{margin-top:2.14em}.pf{line-height:32px}.pg{letter-spacing:-0.003em}.pq{margin-top:56px}.qf{font-size:24px}.qg{margin-top:1.95em}.qh{line-height:30px}.qi{letter-spacing:-0.016em}.qr{margin-top:0.94em}.tg{margin-bottom:0}.th{margin-right:20px}.tu{max-width:500px}.uj{margin-bottom:88px}.ut{margin:40px 0 16px}.vg{width:min-width}.vl{padding-top:72px}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.k{display:none}.x{display:flex}.y{justify-content:space-between}.bu{width:64px}.cg{min-width:100%}.cl{margin:0 48px}.da{height:48px}.dh{margin-bottom:52px}.dt{margin-bottom:48px}.ei{font-size:13px}.ej{line-height:20px}.er{padding:0px 8px 1px}.gt{max-width:250px}.hb{font-size:20px}.hc{line-height:24px}.hd{letter-spacing:0}.ie{margin-bottom:50px}.ii{max-width:680px}.jm{font-size:42px}.jn{margin-top:1.19em}.jo{margin-bottom:32px}.jp{line-height:52px}.jq{letter-spacing:-0.011em}.kf{align-items:center}.kg{flex-direction:row}.le{border-top:solid 1px #F2F2F2}.lf{border-bottom:solid 1px #F2F2F2}.lg{margin:32px 0 0}.lh{padding:3px 8px}.lu> *{margin-right:24px}.lv> :last-child{margin-right:0}.oh{margin-top:40px}.pb{margin-top:2.14em}.pc{line-height:32px}.pd{letter-spacing:-0.003em}.pp{margin-top:56px}.qb{font-size:24px}.qc{margin-top:1.95em}.qd{line-height:30px}.qe{letter-spacing:-0.016em}.qq{margin-top:0.94em}.ti{margin-bottom:0}.tj{margin-right:20px}.tv{max-width:500px}.ui{margin-bottom:88px}.us{margin:40px 0 16px}.vf{width:min-width}.vk{padding-top:72px}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.l{display:none}.v{display:flex}.w{justify-content:space-between}.bt{width:24px}.cf{min-width:100%}.ck{margin:0 24px}.cz{height:40px}.dg{margin-bottom:44px}.ds{margin-bottom:32px}.eg{font-size:13px}.eh{line-height:20px}.eq{padding:0px 8px 1px}.gs{max-width:150px}.gz{font-size:16px}.ha{letter-spacing:0}.id{margin-bottom:2px}.jh{font-size:32px}.ji{margin-top:1.01em}.jj{margin-bottom:24px}.jk{line-height:38px}.jl{letter-spacing:-0.014em}.kd{align-items:flex-start}.ke{flex-direction:column-reverse}.lc{margin:24px 0 0}.ld{padding:0}.ls> *{margin-right:8px}.lt> :last-child{margin-right:8px}.mk{margin-left:0px}.nv{border:1px solid #F2F2F2}.nw{border-radius:99em}.nx{padding:0px 16px 0px 12px}.ny{height:38px}.nz{align-items:center}.ob svg{margin-right:8px}.og{margin-top:32px}.ox{font-size:18px}.oy{margin-top:1.56em}.oz{line-height:28px}.pa{letter-spacing:-0.003em}.po{margin-top:40px}.py{font-size:20px}.pz{margin-top:1.2em}.qa{line-height:24px}.qp{margin-top:0.67em}.tc{flex-direction:column}.tk{margin-bottom:20px}.tl{margin-right:0}.tw{max-width:100%}.uc{font-size:24px}.ud{line-height:30px}.ue{letter-spacing:-0.016em}.uh{margin-bottom:64px}.ur{margin:32px 0 16px}.ve{width:100%}.vj{padding-top:48px}.oa:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="print">.ss{display:none}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.hr{transition:opacity 200ms}.qv{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (max-width: 1232px)">.hs{display:none}</style></head><body><div id="root"><div class="a b c"><a href="/sitemap/sitemap.xml" class="d">Sitemap</a><div class="e f g h i j k l"></div><script>document.domain = document.domain;</script><div class="m c"><div class="m n o p c"><div class="q r s t u v w x y j e z ab"><a class="eb ai ec bg am b ao ap aq ar as at au av t v x j e r ed ab" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6ca15fe1b241&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;%7Estage=mobileNavBar&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ea"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Ftradahacking%2Fl%25C3%25A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="q r s ac ae af"><div class="ac r ag"><a class="ah ai aj ak al am an ao ap aq ar as at au av ac" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" aria-labelledby="wordmark-medium-desc" viewBox="0 0 719 160" class="aw ax ay"><desc id="wordmark-medium-desc">Medium Logo</desc><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="az i"><div class="ac ak ba bb bc r bd be"><div class="bn" aria-describedby="searchResults" aria-labelledby="searchResults" aria-haspopup="listbox" role="listbox"></div><div class="bo bp ac"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ak bf bg bh ab bi bj bk bl bm" placeholder="Search" value=""/></div></div></div><div class="i l x fp fq"><span data-dd-action-name="Susi presentation tracker new_post_topnav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" data-discover="true"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg>Write</div></a></span></div><div class="l k j e"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><div class="bg b bh ab eb fr fs ac r ft fu fv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Search</span></div></a></div><div class="ge i l k"><div class="ac r"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><button class="bg b ee ef ep eg eh eq ei ej er es el et eu eo ev ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk bn fl fm" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fn m"><p class="bg b ee ef eg eh ei ej ek el em eo eb"><span data-dd-action-name="Susi presentation tracker global_nav"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Ftradahacking%2Fl%25C3%25A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="m"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><button class="ak gf ao ac r aq fr gg gh gi" aria-label="user options menu" data-testid="headerUserIcon"><div class="m fr"><img alt="" class="m fk by bz ca de" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="gj by m bz ca fw o ak gk"></div></div></button></div></div></div></div></div></div><div class="ac"><div class="cb i l k j cc" style="width:0px"></div><div class="cd bi ce cf cg ch" style="width:calc(100% - 0px)"><div class="m"><div><div class="gn bi m"><div class="go bi gp"></div><div class="ac ci"><div class="cj ck cl cm cn gq cp bi"><div class="af ac r"><div class="gr gs gt gu gv m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://medium.com/tradahacking?source=post_page---publication_nav-e9f496034096-6ca15fe1b241---------------------------------------" rel="noopener follow"><h2 class="bg gw gx ef gy gz eh ha hb hc hd he hf hg hh hi hj bl"><div class="gl ga gm gc">tradahacking</div></h2></a></div><div class="t v k j e"><span class="hk hl" aria-hidden="true"><span class="bg b hm hn bl">·</span></span><p class="bg b hm hn bl"></p></div></div></div></div></div></div><div class="ho fw hp hq o hr hs ht hu"><div class="ac ci"><div class="cj ck cl cm cn gq cp bi"><div class="hv m"><div class="ho"><div class="ac cu cv"><a href="https://medium.com/tradahacking?source=post_page---post_publication_sidebar-e9f496034096-6ca15fe1b241---------------------------------------" rel="noopener follow"><div class="fr"><img alt="tradahacking" class="de hw m hy hx" src="https://miro.medium.com/v2/resize:fill:76:76/1*aPmV4ykveVMK7Gn2z0_xKg.png" width="38" height="38" loading="lazy"/><div class="hw m hx hy fw o gj hz"></div></div></a><div class="ia m"></div><p class="bg b bh ab eb"><span class="ib">Chia sẻ kiến thức An Toàn Thông Tin</span></p><div class="ia m"></div><p class="bg b bh ab bl"></p></div></div></div></div></div></div><div class="ic id ie if ig m"><div class="ac ci"><div class="cp bi ih ii ij ik"></div></div><article><div class="m"><div class="m"><span class="m"></span><section><div><div class="fw iq ir is it ho"></div><div class="ib iu iv iw ix"><div class="ac ci"><div class="cp bi ih ii ij ik"><div><h1 id="2706" class="pw-post-title iy iz ja bg jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bl" data-testid="storyTitle">Là 1937CN hay OceanLotus hay Lazarus …</h1><div><div class="speechify-ignore ac cw"><div class="speechify-ignore bi m"><div class="ac kb kc kd ke kf kg kh ki kj kk kl"><div class="ac r kl"><div class="ac km"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><a rel="noopener follow" href="/@kienbigmummy?source=post_page---byline--6ca15fe1b241---------------------------------------" data-discover="true"><div class="m kn ko by kp kq"><div class="m fr"><img alt="m4n0w4r" class="m fk by bz ca de" src="https://miro.medium.com/v2/resize:fill:64:64/1*Dw-pvqpZpLfrihTKmh9-6Q.jpeg" width="32" height="32" loading="lazy" data-testid="authorPhoto"/><div class="kr by m bz ca fw o ks gk"></div></div></div></a></div></div></div></div><span class="bg b bh ab bl"><div class="kt ac r"><div class="ac r ku"><div class="ac r"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><span class="bg b bh ab bl"><a class="ah ai aj fo al am an ao ap aq ar as at kv" data-testid="authorName" rel="noopener follow" href="/@kienbigmummy?source=post_page---byline--6ca15fe1b241---------------------------------------" data-discover="true">m4n0w4r</a></span></div></div></div></div><div class="kw bn"></div></div></div></span></div><div class="ac r kx"><span class="bg b bh ab eb"><div class="ac ag"><span data-testid="storyReadTime">15 min read</span><div class="ky kz m" aria-hidden="true"><span class="m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span></div><span data-testid="storyPublishDate">Nov 3, 2018</span></div></span></div></div><div class="ac cw la lb lc ld le lf lg lh li lj lk ll lm ln lo lp"><div class="i l x fp fq r"><div class="mf m"><div class="ac r mg mh"><div class="pw-multi-vote-icon fr mi mj mk ml"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftradahacking%2F6ca15fe1b241&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Ftradahacking%2Fl%25C3%25A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241&amp;user=m4n0w4r&amp;userId=3d670b41fa5f&amp;source=---header_actions--6ca15fe1b241---------------------clap_footer------------------" data-discover="true"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><div class="mm aq mn mo mp mq ao mr ms mt ml" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m mu mv mw mx my mz na"><p class="bg b ec ab eb"><span class="nb">--</span></p></div></div></div><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><button class="aq mm ne nf ac r fs ng nh" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="nd"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bg b ec ab eb"><span class="pw-responses-count nc nd">5</span></p></button></div></div></div></div><div class="ac r lq lr ls lt lu lv lw lx ly lz ma mb mc md me"><div class="ni l k j e"></div><div class="i l"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ca15fe1b241&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Ftradahacking%2Fl%25C3%25A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241&amp;source=---header_actions--6ca15fe1b241---------------------bookmark_footer------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb nj" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div><div class="bn" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ah fs aj fo al am an nk ap aq ar fe nl nm nh nn no np nq nr t ns nt nu nv nw nx ny v nz oa ob"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bg b bh ab eb">Share</p></div></button></div></div></div></div></div></div></div></div></div></div><figure class="of og oh oi oj ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*utkVDcocvYLgno9vgjM-_w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*utkVDcocvYLgno9vgjM-_w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*utkVDcocvYLgno9vgjM-_w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*utkVDcocvYLgno9vgjM-_w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*utkVDcocvYLgno9vgjM-_w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*utkVDcocvYLgno9vgjM-_w.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*utkVDcocvYLgno9vgjM-_w.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*utkVDcocvYLgno9vgjM-_w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*utkVDcocvYLgno9vgjM-_w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*utkVDcocvYLgno9vgjM-_w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*utkVDcocvYLgno9vgjM-_w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*utkVDcocvYLgno9vgjM-_w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*utkVDcocvYLgno9vgjM-_w.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*utkVDcocvYLgno9vgjM-_w.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="562" loading="eager" role="presentation"/></picture></div></figure><blockquote class="om on oo"><p id="4c29" class="op oq or os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Vô tình bắt gặp trên twitter của <strong class="os jb">@blu3_team</strong> (<strong class="os jb"><em class="ja">Tôi không rõ sao acc này lại rất hay có được những mẫu target vào VN</em></strong>), tôi tò mò muốn biết kĩ thuật đằng sau nó là gì bởi tôi thấy nó tương tự như một bài mà tôi đã đọc <a class="ah pl" rel="noopener" href="/@Sebdraven/malicious-document-targets-vietnamese-officials-acb3b9d8b80a" data-discover="true">https://medium.com/@Sebdraven/malicious-document-targets-vietnamese-officials-acb3b9d8b80a</a>, và vì xem comment, người nghi ngờ là <strong class="os jb">OceanLotus</strong>, người khẳng định là <strong class="os jb">1937CN Team</strong>…</p><p id="b382" class="op oq or os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Xin lỗi vì bài viết khá dài, tôi cũng không biết làm thế nào để cho nó ngắn hơn :D, nếu bạn không có thời gian để đọc hết thì bấm một like rồi chuyển trang khác. Phần tôi, một là do tôi thích viết, mặt khác cũng là cách tôi tự rèn kĩ năng … phần nữa là vì tôi biết rằng chỉ khi mình thực sự bắt tay vào phân tích mới thấy nó khác xa với những gì mình đọc bằng mắt và tưởng tượng….</p></blockquote><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od pm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*f94cQEOVnLq5jA7pfEWbag.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*f94cQEOVnLq5jA7pfEWbag.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*f94cQEOVnLq5jA7pfEWbag.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*f94cQEOVnLq5jA7pfEWbag.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*f94cQEOVnLq5jA7pfEWbag.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*f94cQEOVnLq5jA7pfEWbag.png 1100w, https://miro.medium.com/v2/resize:fit:1174/format:webp/1*f94cQEOVnLq5jA7pfEWbag.png 1174w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 587px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*f94cQEOVnLq5jA7pfEWbag.png 640w, https://miro.medium.com/v2/resize:fit:720/1*f94cQEOVnLq5jA7pfEWbag.png 720w, https://miro.medium.com/v2/resize:fit:750/1*f94cQEOVnLq5jA7pfEWbag.png 750w, https://miro.medium.com/v2/resize:fit:786/1*f94cQEOVnLq5jA7pfEWbag.png 786w, https://miro.medium.com/v2/resize:fit:828/1*f94cQEOVnLq5jA7pfEWbag.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*f94cQEOVnLq5jA7pfEWbag.png 1100w, https://miro.medium.com/v2/resize:fit:1174/1*f94cQEOVnLq5jA7pfEWbag.png 1174w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 587px"/><img alt="" class="bi gl ol c" width="587" height="420" loading="lazy" role="presentation"/></picture></div></figure><h2 id="c6d1" class="ps pt ja bg pu pv pw px gy py pz qa ha qb qc qd qe qf qg qh qi qj qk ql qm qn bl">1. Môi trường thực hiện</h2><p id="69a0" class="pw-post-body-paragraph op oq ja os b ot qo ov ow ox qp oz pa hb qq pc pd he qr pf pg hh qs pi pj pk ib bl">1. Máy ảo <strong class="os jb">REMnux</strong> (<a class="ah pl" href="https://remnux.org/" rel="noopener ugc nofollow" target="_blank">https://remnux.org/</a>): sử dụng để phân tích files, giả lập Internet services và capture network traffic.</p><p id="027d" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">2. Máy ảo <strong class="os jb">Win10x64</strong> (tự build): sử dụng cho Static &amp; Dynamic Analysis</p><p id="edd0" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">a. Cài đặt sẵn các cộng cụ debugger &amp; disassembler: OllyDbg, x64dbg, IDA …</p><p id="c57d" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">b. Cài đặt sẵn Office 2013.</p><p id="9856" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">c. Enable tải khoản <strong class="os jb">Administrator</strong> (<em class="or">mặc định tài khoản này bị disable</em>) và đăng nhập bằng tải khoản này để thực hiện phân tích.</p><h2 id="2e69" class="ps pt ja bg pu pv pw px gy py pz qa ha qb qc qd qe qf qg qh qi qj qk ql qm qn bl">2. Phân tích theo hành vi</h2><p id="8220" class="pw-post-body-paragraph op oq ja os b ot qo ov ow ox qp oz pa hb qq pc pd he qr pf pg hh qs pi pj pk ib bl">Khi mở tài liệu trên máy ảo Win10, sẽ thấy ứng dụng <strong class="os jb">EQNEDT32.exe</strong> được gọi, sau đó xuất hiện thêm hai tiến trình khác là <strong class="os jb">QcConsol.exe</strong> và <strong class="os jb">dllhst3g.exe</strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od qt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5sgrSwXlIdHL3ydx_JsaAg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5sgrSwXlIdHL3ydx_JsaAg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5sgrSwXlIdHL3ydx_JsaAg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5sgrSwXlIdHL3ydx_JsaAg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5sgrSwXlIdHL3ydx_JsaAg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5sgrSwXlIdHL3ydx_JsaAg.png 1100w, https://miro.medium.com/v2/resize:fit:1008/format:webp/1*5sgrSwXlIdHL3ydx_JsaAg.png 1008w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 504px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*5sgrSwXlIdHL3ydx_JsaAg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5sgrSwXlIdHL3ydx_JsaAg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5sgrSwXlIdHL3ydx_JsaAg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5sgrSwXlIdHL3ydx_JsaAg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5sgrSwXlIdHL3ydx_JsaAg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5sgrSwXlIdHL3ydx_JsaAg.png 1100w, https://miro.medium.com/v2/resize:fit:1008/1*5sgrSwXlIdHL3ydx_JsaAg.png 1008w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 504px"/><img alt="" class="bi gl ol c" width="504" height="132" loading="lazy" role="presentation"/></picture></div></figure><p id="cb7f" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Trên máy ảo REMnux chạy Wireshark để capture traffic từ máy ảo Win10, thu được kết quả kết nối tới C2 server là login[dot]dangquanwatch[dot]com:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5AQFnklODEuUWM1RVE0jRw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5AQFnklODEuUWM1RVE0jRw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5AQFnklODEuUWM1RVE0jRw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5AQFnklODEuUWM1RVE0jRw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5AQFnklODEuUWM1RVE0jRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5AQFnklODEuUWM1RVE0jRw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*5AQFnklODEuUWM1RVE0jRw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*5AQFnklODEuUWM1RVE0jRw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5AQFnklODEuUWM1RVE0jRw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5AQFnklODEuUWM1RVE0jRw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5AQFnklODEuUWM1RVE0jRw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5AQFnklODEuUWM1RVE0jRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5AQFnklODEuUWM1RVE0jRw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*5AQFnklODEuUWM1RVE0jRw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="87" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*F3ZfLQNO5IW5G1u86adnFQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*F3ZfLQNO5IW5G1u86adnFQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*F3ZfLQNO5IW5G1u86adnFQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*F3ZfLQNO5IW5G1u86adnFQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*F3ZfLQNO5IW5G1u86adnFQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*F3ZfLQNO5IW5G1u86adnFQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*F3ZfLQNO5IW5G1u86adnFQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*F3ZfLQNO5IW5G1u86adnFQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*F3ZfLQNO5IW5G1u86adnFQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*F3ZfLQNO5IW5G1u86adnFQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*F3ZfLQNO5IW5G1u86adnFQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*F3ZfLQNO5IW5G1u86adnFQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*F3ZfLQNO5IW5G1u86adnFQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*F3ZfLQNO5IW5G1u86adnFQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="113" loading="lazy" role="presentation"/></picture></div></figure><p id="451e" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Log của Noriben (<a class="ah pl" href="https://github.com/Rurik/Noriben" rel="noopener ugc nofollow" target="_blank">https://github.com/Rurik/Noriben</a>) cung cấp:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div role="button" tabindex="0" class="qv qw fr qx bi qy"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oc od qu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SdIZ-Jv2KJpzSUXT7Rphuw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bi gl ol c" width="700" height="135" loading="lazy" role="presentation"/></picture></div></div></figure><h2 id="39ec" class="ps pt ja bg pu pv pw px gy py pz qa ha qb qc qd qe qf qg qh qi qj qk ql qm qn bl">3. Phân tích sample trên REMnux</h2><p id="0a1a" class="pw-post-body-paragraph op oq ja os b ot qo ov ow ox qp oz pa hb qq pc pd he qr pf pg hh qs pi pj pk ib bl">Sample nhận được là một file có định dạng RTF:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*oM6Mz3JV-xXP-PmLCDt9aA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*oM6Mz3JV-xXP-PmLCDt9aA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*oM6Mz3JV-xXP-PmLCDt9aA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*oM6Mz3JV-xXP-PmLCDt9aA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*oM6Mz3JV-xXP-PmLCDt9aA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*oM6Mz3JV-xXP-PmLCDt9aA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*oM6Mz3JV-xXP-PmLCDt9aA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*oM6Mz3JV-xXP-PmLCDt9aA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*oM6Mz3JV-xXP-PmLCDt9aA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*oM6Mz3JV-xXP-PmLCDt9aA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*oM6Mz3JV-xXP-PmLCDt9aA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*oM6Mz3JV-xXP-PmLCDt9aA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*oM6Mz3JV-xXP-PmLCDt9aA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*oM6Mz3JV-xXP-PmLCDt9aA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="23" loading="lazy" role="presentation"/></picture></div></figure><p id="5a82" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Sử dụng <strong class="os jb">rtfobj</strong> (<a class="ah pl" href="https://github.com/decalage2/oletools" rel="noopener ugc nofollow" target="_blank">https://github.com/decalage2/oletools</a>), biết được sample này có 3 objects:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZKMd8PRTjjMq1OCOsw-sFw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZKMd8PRTjjMq1OCOsw-sFw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZKMd8PRTjjMq1OCOsw-sFw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZKMd8PRTjjMq1OCOsw-sFw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZKMd8PRTjjMq1OCOsw-sFw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZKMd8PRTjjMq1OCOsw-sFw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*ZKMd8PRTjjMq1OCOsw-sFw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZKMd8PRTjjMq1OCOsw-sFw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZKMd8PRTjjMq1OCOsw-sFw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZKMd8PRTjjMq1OCOsw-sFw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZKMd8PRTjjMq1OCOsw-sFw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZKMd8PRTjjMq1OCOsw-sFw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZKMd8PRTjjMq1OCOsw-sFw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*ZKMd8PRTjjMq1OCOsw-sFw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="247" loading="lazy" role="presentation"/></picture></div></figure><p id="44a3" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Object tại id 0 có FileName là <strong class="os jb">8.t</strong>, khi mở tài liệu thì file này sẽ được drop vào thư mục Temp trên máy. Hai object còn lại được nhận diện là “<em class="or">Not a well formed ole object</em>”.</p><p id="6085" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Dùng luôn <strong class="os jb">rtfobj </strong>để dump toàn bộ các objects này:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*b1yMItve0KuUfZWao2WglA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*b1yMItve0KuUfZWao2WglA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*b1yMItve0KuUfZWao2WglA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*b1yMItve0KuUfZWao2WglA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*b1yMItve0KuUfZWao2WglA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*b1yMItve0KuUfZWao2WglA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*b1yMItve0KuUfZWao2WglA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*b1yMItve0KuUfZWao2WglA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*b1yMItve0KuUfZWao2WglA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*b1yMItve0KuUfZWao2WglA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*b1yMItve0KuUfZWao2WglA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*b1yMItve0KuUfZWao2WglA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*b1yMItve0KuUfZWao2WglA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*b1yMItve0KuUfZWao2WglA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="325" loading="lazy" role="presentation"/></picture></div></figure><p id="a4c5" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Kiểm tra thông tin từng file. Đầu tiên là <em class="or">b45087ad4f7d84758046e9d6eb174530fee98b069105a78f124cbde1ecfb0415_8.t</em>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*M_HgqD4AwbWSvbKXQs_3DA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*M_HgqD4AwbWSvbKXQs_3DA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*M_HgqD4AwbWSvbKXQs_3DA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*M_HgqD4AwbWSvbKXQs_3DA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*M_HgqD4AwbWSvbKXQs_3DA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*M_HgqD4AwbWSvbKXQs_3DA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*M_HgqD4AwbWSvbKXQs_3DA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*M_HgqD4AwbWSvbKXQs_3DA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*M_HgqD4AwbWSvbKXQs_3DA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*M_HgqD4AwbWSvbKXQs_3DA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*M_HgqD4AwbWSvbKXQs_3DA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*M_HgqD4AwbWSvbKXQs_3DA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*M_HgqD4AwbWSvbKXQs_3DA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*M_HgqD4AwbWSvbKXQs_3DA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="310" loading="lazy" role="presentation"/></picture></div></figure><p id="0db6" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Theo data như trên hình thì khả năng file này đã bị mã hóa và sẽ được giải mã sau khi drop vào thự mục <strong class="os jb">Temo</strong>.</p><p id="e088" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Với file <em class="or">b45087ad4f7d84758046e9d6eb174530fee98b069105a78f124cbde1ecfb0415_object_000C11FB.raw</em>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*P7_icWYTQGe_qKEP8WGADQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*P7_icWYTQGe_qKEP8WGADQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*P7_icWYTQGe_qKEP8WGADQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*P7_icWYTQGe_qKEP8WGADQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*P7_icWYTQGe_qKEP8WGADQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*P7_icWYTQGe_qKEP8WGADQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*P7_icWYTQGe_qKEP8WGADQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*P7_icWYTQGe_qKEP8WGADQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*P7_icWYTQGe_qKEP8WGADQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*P7_icWYTQGe_qKEP8WGADQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*P7_icWYTQGe_qKEP8WGADQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*P7_icWYTQGe_qKEP8WGADQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*P7_icWYTQGe_qKEP8WGADQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*P7_icWYTQGe_qKEP8WGADQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="48" loading="lazy" role="presentation"/></picture></div></figure><p id="36a1" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Căn cứ vào dấu hiệu như trên hình thì khả năng file RTF có thể sẽ sử dụng exploit <strong class="os jb">CVE-2017–11882</strong> (<a class="ah pl" href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882" rel="noopener ugc nofollow" target="_blank">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882</a>).</p><p id="a495" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Kiểm tra file còn lại là <em class="or">b45087ad4f7d84758046e9d6eb174530fee98b069105a78f124cbde1ecfb0415_object_000C11E9.raw</em>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div role="button" tabindex="0" class="qv qw fr qx bi qy"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NpWeo4hQPXLqitk1uQ1Cig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NpWeo4hQPXLqitk1uQ1Cig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NpWeo4hQPXLqitk1uQ1Cig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NpWeo4hQPXLqitk1uQ1Cig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NpWeo4hQPXLqitk1uQ1Cig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NpWeo4hQPXLqitk1uQ1Cig.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*NpWeo4hQPXLqitk1uQ1Cig.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*NpWeo4hQPXLqitk1uQ1Cig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NpWeo4hQPXLqitk1uQ1Cig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NpWeo4hQPXLqitk1uQ1Cig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NpWeo4hQPXLqitk1uQ1Cig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NpWeo4hQPXLqitk1uQ1Cig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NpWeo4hQPXLqitk1uQ1Cig.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*NpWeo4hQPXLqitk1uQ1Cig.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="645" loading="lazy" role="presentation"/></picture></div></div></figure><p id="07fc" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">File này khả năng sẽ chứa đoạn shellcode để thực hiện sau khi máy nạn nhân bị exploit. Thông tin sợ bộ là như vậy, tiếp theo ta sẽ thực hiện debug sample này để xem file <strong class="os jb">8.t</strong> được sử dụng như thế nào.</p><h2 id="d4b8" class="ps pt ja bg pu pv pw px gy py pz qa ha qb qc qd qe qf qg qh qi qj qk ql qm qn bl">4. Debug maldoc trên Windows10</h2><p id="6cf3" class="pw-post-body-paragraph op oq ja os b ot qo ov ow ox qp oz pa hb qq pc pd he qr pf pg hh qs pi pj pk ib bl">Liên quan tới exploit <strong class="os jb">CVE-2017–11882</strong>, khi chạy sample, Winword.exe sẽ gọi tiến trình <strong class="os jb">EQNEDT32.exe</strong> để handle OLE object. Tuy nhiên, <strong class="os jb">Winword.exe</strong> không phải là process cha của <strong class="os jb">EQNEDT32.exe</strong>, tiến trình <strong class="os jb">EQNEDT32.exe</strong> được gọi bởi <strong class="os jb">Winword.exe</strong> thông qua việc sử dụng COM Object như hình dưới đây:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_pmEHYg63O77FRvfmWNOLQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_pmEHYg63O77FRvfmWNOLQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_pmEHYg63O77FRvfmWNOLQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_pmEHYg63O77FRvfmWNOLQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_pmEHYg63O77FRvfmWNOLQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_pmEHYg63O77FRvfmWNOLQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*_pmEHYg63O77FRvfmWNOLQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*_pmEHYg63O77FRvfmWNOLQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_pmEHYg63O77FRvfmWNOLQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_pmEHYg63O77FRvfmWNOLQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_pmEHYg63O77FRvfmWNOLQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_pmEHYg63O77FRvfmWNOLQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_pmEHYg63O77FRvfmWNOLQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*_pmEHYg63O77FRvfmWNOLQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="228" loading="lazy" role="presentation"/></picture></div><figcaption class="qz fm ra oc od rb rc bg b bh ab eb"><a class="ah pl" href="https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about/" rel="noopener ugc nofollow" target="_blank">https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about/</a></figcaption></figure><p id="e77b" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Như vậy, bằng cách nào đó ta phải attach được <strong class="os jb">EQNEDT32.exe</strong> vào debugger để debug. Ở đây, tôi sử dụng một kĩ thuật của M$ là <strong class="os jb"><em class="or">Image File Execution Options</em></strong> (IFEO: <a class="ah pl" href="https://blogs.msdn.microsoft.com/mithuns/2010/03/24/image-file-execution-options-ifeo/" rel="noopener ugc nofollow" target="_blank">https://blogs.msdn.microsoft.com/mithuns/2010/03/24/image-file-execution-options-ifeo/</a>).</p><p id="554a" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Vào Registry, tạo một key như sau hoặc nếu cài Word2013 trở lên thì khả năng có sẵn key này (vì tôi thấy trên máy tôi có sẵn):</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*X0Tqm2UMimBW9OeGqw3jxA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*X0Tqm2UMimBW9OeGqw3jxA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*X0Tqm2UMimBW9OeGqw3jxA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*X0Tqm2UMimBW9OeGqw3jxA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*X0Tqm2UMimBW9OeGqw3jxA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*X0Tqm2UMimBW9OeGqw3jxA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*X0Tqm2UMimBW9OeGqw3jxA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*X0Tqm2UMimBW9OeGqw3jxA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*X0Tqm2UMimBW9OeGqw3jxA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*X0Tqm2UMimBW9OeGqw3jxA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*X0Tqm2UMimBW9OeGqw3jxA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*X0Tqm2UMimBW9OeGqw3jxA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*X0Tqm2UMimBW9OeGqw3jxA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*X0Tqm2UMimBW9OeGqw3jxA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="235" loading="lazy" role="presentation"/></picture></div></figure><p id="a62d" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tiếp theo, tạo một string value để khởi chạy debugger khi EQNEDT32.exe được thực thi, qua đó sẽ attach đươc debugger vào tiến trình của EQNEDT32.exe.</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*k8MxeblFLPSGuBngKy06CQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*k8MxeblFLPSGuBngKy06CQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*k8MxeblFLPSGuBngKy06CQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*k8MxeblFLPSGuBngKy06CQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*k8MxeblFLPSGuBngKy06CQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*k8MxeblFLPSGuBngKy06CQ.png 1100w, https://miro.medium.com/v2/resize:fit:1178/format:webp/1*k8MxeblFLPSGuBngKy06CQ.png 1178w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 589px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*k8MxeblFLPSGuBngKy06CQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*k8MxeblFLPSGuBngKy06CQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*k8MxeblFLPSGuBngKy06CQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*k8MxeblFLPSGuBngKy06CQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*k8MxeblFLPSGuBngKy06CQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*k8MxeblFLPSGuBngKy06CQ.png 1100w, https://miro.medium.com/v2/resize:fit:1178/1*k8MxeblFLPSGuBngKy06CQ.png 1178w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 589px"/><img alt="" class="bi gl ol c" width="589" height="109" loading="lazy" role="presentation"/></picture></div></figure><p id="7bd7" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Với thiết lập như trên, kiểm tra lại bằng <strong class="os jb">Autoruns</strong> sẽ như sau:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Sc1FHWnRsqRctIGBZflPqw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Sc1FHWnRsqRctIGBZflPqw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Sc1FHWnRsqRctIGBZflPqw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Sc1FHWnRsqRctIGBZflPqw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Sc1FHWnRsqRctIGBZflPqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Sc1FHWnRsqRctIGBZflPqw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Sc1FHWnRsqRctIGBZflPqw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Sc1FHWnRsqRctIGBZflPqw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Sc1FHWnRsqRctIGBZflPqw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Sc1FHWnRsqRctIGBZflPqw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Sc1FHWnRsqRctIGBZflPqw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Sc1FHWnRsqRctIGBZflPqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Sc1FHWnRsqRctIGBZflPqw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*Sc1FHWnRsqRctIGBZflPqw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="141" loading="lazy" role="presentation"/></picture></div></figure><p id="cd37" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Lưu ý: khi thiết lập IFEO, các thiết lập sẽ tự động bộ giữa hai key: <em class="or">HKLM\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</em> và <em class="or">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</em></p><p id="4a49" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tiếp theo, mở WINWORD.EXE, sau đó từ Winword mở tài liệu malicious rtf. Lúc này, tiến trình EQNEDT32.exe cũng sẽ được khởi chạy và được attach vào debugger:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4XSkTYb6gkFIPdtHPsti9Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4XSkTYb6gkFIPdtHPsti9Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4XSkTYb6gkFIPdtHPsti9Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4XSkTYb6gkFIPdtHPsti9Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4XSkTYb6gkFIPdtHPsti9Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4XSkTYb6gkFIPdtHPsti9Q.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*4XSkTYb6gkFIPdtHPsti9Q.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*4XSkTYb6gkFIPdtHPsti9Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4XSkTYb6gkFIPdtHPsti9Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4XSkTYb6gkFIPdtHPsti9Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4XSkTYb6gkFIPdtHPsti9Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4XSkTYb6gkFIPdtHPsti9Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4XSkTYb6gkFIPdtHPsti9Q.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*4XSkTYb6gkFIPdtHPsti9Q.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="107" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HHwwTVJBtSJZivFB3uOT1A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*HHwwTVJBtSJZivFB3uOT1A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*HHwwTVJBtSJZivFB3uOT1A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*HHwwTVJBtSJZivFB3uOT1A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*HHwwTVJBtSJZivFB3uOT1A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*HHwwTVJBtSJZivFB3uOT1A.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*HHwwTVJBtSJZivFB3uOT1A.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*HHwwTVJBtSJZivFB3uOT1A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*HHwwTVJBtSJZivFB3uOT1A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*HHwwTVJBtSJZivFB3uOT1A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*HHwwTVJBtSJZivFB3uOT1A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*HHwwTVJBtSJZivFB3uOT1A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*HHwwTVJBtSJZivFB3uOT1A.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*HHwwTVJBtSJZivFB3uOT1A.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="301" loading="lazy" role="presentation"/></picture></div></figure><p id="5799" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tại debugger, ta đang dừng lại tại EP(Entry Point) của EQNEDT32.exe:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*StJmlkRdN8LCEDlLfqBvDA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*StJmlkRdN8LCEDlLfqBvDA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*StJmlkRdN8LCEDlLfqBvDA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*StJmlkRdN8LCEDlLfqBvDA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*StJmlkRdN8LCEDlLfqBvDA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*StJmlkRdN8LCEDlLfqBvDA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*StJmlkRdN8LCEDlLfqBvDA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*StJmlkRdN8LCEDlLfqBvDA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*StJmlkRdN8LCEDlLfqBvDA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*StJmlkRdN8LCEDlLfqBvDA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*StJmlkRdN8LCEDlLfqBvDA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*StJmlkRdN8LCEDlLfqBvDA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*StJmlkRdN8LCEDlLfqBvDA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*StJmlkRdN8LCEDlLfqBvDA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="261" loading="lazy" role="presentation"/></picture></div></figure><p id="9254" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Kiểm tra ta thấy file <strong class="os jb">8.t</strong> đã được drop vào thư mục Temp:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od re"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*S7STqZQQtdJIMIe00D5toQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*S7STqZQQtdJIMIe00D5toQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*S7STqZQQtdJIMIe00D5toQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*S7STqZQQtdJIMIe00D5toQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*S7STqZQQtdJIMIe00D5toQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*S7STqZQQtdJIMIe00D5toQ.png 1100w, https://miro.medium.com/v2/resize:fit:1226/format:webp/1*S7STqZQQtdJIMIe00D5toQ.png 1226w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 613px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*S7STqZQQtdJIMIe00D5toQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*S7STqZQQtdJIMIe00D5toQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*S7STqZQQtdJIMIe00D5toQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*S7STqZQQtdJIMIe00D5toQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*S7STqZQQtdJIMIe00D5toQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*S7STqZQQtdJIMIe00D5toQ.png 1100w, https://miro.medium.com/v2/resize:fit:1226/1*S7STqZQQtdJIMIe00D5toQ.png 1226w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 613px"/><img alt="" class="bi gl ol c" width="613" height="422" loading="lazy" role="presentation"/></picture></div></figure><p id="cfab" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Đặt BP tại API <strong class="os jb"><em class="or">CreatFileW</em></strong>, sau đó nhấn F9 để thực thi, ta thấy chương trình sẽ thực hiện mở file <strong class="os jb">8.t</strong> để đọc nội dung:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lVInTz_NAv6lZt0yssAvgg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lVInTz_NAv6lZt0yssAvgg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lVInTz_NAv6lZt0yssAvgg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lVInTz_NAv6lZt0yssAvgg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lVInTz_NAv6lZt0yssAvgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lVInTz_NAv6lZt0yssAvgg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*lVInTz_NAv6lZt0yssAvgg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lVInTz_NAv6lZt0yssAvgg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lVInTz_NAv6lZt0yssAvgg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lVInTz_NAv6lZt0yssAvgg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lVInTz_NAv6lZt0yssAvgg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lVInTz_NAv6lZt0yssAvgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lVInTz_NAv6lZt0yssAvgg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*lVInTz_NAv6lZt0yssAvgg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="245" loading="lazy" role="presentation"/></picture></div></figure><p id="4851" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Trace qua hàm này và return, sẽ tới shellcode của exploit:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HSontP6_ttfTEgbMuxjm2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*HSontP6_ttfTEgbMuxjm2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*HSontP6_ttfTEgbMuxjm2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*HSontP6_ttfTEgbMuxjm2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*HSontP6_ttfTEgbMuxjm2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*HSontP6_ttfTEgbMuxjm2Q.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*HSontP6_ttfTEgbMuxjm2Q.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*HSontP6_ttfTEgbMuxjm2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*HSontP6_ttfTEgbMuxjm2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*HSontP6_ttfTEgbMuxjm2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*HSontP6_ttfTEgbMuxjm2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*HSontP6_ttfTEgbMuxjm2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*HSontP6_ttfTEgbMuxjm2Q.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*HSontP6_ttfTEgbMuxjm2Q.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="449" loading="lazy" role="presentation"/></picture></div></figure><p id="bf4d" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Gọi hàm <strong class="os jb"><em class="or">GetFileSize</em></strong> để lấy kích thước của <strong class="os jb">8.t</strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WgrdEaAppawqbCQyXPcVsg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WgrdEaAppawqbCQyXPcVsg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WgrdEaAppawqbCQyXPcVsg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WgrdEaAppawqbCQyXPcVsg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WgrdEaAppawqbCQyXPcVsg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WgrdEaAppawqbCQyXPcVsg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*WgrdEaAppawqbCQyXPcVsg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*WgrdEaAppawqbCQyXPcVsg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WgrdEaAppawqbCQyXPcVsg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WgrdEaAppawqbCQyXPcVsg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WgrdEaAppawqbCQyXPcVsg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WgrdEaAppawqbCQyXPcVsg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WgrdEaAppawqbCQyXPcVsg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*WgrdEaAppawqbCQyXPcVsg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="231" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*1Od7yIftihylNHGivMwkqA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*1Od7yIftihylNHGivMwkqA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*1Od7yIftihylNHGivMwkqA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*1Od7yIftihylNHGivMwkqA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*1Od7yIftihylNHGivMwkqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*1Od7yIftihylNHGivMwkqA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*1Od7yIftihylNHGivMwkqA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*1Od7yIftihylNHGivMwkqA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*1Od7yIftihylNHGivMwkqA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*1Od7yIftihylNHGivMwkqA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*1Od7yIftihylNHGivMwkqA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*1Od7yIftihylNHGivMwkqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*1Od7yIftihylNHGivMwkqA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*1Od7yIftihylNHGivMwkqA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="241" loading="lazy" role="presentation"/></picture></div></figure><p id="8ed3" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Sau đó, gọi hàm <strong class="os jb"><em class="or">VirtualAlloc</em></strong> để thực hiện cấp phát một vùng nhớ:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-QiLOc2suv-vWAVTOZ5mWg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-QiLOc2suv-vWAVTOZ5mWg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-QiLOc2suv-vWAVTOZ5mWg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-QiLOc2suv-vWAVTOZ5mWg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-QiLOc2suv-vWAVTOZ5mWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-QiLOc2suv-vWAVTOZ5mWg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*-QiLOc2suv-vWAVTOZ5mWg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-QiLOc2suv-vWAVTOZ5mWg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-QiLOc2suv-vWAVTOZ5mWg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-QiLOc2suv-vWAVTOZ5mWg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-QiLOc2suv-vWAVTOZ5mWg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-QiLOc2suv-vWAVTOZ5mWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-QiLOc2suv-vWAVTOZ5mWg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*-QiLOc2suv-vWAVTOZ5mWg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="180" loading="lazy" role="presentation"/></picture></div></figure><p id="7eb1" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Vùng nhớ được cấp phát trỏ bởi thanh ghi EAX, follow theo vùng nhớ này để xem code sẽ tác động gì lên nó:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HR1tWF875PV9Iodoaccdtw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*HR1tWF875PV9Iodoaccdtw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*HR1tWF875PV9Iodoaccdtw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*HR1tWF875PV9Iodoaccdtw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*HR1tWF875PV9Iodoaccdtw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*HR1tWF875PV9Iodoaccdtw.png 1100w, https://miro.medium.com/v2/resize:fit:554/format:webp/1*HR1tWF875PV9Iodoaccdtw.png 554w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 277px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*HR1tWF875PV9Iodoaccdtw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*HR1tWF875PV9Iodoaccdtw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*HR1tWF875PV9Iodoaccdtw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*HR1tWF875PV9Iodoaccdtw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*HR1tWF875PV9Iodoaccdtw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*HR1tWF875PV9Iodoaccdtw.png 1100w, https://miro.medium.com/v2/resize:fit:554/1*HR1tWF875PV9Iodoaccdtw.png 554w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 277px"/><img alt="" class="bi gl ol c" width="277" height="184" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*TYHASamXB4Cd6bcyCrlgYA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*TYHASamXB4Cd6bcyCrlgYA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*TYHASamXB4Cd6bcyCrlgYA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*TYHASamXB4Cd6bcyCrlgYA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*TYHASamXB4Cd6bcyCrlgYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*TYHASamXB4Cd6bcyCrlgYA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*TYHASamXB4Cd6bcyCrlgYA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*TYHASamXB4Cd6bcyCrlgYA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*TYHASamXB4Cd6bcyCrlgYA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*TYHASamXB4Cd6bcyCrlgYA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*TYHASamXB4Cd6bcyCrlgYA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*TYHASamXB4Cd6bcyCrlgYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*TYHASamXB4Cd6bcyCrlgYA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*TYHASamXB4Cd6bcyCrlgYA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bi gl ol c" width="602" height="216" loading="lazy" role="presentation"/></picture></div></figure><p id="0e6f" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Hàm <strong class="os jb"><em class="or">ReadFile</em></strong> được gọi để đọc ra nội dung của <strong class="os jb">8.t</strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wvO67K0z1C7kpj5cMEMkpg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wvO67K0z1C7kpj5cMEMkpg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wvO67K0z1C7kpj5cMEMkpg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wvO67K0z1C7kpj5cMEMkpg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wvO67K0z1C7kpj5cMEMkpg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wvO67K0z1C7kpj5cMEMkpg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*wvO67K0z1C7kpj5cMEMkpg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wvO67K0z1C7kpj5cMEMkpg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wvO67K0z1C7kpj5cMEMkpg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wvO67K0z1C7kpj5cMEMkpg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wvO67K0z1C7kpj5cMEMkpg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wvO67K0z1C7kpj5cMEMkpg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wvO67K0z1C7kpj5cMEMkpg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*wvO67K0z1C7kpj5cMEMkpg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="232" loading="lazy" role="presentation"/></picture></div></figure><p id="3d95" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Toàn bộ nội dung của <strong class="os jb">8.t</strong> được đọc vào vùng nhớ đã được cấp phát ở trên:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div role="button" tabindex="0" class="qv qw fr qx bi qy"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oc od rd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*v_vtbOLe6_kn9fOVPr1Wjg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*v_vtbOLe6_kn9fOVPr1Wjg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*v_vtbOLe6_kn9fOVPr1Wjg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*v_vtbOLe6_kn9fOVPr1Wjg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*v_vtbOLe6_kn9fOVPr1Wjg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*v_vtbOLe6_kn9fOVPr1Wjg.png 1100w, https://miro.medium.com/v2/resize:fit:1178/format:webp/1*v_vtbOLe6_kn9fOVPr1Wjg.png 1178w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 589px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*v_vtbOLe6_kn9fOVPr1Wjg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*v_vtbOLe6_kn9fOVPr1Wjg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*v_vtbOLe6_kn9fOVPr1Wjg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*v_vtbOLe6_kn9fOVPr1Wjg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*v_vtbOLe6_kn9fOVPr1Wjg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*v_vtbOLe6_kn9fOVPr1Wjg.png 1100w, https://miro.medium.com/v2/resize:fit:1178/1*v_vtbOLe6_kn9fOVPr1Wjg.png 1178w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 589px"/><img alt="" class="bi gl ol c" width="589" height="302" loading="lazy" role="presentation"/></picture></div></div></figure><p id="d6f1" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tiếp tục trace sẽ tới đoạn shellcode thực hiện giải mã toàn bộ nội dung của file <strong class="os jb">8.t</strong> trong memory tại <strong class="os jb"><em class="or">0x4F70000</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mY6YE9A7c2J6_eY1mRvv_w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mY6YE9A7c2J6_eY1mRvv_w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mY6YE9A7c2J6_eY1mRvv_w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mY6YE9A7c2J6_eY1mRvv_w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mY6YE9A7c2J6_eY1mRvv_w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mY6YE9A7c2J6_eY1mRvv_w.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*mY6YE9A7c2J6_eY1mRvv_w.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*mY6YE9A7c2J6_eY1mRvv_w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mY6YE9A7c2J6_eY1mRvv_w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mY6YE9A7c2J6_eY1mRvv_w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mY6YE9A7c2J6_eY1mRvv_w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mY6YE9A7c2J6_eY1mRvv_w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mY6YE9A7c2J6_eY1mRvv_w.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*mY6YE9A7c2J6_eY1mRvv_w.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="283" loading="lazy" role="presentation"/></picture></div></figure><p id="6a2c" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Sau vài lần trace code sẽ thấy được dấu hiệu MZ, nhưng vậy file <strong class="os jb">8.t</strong> sau khi giải mà sẽ là một PE file:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zGJmHCw2k5B_gVIwg56TcQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zGJmHCw2k5B_gVIwg56TcQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zGJmHCw2k5B_gVIwg56TcQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zGJmHCw2k5B_gVIwg56TcQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zGJmHCw2k5B_gVIwg56TcQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zGJmHCw2k5B_gVIwg56TcQ.png 1100w, https://miro.medium.com/v2/resize:fit:1216/format:webp/1*zGJmHCw2k5B_gVIwg56TcQ.png 1216w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 608px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*zGJmHCw2k5B_gVIwg56TcQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zGJmHCw2k5B_gVIwg56TcQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zGJmHCw2k5B_gVIwg56TcQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zGJmHCw2k5B_gVIwg56TcQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zGJmHCw2k5B_gVIwg56TcQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zGJmHCw2k5B_gVIwg56TcQ.png 1100w, https://miro.medium.com/v2/resize:fit:1216/1*zGJmHCw2k5B_gVIwg56TcQ.png 1216w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 608px"/><img alt="" class="bi gl ol c" width="608" height="142" loading="lazy" role="presentation"/></picture></div></figure><p id="5a31" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Cho thực hiện xong toàn bộ vòng lặp giải mã trên sẽ có được một PE hoàn chỉnh trong bộ nhớ:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od ri"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*A-qIPNOeK6eiieXmFuzOWg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*A-qIPNOeK6eiieXmFuzOWg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*A-qIPNOeK6eiieXmFuzOWg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*A-qIPNOeK6eiieXmFuzOWg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*A-qIPNOeK6eiieXmFuzOWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*A-qIPNOeK6eiieXmFuzOWg.png 1100w, https://miro.medium.com/v2/resize:fit:1200/format:webp/1*A-qIPNOeK6eiieXmFuzOWg.png 1200w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 600px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*A-qIPNOeK6eiieXmFuzOWg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*A-qIPNOeK6eiieXmFuzOWg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*A-qIPNOeK6eiieXmFuzOWg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*A-qIPNOeK6eiieXmFuzOWg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*A-qIPNOeK6eiieXmFuzOWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*A-qIPNOeK6eiieXmFuzOWg.png 1100w, https://miro.medium.com/v2/resize:fit:1200/1*A-qIPNOeK6eiieXmFuzOWg.png 1200w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 600px"/><img alt="" class="bi gl ol c" width="600" height="546" loading="lazy" role="presentation"/></picture></div></figure><p id="9357" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Dump PE mới này và lưu lại để thực hiện phân tích sau:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*imBLPCI8VP00x5uJmPtx7w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*imBLPCI8VP00x5uJmPtx7w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*imBLPCI8VP00x5uJmPtx7w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*imBLPCI8VP00x5uJmPtx7w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*imBLPCI8VP00x5uJmPtx7w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*imBLPCI8VP00x5uJmPtx7w.png 1100w, https://miro.medium.com/v2/resize:fit:698/format:webp/1*imBLPCI8VP00x5uJmPtx7w.png 698w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 349px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*imBLPCI8VP00x5uJmPtx7w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*imBLPCI8VP00x5uJmPtx7w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*imBLPCI8VP00x5uJmPtx7w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*imBLPCI8VP00x5uJmPtx7w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*imBLPCI8VP00x5uJmPtx7w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*imBLPCI8VP00x5uJmPtx7w.png 1100w, https://miro.medium.com/v2/resize:fit:698/1*imBLPCI8VP00x5uJmPtx7w.png 698w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 349px"/><img alt="" class="bi gl ol c" width="349" height="79" loading="lazy" role="presentation"/></picture></div></figure><p id="3621" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">File dump được là một exe file:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ByFQHfmkqkVl4QOzEBIySQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ByFQHfmkqkVl4QOzEBIySQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ByFQHfmkqkVl4QOzEBIySQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ByFQHfmkqkVl4QOzEBIySQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ByFQHfmkqkVl4QOzEBIySQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ByFQHfmkqkVl4QOzEBIySQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*ByFQHfmkqkVl4QOzEBIySQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ByFQHfmkqkVl4QOzEBIySQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ByFQHfmkqkVl4QOzEBIySQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ByFQHfmkqkVl4QOzEBIySQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ByFQHfmkqkVl4QOzEBIySQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ByFQHfmkqkVl4QOzEBIySQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ByFQHfmkqkVl4QOzEBIySQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*ByFQHfmkqkVl4QOzEBIySQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="364" loading="lazy" role="presentation"/></picture></div></figure><p id="4307" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tiếp tục debug, shellcode gọi tiếp hàm <strong class="os jb"><em class="or">VirtualAlloc</em></strong> để cấp phát một vùng nhớ khác tại địa chỉ <strong class="os jb"><em class="or">0x5170000</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KZaZRJZOiH1ayWMTQQujTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KZaZRJZOiH1ayWMTQQujTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KZaZRJZOiH1ayWMTQQujTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KZaZRJZOiH1ayWMTQQujTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KZaZRJZOiH1ayWMTQQujTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KZaZRJZOiH1ayWMTQQujTQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*KZaZRJZOiH1ayWMTQQujTQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*KZaZRJZOiH1ayWMTQQujTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KZaZRJZOiH1ayWMTQQujTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KZaZRJZOiH1ayWMTQQujTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KZaZRJZOiH1ayWMTQQujTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KZaZRJZOiH1ayWMTQQujTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KZaZRJZOiH1ayWMTQQujTQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*KZaZRJZOiH1ayWMTQQujTQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="238" loading="lazy" role="presentation"/></picture></div></figure><p id="503e" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">PE được giải mã tại vùng nhớ <strong class="os jb"><em class="or">0x4F70000</em></strong> sẽ được copy vào vùng nhớ mới được cấp phát ở trên:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QU0qP9kVeX3Ref9S0ATuGA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QU0qP9kVeX3Ref9S0ATuGA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QU0qP9kVeX3Ref9S0ATuGA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QU0qP9kVeX3Ref9S0ATuGA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QU0qP9kVeX3Ref9S0ATuGA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QU0qP9kVeX3Ref9S0ATuGA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*QU0qP9kVeX3Ref9S0ATuGA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*QU0qP9kVeX3Ref9S0ATuGA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QU0qP9kVeX3Ref9S0ATuGA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QU0qP9kVeX3Ref9S0ATuGA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QU0qP9kVeX3Ref9S0ATuGA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QU0qP9kVeX3Ref9S0ATuGA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QU0qP9kVeX3Ref9S0ATuGA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*QU0qP9kVeX3Ref9S0ATuGA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="350" loading="lazy" role="presentation"/></picture></div></figure><p id="7d0e" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Dump vùng mem trên ra bộ nhớ, và vì file này đã được mapping trên memory và có thay đổi, nên sử dụng cộng cụ <strong class="os jb"><em class="or">pe_unmapper</em></strong> của <strong class="os jb"><em class="or">hasherezade</em></strong> (<a class="ah pl" href="https://github.com/hasherezade/pe_recovery_tools/tree/master/pe_unmapper" rel="noopener ugc nofollow" target="_blank">https://github.com/hasherezade/pe_recovery_tools/tree/master/pe_unmapper</a>) để chuyển đổi từ virtual format về định dạng raw:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*aFvaLr1U3kxo--j5Wmar9g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*aFvaLr1U3kxo--j5Wmar9g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*aFvaLr1U3kxo--j5Wmar9g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*aFvaLr1U3kxo--j5Wmar9g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*aFvaLr1U3kxo--j5Wmar9g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*aFvaLr1U3kxo--j5Wmar9g.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*aFvaLr1U3kxo--j5Wmar9g.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*aFvaLr1U3kxo--j5Wmar9g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*aFvaLr1U3kxo--j5Wmar9g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*aFvaLr1U3kxo--j5Wmar9g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*aFvaLr1U3kxo--j5Wmar9g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*aFvaLr1U3kxo--j5Wmar9g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*aFvaLr1U3kxo--j5Wmar9g.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*aFvaLr1U3kxo--j5Wmar9g.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="668" loading="lazy" role="presentation"/></picture></div></figure><p id="b1a2" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Debug tiếp, shellcode gọi hàm <strong class="os jb"><em class="or">GetModuleFileNameA</em></strong> được gọi để lấy đường dẫn của EQNEDT32.exe:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-TSVcfMc26p1JaA_1n2cOw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-TSVcfMc26p1JaA_1n2cOw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-TSVcfMc26p1JaA_1n2cOw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-TSVcfMc26p1JaA_1n2cOw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-TSVcfMc26p1JaA_1n2cOw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-TSVcfMc26p1JaA_1n2cOw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*-TSVcfMc26p1JaA_1n2cOw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-TSVcfMc26p1JaA_1n2cOw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-TSVcfMc26p1JaA_1n2cOw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-TSVcfMc26p1JaA_1n2cOw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-TSVcfMc26p1JaA_1n2cOw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-TSVcfMc26p1JaA_1n2cOw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-TSVcfMc26p1JaA_1n2cOw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*-TSVcfMc26p1JaA_1n2cOw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="162" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ukVD8cqe0xIXliMSmMUNsw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ukVD8cqe0xIXliMSmMUNsw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ukVD8cqe0xIXliMSmMUNsw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ukVD8cqe0xIXliMSmMUNsw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ukVD8cqe0xIXliMSmMUNsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ukVD8cqe0xIXliMSmMUNsw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*ukVD8cqe0xIXliMSmMUNsw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ukVD8cqe0xIXliMSmMUNsw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ukVD8cqe0xIXliMSmMUNsw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ukVD8cqe0xIXliMSmMUNsw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ukVD8cqe0xIXliMSmMUNsw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ukVD8cqe0xIXliMSmMUNsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ukVD8cqe0xIXliMSmMUNsw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*ukVD8cqe0xIXliMSmMUNsw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="74" loading="lazy" role="presentation"/></picture></div></figure><p id="f4f0" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Sử dụng <strong class="os jb"><em class="or">CreateProcessA</em></strong> (<em class="or">CreateProcessInternalA</em>) để tạo một process EQNEDT32.exe khác ở trạng thái <strong class="os jb"><em class="or">Suspended</em></strong>. Do đang thiết lập tính năng IFEO nên ta sẽ thấy process của debugger thay vì là process EQNEDT32.exe:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XSHvEjf3lq2Uzy9299vzSQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XSHvEjf3lq2Uzy9299vzSQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XSHvEjf3lq2Uzy9299vzSQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XSHvEjf3lq2Uzy9299vzSQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XSHvEjf3lq2Uzy9299vzSQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XSHvEjf3lq2Uzy9299vzSQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*XSHvEjf3lq2Uzy9299vzSQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XSHvEjf3lq2Uzy9299vzSQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XSHvEjf3lq2Uzy9299vzSQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XSHvEjf3lq2Uzy9299vzSQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XSHvEjf3lq2Uzy9299vzSQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XSHvEjf3lq2Uzy9299vzSQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XSHvEjf3lq2Uzy9299vzSQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*XSHvEjf3lq2Uzy9299vzSQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="140" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*uevnQD0-yT3tpm1SudqAyQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*uevnQD0-yT3tpm1SudqAyQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*uevnQD0-yT3tpm1SudqAyQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*uevnQD0-yT3tpm1SudqAyQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*uevnQD0-yT3tpm1SudqAyQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*uevnQD0-yT3tpm1SudqAyQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*uevnQD0-yT3tpm1SudqAyQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*uevnQD0-yT3tpm1SudqAyQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*uevnQD0-yT3tpm1SudqAyQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*uevnQD0-yT3tpm1SudqAyQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*uevnQD0-yT3tpm1SudqAyQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*uevnQD0-yT3tpm1SudqAyQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*uevnQD0-yT3tpm1SudqAyQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*uevnQD0-yT3tpm1SudqAyQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="371" loading="lazy" role="presentation"/></picture></div></figure><p id="966b" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl"><em class="or">Note: Nếu thực hiện lại, tới bước này thì sử dụng Autoruns để bỏ việc sử dụng IFEO và cho thực hiện hàm </em><strong class="os jb"><em class="or">CreateProcessA</em></strong><em class="or">, ta sẽ có được kết quả đúng như hình:</em></p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xr8V8o4nmu84NXG6RuOU9A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xr8V8o4nmu84NXG6RuOU9A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xr8V8o4nmu84NXG6RuOU9A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xr8V8o4nmu84NXG6RuOU9A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xr8V8o4nmu84NXG6RuOU9A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xr8V8o4nmu84NXG6RuOU9A.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*xr8V8o4nmu84NXG6RuOU9A.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*xr8V8o4nmu84NXG6RuOU9A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xr8V8o4nmu84NXG6RuOU9A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xr8V8o4nmu84NXG6RuOU9A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xr8V8o4nmu84NXG6RuOU9A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xr8V8o4nmu84NXG6RuOU9A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xr8V8o4nmu84NXG6RuOU9A.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*xr8V8o4nmu84NXG6RuOU9A.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="243" loading="lazy" role="presentation"/></picture></div></figure><p id="f113" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Đoạn code tiếp theo sẽ lấy thread context bằng <strong class="os jb"><em class="or">GetThreadContext</em></strong>, đọc dữ liệu từ vùng nhớ với hàm <strong class="os jb"><em class="or">ReadProcessMemory</em></strong>, gọi <strong class="os jb"><em class="or">VirtualProtectEx</em></strong> (<em class="or">PAGE_EXECUTE_READWRITE 0x40</em>) để thay đổi trang thái của vùng nhớ trên Suspend process, và cuối cùng shellcode ghi đè lên bằng PE tại địa chỉ <strong class="os jb"><em class="or">0x5170000</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SXHrHBZn80BrMUmJNYIxxw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SXHrHBZn80BrMUmJNYIxxw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SXHrHBZn80BrMUmJNYIxxw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SXHrHBZn80BrMUmJNYIxxw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SXHrHBZn80BrMUmJNYIxxw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SXHrHBZn80BrMUmJNYIxxw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*SXHrHBZn80BrMUmJNYIxxw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*SXHrHBZn80BrMUmJNYIxxw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SXHrHBZn80BrMUmJNYIxxw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SXHrHBZn80BrMUmJNYIxxw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SXHrHBZn80BrMUmJNYIxxw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SXHrHBZn80BrMUmJNYIxxw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SXHrHBZn80BrMUmJNYIxxw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*SXHrHBZn80BrMUmJNYIxxw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="132" loading="lazy" role="presentation"/></picture></div></figure><p id="90fe" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Thực hiện đặt lại thread context bằng <strong class="os jb"><em class="or">SetThreadContext</em></strong>, cuối cùng shellcode thực hiện hàm <strong class="os jb"><em class="or">ResumeThread</em></strong> để launch PE mới:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xiZmHXlM1z4eAfKzK07TVA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xiZmHXlM1z4eAfKzK07TVA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xiZmHXlM1z4eAfKzK07TVA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xiZmHXlM1z4eAfKzK07TVA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xiZmHXlM1z4eAfKzK07TVA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xiZmHXlM1z4eAfKzK07TVA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*xiZmHXlM1z4eAfKzK07TVA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*xiZmHXlM1z4eAfKzK07TVA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xiZmHXlM1z4eAfKzK07TVA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xiZmHXlM1z4eAfKzK07TVA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xiZmHXlM1z4eAfKzK07TVA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xiZmHXlM1z4eAfKzK07TVA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xiZmHXlM1z4eAfKzK07TVA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*xiZmHXlM1z4eAfKzK07TVA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="130" loading="lazy" role="presentation"/></picture></div></figure><blockquote class="om on oo"><p id="d9ed" class="op oq or os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tổng kết lại, toàn bộ quá trình thực hiện của shellcode là giải mã file <strong class="os jb">8.t</strong> thành một PE mới, sau đó thực hiện nhân bản sang một vùng nhớ khác, thực hiện tạo một fork process mới là EQNEDT32.exe, cuối cùng áp dụng kĩ thuật runPE để launch <strong class="os jb">EQNEDT32.exe mới</strong> đã bị ghi đè code bởi nội dung của file <strong class="os jb">8.t</strong>.</p></blockquote><h2 id="4cf1" class="ps pt ja bg pu pv pw px gy py pz qa ha qb qc qd qe qf qg qh qi qj qk ql qm qn bl">5. Phân tích binary đã dump</h2><p id="2672" class="pw-post-body-paragraph op oq ja os b ot qo ov ow ox qp oz pa hb qq pc pd he qr pf pg hh qs pi pj pk ib bl">Như đã biết khi phân tích dynamic, sau khi resume thread thì malware sẽ drop ra disk các file sau: <strong class="os jb"><em class="or">QcConsol.exe; QcLite.dll; stdole.tlb</em></strong> vào thư mục <strong class="os jb">%AppData%\Microsoft\Windows\Printer Shortcuts</strong>.</p><p id="76c4" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Ở trên tôi có 2 file đã dump là <strong class="os jb"><em class="or">_04F70000.mem</em></strong> và <strong class="os jb"><em class="or">drop_bin.exe (được unmap bằng công cụ pe_unmapper)</em></strong>. Tuy nhiên, chỉ có file <strong class="os jb"><em class="or">_04F70000.mem</em></strong> là thực thi được bình thường, còn file <strong class="os jb"><em class="or">drop_bin.exe</em></strong> thì bị crash (mặc dù lúc fix, kiểm tra bằng PE bear thấy mọi thứ đều ok. Tôi có chat hỏi về vấn đề này thì nhận được trả lời của <strong class="os jb"><em class="or">hasherezade</em></strong> như sau: “<em class="or">dumped samples may not always work, so it is normal</em>”).</p><p id="0b46" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Mở IDA và load file <strong class="os jb"><em class="or">_04F70000.exe</em></strong> (đổi tên lại từ file .mem), dừng lại tại <strong class="os jb"><em class="or">WinMain()</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Tp1dQH2fPv4dkISVVJDCuA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Tp1dQH2fPv4dkISVVJDCuA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Tp1dQH2fPv4dkISVVJDCuA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Tp1dQH2fPv4dkISVVJDCuA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Tp1dQH2fPv4dkISVVJDCuA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Tp1dQH2fPv4dkISVVJDCuA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Tp1dQH2fPv4dkISVVJDCuA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Tp1dQH2fPv4dkISVVJDCuA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Tp1dQH2fPv4dkISVVJDCuA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Tp1dQH2fPv4dkISVVJDCuA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Tp1dQH2fPv4dkISVVJDCuA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Tp1dQH2fPv4dkISVVJDCuA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Tp1dQH2fPv4dkISVVJDCuA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*Tp1dQH2fPv4dkISVVJDCuA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="419" loading="lazy" role="presentation"/></picture></div></figure><p id="de68" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Binary lấy đường dẫn tới thư mục <em class="or">%AppData%\Microsoft\Windows\Printer Shortcuts</em>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Kd3HZ4Xnk5e94vND-9orbw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Kd3HZ4Xnk5e94vND-9orbw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Kd3HZ4Xnk5e94vND-9orbw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Kd3HZ4Xnk5e94vND-9orbw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Kd3HZ4Xnk5e94vND-9orbw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Kd3HZ4Xnk5e94vND-9orbw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Kd3HZ4Xnk5e94vND-9orbw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Kd3HZ4Xnk5e94vND-9orbw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Kd3HZ4Xnk5e94vND-9orbw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Kd3HZ4Xnk5e94vND-9orbw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Kd3HZ4Xnk5e94vND-9orbw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Kd3HZ4Xnk5e94vND-9orbw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Kd3HZ4Xnk5e94vND-9orbw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*Kd3HZ4Xnk5e94vND-9orbw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="229" loading="lazy" role="presentation"/></picture></div></figure><p id="b1bc" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Cấu thành đường dẫn của các file:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YOd0ajwB2zmomxpjTAhnxA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YOd0ajwB2zmomxpjTAhnxA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YOd0ajwB2zmomxpjTAhnxA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YOd0ajwB2zmomxpjTAhnxA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YOd0ajwB2zmomxpjTAhnxA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YOd0ajwB2zmomxpjTAhnxA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*YOd0ajwB2zmomxpjTAhnxA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*YOd0ajwB2zmomxpjTAhnxA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YOd0ajwB2zmomxpjTAhnxA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YOd0ajwB2zmomxpjTAhnxA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YOd0ajwB2zmomxpjTAhnxA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YOd0ajwB2zmomxpjTAhnxA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YOd0ajwB2zmomxpjTAhnxA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*YOd0ajwB2zmomxpjTAhnxA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="49" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Xh5lxKGL5XmVEKFQl8XkAA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Xh5lxKGL5XmVEKFQl8XkAA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Xh5lxKGL5XmVEKFQl8XkAA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Xh5lxKGL5XmVEKFQl8XkAA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Xh5lxKGL5XmVEKFQl8XkAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Xh5lxKGL5XmVEKFQl8XkAA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Xh5lxKGL5XmVEKFQl8XkAA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Xh5lxKGL5XmVEKFQl8XkAA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Xh5lxKGL5XmVEKFQl8XkAA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Xh5lxKGL5XmVEKFQl8XkAA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Xh5lxKGL5XmVEKFQl8XkAA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Xh5lxKGL5XmVEKFQl8XkAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Xh5lxKGL5XmVEKFQl8XkAA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*Xh5lxKGL5XmVEKFQl8XkAA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="56" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8kTV_3a7Gh9n3hKUcts0GA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8kTV_3a7Gh9n3hKUcts0GA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8kTV_3a7Gh9n3hKUcts0GA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8kTV_3a7Gh9n3hKUcts0GA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8kTV_3a7Gh9n3hKUcts0GA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8kTV_3a7Gh9n3hKUcts0GA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*8kTV_3a7Gh9n3hKUcts0GA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*8kTV_3a7Gh9n3hKUcts0GA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8kTV_3a7Gh9n3hKUcts0GA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8kTV_3a7Gh9n3hKUcts0GA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8kTV_3a7Gh9n3hKUcts0GA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8kTV_3a7Gh9n3hKUcts0GA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8kTV_3a7Gh9n3hKUcts0GA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*8kTV_3a7Gh9n3hKUcts0GA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="59" loading="lazy" role="presentation"/></picture></div></figure><p id="9409" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tới đoạn code thực hiện <strong class="os jb"><em class="or">call sub_331860</em></strong> 3 lần để thực hiện drop các file trên vào thư mục chỉ định. Tôi đổi tên sub này thành thành <strong class="os jb"><em class="or">drop_file</em></strong> như hình:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ALeiuyWgOkg6FiCtXYO-ng.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ALeiuyWgOkg6FiCtXYO-ng.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ALeiuyWgOkg6FiCtXYO-ng.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ALeiuyWgOkg6FiCtXYO-ng.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ALeiuyWgOkg6FiCtXYO-ng.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ALeiuyWgOkg6FiCtXYO-ng.png 1100w, https://miro.medium.com/v2/resize:fit:970/format:webp/1*ALeiuyWgOkg6FiCtXYO-ng.png 970w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 485px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ALeiuyWgOkg6FiCtXYO-ng.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ALeiuyWgOkg6FiCtXYO-ng.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ALeiuyWgOkg6FiCtXYO-ng.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ALeiuyWgOkg6FiCtXYO-ng.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ALeiuyWgOkg6FiCtXYO-ng.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ALeiuyWgOkg6FiCtXYO-ng.png 1100w, https://miro.medium.com/v2/resize:fit:970/1*ALeiuyWgOkg6FiCtXYO-ng.png 970w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 485px"/><img alt="" class="bi gl ol c" width="485" height="366" loading="lazy" role="presentation"/></picture></div></figure><p id="f213" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Đi sâu vào hàm này sẽ gặp vòng lặp xor thực hiện decode bytes, sau đó là đoạn code thực hiện <strong class="os jb"><em class="or">WriteFile</em></strong> vào thư mục:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*q_johZ0o7uBUxVqfbx6GbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*q_johZ0o7uBUxVqfbx6GbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*q_johZ0o7uBUxVqfbx6GbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*q_johZ0o7uBUxVqfbx6GbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*q_johZ0o7uBUxVqfbx6GbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*q_johZ0o7uBUxVqfbx6GbQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*q_johZ0o7uBUxVqfbx6GbQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*q_johZ0o7uBUxVqfbx6GbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*q_johZ0o7uBUxVqfbx6GbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*q_johZ0o7uBUxVqfbx6GbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*q_johZ0o7uBUxVqfbx6GbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*q_johZ0o7uBUxVqfbx6GbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*q_johZ0o7uBUxVqfbx6GbQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*q_johZ0o7uBUxVqfbx6GbQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="395" loading="lazy" role="presentation"/></picture></div></figure><p id="7414" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Kết quả sau khi thực hiện hàm <strong class="os jb"><em class="or">drop_file</em></strong> đầu tiên, có được file <strong class="os jb"><em class="or">QcConsol.exe</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rl"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IJ1h4xazG6nqYWRMpJgM-g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IJ1h4xazG6nqYWRMpJgM-g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IJ1h4xazG6nqYWRMpJgM-g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IJ1h4xazG6nqYWRMpJgM-g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IJ1h4xazG6nqYWRMpJgM-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IJ1h4xazG6nqYWRMpJgM-g.png 1100w, https://miro.medium.com/v2/resize:fit:1210/format:webp/1*IJ1h4xazG6nqYWRMpJgM-g.png 1210w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 605px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*IJ1h4xazG6nqYWRMpJgM-g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IJ1h4xazG6nqYWRMpJgM-g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IJ1h4xazG6nqYWRMpJgM-g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IJ1h4xazG6nqYWRMpJgM-g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IJ1h4xazG6nqYWRMpJgM-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IJ1h4xazG6nqYWRMpJgM-g.png 1100w, https://miro.medium.com/v2/resize:fit:1210/1*IJ1h4xazG6nqYWRMpJgM-g.png 1210w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 605px"/><img alt="" class="bi gl ol c" width="605" height="81" loading="lazy" role="presentation"/></picture></div></figure><p id="1a8b" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Đây là một file hợp lệ, có chữ kí và được phát triển bởi hãng <strong class="os jb"><em class="or">McAfee, Inc.</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Ci1AckRV9vSUXgGbpAWSNw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Ci1AckRV9vSUXgGbpAWSNw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Ci1AckRV9vSUXgGbpAWSNw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Ci1AckRV9vSUXgGbpAWSNw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Ci1AckRV9vSUXgGbpAWSNw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Ci1AckRV9vSUXgGbpAWSNw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Ci1AckRV9vSUXgGbpAWSNw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Ci1AckRV9vSUXgGbpAWSNw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Ci1AckRV9vSUXgGbpAWSNw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Ci1AckRV9vSUXgGbpAWSNw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Ci1AckRV9vSUXgGbpAWSNw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Ci1AckRV9vSUXgGbpAWSNw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Ci1AckRV9vSUXgGbpAWSNw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*Ci1AckRV9vSUXgGbpAWSNw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="348" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZS4MBpJfObc5yWTG9azMIg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZS4MBpJfObc5yWTG9azMIg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZS4MBpJfObc5yWTG9azMIg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZS4MBpJfObc5yWTG9azMIg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZS4MBpJfObc5yWTG9azMIg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZS4MBpJfObc5yWTG9azMIg.png 1100w, https://miro.medium.com/v2/resize:fit:632/format:webp/1*ZS4MBpJfObc5yWTG9azMIg.png 632w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 316px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZS4MBpJfObc5yWTG9azMIg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZS4MBpJfObc5yWTG9azMIg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZS4MBpJfObc5yWTG9azMIg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZS4MBpJfObc5yWTG9azMIg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZS4MBpJfObc5yWTG9azMIg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZS4MBpJfObc5yWTG9azMIg.png 1100w, https://miro.medium.com/v2/resize:fit:632/1*ZS4MBpJfObc5yWTG9azMIg.png 632w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 316px"/><img alt="" class="bi gl ol c" width="316" height="233" loading="lazy" role="presentation"/></picture></div></figure><p id="f822" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Lời gọi hàm <strong class="os jb"><em class="or">drop_file</em></strong> thứ 2 sẽ drop ra file <strong class="os jb"><em class="or">QcLite.dll</em></strong>, file này không có thông tin gì về Signature cũng như info, như vậy malicious code sẽ nằm ở file này:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od ri"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*rIMHzMiAyKSa1scEf20AHQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*rIMHzMiAyKSa1scEf20AHQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*rIMHzMiAyKSa1scEf20AHQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*rIMHzMiAyKSa1scEf20AHQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*rIMHzMiAyKSa1scEf20AHQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rIMHzMiAyKSa1scEf20AHQ.png 1100w, https://miro.medium.com/v2/resize:fit:1200/format:webp/1*rIMHzMiAyKSa1scEf20AHQ.png 1200w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 600px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*rIMHzMiAyKSa1scEf20AHQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*rIMHzMiAyKSa1scEf20AHQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*rIMHzMiAyKSa1scEf20AHQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*rIMHzMiAyKSa1scEf20AHQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*rIMHzMiAyKSa1scEf20AHQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*rIMHzMiAyKSa1scEf20AHQ.png 1100w, https://miro.medium.com/v2/resize:fit:1200/1*rIMHzMiAyKSa1scEf20AHQ.png 1200w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 600px"/><img alt="" class="bi gl ol c" width="600" height="78" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FPeV-xmtGV3zVRnBW2Y5pw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FPeV-xmtGV3zVRnBW2Y5pw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FPeV-xmtGV3zVRnBW2Y5pw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FPeV-xmtGV3zVRnBW2Y5pw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FPeV-xmtGV3zVRnBW2Y5pw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FPeV-xmtGV3zVRnBW2Y5pw.png 1100w, https://miro.medium.com/v2/resize:fit:754/format:webp/1*FPeV-xmtGV3zVRnBW2Y5pw.png 754w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 377px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*FPeV-xmtGV3zVRnBW2Y5pw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FPeV-xmtGV3zVRnBW2Y5pw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FPeV-xmtGV3zVRnBW2Y5pw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FPeV-xmtGV3zVRnBW2Y5pw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FPeV-xmtGV3zVRnBW2Y5pw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FPeV-xmtGV3zVRnBW2Y5pw.png 1100w, https://miro.medium.com/v2/resize:fit:754/1*FPeV-xmtGV3zVRnBW2Y5pw.png 754w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 377px"/><img alt="" class="bi gl ol c" width="377" height="288" loading="lazy" role="presentation"/></picture></div></figure><p id="0e22" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Lời gọi hàm <strong class="os jb"><em class="or">drop_file</em></strong> thứ 3 sẽ drop ra file <strong class="os jb">stdole.tlb</strong>. Thông tin về <strong class="os jb"><em class="or">.tlb</em></strong> có thể xem tại đây (<a class="ah pl" href="https://docs.microsoft.com/en-us/windows/desktop/midl/com-dcom-and-type-libraries" rel="noopener ugc nofollow" target="_blank">https://docs.microsoft.com/en-us/windows/desktop/midl/com-dcom-and-type-libraries</a>):</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od ro"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*LA1GkxahkFRBGI_vYF5y3A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*LA1GkxahkFRBGI_vYF5y3A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*LA1GkxahkFRBGI_vYF5y3A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*LA1GkxahkFRBGI_vYF5y3A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*LA1GkxahkFRBGI_vYF5y3A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LA1GkxahkFRBGI_vYF5y3A.png 1100w, https://miro.medium.com/v2/resize:fit:1234/format:webp/1*LA1GkxahkFRBGI_vYF5y3A.png 1234w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 617px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*LA1GkxahkFRBGI_vYF5y3A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*LA1GkxahkFRBGI_vYF5y3A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*LA1GkxahkFRBGI_vYF5y3A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*LA1GkxahkFRBGI_vYF5y3A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*LA1GkxahkFRBGI_vYF5y3A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*LA1GkxahkFRBGI_vYF5y3A.png 1100w, https://miro.medium.com/v2/resize:fit:1234/1*LA1GkxahkFRBGI_vYF5y3A.png 1234w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 617px"/><img alt="" class="bi gl ol c" width="617" height="100" loading="lazy" role="presentation"/></picture></div></figure><p id="bfff" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tiếp tục, cấu thành một command như sau:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lvuRRwo3od79EgCPNIOpCA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lvuRRwo3od79EgCPNIOpCA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lvuRRwo3od79EgCPNIOpCA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lvuRRwo3od79EgCPNIOpCA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lvuRRwo3od79EgCPNIOpCA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lvuRRwo3od79EgCPNIOpCA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*lvuRRwo3od79EgCPNIOpCA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lvuRRwo3od79EgCPNIOpCA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lvuRRwo3od79EgCPNIOpCA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lvuRRwo3od79EgCPNIOpCA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lvuRRwo3od79EgCPNIOpCA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lvuRRwo3od79EgCPNIOpCA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lvuRRwo3od79EgCPNIOpCA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*lvuRRwo3od79EgCPNIOpCA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="57" loading="lazy" role="presentation"/></picture></div></figure><p id="4073" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Cuối cùng, gọi hàm <strong class="os jb"><em class="or">WinExec</em></strong> để thực thi <strong class="os jb"><em class="or">QcConsol.exe</em></strong> với tham số là <strong class="os jb"><em class="or">“-LowIntegrityServer</em></strong>”:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0mSvs5xZ7S3HoR1-2rG12w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0mSvs5xZ7S3HoR1-2rG12w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0mSvs5xZ7S3HoR1-2rG12w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0mSvs5xZ7S3HoR1-2rG12w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0mSvs5xZ7S3HoR1-2rG12w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0mSvs5xZ7S3HoR1-2rG12w.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*0mSvs5xZ7S3HoR1-2rG12w.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0mSvs5xZ7S3HoR1-2rG12w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0mSvs5xZ7S3HoR1-2rG12w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0mSvs5xZ7S3HoR1-2rG12w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0mSvs5xZ7S3HoR1-2rG12w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0mSvs5xZ7S3HoR1-2rG12w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0mSvs5xZ7S3HoR1-2rG12w.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*0mSvs5xZ7S3HoR1-2rG12w.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="139" loading="lazy" role="presentation"/></picture></div></figure><p id="1b0d" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Như vậy, với việc thực thi thành công, <strong class="os jb">QcConsol.exe</strong> chắc chắn sẽ phải load <strong class="os jb"><em class="or">QcLite.dll</em></strong> vào để thưc thi malicious code.</p><h2 id="211b" class="ps pt ja bg pu pv pw px gy py pz qa ha qb qc qd qe qf qg qh qi qj qk ql qm qn bl">6. DLL hijacking — Phân tích file QcConsol.exe</h2><p id="fdfd" class="pw-post-body-paragraph op oq ja os b ot qo ov ow ox qp oz pa hb qq pc pd he qr pf pg hh qs pi pj pk ib bl">Load file vào IDA nhận được thông báo:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IvrOBdTzvt6wqAP4FBpnsw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IvrOBdTzvt6wqAP4FBpnsw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IvrOBdTzvt6wqAP4FBpnsw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IvrOBdTzvt6wqAP4FBpnsw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IvrOBdTzvt6wqAP4FBpnsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IvrOBdTzvt6wqAP4FBpnsw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*IvrOBdTzvt6wqAP4FBpnsw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*IvrOBdTzvt6wqAP4FBpnsw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IvrOBdTzvt6wqAP4FBpnsw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IvrOBdTzvt6wqAP4FBpnsw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IvrOBdTzvt6wqAP4FBpnsw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IvrOBdTzvt6wqAP4FBpnsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IvrOBdTzvt6wqAP4FBpnsw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*IvrOBdTzvt6wqAP4FBpnsw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="185" loading="lazy" role="presentation"/></picture></div></figure><p id="46ca" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Để nạp được <strong class="os jb"><em class="or">QcLite.dll</em></strong>, <strong class="os jb"><em class="or">QcConsol.exe</em></strong> sử dụng API <strong class="os jb"><em class="or">LoadLibraryW</em></strong> và sau đó gọi <strong class="os jb"><em class="or">GetProcAddress</em></strong> để lấy địa chỉ của hàm. Về bản chất khi thực hiện nạp module thì đồng thời code của dll cũng sẽ được thực hiện bắt đầu từ <strong class="os jb"><em class="or">DllMain</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*B9tsBlt9hGv5uDw4v-XAkA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*B9tsBlt9hGv5uDw4v-XAkA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*B9tsBlt9hGv5uDw4v-XAkA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*B9tsBlt9hGv5uDw4v-XAkA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*B9tsBlt9hGv5uDw4v-XAkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*B9tsBlt9hGv5uDw4v-XAkA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*B9tsBlt9hGv5uDw4v-XAkA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*B9tsBlt9hGv5uDw4v-XAkA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*B9tsBlt9hGv5uDw4v-XAkA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*B9tsBlt9hGv5uDw4v-XAkA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*B9tsBlt9hGv5uDw4v-XAkA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*B9tsBlt9hGv5uDw4v-XAkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*B9tsBlt9hGv5uDw4v-XAkA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*B9tsBlt9hGv5uDw4v-XAkA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="129" loading="lazy" role="presentation"/></picture></div></figure><h2 id="7ad3" class="ps pt ja bg pu pv pw px gy py pz qa ha qb qc qd qe qf qg qh qi qj qk ql qm qn bl">7. Phân tích sơ bộ file QcLite.dll</h2><p id="0d8f" class="pw-post-body-paragraph op oq ja os b ot qo ov ow ox qp oz pa hb qq pc pd he qr pf pg hh qs pi pj pk ib bl">Gọi hàm <strong class="os jb"><em class="or">VirtualAlloc</em></strong> để cấp phát một vùng nhớ:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nV7fU2Z2BFDFp8jYe-4YAw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nV7fU2Z2BFDFp8jYe-4YAw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nV7fU2Z2BFDFp8jYe-4YAw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nV7fU2Z2BFDFp8jYe-4YAw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nV7fU2Z2BFDFp8jYe-4YAw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nV7fU2Z2BFDFp8jYe-4YAw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*nV7fU2Z2BFDFp8jYe-4YAw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*nV7fU2Z2BFDFp8jYe-4YAw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nV7fU2Z2BFDFp8jYe-4YAw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nV7fU2Z2BFDFp8jYe-4YAw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nV7fU2Z2BFDFp8jYe-4YAw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nV7fU2Z2BFDFp8jYe-4YAw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nV7fU2Z2BFDFp8jYe-4YAw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*nV7fU2Z2BFDFp8jYe-4YAw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="26" loading="lazy" role="presentation"/></picture></div></figure><p id="0f85" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Lấy đường dẫn đầy đủ tới <strong class="os jb"><em class="or">QcLite.dll</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*PrkPSR6Ah4afO1PCGGWkkA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*PrkPSR6Ah4afO1PCGGWkkA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*PrkPSR6Ah4afO1PCGGWkkA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*PrkPSR6Ah4afO1PCGGWkkA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*PrkPSR6Ah4afO1PCGGWkkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*PrkPSR6Ah4afO1PCGGWkkA.png 1100w, https://miro.medium.com/v2/resize:fit:994/format:webp/1*PrkPSR6Ah4afO1PCGGWkkA.png 994w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 497px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*PrkPSR6Ah4afO1PCGGWkkA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*PrkPSR6Ah4afO1PCGGWkkA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*PrkPSR6Ah4afO1PCGGWkkA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*PrkPSR6Ah4afO1PCGGWkkA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*PrkPSR6Ah4afO1PCGGWkkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*PrkPSR6Ah4afO1PCGGWkkA.png 1100w, https://miro.medium.com/v2/resize:fit:994/1*PrkPSR6Ah4afO1PCGGWkkA.png 994w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 497px"/><img alt="" class="bi gl ol c" width="497" height="31" loading="lazy" role="presentation"/></picture></div></figure><p id="9c63" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Dll này sẽ load file <strong class="os jb"><em class="or">.tlb</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*hRyaApDx3lkwh30btqGsOg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*hRyaApDx3lkwh30btqGsOg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*hRyaApDx3lkwh30btqGsOg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*hRyaApDx3lkwh30btqGsOg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*hRyaApDx3lkwh30btqGsOg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hRyaApDx3lkwh30btqGsOg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*hRyaApDx3lkwh30btqGsOg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*hRyaApDx3lkwh30btqGsOg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*hRyaApDx3lkwh30btqGsOg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*hRyaApDx3lkwh30btqGsOg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*hRyaApDx3lkwh30btqGsOg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*hRyaApDx3lkwh30btqGsOg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*hRyaApDx3lkwh30btqGsOg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*hRyaApDx3lkwh30btqGsOg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="57" loading="lazy" role="presentation"/></picture></div></figure><p id="cb9f" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Gọi hàm <strong class="os jb"><em class="or">CreatFileW</em></strong> để mở file này (<strong class="os jb"><em class="or">lpFileName</em></strong> trỏ tới <strong class="os jb">stdole.tlb</strong>):</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zFJ7ra3IYao7KSlp8f7XdQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zFJ7ra3IYao7KSlp8f7XdQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zFJ7ra3IYao7KSlp8f7XdQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zFJ7ra3IYao7KSlp8f7XdQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zFJ7ra3IYao7KSlp8f7XdQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zFJ7ra3IYao7KSlp8f7XdQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*zFJ7ra3IYao7KSlp8f7XdQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*zFJ7ra3IYao7KSlp8f7XdQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zFJ7ra3IYao7KSlp8f7XdQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zFJ7ra3IYao7KSlp8f7XdQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zFJ7ra3IYao7KSlp8f7XdQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zFJ7ra3IYao7KSlp8f7XdQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zFJ7ra3IYao7KSlp8f7XdQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*zFJ7ra3IYao7KSlp8f7XdQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="24" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MmBDqYxKG-GCoVdajmgSBQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MmBDqYxKG-GCoVdajmgSBQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MmBDqYxKG-GCoVdajmgSBQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MmBDqYxKG-GCoVdajmgSBQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MmBDqYxKG-GCoVdajmgSBQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MmBDqYxKG-GCoVdajmgSBQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*MmBDqYxKG-GCoVdajmgSBQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*MmBDqYxKG-GCoVdajmgSBQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MmBDqYxKG-GCoVdajmgSBQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MmBDqYxKG-GCoVdajmgSBQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MmBDqYxKG-GCoVdajmgSBQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MmBDqYxKG-GCoVdajmgSBQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MmBDqYxKG-GCoVdajmgSBQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*MmBDqYxKG-GCoVdajmgSBQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="106" loading="lazy" role="presentation"/></picture></div></figure><p id="764f" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Lấy kích thước của <strong class="os jb"><em class="or">stdole.tlb</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div role="button" tabindex="0" class="qv qw fr qx bi qy"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oc od rq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*yZoKxfedYZYH7GYrwhegtg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*yZoKxfedYZYH7GYrwhegtg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*yZoKxfedYZYH7GYrwhegtg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*yZoKxfedYZYH7GYrwhegtg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*yZoKxfedYZYH7GYrwhegtg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*yZoKxfedYZYH7GYrwhegtg.png 1100w, https://miro.medium.com/v2/resize:fit:802/format:webp/1*yZoKxfedYZYH7GYrwhegtg.png 802w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 401px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*yZoKxfedYZYH7GYrwhegtg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*yZoKxfedYZYH7GYrwhegtg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*yZoKxfedYZYH7GYrwhegtg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*yZoKxfedYZYH7GYrwhegtg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*yZoKxfedYZYH7GYrwhegtg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*yZoKxfedYZYH7GYrwhegtg.png 1100w, https://miro.medium.com/v2/resize:fit:802/1*yZoKxfedYZYH7GYrwhegtg.png 802w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 401px"/><img alt="" class="bi gl ol c" width="401" height="30" loading="lazy" role="presentation"/></picture></div></div></figure><p id="776e" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Đọc dữ liệu từ <strong class="os jb"><em class="or">stdole.tlb</em></strong> và lưu vào vùng nhớ đã cấp phát ở trên:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*d3iWpifNiCE8Ul4Enk25ow.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*d3iWpifNiCE8Ul4Enk25ow.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*d3iWpifNiCE8Ul4Enk25ow.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*d3iWpifNiCE8Ul4Enk25ow.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*d3iWpifNiCE8Ul4Enk25ow.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*d3iWpifNiCE8Ul4Enk25ow.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*d3iWpifNiCE8Ul4Enk25ow.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*d3iWpifNiCE8Ul4Enk25ow.png 640w, https://miro.medium.com/v2/resize:fit:720/1*d3iWpifNiCE8Ul4Enk25ow.png 720w, https://miro.medium.com/v2/resize:fit:750/1*d3iWpifNiCE8Ul4Enk25ow.png 750w, https://miro.medium.com/v2/resize:fit:786/1*d3iWpifNiCE8Ul4Enk25ow.png 786w, https://miro.medium.com/v2/resize:fit:828/1*d3iWpifNiCE8Ul4Enk25ow.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*d3iWpifNiCE8Ul4Enk25ow.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*d3iWpifNiCE8Ul4Enk25ow.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="39" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*87qbjS1eLYfYzcGHZP8xZg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*87qbjS1eLYfYzcGHZP8xZg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*87qbjS1eLYfYzcGHZP8xZg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*87qbjS1eLYfYzcGHZP8xZg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*87qbjS1eLYfYzcGHZP8xZg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*87qbjS1eLYfYzcGHZP8xZg.png 1100w, https://miro.medium.com/v2/resize:fit:1002/format:webp/1*87qbjS1eLYfYzcGHZP8xZg.png 1002w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 501px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*87qbjS1eLYfYzcGHZP8xZg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*87qbjS1eLYfYzcGHZP8xZg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*87qbjS1eLYfYzcGHZP8xZg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*87qbjS1eLYfYzcGHZP8xZg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*87qbjS1eLYfYzcGHZP8xZg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*87qbjS1eLYfYzcGHZP8xZg.png 1100w, https://miro.medium.com/v2/resize:fit:1002/1*87qbjS1eLYfYzcGHZP8xZg.png 1002w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 501px"/><img alt="" class="bi gl ol c" width="501" height="110" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FMBqm5NmdZLhx42YzytGLg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FMBqm5NmdZLhx42YzytGLg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FMBqm5NmdZLhx42YzytGLg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FMBqm5NmdZLhx42YzytGLg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FMBqm5NmdZLhx42YzytGLg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FMBqm5NmdZLhx42YzytGLg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*FMBqm5NmdZLhx42YzytGLg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*FMBqm5NmdZLhx42YzytGLg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FMBqm5NmdZLhx42YzytGLg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FMBqm5NmdZLhx42YzytGLg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FMBqm5NmdZLhx42YzytGLg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FMBqm5NmdZLhx42YzytGLg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FMBqm5NmdZLhx42YzytGLg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*FMBqm5NmdZLhx42YzytGLg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="81" loading="lazy" role="presentation"/></picture></div></figure><p id="e6ba" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Thực hiện vòng lặp sử dụng <strong class="os jb"><em class="or">xor</em></strong> để decode toàn bộ dữ liệu của <strong class="os jb"><em class="or">stdole.tlb</em></strong> đã được copy lên memory:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*K4Fo5l49ACd4CsXnwgBK0A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*K4Fo5l49ACd4CsXnwgBK0A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*K4Fo5l49ACd4CsXnwgBK0A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*K4Fo5l49ACd4CsXnwgBK0A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*K4Fo5l49ACd4CsXnwgBK0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*K4Fo5l49ACd4CsXnwgBK0A.png 1100w, https://miro.medium.com/v2/resize:fit:1112/format:webp/1*K4Fo5l49ACd4CsXnwgBK0A.png 1112w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 556px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*K4Fo5l49ACd4CsXnwgBK0A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*K4Fo5l49ACd4CsXnwgBK0A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*K4Fo5l49ACd4CsXnwgBK0A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*K4Fo5l49ACd4CsXnwgBK0A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*K4Fo5l49ACd4CsXnwgBK0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*K4Fo5l49ACd4CsXnwgBK0A.png 1100w, https://miro.medium.com/v2/resize:fit:1112/1*K4Fo5l49ACd4CsXnwgBK0A.png 1112w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 556px"/><img alt="" class="bi gl ol c" width="556" height="542" loading="lazy" role="presentation"/></picture></div></figure><p id="671a" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Kết quả có được sau khi decode, nghi ngờ khả năng đây có thể sẽ là một PE file khác:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zVERaNhRUIGU0ZlVC2KSMA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zVERaNhRUIGU0ZlVC2KSMA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zVERaNhRUIGU0ZlVC2KSMA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zVERaNhRUIGU0ZlVC2KSMA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zVERaNhRUIGU0ZlVC2KSMA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zVERaNhRUIGU0ZlVC2KSMA.png 1100w, https://miro.medium.com/v2/resize:fit:1180/format:webp/1*zVERaNhRUIGU0ZlVC2KSMA.png 1180w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 590px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*zVERaNhRUIGU0ZlVC2KSMA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zVERaNhRUIGU0ZlVC2KSMA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zVERaNhRUIGU0ZlVC2KSMA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zVERaNhRUIGU0ZlVC2KSMA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zVERaNhRUIGU0ZlVC2KSMA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zVERaNhRUIGU0ZlVC2KSMA.png 1100w, https://miro.medium.com/v2/resize:fit:1180/1*zVERaNhRUIGU0ZlVC2KSMA.png 1180w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 590px"/><img alt="" class="bi gl ol c" width="590" height="453" loading="lazy" role="presentation"/></picture></div></figure><p id="b4a3" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Qua rất nhiều <em class="or">rop_chain</em> (tôi đoán thế :D) thì sẽ nhảy tới vùng nhớ trên để thực thi code (<em class="or">Cách nhanh nhất thì các bạn có thể đặt một </em><strong class="os jb"><em class="or">HWBP on Execute</em></strong><em class="or"> tại 4 bytes đầu </em><strong class="os jb"><em class="or">0x50 0x68 0xA7 0x45</em></strong><em class="or">; sau đó nhấn F9 là tới</em>):</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HwhmVYJs-EAk1x35gTGAbg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*HwhmVYJs-EAk1x35gTGAbg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*HwhmVYJs-EAk1x35gTGAbg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*HwhmVYJs-EAk1x35gTGAbg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*HwhmVYJs-EAk1x35gTGAbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*HwhmVYJs-EAk1x35gTGAbg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*HwhmVYJs-EAk1x35gTGAbg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*HwhmVYJs-EAk1x35gTGAbg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*HwhmVYJs-EAk1x35gTGAbg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*HwhmVYJs-EAk1x35gTGAbg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*HwhmVYJs-EAk1x35gTGAbg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*HwhmVYJs-EAk1x35gTGAbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*HwhmVYJs-EAk1x35gTGAbg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*HwhmVYJs-EAk1x35gTGAbg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="295" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*GygNk5sRuCLYk_PA57CK9g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GygNk5sRuCLYk_PA57CK9g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GygNk5sRuCLYk_PA57CK9g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GygNk5sRuCLYk_PA57CK9g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GygNk5sRuCLYk_PA57CK9g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GygNk5sRuCLYk_PA57CK9g.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*GygNk5sRuCLYk_PA57CK9g.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*GygNk5sRuCLYk_PA57CK9g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GygNk5sRuCLYk_PA57CK9g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GygNk5sRuCLYk_PA57CK9g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GygNk5sRuCLYk_PA57CK9g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GygNk5sRuCLYk_PA57CK9g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GygNk5sRuCLYk_PA57CK9g.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*GygNk5sRuCLYk_PA57CK9g.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="57" loading="lazy" role="presentation"/></picture></div></figure><p id="7cbb" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Shellcode tại <strong class="os jb"><em class="or">0x01A10000</em></strong> sẽ truy cập <strong class="os jb"><em class="or">PEB (Process Environment Block)</em></strong> để lấy ra địa chỉ base address của <strong class="os jb"><em class="or">kernel32.dll</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od ru"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dDadL0KBC8O8x6KqB7OccA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dDadL0KBC8O8x6KqB7OccA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dDadL0KBC8O8x6KqB7OccA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dDadL0KBC8O8x6KqB7OccA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dDadL0KBC8O8x6KqB7OccA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dDadL0KBC8O8x6KqB7OccA.png 1100w, https://miro.medium.com/v2/resize:fit:494/format:webp/1*dDadL0KBC8O8x6KqB7OccA.png 494w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 247px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*dDadL0KBC8O8x6KqB7OccA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dDadL0KBC8O8x6KqB7OccA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dDadL0KBC8O8x6KqB7OccA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dDadL0KBC8O8x6KqB7OccA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dDadL0KBC8O8x6KqB7OccA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dDadL0KBC8O8x6KqB7OccA.png 1100w, https://miro.medium.com/v2/resize:fit:494/1*dDadL0KBC8O8x6KqB7OccA.png 494w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 247px"/><img alt="" class="bi gl ol c" width="247" height="223" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fMLtLweHn29WGhQ54gQGuA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fMLtLweHn29WGhQ54gQGuA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fMLtLweHn29WGhQ54gQGuA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fMLtLweHn29WGhQ54gQGuA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fMLtLweHn29WGhQ54gQGuA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fMLtLweHn29WGhQ54gQGuA.png 1100w, https://miro.medium.com/v2/resize:fit:1076/format:webp/1*fMLtLweHn29WGhQ54gQGuA.png 1076w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 538px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*fMLtLweHn29WGhQ54gQGuA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fMLtLweHn29WGhQ54gQGuA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fMLtLweHn29WGhQ54gQGuA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fMLtLweHn29WGhQ54gQGuA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fMLtLweHn29WGhQ54gQGuA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fMLtLweHn29WGhQ54gQGuA.png 1100w, https://miro.medium.com/v2/resize:fit:1076/1*fMLtLweHn29WGhQ54gQGuA.png 1076w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 538px"/><img alt="" class="bi gl ol c" width="538" height="154" loading="lazy" role="presentation"/></picture></div></figure><p id="875d" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Sau khi có được base address của <strong class="os jb"><em class="or">kernel32.dll</em></strong>, shellcode sẽ tìm địa chỉ của hàm API <strong class="os jb"><em class="or">GetProcAddress</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*OWi2TYbx2opIVPLGEWEmKw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*OWi2TYbx2opIVPLGEWEmKw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*OWi2TYbx2opIVPLGEWEmKw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*OWi2TYbx2opIVPLGEWEmKw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*OWi2TYbx2opIVPLGEWEmKw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*OWi2TYbx2opIVPLGEWEmKw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*OWi2TYbx2opIVPLGEWEmKw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*OWi2TYbx2opIVPLGEWEmKw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*OWi2TYbx2opIVPLGEWEmKw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*OWi2TYbx2opIVPLGEWEmKw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*OWi2TYbx2opIVPLGEWEmKw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*OWi2TYbx2opIVPLGEWEmKw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*OWi2TYbx2opIVPLGEWEmKw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*OWi2TYbx2opIVPLGEWEmKw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="338" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MDAM8M8aIjNSBYx3YwxGaQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MDAM8M8aIjNSBYx3YwxGaQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MDAM8M8aIjNSBYx3YwxGaQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MDAM8M8aIjNSBYx3YwxGaQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MDAM8M8aIjNSBYx3YwxGaQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MDAM8M8aIjNSBYx3YwxGaQ.png 1100w, https://miro.medium.com/v2/resize:fit:654/format:webp/1*MDAM8M8aIjNSBYx3YwxGaQ.png 654w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 327px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*MDAM8M8aIjNSBYx3YwxGaQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MDAM8M8aIjNSBYx3YwxGaQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MDAM8M8aIjNSBYx3YwxGaQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MDAM8M8aIjNSBYx3YwxGaQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MDAM8M8aIjNSBYx3YwxGaQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MDAM8M8aIjNSBYx3YwxGaQ.png 1100w, https://miro.medium.com/v2/resize:fit:654/1*MDAM8M8aIjNSBYx3YwxGaQ.png 654w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 327px"/><img alt="" class="bi gl ol c" width="327" height="47" loading="lazy" role="presentation"/></picture></div></figure><p id="1f07" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Với hàm API <strong class="os jb"><em class="or">GetProcAddress</em></strong>, shellcode sẽ lấy địa chỉ của các hàm API khác là <strong class="os jb"><em class="or">LoadLibraryA</em></strong>, <strong class="os jb"><em class="or">VirtualAlloc</em></strong>, <strong class="os jb"><em class="or">FreeLibraryA</em></strong>, <strong class="os jb"><em class="or">Sleep</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DzaZkhiwzDJQYnIQGj6MWw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DzaZkhiwzDJQYnIQGj6MWw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DzaZkhiwzDJQYnIQGj6MWw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DzaZkhiwzDJQYnIQGj6MWw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DzaZkhiwzDJQYnIQGj6MWw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DzaZkhiwzDJQYnIQGj6MWw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*DzaZkhiwzDJQYnIQGj6MWw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*DzaZkhiwzDJQYnIQGj6MWw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DzaZkhiwzDJQYnIQGj6MWw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DzaZkhiwzDJQYnIQGj6MWw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DzaZkhiwzDJQYnIQGj6MWw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DzaZkhiwzDJQYnIQGj6MWw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DzaZkhiwzDJQYnIQGj6MWw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*DzaZkhiwzDJQYnIQGj6MWw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="206" loading="lazy" role="presentation"/></picture></div></figure><p id="09a0" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Sử dụng hàm <strong class="os jb"><em class="or">VirtualAlloc</em></strong> để cấp phát một vùng nhớ và gọi hàm <strong class="os jb"><em class="or">decode_data()</em></strong> để decode bytes trong shellcode vào vùng nhớ cấp phát:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3re1i7xXitmEbbNqXhXKAg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3re1i7xXitmEbbNqXhXKAg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3re1i7xXitmEbbNqXhXKAg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3re1i7xXitmEbbNqXhXKAg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3re1i7xXitmEbbNqXhXKAg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3re1i7xXitmEbbNqXhXKAg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*3re1i7xXitmEbbNqXhXKAg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3re1i7xXitmEbbNqXhXKAg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3re1i7xXitmEbbNqXhXKAg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3re1i7xXitmEbbNqXhXKAg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3re1i7xXitmEbbNqXhXKAg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3re1i7xXitmEbbNqXhXKAg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3re1i7xXitmEbbNqXhXKAg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*3re1i7xXitmEbbNqXhXKAg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="168" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_Qnw8IK_ckVF8hsxcnoTVA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_Qnw8IK_ckVF8hsxcnoTVA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_Qnw8IK_ckVF8hsxcnoTVA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_Qnw8IK_ckVF8hsxcnoTVA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_Qnw8IK_ckVF8hsxcnoTVA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_Qnw8IK_ckVF8hsxcnoTVA.png 1100w, https://miro.medium.com/v2/resize:fit:1184/format:webp/1*_Qnw8IK_ckVF8hsxcnoTVA.png 1184w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 592px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*_Qnw8IK_ckVF8hsxcnoTVA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_Qnw8IK_ckVF8hsxcnoTVA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_Qnw8IK_ckVF8hsxcnoTVA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_Qnw8IK_ckVF8hsxcnoTVA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_Qnw8IK_ckVF8hsxcnoTVA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_Qnw8IK_ckVF8hsxcnoTVA.png 1100w, https://miro.medium.com/v2/resize:fit:1184/1*_Qnw8IK_ckVF8hsxcnoTVA.png 1184w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 592px"/><img alt="" class="bi gl ol c" width="592" height="399" loading="lazy" role="presentation"/></picture></div></figure><p id="8d88" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tiếp tục sử dụng <strong class="os jb"><em class="or">VirtualAlloc</em></strong> để cấp phát thêm một vùng nhớ khác với kích thước lấy từ vùng nhớ trên (<strong class="os jb"><em class="or">dwSize = SizeOfImage = PE_header + 0x50</em></strong>) và thiết lập vùng nhớ mới này là <strong class="os jb"><em class="or">PAGE_EXECUTE_READWRITE</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*K6nH25yfQ-OyRgkLR5LB6g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*K6nH25yfQ-OyRgkLR5LB6g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*K6nH25yfQ-OyRgkLR5LB6g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*K6nH25yfQ-OyRgkLR5LB6g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*K6nH25yfQ-OyRgkLR5LB6g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*K6nH25yfQ-OyRgkLR5LB6g.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*K6nH25yfQ-OyRgkLR5LB6g.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*K6nH25yfQ-OyRgkLR5LB6g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*K6nH25yfQ-OyRgkLR5LB6g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*K6nH25yfQ-OyRgkLR5LB6g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*K6nH25yfQ-OyRgkLR5LB6g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*K6nH25yfQ-OyRgkLR5LB6g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*K6nH25yfQ-OyRgkLR5LB6g.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*K6nH25yfQ-OyRgkLR5LB6g.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="193" loading="lazy" role="presentation"/></picture></div></figure><p id="4599" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Sau khi lấy được section header tại vùng nhớ <strong class="os jb"><em class="or">0x01880000</em></strong> ở trên, thực hiện vòng lặp để copy toàn bộ các section data sang vùng nhớ mới được cấp phát:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*vxQXLmQq3LOB-vOdQ2m3ag.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*vxQXLmQq3LOB-vOdQ2m3ag.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*vxQXLmQq3LOB-vOdQ2m3ag.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*vxQXLmQq3LOB-vOdQ2m3ag.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*vxQXLmQq3LOB-vOdQ2m3ag.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vxQXLmQq3LOB-vOdQ2m3ag.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*vxQXLmQq3LOB-vOdQ2m3ag.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*vxQXLmQq3LOB-vOdQ2m3ag.png 640w, https://miro.medium.com/v2/resize:fit:720/1*vxQXLmQq3LOB-vOdQ2m3ag.png 720w, https://miro.medium.com/v2/resize:fit:750/1*vxQXLmQq3LOB-vOdQ2m3ag.png 750w, https://miro.medium.com/v2/resize:fit:786/1*vxQXLmQq3LOB-vOdQ2m3ag.png 786w, https://miro.medium.com/v2/resize:fit:828/1*vxQXLmQq3LOB-vOdQ2m3ag.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*vxQXLmQq3LOB-vOdQ2m3ag.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*vxQXLmQq3LOB-vOdQ2m3ag.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="543" loading="lazy" role="presentation"/></picture></div></figure><p id="316f" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tiến hành resolve toàn bộ địa chỉ API ghi lại vào IAT của vùng nhớ mới:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od ry"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*rrfeJG8WopL_o3jsnVyXiQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*rrfeJG8WopL_o3jsnVyXiQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*rrfeJG8WopL_o3jsnVyXiQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*rrfeJG8WopL_o3jsnVyXiQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*rrfeJG8WopL_o3jsnVyXiQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rrfeJG8WopL_o3jsnVyXiQ.png 1100w, https://miro.medium.com/v2/resize:fit:1050/format:webp/1*rrfeJG8WopL_o3jsnVyXiQ.png 1050w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 525px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*rrfeJG8WopL_o3jsnVyXiQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*rrfeJG8WopL_o3jsnVyXiQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*rrfeJG8WopL_o3jsnVyXiQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*rrfeJG8WopL_o3jsnVyXiQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*rrfeJG8WopL_o3jsnVyXiQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*rrfeJG8WopL_o3jsnVyXiQ.png 1100w, https://miro.medium.com/v2/resize:fit:1050/1*rrfeJG8WopL_o3jsnVyXiQ.png 1050w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 525px"/><img alt="" class="bi gl ol c" width="525" height="533" loading="lazy" role="presentation"/></picture></div></figure><p id="60fa" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Sau khi lấy địa chỉ của toàn bộ các API cần thiết, sử dụng lệnh call để nhảy tới vùng nhớ để thực hiện lệnh:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od ro"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JU_YXrnniTDMepCHDBZhZQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JU_YXrnniTDMepCHDBZhZQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JU_YXrnniTDMepCHDBZhZQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JU_YXrnniTDMepCHDBZhZQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JU_YXrnniTDMepCHDBZhZQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JU_YXrnniTDMepCHDBZhZQ.png 1100w, https://miro.medium.com/v2/resize:fit:1234/format:webp/1*JU_YXrnniTDMepCHDBZhZQ.png 1234w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 617px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*JU_YXrnniTDMepCHDBZhZQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JU_YXrnniTDMepCHDBZhZQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JU_YXrnniTDMepCHDBZhZQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JU_YXrnniTDMepCHDBZhZQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JU_YXrnniTDMepCHDBZhZQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JU_YXrnniTDMepCHDBZhZQ.png 1100w, https://miro.medium.com/v2/resize:fit:1234/1*JU_YXrnniTDMepCHDBZhZQ.png 1234w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 617px"/><img alt="" class="bi gl ol c" width="617" height="61" loading="lazy" role="presentation"/></picture></div></figure><p id="d090" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tiếp tục debug xuyên qua nhiều lớp call sẽ tới đoạn gọi hàm <strong class="os jb"><em class="or">CreateThread</em></strong> để tạo một thread mới:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9niZGU2WGqziUv2w6tPVWA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9niZGU2WGqziUv2w6tPVWA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9niZGU2WGqziUv2w6tPVWA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9niZGU2WGqziUv2w6tPVWA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9niZGU2WGqziUv2w6tPVWA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9niZGU2WGqziUv2w6tPVWA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*9niZGU2WGqziUv2w6tPVWA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*9niZGU2WGqziUv2w6tPVWA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9niZGU2WGqziUv2w6tPVWA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9niZGU2WGqziUv2w6tPVWA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9niZGU2WGqziUv2w6tPVWA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9niZGU2WGqziUv2w6tPVWA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9niZGU2WGqziUv2w6tPVWA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*9niZGU2WGqziUv2w6tPVWA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="194" loading="lazy" role="presentation"/></picture></div></figure><p id="c8f4" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Đi tới <em class="or">ThreadFunction</em> tại địa chỉ <strong class="os jb"><em class="or">0x01EE35D0</em></strong>. Code tại đây thực hiện lấy thông tin binary có sẵn của Windows là <strong class="os jb"><em class="or">dllhst3g.exe</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lqw2UxB-bQRoGvEfuuHwIg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lqw2UxB-bQRoGvEfuuHwIg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lqw2UxB-bQRoGvEfuuHwIg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lqw2UxB-bQRoGvEfuuHwIg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lqw2UxB-bQRoGvEfuuHwIg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lqw2UxB-bQRoGvEfuuHwIg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*lqw2UxB-bQRoGvEfuuHwIg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lqw2UxB-bQRoGvEfuuHwIg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lqw2UxB-bQRoGvEfuuHwIg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lqw2UxB-bQRoGvEfuuHwIg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lqw2UxB-bQRoGvEfuuHwIg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lqw2UxB-bQRoGvEfuuHwIg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lqw2UxB-bQRoGvEfuuHwIg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*lqw2UxB-bQRoGvEfuuHwIg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="58" loading="lazy" role="presentation"/></picture></div></figure><p id="274b" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Xem tổng quan code thì thấy có đoạn code liên quan đến C2 (<em class="or">login[dot]dangquanwatch[dot]com</em>):</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nf0I4fLH7MD1B9GcHDqbrw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nf0I4fLH7MD1B9GcHDqbrw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nf0I4fLH7MD1B9GcHDqbrw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nf0I4fLH7MD1B9GcHDqbrw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nf0I4fLH7MD1B9GcHDqbrw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nf0I4fLH7MD1B9GcHDqbrw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*nf0I4fLH7MD1B9GcHDqbrw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*nf0I4fLH7MD1B9GcHDqbrw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nf0I4fLH7MD1B9GcHDqbrw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nf0I4fLH7MD1B9GcHDqbrw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nf0I4fLH7MD1B9GcHDqbrw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nf0I4fLH7MD1B9GcHDqbrw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nf0I4fLH7MD1B9GcHDqbrw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*nf0I4fLH7MD1B9GcHDqbrw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="45" loading="lazy" role="presentation"/></picture></div></figure><p id="2a36" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tạo một thread khác làm nhiệm vụ tạo Persistent trong Registry <strong class="os jb"><em class="or">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zy4za7POBmrjG1YkZ2_O6A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zy4za7POBmrjG1YkZ2_O6A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zy4za7POBmrjG1YkZ2_O6A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zy4za7POBmrjG1YkZ2_O6A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zy4za7POBmrjG1YkZ2_O6A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zy4za7POBmrjG1YkZ2_O6A.png 1100w, https://miro.medium.com/v2/resize:fit:852/format:webp/1*zy4za7POBmrjG1YkZ2_O6A.png 852w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 426px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*zy4za7POBmrjG1YkZ2_O6A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zy4za7POBmrjG1YkZ2_O6A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zy4za7POBmrjG1YkZ2_O6A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zy4za7POBmrjG1YkZ2_O6A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zy4za7POBmrjG1YkZ2_O6A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zy4za7POBmrjG1YkZ2_O6A.png 1100w, https://miro.medium.com/v2/resize:fit:852/1*zy4za7POBmrjG1YkZ2_O6A.png 852w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 426px"/><img alt="" class="bi gl ol c" width="426" height="132" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XZZ53K4_iEwx7ftjLk5DTg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XZZ53K4_iEwx7ftjLk5DTg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XZZ53K4_iEwx7ftjLk5DTg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XZZ53K4_iEwx7ftjLk5DTg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XZZ53K4_iEwx7ftjLk5DTg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XZZ53K4_iEwx7ftjLk5DTg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*XZZ53K4_iEwx7ftjLk5DTg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XZZ53K4_iEwx7ftjLk5DTg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XZZ53K4_iEwx7ftjLk5DTg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XZZ53K4_iEwx7ftjLk5DTg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XZZ53K4_iEwx7ftjLk5DTg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XZZ53K4_iEwx7ftjLk5DTg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XZZ53K4_iEwx7ftjLk5DTg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*XZZ53K4_iEwx7ftjLk5DTg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="30" loading="lazy" role="presentation"/></picture></div></figure><p id="0216" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Gọi hàm <strong class="os jb"><em class="or">WritePrivateProfileStringW</em></strong> để ghi string vào file tại “<strong class="os jb"><em class="or">C:\ProgramData\desktop.ini</em></strong>”:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*x6ZVTRZxezwE1TjVOr1PeQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*x6ZVTRZxezwE1TjVOr1PeQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*x6ZVTRZxezwE1TjVOr1PeQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*x6ZVTRZxezwE1TjVOr1PeQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*x6ZVTRZxezwE1TjVOr1PeQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*x6ZVTRZxezwE1TjVOr1PeQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*x6ZVTRZxezwE1TjVOr1PeQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*x6ZVTRZxezwE1TjVOr1PeQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*x6ZVTRZxezwE1TjVOr1PeQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*x6ZVTRZxezwE1TjVOr1PeQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*x6ZVTRZxezwE1TjVOr1PeQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*x6ZVTRZxezwE1TjVOr1PeQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*x6ZVTRZxezwE1TjVOr1PeQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*x6ZVTRZxezwE1TjVOr1PeQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="72" loading="lazy" role="presentation"/></picture></div></figure><p id="bd97" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Thiết lập thuộc tính cho file với hàm <strong class="os jb"><em class="or">SetFileAttributesW</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od sa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7uykeVzDjXTmYI0gVwI3rw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7uykeVzDjXTmYI0gVwI3rw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7uykeVzDjXTmYI0gVwI3rw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7uykeVzDjXTmYI0gVwI3rw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7uykeVzDjXTmYI0gVwI3rw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7uykeVzDjXTmYI0gVwI3rw.png 1100w, https://miro.medium.com/v2/resize:fit:1078/format:webp/1*7uykeVzDjXTmYI0gVwI3rw.png 1078w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 539px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*7uykeVzDjXTmYI0gVwI3rw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7uykeVzDjXTmYI0gVwI3rw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7uykeVzDjXTmYI0gVwI3rw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7uykeVzDjXTmYI0gVwI3rw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7uykeVzDjXTmYI0gVwI3rw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7uykeVzDjXTmYI0gVwI3rw.png 1100w, https://miro.medium.com/v2/resize:fit:1078/1*7uykeVzDjXTmYI0gVwI3rw.png 1078w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 539px"/><img alt="" class="bi gl ol c" width="539" height="68" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8X7YB5QeTY3JwR0_gncO5w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8X7YB5QeTY3JwR0_gncO5w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8X7YB5QeTY3JwR0_gncO5w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8X7YB5QeTY3JwR0_gncO5w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8X7YB5QeTY3JwR0_gncO5w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8X7YB5QeTY3JwR0_gncO5w.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*8X7YB5QeTY3JwR0_gncO5w.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*8X7YB5QeTY3JwR0_gncO5w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8X7YB5QeTY3JwR0_gncO5w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8X7YB5QeTY3JwR0_gncO5w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8X7YB5QeTY3JwR0_gncO5w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8X7YB5QeTY3JwR0_gncO5w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8X7YB5QeTY3JwR0_gncO5w.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*8X7YB5QeTY3JwR0_gncO5w.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="88" loading="lazy" role="presentation"/></picture></div></figure><p id="2a3d" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tạo một <em class="or">Mutex {986AFDE7-F299–4A7D-BBF4-CA756FC01F1B65027208}</em>, tuy nhiên handle tới mutext này sẽ bị đóng ngay sau đó:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lAWNwebWDuCwkDdtIt875A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lAWNwebWDuCwkDdtIt875A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lAWNwebWDuCwkDdtIt875A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lAWNwebWDuCwkDdtIt875A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lAWNwebWDuCwkDdtIt875A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lAWNwebWDuCwkDdtIt875A.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*lAWNwebWDuCwkDdtIt875A.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lAWNwebWDuCwkDdtIt875A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lAWNwebWDuCwkDdtIt875A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lAWNwebWDuCwkDdtIt875A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lAWNwebWDuCwkDdtIt875A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lAWNwebWDuCwkDdtIt875A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lAWNwebWDuCwkDdtIt875A.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*lAWNwebWDuCwkDdtIt875A.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="53" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*P1Bx4-JRniESihO06Bh79Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*P1Bx4-JRniESihO06Bh79Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*P1Bx4-JRniESihO06Bh79Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*P1Bx4-JRniESihO06Bh79Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*P1Bx4-JRniESihO06Bh79Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*P1Bx4-JRniESihO06Bh79Q.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*P1Bx4-JRniESihO06Bh79Q.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*P1Bx4-JRniESihO06Bh79Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*P1Bx4-JRniESihO06Bh79Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*P1Bx4-JRniESihO06Bh79Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*P1Bx4-JRniESihO06Bh79Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*P1Bx4-JRniESihO06Bh79Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*P1Bx4-JRniESihO06Bh79Q.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*P1Bx4-JRniESihO06Bh79Q.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="116" loading="lazy" role="presentation"/></picture></div></figure><p id="81f9" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tiếp tục sử dụng bộ API <strong class="os jb"><em class="or">CreateFileW</em></strong>, <strong class="os jb"><em class="or">GetFileSize</em></strong>, <strong class="os jb"><em class="or">VirtualAlloc</em></strong>, <strong class="os jb"><em class="or">ReadFile</em></strong> để một lần nữa đọc ra nội dung được lưu trong file <strong class="os jb"><em class="or">%AppData%\Microsoft\Windows\Printer Shortcuts\stdole.tlb</em></strong> và thực hiện decode dữ liệu giống như đã nói ở bước trước:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div role="button" tabindex="0" class="qv qw fr qx bi qy"><span class="fw fx fy ao fz ga gb gc gd speechify-ignore">Press enter or click to view image in full size</span><div class="oc od sb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*iky4qcKwNaBR6cse20X7bw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*iky4qcKwNaBR6cse20X7bw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*iky4qcKwNaBR6cse20X7bw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*iky4qcKwNaBR6cse20X7bw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*iky4qcKwNaBR6cse20X7bw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*iky4qcKwNaBR6cse20X7bw.png 1100w, https://miro.medium.com/v2/resize:fit:1186/format:webp/1*iky4qcKwNaBR6cse20X7bw.png 1186w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 593px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*iky4qcKwNaBR6cse20X7bw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*iky4qcKwNaBR6cse20X7bw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*iky4qcKwNaBR6cse20X7bw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*iky4qcKwNaBR6cse20X7bw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*iky4qcKwNaBR6cse20X7bw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*iky4qcKwNaBR6cse20X7bw.png 1100w, https://miro.medium.com/v2/resize:fit:1186/1*iky4qcKwNaBR6cse20X7bw.png 1186w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 593px"/><img alt="" class="bi gl ol c" width="593" height="231" loading="lazy" role="presentation"/></picture></div></div></figure><p id="a8a4" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Thực hiện kĩ thuật inject code bằng cách gọi hàm <strong class="os jb"><em class="or">CreateProcessW</em></strong> để khởi động tiến trình <strong class="os jb"><em class="or">dllhst3g.exe</em></strong> ở trạng thái <strong class="os jb"><em class="or">Suspended</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FLbPMpQ_-NoLLHIq2eZWbA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FLbPMpQ_-NoLLHIq2eZWbA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FLbPMpQ_-NoLLHIq2eZWbA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FLbPMpQ_-NoLLHIq2eZWbA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FLbPMpQ_-NoLLHIq2eZWbA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FLbPMpQ_-NoLLHIq2eZWbA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*FLbPMpQ_-NoLLHIq2eZWbA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*FLbPMpQ_-NoLLHIq2eZWbA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FLbPMpQ_-NoLLHIq2eZWbA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FLbPMpQ_-NoLLHIq2eZWbA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FLbPMpQ_-NoLLHIq2eZWbA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FLbPMpQ_-NoLLHIq2eZWbA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FLbPMpQ_-NoLLHIq2eZWbA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*FLbPMpQ_-NoLLHIq2eZWbA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="175" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od sc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BpVkqjeuBm7MJfyVTlgEJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BpVkqjeuBm7MJfyVTlgEJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BpVkqjeuBm7MJfyVTlgEJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BpVkqjeuBm7MJfyVTlgEJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BpVkqjeuBm7MJfyVTlgEJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BpVkqjeuBm7MJfyVTlgEJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1246/format:webp/1*BpVkqjeuBm7MJfyVTlgEJQ.png 1246w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 623px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*BpVkqjeuBm7MJfyVTlgEJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BpVkqjeuBm7MJfyVTlgEJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BpVkqjeuBm7MJfyVTlgEJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BpVkqjeuBm7MJfyVTlgEJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BpVkqjeuBm7MJfyVTlgEJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BpVkqjeuBm7MJfyVTlgEJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1246/1*BpVkqjeuBm7MJfyVTlgEJQ.png 1246w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 623px"/><img alt="" class="bi gl ol c" width="623" height="168" loading="lazy" role="presentation"/></picture></div></figure><p id="18d4" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Cấp phát vùng nhớ trong tiến trình này thông qua hàm <strong class="os jb"><em class="or">VirtualAllocEx</em></strong>:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tTqmJDG-TjyO-de7Z6A2Vw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tTqmJDG-TjyO-de7Z6A2Vw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tTqmJDG-TjyO-de7Z6A2Vw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tTqmJDG-TjyO-de7Z6A2Vw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tTqmJDG-TjyO-de7Z6A2Vw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tTqmJDG-TjyO-de7Z6A2Vw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*tTqmJDG-TjyO-de7Z6A2Vw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*tTqmJDG-TjyO-de7Z6A2Vw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tTqmJDG-TjyO-de7Z6A2Vw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tTqmJDG-TjyO-de7Z6A2Vw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tTqmJDG-TjyO-de7Z6A2Vw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tTqmJDG-TjyO-de7Z6A2Vw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tTqmJDG-TjyO-de7Z6A2Vw.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*tTqmJDG-TjyO-de7Z6A2Vw.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="93" loading="lazy" role="presentation"/></picture></div></figure><p id="aeb2" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Gọi hàm <strong class="os jb"><em class="or">WriteProcessMemory</em></strong> để ghi dữ liệu từ <strong class="os jb"><em class="or">0x00F90000</em></strong> (<em class="or">buffer chứa data đã decode của stdole.tlb</em>) vào vùng nhớ đã cấp phát tại tiến trình <strong class="os jb"><em class="or">dllhst3g.exe</em></strong>, đặt lại thread context và resume thread. Lúc này <strong class="os jb"><em class="or">dllhst3g.exe</em></strong> sẽ thực thi bình thường và thực thi luôn malicious code:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4wbw8KP_DATfZMot7GHi_w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4wbw8KP_DATfZMot7GHi_w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4wbw8KP_DATfZMot7GHi_w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4wbw8KP_DATfZMot7GHi_w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4wbw8KP_DATfZMot7GHi_w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4wbw8KP_DATfZMot7GHi_w.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*4wbw8KP_DATfZMot7GHi_w.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*4wbw8KP_DATfZMot7GHi_w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4wbw8KP_DATfZMot7GHi_w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4wbw8KP_DATfZMot7GHi_w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4wbw8KP_DATfZMot7GHi_w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4wbw8KP_DATfZMot7GHi_w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4wbw8KP_DATfZMot7GHi_w.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*4wbw8KP_DATfZMot7GHi_w.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="178" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xZpweayv3ZhdR6aknc5WEQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xZpweayv3ZhdR6aknc5WEQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xZpweayv3ZhdR6aknc5WEQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xZpweayv3ZhdR6aknc5WEQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xZpweayv3ZhdR6aknc5WEQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xZpweayv3ZhdR6aknc5WEQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*xZpweayv3ZhdR6aknc5WEQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*xZpweayv3ZhdR6aknc5WEQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xZpweayv3ZhdR6aknc5WEQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xZpweayv3ZhdR6aknc5WEQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xZpweayv3ZhdR6aknc5WEQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xZpweayv3ZhdR6aknc5WEQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xZpweayv3ZhdR6aknc5WEQ.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*xZpweayv3ZhdR6aknc5WEQ.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="76" loading="lazy" role="presentation"/></picture></div></figure><h2 id="954c" class="ps pt ja bg pu pv pw px gy py pz qa ha qb qc qd qe qf qg qh qi qj qk ql qm qn bl">8. Debug dllhst3g.exe</h2><p id="fd47" class="pw-post-body-paragraph op oq ja os b ot qo ov ow ox qp oz pa hb qq pc pd he qr pf pg hh qs pi pj pk ib bl">Hoàn thành xong việc inject code vào <strong class="os jb"><em class="or">dllhst3g.exe</em></strong> sẽ gọi <strong class="os jb"><em class="or">ExitProcess</em></strong> để kết thúc tiến trình <strong class="os jb"><em class="or">QcConsol.exe</em></strong> và tiếp tục thực thi tiến trình <strong class="os jb"><em class="or">dllhst3g.exe</em></strong>. Do <strong class="os jb"><em class="or">dllhst3g.exe</em></strong> bị inject code của file <em class="or">stdole.tlb</em> sau khi decode trên bộ nhớ, nên cách thức hoạt động cũng tương tự. <em class="or">Để có thể debug xem </em><strong class="os jb"><em class="or">dllhst3g.exe</em></strong> sẽ làm gì <em class="or">thì trước khi thực hiện bước </em><strong class="os jb"><em class="or">WriteProcessMemory</em></strong><em class="or"> ở trên, sửa 2 bytes đầu là</em><strong class="os jb"><em class="or"> 0x50 0x68</em></strong><em class="or"> thành </em><strong class="os jb"><em class="or">0xEB 0xFE</em></strong><em class="or">. Sau khi resume thread, mở một debugger khác để attach và khôi phục lại 2 bytes đã bị sửa.</em></p><p id="c479" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Lúc này, debug sẽ thấy code tạo một mutext và đọc lại nội dung từ file “<strong class="os jb"><em class="or">C:\ProgramData\desktop.ini</em></strong>” và decode string trong file này thành:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od rh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FXodpiCesmviUjpZJx2Vtg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FXodpiCesmviUjpZJx2Vtg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FXodpiCesmviUjpZJx2Vtg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FXodpiCesmviUjpZJx2Vtg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FXodpiCesmviUjpZJx2Vtg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FXodpiCesmviUjpZJx2Vtg.png 1100w, https://miro.medium.com/v2/resize:fit:1216/format:webp/1*FXodpiCesmviUjpZJx2Vtg.png 1216w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 608px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*FXodpiCesmviUjpZJx2Vtg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FXodpiCesmviUjpZJx2Vtg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FXodpiCesmviUjpZJx2Vtg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FXodpiCesmviUjpZJx2Vtg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FXodpiCesmviUjpZJx2Vtg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FXodpiCesmviUjpZJx2Vtg.png 1100w, https://miro.medium.com/v2/resize:fit:1216/1*FXodpiCesmviUjpZJx2Vtg.png 1216w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 608px"/><img alt="" class="bi gl ol c" width="608" height="75" loading="lazy" role="presentation"/></picture></div></figure><p id="e72b" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Gắn thêm tham số: <em class="or">0206F4E4 00D80B30 UNICODE “”C:\Users\REM\AppData\Roaming\Microsoft\Windows\Printer Shortcuts\QcConsol.exe” -</em><strong class="os jb"><em class="or">LowIntegrityServer</em></strong><em class="or">”</em> và gọi hàm <strong class="os jb"><em class="or">WinExec</em></strong> để thực thi</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SkQWqSUsMTSgZUkCjVxyvA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SkQWqSUsMTSgZUkCjVxyvA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SkQWqSUsMTSgZUkCjVxyvA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SkQWqSUsMTSgZUkCjVxyvA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SkQWqSUsMTSgZUkCjVxyvA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SkQWqSUsMTSgZUkCjVxyvA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*SkQWqSUsMTSgZUkCjVxyvA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*SkQWqSUsMTSgZUkCjVxyvA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SkQWqSUsMTSgZUkCjVxyvA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SkQWqSUsMTSgZUkCjVxyvA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SkQWqSUsMTSgZUkCjVxyvA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SkQWqSUsMTSgZUkCjVxyvA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SkQWqSUsMTSgZUkCjVxyvA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*SkQWqSUsMTSgZUkCjVxyvA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="41" loading="lazy" role="presentation"/></picture></div></figure><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BVVpWqyi8_6UNPbI-naZGg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BVVpWqyi8_6UNPbI-naZGg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BVVpWqyi8_6UNPbI-naZGg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BVVpWqyi8_6UNPbI-naZGg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BVVpWqyi8_6UNPbI-naZGg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BVVpWqyi8_6UNPbI-naZGg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*BVVpWqyi8_6UNPbI-naZGg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*BVVpWqyi8_6UNPbI-naZGg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BVVpWqyi8_6UNPbI-naZGg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BVVpWqyi8_6UNPbI-naZGg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BVVpWqyi8_6UNPbI-naZGg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BVVpWqyi8_6UNPbI-naZGg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BVVpWqyi8_6UNPbI-naZGg.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*BVVpWqyi8_6UNPbI-naZGg.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="66" loading="lazy" role="presentation"/></picture></div></figure><p id="2949" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tiến trình mới này sẽ kết nối tới C2 (<strong class="os jb"><em class="or">Ở đây tôi đang lái traffic về REMnux</em></strong>):</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3fhgC-P4xkKFfr0m_lC8AA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3fhgC-P4xkKFfr0m_lC8AA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3fhgC-P4xkKFfr0m_lC8AA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3fhgC-P4xkKFfr0m_lC8AA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3fhgC-P4xkKFfr0m_lC8AA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3fhgC-P4xkKFfr0m_lC8AA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*3fhgC-P4xkKFfr0m_lC8AA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3fhgC-P4xkKFfr0m_lC8AA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3fhgC-P4xkKFfr0m_lC8AA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3fhgC-P4xkKFfr0m_lC8AA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3fhgC-P4xkKFfr0m_lC8AA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3fhgC-P4xkKFfr0m_lC8AA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3fhgC-P4xkKFfr0m_lC8AA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*3fhgC-P4xkKFfr0m_lC8AA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="119" loading="lazy" role="presentation"/></picture></div></figure><p id="3aa4" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Tại máy REMnux, sử dụng wireshark sẽ capture được thông tin như hình:</p><figure class="pn po pp pq pr ok oc od paragraph-image"><div class="oc od oe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ReLvnC7AUEp54fum3h5RbA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ReLvnC7AUEp54fum3h5RbA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ReLvnC7AUEp54fum3h5RbA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ReLvnC7AUEp54fum3h5RbA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ReLvnC7AUEp54fum3h5RbA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ReLvnC7AUEp54fum3h5RbA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*ReLvnC7AUEp54fum3h5RbA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ReLvnC7AUEp54fum3h5RbA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ReLvnC7AUEp54fum3h5RbA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ReLvnC7AUEp54fum3h5RbA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ReLvnC7AUEp54fum3h5RbA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ReLvnC7AUEp54fum3h5RbA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ReLvnC7AUEp54fum3h5RbA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*ReLvnC7AUEp54fum3h5RbA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bi gl ol c" width="624" height="137" loading="lazy" role="presentation"/></picture></div></figure><h2 id="4f82" class="ps pt ja bg pu pv pw px gy py pz qa ha qb qc qd qe qf qg qh qi qj qk ql qm qn bl">9. IOCs</h2><p id="712a" class="pw-post-body-paragraph op oq ja os b ot qo ov ow ox qp oz pa hb qq pc pd he qr pf pg hh qs pi pj pk ib bl">Domain: login[dot]dangquanwatch[dot]com / IP: 185.77.129.142</p><p id="80c4" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">RTF: b45087ad4f7d84758046e9d6eb174530fee98b069105a78f124cbde1ecfb0415</p><p id="27ce" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">8.t: 6328dd14eda2ef983810c0c7b3af47298b5998e4fa52d97b204be2818f08bb69</p><p id="246c" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Binary:</p><p id="bff5" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">QcConsol.exe: 9f3114e48dd0245467fd184bb9655a5208fa7d13e2fe06514d1f3d61ce8b8770</p><p id="bdaf" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">QcLite.dll: 5b652205b1c248e5d5fc0eb5f53c5754df829ed2479687d4f14c2e08fbf87e76</p><p id="b9e3" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Others:</p><p id="6e34" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">stdole.tlb: ba620bad026f25ba6decc4bdcefc6415b563503cf9eaddc4e1137a5871d5cee2</p><p id="70a3" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">desktop.ini: 31c2be9ca29fb2bd8096720c221ee9682f013eee119b02d390d6efc12684392d</p><p id="0be9" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Registry:</p><p id="4269" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run &amp; HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</p><p id="7b2b" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">ValueName: Windows HD Audio Manager</p><p id="7334" class="pw-post-body-paragraph op oq ja os b ot ou ov ow ox oy oz pa hb pb pc pd he pe pf pg hh ph pi pj pk ib bl">Data: %AppData%\MICROS~1\Windows\PRINTE~1\QcConsol.exe -LowIntegrityServer</p></div></div></div></div></section></div></div></article></div><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="sd se ac kx"><div class="sf ac"><a class="sg ak ao aq" rel="noopener follow" href="/tag/malware-analysis?source=post_page-----6ca15fe1b241---------------------------------------" data-discover="true"><div class="sh fr de si im sj sk bg b bh ab bl gc">Malware Analysis</div></a></div><div class="sf ac"><a class="sg ak ao aq" rel="noopener follow" href="/tag/security?source=post_page-----6ca15fe1b241---------------------------------------" data-discover="true"><div class="sh fr de si im sj sk bg b bh ab bl gc">Security</div></a></div></div></div></div><div class="m"></div><footer class="sl sm sn so sp ac r sq sr c"><div class="m ag"><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="ac cw ss"><div class="ac r mg"><div class="st m"><span class="m su sv sw f e"><div class="ac r mg mh"><div class="pw-multi-vote-icon fr mi mj mk ml"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftradahacking%2F6ca15fe1b241&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Ftradahacking%2Fl%25C3%25A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241&amp;user=m4n0w4r&amp;userId=3d670b41fa5f&amp;source=---footer_actions--6ca15fe1b241---------------------clap_footer------------------" data-discover="true"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><div class="mm aq mn mo mp mq ao mr ms mt ml" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m mu mv mw mx my mz na"><p class="bg b ec ab eb"><span class="nb">--</span></p></div></div></span><span class="m i h g sx sy"><div class="ac r mg mh"><div class="pw-multi-vote-icon fr mi mj mk ml"><span data-dd-action-name="Susi presentation tracker clap_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftradahacking%2F6ca15fe1b241&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Ftradahacking%2Fl%25C3%25A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241&amp;user=m4n0w4r&amp;userId=3d670b41fa5f&amp;source=---footer_actions--6ca15fe1b241---------------------clap_footer------------------" data-discover="true"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><div class="mm aq mn mo mp mq ao mr ms mt ml" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m mu mv mw mx my mz na"><p class="bg b ec ab eb"><span class="nb">--</span></p></div></div></span></div><div class="az ac"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><button class="aq mm ne nf ac r fs ng nh" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="nd"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bg b bh ab eb"><span class="pw-responses-count nc nd">5</span></p></button></div></div></div></div></div><div class="ac r"><div class="sz m cb"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><span data-dd-action-name="Susi presentation tracker bookmark_footer"><a class="ah ai aj fo al am an ao ap aq ar as at au av" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ca15fe1b241&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Ftradahacking%2Fl%25C3%25A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241&amp;source=---footer_actions--6ca15fe1b241---------------------bookmark_footer------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="eb nj" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div><div class="sz m cb"><div class="bn" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="ah fs aj fo al am an nk ap aq ar fe nl nm nh nn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></footer><div class="ta m"><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="tb m"><div class="ac kk ki kg tc td"><div class="te tf tg th ti tj tk tl tm tn ac cw"><div class="i l"><a href="https://medium.com/tradahacking?source=post_page---post_publication_info--6ca15fe1b241---------------------------------------" rel="noopener follow"><div class="fr"><img alt="tradahacking" class="de hw m tp to" src="https://miro.medium.com/v2/resize:fill:96:96/1*aPmV4ykveVMK7Gn2z0_xKg.png" width="48" height="48" loading="lazy"/><div class="hw m to tp fw o gj hz"></div></div></a></div><div class="k j e"><a href="https://medium.com/tradahacking?source=post_page---post_publication_info--6ca15fe1b241---------------------------------------" rel="noopener follow"><div class="fr"><img alt="tradahacking" class="de hw m tr tq" src="https://miro.medium.com/v2/resize:fill:128:128/1*aPmV4ykveVMK7Gn2z0_xKg.png" width="64" height="64" loading="lazy"/><div class="hw m tq tr fw o gj hz"></div></div></a></div><div class="k j e ts cb"><div class="ac"></div></div></div><div class="ac cv cd"><div class="tt tu tv tw tx m"><a class="ah ai aj al am an ao ap aq ar as at au av ac r" href="https://medium.com/tradahacking?source=post_page---post_publication_info--6ca15fe1b241---------------------------------------" rel="noopener follow"><h2 class="pw-author-name bg gw tz ua ub uc ud ue hb hc hd he hf hg hh hi hj bl"><span class="ib ty">Published in <!-- -->tradahacking</span></h2></a><div class="sf ac km"><div class="m cb"><span class="pw-follower-count bg b bh ab eb"><a class="ah ai aj fo al am an ao ap aq ar as at kv" rel="noopener follow" href="/tradahacking/followers?source=post_page---post_publication_info--6ca15fe1b241---------------------------------------" data-discover="true">1.1K followers</a></span></div><div class="bg b bh ab eb ac uf"><span class="hk m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span><a class="ah ai aj fo al am an ao ap aq ar as at kv" rel="noopener follow" href="/tradahacking/reversing-with-ida-from-scratch-p37-6bcb0335d3a6?source=post_page---post_publication_info--6ca15fe1b241---------------------------------------" data-discover="true">Last published <span>Dec 25, 2021</span></a></div></div><div class="ia m"><p class="bg b bh ab bl"><span class="ib">Chia sẻ kiến thức An Toàn Thông Tin</span></p></div></div></div><div class="i l"><div class="ac"></div></div></div></div><div class="ac kk ki kg tc td"><div class="te tf tg th ti tj tk tl tm tn ac cw"><div class="i l"><a tabindex="0" rel="noopener follow" href="/@kienbigmummy?source=post_page---post_author_info--6ca15fe1b241---------------------------------------" data-discover="true"><div class="m fr"><img alt="m4n0w4r" class="m fk by to tp de" src="https://miro.medium.com/v2/resize:fill:96:96/1*Dw-pvqpZpLfrihTKmh9-6Q.jpeg" width="48" height="48" loading="lazy"/><div class="gj by m to tp fw o ak hz"></div></div></a></div><div class="k j e"><a tabindex="0" rel="noopener follow" href="/@kienbigmummy?source=post_page---post_author_info--6ca15fe1b241---------------------------------------" data-discover="true"><div class="m fr"><img alt="m4n0w4r" class="m fk by tq tr de" src="https://miro.medium.com/v2/resize:fill:128:128/1*Dw-pvqpZpLfrihTKmh9-6Q.jpeg" width="64" height="64" loading="lazy"/><div class="gj by m tq tr fw o ak hz"></div></div></a></div><div class="k j e ts cb"><div class="ac"></div></div></div><div class="ac cv cd"><div class="tt tu tv tw tx m"><a class="ah ai aj al am an ao ap aq ar as at au av ac r" rel="noopener follow" href="/@kienbigmummy?source=post_page---post_author_info--6ca15fe1b241---------------------------------------" data-discover="true"><h2 class="pw-author-name bg gw tz ua ub uc ud ue hb hc hd he hf hg hh hi hj bl"><span class="ib ty">Written by <!-- -->m4n0w4r</span></h2></a><div class="sf ac km"><div class="m cb"><span class="pw-follower-count bg b bh ab eb"><a class="ah ai aj fo al am an ao ap aq ar as at kv" rel="noopener follow" href="/@kienbigmummy/followers?source=post_page---post_author_info--6ca15fe1b241---------------------------------------" data-discover="true">570 followers</a></span></div><div class="bg b bh ab eb ac uf"><span class="hk m" aria-hidden="true"><span class="bg b bh ab eb">·</span></span><a class="ah ai aj fo al am an ao ap aq ar as at kv" rel="noopener follow" href="/@kienbigmummy/following?source=post_page---post_author_info--6ca15fe1b241---------------------------------------" data-discover="true">128 following</a></div></div><div class="ia m"><p class="bg b bh ab bl"><span class="ib">Malware Analysis/IR</span></p></div></div></div><div class="i l"><div class="ac"></div></div></div></div></div></div><div class="ug uh ui uj uk m"><div class="ul bi s ta"></div><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="ac r cw"><h2 class="bg gw pv px gy py qa ha qb qd qe qf qh qi qj ql qm bl">Responses (<!-- -->5<!-- -->)</h2><div class="ac um"><div><div class="bn" role="tooltip"><div tabindex="-1" class="bf"><a class="un uo" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--6ca15fe1b241---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" aria-label="Shield with a checkmark" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="up gn uq ur us ut uu m"></div><div class="uv m"><button class="bg b bh ab bl sh uw ux uy nj ng uz fc fd fe va vb vc fh vd ve vf vg vh fi fj fk bn fl fm">See all responses</button></div></div></div></div><div class="vi vj vk vl vm m bx"><div class="i l k"><div class="ul bi vn vo"></div><div class="ac ci"><div class="cp bi ih ii ij ik"><div class="vp ac mg kx"><div class="vq vr m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://help.medium.com/hc/en-us?source=post_page-----6ca15fe1b241---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Help</p></a></div><div class="vq vr m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://status.medium.com/?source=post_page-----6ca15fe1b241---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Status</p></a></div><div class="vq vr m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----6ca15fe1b241---------------------------------------" data-discover="true"><p class="bg b ec ab eb">About</p></a></div><div class="vq vr m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----6ca15fe1b241---------------------------------------" data-discover="true"><p class="bg b ec ab eb">Careers</p></a></div><div class="vq vr m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bg b ec ab eb">Press</p></a></div><div class="vq vr m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://blog.medium.com/?source=post_page-----6ca15fe1b241---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Blog</p></a></div><div class="vq vr m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6ca15fe1b241---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Privacy</p></a></div><div class="vq vr m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----6ca15fe1b241---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Rules</p></a></div><div class="vq vr m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6ca15fe1b241---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Terms</p></a></div><div class="vq m"><a class="ah ai aj fo al am an ao ap aq ar as at au av" href="https://speechify.com/medium?source=post_page-----6ca15fe1b241---------------------------------------" rel="noopener follow"><p class="bg b ec ab eb">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20251002-200904-bc48c2adfb"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-6ca15fe1b241","user-3d670b41fa5f","collection-e9f496034096"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"pubFeaturingPostPageLabelEnabled":false,"shouldFollowPostQueryEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"ceedaae6-0ed8-476a-ae18-a6d034adb827","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-ece200b728ecc36eb8cb22a515f20c0f-f2d7487918549418-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Ftradahacking\u002Fl%C3%A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"staticRouterContext":{"route":{"name":"ShowPostUnderCollection"},"statusCode":200},"toastQueue":[],"currentToast":null,"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20251002-200904-bc48c2adfb","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","iosAppId":"828256236","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20251002-200904-bc48c2adfb","commit":"bc48c2adfb6f3202e1a73c039b9a7eba6d913d29"}},"datacenter":"us"},"googleAdsCode":"AW-17106321204","googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"167cff2a3d17ac1e64d0762539978f2d54c0058886e8b3c8a03a725a83012ec0","height":630,"width":1200},"postPreviewImage":{"imageId":"bc1f8416df0cad099e43cda2872716e5864f18a73bda2a7547ea082aca9b5632","height":630,"width":1200}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"tradahacking\"})":{"__ref":"Collection:e9f496034096"},"postResult({\"id\":\"6ca15fe1b241\"})":{"__ref":"Post:6ca15fe1b241"}},"ImageMetadata:1*cODlhCaSuYZ5NVUo_EgEtg.png":{"__typename":"ImageMetadata","id":"1*cODlhCaSuYZ5NVUo_EgEtg.png"},"Collection:e9f496034096":{"__typename":"Collection","id":"e9f496034096","favicon":{"__ref":"ImageMetadata:1*cODlhCaSuYZ5NVUo_EgEtg.png"},"domain":null,"slug":"tradahacking","googleAnalyticsId":null,"name":"tradahacking","avatar":{"__ref":"ImageMetadata:1*aPmV4ykveVMK7Gn2z0_xKg.png"},"description":"Chia sẻ kiến thức An Toàn Thông Tin","subscriberCount":1112,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:6bcb0335d3a6"}]},"compatV3":{"__ref":"Publication:e9f496034096"},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:e9f496034096-viewerId:lo_ba22a26464ef"},"twitterUsername":"tradahackingvn","facebookPageId":null},"ImageMetadata:1*aPmV4ykveVMK7Gn2z0_xKg.png":{"__typename":"ImageMetadata","id":"1*aPmV4ykveVMK7Gn2z0_xKg.png"},"User:3d670b41fa5f":{"__typename":"User","id":"3d670b41fa5f","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"kienbigmummy.medium.com"}},"hasSubdomain":true,"username":"kienbigmummy","name":"m4n0w4r","newsletterV3":{"__ref":"NewsletterV3:2beaf83a1b7f"},"linkedAccounts":{"__ref":"LinkedAccounts:3d670b41fa5f"},"isSuspended":false,"imageId":"1*Dw-pvqpZpLfrihTKmh9-6Q.jpeg","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":570,"followingCount":114,"collectionFollowingCount":14},"bio":"Malware Analysis\u002FIR","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:3d670b41fa5f-viewerId:lo_ba22a26464ef"},"twitterScreenName":""},"Post:6bcb0335d3a6":{"__typename":"Post","id":"6bcb0335d3a6","firstPublishedAt":1640425062000,"creator":{"__ref":"User:3d670b41fa5f"},"collection":{"__ref":"Collection:e9f496034096"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Ftradahacking\u002Freversing-with-ida-from-scratch-p37-6bcb0335d3a6","sequence":null,"uniqueSlug":"reversing-with-ida-from-scratch-p37-6bcb0335d3a6"},"Publication:e9f496034096":{"__typename":"Publication","id":"e9f496034096","theme":{"__typename":"PublicationTheme","accentColor":{"__typename":"ColorValue","rgb":"#112233"}}},"LinkedAccounts:3d670b41fa5f":{"__typename":"LinkedAccounts","mastodon":null,"id":"3d670b41fa5f"},"NewsletterV3:2beaf83a1b7f":{"__typename":"NewsletterV3","id":"2beaf83a1b7f","type":"NEWSLETTER_TYPE_AUTHOR","slug":"3d670b41fa5f","name":"3d670b41fa5f","collection":null,"user":{"__ref":"User:3d670b41fa5f"}},"Paragraph:7d741b1dd33f_0":{"__typename":"Paragraph","id":"7d741b1dd33f_0","name":"2706","type":"H3","href":null,"layout":null,"metadata":null,"text":"Là 1937CN hay OceanLotus hay Lazarus …","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*utkVDcocvYLgno9vgjM-_w.png":{"__typename":"ImageMetadata","id":"1*utkVDcocvYLgno9vgjM-_w.png","originalHeight":562,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_1":{"__typename":"Paragraph","id":"7d741b1dd33f_1","name":"b483","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*utkVDcocvYLgno9vgjM-_w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_2":{"__typename":"Paragraph","id":"7d741b1dd33f_2","name":"4c29","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Vô tình bắt gặp trên twitter của @blu3_team (Tôi không rõ sao acc này lại rất hay có được những mẫu target vào VN), tôi tò mò muốn biết kĩ thuật đằng sau nó là gì bởi tôi thấy nó tương tự như một bài mà tôi đã đọc https:\u002F\u002Fmedium.com\u002F@Sebdraven\u002Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a, và vì xem comment, người nghi ngờ là OceanLotus, người khẳng định là 1937CN Team…","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":214,"end":304,"href":"https:\u002F\u002Fmedium.com\u002F@Sebdraven\u002Fmalicious-document-targets-vietnamese-officials-acb3b9d8b80a","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":33,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":45,"end":113,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":343,"end":353,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":375,"end":386,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":45,"end":113,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_3":{"__typename":"Paragraph","id":"7d741b1dd33f_3","name":"b382","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Xin lỗi vì bài viết khá dài, tôi cũng không biết làm thế nào để cho nó ngắn hơn :D, nếu bạn không có thời gian để đọc hết thì bấm một like rồi chuyển trang khác. Phần tôi, một là do tôi thích viết, mặt khác cũng là cách tôi tự rèn kĩ năng … phần nữa là vì tôi biết rằng chỉ khi mình thực sự bắt tay vào phân tích mới thấy nó khác xa với những gì mình đọc bằng mắt và tưởng tượng….","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*f94cQEOVnLq5jA7pfEWbag.png":{"__typename":"ImageMetadata","id":"1*f94cQEOVnLq5jA7pfEWbag.png","originalHeight":420,"originalWidth":587,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_4":{"__typename":"Paragraph","id":"7d741b1dd33f_4","name":"8af1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*f94cQEOVnLq5jA7pfEWbag.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_5":{"__typename":"Paragraph","id":"7d741b1dd33f_5","name":"c6d1","type":"H3","href":null,"layout":null,"metadata":null,"text":"1. Môi trường thực hiện","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_6":{"__typename":"Paragraph","id":"7d741b1dd33f_6","name":"69a0","type":"P","href":null,"layout":null,"metadata":null,"text":"1. Máy ảo REMnux (https:\u002F\u002Fremnux.org\u002F): sử dụng để phân tích files, giả lập Internet services và capture network traffic.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":18,"end":37,"href":"https:\u002F\u002Fremnux.org\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":10,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_7":{"__typename":"Paragraph","id":"7d741b1dd33f_7","name":"027d","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Máy ảo Win10x64 (tự build): sử dụng cho Static & Dynamic Analysis","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":10,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_8":{"__typename":"Paragraph","id":"7d741b1dd33f_8","name":"edd0","type":"P","href":null,"layout":null,"metadata":null,"text":"a. Cài đặt sẵn các cộng cụ debugger & disassembler: OllyDbg, x64dbg, IDA …","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_9":{"__typename":"Paragraph","id":"7d741b1dd33f_9","name":"c57d","type":"P","href":null,"layout":null,"metadata":null,"text":"b. Cài đặt sẵn Office 2013.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_10":{"__typename":"Paragraph","id":"7d741b1dd33f_10","name":"9856","type":"P","href":null,"layout":null,"metadata":null,"text":"c. Enable tải khoản Administrator (mặc định tài khoản này bị disable) và đăng nhập bằng tải khoản này để thực hiện phân tích.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":20,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":35,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_11":{"__typename":"Paragraph","id":"7d741b1dd33f_11","name":"2e69","type":"H3","href":null,"layout":null,"metadata":null,"text":"2. Phân tích theo hành vi","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_12":{"__typename":"Paragraph","id":"7d741b1dd33f_12","name":"8220","type":"P","href":null,"layout":null,"metadata":null,"text":"Khi mở tài liệu trên máy ảo Win10, sẽ thấy ứng dụng EQNEDT32.exe được gọi, sau đó xuất hiện thêm hai tiến trình khác là QcConsol.exe và dllhst3g.exe:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":52,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":120,"end":132,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":136,"end":148,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*5sgrSwXlIdHL3ydx_JsaAg.png":{"__typename":"ImageMetadata","id":"1*5sgrSwXlIdHL3ydx_JsaAg.png","originalHeight":132,"originalWidth":504,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_13":{"__typename":"Paragraph","id":"7d741b1dd33f_13","name":"4d9f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*5sgrSwXlIdHL3ydx_JsaAg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_14":{"__typename":"Paragraph","id":"7d741b1dd33f_14","name":"cb7f","type":"P","href":null,"layout":null,"metadata":null,"text":"Trên máy ảo REMnux chạy Wireshark để capture traffic từ máy ảo Win10, thu được kết quả kết nối tới C2 server là login[dot]dangquanwatch[dot]com:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*5AQFnklODEuUWM1RVE0jRw.png":{"__typename":"ImageMetadata","id":"1*5AQFnklODEuUWM1RVE0jRw.png","originalHeight":87,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_15":{"__typename":"Paragraph","id":"7d741b1dd33f_15","name":"570e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*5AQFnklODEuUWM1RVE0jRw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*F3ZfLQNO5IW5G1u86adnFQ.png":{"__typename":"ImageMetadata","id":"1*F3ZfLQNO5IW5G1u86adnFQ.png","originalHeight":113,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_16":{"__typename":"Paragraph","id":"7d741b1dd33f_16","name":"adeb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*F3ZfLQNO5IW5G1u86adnFQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_17":{"__typename":"Paragraph","id":"7d741b1dd33f_17","name":"451e","type":"P","href":null,"layout":null,"metadata":null,"text":"Log của Noriben (https:\u002F\u002Fgithub.com\u002FRurik\u002FNoriben) cung cấp:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":17,"end":49,"href":"https:\u002F\u002Fgithub.com\u002FRurik\u002FNoriben","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*SdIZ-Jv2KJpzSUXT7Rphuw.png":{"__typename":"ImageMetadata","id":"1*SdIZ-Jv2KJpzSUXT7Rphuw.png","originalHeight":319,"originalWidth":1657,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_18":{"__typename":"Paragraph","id":"7d741b1dd33f_18","name":"1c33","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*SdIZ-Jv2KJpzSUXT7Rphuw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_19":{"__typename":"Paragraph","id":"7d741b1dd33f_19","name":"39ec","type":"H3","href":null,"layout":null,"metadata":null,"text":"3. Phân tích sample trên REMnux","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_20":{"__typename":"Paragraph","id":"7d741b1dd33f_20","name":"0a1a","type":"P","href":null,"layout":null,"metadata":null,"text":"Sample nhận được là một file có định dạng RTF:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*oM6Mz3JV-xXP-PmLCDt9aA.png":{"__typename":"ImageMetadata","id":"1*oM6Mz3JV-xXP-PmLCDt9aA.png","originalHeight":23,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_21":{"__typename":"Paragraph","id":"7d741b1dd33f_21","name":"cadc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*oM6Mz3JV-xXP-PmLCDt9aA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_22":{"__typename":"Paragraph","id":"7d741b1dd33f_22","name":"5a82","type":"P","href":null,"layout":null,"metadata":null,"text":"Sử dụng rtfobj (https:\u002F\u002Fgithub.com\u002Fdecalage2\u002Foletools), biết được sample này có 3 objects:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":16,"end":53,"href":"https:\u002F\u002Fgithub.com\u002Fdecalage2\u002Foletools","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":8,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZKMd8PRTjjMq1OCOsw-sFw.png":{"__typename":"ImageMetadata","id":"1*ZKMd8PRTjjMq1OCOsw-sFw.png","originalHeight":247,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_23":{"__typename":"Paragraph","id":"7d741b1dd33f_23","name":"1f0a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZKMd8PRTjjMq1OCOsw-sFw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_24":{"__typename":"Paragraph","id":"7d741b1dd33f_24","name":"44a3","type":"P","href":null,"layout":null,"metadata":null,"text":"Object tại id 0 có FileName là 8.t, khi mở tài liệu thì file này sẽ được drop vào thư mục Temp trên máy. Hai object còn lại được nhận diện là “Not a well formed ole object”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":31,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":143,"end":171,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_25":{"__typename":"Paragraph","id":"7d741b1dd33f_25","name":"6085","type":"P","href":null,"layout":null,"metadata":null,"text":"Dùng luôn rtfobj để dump toàn bộ các objects này:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":10,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*b1yMItve0KuUfZWao2WglA.png":{"__typename":"ImageMetadata","id":"1*b1yMItve0KuUfZWao2WglA.png","originalHeight":325,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_26":{"__typename":"Paragraph","id":"7d741b1dd33f_26","name":"53c8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*b1yMItve0KuUfZWao2WglA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_27":{"__typename":"Paragraph","id":"7d741b1dd33f_27","name":"a4c5","type":"P","href":null,"layout":null,"metadata":null,"text":"Kiểm tra thông tin từng file. Đầu tiên là b45087ad4f7d84758046e9d6eb174530fee98b069105a78f124cbde1ecfb0415_8.t:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":42,"end":110,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*M_HgqD4AwbWSvbKXQs_3DA.png":{"__typename":"ImageMetadata","id":"1*M_HgqD4AwbWSvbKXQs_3DA.png","originalHeight":310,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_28":{"__typename":"Paragraph","id":"7d741b1dd33f_28","name":"20ad","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*M_HgqD4AwbWSvbKXQs_3DA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_29":{"__typename":"Paragraph","id":"7d741b1dd33f_29","name":"0db6","type":"P","href":null,"layout":null,"metadata":null,"text":"Theo data như trên hình thì khả năng file này đã bị mã hóa và sẽ được giải mã sau khi drop vào thự mục Temo.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":103,"end":107,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_30":{"__typename":"Paragraph","id":"7d741b1dd33f_30","name":"e088","type":"P","href":null,"layout":null,"metadata":null,"text":"Với file b45087ad4f7d84758046e9d6eb174530fee98b069105a78f124cbde1ecfb0415_object_000C11FB.raw:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":9,"end":93,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*P7_icWYTQGe_qKEP8WGADQ.png":{"__typename":"ImageMetadata","id":"1*P7_icWYTQGe_qKEP8WGADQ.png","originalHeight":48,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_31":{"__typename":"Paragraph","id":"7d741b1dd33f_31","name":"4277","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*P7_icWYTQGe_qKEP8WGADQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_32":{"__typename":"Paragraph","id":"7d741b1dd33f_32","name":"36a1","type":"P","href":null,"layout":null,"metadata":null,"text":"Căn cứ vào dấu hiệu như trên hình thì khả năng file RTF có thể sẽ sử dụng exploit CVE-2017–11882 (https:\u002F\u002Fportal.msrc.microsoft.com\u002Fen-US\u002Fsecurity-guidance\u002Fadvisory\u002FCVE-2017-11882).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":98,"end":179,"href":"https:\u002F\u002Fportal.msrc.microsoft.com\u002Fen-US\u002Fsecurity-guidance\u002Fadvisory\u002FCVE-2017-11882","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":82,"end":96,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_33":{"__typename":"Paragraph","id":"7d741b1dd33f_33","name":"a495","type":"P","href":null,"layout":null,"metadata":null,"text":"Kiểm tra file còn lại là b45087ad4f7d84758046e9d6eb174530fee98b069105a78f124cbde1ecfb0415_object_000C11E9.raw:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":25,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*NpWeo4hQPXLqitk1uQ1Cig.png":{"__typename":"ImageMetadata","id":"1*NpWeo4hQPXLqitk1uQ1Cig.png","originalHeight":644,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_34":{"__typename":"Paragraph","id":"7d741b1dd33f_34","name":"a6ab","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*NpWeo4hQPXLqitk1uQ1Cig.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_35":{"__typename":"Paragraph","id":"7d741b1dd33f_35","name":"07fc","type":"P","href":null,"layout":null,"metadata":null,"text":"File này khả năng sẽ chứa đoạn shellcode để thực hiện sau khi máy nạn nhân bị exploit. Thông tin sợ bộ là như vậy, tiếp theo ta sẽ thực hiện debug sample này để xem file 8.t được sử dụng như thế nào.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":170,"end":173,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_36":{"__typename":"Paragraph","id":"7d741b1dd33f_36","name":"d4b8","type":"H3","href":null,"layout":null,"metadata":null,"text":"4. Debug maldoc trên Windows10","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_37":{"__typename":"Paragraph","id":"7d741b1dd33f_37","name":"6cf3","type":"P","href":null,"layout":null,"metadata":null,"text":"Liên quan tới exploit CVE-2017–11882, khi chạy sample, Winword.exe sẽ gọi tiến trình EQNEDT32.exe để handle OLE object. Tuy nhiên, Winword.exe không phải là process cha của EQNEDT32.exe, tiến trình EQNEDT32.exe được gọi bởi Winword.exe thông qua việc sử dụng COM Object như hình dưới đây:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":22,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":85,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":131,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":173,"end":185,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":198,"end":210,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":224,"end":235,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*_pmEHYg63O77FRvfmWNOLQ.png":{"__typename":"ImageMetadata","id":"1*_pmEHYg63O77FRvfmWNOLQ.png","originalHeight":228,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_38":{"__typename":"Paragraph","id":"7d741b1dd33f_38","name":"f323","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*_pmEHYg63O77FRvfmWNOLQ.png"},"text":"https:\u002F\u002Fembedi.com\u002Fblog\u002Fskeleton-closet-ms-office-vulnerability-you-didnt-know-about\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":85,"href":"https:\u002F\u002Fembedi.com\u002Fblog\u002Fskeleton-closet-ms-office-vulnerability-you-didnt-know-about\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_39":{"__typename":"Paragraph","id":"7d741b1dd33f_39","name":"e77b","type":"P","href":null,"layout":null,"metadata":null,"text":"Như vậy, bằng cách nào đó ta phải attach được EQNEDT32.exe vào debugger để debug. Ở đây, tôi sử dụng một kĩ thuật của M$ là Image File Execution Options (IFEO: https:\u002F\u002Fblogs.msdn.microsoft.com\u002Fmithuns\u002F2010\u002F03\u002F24\u002Fimage-file-execution-options-ifeo\u002F).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":160,"end":246,"href":"https:\u002F\u002Fblogs.msdn.microsoft.com\u002Fmithuns\u002F2010\u002F03\u002F24\u002Fimage-file-execution-options-ifeo\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":46,"end":58,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":124,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":124,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_40":{"__typename":"Paragraph","id":"7d741b1dd33f_40","name":"554a","type":"P","href":null,"layout":null,"metadata":null,"text":"Vào Registry, tạo một key như sau hoặc nếu cài Word2013 trở lên thì khả năng có sẵn key này (vì tôi thấy trên máy tôi có sẵn):","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*X0Tqm2UMimBW9OeGqw3jxA.png":{"__typename":"ImageMetadata","id":"1*X0Tqm2UMimBW9OeGqw3jxA.png","originalHeight":235,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_41":{"__typename":"Paragraph","id":"7d741b1dd33f_41","name":"a1c2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*X0Tqm2UMimBW9OeGqw3jxA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_42":{"__typename":"Paragraph","id":"7d741b1dd33f_42","name":"a62d","type":"P","href":null,"layout":null,"metadata":null,"text":"Tiếp theo, tạo một string value để khởi chạy debugger khi EQNEDT32.exe được thực thi, qua đó sẽ attach đươc debugger vào tiến trình của EQNEDT32.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*k8MxeblFLPSGuBngKy06CQ.png":{"__typename":"ImageMetadata","id":"1*k8MxeblFLPSGuBngKy06CQ.png","originalHeight":109,"originalWidth":589,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_43":{"__typename":"Paragraph","id":"7d741b1dd33f_43","name":"0938","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*k8MxeblFLPSGuBngKy06CQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_44":{"__typename":"Paragraph","id":"7d741b1dd33f_44","name":"7bd7","type":"P","href":null,"layout":null,"metadata":null,"text":"Với thiết lập như trên, kiểm tra lại bằng Autoruns sẽ như sau:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":42,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Sc1FHWnRsqRctIGBZflPqw.png":{"__typename":"ImageMetadata","id":"1*Sc1FHWnRsqRctIGBZflPqw.png","originalHeight":141,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_45":{"__typename":"Paragraph","id":"7d741b1dd33f_45","name":"af8d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Sc1FHWnRsqRctIGBZflPqw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_46":{"__typename":"Paragraph","id":"7d741b1dd33f_46","name":"cd37","type":"P","href":null,"layout":null,"metadata":null,"text":"Lưu ý: khi thiết lập IFEO, các thiết lập sẽ tự động bộ giữa hai key: HKLM\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options và HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":69,"end":159,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":163,"end":241,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_47":{"__typename":"Paragraph","id":"7d741b1dd33f_47","name":"4a49","type":"P","href":null,"layout":null,"metadata":null,"text":"Tiếp theo, mở WINWORD.EXE, sau đó từ Winword mở tài liệu malicious rtf. Lúc này, tiến trình EQNEDT32.exe cũng sẽ được khởi chạy và được attach vào debugger:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*4XSkTYb6gkFIPdtHPsti9Q.png":{"__typename":"ImageMetadata","id":"1*4XSkTYb6gkFIPdtHPsti9Q.png","originalHeight":107,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_48":{"__typename":"Paragraph","id":"7d741b1dd33f_48","name":"71de","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*4XSkTYb6gkFIPdtHPsti9Q.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*HHwwTVJBtSJZivFB3uOT1A.png":{"__typename":"ImageMetadata","id":"1*HHwwTVJBtSJZivFB3uOT1A.png","originalHeight":301,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_49":{"__typename":"Paragraph","id":"7d741b1dd33f_49","name":"4ecb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*HHwwTVJBtSJZivFB3uOT1A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_50":{"__typename":"Paragraph","id":"7d741b1dd33f_50","name":"5799","type":"P","href":null,"layout":null,"metadata":null,"text":"Tại debugger, ta đang dừng lại tại EP(Entry Point) của EQNEDT32.exe:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*StJmlkRdN8LCEDlLfqBvDA.png":{"__typename":"ImageMetadata","id":"1*StJmlkRdN8LCEDlLfqBvDA.png","originalHeight":261,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_51":{"__typename":"Paragraph","id":"7d741b1dd33f_51","name":"c1d1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*StJmlkRdN8LCEDlLfqBvDA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_52":{"__typename":"Paragraph","id":"7d741b1dd33f_52","name":"9254","type":"P","href":null,"layout":null,"metadata":null,"text":"Kiểm tra ta thấy file 8.t đã được drop vào thư mục Temp:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":22,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*S7STqZQQtdJIMIe00D5toQ.png":{"__typename":"ImageMetadata","id":"1*S7STqZQQtdJIMIe00D5toQ.png","originalHeight":422,"originalWidth":613,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_53":{"__typename":"Paragraph","id":"7d741b1dd33f_53","name":"a565","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*S7STqZQQtdJIMIe00D5toQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_54":{"__typename":"Paragraph","id":"7d741b1dd33f_54","name":"cfab","type":"P","href":null,"layout":null,"metadata":null,"text":"Đặt BP tại API CreatFileW, sau đó nhấn F9 để thực thi, ta thấy chương trình sẽ thực hiện mở file 8.t để đọc nội dung:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":15,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":97,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":15,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lVInTz_NAv6lZt0yssAvgg.png":{"__typename":"ImageMetadata","id":"1*lVInTz_NAv6lZt0yssAvgg.png","originalHeight":245,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_55":{"__typename":"Paragraph","id":"7d741b1dd33f_55","name":"7a33","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lVInTz_NAv6lZt0yssAvgg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_56":{"__typename":"Paragraph","id":"7d741b1dd33f_56","name":"4851","type":"P","href":null,"layout":null,"metadata":null,"text":"Trace qua hàm này và return, sẽ tới shellcode của exploit:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*HSontP6_ttfTEgbMuxjm2Q.png":{"__typename":"ImageMetadata","id":"1*HSontP6_ttfTEgbMuxjm2Q.png","originalHeight":449,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_57":{"__typename":"Paragraph","id":"7d741b1dd33f_57","name":"7512","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*HSontP6_ttfTEgbMuxjm2Q.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_58":{"__typename":"Paragraph","id":"7d741b1dd33f_58","name":"bf4d","type":"P","href":null,"layout":null,"metadata":null,"text":"Gọi hàm GetFileSize để lấy kích thước của 8.t:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":8,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":42,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":8,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*WgrdEaAppawqbCQyXPcVsg.png":{"__typename":"ImageMetadata","id":"1*WgrdEaAppawqbCQyXPcVsg.png","originalHeight":231,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_59":{"__typename":"Paragraph","id":"7d741b1dd33f_59","name":"8a2a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*WgrdEaAppawqbCQyXPcVsg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*1Od7yIftihylNHGivMwkqA.png":{"__typename":"ImageMetadata","id":"1*1Od7yIftihylNHGivMwkqA.png","originalHeight":241,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_60":{"__typename":"Paragraph","id":"7d741b1dd33f_60","name":"26a3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*1Od7yIftihylNHGivMwkqA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_61":{"__typename":"Paragraph","id":"7d741b1dd33f_61","name":"8ed3","type":"P","href":null,"layout":null,"metadata":null,"text":"Sau đó, gọi hàm VirtualAlloc để thực hiện cấp phát một vùng nhớ:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":16,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":16,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-QiLOc2suv-vWAVTOZ5mWg.png":{"__typename":"ImageMetadata","id":"1*-QiLOc2suv-vWAVTOZ5mWg.png","originalHeight":180,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_62":{"__typename":"Paragraph","id":"7d741b1dd33f_62","name":"b4e8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-QiLOc2suv-vWAVTOZ5mWg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_63":{"__typename":"Paragraph","id":"7d741b1dd33f_63","name":"7eb1","type":"P","href":null,"layout":null,"metadata":null,"text":"Vùng nhớ được cấp phát trỏ bởi thanh ghi EAX, follow theo vùng nhớ này để xem code sẽ tác động gì lên nó:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*HR1tWF875PV9Iodoaccdtw.png":{"__typename":"ImageMetadata","id":"1*HR1tWF875PV9Iodoaccdtw.png","originalHeight":184,"originalWidth":277,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_64":{"__typename":"Paragraph","id":"7d741b1dd33f_64","name":"ac93","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*HR1tWF875PV9Iodoaccdtw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*TYHASamXB4Cd6bcyCrlgYA.png":{"__typename":"ImageMetadata","id":"1*TYHASamXB4Cd6bcyCrlgYA.png","originalHeight":216,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_65":{"__typename":"Paragraph","id":"7d741b1dd33f_65","name":"01b0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*TYHASamXB4Cd6bcyCrlgYA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_66":{"__typename":"Paragraph","id":"7d741b1dd33f_66","name":"0e6f","type":"P","href":null,"layout":null,"metadata":null,"text":"Hàm ReadFile được gọi để đọc ra nội dung của 8.t:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":45,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":4,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wvO67K0z1C7kpj5cMEMkpg.png":{"__typename":"ImageMetadata","id":"1*wvO67K0z1C7kpj5cMEMkpg.png","originalHeight":232,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_67":{"__typename":"Paragraph","id":"7d741b1dd33f_67","name":"78ce","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wvO67K0z1C7kpj5cMEMkpg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_68":{"__typename":"Paragraph","id":"7d741b1dd33f_68","name":"3d95","type":"P","href":null,"layout":null,"metadata":null,"text":"Toàn bộ nội dung của 8.t được đọc vào vùng nhớ đã được cấp phát ở trên:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":21,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*v_vtbOLe6_kn9fOVPr1Wjg.png":{"__typename":"ImageMetadata","id":"1*v_vtbOLe6_kn9fOVPr1Wjg.png","originalHeight":301,"originalWidth":589,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_69":{"__typename":"Paragraph","id":"7d741b1dd33f_69","name":"2a8d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*v_vtbOLe6_kn9fOVPr1Wjg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_70":{"__typename":"Paragraph","id":"7d741b1dd33f_70","name":"d6f1","type":"P","href":null,"layout":null,"metadata":null,"text":"Tiếp tục trace sẽ tới đoạn shellcode thực hiện giải mã toàn bộ nội dung của file 8.t trong memory tại 0x4F70000:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":81,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":102,"end":111,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":102,"end":111,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*mY6YE9A7c2J6_eY1mRvv_w.png":{"__typename":"ImageMetadata","id":"1*mY6YE9A7c2J6_eY1mRvv_w.png","originalHeight":283,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_71":{"__typename":"Paragraph","id":"7d741b1dd33f_71","name":"938e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mY6YE9A7c2J6_eY1mRvv_w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_72":{"__typename":"Paragraph","id":"7d741b1dd33f_72","name":"6a2c","type":"P","href":null,"layout":null,"metadata":null,"text":"Sau vài lần trace code sẽ thấy được dấu hiệu MZ, nhưng vậy file 8.t sau khi giải mà sẽ là một PE file:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":64,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*zGJmHCw2k5B_gVIwg56TcQ.png":{"__typename":"ImageMetadata","id":"1*zGJmHCw2k5B_gVIwg56TcQ.png","originalHeight":142,"originalWidth":608,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_73":{"__typename":"Paragraph","id":"7d741b1dd33f_73","name":"201e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*zGJmHCw2k5B_gVIwg56TcQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_74":{"__typename":"Paragraph","id":"7d741b1dd33f_74","name":"5a31","type":"P","href":null,"layout":null,"metadata":null,"text":"Cho thực hiện xong toàn bộ vòng lặp giải mã trên sẽ có được một PE hoàn chỉnh trong bộ nhớ:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*A-qIPNOeK6eiieXmFuzOWg.png":{"__typename":"ImageMetadata","id":"1*A-qIPNOeK6eiieXmFuzOWg.png","originalHeight":546,"originalWidth":600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_75":{"__typename":"Paragraph","id":"7d741b1dd33f_75","name":"50a1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*A-qIPNOeK6eiieXmFuzOWg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_76":{"__typename":"Paragraph","id":"7d741b1dd33f_76","name":"9357","type":"P","href":null,"layout":null,"metadata":null,"text":"Dump PE mới này và lưu lại để thực hiện phân tích sau:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*imBLPCI8VP00x5uJmPtx7w.png":{"__typename":"ImageMetadata","id":"1*imBLPCI8VP00x5uJmPtx7w.png","originalHeight":79,"originalWidth":349,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_77":{"__typename":"Paragraph","id":"7d741b1dd33f_77","name":"228d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*imBLPCI8VP00x5uJmPtx7w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_78":{"__typename":"Paragraph","id":"7d741b1dd33f_78","name":"3621","type":"P","href":null,"layout":null,"metadata":null,"text":"File dump được là một exe file:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ByFQHfmkqkVl4QOzEBIySQ.png":{"__typename":"ImageMetadata","id":"1*ByFQHfmkqkVl4QOzEBIySQ.png","originalHeight":364,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_79":{"__typename":"Paragraph","id":"7d741b1dd33f_79","name":"321e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ByFQHfmkqkVl4QOzEBIySQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_80":{"__typename":"Paragraph","id":"7d741b1dd33f_80","name":"4307","type":"P","href":null,"layout":null,"metadata":null,"text":"Tiếp tục debug, shellcode gọi tiếp hàm VirtualAlloc để cấp phát một vùng nhớ khác tại địa chỉ 0x5170000:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":39,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":94,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":39,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":94,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*KZaZRJZOiH1ayWMTQQujTQ.png":{"__typename":"ImageMetadata","id":"1*KZaZRJZOiH1ayWMTQQujTQ.png","originalHeight":238,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_81":{"__typename":"Paragraph","id":"7d741b1dd33f_81","name":"00b0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KZaZRJZOiH1ayWMTQQujTQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_82":{"__typename":"Paragraph","id":"7d741b1dd33f_82","name":"503e","type":"P","href":null,"layout":null,"metadata":null,"text":"PE được giải mã tại vùng nhớ 0x4F70000 sẽ được copy vào vùng nhớ mới được cấp phát ở trên:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":29,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":29,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QU0qP9kVeX3Ref9S0ATuGA.png":{"__typename":"ImageMetadata","id":"1*QU0qP9kVeX3Ref9S0ATuGA.png","originalHeight":350,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_83":{"__typename":"Paragraph","id":"7d741b1dd33f_83","name":"156a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*QU0qP9kVeX3Ref9S0ATuGA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_84":{"__typename":"Paragraph","id":"7d741b1dd33f_84","name":"7d0e","type":"P","href":null,"layout":null,"metadata":null,"text":"Dump vùng mem trên ra bộ nhớ, và vì file này đã được mapping trên memory và có thay đổi, nên sử dụng cộng cụ pe_unmapper của hasherezade (https:\u002F\u002Fgithub.com\u002Fhasherezade\u002Fpe_recovery_tools\u002Ftree\u002Fmaster\u002Fpe_unmapper) để chuyển đổi từ virtual format về định dạng raw:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":138,"end":210,"href":"https:\u002F\u002Fgithub.com\u002Fhasherezade\u002Fpe_recovery_tools\u002Ftree\u002Fmaster\u002Fpe_unmapper","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":109,"end":120,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":125,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":109,"end":120,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":125,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*aFvaLr1U3kxo--j5Wmar9g.png":{"__typename":"ImageMetadata","id":"1*aFvaLr1U3kxo--j5Wmar9g.png","originalHeight":668,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_85":{"__typename":"Paragraph","id":"7d741b1dd33f_85","name":"5fd5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*aFvaLr1U3kxo--j5Wmar9g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_86":{"__typename":"Paragraph","id":"7d741b1dd33f_86","name":"b1a2","type":"P","href":null,"layout":null,"metadata":null,"text":"Debug tiếp, shellcode gọi hàm GetModuleFileNameA được gọi để lấy đường dẫn của EQNEDT32.exe:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":30,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":30,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-TSVcfMc26p1JaA_1n2cOw.png":{"__typename":"ImageMetadata","id":"1*-TSVcfMc26p1JaA_1n2cOw.png","originalHeight":162,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_87":{"__typename":"Paragraph","id":"7d741b1dd33f_87","name":"0258","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-TSVcfMc26p1JaA_1n2cOw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ukVD8cqe0xIXliMSmMUNsw.png":{"__typename":"ImageMetadata","id":"1*ukVD8cqe0xIXliMSmMUNsw.png","originalHeight":74,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_88":{"__typename":"Paragraph","id":"7d741b1dd33f_88","name":"4153","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ukVD8cqe0xIXliMSmMUNsw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_89":{"__typename":"Paragraph","id":"7d741b1dd33f_89","name":"f4f0","type":"P","href":null,"layout":null,"metadata":null,"text":"Sử dụng CreateProcessA (CreateProcessInternalA) để tạo một process EQNEDT32.exe khác ở trạng thái Suspended. Do đang thiết lập tính năng IFEO nên ta sẽ thấy process của debugger thay vì là process EQNEDT32.exe:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":8,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":98,"end":107,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":8,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":24,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":98,"end":107,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XSHvEjf3lq2Uzy9299vzSQ.png":{"__typename":"ImageMetadata","id":"1*XSHvEjf3lq2Uzy9299vzSQ.png","originalHeight":140,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_90":{"__typename":"Paragraph","id":"7d741b1dd33f_90","name":"c8c7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XSHvEjf3lq2Uzy9299vzSQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*uevnQD0-yT3tpm1SudqAyQ.png":{"__typename":"ImageMetadata","id":"1*uevnQD0-yT3tpm1SudqAyQ.png","originalHeight":371,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_91":{"__typename":"Paragraph","id":"7d741b1dd33f_91","name":"81bd","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*uevnQD0-yT3tpm1SudqAyQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_92":{"__typename":"Paragraph","id":"7d741b1dd33f_92","name":"966b","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: Nếu thực hiện lại, tới bước này thì sử dụng Autoruns để bỏ việc sử dụng IFEO và cho thực hiện hàm CreateProcessA, ta sẽ có được kết quả đúng như hình:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":104,"end":118,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":156,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*xr8V8o4nmu84NXG6RuOU9A.png":{"__typename":"ImageMetadata","id":"1*xr8V8o4nmu84NXG6RuOU9A.png","originalHeight":243,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_93":{"__typename":"Paragraph","id":"7d741b1dd33f_93","name":"e2f9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xr8V8o4nmu84NXG6RuOU9A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_94":{"__typename":"Paragraph","id":"7d741b1dd33f_94","name":"f113","type":"P","href":null,"layout":null,"metadata":null,"text":"Đoạn code tiếp theo sẽ lấy thread context bằng GetThreadContext, đọc dữ liệu từ vùng nhớ với hàm ReadProcessMemory, gọi VirtualProtectEx (PAGE_EXECUTE_READWRITE 0x40) để thay đổi trang thái của vùng nhớ trên Suspend process, và cuối cùng shellcode ghi đè lên bằng PE tại địa chỉ 0x5170000:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":47,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":97,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":120,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":279,"end":288,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":47,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":97,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":120,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":138,"end":165,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":279,"end":288,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*SXHrHBZn80BrMUmJNYIxxw.png":{"__typename":"ImageMetadata","id":"1*SXHrHBZn80BrMUmJNYIxxw.png","originalHeight":132,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_95":{"__typename":"Paragraph","id":"7d741b1dd33f_95","name":"0901","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*SXHrHBZn80BrMUmJNYIxxw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_96":{"__typename":"Paragraph","id":"7d741b1dd33f_96","name":"90fe","type":"P","href":null,"layout":null,"metadata":null,"text":"Thực hiện đặt lại thread context bằng SetThreadContext, cuối cùng shellcode thực hiện hàm ResumeThread để launch PE mới:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":38,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":90,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":38,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":90,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*xiZmHXlM1z4eAfKzK07TVA.png":{"__typename":"ImageMetadata","id":"1*xiZmHXlM1z4eAfKzK07TVA.png","originalHeight":130,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_97":{"__typename":"Paragraph","id":"7d741b1dd33f_97","name":"e961","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xiZmHXlM1z4eAfKzK07TVA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_98":{"__typename":"Paragraph","id":"7d741b1dd33f_98","name":"d9ed","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Tổng kết lại, toàn bộ quá trình thực hiện của shellcode là giải mã file 8.t thành một PE mới, sau đó thực hiện nhân bản sang một vùng nhớ khác, thực hiện tạo một fork process mới là EQNEDT32.exe, cuối cùng áp dụng kĩ thuật runPE để launch EQNEDT32.exe mới đã bị ghi đè code bởi nội dung của file 8.t.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":72,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":239,"end":255,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":296,"end":299,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_99":{"__typename":"Paragraph","id":"7d741b1dd33f_99","name":"4cf1","type":"H3","href":null,"layout":null,"metadata":null,"text":"5. Phân tích binary đã dump","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_100":{"__typename":"Paragraph","id":"7d741b1dd33f_100","name":"2672","type":"P","href":null,"layout":null,"metadata":null,"text":"Như đã biết khi phân tích dynamic, sau khi resume thread thì malware sẽ drop ra disk các file sau: QcConsol.exe; QcLite.dll; stdole.tlb vào thư mục %AppData%\\Microsoft\\Windows\\Printer Shortcuts.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":99,"end":135,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":148,"end":193,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":99,"end":135,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_101":{"__typename":"Paragraph","id":"7d741b1dd33f_101","name":"76c4","type":"P","href":null,"layout":null,"metadata":null,"text":"Ở trên tôi có 2 file đã dump là _04F70000.mem và drop_bin.exe (được unmap bằng công cụ pe_unmapper). Tuy nhiên, chỉ có file _04F70000.mem là thực thi được bình thường, còn file drop_bin.exe thì bị crash (mặc dù lúc fix, kiểm tra bằng PE bear thấy mọi thứ đều ok. Tôi có chat hỏi về vấn đề này thì nhận được trả lời của hasherezade như sau: “dumped samples may not always work, so it is normal”).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":32,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":49,"end":99,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":124,"end":137,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":177,"end":189,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":319,"end":330,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":32,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":49,"end":99,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":124,"end":137,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":177,"end":189,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":319,"end":330,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":341,"end":392,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_102":{"__typename":"Paragraph","id":"7d741b1dd33f_102","name":"0b46","type":"P","href":null,"layout":null,"metadata":null,"text":"Mở IDA và load file _04F70000.exe (đổi tên lại từ file .mem), dừng lại tại WinMain():","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":20,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":75,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":20,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":75,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Tp1dQH2fPv4dkISVVJDCuA.png":{"__typename":"ImageMetadata","id":"1*Tp1dQH2fPv4dkISVVJDCuA.png","originalHeight":419,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_103":{"__typename":"Paragraph","id":"7d741b1dd33f_103","name":"de53","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Tp1dQH2fPv4dkISVVJDCuA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_104":{"__typename":"Paragraph","id":"7d741b1dd33f_104","name":"de68","type":"P","href":null,"layout":null,"metadata":null,"text":"Binary lấy đường dẫn tới thư mục %AppData%\\Microsoft\\Windows\\Printer Shortcuts:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":33,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Kd3HZ4Xnk5e94vND-9orbw.png":{"__typename":"ImageMetadata","id":"1*Kd3HZ4Xnk5e94vND-9orbw.png","originalHeight":229,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_105":{"__typename":"Paragraph","id":"7d741b1dd33f_105","name":"65de","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Kd3HZ4Xnk5e94vND-9orbw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_106":{"__typename":"Paragraph","id":"7d741b1dd33f_106","name":"b1bc","type":"P","href":null,"layout":null,"metadata":null,"text":"Cấu thành đường dẫn của các file:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*YOd0ajwB2zmomxpjTAhnxA.png":{"__typename":"ImageMetadata","id":"1*YOd0ajwB2zmomxpjTAhnxA.png","originalHeight":49,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_107":{"__typename":"Paragraph","id":"7d741b1dd33f_107","name":"867f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*YOd0ajwB2zmomxpjTAhnxA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Xh5lxKGL5XmVEKFQl8XkAA.png":{"__typename":"ImageMetadata","id":"1*Xh5lxKGL5XmVEKFQl8XkAA.png","originalHeight":56,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_108":{"__typename":"Paragraph","id":"7d741b1dd33f_108","name":"732b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Xh5lxKGL5XmVEKFQl8XkAA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8kTV_3a7Gh9n3hKUcts0GA.png":{"__typename":"ImageMetadata","id":"1*8kTV_3a7Gh9n3hKUcts0GA.png","originalHeight":59,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_109":{"__typename":"Paragraph","id":"7d741b1dd33f_109","name":"358b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8kTV_3a7Gh9n3hKUcts0GA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_110":{"__typename":"Paragraph","id":"7d741b1dd33f_110","name":"9409","type":"P","href":null,"layout":null,"metadata":null,"text":"Tới đoạn code thực hiện call sub_331860 3 lần để thực hiện drop các file trên vào thư mục chỉ định. Tôi đổi tên sub này thành thành drop_file như hình:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":132,"end":141,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":24,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":132,"end":141,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ALeiuyWgOkg6FiCtXYO-ng.png":{"__typename":"ImageMetadata","id":"1*ALeiuyWgOkg6FiCtXYO-ng.png","originalHeight":366,"originalWidth":485,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_111":{"__typename":"Paragraph","id":"7d741b1dd33f_111","name":"a4b4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ALeiuyWgOkg6FiCtXYO-ng.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_112":{"__typename":"Paragraph","id":"7d741b1dd33f_112","name":"f213","type":"P","href":null,"layout":null,"metadata":null,"text":"Đi sâu vào hàm này sẽ gặp vòng lặp xor thực hiện decode bytes, sau đó là đoạn code thực hiện WriteFile vào thư mục:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":93,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":93,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*q_johZ0o7uBUxVqfbx6GbQ.png":{"__typename":"ImageMetadata","id":"1*q_johZ0o7uBUxVqfbx6GbQ.png","originalHeight":395,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_113":{"__typename":"Paragraph","id":"7d741b1dd33f_113","name":"eaa3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*q_johZ0o7uBUxVqfbx6GbQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_114":{"__typename":"Paragraph","id":"7d741b1dd33f_114","name":"7414","type":"P","href":null,"layout":null,"metadata":null,"text":"Kết quả sau khi thực hiện hàm drop_file đầu tiên, có được file QcConsol.exe:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":30,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":63,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":30,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":63,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IJ1h4xazG6nqYWRMpJgM-g.png":{"__typename":"ImageMetadata","id":"1*IJ1h4xazG6nqYWRMpJgM-g.png","originalHeight":81,"originalWidth":605,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_115":{"__typename":"Paragraph","id":"7d741b1dd33f_115","name":"4342","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IJ1h4xazG6nqYWRMpJgM-g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_116":{"__typename":"Paragraph","id":"7d741b1dd33f_116","name":"1a8b","type":"P","href":null,"layout":null,"metadata":null,"text":"Đây là một file hợp lệ, có chữ kí và được phát triển bởi hãng McAfee, Inc.:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":62,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":62,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Ci1AckRV9vSUXgGbpAWSNw.png":{"__typename":"ImageMetadata","id":"1*Ci1AckRV9vSUXgGbpAWSNw.png","originalHeight":348,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_117":{"__typename":"Paragraph","id":"7d741b1dd33f_117","name":"b031","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Ci1AckRV9vSUXgGbpAWSNw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZS4MBpJfObc5yWTG9azMIg.png":{"__typename":"ImageMetadata","id":"1*ZS4MBpJfObc5yWTG9azMIg.png","originalHeight":233,"originalWidth":316,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_118":{"__typename":"Paragraph","id":"7d741b1dd33f_118","name":"159b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZS4MBpJfObc5yWTG9azMIg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_119":{"__typename":"Paragraph","id":"7d741b1dd33f_119","name":"f822","type":"P","href":null,"layout":null,"metadata":null,"text":"Lời gọi hàm drop_file thứ 2 sẽ drop ra file QcLite.dll, file này không có thông tin gì về Signature cũng như info, như vậy malicious code sẽ nằm ở file này:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":12,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":44,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":12,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":44,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rIMHzMiAyKSa1scEf20AHQ.png":{"__typename":"ImageMetadata","id":"1*rIMHzMiAyKSa1scEf20AHQ.png","originalHeight":78,"originalWidth":600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_120":{"__typename":"Paragraph","id":"7d741b1dd33f_120","name":"91d8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*rIMHzMiAyKSa1scEf20AHQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*FPeV-xmtGV3zVRnBW2Y5pw.png":{"__typename":"ImageMetadata","id":"1*FPeV-xmtGV3zVRnBW2Y5pw.png","originalHeight":288,"originalWidth":377,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_121":{"__typename":"Paragraph","id":"7d741b1dd33f_121","name":"4d16","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*FPeV-xmtGV3zVRnBW2Y5pw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_122":{"__typename":"Paragraph","id":"7d741b1dd33f_122","name":"0e22","type":"P","href":null,"layout":null,"metadata":null,"text":"Lời gọi hàm drop_file thứ 3 sẽ drop ra file stdole.tlb. Thông tin về .tlb có thể xem tại đây (https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fdesktop\u002Fmidl\u002Fcom-dcom-and-type-libraries):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":94,"end":175,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fdesktop\u002Fmidl\u002Fcom-dcom-and-type-libraries","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":12,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":44,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":69,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":12,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":69,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*LA1GkxahkFRBGI_vYF5y3A.png":{"__typename":"ImageMetadata","id":"1*LA1GkxahkFRBGI_vYF5y3A.png","originalHeight":100,"originalWidth":617,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_123":{"__typename":"Paragraph","id":"7d741b1dd33f_123","name":"99e8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*LA1GkxahkFRBGI_vYF5y3A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_124":{"__typename":"Paragraph","id":"7d741b1dd33f_124","name":"bfff","type":"P","href":null,"layout":null,"metadata":null,"text":"Tiếp tục, cấu thành một command như sau:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lvuRRwo3od79EgCPNIOpCA.png":{"__typename":"ImageMetadata","id":"1*lvuRRwo3od79EgCPNIOpCA.png","originalHeight":57,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_125":{"__typename":"Paragraph","id":"7d741b1dd33f_125","name":"be7c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lvuRRwo3od79EgCPNIOpCA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_126":{"__typename":"Paragraph","id":"7d741b1dd33f_126","name":"4073","type":"P","href":null,"layout":null,"metadata":null,"text":"Cuối cùng, gọi hàm WinExec để thực thi QcConsol.exe với tham số là “-LowIntegrityServer”:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":19,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":39,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":67,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":19,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":39,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":67,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0mSvs5xZ7S3HoR1-2rG12w.png":{"__typename":"ImageMetadata","id":"1*0mSvs5xZ7S3HoR1-2rG12w.png","originalHeight":139,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_127":{"__typename":"Paragraph","id":"7d741b1dd33f_127","name":"99e6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0mSvs5xZ7S3HoR1-2rG12w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_128":{"__typename":"Paragraph","id":"7d741b1dd33f_128","name":"1b0d","type":"P","href":null,"layout":null,"metadata":null,"text":"Như vậy, với việc thực thi thành công, QcConsol.exe chắc chắn sẽ phải load QcLite.dll vào để thưc thi malicious code.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":39,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":75,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":75,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_129":{"__typename":"Paragraph","id":"7d741b1dd33f_129","name":"211b","type":"H3","href":null,"layout":null,"metadata":null,"text":"6. DLL hijacking — Phân tích file QcConsol.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_130":{"__typename":"Paragraph","id":"7d741b1dd33f_130","name":"fdfd","type":"P","href":null,"layout":null,"metadata":null,"text":"Load file vào IDA nhận được thông báo:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IvrOBdTzvt6wqAP4FBpnsw.png":{"__typename":"ImageMetadata","id":"1*IvrOBdTzvt6wqAP4FBpnsw.png","originalHeight":185,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_131":{"__typename":"Paragraph","id":"7d741b1dd33f_131","name":"fcfa","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IvrOBdTzvt6wqAP4FBpnsw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_132":{"__typename":"Paragraph","id":"7d741b1dd33f_132","name":"46ca","type":"P","href":null,"layout":null,"metadata":null,"text":"Để nạp được QcLite.dll, QcConsol.exe sử dụng API LoadLibraryW và sau đó gọi GetProcAddress để lấy địa chỉ của hàm. Về bản chất khi thực hiện nạp module thì đồng thời code của dll cũng sẽ được thực hiện bắt đầu từ DllMain:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":12,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":24,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":49,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":76,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":213,"end":220,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":12,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":24,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":49,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":76,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":213,"end":220,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*B9tsBlt9hGv5uDw4v-XAkA.png":{"__typename":"ImageMetadata","id":"1*B9tsBlt9hGv5uDw4v-XAkA.png","originalHeight":129,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_133":{"__typename":"Paragraph","id":"7d741b1dd33f_133","name":"ff30","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*B9tsBlt9hGv5uDw4v-XAkA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_134":{"__typename":"Paragraph","id":"7d741b1dd33f_134","name":"7ad3","type":"H3","href":null,"layout":null,"metadata":null,"text":"7. Phân tích sơ bộ file QcLite.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_135":{"__typename":"Paragraph","id":"7d741b1dd33f_135","name":"0d8f","type":"P","href":null,"layout":null,"metadata":null,"text":"Gọi hàm VirtualAlloc để cấp phát một vùng nhớ:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":8,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":8,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nV7fU2Z2BFDFp8jYe-4YAw.png":{"__typename":"ImageMetadata","id":"1*nV7fU2Z2BFDFp8jYe-4YAw.png","originalHeight":26,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_136":{"__typename":"Paragraph","id":"7d741b1dd33f_136","name":"329b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*nV7fU2Z2BFDFp8jYe-4YAw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_137":{"__typename":"Paragraph","id":"7d741b1dd33f_137","name":"0f85","type":"P","href":null,"layout":null,"metadata":null,"text":"Lấy đường dẫn đầy đủ tới QcLite.dll:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":25,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":25,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*PrkPSR6Ah4afO1PCGGWkkA.png":{"__typename":"ImageMetadata","id":"1*PrkPSR6Ah4afO1PCGGWkkA.png","originalHeight":31,"originalWidth":497,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_138":{"__typename":"Paragraph","id":"7d741b1dd33f_138","name":"212e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*PrkPSR6Ah4afO1PCGGWkkA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_139":{"__typename":"Paragraph","id":"7d741b1dd33f_139","name":"9c63","type":"P","href":null,"layout":null,"metadata":null,"text":"Dll này sẽ load file .tlb:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":21,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":21,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*hRyaApDx3lkwh30btqGsOg.png":{"__typename":"ImageMetadata","id":"1*hRyaApDx3lkwh30btqGsOg.png","originalHeight":57,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_140":{"__typename":"Paragraph","id":"7d741b1dd33f_140","name":"52ed","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*hRyaApDx3lkwh30btqGsOg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_141":{"__typename":"Paragraph","id":"7d741b1dd33f_141","name":"cb9f","type":"P","href":null,"layout":null,"metadata":null,"text":"Gọi hàm CreatFileW để mở file này (lpFileName trỏ tới stdole.tlb):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":8,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":35,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":54,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":8,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":35,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*zFJ7ra3IYao7KSlp8f7XdQ.png":{"__typename":"ImageMetadata","id":"1*zFJ7ra3IYao7KSlp8f7XdQ.png","originalHeight":24,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_142":{"__typename":"Paragraph","id":"7d741b1dd33f_142","name":"f2e7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*zFJ7ra3IYao7KSlp8f7XdQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*MmBDqYxKG-GCoVdajmgSBQ.png":{"__typename":"ImageMetadata","id":"1*MmBDqYxKG-GCoVdajmgSBQ.png","originalHeight":106,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_143":{"__typename":"Paragraph","id":"7d741b1dd33f_143","name":"1ac3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*MmBDqYxKG-GCoVdajmgSBQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_144":{"__typename":"Paragraph","id":"7d741b1dd33f_144","name":"764f","type":"P","href":null,"layout":null,"metadata":null,"text":"Lấy kích thước của stdole.tlb:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":19,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":19,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*yZoKxfedYZYH7GYrwhegtg.png":{"__typename":"ImageMetadata","id":"1*yZoKxfedYZYH7GYrwhegtg.png","originalHeight":29,"originalWidth":401,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_145":{"__typename":"Paragraph","id":"7d741b1dd33f_145","name":"6104","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*yZoKxfedYZYH7GYrwhegtg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_146":{"__typename":"Paragraph","id":"7d741b1dd33f_146","name":"776e","type":"P","href":null,"layout":null,"metadata":null,"text":"Đọc dữ liệu từ stdole.tlb và lưu vào vùng nhớ đã cấp phát ở trên:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":15,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":15,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*d3iWpifNiCE8Ul4Enk25ow.png":{"__typename":"ImageMetadata","id":"1*d3iWpifNiCE8Ul4Enk25ow.png","originalHeight":39,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_147":{"__typename":"Paragraph","id":"7d741b1dd33f_147","name":"b564","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*d3iWpifNiCE8Ul4Enk25ow.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*87qbjS1eLYfYzcGHZP8xZg.png":{"__typename":"ImageMetadata","id":"1*87qbjS1eLYfYzcGHZP8xZg.png","originalHeight":110,"originalWidth":501,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_148":{"__typename":"Paragraph","id":"7d741b1dd33f_148","name":"4560","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*87qbjS1eLYfYzcGHZP8xZg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*FMBqm5NmdZLhx42YzytGLg.png":{"__typename":"ImageMetadata","id":"1*FMBqm5NmdZLhx42YzytGLg.png","originalHeight":81,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_149":{"__typename":"Paragraph","id":"7d741b1dd33f_149","name":"0289","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*FMBqm5NmdZLhx42YzytGLg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_150":{"__typename":"Paragraph","id":"7d741b1dd33f_150","name":"e6ba","type":"P","href":null,"layout":null,"metadata":null,"text":"Thực hiện vòng lặp sử dụng xor để decode toàn bộ dữ liệu của stdole.tlb đã được copy lên memory:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":27,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":61,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":27,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":61,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*K4Fo5l49ACd4CsXnwgBK0A.png":{"__typename":"ImageMetadata","id":"1*K4Fo5l49ACd4CsXnwgBK0A.png","originalHeight":542,"originalWidth":556,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_151":{"__typename":"Paragraph","id":"7d741b1dd33f_151","name":"b621","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*K4Fo5l49ACd4CsXnwgBK0A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_152":{"__typename":"Paragraph","id":"7d741b1dd33f_152","name":"671a","type":"P","href":null,"layout":null,"metadata":null,"text":"Kết quả có được sau khi decode, nghi ngờ khả năng đây có thể sẽ là một PE file khác:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*zVERaNhRUIGU0ZlVC2KSMA.png":{"__typename":"ImageMetadata","id":"1*zVERaNhRUIGU0ZlVC2KSMA.png","originalHeight":453,"originalWidth":590,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_153":{"__typename":"Paragraph","id":"7d741b1dd33f_153","name":"3c5f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*zVERaNhRUIGU0ZlVC2KSMA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_154":{"__typename":"Paragraph","id":"7d741b1dd33f_154","name":"b4a3","type":"P","href":null,"layout":null,"metadata":null,"text":"Qua rất nhiều rop_chain (tôi đoán thế :D) thì sẽ nhảy tới vùng nhớ trên để thực thi code (Cách nhanh nhất thì các bạn có thể đặt một HWBP on Execute tại 4 bytes đầu 0x50 0x68 0xA7 0x45; sau đó nhấn F9 là tới):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":133,"end":148,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":165,"end":184,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":14,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":90,"end":207,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*HwhmVYJs-EAk1x35gTGAbg.png":{"__typename":"ImageMetadata","id":"1*HwhmVYJs-EAk1x35gTGAbg.png","originalHeight":295,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_155":{"__typename":"Paragraph","id":"7d741b1dd33f_155","name":"4af7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*HwhmVYJs-EAk1x35gTGAbg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*GygNk5sRuCLYk_PA57CK9g.png":{"__typename":"ImageMetadata","id":"1*GygNk5sRuCLYk_PA57CK9g.png","originalHeight":57,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_156":{"__typename":"Paragraph","id":"7d741b1dd33f_156","name":"d854","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*GygNk5sRuCLYk_PA57CK9g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_157":{"__typename":"Paragraph","id":"7d741b1dd33f_157","name":"7cbb","type":"P","href":null,"layout":null,"metadata":null,"text":"Shellcode tại 0x01A10000 sẽ truy cập PEB (Process Environment Block) để lấy ra địa chỉ base address của kernel32.dll:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":14,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":37,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":104,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":14,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":37,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":104,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*dDadL0KBC8O8x6KqB7OccA.png":{"__typename":"ImageMetadata","id":"1*dDadL0KBC8O8x6KqB7OccA.png","originalHeight":223,"originalWidth":247,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_158":{"__typename":"Paragraph","id":"7d741b1dd33f_158","name":"956b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*dDadL0KBC8O8x6KqB7OccA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fMLtLweHn29WGhQ54gQGuA.png":{"__typename":"ImageMetadata","id":"1*fMLtLweHn29WGhQ54gQGuA.png","originalHeight":154,"originalWidth":538,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_159":{"__typename":"Paragraph","id":"7d741b1dd33f_159","name":"6f45","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fMLtLweHn29WGhQ54gQGuA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_160":{"__typename":"Paragraph","id":"7d741b1dd33f_160","name":"875d","type":"P","href":null,"layout":null,"metadata":null,"text":"Sau khi có được base address của kernel32.dll, shellcode sẽ tìm địa chỉ của hàm API GetProcAddress:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":33,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":84,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":33,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*OWi2TYbx2opIVPLGEWEmKw.png":{"__typename":"ImageMetadata","id":"1*OWi2TYbx2opIVPLGEWEmKw.png","originalHeight":338,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_161":{"__typename":"Paragraph","id":"7d741b1dd33f_161","name":"0fb5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*OWi2TYbx2opIVPLGEWEmKw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*MDAM8M8aIjNSBYx3YwxGaQ.png":{"__typename":"ImageMetadata","id":"1*MDAM8M8aIjNSBYx3YwxGaQ.png","originalHeight":47,"originalWidth":327,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_162":{"__typename":"Paragraph","id":"7d741b1dd33f_162","name":"2465","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*MDAM8M8aIjNSBYx3YwxGaQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_163":{"__typename":"Paragraph","id":"7d741b1dd33f_163","name":"1f07","type":"P","href":null,"layout":null,"metadata":null,"text":"Với hàm API GetProcAddress, shellcode sẽ lấy địa chỉ của các hàm API khác là LoadLibraryA, VirtualAlloc, FreeLibraryA, Sleep:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":12,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":77,"end":89,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":91,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":105,"end":117,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":119,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":12,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":77,"end":89,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":91,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":105,"end":117,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":119,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*DzaZkhiwzDJQYnIQGj6MWw.png":{"__typename":"ImageMetadata","id":"1*DzaZkhiwzDJQYnIQGj6MWw.png","originalHeight":206,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_164":{"__typename":"Paragraph","id":"7d741b1dd33f_164","name":"f9ff","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*DzaZkhiwzDJQYnIQGj6MWw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_165":{"__typename":"Paragraph","id":"7d741b1dd33f_165","name":"09a0","type":"P","href":null,"layout":null,"metadata":null,"text":"Sử dụng hàm VirtualAlloc để cấp phát một vùng nhớ và gọi hàm decode_data() để decode bytes trong shellcode vào vùng nhớ cấp phát:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":12,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":61,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":12,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":61,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3re1i7xXitmEbbNqXhXKAg.png":{"__typename":"ImageMetadata","id":"1*3re1i7xXitmEbbNqXhXKAg.png","originalHeight":168,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_166":{"__typename":"Paragraph","id":"7d741b1dd33f_166","name":"2b8d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3re1i7xXitmEbbNqXhXKAg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*_Qnw8IK_ckVF8hsxcnoTVA.png":{"__typename":"ImageMetadata","id":"1*_Qnw8IK_ckVF8hsxcnoTVA.png","originalHeight":399,"originalWidth":592,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_167":{"__typename":"Paragraph","id":"7d741b1dd33f_167","name":"e017","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*_Qnw8IK_ckVF8hsxcnoTVA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_168":{"__typename":"Paragraph","id":"7d741b1dd33f_168","name":"8d88","type":"P","href":null,"layout":null,"metadata":null,"text":"Tiếp tục sử dụng VirtualAlloc để cấp phát thêm một vùng nhớ khác với kích thước lấy từ vùng nhớ trên (dwSize = SizeOfImage = PE_header + 0x50) và thiết lập vùng nhớ mới này là PAGE_EXECUTE_READWRITE:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":17,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":102,"end":141,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":176,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":17,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":102,"end":141,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":176,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*K6nH25yfQ-OyRgkLR5LB6g.png":{"__typename":"ImageMetadata","id":"1*K6nH25yfQ-OyRgkLR5LB6g.png","originalHeight":193,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_169":{"__typename":"Paragraph","id":"7d741b1dd33f_169","name":"a1da","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*K6nH25yfQ-OyRgkLR5LB6g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_170":{"__typename":"Paragraph","id":"7d741b1dd33f_170","name":"4599","type":"P","href":null,"layout":null,"metadata":null,"text":"Sau khi lấy được section header tại vùng nhớ 0x01880000 ở trên, thực hiện vòng lặp để copy toàn bộ các section data sang vùng nhớ mới được cấp phát:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":45,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":45,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vxQXLmQq3LOB-vOdQ2m3ag.png":{"__typename":"ImageMetadata","id":"1*vxQXLmQq3LOB-vOdQ2m3ag.png","originalHeight":543,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_171":{"__typename":"Paragraph","id":"7d741b1dd33f_171","name":"e2d5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vxQXLmQq3LOB-vOdQ2m3ag.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_172":{"__typename":"Paragraph","id":"7d741b1dd33f_172","name":"316f","type":"P","href":null,"layout":null,"metadata":null,"text":"Tiến hành resolve toàn bộ địa chỉ API ghi lại vào IAT của vùng nhớ mới:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rrfeJG8WopL_o3jsnVyXiQ.png":{"__typename":"ImageMetadata","id":"1*rrfeJG8WopL_o3jsnVyXiQ.png","originalHeight":533,"originalWidth":525,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_173":{"__typename":"Paragraph","id":"7d741b1dd33f_173","name":"4c91","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*rrfeJG8WopL_o3jsnVyXiQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_174":{"__typename":"Paragraph","id":"7d741b1dd33f_174","name":"60fa","type":"P","href":null,"layout":null,"metadata":null,"text":"Sau khi lấy địa chỉ của toàn bộ các API cần thiết, sử dụng lệnh call để nhảy tới vùng nhớ để thực hiện lệnh:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*JU_YXrnniTDMepCHDBZhZQ.png":{"__typename":"ImageMetadata","id":"1*JU_YXrnniTDMepCHDBZhZQ.png","originalHeight":61,"originalWidth":617,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_175":{"__typename":"Paragraph","id":"7d741b1dd33f_175","name":"7413","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JU_YXrnniTDMepCHDBZhZQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_176":{"__typename":"Paragraph","id":"7d741b1dd33f_176","name":"d090","type":"P","href":null,"layout":null,"metadata":null,"text":"Tiếp tục debug xuyên qua nhiều lớp call sẽ tới đoạn gọi hàm CreateThread để tạo một thread mới:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":60,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":60,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9niZGU2WGqziUv2w6tPVWA.png":{"__typename":"ImageMetadata","id":"1*9niZGU2WGqziUv2w6tPVWA.png","originalHeight":194,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_177":{"__typename":"Paragraph","id":"7d741b1dd33f_177","name":"dfd6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9niZGU2WGqziUv2w6tPVWA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_178":{"__typename":"Paragraph","id":"7d741b1dd33f_178","name":"c8f4","type":"P","href":null,"layout":null,"metadata":null,"text":"Đi tới ThreadFunction tại địa chỉ 0x01EE35D0. Code tại đây thực hiện lấy thông tin binary có sẵn của Windows là dllhst3g.exe:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":34,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":112,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":7,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":34,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":112,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lqw2UxB-bQRoGvEfuuHwIg.png":{"__typename":"ImageMetadata","id":"1*lqw2UxB-bQRoGvEfuuHwIg.png","originalHeight":58,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_179":{"__typename":"Paragraph","id":"7d741b1dd33f_179","name":"5749","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lqw2UxB-bQRoGvEfuuHwIg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_180":{"__typename":"Paragraph","id":"7d741b1dd33f_180","name":"274b","type":"P","href":null,"layout":null,"metadata":null,"text":"Xem tổng quan code thì thấy có đoạn code liên quan đến C2 (login[dot]dangquanwatch[dot]com):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":59,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nf0I4fLH7MD1B9GcHDqbrw.png":{"__typename":"ImageMetadata","id":"1*nf0I4fLH7MD1B9GcHDqbrw.png","originalHeight":45,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_181":{"__typename":"Paragraph","id":"7d741b1dd33f_181","name":"6f72","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*nf0I4fLH7MD1B9GcHDqbrw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_182":{"__typename":"Paragraph","id":"7d741b1dd33f_182","name":"2a36","type":"P","href":null,"layout":null,"metadata":null,"text":"Tạo một thread khác làm nhiệm vụ tạo Persistent trong Registry HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":63,"end":127,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":63,"end":127,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*zy4za7POBmrjG1YkZ2_O6A.png":{"__typename":"ImageMetadata","id":"1*zy4za7POBmrjG1YkZ2_O6A.png","originalHeight":132,"originalWidth":426,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_183":{"__typename":"Paragraph","id":"7d741b1dd33f_183","name":"5583","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*zy4za7POBmrjG1YkZ2_O6A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XZZ53K4_iEwx7ftjLk5DTg.png":{"__typename":"ImageMetadata","id":"1*XZZ53K4_iEwx7ftjLk5DTg.png","originalHeight":30,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_184":{"__typename":"Paragraph","id":"7d741b1dd33f_184","name":"5a80","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XZZ53K4_iEwx7ftjLk5DTg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_185":{"__typename":"Paragraph","id":"7d741b1dd33f_185","name":"0216","type":"P","href":null,"layout":null,"metadata":null,"text":"Gọi hàm WritePrivateProfileStringW để ghi string vào file tại “C:\\ProgramData\\desktop.ini”:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":8,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":63,"end":89,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":8,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":63,"end":89,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*x6ZVTRZxezwE1TjVOr1PeQ.png":{"__typename":"ImageMetadata","id":"1*x6ZVTRZxezwE1TjVOr1PeQ.png","originalHeight":72,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_186":{"__typename":"Paragraph","id":"7d741b1dd33f_186","name":"e9f3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*x6ZVTRZxezwE1TjVOr1PeQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_187":{"__typename":"Paragraph","id":"7d741b1dd33f_187","name":"bd97","type":"P","href":null,"layout":null,"metadata":null,"text":"Thiết lập thuộc tính cho file với hàm SetFileAttributesW:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":38,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":38,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7uykeVzDjXTmYI0gVwI3rw.png":{"__typename":"ImageMetadata","id":"1*7uykeVzDjXTmYI0gVwI3rw.png","originalHeight":68,"originalWidth":539,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_188":{"__typename":"Paragraph","id":"7d741b1dd33f_188","name":"9a54","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*7uykeVzDjXTmYI0gVwI3rw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8X7YB5QeTY3JwR0_gncO5w.png":{"__typename":"ImageMetadata","id":"1*8X7YB5QeTY3JwR0_gncO5w.png","originalHeight":88,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_189":{"__typename":"Paragraph","id":"7d741b1dd33f_189","name":"e8a8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8X7YB5QeTY3JwR0_gncO5w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_190":{"__typename":"Paragraph","id":"7d741b1dd33f_190","name":"2a3d","type":"P","href":null,"layout":null,"metadata":null,"text":"Tạo một Mutex {986AFDE7-F299–4A7D-BBF4-CA756FC01F1B65027208}, tuy nhiên handle tới mutext này sẽ bị đóng ngay sau đó:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":8,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lAWNwebWDuCwkDdtIt875A.png":{"__typename":"ImageMetadata","id":"1*lAWNwebWDuCwkDdtIt875A.png","originalHeight":53,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_191":{"__typename":"Paragraph","id":"7d741b1dd33f_191","name":"ce20","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lAWNwebWDuCwkDdtIt875A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*P1Bx4-JRniESihO06Bh79Q.png":{"__typename":"ImageMetadata","id":"1*P1Bx4-JRniESihO06Bh79Q.png","originalHeight":116,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_192":{"__typename":"Paragraph","id":"7d741b1dd33f_192","name":"a2dd","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*P1Bx4-JRniESihO06Bh79Q.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_193":{"__typename":"Paragraph","id":"7d741b1dd33f_193","name":"81f9","type":"P","href":null,"layout":null,"metadata":null,"text":"Tiếp tục sử dụng bộ API CreateFileW, GetFileSize, VirtualAlloc, ReadFile để một lần nữa đọc ra nội dung được lưu trong file %AppData%\\Microsoft\\Windows\\Printer Shortcuts\\stdole.tlb và thực hiện decode dữ liệu giống như đã nói ở bước trước:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":37,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":50,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":64,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":124,"end":180,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":24,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":37,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":50,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":64,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":124,"end":180,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*iky4qcKwNaBR6cse20X7bw.png":{"__typename":"ImageMetadata","id":"1*iky4qcKwNaBR6cse20X7bw.png","originalHeight":230,"originalWidth":593,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_194":{"__typename":"Paragraph","id":"7d741b1dd33f_194","name":"65c8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*iky4qcKwNaBR6cse20X7bw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_195":{"__typename":"Paragraph","id":"7d741b1dd33f_195","name":"a8a4","type":"P","href":null,"layout":null,"metadata":null,"text":"Thực hiện kĩ thuật inject code bằng cách gọi hàm CreateProcessW để khởi động tiến trình dllhst3g.exe ở trạng thái Suspended:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":49,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":88,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":114,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":49,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":88,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":114,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*FLbPMpQ_-NoLLHIq2eZWbA.png":{"__typename":"ImageMetadata","id":"1*FLbPMpQ_-NoLLHIq2eZWbA.png","originalHeight":175,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_196":{"__typename":"Paragraph","id":"7d741b1dd33f_196","name":"55d2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*FLbPMpQ_-NoLLHIq2eZWbA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*BpVkqjeuBm7MJfyVTlgEJQ.png":{"__typename":"ImageMetadata","id":"1*BpVkqjeuBm7MJfyVTlgEJQ.png","originalHeight":168,"originalWidth":623,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_197":{"__typename":"Paragraph","id":"7d741b1dd33f_197","name":"e00e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*BpVkqjeuBm7MJfyVTlgEJQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_198":{"__typename":"Paragraph","id":"7d741b1dd33f_198","name":"18d4","type":"P","href":null,"layout":null,"metadata":null,"text":"Cấp phát vùng nhớ trong tiến trình này thông qua hàm VirtualAllocEx:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":53,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":53,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*tTqmJDG-TjyO-de7Z6A2Vw.png":{"__typename":"ImageMetadata","id":"1*tTqmJDG-TjyO-de7Z6A2Vw.png","originalHeight":93,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_199":{"__typename":"Paragraph","id":"7d741b1dd33f_199","name":"31a5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*tTqmJDG-TjyO-de7Z6A2Vw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_200":{"__typename":"Paragraph","id":"7d741b1dd33f_200","name":"aeb2","type":"P","href":null,"layout":null,"metadata":null,"text":"Gọi hàm WriteProcessMemory để ghi dữ liệu từ 0x00F90000 (buffer chứa data đã decode của stdole.tlb) vào vùng nhớ đã cấp phát tại tiến trình dllhst3g.exe, đặt lại thread context và resume thread. Lúc này dllhst3g.exe sẽ thực thi bình thường và thực thi luôn malicious code:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":8,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":45,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":140,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":203,"end":215,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":8,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":45,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":57,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":140,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":203,"end":215,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*4wbw8KP_DATfZMot7GHi_w.png":{"__typename":"ImageMetadata","id":"1*4wbw8KP_DATfZMot7GHi_w.png","originalHeight":178,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_201":{"__typename":"Paragraph","id":"7d741b1dd33f_201","name":"4145","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*4wbw8KP_DATfZMot7GHi_w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*xZpweayv3ZhdR6aknc5WEQ.png":{"__typename":"ImageMetadata","id":"1*xZpweayv3ZhdR6aknc5WEQ.png","originalHeight":76,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_202":{"__typename":"Paragraph","id":"7d741b1dd33f_202","name":"6b4f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xZpweayv3ZhdR6aknc5WEQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_203":{"__typename":"Paragraph","id":"7d741b1dd33f_203","name":"954c","type":"H3","href":null,"layout":null,"metadata":null,"text":"8. Debug dllhst3g.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_204":{"__typename":"Paragraph","id":"7d741b1dd33f_204","name":"fd47","type":"P","href":null,"layout":null,"metadata":null,"text":"Hoàn thành xong việc inject code vào dllhst3g.exe sẽ gọi ExitProcess để kết thúc tiến trình QcConsol.exe và tiếp tục thực thi tiến trình dllhst3g.exe. Do dllhst3g.exe bị inject code của file stdole.tlb sau khi decode trên bộ nhớ, nên cách thức hoạt động cũng tương tự. Để có thể debug xem dllhst3g.exe sẽ làm gì thì trước khi thực hiện bước WriteProcessMemory ở trên, sửa 2 bytes đầu là 0x50 0x68 thành 0xEB 0xFE. Sau khi resume thread, mở một debugger khác để attach và khôi phục lại 2 bytes đã bị sửa.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":37,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":57,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":92,"end":104,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":137,"end":149,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":154,"end":166,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":289,"end":301,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":341,"end":359,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":386,"end":396,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":403,"end":412,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":37,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":57,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":92,"end":104,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":137,"end":149,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":154,"end":166,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":191,"end":201,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":269,"end":301,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":312,"end":503,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_205":{"__typename":"Paragraph","id":"7d741b1dd33f_205","name":"c479","type":"P","href":null,"layout":null,"metadata":null,"text":"Lúc này, debug sẽ thấy code tạo một mutext và đọc lại nội dung từ file “C:\\ProgramData\\desktop.ini” và decode string trong file này thành:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":72,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":72,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*FXodpiCesmviUjpZJx2Vtg.png":{"__typename":"ImageMetadata","id":"1*FXodpiCesmviUjpZJx2Vtg.png","originalHeight":75,"originalWidth":608,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_206":{"__typename":"Paragraph","id":"7d741b1dd33f_206","name":"d2d3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*FXodpiCesmviUjpZJx2Vtg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_207":{"__typename":"Paragraph","id":"7d741b1dd33f_207","name":"e72b","type":"P","href":null,"layout":null,"metadata":null,"text":"Gắn thêm tham số: 0206F4E4 00D80B30 UNICODE “”C:\\Users\\REM\\AppData\\Roaming\\Microsoft\\Windows\\Printer Shortcuts\\QcConsol.exe” -LowIntegrityServer” và gọi hàm WinExec để thực thi","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":126,"end":144,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":157,"end":164,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":18,"end":145,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":157,"end":164,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*SkQWqSUsMTSgZUkCjVxyvA.png":{"__typename":"ImageMetadata","id":"1*SkQWqSUsMTSgZUkCjVxyvA.png","originalHeight":41,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_208":{"__typename":"Paragraph","id":"7d741b1dd33f_208","name":"59ec","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*SkQWqSUsMTSgZUkCjVxyvA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*BVVpWqyi8_6UNPbI-naZGg.png":{"__typename":"ImageMetadata","id":"1*BVVpWqyi8_6UNPbI-naZGg.png","originalHeight":66,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_209":{"__typename":"Paragraph","id":"7d741b1dd33f_209","name":"e6f3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*BVVpWqyi8_6UNPbI-naZGg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_210":{"__typename":"Paragraph","id":"7d741b1dd33f_210","name":"2949","type":"P","href":null,"layout":null,"metadata":null,"text":"Tiến trình mới này sẽ kết nối tới C2 (Ở đây tôi đang lái traffic về REMnux):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":38,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":38,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3fhgC-P4xkKFfr0m_lC8AA.png":{"__typename":"ImageMetadata","id":"1*3fhgC-P4xkKFfr0m_lC8AA.png","originalHeight":119,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_211":{"__typename":"Paragraph","id":"7d741b1dd33f_211","name":"7d9b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3fhgC-P4xkKFfr0m_lC8AA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_212":{"__typename":"Paragraph","id":"7d741b1dd33f_212","name":"3aa4","type":"P","href":null,"layout":null,"metadata":null,"text":"Tại máy REMnux, sử dụng wireshark sẽ capture được thông tin như hình:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ReLvnC7AUEp54fum3h5RbA.png":{"__typename":"ImageMetadata","id":"1*ReLvnC7AUEp54fum3h5RbA.png","originalHeight":137,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7d741b1dd33f_213":{"__typename":"Paragraph","id":"7d741b1dd33f_213","name":"12da","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ReLvnC7AUEp54fum3h5RbA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_214":{"__typename":"Paragraph","id":"7d741b1dd33f_214","name":"4f82","type":"H3","href":null,"layout":null,"metadata":null,"text":"9. IOCs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_215":{"__typename":"Paragraph","id":"7d741b1dd33f_215","name":"712a","type":"P","href":null,"layout":null,"metadata":null,"text":"Domain: login[dot]dangquanwatch[dot]com \u002F IP: 185.77.129.142","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_216":{"__typename":"Paragraph","id":"7d741b1dd33f_216","name":"80c4","type":"P","href":null,"layout":null,"metadata":null,"text":"RTF: b45087ad4f7d84758046e9d6eb174530fee98b069105a78f124cbde1ecfb0415","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_217":{"__typename":"Paragraph","id":"7d741b1dd33f_217","name":"27ce","type":"P","href":null,"layout":null,"metadata":null,"text":"8.t: 6328dd14eda2ef983810c0c7b3af47298b5998e4fa52d97b204be2818f08bb69","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_218":{"__typename":"Paragraph","id":"7d741b1dd33f_218","name":"246c","type":"P","href":null,"layout":null,"metadata":null,"text":"Binary:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_219":{"__typename":"Paragraph","id":"7d741b1dd33f_219","name":"bff5","type":"P","href":null,"layout":null,"metadata":null,"text":"QcConsol.exe: 9f3114e48dd0245467fd184bb9655a5208fa7d13e2fe06514d1f3d61ce8b8770","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_220":{"__typename":"Paragraph","id":"7d741b1dd33f_220","name":"bdaf","type":"P","href":null,"layout":null,"metadata":null,"text":"QcLite.dll: 5b652205b1c248e5d5fc0eb5f53c5754df829ed2479687d4f14c2e08fbf87e76","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_221":{"__typename":"Paragraph","id":"7d741b1dd33f_221","name":"b9e3","type":"P","href":null,"layout":null,"metadata":null,"text":"Others:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_222":{"__typename":"Paragraph","id":"7d741b1dd33f_222","name":"6e34","type":"P","href":null,"layout":null,"metadata":null,"text":"stdole.tlb: ba620bad026f25ba6decc4bdcefc6415b563503cf9eaddc4e1137a5871d5cee2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_223":{"__typename":"Paragraph","id":"7d741b1dd33f_223","name":"70a3","type":"P","href":null,"layout":null,"metadata":null,"text":"desktop.ini: 31c2be9ca29fb2bd8096720c221ee9682f013eee119b02d390d6efc12684392d","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_224":{"__typename":"Paragraph","id":"7d741b1dd33f_224","name":"0be9","type":"P","href":null,"layout":null,"metadata":null,"text":"Registry:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_225":{"__typename":"Paragraph","id":"7d741b1dd33f_225","name":"4269","type":"P","href":null,"layout":null,"metadata":null,"text":"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run & HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_226":{"__typename":"Paragraph","id":"7d741b1dd33f_226","name":"7b2b","type":"P","href":null,"layout":null,"metadata":null,"text":"ValueName: Windows HD Audio Manager","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7d741b1dd33f_227":{"__typename":"Paragraph","id":"7d741b1dd33f_227","name":"7334","type":"P","href":null,"layout":null,"metadata":null,"text":"Data: %AppData%\\MICROS~1\\Windows\\PRINTE~1\\QcConsol.exe -LowIntegrityServer","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:e9f496034096-viewerId:lo_ba22a26464ef":{"__typename":"CollectionViewerEdge","id":"collectionId:e9f496034096-viewerId:lo_ba22a26464ef","isEditor":false,"isMuting":false},"UserViewerEdge:userId:3d670b41fa5f-viewerId:lo_ba22a26464ef":{"__typename":"UserViewerEdge","id":"userId:3d670b41fa5f-viewerId:lo_ba22a26464ef","isMuting":false},"PostViewerEdge:postId:6ca15fe1b241-viewerId:lo_ba22a26464ef":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:6ca15fe1b241-viewerId:lo_ba22a26464ef"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Tag:security":{"__typename":"Tag","id":"security","displayTitle":"Security","normalizedTagSlug":"security"},"Post:6ca15fe1b241":{"__typename":"Post","id":"6ca15fe1b241","collection":{"__ref":"Collection:e9f496034096"},"content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Ftradahacking\u002Flà-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"6186","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:7d741b1dd33f_0"},{"__ref":"Paragraph:7d741b1dd33f_1"},{"__ref":"Paragraph:7d741b1dd33f_2"},{"__ref":"Paragraph:7d741b1dd33f_3"},{"__ref":"Paragraph:7d741b1dd33f_4"},{"__ref":"Paragraph:7d741b1dd33f_5"},{"__ref":"Paragraph:7d741b1dd33f_6"},{"__ref":"Paragraph:7d741b1dd33f_7"},{"__ref":"Paragraph:7d741b1dd33f_8"},{"__ref":"Paragraph:7d741b1dd33f_9"},{"__ref":"Paragraph:7d741b1dd33f_10"},{"__ref":"Paragraph:7d741b1dd33f_11"},{"__ref":"Paragraph:7d741b1dd33f_12"},{"__ref":"Paragraph:7d741b1dd33f_13"},{"__ref":"Paragraph:7d741b1dd33f_14"},{"__ref":"Paragraph:7d741b1dd33f_15"},{"__ref":"Paragraph:7d741b1dd33f_16"},{"__ref":"Paragraph:7d741b1dd33f_17"},{"__ref":"Paragraph:7d741b1dd33f_18"},{"__ref":"Paragraph:7d741b1dd33f_19"},{"__ref":"Paragraph:7d741b1dd33f_20"},{"__ref":"Paragraph:7d741b1dd33f_21"},{"__ref":"Paragraph:7d741b1dd33f_22"},{"__ref":"Paragraph:7d741b1dd33f_23"},{"__ref":"Paragraph:7d741b1dd33f_24"},{"__ref":"Paragraph:7d741b1dd33f_25"},{"__ref":"Paragraph:7d741b1dd33f_26"},{"__ref":"Paragraph:7d741b1dd33f_27"},{"__ref":"Paragraph:7d741b1dd33f_28"},{"__ref":"Paragraph:7d741b1dd33f_29"},{"__ref":"Paragraph:7d741b1dd33f_30"},{"__ref":"Paragraph:7d741b1dd33f_31"},{"__ref":"Paragraph:7d741b1dd33f_32"},{"__ref":"Paragraph:7d741b1dd33f_33"},{"__ref":"Paragraph:7d741b1dd33f_34"},{"__ref":"Paragraph:7d741b1dd33f_35"},{"__ref":"Paragraph:7d741b1dd33f_36"},{"__ref":"Paragraph:7d741b1dd33f_37"},{"__ref":"Paragraph:7d741b1dd33f_38"},{"__ref":"Paragraph:7d741b1dd33f_39"},{"__ref":"Paragraph:7d741b1dd33f_40"},{"__ref":"Paragraph:7d741b1dd33f_41"},{"__ref":"Paragraph:7d741b1dd33f_42"},{"__ref":"Paragraph:7d741b1dd33f_43"},{"__ref":"Paragraph:7d741b1dd33f_44"},{"__ref":"Paragraph:7d741b1dd33f_45"},{"__ref":"Paragraph:7d741b1dd33f_46"},{"__ref":"Paragraph:7d741b1dd33f_47"},{"__ref":"Paragraph:7d741b1dd33f_48"},{"__ref":"Paragraph:7d741b1dd33f_49"},{"__ref":"Paragraph:7d741b1dd33f_50"},{"__ref":"Paragraph:7d741b1dd33f_51"},{"__ref":"Paragraph:7d741b1dd33f_52"},{"__ref":"Paragraph:7d741b1dd33f_53"},{"__ref":"Paragraph:7d741b1dd33f_54"},{"__ref":"Paragraph:7d741b1dd33f_55"},{"__ref":"Paragraph:7d741b1dd33f_56"},{"__ref":"Paragraph:7d741b1dd33f_57"},{"__ref":"Paragraph:7d741b1dd33f_58"},{"__ref":"Paragraph:7d741b1dd33f_59"},{"__ref":"Paragraph:7d741b1dd33f_60"},{"__ref":"Paragraph:7d741b1dd33f_61"},{"__ref":"Paragraph:7d741b1dd33f_62"},{"__ref":"Paragraph:7d741b1dd33f_63"},{"__ref":"Paragraph:7d741b1dd33f_64"},{"__ref":"Paragraph:7d741b1dd33f_65"},{"__ref":"Paragraph:7d741b1dd33f_66"},{"__ref":"Paragraph:7d741b1dd33f_67"},{"__ref":"Paragraph:7d741b1dd33f_68"},{"__ref":"Paragraph:7d741b1dd33f_69"},{"__ref":"Paragraph:7d741b1dd33f_70"},{"__ref":"Paragraph:7d741b1dd33f_71"},{"__ref":"Paragraph:7d741b1dd33f_72"},{"__ref":"Paragraph:7d741b1dd33f_73"},{"__ref":"Paragraph:7d741b1dd33f_74"},{"__ref":"Paragraph:7d741b1dd33f_75"},{"__ref":"Paragraph:7d741b1dd33f_76"},{"__ref":"Paragraph:7d741b1dd33f_77"},{"__ref":"Paragraph:7d741b1dd33f_78"},{"__ref":"Paragraph:7d741b1dd33f_79"},{"__ref":"Paragraph:7d741b1dd33f_80"},{"__ref":"Paragraph:7d741b1dd33f_81"},{"__ref":"Paragraph:7d741b1dd33f_82"},{"__ref":"Paragraph:7d741b1dd33f_83"},{"__ref":"Paragraph:7d741b1dd33f_84"},{"__ref":"Paragraph:7d741b1dd33f_85"},{"__ref":"Paragraph:7d741b1dd33f_86"},{"__ref":"Paragraph:7d741b1dd33f_87"},{"__ref":"Paragraph:7d741b1dd33f_88"},{"__ref":"Paragraph:7d741b1dd33f_89"},{"__ref":"Paragraph:7d741b1dd33f_90"},{"__ref":"Paragraph:7d741b1dd33f_91"},{"__ref":"Paragraph:7d741b1dd33f_92"},{"__ref":"Paragraph:7d741b1dd33f_93"},{"__ref":"Paragraph:7d741b1dd33f_94"},{"__ref":"Paragraph:7d741b1dd33f_95"},{"__ref":"Paragraph:7d741b1dd33f_96"},{"__ref":"Paragraph:7d741b1dd33f_97"},{"__ref":"Paragraph:7d741b1dd33f_98"},{"__ref":"Paragraph:7d741b1dd33f_99"},{"__ref":"Paragraph:7d741b1dd33f_100"},{"__ref":"Paragraph:7d741b1dd33f_101"},{"__ref":"Paragraph:7d741b1dd33f_102"},{"__ref":"Paragraph:7d741b1dd33f_103"},{"__ref":"Paragraph:7d741b1dd33f_104"},{"__ref":"Paragraph:7d741b1dd33f_105"},{"__ref":"Paragraph:7d741b1dd33f_106"},{"__ref":"Paragraph:7d741b1dd33f_107"},{"__ref":"Paragraph:7d741b1dd33f_108"},{"__ref":"Paragraph:7d741b1dd33f_109"},{"__ref":"Paragraph:7d741b1dd33f_110"},{"__ref":"Paragraph:7d741b1dd33f_111"},{"__ref":"Paragraph:7d741b1dd33f_112"},{"__ref":"Paragraph:7d741b1dd33f_113"},{"__ref":"Paragraph:7d741b1dd33f_114"},{"__ref":"Paragraph:7d741b1dd33f_115"},{"__ref":"Paragraph:7d741b1dd33f_116"},{"__ref":"Paragraph:7d741b1dd33f_117"},{"__ref":"Paragraph:7d741b1dd33f_118"},{"__ref":"Paragraph:7d741b1dd33f_119"},{"__ref":"Paragraph:7d741b1dd33f_120"},{"__ref":"Paragraph:7d741b1dd33f_121"},{"__ref":"Paragraph:7d741b1dd33f_122"},{"__ref":"Paragraph:7d741b1dd33f_123"},{"__ref":"Paragraph:7d741b1dd33f_124"},{"__ref":"Paragraph:7d741b1dd33f_125"},{"__ref":"Paragraph:7d741b1dd33f_126"},{"__ref":"Paragraph:7d741b1dd33f_127"},{"__ref":"Paragraph:7d741b1dd33f_128"},{"__ref":"Paragraph:7d741b1dd33f_129"},{"__ref":"Paragraph:7d741b1dd33f_130"},{"__ref":"Paragraph:7d741b1dd33f_131"},{"__ref":"Paragraph:7d741b1dd33f_132"},{"__ref":"Paragraph:7d741b1dd33f_133"},{"__ref":"Paragraph:7d741b1dd33f_134"},{"__ref":"Paragraph:7d741b1dd33f_135"},{"__ref":"Paragraph:7d741b1dd33f_136"},{"__ref":"Paragraph:7d741b1dd33f_137"},{"__ref":"Paragraph:7d741b1dd33f_138"},{"__ref":"Paragraph:7d741b1dd33f_139"},{"__ref":"Paragraph:7d741b1dd33f_140"},{"__ref":"Paragraph:7d741b1dd33f_141"},{"__ref":"Paragraph:7d741b1dd33f_142"},{"__ref":"Paragraph:7d741b1dd33f_143"},{"__ref":"Paragraph:7d741b1dd33f_144"},{"__ref":"Paragraph:7d741b1dd33f_145"},{"__ref":"Paragraph:7d741b1dd33f_146"},{"__ref":"Paragraph:7d741b1dd33f_147"},{"__ref":"Paragraph:7d741b1dd33f_148"},{"__ref":"Paragraph:7d741b1dd33f_149"},{"__ref":"Paragraph:7d741b1dd33f_150"},{"__ref":"Paragraph:7d741b1dd33f_151"},{"__ref":"Paragraph:7d741b1dd33f_152"},{"__ref":"Paragraph:7d741b1dd33f_153"},{"__ref":"Paragraph:7d741b1dd33f_154"},{"__ref":"Paragraph:7d741b1dd33f_155"},{"__ref":"Paragraph:7d741b1dd33f_156"},{"__ref":"Paragraph:7d741b1dd33f_157"},{"__ref":"Paragraph:7d741b1dd33f_158"},{"__ref":"Paragraph:7d741b1dd33f_159"},{"__ref":"Paragraph:7d741b1dd33f_160"},{"__ref":"Paragraph:7d741b1dd33f_161"},{"__ref":"Paragraph:7d741b1dd33f_162"},{"__ref":"Paragraph:7d741b1dd33f_163"},{"__ref":"Paragraph:7d741b1dd33f_164"},{"__ref":"Paragraph:7d741b1dd33f_165"},{"__ref":"Paragraph:7d741b1dd33f_166"},{"__ref":"Paragraph:7d741b1dd33f_167"},{"__ref":"Paragraph:7d741b1dd33f_168"},{"__ref":"Paragraph:7d741b1dd33f_169"},{"__ref":"Paragraph:7d741b1dd33f_170"},{"__ref":"Paragraph:7d741b1dd33f_171"},{"__ref":"Paragraph:7d741b1dd33f_172"},{"__ref":"Paragraph:7d741b1dd33f_173"},{"__ref":"Paragraph:7d741b1dd33f_174"},{"__ref":"Paragraph:7d741b1dd33f_175"},{"__ref":"Paragraph:7d741b1dd33f_176"},{"__ref":"Paragraph:7d741b1dd33f_177"},{"__ref":"Paragraph:7d741b1dd33f_178"},{"__ref":"Paragraph:7d741b1dd33f_179"},{"__ref":"Paragraph:7d741b1dd33f_180"},{"__ref":"Paragraph:7d741b1dd33f_181"},{"__ref":"Paragraph:7d741b1dd33f_182"},{"__ref":"Paragraph:7d741b1dd33f_183"},{"__ref":"Paragraph:7d741b1dd33f_184"},{"__ref":"Paragraph:7d741b1dd33f_185"},{"__ref":"Paragraph:7d741b1dd33f_186"},{"__ref":"Paragraph:7d741b1dd33f_187"},{"__ref":"Paragraph:7d741b1dd33f_188"},{"__ref":"Paragraph:7d741b1dd33f_189"},{"__ref":"Paragraph:7d741b1dd33f_190"},{"__ref":"Paragraph:7d741b1dd33f_191"},{"__ref":"Paragraph:7d741b1dd33f_192"},{"__ref":"Paragraph:7d741b1dd33f_193"},{"__ref":"Paragraph:7d741b1dd33f_194"},{"__ref":"Paragraph:7d741b1dd33f_195"},{"__ref":"Paragraph:7d741b1dd33f_196"},{"__ref":"Paragraph:7d741b1dd33f_197"},{"__ref":"Paragraph:7d741b1dd33f_198"},{"__ref":"Paragraph:7d741b1dd33f_199"},{"__ref":"Paragraph:7d741b1dd33f_200"},{"__ref":"Paragraph:7d741b1dd33f_201"},{"__ref":"Paragraph:7d741b1dd33f_202"},{"__ref":"Paragraph:7d741b1dd33f_203"},{"__ref":"Paragraph:7d741b1dd33f_204"},{"__ref":"Paragraph:7d741b1dd33f_205"},{"__ref":"Paragraph:7d741b1dd33f_206"},{"__ref":"Paragraph:7d741b1dd33f_207"},{"__ref":"Paragraph:7d741b1dd33f_208"},{"__ref":"Paragraph:7d741b1dd33f_209"},{"__ref":"Paragraph:7d741b1dd33f_210"},{"__ref":"Paragraph:7d741b1dd33f_211"},{"__ref":"Paragraph:7d741b1dd33f_212"},{"__ref":"Paragraph:7d741b1dd33f_213"},{"__ref":"Paragraph:7d741b1dd33f_214"},{"__ref":"Paragraph:7d741b1dd33f_215"},{"__ref":"Paragraph:7d741b1dd33f_216"},{"__ref":"Paragraph:7d741b1dd33f_217"},{"__ref":"Paragraph:7d741b1dd33f_218"},{"__ref":"Paragraph:7d741b1dd33f_219"},{"__ref":"Paragraph:7d741b1dd33f_220"},{"__ref":"Paragraph:7d741b1dd33f_221"},{"__ref":"Paragraph:7d741b1dd33f_222"},{"__ref":"Paragraph:7d741b1dd33f_223"},{"__ref":"Paragraph:7d741b1dd33f_224"},{"__ref":"Paragraph:7d741b1dd33f_225"},{"__ref":"Paragraph:7d741b1dd33f_226"},{"__ref":"Paragraph:7d741b1dd33f_227"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:3d670b41fa5f"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Ftradahacking\u002Fl%C3%A0-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241","primaryTopic":null,"topics":[],"isLimitedState":false,"isPublished":true,"allowResponses":true,"responsesLocked":false,"visibility":"PUBLIC","latestPublishedVersion":"7d741b1dd33f","postResponses":{"__typename":"PostResponses","count":5},"responseDistribution":"NOT_DISTRIBUTED","clapCount":159,"title":"Là 1937CN hay OceanLotus hay Lazarus …","isSeries":false,"sequence":null,"uniqueSlug":"là-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241","socialTitle":"","socialDek":"","canonicalUrl":"https:\u002F\u002Fmedium.com\u002Ftradahacking\u002Flà-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241","metaDescription":"","latestPublishedAt":1541261844832,"readingTime":14.978301886792451,"previewContent":{"__typename":"PreviewContent","subtitle":"Vô tình bắt gặp trên twitter của @blu3_team (Tôi không rõ sao acc này lại rất hay có được những mẫu target vào VN), tôi tò mò muốn biết kĩ…"},"previewImage":{"__ref":"ImageMetadata:1*utkVDcocvYLgno9vgjM-_w.png"},"isShortform":false,"seoMetaTags":{"__typename":"SEOMetaTags","jsonLd":"{\"@context\":\"https:\u002F\u002Fschema.org\",\"@id\":\"https:\u002F\u002Fmedium.com\u002Ftradahacking\u002Flà-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241\",\"@type\":\"SocialMediaPosting\",\"image\":[\"https:\u002F\u002Fmiro.medium.com\u002F1*utkVDcocvYLgno9vgjM-_w.png\"],\"url\":\"https:\u002F\u002Fmedium.com\u002Ftradahacking\u002Flà-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241\",\"dateCreated\":\"2018-11-03T15:59:47Z\",\"datePublished\":\"2018-11-03T15:59:47Z\",\"dateModified\":\"2018-11-03T16:17:24Z\",\"headline\":\"Là 1937CN hay OceanLotus hay Lazarus …\",\"name\":\"Là 1937CN hay OceanLotus hay Lazarus …\",\"description\":\"Là 1937CN hay OceanLotus hay Lazarus … Vô tình bắt gặp trên twitter của @blu3_team (Tôi không rõ sao acc này lại rất hay có được những mẫu target vào VN), tôi tò mò …\",\"identifier\":\"6ca15fe1b241\",\"author\":{\"@context\":\"https:\u002F\u002Fschema.org\",\"@id\":\"https:\u002F\u002Fmedium.com\u002F@kienbigmummy\",\"@type\":\"Person\",\"identifier\":\"kienbigmummy\",\"name\":\"m4n0w4r\",\"url\":\"https:\u002F\u002Fmedium.com\u002F@kienbigmummy\"},\"creator\":{\"@context\":\"https:\u002F\u002Fschema.org\",\"@id\":\"https:\u002F\u002Fmedium.com\u002F@kienbigmummy\",\"@type\":\"Person\",\"identifier\":\"kienbigmummy\",\"name\":\"m4n0w4r\",\"url\":\"https:\u002F\u002Fmedium.com\u002F@kienbigmummy\"},\"publisher\":{\"@context\":\"https:\u002F\u002Fschema.org\",\"@type\":\"Organization\",\"@id\":\"https:\u002F\u002Fmedium.com\u002Ftradahacking\",\"name\":\"tradahacking\",\"description\":\"Chia sẻ kiến thức An Toàn Thông Tin\",\"url\":\"https:\u002F\u002Fmedium.com\u002Ftradahacking\",\"sameAs\":[\"https:\u002F\u002Ftwitter.com\u002Ftradahackingvn\",\"https:\u002F\u002Ffacebook.com\u002Ftradahackingvn\"],\"logo\":{\"@type\":\"ImageObject\",\"width\":274,\"height\":206,\"url\":\"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:274\u002F1%2AaPmV4ykveVMK7Gn2z0_xKg.png\"}},\"mainEntityOfPage\":\"https:\u002F\u002Fmedium.com\u002Ftradahacking\u002Flà-1937cn-hay-oceanlotus-hay-lazarus-6ca15fe1b241\",\"isAccessibleForFree\":true}"},"seoDescription":"Là 1937CN hay OceanLotus hay Lazarus … Vô tình bắt gặp trên twitter của @blu3_team (Tôi không rõ sao acc này lại rất hay có được những mẫu target vào VN), tôi tò mò …","shortformType":"SHORTFORM_TYPE_LINK","firstPublishedAt":1541260787086,"viewerEdge":{"__ref":"PostViewerEdge:postId:6ca15fe1b241-viewerId:lo_ba22a26464ef"},"seoTitle":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:malware-analysis"},{"__ref":"Tag:security"}],"isFeaturedInPublishedPublication":false,"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"vi","wordCount":2366,"isPublishToEmail":false,"publishSchedule":null}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.d67f306f.js"></script><script src="https://cdn-client.medium.com/lite/static/js/723.128cd04d.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.29da60c4.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.47ae8b31.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.851fdaca.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5052.eb638269.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/683.abfef39e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6062.c3638afc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3326.53a6c411.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7566.14491814.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7908.d91f6e64.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3927.2f9f3eed.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8640.9dfdf08f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9967.f31ca2af.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9214.a792bbcc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3862.a0fe9068.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1214.dda1f719.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/556.d95c90dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5094.e8fa1282.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7381.c53435ab.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7185.66c8dc54.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3507.df6bb5b3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9347.6fa32b31.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4929.59baa8b5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.6c66e3cc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6954.3c7c8133.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7979.35c5b2af.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3877.769556c7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.3f8d607c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9256.ad0fef76.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8768.62c3639c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/144.0ea6f0e3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3666.6579eeda.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1069.bbe95674.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.e62bbb3f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2698.9eecb474.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.f4c0b2b4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.5b775609.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.e940a3b4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.d61aa7c4.chunk.js"></script>
<script id="__LOADABLE_REQUIRED_CHUNKS__" type="application/json">[]</script>
<script id="__LOADABLE_REQUIRED_CHUNKS___ext" type="application/json">{"namedChunks":[]}</script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'989157c3be736077',t:'MTc1OTU0NTkyNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"989157c3be736077","version":"2025.9.1","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>