<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TDBVSRVN');</script>
<!-- End Google Tag Manager -->
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Mobile Specific Metas  ================================================== -->
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<!-- CORE CONCRETE  ================================================== -->
<script type="text/javascript">var BOOTSTRAP_VERSION ="lumen";
	var BOOTSTRAP_JS_HEAD =1;
	var BOOTSTRAP_CDN_ENABLE =0; var BOOTSTRAP_NAVBAR_TYPE =0; var BOOTSTRAP_LOGO_OPTION =0; var BOOTSTRAP_NAVBAR =1; var BootstrapInputFix =true;var BootstrapNavbarLineHeightFix =true;var BOOTSTRAP_EDT= 0; </script>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Virus Bulletin :: Behind the scenes of GandCrab’s operation</title>
<meta name="description" content="The GandCrab ransomware was active from January 2018 to May 2019. During its active state, numerous variants were distributed worldwide, causing much damage. This report examines the battle that went on between security vendor AhnLab and the GandCrab ransomware." />
<meta name="generator" content="concrete5 - 5.6.3.5" />
<script type="text/javascript">
var CCM_DISPATCHER_FILENAME = '/index.php';var CCM_CID = 6751;var CCM_EDIT_MODE = false;var CCM_ARRANGE_MODE = false;var CCM_IMAGE_PATH = "/concrete/images";
var CCM_TOOLS_PATH = "/index.php/tools/required";
var CCM_BASE_URL = "https://www.virusbulletin.com";
var CCM_REL = "";

</script>

	<link rel="shortcut icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
	<link rel="icon" href="/files/8914/5459/9485/VBIcon.png" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/concrete/css/ccm.base.css" />
<script type="text/javascript" src="/concrete/js/jquery.js"></script>
<script type="text/javascript" src="/concrete/js/ccm.base.js"></script>

<script type="text/javascript">
var COOKIES_ALLOWED=false;
</script>
<link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure.css" />
<!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/packages/free_cookies_disclosure/css/cookies_disclosure_ie.css" /><![endif]-->

<script type="text/javascript">
var COOKIES_DISCLOSURE_HIDE_INTERVAL=10;
</script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_hide.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/lumen/bootstrap-overwrites.css" />
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/css/members.css" />
<script type="text/javascript" src="/packages/bootstrap/js/common/prettify.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="/libraries/css/jquery.fancybox.css" />
<script type="text/javascript" src="/libraries/js/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" media="screen" type="text/css" href="/files/cache/css/bootstrap/typography.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.js" integrity="sha512-ZwR1/gSZM3ai6vCdI+LVF1zSq/5HznD3ZSTk7kajkaj4D292NLuduDCO1c/NT8Id+jE58KYLKT7hXnbtryGmMg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script type="text/javascript" src="/index.php/tools/packages/free_cookies_disclosure/disclosure_i18n_js"></script>
<script type="text/javascript" src="/packages/free_cookies_disclosure/js/disclosure_ajax_form.js"></script>
<link rel="stylesheet" type="text/css" href="/concrete/blocks/page_list/view.css" />
<link rel="stylesheet" type="text/css" href="/blocks/expand_collapse_toc/templates/vbexpand/view.css" />
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.color.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/jquery.ba-hashchange.js"></script>
<script type="text/javascript" src="/blocks/expand_collapse_toc/js/expand.js"></script>
<link rel="stylesheet" type="text/css" href="/packages/bootstrap/blocks/search/templates/VB_global_search/view.css" />
<link rel="stylesheet" type="text/css" href="/packages/travisn_spacer/css/ccm.tnspacer.css" />
<!-- added by lian to get some nice icons: -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- added by lian to get syntax highlighting -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.js" integrity="sha256-1SFdTXlsw0RkQ+iO0E91LDshGiIbPiTYqJto0px4wds=" crossorigin="anonymous"></script>

<!--[if gte IE 9]>
<script src="/packages/bootstrap/js/common/modernizr.js"></script>
<![endif]-->
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>	
	
	<script src="/packages/bootstrap/js/common/html5shiv.js"></script>
	<script src="/packages/bootstrap/js/common/respond.min.js"></script>
	
<![endif]-->
</head>
<body data-spy="scroll" data-target=".bs-sidebar">

<!-- Navbar
    ================================================== -->
	<div class="navbar  navbar-fixed-top navbar-default  bs-docs-nav">
				<div class="navbar-inner">
					<div class="container"><div class="row"><div class="col-sm-4 col-md-4 logo-position-1 col-logo">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle btn_navbar_custom" >
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						  </button><div class="mobile-clearfix"></div><div class="navbar-brand navbar-brand-area"><a href="/"><img border="0" class="ccm-image-block" alt="" src="/files/4614/4535/7515/logo-big.png" width="339" height="92" /></a></div>		</div>
				</div><div class="col-sm-8 col-md-8 logo-position-1 col-nav">		<div class="nav-collapse collapse nav_collapse_custom navbar-collapse" > <div style="clear:both"></div>
<div class="vb-global-search-div"> 
<form action="/index.php/global-search-results/" method="get">
<fieldset>
	<input name="search_paths[]" type="hidden" value="" />
		<input name="query" type="text"  class="vb-global-search"  placeholder="Search site..."/>
	<input name="submit" type="submit" value="Search!" style="display:none"/>
</fieldset>
</form>
</div>


<div class="tnSpacer" style="height:48px"></div>
<ul class="nav nav-pills"><li class=" nav-first nav-item-6299"><a href="/newsletter/" target="_self"  class=" nav-first nav-item-6299 "  >Newsletter</a></li><li class=" nav-item-260"><a href="/conference/" target="_self"  class=" nav-item-260 "  >VB Conference</a></li><li class=" nav-item-166"><a href="/testing/" target="_self"  class=" nav-item-166 "  >VB Testing</a></li><li class=" nav-path-selected active nav-item-160"><a href="/virusbulletin/" target="_self"  class=" nav-path-selected active nav-item-160 "  >Bulletin</a></li><li class=" nav-last nav-item-130"><a href="/blog/" target="_self"  class=" nav-last nav-item-130 "  >Blog</a></li></ul> 	</div>
				</div>
			</div><div class="clearfix"></div>
        </div>
      </div>
	 
    </div>
	<div class="navbar-top-fixed-space "><div class="clearfix"></div></div>
		
<!-- Navbar
    ================================================== -->		
<div class="container m-top-20">
	<div class="row">    
		<div class="col-md-9 col-sm-9 col-lg-9">
		<h1><a class="chapter" name="h1-behind-scenes-gandcrabs-operation"></a>Behind the scenes of GandCrab’s operation</h1>
<h3><a class="chapter" name="h3-ahnlab-security-analysis-team"></a>AhnLab Security Analysis Team</h3>
<p><em>AhnLab, South Korea</em></p>
<hr />
<p> </p>
<div class="ccm-expand-collapse-toc">
    <div id="ccm-expand-collapse-toc-title-15429" class="ccm-expand-collapse-toc-title ccm-expand-collapse-toc-closed" data-expander-speed="500">Table of contents</div><div id="ccm-expand-collapse-toc-content-15429" class="ccm-expand-collapse-toc-content"><p><a class="toc-level2" href="#h2-abstract">Abstract</a><br /> <a class="toc-level2" href="#h2-introduction">Introduction</a><br /> <a class="toc-level2" href="#h2-analysis-timeline">Analysis by timeline</a><br /> <a class="toc-level3" href="#h3-scene-01-prelude-war-gandcrab-v2x">Scene #01: The prelude to war (GandCrab v2.x)</a><br /> <a class="toc-level3" href="#h3-scene-02-adversary-revealed-gandcrab-v41x">Scene #02: The adversary revealed (GandCrab v4.1.x)</a><br /> <a class="toc-level3" href="#h3-scene-03-gandcrab-strikes-back">Scene #03: GandCrab strikes back</a><br /> <a class="toc-level3" href="#h3-scene-04-gandcrabs-full-attack">Scene #04: GandCrab’s full-on attack</a><br /> <a class="toc-level3" href="#h3-scene-05-endgame-last-battle">Scene #05: Endgame, the last battle</a><br /> <a class="toc-level2" href="#h2-conclusion">Conclusion</a><br /> <a class="toc-level2" href="#h2-references">References</a></p><p>&nbsp;</p></div></div>
<h2><a class="chapter" name="h2-abstract"></a>Abstract</h2>
<p>The GandCrab ransomware was active from January 2018 to May 2019. During its active state, numerous variants were distributed worldwide, causing much damage.</p>
<p>This report examines the battle that went on between security vendor <em>AhnLab</em> and the GandCrab ransomware and includes details about GandCrab that have been unpublished until now.</p>
<p> </p>
<h2><a class="chapter" name="h2-introduction"></a>Introduction</h2>
<p>The GandCrab ransomware, which is no longer active, was actively distributed for a little over a year. GandCrab variants caused a great deal of damage worldwide, including in South Korea.</p>
<p>The GandCrab ransomware shares an interesting history with <em>AhnLab</em>. Like many other examples of ransomware, GandCrab searches for any running or pre-installed anti‑malware program and when it finds one it interferes with its normal execution and shuts it down. However, when it came to <em>AhnLab</em>, GandCrab went the extra mile, specifically targeting the company and its anti-malware program <em>V3 Lite</em> by mentioning it in its code. It even revealed a vulnerability in the security program and made attempts to delete it entirely.</p>
<p>To effectively respond to and protect against GandCrab attacks, the AhnLab Security Analysis Team analysed GandCrab and all its different versions by thoroughly investigating the distributed code, encryption method, restoration method, and the evasive method it used to avoid behaviour-based detection. Each time a new attack feature targeting <em>AhnLab</em> and <em>V3</em> was identified, the company’s product developers promptly addressed it to ensure maximum security.</p>
<p>The interesting conflict between <em>AhnLab</em> and the GandCrab ransomware was widely discussed in the IT security industry. However, the details that were revealed at the time were only the tip of the iceberg, with more details being kept private for reasons of confidentiality.</p>
<p> </p>
<h2><a class="chapter" name="h2-analysis-timeline"></a>Analysis by timeline</h2>
<h3><a class="chapter" name="h3-scene-01-prelude-war-gandcrab-v2x"></a>Scene #01: The prelude to war (GandCrab v2.x)</h3>
<p>On 8 February 2018 <em>AhnLab</em> reported in a blog post [<a href="#ref1">1</a>] the active distribution of GandCrab ransomware in South Korea. Shortly afterwards, on 17 April, we released a kill switch to the public [<a href="#ref2">2</a>] after having analysed how the ransomware worked. The kill switch prevented the encryption of files, thus interfering with GandCrab’s operation.</p>
<p>This triggered a battle between GandCrab and <em>AhnLab</em>. Three days later, a profanity directed at <em>AhnLab</em> was found within the malware’s mutex name. The GandCrab creator did not stop here but continued to express anger towards the company by changing the host address from ‘google.com’ to ‘ahnlab.com’. The host address was used for C&amp;C server communication and was randomly adjusted to avoid network filters.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/2715/7951/3692/Figure1-GandCrab.png" alt="Figure1-GandCrab.png" width="673" height="230" /></p>
<p class="centered-caption">Figure 1: Mutex including profanity directed at AhnLab.</p>
<p>The encryption-blocking method that the kill switch had been based on was patched, and changes were made to the internal version of GandCrab v3.0.0. However, we were able to identify a new method of blocking encryption by utilizing the ransomware’s pop-up message, and we duly published this finding [<a href="#ref3">3</a>].</p>
<p> </p>
<h3><a class="chapter" name="h3-scene-02-adversary-revealed-gandcrab-v41x"></a>Scene #02: The adversary revealed (GandCrab v4.1.x)</h3>
<p>By July 2018, GandCrab was being distributed by various means including drive-by downloads, email, executable files and fileless malware. There was even a case where a malicious script named ‘ahnlab.txt’ was distributed during a fileless attack using PowerShell.</p>
<p>While <em>AhnLab</em> was engaged in battle with GandCrab in Southeast Asia, <em>Fortinet</em> was actively analysing and responding to GandCrab in real time halfway across the globe. On 9 July, <em>Fortinet</em> released a method [<a href="#ref4">4</a>] that stopped the malware from infecting the system if there existed a file named ‘&lt;8hex-chars&gt;.lock’ (e.g. ‘2078FBF8.lock’) in the user’s Common AppData directory.</p>
<p>Based on the information shared by <em>Fortinet</em>, we were able to confirm that the new method was valid for the latest version of the malware, v4.1.1, as well. On 13 July we released an executable file tool to the public [<a href="#ref5">5</a>].</p>
<p>The GandCrab creator retaliated immediately. A sarcastic text directed at both <em>Fortinet</em> and <em>AhnLab</em> was included within the kill switch of v4.1.2, saying that the ‘.lock’ file wasn’t the only blocking method, following which the file generation logic for the ‘.lock’ file was changed. However, we figured out the logic of v4.1.2 as well as v4.1.3 and updated the tool accordingly.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/1615/7951/3771/Figure2-GandCrab.png" alt="Figure2-GandCrab.png" width="602" height="482" /></p>
<p class="centered-caption">Figure 2: Mention of AhnLab and Fortinet in the kill switch.</p>
<p>While the kill switch in v4.1.2 mentioned both <em>AhnLab</em> and <em>Fortinet</em>, a slightly modified internal version of v4.1.2 only included an ‘ahnlab’ string (see Figure 3). It also included a specific URL which led to a page containing a profanity directed at <em>AhnLab</em> in Russian (see Figure 4).</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/5615/7951/3820/Figure3-GandCrab.png" alt="Figure3-GandCrab.png" width="792" height="391" /><span class="centered-caption">Figure 3: AhnLab string and URL included in a modified version of v4.1.2. </span></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/4015/7951/3851/Figure4-GandCrab.png" alt="Figure4-GandCrab.png" width="561" height="494" /><span class="centered-caption">Figure 4: Profanity directed at AhnLab in Russian.</span></p>
<p> </p>
<h3><a class="chapter" name="h3-scene-03-gandcrab-strikes-back"></a>Scene #03: GandCrab strikes back</h3>
<p>In August 2018, the creator of GandCrab officially began to strike back. The creator contacted tech site <em>Bleeping Computer</em> [<a href="#ref6">6</a>] and declared that the upcoming version of the GandCrab ransomware would contain a zero-day for <em>AhnLab V3 Lite</em>, also sharing a link to the exploit code. The creator claimed that this was in retaliation for the kill switch having been released by <em>AhnLab</em> and went on to explain that the kill switch would no longer be effective in future versions of GandCrab.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/d62d0d08a1eda528cfef6a116560b2b8_f4523.png" alt="Figure5-GandCrab.png" width="830" height="382" /><span class="centered-caption">Figure 5: GandCrab creator announces alleged exploit attack of V3 Lite via Bleeping Computer [6].</span><br /><br />Then, the internal version of v4.2.1 revealed the attack pattern code for <em>V3 Lite</em> products, stating that it was a 1:1 score between <em>AhnLab</em> and GandCrab.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/140c8fe988c0db58b8ccce01ecc8dde2_f4524.png" alt="Figure6-GandCrab.png" width="840" height="219" /><span class="centered-caption">Figure 6: GandGrab’s message to AhnLab hidden in GandCrab v4.2.1.</span></p>
<p>The alleged attack code that was revealed could trigger a BSOD if <em>V3 Lite</em> was installed in the system, and was executed after encryption. <em>AhnLab</em> released an emergency patch immediately following the exploit.</p>
<p> </p>
<h3><a class="chapter" name="h3-scene-04-gandcrabs-full-attack"></a>Scene #04: GandCrab’s full-on attack</h3>
<p>From then, the creator of GandCrab made continuous efforts to uninstall the<em> V3</em> program through its scripts, with the attempts becoming more sophisticated as time went on.</p>
<p>The first method used by GandCrab to uninstall <em>V3</em> was by encouraging the user to click. As shown in Figure 7, a piece of code was included within the distributed script specifically to drop and run a JS file which deletes the <em>V3</em> service upon detection.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/a75430a2f7278602d49037ac25acfce4_f4525.png" alt="Figure7-GandCrab.png" width="800" height="394" /><span class="centered-caption">Figure 7: GandCrab’s distributed script without obfuscation.</span></p>
<p>The dropped JS file finds the path to the<em> V3</em> deletion program and runs the corresponding uninstaller according to the user’s <em>Windows</em> version, as shown in Figure 8. Afterwards, it checks for up to 60 seconds whether <em>V3</em> has been removed.</p>
<p><a class="zoom-img" title="Figure 8: JavaScript that induces deletion of V3." href="/files/2115/7951/4097/Figure8-GandCrab.png"><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/2682a7c122e702a66cce49f40160b824_f4526.png" alt="Figure8-GandCrab.png" width="840" height="425" /></a><span class="centered-caption">Figure 8: JavaScript that induces deletion of V3.</span></p>
<p>If, within that 60-second period, the user clicks the ‘remove’ button (which is shown by the uninstaller), <em>V3</em> is deleted and the system runs the GandCrab ransomware. This method requires user interaction, meaning that the deletion of the program cannot be done in the background without the user’s knowledge.</p>
<p>This limitation led the creator of GandCrab to update its code in September 2018, to enable the deletion of the <em>V3</em> program without the user’s knowledge, as shown in Figure 9. The upgraded method allowed the <em>V3</em> uninstallation screen to be hidden from the user’s view while also automating the button-click process to run the GandCrab ransomware.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/01ae684107f113e3869eadc6375205e9_f4527.png" alt="Figure9-GandCrab.png" width="800" height="349" /><span class="centered-caption">Figure 9: Main function of the decoded PowerShell.</span></p>
<p>In GandCrab v5.0 a new executable, cmd.exe, was added in addition to the original process, Uninst.exe under Powershell.exe. However, it did not stop here. The structure of the process tree was altered continuously in order to evade <em>V3</em>’s behaviour-based detection. After 26 September, WMIC.exe was used instead of cmd.exe to uninstall the <em>V3</em> program.</p>
<p>As <em>AhnLab</em> made continuous updates to its anti-malware program so GandCrab also introduced updates. GandCrab v5.0.2 was distributed, which incorporated uninstallation using the existing Uninst.exe -Uninstall in addition to the AhnUn000.tmp -UC method. As shown in Figure 10, this version copied the Uninst.exe file to %temp%\AhnUn000.tmp, used WMIC.exe to run the file as the -UC switch, and changed the<em> V3</em> product deletion processor to runas.exe.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/4d11b7ab72be7f760a8e631edc25665c_f4528.png" alt="Figure10-GandCrab.png" width="800" height="648" /><span class="centered-caption">Figure 10: Process structure of uninstalling.</span></p>
<p>GandCrab v5.0.3 only used AhnUn000.tmp -UC to execute the deletion of the program instead of using Uninst.exe, and in v5.0.4, the main agent for the program deletion had changed to cscript.exe.</p>
<p><em>AhnLab</em> continued to update its product in response to GandCrab’s weekly script update. On 6 November, for instance, a CAPTCHA was added to the<em> V3 Lite</em> uninstall program to prevent automated deletion by malware. As a result, GandCrab was unable to delete <em>V3</em>, and removed the uninstall function from its distributed script.</p>
<p> </p>
<h3><a class="chapter" name="h3-scene-05-endgame-last-battle"></a>Scene #05: Endgame, the last battle</h3>
<p>While the versions of GandCrab distributed before December 2018 attempted to delete <em>V3</em> in various ways, GandCrab v5.0.4, discovered in January 2019, focused on terminating <em>V3</em>’s operation instead of uninstalling it.</p>
<p>The process to disable the V3 service is shown in Figure 11.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/0524583ed781f8efa46ce290811ffca0_f4529.png" alt="Figure11-GandCrab.png" width="840" height="347" /><span class="centered-caption">Figure 11: Process to disable V3 service.</span></p>
<p>Before moving onto the next step, GandCrab checks whether the <em>V3</em> service is running and uses the sleep function to wait 15 minutes if it is running. In the first step, an execution file (help22.exe) is dropped to stop the service. The dropped file locates <em>V3 Lite</em> and then duplicates Uninst.exe, the <em>V3</em> uninstall program, to %UserProfile%help.exe. The duplicated file then executes ASDCli.exe and uses the stop command to stop<em> V3 Lite</em>.</p>
<p><em>AhnLab</em> responded immediately with critical security patches, deleting ASDCli.exe and preventing the stop command from being executed. In addition, the product was upgraded, requiring an additional string (other than /Uninstall) to remove the product. The long tussle between GandCrab and <em>AhnLab</em> seemed to have settled down.</p>
<p>However, the battle was not yet over. GandCrab’s creator continued to taunt <em>AhnLab</em> by adding an insulting text in GandCrab v5.2. Distributed in February 2019, GandCrab v5.2 incorporated a time-delay technique to disturb dynamic analysis. This version included the text string ‘AnaLab_sucks’ within the <em>Windows</em> procedure class name that enables the SetTimer function. ‘AnaLab’ can be assumed to be a typo. Furthermore, the creator of GandCrab consistently mentioned ‘V3 Lite’ and ‘AhnLab’ directly within the distributed strings.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/c9f1898ffa343b76f2a430eb17209b7c_f4530.png" alt="Figure12-GandCrab.png" width="840" height="273" /><span class="centered-caption">Figure 12: AhnLab text string that was used as a class name.</span></p>
<p>A modified version of GandCrab v5.2, distributed in March 2019, no longer contained the above-mentioned text. Instead, a text insulting <em>Bitdefender</em> was used as the mutex. However, it was too soon to assume that the battle between <em>AhnLab</em> and GandCrab had ended.</p>
<p>In April 2019 GandCrab v5.2 added an evasive function to bypass detection by<em> V3 Lite</em>. Unlike the previous attempts to disable <em>V3 Lite</em>, the new feature injected the malware into <em>AhnLab</em>’s anti-malware update program in order to perform malicious activities.</p>
<p>The evasive process used by GandCrab to bypass <em>V3 Lite</em> is shown in Figure 13.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/09761bc8fcb8b68d43a7b24fb01541c9_f4531.png" alt="Figure13-GandCrab.png" width="840" height="439" /><span class="centered-caption">Figure 13: Evasive process used by GandCrab to bypass V3 Lite.</span></p>
<p>Like the <em>V3</em> disabling process, the malware first checks if ‘V3 Service’ is running. If the service is running, it uses the sleep function to wait for 20 minutes before moving onto the next step. After 20 minutes, it scans for the <em>AhnLab</em> anti-malware update program, Autoup.exe, then injects the ransomware execution data into the program. The injected code is executed, starting the encryption process. <em>AhnLab</em> quickly released a security patch to address this process.</p>
<p>As if to prove the famous quote ‘nothing lasts forever, everything has an end’, what seemed like a never-ending battle between GandCrab and <em>AhnLab</em> came to an abrupt end when GandCrab’s creator announced the end of its operation on 31 May 2019.</p>
<p>GandCrab’s creator has claimed to have earned more than enough through the ransomware operation, as seen in the statement shown in Figure 14. No new variants have been found since May 2019, and v5.3 remains GandCrab’s last released version.</p>
<p><a class="zoom-img" title="Figure 14: Announcement of GandCrab shutdown." href="/files/9915/7951/6070/Figure14-GandCrab.png"><img class="framed" style="display: block; margin-left: auto; margin-right: auto;" src="/files/cache/6ab09872a004f7fd6ab47c9ec4fe10ae_f4532.png" alt="Figure14-GandCrab.png" width="830" height="278" /></a><span class="centered-caption">Figure 14: Announcement of GandCrab shutdown.</span></p>
<p> </p>
<h2><a class="chapter" name="h2-conclusion"></a>Conclusion</h2>
<p>The battle between the GandCrab threat group and <em>AhnLab</em> lasted for 478 days and highlights the importance of collaboration between security vendors and organizations in the fight against advanced threats such as this. It is also vital for security vendors to continuously monitor threats and be resilient. It may seem as though the adversaries always have a head start, but advanced attacks cannot prevail if vulnerabilities are promptly addressed and appropriate updates are made.</p>
<p><em>AhnLab</em> will continue to monitor security threats in real time via its threat analysis and anti-malware program. In continuous efforts to build a strong alliance with other vendors and organizations, it will provide threat intelligence through various channels. GandCrab’s operation may have ended, but the cyber battle will never end.</p>
<p> </p>
<h2><a class="chapter" name="h2-references"></a>References</h2>
<p><a class=" anchor" name="ref1"></a>[1] GandCrab Ransomware Disseminated in Korea (in Korean). AhnLab blog. <a href="https://asec.ahnlab.com/1091" target="_blank">https://asec.ahnlab.com/1091</a>.</p>
<p><a class=" anchor" name="ref2"></a>[2] GandCrab v2.1 spread in Fileless mode (in Korean). AhnLab blog. <a href="https://asec.ahnlab.com/1130" target="_blank">https://asec.ahnlab.com/1130</a>.</p>
<p><a class=" anchor" name="ref3"></a>[3] GandCrab V2.1 Ransomware (internal version “version = 3.0.0”) (in Korean). AhnLab blog. <a href="https://asec.ahnlab.com/1133" target="_blank">https://asec.ahnlab.com/1133</a>.</p>
<p><a class=" anchor" name="ref4"></a>[4] Salvio, J. GandCrab V4.0 Analysis: New Shell, Same Old Menace. Fortinet blog. <a href="https://www.fortinet.com/blog/threat-research/gandcrab-v4-0-analysis--new-shell--same-old-menace.html" target="_blank">https://www.fortinet.com/blog/threat-research/gandcrab-v4-0-analysis--new-shell--same-old-menace.html</a>.</p>
<p><a class=" anchor" name="ref5"></a>[5] GandCrab v4.x encryption blocking method (Kill-Switch) (in Korean). AhnLab blog. <a href="https://asec.ahnlab.com/1144" target="_blank">https://asec.ahnlab.com/1144</a>.</p>
<p><a class=" anchor" name="ref6"></a>[6] Cimpanu, C. GandCrab Ransomware Author Bitter After Security Vendor Releases Vaccine App. Bleeping Computer. <a href="https://www.bleepingcomputer.com/news/security/gandcrab-ransomware-author-bitter-after-security-vendor-releases-vaccine-app/" target="_blank">https://www.bleepingcomputer.com/news/security/gandcrab-ransomware-author-bitter-after-security-vendor-releases-vaccine-app/</a>.</p>		</div>
		<div class="col-md-3 col-sm-3 col-lg-3">
		<p><a href="/uploads/pdf/magazine/2020/202001-GandCrab-operation.pdf" target="_blank"><img src="/uploads/images/buttons/pdf-download-button.jpg" alt="Download PDF" width="262" height="45" /></a></p>
<div id="NDPHPBlock13359" class="NDPHPBlock">
<div style="width: 100%;"><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Tweet this!' href="https://twitter.com/share?text=Behind the scenes of GandCrab’s operation&url=https://www.virusbulletin.com/virusbulletin/2020/01/behind-scenes-gandcrabs-operation"><img src='/uploads/images/buttons/twitter.png' alt='twitter.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Facebook' href='https://www.facebook.com/sharer.php?u=https://www.virusbulletin.com/virusbulletin/2020/01/behind-scenes-gandcrabs-operation'><img src='/uploads/images/buttons/fb.png' alt='fb.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on LinkedIn' href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.virusbulletin.com/virusbulletin/2020/01/behind-scenes-gandcrabs-operation&title=Behind the scenes of GandCrab’s operation"><img src='/uploads/images/buttons/linkedin.png' alt='linkedin.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='Share on Hacker News' href="https://news.ycombinator.com/submitlink?u=https://www.virusbulletin.com/virusbulletin/2020/01/behind-scenes-gandcrabs-operation&t=Behind the scenes of GandCrab’s operation"><img src='/uploads/images/buttons/hackernews.png' alt='hackernews.png' width='45' height='45' class='responsive' /></a></center></div><div style='float: left; width: 20%; margin-left: auto; margin-right: auto; text-align: center;'><center><a target='_blank' title='reddit this!' href="https://www.reddit.com/submit?url=https://www.virusbulletin.com/virusbulletin/2020/01/behind-scenes-gandcrabs-operation"><img src='/uploads/images/buttons/reddit.png' alt='reddit.png' width='45' height='45' class='responsive' /></a></center></div></div></div><p> </p>
<h2>Latest articles:</h2>
<div class="ccm-page-list">

			<h3 class="ccm-page-list-title">
			<a href="/virusbulletin/2025/08/built-be-believed-emotional-mimicry-new-class-threat/" target="_self">Built to be believed: emotional mimicry as a new class of threat</a>
		</h3>
		<div class="ccm-page-list-description">
			In the early days of virus hoaxes and digital confidence scams, we learned that the most dangerous threats weren&rsquo;t always technical but psychological. Now, a new class of threats is emerging that targets that same vulnerability. Only this time, it&rsquo;s&hellip;		</div>
		
			<h3 class="ccm-page-list-title">
			<a href="/virusbulletin/2023/10/nexus-android-banking-botnet-compromising-cc-panels-and-dissecting-mobile-appinjects/" target="_self">Nexus Android banking botnet &ndash; compromising C&amp;C panels and dissecting mobile AppInjects</a>
		</h3>
		<div class="ccm-page-list-description">
			Aditya Sood &amp; Rohit Bansal provide details of a security vulnerability in the Nexus Android botnet C&amp;C panel that was exploited to compromise the C&amp;C panel in order to gather threat intelligence, and present a model of mobile AppInjects.		</div>
		
			<h3 class="ccm-page-list-title">
			<a href="/virusbulletin/2022/04/cryptojacking-fly-teamtnt-using-nvidia-drivers-mine-cryptocurrency/" target="_self">Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency</a>
		</h3>
		<div class="ccm-page-list-description">
			TeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations&rsquo; dedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module introduced by&hellip;		</div>
		
			<h3 class="ccm-page-list-title">
			<a href="/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/" target="_self">Collector-stealer: a Russian origin credential and information extractor</a>
		</h3>
		<div class="ccm-page-list-description">
			Collector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from end-user systems and store it in its C&amp;C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a 360&hellip;		</div>
		
			<h3 class="ccm-page-list-title">
			<a href="/virusbulletin/2021/06/fighting-fire-fire/" target="_self">Fighting Fire with Fire</a>
		</h3>
		<div class="ccm-page-list-description">
			In 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was intrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses, was partly&hellip;		</div>
		
	 

	 
</div><!-- end .ccm-page-list -->


<p><br /><a class="btn btn-block btn-warning" href="/virusbulletin/archive">Bulletin Archive</a></p>		</div>
	</div>
</div>

<!-- Footer
    ================================================== -->
    <footer class="bs-footer" role="contentinfo">
      <div class="container">
        <div class="bs-social">
			<div class="row ">
						
				<div class="col-md-3">
					<p><a title="About Us" href="/about-vb/about-us/">About us</a></p>
<p><a title="Contact Us" href="/about-vb/contact-us/">Contact us</a></p>
<p><a title="Advisory Board" href="/about-vb/advisory-board/">Advisory board</a></p>
<p><a title="Press" href="/about-vb/press/">Press information</a></p>
<p><a title="Newsletter" href="/newsletter/">Virus Bulletin newsletter</a></p>				</div>
				<div class="col-md-3">
					<p><a title="VB Testing" href="/testing/">Testing</a></p>
<p><a title="VB100" href="/testing/vb100/">VB100</a></p>
<p><a title="VBSpam" href="/testing/vbspam/">VBSpam</a></p>
<p><a title="Consultancy Services" href="/testing/consultancy-services/">Consultancy services</a></p>
<p><a title="The Spammers' Compendium" href="/resources/spammerscompendium/">Spammers' Compendium</a></p>				</div>	
									<div class="col-md-3">
					<p><a title="VB2024" href="/conference/vb2024/">VB2024 (Dublin)</a></p>
<p><a title="VB2023" href="/conference/vb2023/">VB2023 (London)</a></p>
<p><a title="VB2022" href="/conference/vb2022/">VB2022 (Prague)</a></p>
<p><a title="VB2021 localhost" href="/conference/vb2021/">VB2021 localhost</a></p>
<p><a title="VB2020 localhost" href="/conference/vb2020/">VB2020 localhost</a></p>
<p><a title="Conference Archive" href="/conference/vb-conference-archive/">Older conferences</a></p>					</div>	
				
									<div class="col-md-3">
					<div class="row">
<table style="float: right;" border="0">
<tbody>
<tr>
<td align="center"><a href="/rss" target="_blank"><img title="Get our blog updates" src="/uploads/images/buttons/rss-square-gray.png" alt="rss.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://twitter.com/virusbtn" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on Twitter" src="/uploads/images/buttons/twitter-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.linkedin.com/company/virus-bulletin" target="_blank"><img class="bhtmbxoyxwpzahwcvxnw" title="Visit us on LinkedIn" src="/uploads/images/buttons/linkedin-square-gray.png" alt="linkedin.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.facebook.com/virusbulletin" target="_blank"><img title="Visit us on Facebook" src="/uploads/images/buttons/fb-square-gray.png" alt="twitter.png" width="35" height="35" /></a></td>
<td> </td>
<td align="center"><a href="https://www.youtube.com/user/virusbtn" target="_blank"><img title="Visit us on Youtube" src="/uploads/images/buttons/youtube-square-gray.png" alt="youtube.png" width="35" height="35" /></a></td>
</tr>
</tbody>
</table>
</div>					</div>	
				
								
			</div>
			<div class="row ">
				<div class="col-md-12">
									</div>							
			</div>
		</div>
      </div>
    </footer>

	<!-- lian's attempt for a new footer -->
    <footer class="bs-footer2" role="contentinfo">
      <div class="container">
        <div class="bs-social2">
			<div class="row ">
						
				<div class="col-md-3">
									</div>
				<div class="col-md-3">
									</div>	
									<div class="col-md-3">
										</div>	
				
									<div class="col-md-3">
										</div>	
				
								
			</div>
			<div class="row ">
				<div class="col-md-12">
					<p style="text-align: left;">©1989-2025 Virus Bulletin.        <a title="Privacy Policy" href="/about-vb/privacy-policy/">Privacy policy</a>        <a title="Cookies" href="/about-vb/privacy-policy/cookies/">Cookies</a>        <a title="Terms and Conditions" href="/about-vb/terms-and-conditions/">Terms and Conditions</a></p>				</div>							
			</div>
		</div>
      </div>
    </footer>

<script type="text/javascript" src="/libraries/js/fancybox.load.js"></script>
<script type="text/javascript" src="/packages/bootstrap/js/common/app.js"></script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TDBVSRVN"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div id="ccm-cookiesDisclosure" class="disclosure-bottom">
	<div class="disclosure-container">
					<div class="disclosure-content">
				<p> We have placed cookies on your device in order to improve the functionality of this site, as outlined in our <a href="/about-vb/privacy-policy/cookies" target="_blank">cookies policy</a>. However, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our <a href="/about-vb/privacy-policy/" target="_blank">privacy policy</a>.</p>
			</div>
			<div class="disclosure-form">
	<form action="/index.php/cookies_disclosure/" method="POST">
					<input type="hidden" name="allowCookies" value="1" />
							<div class="button">
			<input class="btn btn-info btn-sm" type="submit" name="submit" value="I understand. Don't show this message again!" />
		</div>
	</form>
</div>
				<div class="ccm-spacer">&nbsp;</div>
	</div>
</div>
</body>
</html>