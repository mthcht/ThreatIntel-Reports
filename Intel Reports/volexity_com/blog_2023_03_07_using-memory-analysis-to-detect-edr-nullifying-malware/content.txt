
<!DOCTYPE html>
<!--[if lt IE 7 ]> <html lang="en-US" class="ie ie6 lte9 lte8 lte7 lte6 no-js"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en-US" class="ie ie7 lte9 lte8 lte7 no-js"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en-US" class="ie ie8 lte9 lte8 no-js"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en-US" class="ie ie9 lte9 no-js"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html lang="en-US" class="no-js">
<!--<![endif]-->

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="cleartype" content="on">
	<meta name="theme-color" content="#0075BC">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

	<script>
		// Define dataLayer and the gtag function.
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}

		// Set default consent to 'denied' as a placeholder
		// Determine actual values based on your own requirements
		gtag('consent', 'default', {
			'ad_storage': 'denied',
			'ad_user_data': 'denied',
			'ad_personalization': 'denied',
			'analytics_storage': 'denied',
			'functionality_storage': 'denied',
			'personalization_storage': 'denied',
			'security_storage': 'denied',
		});
	</script>
	<!-- Google tag (gtag.js) -->
    	<script async src="https://www.googletagmanager.com/gtag/js?id=G-WRSX85NK29"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}

		gtag('js', new Date());
		gtag('config', 'G-WRSX85NK29');
	</script>
	<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
	<!-- This site is optimized with the Yoast SEO Premium plugin v25.2 (Yoast SEO v25.2) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Using Memory Analysis to Detect EDR-Nullifying Malware | Volexity</title>
	<link rel="canonical" href="https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Using Memory Analysis to Detect EDR-Nullifying Malware" />
	<meta property="og:description" content="In the ever-changing cybersecurity landscape, threat actors are forced to evolve and continually modify the tactics, techniques, and procedures (TTPs) they employ to launch and sustain attacks successfully. They are [&hellip;]" />
	<meta property="og:url" content="https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/" />
	<meta property="og:site_name" content="Volexity" />
	<meta property="article:publisher" content="https://www.facebook.com/volexity/" />
	<meta property="article:published_time" content="2023-03-07T11:01:57+00:00" />
	<meta property="article:modified_time" content="2025-06-06T18:52:07+00:00" />
	<meta property="og:image" content="https://www-dev.volexity.com/wp-content/uploads/2025/02/Volexity-Memory-Analysis-AVBurner-Header-Graphic-1.png" />
	<meta property="og:image:width" content="2060" />
	<meta property="og:image:height" content="1076" />
	<meta property="og:image:type" content="image/png" />
	<meta name="author" content="mindgrub" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@volexity" />
	<meta name="twitter:site" content="@volexity" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/#article","isPartOf":{"@id":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/"},"author":{"name":"mindgrub","@id":"https://www-dev.volexity.com/#/schema/person/ef102495bc7ecc8cddb3946d0eff9f9a"},"headline":"Using Memory Analysis to Detect EDR-Nullifying Malware","datePublished":"2023-03-07T11:01:57+00:00","dateModified":"2025-06-06T18:52:07+00:00","mainEntityOfPage":{"@id":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/"},"wordCount":1970,"commentCount":0,"publisher":{"@id":"https://www-dev.volexity.com/#organization"},"image":{"@id":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/#primaryimage"},"thumbnailUrl":"https://www.volexity.com/wp-content/uploads/2025/02/Volexity-Memory-Analysis-AVBurner-Header-Graphic-1.png","keywords":["edr","forensics","Memory Forensics","snakecharmer","volcano"],"articleSection":["Memory Forensics"],"inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/#respond"]}]},{"@type":"WebPage","@id":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/","url":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/","name":"Using Memory Analysis to Detect EDR-Nullifying Malware | Volexity","isPartOf":{"@id":"https://www-dev.volexity.com/#website"},"primaryImageOfPage":{"@id":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/#primaryimage"},"image":{"@id":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/#primaryimage"},"thumbnailUrl":"https://www.volexity.com/wp-content/uploads/2025/02/Volexity-Memory-Analysis-AVBurner-Header-Graphic-1.png","datePublished":"2023-03-07T11:01:57+00:00","dateModified":"2025-06-06T18:52:07+00:00","breadcrumb":{"@id":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/#primaryimage","url":"https://www.volexity.com/wp-content/uploads/2025/02/Volexity-Memory-Analysis-AVBurner-Header-Graphic-1.png","contentUrl":"https://www.volexity.com/wp-content/uploads/2025/02/Volexity-Memory-Analysis-AVBurner-Header-Graphic-1.png","width":2060,"height":1076},{"@type":"BreadcrumbList","@id":"https://www-dev.volexity.com/blog/2023/03/07/using-memory-analysis-to-detect-edr-nullifying-malware/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www-dev.volexity.com/"},{"@type":"ListItem","position":2,"name":"Using Memory Analysis to Detect EDR-Nullifying Malware"}]},{"@type":"WebSite","@id":"https://www-dev.volexity.com/#website","url":"https://www-dev.volexity.com/","name":"Volexity | Memory Forensics, Cybersecurity Threat Intelligence & Incident Response","description":"No &#039;Ware To Hide","publisher":{"@id":"https://www-dev.volexity.com/#organization"},"alternateName":"Volexity Memory Forensics","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www-dev.volexity.com/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://www-dev.volexity.com/#organization","name":"Volexity","alternateName":"Volexity - Memory Forensics","url":"https://www-dev.volexity.com/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www-dev.volexity.com/#/schema/logo/image/","url":"https://www.volexity.com/wp-content/uploads/2025/06/Volexity-Logo-Stacked.png","contentUrl":"https://www.volexity.com/wp-content/uploads/2025/06/Volexity-Logo-Stacked.png","width":1200,"height":765,"caption":"Volexity"},"image":{"@id":"https://www-dev.volexity.com/#/schema/logo/image/"},"sameAs":["https://www.facebook.com/volexity/","https://x.com/volexity","https://www.linkedin.com/company/volexity/","https://github.com/volexity","https://infosec.exchange/@volexity","https://bsky.app/profile/volexity.com"]},{"@type":"Person","@id":"https://www-dev.volexity.com/#/schema/person/ef102495bc7ecc8cddb3946d0eff9f9a","name":"mindgrub","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www-dev.volexity.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/e053e4a98d01060cb7fd4f91410720af?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/e053e4a98d01060cb7fd4f91410720af?s=96&d=mm&r=g","caption":"mindgrub"},"sameAs":["https://www.volexity.com"],"url":"https://www.volexity.com/blog/author/mindgrub/"}]}</script>
	<!-- / Yoast SEO Premium plugin. -->


<link rel='dns-prefetch' href='//static.addtoany.com' />
<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link href='https://fonts.gstatic.com' crossorigin='' rel='preconnect' />
<link rel='preconnect' href='https://fonts.googleapis.com' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='theme-styles-css' href='https://www.volexity.com/wp-content/themes/volexity/dist/styles/theme-styles.min.css?ver=1749053750' type='text/css' media='screen, print' />
<link rel='stylesheet' id='theme-icons-css' href='https://www.volexity.com/wp-content/themes/volexity/dist/icons.css?ver=1748636865' type='text/css' media='screen' />
<link rel='stylesheet' id='theme-fonts-css' href='https://fonts.googleapis.com/css2?family=Gloock&#038;family=Work+Sans:ital,wght@0,100..900;1,100..900&#038;Archivo+Narrow:ital,wght@0,400..700;1,400..700&#038;display=swap' type='text/css' media='all' />
<link rel='stylesheet' id='addtoany-css' href='https://www.volexity.com/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.16' type='text/css' media='all' />
<script type="text/javascript" id="addtoany-core-js-before">
/* <![CDATA[ */
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};
/* ]]> */
</script>
<script type="text/javascript" defer src="https://static.addtoany.com/menu/page.js" id="addtoany-core-js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js?ver=1.0.0" id="jquery-js"></script>
<script type="text/javascript" defer src="https://www.volexity.com/wp-content/plugins/add-to-any/addtoany.min.js?ver=1.1" id="addtoany-jquery-js"></script>
<link rel="https://api.w.org/" href="https://www.volexity.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://www.volexity.com/wp-json/wp/v2/posts/1128" /><link rel='shortlink' href='https://www.volexity.com/?p=1128' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://www.volexity.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.volexity.com%2Fblog%2F2023%2F03%2F07%2Fusing-memory-analysis-to-detect-edr-nullifying-malware%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://www.volexity.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.volexity.com%2Fblog%2F2023%2F03%2F07%2Fusing-memory-analysis-to-detect-edr-nullifying-malware%2F&#038;format=xml" />
<meta name="tec-api-version" content="v1"><meta name="tec-api-origin" content="https://www.volexity.com"><link rel="alternate" href="https://www.volexity.com/wp-json/tribe/events/v1/" /><link rel="icon" href="https://www.volexity.com/wp-content/uploads/2025/06/favicon-512x512-1-150x150.png" sizes="32x32" />
<link rel="icon" href="https://www.volexity.com/wp-content/uploads/2025/06/favicon-512x512-1-300x300.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.volexity.com/wp-content/uploads/2025/06/favicon-512x512-1-300x300.png" />
<meta name="msapplication-TileImage" content="https://www.volexity.com/wp-content/uploads/2025/06/favicon-512x512-1-300x300.png" />
</head>

<body class="post-template-default single single-post postid-1128 single-format-standard tribe-no-js">
			<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}

			gtag('consent', 'default', {
				'ad_storage': 'denied',
				'analytics_storage': 'denied',
				'functionality_storage': 'denied',
				'personalization_storage': 'denied',
				'security_storage': 'denied'
			});
		</script>
	
	<div class="header-observer"></div>
<header class="header" id="site-header">

	<a class="sr-only sr-only-focusable skip-to-main" href="#main">
		Skip to main content	</a>

	<section class="main-header main-header--white">
		<div class="container container-wide">
			<div class="main-header__wrapper">


				<div class="main-header__logo text-center">
					<a href="/" class="main-header__home" aria-label="Logo linking to homepage">
						<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 195 20">
	<g>
		<path d="m123.152 0-20.556 19.773h8.457L131.479 0h-8.327Z" fill="#4D9ED7" />
		<path d="m118.52 14.724 5.154 5.049h8.327l-9.405-8.994-4.068 3.937-.008.008ZM103.509 0l8.605 8.443 3.998-3.85L111.305 0H103.5h.009ZM22.198.254 14.41 14.899 6.726.254H.103l10.508 19.519h7.51L28.638.253h-6.44ZM37.556 19.947c-.444 0-.895 0-1.365-.026-.47-.017-.843-.026-1.138-.044-.904 0-1.704-.148-2.4-.437a5.182 5.182 0 0 1-1.807-1.269c-.426-.437-.74-.883-.922-1.347-.26-.595-.452-1.417-.6-2.476-.138-1.059-.208-2.345-.208-3.858V7.953c0-.858.052-1.628.157-2.319.104-.691.252-1.347.46-1.995.452-1.426 1.443-2.432 2.973-2.992.556-.201 1.556-.358 2.99-.472C37.13.07 39.007.017 41.346.017h4.25c2.972 0 4.963.175 5.97.534 2.043.717 3.217 2.231 3.521 4.55.035.314.06.734.096 1.268.034.534.052 1.059.052 1.575l.052 3.21c0 1.357-.052 2.442-.148 3.273a8.144 8.144 0 0 1-.608 2.3c-.452 1.05-1.139 1.847-2.06 2.398-.921.551-2.069.822-3.442.822L46.03 20l-8.465-.053h-.01Zm7.518-4.986c.939 0 1.643-.036 2.112-.097.782-.105 1.347-.498 1.678-1.155.33-.665.495-2.082.495-4.252 0-1.11-.052-1.907-.156-2.397-.174-.91-.66-1.478-1.452-1.706-.26-.061-.556-.122-.886-.184a6.278 6.278 0 0 0-.983-.078l-3.78-.035h-2.13c-.33 0-.782 0-1.347.017-.565.009-.913.018-1.043.018-.487 0-.895.078-1.226.253-.33.167-.617.42-.843.762-.347.525-.521 2.108-.521 4.741 0 1.855.304 3.019.904 3.5.426.367 1.634.56 3.598.56l5.572.044.008.008ZM64.266.254v14.48h13.002v5.039H58.356V.253h5.91ZM79.415.254h21.33v4.55h-15.42v2.668h14.56v4.225h-14.56v3.526h15.594v4.55H79.415V.253ZM139.136.254h-5.91v19.519h5.91V.253ZM164.569.254v5.039h-8.492v14.48h-5.911V5.293h-8.5V.253h22.903ZM173.773.254l6.38 7.847 6.38-7.847h7.57l-11.03 12.712v6.807h-5.91v-6.807L166.168.254h7.605Z" fill="#64656A" />
	</g>
	<defs>
		
			<path fill="#fff" d="M0 0h194v20H0z" />
		
	</defs>
</svg>
					</a>
				</div>

				<div class="main-header-toggle__wrapper">
					<button class="main-header-toggle">
						<span class="sr-only">Open Menu</span>
						<span class="main-header-toggle__span"></span>
						<span class="main-header-toggle__span"></span>
						<span class="main-header-toggle__span"></span>
						<span class="main-header-toggle__span"></span>
					</button>
				</div>

				<div class="main-header__drawer">
											<section class="main-menu container container-wide">
							<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-2983" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2983"><a href="https://www.volexity.com/products-overview/"><span>Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-515" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-515"><a href="https://www.volexity.com/products-overview/"><span>Products Overview</span></a></li>
	<li id="menu-item-565" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-565"><a href="https://www.volexity.com/products-overview/volcano/"><span>Volcano</span></a></li>
	<li id="menu-item-564" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-564"><a href="https://www.volexity.com/products-overview/surge/"><span>Surge</span></a></li>
</ul>
</li>
<li id="menu-item-552" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-552"><a href="https://www.volexity.com/services-overview/"><span>Services</span></a>
<ul class="sub-menu">
	<li id="menu-item-2535" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2535"><a href="https://www.volexity.com/services-overview/"><span>Services Overview</span></a></li>
	<li id="menu-item-549" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-549"><a href="https://www.volexity.com/services-overview/incident-response/"><span>Incident Response</span></a></li>
	<li id="menu-item-548" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-548"><a href="https://www.volexity.com/services-overview/network-security-monitoring/"><span>Network Security Monitoring</span></a></li>
	<li id="menu-item-547" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-547"><a href="https://www.volexity.com/services-overview/proactive-threat-assessments/"><span>Proactive Threat Assessments</span></a></li>
	<li id="menu-item-546" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-546"><a href="https://www.volexity.com/services-overview/cyber-threat-intelligence/"><span>Cyber Threat Intelligence</span></a></li>
	<li id="menu-item-2345" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2345"><a href="https://www.volexity.com/services-overview/mergers-acquisitions-cybersecurity-assessments/"><span>M&#038;A Cybersecurity Assessments</span></a></li>
</ul>
</li>
<li id="menu-item-2490" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-2490"><a href="#"><span>Company</span></a>
<ul class="sub-menu">
	<li id="menu-item-523" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-523"><a href="https://www.volexity.com/company/about-us/"><span>About</span></a></li>
	<li id="menu-item-2298" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2298"><a href="https://www.volexity.com/company/news/"><span>News &#038; Press</span></a></li>
	<li id="menu-item-533" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-533"><a href="https://www.volexity.com/company/careers/"><span>Careers</span></a></li>
	<li id="menu-item-2344" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2344"><a href="https://www.volexity.com/internships/"><span>Internships</span></a></li>
	<li id="menu-item-532" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-532"><a href="https://www.volexity.com/company/resources/"><span>Resources</span></a></li>
	<li id="menu-item-2990" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2990"><a href="https://www.volexity.com/events/"><span>Events</span></a></li>
</ul>
</li>
<li id="menu-item-516" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-516"><a href="https://www.volexity.com/blog/"><span>Blog</span></a></li>
<li id="menu-item-530" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-530"><a href="https://www.volexity.com/contact/"><span>Contact</span></a></li>
</ul></div>						</section>
																<section class="main-menu-utility container container-wide">

							<ul id="menu-utility-menu" class="main-menu-utility__container"><li id="menu-item-1605" class=' menu-item menu-item-type-post_type menu-item-object-page menu-item--0'><a href="https://www.volexity.com/contact/demo-request/" class="menu-item__link menu-item__link--0">Request A Demo</a></li>
<li id="menu-item-507" class=' menu-item menu-item-type-post_type menu-item-object-page menu-item--0'><a href="https://www.volexity.com/contact/breach-assistance/" class="menu-item__link menu-item__link--0">Breach Assistance</a></li>
</ul>
						</section>
					
				</div>
			</div>
		</div>
	</section>

</header>

	<main class="site-main" id="main">
		<nav class="breadcrumbs breadcrumbs--shallow"
	 aria-label="Breadcrumb">
	<div class="container container-narrow">
		<ol class="breadcrumbs__list" itemscope itemtype="https://schema.org/BreadcrumbList">

							<li class="breadcrumbs__crumb" itemscope itemprop="itemListElement"
					itemtype="https://schema.org/ListItem">
																		<a class="breadcrumbs__link" itemprop="item"
								href="https://www.volexity.com/blog/"
															>
								<span itemprop="name">Blog</span>
							</a>
																<meta itemprop="position" content="1"/>
				</li>
											<li class="breadcrumbs__crumb" itemscope itemprop="itemListElement"
					itemtype="https://schema.org/ListItem">
																					<meta itemprop="position" content="2"/>
				</li>
									</ol>
	</div>

</nav>
<section class="mgpb-hero mgpb-hero--detail mgpb-hero--light-blue mgpb-hero--none mgpb-hero--image">
	
	<div class="mgpb-hero__container container">
		<div class="row">
			<div class="col-12">
				<div class="mgpb-hero__inner d-flex flex-column flex-lg-row align-items-center">
					<div class="mgpb-hero__content">
						<div>
															<p class="mgpb-hero__label mb-2">
									<span class="mgpb-chip mgpb-chip--square" style="">Memory Forensics</span>
								</p>
							
															<h1 class="mgpb-hero__heading heading heading--hero mb-6">
									Using Memory Analysis to Detect EDR-Nullifying Malware								</h1>

								<p class="mgpb-hero__date heading--4">March 7, 2023</p>

																	<p class="mgpb-hero__byline body--large mt-2">Paul Rascagneres and Volexity Volcano Team</p>
																					</div>
					</div>

									</div>
			</div>
		</div>
	</div>

	</section>
	<div class="after-hero">
	
<section class="mgpb-wysiwyg mt-12 mb-12">
	<div class="mgpb-wysiwyg__container container">
		<div class="wysiwyg">
			<p><a href="https://www.volexity.com/wp-content/uploads/2023/03/Volexity-Memory-Analysis-AVBurner-Header-Graphic.png"><img class="alignnone wp-image-2780 size-full" src="https://www.volexity.com/wp-content/uploads/2023/03/Volexity-Memory-Analysis-AVBurner-Header-Graphic-1.png" alt="" width="2060" height="1076" /></a></p>
<p>In the ever-changing cybersecurity landscape, threat actors are forced to evolve and continually modify the tactics, techniques, and procedures (TTPs) they employ to launch and sustain attacks successfully. They are continually modifying their malware and command-execution methods to evade detection. The attackers in these cases are attempting to get a step ahead of security software at the most basic level.</p>
<p>However, some techniques take a different approach, aiming further up the stack and directly taking on security software. The most brazen methods involve leveraging various tools that directly terminate or shutdown security software. If successful, this method is effective at giving an attacker free reign on a system. However, it comes at the potential cost of alerting users or administrators that the software unexpectedly stopped reporting or was shut off. What about a technique that potentially flies a bit more under the radar?</p>
<p>In November 2022, Trend Micro published a <a href="https://www.trendmicro.com/en_us/research/22/k/hack-the-real-box-apt41-new-subgroup-earth-longzhi.html">blog post</a> related a Chinese APT threat actor they called “Earth Longzhi”, and that Volexity tracks as “SnakeCharmer”. One tool Trend Micro described, dubbed “AVBurner”, used a technique to patch process-creation callbacks in kernel memory to nullify security software running on a victim system. The end result: the security software would appear to be running fine, but in reality, it was neutered and rendered useless. When successful, this approach allows an attacker to carry on their operations with little risk of being detected as a result of the security software. While there are several documented cases of attackers patching these callbacks, this particular technique leveraged by SnakeCharmer and others lends itself to specific methods of detection by way of memory analysis.</p>
<p>Volexity conducted research and testing to determine ways this technique of attacking endpoint detection and response (EDR) and antivirus (AV) software could reliably be detected through memory analysis. This blog:</p>
<ul>
<li>Examines the technique used by AVBurner, building upon the Trend Micro blog.</li>
<li>Provides a refresher on the internal mechanism of the Windows callbacks and how AVBurner disables functionality of security products.</li>
<li>Explains how memory analysis can identify manipulated EDR callbacks, such as those employed by AVBurner, using either via <a href="https://github.com/volatilityfoundation/volatility3">Volatility 3</a> or <a href="https://www.volexity.com/products-overview/volcano/">Volexity Volcano</a>.</li>
</ul>
<h2>Kernel Process Callbacks</h2>
<p>In order to function, both EDR and AV solutions must effectively monitor process creation. When a process is created, security products can block it from starting or inject a library into it to monitor its behavior. To do so, most security products use a driver to register a kernel callback, most commonly using the <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-pssetcreateprocessnotifyroutine"><mark style="background-color: lightgrey">PsSetCreateProcessNotifyRoutine()</mark></a> API.</p>
<p>Figure 1 shows the pseudocode of this function.</p>
<p><img class="alignnone size-full wp-image-2762" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_1-1.png" alt="" width="821" height="66" /></p>
<p><em>Figure 1. PsSetCreateProcessNotifyRoutine() pseudocode</em></p>
<p>As can be seen, this function’s sole purpose is to execute another function, <mark style="background-color: lightgrey">PspSetCreateProcessNotifyRoutine()</mark>. This API is not documented by Microsoft, but it can be understood by examining its disassembly pseudocode.</p>
<p><img class="alignnone size-full wp-image-2763" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_2-1.png" alt="" width="781" height="757" /></p>
<p><em>Figure 2. PspSetCreateProcessNotifyRoutine() pseudocode</em></p>
<p>Figure 2 shows the pseudocode of this function when the second argument is true (i.e., when a callback is to be removed).</p>
<ul>
<li>Lines 19 and 44 of this pseudocode show a loop that increments the <mark style="background-color: lightgrey">v9</mark> variable from “0” to “0x40”. This variable is an index for the <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutine</mark> This array is used as a first argument to the <mark style="background-color: lightgrey">ExDerefenceCallBackBlock()</mark> function and contains the callbacks. A maximum of “0x40” (64) callbacks can be defined.</li>
<li>Lines 32 and 34 show two interesting variables: <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutineExCount</mark> and <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutineCount</mark>. If a callback is removed, one of these variables is decremented. The sum of these two variables is the number of defined callbacks.</li>
<li>The <mark style="background-color: lightgrey">ExCompareExchangeCallBack()</mark> API shows a mask (“0xFFFFFFFF`FFFFFFF0”) must be applied to the address stored in the <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutine</mark></li>
</ul>
<p><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/debugger-download-tools">WinDBG</a> can be used to confirm these conclusions. Figure 3 shows the <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutineExCount</mark> and <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutineCount</mark> values.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2764" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_3-1.png" alt="" width="505" height="73" /></p>
<p><em>Figure 3. The count of defined callbacks</em></p>
<p>In this example, there are 13 callbacks defined on this system.</p>
<p>Figure 4 shows the <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutine</mark> array (13 callbacks) and the called functions for the first three callbacks.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2765" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_4-1.png" alt="" width="719" height="470" /></p>
<p><em>Figure 4. 13 defined callbacks and the definition of the first three</em></p>
<p>In this example, each time a process is created, <mark style="background-color: lightgrey">nt!ViCreateProcessCallback()</mark>, <mark style="background-color: lightgrey">cng!CngCreateProcessNotifyRoutine()</mark>, <mark style="background-color: lightgrey">ksecdd!KsecCreateProcessNotifyRoutine()</mark>, and the 10 others are called.</p>
<p>Armed with this knowledge, one can further analyze AVBurner and its approach to tampering with these callbacks.</p>
<h2> AVBurner Kernel Process Callback Bypass</h2>
<div class="mgpb-table-wrapper"><table>
<tbody>
<tr>
<td width="143"><strong>Name(s)</strong></td>
<td width="480">execute.exe</td>
</tr>
<tr>
<td width="143"><strong>Size</strong></td>
<td width="480">158.0KB (161792 Bytes)</td>
</tr>
<tr>
<td width="143"><strong>File Type</strong></td>
<td width="480">Win64 EXE</td>
</tr>
<tr>
<td width="143"><strong>MD5</strong></td>
<td width="480">494cc48a9856cf5b46fb13bcd68c256f</td>
</tr>
<tr>
<td width="143"><strong>SHA1</strong></td>
<td width="480">39727e755b2806fc2ed5204dae4572a14b2d43d1</td>
</tr>
<tr>
<td width="143"><strong>SHA256</strong></td>
<td width="480">4b1b1a1293ccd2c0fd51075de9376ebb55ab64972da785153fcb0a4eb523a5eb</td>
</tr>
</tbody>
</table></div>
<p>AVBurner is designed to disable callbacks from the kernel space. A userland application cannot modify kernel memory, so the malware authors include a vulnerable driver, <mark style="background-color: lightgrey">RTCore64.sys</mark>, to read and write into this protected memory space. This driver has been <a href="https://www.picussecurity.com/resource/blog/blackbyte-ransomware-bypasses-edr-products-via-rtcore64.sys-abuse#:~:text=sys.-,RTCore64.,graphic%20cards%20on%20the%20system.">previously reported</a> as being used for the same purpose by ransomware groups. The threat actor in this case is not a ransomware attacker.</p>
<p>This technique of using an older, vulnerable driver to load malicious code was <a href="https://www.virusbulletin.com/virusbulletin/2014/05/anatomy-turla-exploits/">famously used by Turla</a> for the purposes of loading a malicious rootkit. A public GitHub repository, <a href="https://github.com/hfiref0x/KDU">KDU</a>, owned by hFiref0x, documents a list of drivers that can be abused for this “Bring Your Own Vulnerable Driver” (BYOVD) technique.</p>
<p>AVBurner follows the same logic outlined in the <em>Kernel Process Callbacks</em> section to identify the callback array and disable specific callbacks. Specifically, it has the following workflow:</p>
<ul>
<li>Check the OS version, as this is required for the next step.</li>
<li>Abuse <mark style="background-color: lightgrey">RTCore64.sys</mark> to identify the <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutine</mark> array. The identification of this array is based on a byte pattern, which differs according to the OS version (hence the requirement for the previous step).</li>
<li>Abuse <mark style="background-color: lightgrey">RTCore64.sys</mark> to parse the array in order to get the list of currently defined callbacks.</li>
<li>For each registered callback address, gets the location of any SYS file in the directory <mark style="background-color: lightgrey">C:Windows</mark> or its subdirectories. If the SYS file is not located in this directory it is skipped.</li>
<li>Checks the metadata of the SYS file to see if the file matches specific criteria. This is to identify whether or not the callback must be removed.</li>
<li>If the callback is identified as one that should be removed, AVBurner abuses <mark style="background-color: lightgrey">RTCore64.sys</mark> to replace the callback address with “0x00000000`00000000” which effectively disables the callback.</li>
</ul>
<p>This specific sample of AVBurner targets any drivers with the string “360” in their metadata description, meaning it was almost certainly configured to prevent security products by Qihoo 360 from functioning correctly. Figure 5 summarizes AVBurner’s workflow.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2766" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_5-1.png" alt="" width="1262" height="649" /></p>
<p><em>Figure 5. AVBurner workflow</em></p>
<p>Since the Qihoo 360 security product cannot be downloaded and installed for free, for the purposes of demonstration in this report Volexity patched AVBurner to target the free version of <a href="https://www.immunet.com/index">Immunet</a>, which embeds <a href="https://www.cisco.com/c/en_uk/products/security/advanced-malware-protection/index.html">Cisco AMP</a>. Note that the approach employed by AVBurner could be used to target any security product using the same APIs, and the use of Cisco AMP in this post is simply for illustrative purposes. Some products may have anti-tampering mechanisms to prevent or detect this style of attack.</p>
<p>Figure 6 shows the callback array before and after AVBurner execution.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2767" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_6-1.png" alt="" width="909" height="310" /></p>
<p><em>Figure 6. Callback array before AVBurner execution (left) and after (right)</em></p>
<p>Two callbacks are removed from the list and the address is replaced by “0x00000000`00000000”. Figure 7 shows the values before the AVBurner execution; as expected, these callbacks are related to AMP.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2768" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_7-1.png" alt="" width="675" height="111" /></p>
<p><em>Figure 7. Callback before AVBurner execution</em></p>
<p>This post is limited to process creation monitoring, but AVBurner also supports manipulation of additional callbacks, such as <mark style="background-color: lightgrey">thread creation</mark> and <mark style="background-color: lightgrey">image load</mark> callbacks.</p>
<h2>Detecting Disappearing Callbacks with Volatility 3</h2>
<p>Volatility 3 natively lists the currently registered callbacks with the <mark style="background-color: lightgrey">windows.callbacks</mark> command. Figure 8 shows the command’s output before and after the execution of AVBurner; as expected, the two Cisco AMP callbacks disappear.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2769" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_8-1.png" alt="" width="1100" height="504" /></p>
<p><em>Figure 8. Volatility 3 windows.callback output</em></p>
<p>Two approaches can be used to identify the callback anomaly:</p>
<ul>
<li>Get the count of callbacks (see next section for details on how to do this) and compare the value with the <mark style="background-color: lightgrey">windows.callbacks</mark> output.</li>
<li>Maintain a list of EDR or AV modules that register process creation callbacks, and check if the driver is loaded but a callback that should be registered is missing.</li>
</ul>
<h3>Volshell: Getting the Count of Callbacks</h3>
<p>Volatility 3 provides a shell that supports symbols to query the kernel objects. The following code shows how to get the values for <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutineExCount</mark> and <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutineCount</mark> (Figure 9). Note that color has been added for emphasis.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2770" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_9-1.png" alt="" width="1033" height="508" /></p>
<p><em>Figure 9. Highlighted example command-line output showing the number of callbacks that should exist</em></p>
<p>The offsets of the variables, <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutineExCount</mark> and <mark style="background-color: lightgrey">PspCreateProcessNotifyRoutineCount</mark>, (denoted in purple and gold) match what is shown in Figure 9; the sum is 13. However, there are only 11 defined callbacks shown when listing them using <mark style="background-color: lightgrey">windows.callbacks</mark> (Figure 10).</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2771" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_10-1.png" alt="" width="1326" height="74" /></p>
<p><em>Figure 10. Highlighted Volatility output showing only 11 callbacks are still defined</em></p>
<h3>Detecting Tampered EDR Callbacks with Volexity Volcano</h3>
<p>Although these malicious modifications are possible to detect with Volatility, many analysts prefer a more robust, out-of-the-box solution, especially in time-sensitive engagements. Volexity Volcano can help assess if systems are trustworthy, even if AV and EDR products report being healthy and fully operational. Figure 11 shows a summary of some of the IOCs that triggered on the AVBurner memory sample. It points out that two kernel modules, <mark style="background-color: lightgrey">CiscoAMPCEFWDriver.sys</mark> and <mark style="background-color: lightgrey">CiscoAMP.sys</mark>, are affected by the malware.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2772" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_11-1.png" alt="" width="1754" height="284" /></p>
<p><em>Figure 11. Volcano IOC summary includes two Disabled AV/EDR Callbacks</em></p>
<p>In addition to the IOC summary, Volcano offers more specific details on the artifacts themselves (including the full path on disk to the kernel module) and an explanation of exactly what functionality has been disabled. Color-coded labels and associated notes are automatically added to the artifacts to bring these alerts to the analyst’s attention.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2773" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_12-2.png" alt="" width="1842" height="804" /></p>
<p><em>Figure 12. Zooming in on specific details for CiscoSAM.sys </em></p>
<p>Another valuable feature of Volcano that defenders can leverage against the previously described BYOVD technique is listing recently unloaded kernel modules. In most cases, malware will not need a vulnerable driver in the long term. It will load the driver, use it, then unload it quickly to avoid further detection. For debugging purposes, Windows stores unload events in memory, which Volcano can query. Although the vulnerable driver was referred to by its original name, <mark style="background-color: lightgrey">RTCore64.sys</mark>, the malware drops it to disk as <mark style="background-color: lightgrey">a.sys</mark>. Figure 13 shows how Volcano preserves this activity for forensic purposes and provides an unload timestamp for incorporation into timelines.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-2774" src="https://www.volexity.com/wp-content/uploads/2023/03/fig_13-2.png" alt="" width="1600" height="892" /></p>
<p><em>Figure 13. Volcano showing details of unloaded Kernel modules</em></p>
<h2>Conclusion</h2>
<p>This blog posts describes how process creation callbacks work on Windows, and how AVBurner can bypass modern EDR and AV solutions by patching kernel memory. In this case, the malware was only used to disable monitoring process creation, but the same approach can be used to disable other callbacks used for events like thread creation and image loading.</p>
<p>Having detection capabilities related to AVBurner is useful. However, it is even better to have robust techniques for broadly detecting whether or not security products have been tampered with in this manner. Callback manipulation can be identified by analyzing the memory of the system, either through automated detections in Volexity Volcano, or through use of Volatility 3 and Volshell.</p>
<p>To generically identify BYOVD related attacks, Volexity recommends the following:</p>
<ul>
<li>Monitor for creation of the file <mark style="background-color: lightgrey">RTCore64.sys</mark> and the other vulnerable drivers <a href="https://github.com/hfiref0x/KDU">listed in the KDU project</a>, as they are commonly used by threat actors.</li>
<li>If possible, consider enforcing the mitigations recommended by Microsoft <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules">here</a>.</li>
</ul>
<p>To detect the specific malware referenced in this blog post, Volexity recommends the following:</p>
<ul>
<li>Use the <a href="https://github.com/volexity/threat-intel/blob/main/2023/2023-03-07%20AVBurner/yara.yar">YARA rule available on GitHub</a> to identify instances of AVBurner.</li>
</ul>
<p><em>Volexity&#8217;s Threat Intelligence research, such as the content from this blog, is published to customers via its <a href="https://www.volexity.com/services-overview/threat-intelligence/">Threat Intelligence</a> service and was covered by in MAR-20230112 and original activity related to this threat actor was discussed in TIB-20211124. </em></p>
<p><em>Volexity&#8217;s leading memory analysis product, <a href="https://www.volexity.com/products-overview/volcano/">Volexity Volcano</a>, detects the EDR and AV evasion technique discussed in this post through the “Disabled AV/EDR Callbacks” indicator.</em></p>
<p><em>If you are interested in learning more about these products and services, please do not hesitate to <a href="https://www.volexity.com/company/contact/">contact us</a>.</em></p>
		</div>
	</div>
</section>
	</div>
	<section class="mgpb-tags mgpb-block">
	<div class="mgpb-tags__container container">
		<ul class="mgpb-tags__tags d-flex flex-wrap gap-1">
						<li class="mgpb-tags__tag">
				<a href="https://www.volexity.com/blog/tag/edr/" class="mgpb-chip mgpb-chip--blue-2">
					edr				</a>
			</li>
						<li class="mgpb-tags__tag">
				<a href="https://www.volexity.com/blog/tag/forensics/" class="mgpb-chip mgpb-chip--blue-2">
					forensics				</a>
			</li>
						<li class="mgpb-tags__tag">
				<a href="https://www.volexity.com/blog/tag/memory-forensics/" class="mgpb-chip mgpb-chip--blue-2">
					Memory Forensics				</a>
			</li>
						<li class="mgpb-tags__tag">
				<a href="https://www.volexity.com/blog/tag/snakecharmer/" class="mgpb-chip mgpb-chip--blue-2">
					snakecharmer				</a>
			</li>
						<li class="mgpb-tags__tag">
				<a href="https://www.volexity.com/blog/tag/volcano/" class="mgpb-chip mgpb-chip--blue-2">
					volcano				</a>
			</li>
					</ul>
	</div>
</section>
	</main>

	<footer class="footer">
	<div class="footer__container container d-flex flex-column">
		<div class="footer__row">
			<div class="footer__brand">
				<a href="/" class="footer__logo"
					aria-label="Logo linking to homepage">
					<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 195 20">
	<g>
		<path d="m123.152 0-20.556 19.773h8.457L131.479 0h-8.327Z" fill="#4D9ED7" />
		<path d="m118.52 14.724 5.154 5.049h8.327l-9.405-8.994-4.068 3.937-.008.008ZM103.509 0l8.605 8.443 3.998-3.85L111.305 0H103.5h.009ZM22.198.254 14.41 14.899 6.726.254H.103l10.508 19.519h7.51L28.638.253h-6.44ZM37.556 19.947c-.444 0-.895 0-1.365-.026-.47-.017-.843-.026-1.138-.044-.904 0-1.704-.148-2.4-.437a5.182 5.182 0 0 1-1.807-1.269c-.426-.437-.74-.883-.922-1.347-.26-.595-.452-1.417-.6-2.476-.138-1.059-.208-2.345-.208-3.858V7.953c0-.858.052-1.628.157-2.319.104-.691.252-1.347.46-1.995.452-1.426 1.443-2.432 2.973-2.992.556-.201 1.556-.358 2.99-.472C37.13.07 39.007.017 41.346.017h4.25c2.972 0 4.963.175 5.97.534 2.043.717 3.217 2.231 3.521 4.55.035.314.06.734.096 1.268.034.534.052 1.059.052 1.575l.052 3.21c0 1.357-.052 2.442-.148 3.273a8.144 8.144 0 0 1-.608 2.3c-.452 1.05-1.139 1.847-2.06 2.398-.921.551-2.069.822-3.442.822L46.03 20l-8.465-.053h-.01Zm7.518-4.986c.939 0 1.643-.036 2.112-.097.782-.105 1.347-.498 1.678-1.155.33-.665.495-2.082.495-4.252 0-1.11-.052-1.907-.156-2.397-.174-.91-.66-1.478-1.452-1.706-.26-.061-.556-.122-.886-.184a6.278 6.278 0 0 0-.983-.078l-3.78-.035h-2.13c-.33 0-.782 0-1.347.017-.565.009-.913.018-1.043.018-.487 0-.895.078-1.226.253-.33.167-.617.42-.843.762-.347.525-.521 2.108-.521 4.741 0 1.855.304 3.019.904 3.5.426.367 1.634.56 3.598.56l5.572.044.008.008ZM64.266.254v14.48h13.002v5.039H58.356V.253h5.91ZM79.415.254h21.33v4.55h-15.42v2.668h14.56v4.225h-14.56v3.526h15.594v4.55H79.415V.253ZM139.136.254h-5.91v19.519h5.91V.253ZM164.569.254v5.039h-8.492v14.48h-5.911V5.293h-8.5V.253h22.903ZM173.773.254l6.38 7.847 6.38-7.847h7.57l-11.03 12.712v6.807h-5.91v-6.807L166.168.254h7.605Z" fill="#64656A" />
	</g>
	<defs>
		
			<path fill="#fff" d="M0 0h194v20H0z" />
		
	</defs>
</svg>
				</a>
				<p class="footer__copyright eyebrow">
											&copy; 2025 Volexity Inc. All Rights Reserved.									</p>
			</div>

			<div class="footer__menu footer__menu--primary">
				<ul id="menu-footer-menu" class="menu-footer menu-footer--primary"><li class=' menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children'><h2 class="eyebrow">About</h2>
<ul class="sub-menu">
<li class=' menu-item menu-item-type-post_type menu-item-object-page'><a href="https://www.volexity.com/company/about-us/">About</a></li>
<li class=' menu-item menu-item-type-post_type menu-item-object-page'><a href="https://www.volexity.com/blog/">Blog</a></li>
<li class=' menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy'><a href="https://www.volexity.com/privacy-policy/">Privacy Policy</a></li>
</ul>
</li>
<li class=' menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children'><h2 class="eyebrow">Solutions</h2>
<ul class="sub-menu">
<li class=' menu-item menu-item-type-post_type menu-item-object-page'><a href="https://www.volexity.com/products-overview/">Products</a></li>
<li class=' menu-item menu-item-type-post_type menu-item-object-page'><a href="https://www.volexity.com/services-overview/">Services</a></li>
</ul>
</li>
</ul>			</div>

			<div class="footer__contact">
				<h2 class="eyebrow">Contact</h2>
				<div class="footer__address body--semi-bold d-flex flex-column">
					<p>11654 Plaza America Dr. #774<br />
Reston, VA 20190</p>
<p>+1 (888) 825-1975</p>
				</div>
			</div>

			<div class="footer__menu footer__menu--secondary">
									<h2 class="eyebrow">Connect</h2>
					<div class="footer__buttons">
													<a class="btn btn--icon" href="https://www.linkedin.com/company/volexity"
								target="_blank"
								aria-label="LinkedIn">
								<span class="fa-classic fa-brands fa-linkedin-in" aria-hidden="true"></span>
							</a>
													<a class="btn btn--icon" href="https://bsky.app/profile/did:plc:z6yenb4npk2aibtsqkerghbo"
								target="_blank"
								aria-label="BlueSky">
								<span class="fa-classic fa-brands fa-bluesky" aria-hidden="true"></span>
							</a>
													<a class="btn btn--icon" href="https://infosec.exchange/@volexity"
								target="_blank"
								aria-label="Mastadon">
								<span class="fa-classic fa-brands fa-mastodon" aria-hidden="true"></span>
							</a>
													<a class="btn btn--icon" href="https://x.com/volexity"
								target="_blank"
								aria-label="Twitter (X)">
								<span class="fa-classic fa-brands fa-x-twitter" aria-hidden="true"></span>
							</a>
													<a class="btn btn--icon" href="https://www.facebook.com/volexity"
								target="_blank"
								aria-label="Facebook">
								<span class="fa-classic fa-brands fa-facebook-f" aria-hidden="true"></span>
							</a>
											</div>
							</div>
		</div>
	</div>
</footer>
<div class="mgpb-gdpr mgpb-gdpr--hidden">
	<div class="mgpb-gdpr__banner">
		<div class="mgpb-gdpr__content">
			<div class="mgpb-gdpr__message wysiwyg">
				<p>This Website uses cookies, which are necessary to its functioning and required to achieve the purposes illustrated in our <a href="https://www.volexity.com/privacy-policy/">cookie policy</a>. By clicking the button, you consent to our use of cookies.</p>
			</div>
			<div class="mgpb-gdpr__buttons">
				<button class="mgpb-gdpr-accept btn btn--primary">
					<span class="icon icon-check" aria-hidden="true"></span>
					<span>Agree &amp; Close</span>
				</button>
				<button class="mgpb-gdpr-reject btn btn--secondary">
					<span class="icon icon-multiply" aria-hidden="true"></span>
					<span class="sr-only">Decline</span>
				</button>
			</div>
		</div>
	</div>
</div>
		<script>
		( function ( body ) {
			'use strict';
			body.className = body.className.replace( /\btribe-no-js\b/, 'tribe-js' );
		} )( document.body );
		</script>
		<script> /* <![CDATA[ */var tribe_l10n_datatables = {"aria":{"sort_ascending":": activate to sort column ascending","sort_descending":": activate to sort column descending"},"length_menu":"Show _MENU_ entries","empty_table":"No data available in table","info":"Showing _START_ to _END_ of _TOTAL_ entries","info_empty":"Showing 0 to 0 of 0 entries","info_filtered":"(filtered from _MAX_ total entries)","zero_records":"No matching records found","search":"Search:","all_selected_text":"All items on this page were selected. ","select_all_link":"Select all pages","clear_selection":"Clear Selection.","pagination":{"all":"All","next":"Next","previous":"Previous"},"select":{"rows":{"0":"","_":": Selected %d rows","1":": Selected 1 row"}},"datepicker":{"dayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"dayNamesShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dayNamesMin":["S","M","T","W","T","F","S"],"monthNames":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthNamesShort":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthNamesMin":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"nextText":"Next","prevText":"Prev","currentText":"Today","closeText":"Done","today":"Today","clear":"Clear"}};/* ]]> */ </script><script type="text/javascript" src="https://www.volexity.com/wp-includes/js/dist/dom-ready.min.js?ver=f77871ff7694fffea381" id="wp-dom-ready-js"></script>
<script type="text/javascript" id="theme-scripts-js-extra">
/* <![CDATA[ */
var urls = {"base":"https:\/\/www.volexity.com","theme":"https:\/\/www.volexity.com\/wp-content\/themes\/volexity","ajax":"https:\/\/www.volexity.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" async="async" src="https://www.volexity.com/wp-content/themes/volexity/dist/scripts/theme-scripts.min.js?ver=1748968454" id="theme-scripts-js"></script>
<script crossorigin="anonymous" type="text/javascript" src="https://kit.fontawesome.com/5cd7e6dbda.js?ver=6.7.1" id="acffa_font-awesome-kit-js"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"95b8c66d0bbe2ab0","version":"2025.6.2","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"a029113bf02e4450b5192c2ec2fd2700","b":1}' crossorigin="anonymous"></script>
</body>
</html>
