<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="canonical" href="https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/"><title>BlackLotus UEFI bootkit: Myth confirmed</title><meta content="article" property="og:type"><meta content="BlackLotus UEFI bootkit: Myth confirmed" property="og:title"><meta content="https://web-assets.esetstatic.com/wls/2023/03/blacklotus-uefi-bootkit.jpg" property="og:image"><meta content="https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/" property="og:url"><meta content="ESET researchers are the first to publish an analysis of BlackLotus, the first in-the-wild UEFI bootkit capable of bypassing UEFI Secure Boot." property="og:description"><meta name="robots" content="index, follow, max-image-preview:large, max-video-preview:-1"><meta name="description" content="ESET researchers are the first to publish an analysis of BlackLotus, the first in-the-wild UEFI bootkit capable of bypassing UEFI Secure Boot."><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@welivesecurity"><meta name="twitter:description" content="The first in-the-wild UEFI bootkit bypassing UEFI Secure Boot on fully updated UEFI systems is now a reality"><meta name="twitter:title" content="BlackLotus UEFI bootkit: Myth confirmed"><meta name="twitter:image" content="https://web-assets.esetstatic.com/wls/2023/03/blacklotus-uefi-bootkit.jpg"><meta name="twitter:url" content="https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/">
    
    <!-- Preloading resources -->
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-BookLF-405f3258.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-BoldLF-31f4bc72.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-DemiLF-8885b886.woff" as="font" type="font/woff" crossorigin>
            <link rel="preload" href="https://web-assets.esetstatic.com/tn/-x266/wls/2023/03/blacklotus-uefi-bootkit.jpg" as="image" media="(max-width: 768px)">
        <link rel="preload" href="https://web-assets.esetstatic.com/tn/-x425/wls/2023/03/blacklotus-uefi-bootkit.jpg" as="image" media="(min-width: 768.1px)">
                <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/article-header-4f98b0a2.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/article-header-4f98b0a2.js"></script>
    <script>
    window.addEventListener('pageLoaded', () => {
        window.dispatchEvent(new CustomEvent('postPageViewed', {
            detail: {
                'id': 6693,
                'publicationId': 12716,
                'name': 'BlackLotus UEFI bootkit: Myth confirmed',
                'author': 'Martin Smol√°r',
                'category': 'ESET Research',
                'section': null,
                'branch': 'en',
                'date': '2023/03/01'
            }
        }));
    });
    </script>

    <!-- Google Tag Manager -->
    <script type="module">
    window.addEventListener("pageLoaded", () => {
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-PMDGSM');
    });
    </script>
    <!-- End Google Tag Manager -->

    <script type="module">
    window.dispatchEvent(new CustomEvent("pageLoaded"));
    </script>

    <!-- Styles -->
    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/app-c4cc4fd9.css" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/app-c4cc4fd9.css" />
    <!-- Others -->
            <script>
            window.$current_language = JSON.parse('{"id":1,"code":"en","name":"English","is_pblic":true,"is_active":true,"is_default":true,"is_rtl":false}');
        </script>
    
<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"true","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"SJ-93bfff46-6f26-459e-8a50-70f86133c22e","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch","rua.ceh":"false","rua.ueh":"false","rua.ieh.st":"0"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n="true"=="true"?1:0,t="",a="gsp7maqximq4o2fvcjrq-f-dd012c1e0-clientnsv4-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"39","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":1,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"21ac92fb","ak.r":44740,"ak.a2":n,"ak.m":"dscr","ak.n":"ff","ak.bpcip":"52.159.246.0","ak.cport":50194,"ak.gh":"23.209.85.71","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.0rtt.ed":"","ak.csrc":"-","ak.acc":"bbr","ak.t":"1756697187","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==2gpL8wb3RCIDRmb2yiECfeg5OruPz/54hC2cgnTGa0tnS55dvkTHpzYo/5UJU1Y67vTyuFJn9nUBHroOYaWfWLQ75qkfLzU7v1/a9MfVHMjIlIA4a/w6HD42NeqrWcXTToxRVc0Uobr1FDQuF9tLk+NEhmo/Yx3tU8OqUlHymyS+hrHeHgbMMOgzrEhGTrMRLNOpM+kw/W/I483o/jGR7UW6pZa1Yd8ppkbMEAwnlOdtjQcrXyl2sfUCqo57zNlHaInuUP9BuMttTHOJGsfwHWAHaySLEv3NCWsponbEKBWu7IktXqB00I83b2BM5CGV0eMVPU5jGZ2+/520eSJmZTwJZED2UOmTOvXadSi8oedgAGlgNnCq/Yrh68Dh4wZZNXCIAdV45tHPxrkp+1/T4kizI5/MnUTB3Q8FZPO7XsU=","ak.pv":"20","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.0rtt.ed","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src=https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <div id="app" >
        <!-- navbar -->
        <header id="wls-nav-header" class="wls-header navbar sticky-top navbar-expand-lg has-shadow">
  <div class="container first-line">
    <a class="header-brand" href="/en/" title="WeLiveSecurity">
      <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>    </a>
    <p>
      Award-winning news, views, and insight from the ESET security community
    </p>
    <div class="ms-auto">
      <div class="language-picker dropdown"><div class="language-picker-wrapper"><button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown"aria-expanded="false">English</button><ul class="dropdown-menu dropdown-menu-center"><a class="dropdown-item" href="/es/" title="Espa√±ol">Espa√±ol</a><a class="dropdown-item" href="/de/" title="Deutsch">Deutsch</a><a class="dropdown-item" href="/pt/" title="Portugu√™s">Portugu√™s</a><a class="dropdown-item" href="/fr/" title="Fran√ßais">Fran√ßais</a></ul></div></div>    </div>
  </div>
  <div class="second-line">
    <div class="container">
      <div class="navbar-header">
        <a class="header-brand" href="/en/" title="WeLiveSecurity">
          <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>        </a>
        <div class="me-2">
          <button class=" navbar-toggler button-hamburger collapsed d-flex d-lg-none flex-column justify-content-around" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="This is toggle button"><span class="toggler-icon top-bar"></span><span class="toggler-icon middle-bar"></span><span class="toggler-icon bottom-bar"></span></button>        </div>
      </div>

      <nav id="navbarNavDropdown" class="collapse navbar-collapse page-navbar"><ul class="navbar-nav"><li class="nav-item d-lg-none"><div class="search-bar-input"><search-bar-component placeholder="Search WeLiveSecurity"class="search-bar-component-wrapper"></search-bar-component></div></li><li class="nav-item"><a class="nav-link" href="/en/tips-advice/" title="TIPS &amp; ADVICE"><span class="">TIPS &amp; ADVICE</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item"><a class="nav-link" href="/en/business-security/" title="BUSINESS SECURITY"><span class="">BUSINESS SECURITY</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="ESET RESEARCH" role="button" data-bs-toggle="dropdown"aria-expanded="false">ESET RESEARCH</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/about-eset-research/" title="About ESET Research"><span class="">About ESET Research</span></a><a class="dropdown-item" href="/en/eset-research/" title="Blogposts"><span class="">Blogposts</span></a><a class="dropdown-item" href="/en/podcasts/" title="Podcasts"><span class="">Podcasts</span></a><a class="dropdown-item" href="/en/white-papers/" title="White papers"><span class="">White papers</span></a><a class="dropdown-item" href="/en/threat-reports/" title="Threat reports"><span class="">Threat reports</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item"><a class="nav-link" href="/en/we-live-science/" title="WeLiveScience"><span class="button-link">WeLiveScience</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="FEATURED" role="button" data-bs-toggle="dropdown"aria-expanded="false">FEATURED</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/ukraine-crisis-digital-security-resource-center/" title="Ukraine crisis ‚Äì Digital security resource center"><span class="">Ukraine crisis ‚Äì Digital security resource center</span></a><a class="dropdown-item" href="/en/we-live-progress/" title="WeLiveProgress"><span class="">WeLiveProgress</span></a><a class="dropdown-item" href="/en/covid-19/" title="COVID-19"><span class="">COVID-19</span></a><a class="dropdown-item" href="/en/resources/" title="Resources"><span class="">Resources</span></a><a class="dropdown-item" href="/en/videos/" title="Videos"><span class="">Videos</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="TOPICS" role="button" data-bs-toggle="dropdown"aria-expanded="false">TOPICS</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/cybersecurity/" title="Digital Security"><span class="">Digital Security</span></a><a class="dropdown-item" href="/en/scams/" title="Scams"><span class="">Scams</span></a><a class="dropdown-item" href="/en/how-to/" title="How to"><span class="">How to</span></a><a class="dropdown-item" href="/en/privacy/" title="Privacy"><span class="">Privacy</span></a><a class="dropdown-item" href="/en/cybercrime/" title="Cybercrime"><span class="">Cybercrime</span></a><a class="dropdown-item" href="/en/kids-online/" title="Kids online"><span class="">Kids online</span></a><a class="dropdown-item" href="/en/social-media/" title="Social media"><span class="">Social media</span></a><a class="dropdown-item" href="/en/internet-of-things/" title="Internet of Things"><span class="">Internet of Things</span></a><a class="dropdown-item" href="/en/malware/" title="Malware"><span class="">Malware</span></a><a class="dropdown-item" href="/en/ransomware/" title="Ransomware"><span class="">Ransomware</span></a><a class="dropdown-item" href="/en/secure-coding/" title="Secure coding"><span class="">Secure coding</span></a><a class="dropdown-item" href="/en/mobile-security/" title="Mobile security"><span class="">Mobile security</span></a><a class="dropdown-item" href="/en/critical-infrastructure/" title="Critical infrastructure"><span class="">Critical infrastructure</span></a><a class="dropdown-item" href="/en/about-eset-research/" title="Threat research"><span class="">Threat research</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="ABOUT US" role="button" data-bs-toggle="dropdown"aria-expanded="false">ABOUT US</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/company/about-us/" title="About WeLiveSecurity"><span class="">About WeLiveSecurity</span></a><a class="dropdown-item" href="/en/our-experts/" title="Our Experts"><span class="">Our Experts</span></a><a class="dropdown-item" href="/en/company/contact-us/" title="Contact Us"><span class="">Contact Us</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown d-lg-none"><a class="nav-link dropdown-toggle languages" href="/en/" title="English" role="button"data-bs-toggle="dropdown" aria-expanded="false">English</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/es/" title="Espa√±ol">Espa√±ol</a><a class="dropdown-item" href="/de/" title="Deutsch">Deutsch</a><a class="dropdown-item" href="/pt/" title="Portugu√™s">Portugu√™s</a><a class="dropdown-item" href="/fr/" title="Fran√ßais">Fran√ßais</a></div></div></li><li class="nav-item ms-auto d-none d-lg-block"><button class="nav-link ms-auto search-button-close" type="button" data-bs-toggle="collapse"data-bs-target=".search-bar-wrapper" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9485 19.9001" fill="#424D56"><path d="m19.5429,17.9473l-4.86-4.852c2.7034-3.5802,1.9927-8.674-1.5874-11.3774C9.5153-.9856,4.4214-.2749,1.718,3.3053-.9854,6.8854-.2747,11.9793,3.3055,14.6827c1.4094,1.0643,3.1273,1.6402,4.8934,1.6406,1.7749.0083,3.5023-.5739,4.91-1.655l4.883,4.829c.207.2113.4912.329.787.326.2948-.0022.5771-.1191.787-.326.4163-.4365.406-1.126-.023-1.55Zm-11.316-3.821c-3.2811-.0017-5.9396-2.663-5.9378-5.9442.0017-3.2811,2.663-5.9396,5.9442-5.9378,1.5726.0008,3.0806.6251,4.1937,1.736,1.1259,1.1056,1.7528,2.6221,1.736,4.2-.0007,1.5744-.6249,3.0845-1.736,4.2-1.1067,1.1254-2.6216,1.7552-4.2,1.746Z" /></svg></button></li></ul><div class="search-bar"><div class="collapse search-bar-wrapper"><div class="search-bar-input"><search-bar-component placeholder="Search WeLiveSecurity"class="search-bar-component-wrapper"></search-bar-component><button class="nav-link search-button-close" type="button" data-bs-toggle="collapse"data-bs-target=".search-bar-wrapper" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.1065 18.0626"><polygon points="10.6883 9.0363 17.4683 15.8163 15.8383 17.4463 9.0583 10.6663 2.2683 17.4463 .6383 15.8163 7.4283 9.0363 .6383 2.2463 2.2683 .6163 9.0583 7.4063 15.8383 .6163 17.4683 2.2463 10.6883 9.0363" /></svg></button></div></div></div></nav>    </div>
  </div>
  <div class="additional-info d-none">
    <div class="container">
      <p>
        Award-winning news, views, and insight from the ESET security community
      </p>
    </div>
  </div>
</header>        <!-- main content -->
        <div id="main">
                
    <div class="container article-page py-5">
        <div class="row">
            <div class="col col-lg-8 pe-lg-0">
                                    <div class="article-header">
    <div class="article-tags mb-2 dark big"><p class="article-tag text-capitalize">ESET Research</p></div>    <h1 class="page-headline">BlackLotus UEFI bootkit: Myth confirmed</h1>    <p class="sub-title">The first in-the-wild UEFI bootkit bypassing UEFI Secure Boot on fully updated UEFI systems is now a reality</p>
    
    <div class="article-authors d-flex flex-wrap"><div class="article-author d-flex"><a href="/en/our-experts/martin-smolar/" title="Martin Smol√°r"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2020/05/martin.smolar-1.jpg" media="(max-width: 768px)" /><img class="author-image me-3"  src="https://web-assets.esetstatic.com/tn/-x45/wls/2020/05/martin.smolar-1.jpg" alt="Martin Smol√°r"  /></picture></a><div class="author-text"><p><a href="/en/our-experts/martin-smolar/" title="Martin Smol√°r"><b>Martin Smol√°r</b></a></p></div></div></div>
    <p class="article-info mb-5">
        <span>01 Mar 2023</span>
        <span class="d-none d-lg-inline">&nbsp;&bull;&nbsp;</span>
        <span class="d-inline d-lg-none">, </span>
        <span>40 min. read</span>
    </p>

    <div class="hero-image-container">
        <picture><source srcset="https://web-assets.esetstatic.com/tn/-x266/wls/2023/03/blacklotus-uefi-bootkit.jpg" media="(max-width: 768px)" /><source srcset="https://web-assets.esetstatic.com/tn/-x425/wls/2023/03/blacklotus-uefi-bootkit.jpg" media="(max-width: 1120px)" /><img class="hero-image"  src="https://web-assets.esetstatic.com/tn/-x700/wls/2023/03/blacklotus-uefi-bootkit.jpg" alt="BlackLotus UEFI bootkit: Myth confirmed"  /></picture>    </div>
</div>
                    <div class="article-body">
    <p>The number of UEFI vulnerabilities discovered in recent years and the failures in patching them or revoking vulnerable binaries within a reasonable time window hasn&rsquo;t gone unnoticed by threat actors. As a result, the first publicly known UEFI bootkit bypassing the essential platform security feature &ndash; UEFI Secure Boot &ndash; is now a reality. In this blogpost we present the first public analysis of this UEFI bootkit, which is capable of running on even fully-up-to-date Windows 11 systems with UEFI Secure Boot enabled. Functionality of the bootkit and its individual features leads us to believe that we are dealing with a bootkit known as <strong>BlackLotus</strong>, <a href="https://www.bleepingcomputer.com/news/security/malware-dev-claims-to-sell-new-blacklotus-windows-uefi-bootkit/" target="_blank" rel="noopener">the UEFI bootkit being sold on hacking forums</a> for $5,000 since at least October 2022.</p>
<p>UEFI bootkits are very powerful threats, having full control over the OS boot process and thus capable of disabling various OS security mechanisms and deploying their own kernel-mode or user-mode payloads in early OS startup stages. This allows them to operate very stealthily and with high privileges. So far, only a few have been discovered in the wild and publicly described (e.g., multiple <a href="https://twitter.com/ESETresearch/status/1275770256389222400?s=20" target="_blank" rel="noopener">malicious EFI samples</a> we discovered in 2020, or fully featured UEFI bootkits such as our discovery last year &ndash; the <a href="https://www.welivesecurity.com/2021/10/05/uefi-threats-moving-esp-introducing-especter-bootkit/" target="_blank" rel="noopener">ESPecter bootkit</a> &ndash; or the <a href="https://securelist.com/finspy-unseen-findings/104322/" target="_blank" rel="noopener">FinSpy bootkit</a> discovered by researchers from Kaspersky).</p>
<p>UEFI bootkits may lose on stealthiness when compared to firmware implants &ndash; such as <a href="https://www.welivesecurity.com/2018/09/27/lojax-first-uefi-rootkit-found-wild-courtesy-sednit-group/">LoJax</a>; the first in-the-wild UEFI firmware implant, discovered by our team in 2018 &ndash; as bootkits are located on an easily accessible FAT32 disk partition. However, running as a bootloader gives them almost the same capabilities as firmware implants, but without having to overcome the multilevel SPI flash defenses, such as the BWE, BLE, and PRx protection bits, or the protections provided by hardware (like Intel Boot Guard). Sure, UEFI Secure Boot stands in the way of UEFI bootkits, but there are a non-negligible number of known vulnerabilities that allow bypassing this essential security mechanism. And the worst of this is that some of them are still easily exploitable on up-to-date systems even at the time of this writing &ndash; including the one exploited by BlackLotus.</p>
<p>Our investigation started with a few hits on what turned out to be the BlackLotus user-mode component &ndash; an HTTP downloader &ndash; in our telemetry late in 2022. After an initial assessment, code patterns found in the samples brought us to the discovery of six BlackLotus installers (both on VirusTotal and in our own telemetry). This allowed us to explore the whole execution chain and to realize that what we were dealing with here is not just regular malware.</p>
<p>Following are the key points about BlackLotus and a timeline summarizing the series of events related to it:</p>
<ul>
<li>It&rsquo;s capable of running on the latest, fully patched Windows 11 systems with UEFI Secure Boot enabled.</li>
<li>It exploits a more than one year old vulnerability (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21894" target="_blank" rel="noopener">CVE-2022-21894</a>) to bypass UEFI Secure Boot and set up persistence for the bootkit. This is the first publicly known, in-the-wild abuse of this vulnerability.</li>
<li>Although the vulnerability was fixed in Microsoft&rsquo;s January 2022 update, its exploitation is still possible as the affected, <strong>validly signed</strong> binaries have still not been added to the <a href="https://uefi.org/revocationlistfile" target="_blank" rel="noopener">UEFI revocation list</a>. BlackLotus takes advantage of this, bringing its own copies of legitimate &ndash; but vulnerable &ndash; binaries to the system in order to exploit the vulnerability.</li>
<li>It&rsquo;s capable of disabling OS security mechanisms such as BitLocker, HVCI, and Windows Defender.</li>
<li>Once installed, the bootkit&rsquo;s main goal is to deploy a kernel driver (which, among other things, protects the bootkit from removal), and an HTTP downloader responsible for communication with the C&amp;C and capable of loading additional user-mode or kernel-mode payloads.</li>
<li>BlackLotus has been advertised and sold on underground forums since at least October 6<sup>th</sup>, 2022. In this blogpost, we present evidence that the bootkit is real, and the advertisement is not merely a scam.</li>
<li>Interestingly, some of the BlackLotus installers we have analyzed do not proceed with bootkit installation if the compromised host uses one of the following locales:
<ul>
<li>Romanian (Moldova), ro-MD</li>
<li>Russian (Moldova), ru-MD</li>
<li>Russian (Russia), ru-RU</li>
<li>Ukrainian (Ukraine) , uk-UA</li>
<li>Belarusian (Belarus), be-BY</li>
<li>Armenian (Armenia), hy-AM</li>
<li>Kazakh (Kazakhstan), kk-KZ</li>
</ul>
</li>
</ul>
<p>The timeline of individual events related to BlackLotus is shown in Figure 1.</p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-1.-The-timeline-of-individual-events-related-to-BlackLotus-UEFI-bootkit.png"><img class="wp-image-169940 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-1.-The-timeline-of-individual-events-related-to-BlackLotus-UEFI-bootkit.png" alt="" width="2000" height="1023" /></a>
<p class="caption-text"><em>Figure 1. Timeline of major events related to BlackLotus UEFI bootkit</em></p>
</div>
<p>As already mentioned, the bootkit has been sold on underground forums since at least October 6<sup>th</sup>, 2022. At this point, we have not been able to identify, from our telemetry, the exact distribution channel used to deploy the bootkit to victims. The low number of BlackLotus samples we have been able to obtain, both from public sources and our telemetry, leads us to believe that not many threat actors have started using it yet. But until the revocation of the vulnerable bootloaders that BlackLotus depends on happens, we are concerned that things will change rapidly should this bootkit gets into the hands of the well-known crimeware groups, based on the bootkit&rsquo;s easy deployment and crimeware groups&rsquo; capabilities for spreading malware using their botnets.</p>
<h2><span lang="EN-US">Is this really BlackLotus?</span></h2>
<p>There are several articles or posts summarizing information about BlackLotus (<a href="https://www.theregister.com/2022/10/13/blacklotus_malware_kaspersky/" target="_blank" rel="noopener">here</a>, <a href="https://www.linkedin.com/feed/update/urn:li:share:6986711231885713408/" target="_blank" rel="noopener">here</a> and <a href="https://www.bleepingcomputer.com/news/security/malware-dev-claims-to-sell-new-blacklotus-windows-uefi-bootkit/" target="_blank" rel="noopener">here</a> and many more&hellip;), all based on the information provided by the bootkit developer on underground hacking forums. So far, no one has confirmed or disproved these claims.</p>
<p>Here is our summary of the claims from the available publications compared with what we discovered while reverse engineering the bootkit samples:</p>
<ul>
<li><strong>BlackLotus&rsquo;s advertisement on hacking forums claims that it features integrated Secure Boot bypass</strong><strong>. Adding vulnerable drivers to the UEFI revocation list is currently impossible, as the vulnerability affects hundreds of bootloaders that are still used today.&nbsp;‚úÖ</strong>
<ul>
<li>True: It exploits <a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21894" target="_blank" rel="noopener">CVE-2022-21894</a> in order to break Secure Boot and achieve persistence on UEFI-Secure-Boot-enabled systems. Vulnerable drivers it uses are still not revoked in the latest <a href="https://uefi.org/revocationlistfile" target="_blank" rel="noopener">dbx</a>,&nbsp;at the time of writing.</li>
</ul>
</li>
<li><strong>BlackLotus&rsquo;s advertisement on hacking forums claims that the bootkit has built-in Ring0/Kernel protection against removal.&nbsp;‚úÖ</strong>
<ul>
<li>True: Its kernel driver protects handles belonging to its files on the EFI System Partition (ESP) against closing. As an additional layer of protection, these handles are continuously monitored and a Blue Screen Of Death (BSOD) triggered if any of these handles are closed, as described in the <em><a href="#protecting-bootkit-files-on-the-ESP-from-removal">Protecting bootkit files on the ESP from removal</a>&nbsp;</em>section.</li>
</ul>
</li>
<li><strong>BlackLotus&rsquo;s advertisement on hacking forums claims that it comes with anti-virtual-machine (anti-VM), anti-debug, and code obfuscation features to block malware analysis attempts.&nbsp;‚úÖ</strong>
<ul>
<li>True: It contains various anti-VM, anti-debug, and obfuscation techniques to make it harder to replicate or analyze. However, we are definitely not talking about any breakthrough or advanced anti-analysis techniques here, as they can be easily overcome with little effort.</li>
</ul>
</li>
<li><strong>BlackLotus&rsquo;s advertisement on hacking forums claims that its purpose is to act as an HTTP downloader.&nbsp;‚úÖ</strong>
<ul>
<li>True: Its final component acts as an HTTP downloader, as described in the <em><a href="#http-downloader">HTTP downloader</a> </em>section</li>
</ul>
</li>
<li><strong>BlackLotus&rsquo;s advertisement on hacking forums claims that the HTTP downloader</strong><strong> runs under the SYSTEM account within a legitimate process.&nbsp;‚úÖ</strong>
<ul>
<li>True: Its HTTP downloader runs within the <span style="font-family: 'courier new', courier, monospace;">winlogon.exe</span> process context<strong>.</strong></li>
</ul>
</li>
<li><strong>BlackLotus&rsquo;s advertisement on hacking forums claims it is</strong><strong> a tiny bootkit with an on-disk size of only 80&nbsp;kB.&nbsp;‚úÖ</strong>
<ul>
<li>True: Samples we were able to obtain really are around 80&nbsp;kB.</li>
</ul>
</li>
<li><strong>BlackLotus&rsquo;s advertisement on hacking forums claims that it can</strong><strong> disable built-in Windows security protections such as HVCI, Bitlocker, Windows Defender, and bypass User Account Control (UAC).&nbsp;‚úÖ</strong>
<ul>
<li>True: It can disable <em><a href="#step-2">HVCI</a></em>, <em><a href="#blacklotus-execution-flow">Windows Defender</a></em>, <em><a href="#step-3">BitLocker</a></em>, and bypass <em><a href="#step-0">UAC</a></em>.</li>
</ul>
</li>
</ul>
<p>Based on these facts, we believe with high confidence that the bootkit we discovered in the wild is the BlackLotus UEFI bootkit.</p>
<h2>Attack overview</h2>
<p>A simplified scheme of the BlackLotus compromise chain is shown in Figure 2. It consists of three main parts:</p>
<ol>
<li>It starts with the execution of an installer (step 1 in Figure&nbsp;2), which is responsible for deploying the bootkit&rsquo;s files to the EFI System partition, disabling HVCI and BitLocker, and then rebooting the machine.</li>
<li>After the first reboot, exploitation of CVE-2022-21894 and subsequent enrollment of the attackers&rsquo; <a href="https://edk2-docs.gitbook.io/understanding-the-uefi-secure-boot-chain/additional_secure_boot_chain_implementations/machine_owner_key_mok" target="_blank" rel="noopener">Machine Owner Key</a> (MOK) occurs, to achieve persistence even on systems with UEFI Secure Boot enabled. The machine is then rebooted (steps 2&ndash;4 in Figure&nbsp;2) again.</li>
<li>In all subsequent boots, the self-signed UEFI bootkit is executed and deploys both its kernel driver and user-mode payload, the HTTP downloader. Together, these components are able to download and execute additional user-mode and driver components from the C&amp;C server and protect the bootkit against removal (steps 5&ndash;9 in Figure&nbsp;2).</li>
</ol>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-2.-BlackLotus-simplified-execution-overview.png"><img class="wp-image-169941 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-2.-BlackLotus-simplified-execution-overview.png" alt="" width="1562" height="2000" /></a>
<p class="caption-text"><em>Figure 2. BlackLotus simplified execution overview</em></p>
</div>
<h2>Interesting artifacts</h2>
<p>Even though we believe this is the BlackLotus UEFI bootkit, we did not find any reference to this name in the samples we analyzed. Instead, the code is full of references to the <a href="https://en.wikipedia.org/wiki/Higurashi_When_They_Cry" target="_blank" rel="noopener">Higurashi When They Cry</a> anime series, for example in individual component names, such as <span style="font-family: 'courier new', courier, monospace;">higurashi_installer_uac_module.dll</span> and <span style="font-family: 'courier new', courier, monospace;">higurashi_kernel.sys</span>, and also in the self-signed certificate used to sign the bootkit binary (shown in Figure&nbsp;3).</p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-3.-Self-signed-certificate-used-by-the-BlackLotus-bootkit-1.png"><img class="wp-image-170251 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-3.-Self-signed-certificate-used-by-the-BlackLotus-bootkit-1.png" alt="" width="1319" height="490" /></a>
<p class="caption-text"><em>Figure 3. Self-signed certificate used by the BlackLotus bootkit</em></p>
</div>
<p>Additionally, the code decrypts but never uses various strings containing messages from the BlackLotus author (as shown in Figure&nbsp;4 &ndash; note, that <a href="https://twitter.com/hasherezade" target="_blank" rel="noopener">hasherezade</a> is a well-known researcher and author of various malware-analysis tools), or just some random quotes from various songs, games, or series.</p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-4.-Example-of-messages-left-in-the-code-by-the-BlackLotus-author.png"><img class="wp-image-169943 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-4.-Example-of-messages-left-in-the-code-by-the-BlackLotus-author.png" alt="" width="930" height="304" /></a>
<p class="caption-text"><em>Figure 4. Example of messages left in the code by the BlackLotus author</em></p>
</div>
<h2>Installation process</h2>
<p>We start with analysis of the BlackLotus installers. The bootkit seems to be distributed in a form of installers that come in two versions &ndash; offline and online. The difference between these two is in the way they obtain legitimate (but vulnerable) Windows binaries, later used for bypassing Secure Boot.</p>
<ul>
<li>In offline versions, Windows binaries are embedded in the installer</li>
<li>In online versions, Windows binaries are downloaded directly from the Microsoft symbol store. So far, we&rsquo;ve seen the following Windows binaries being abused by the BlackLotus bootkit:
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">https://msdl.microsoft.com/download/symbols/bootmgfw.efi/7144BCD31C0000/bootmgfw.efi</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">https://msdl.microsoft.com/download/symbols/bootmgr.efi/98B063A61BC000/bootmgr.efi</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">https://msdl.microsoft.com/download/symbols/hvloader.efi/559F396411D000/hvloader.efi</span></li>
</ul>
</li>
</ul>
<p>The goal of the installer is clear &ndash; it&rsquo;s responsible for disabling Windows security features such as BitLocker disk encryption and HVCI, and for deployment of multiple files, including the malicious bootkit, to the ESP. Once finished, it reboots the compromised machine to let the dropped files do their job &ndash; to make sure the self-signed UEFI bootkit will be silently executed on every system start, regardless of UEFI Secure Boot protection status.</p>
<h3><a id="step-0"></a>Step 0 &ndash; Initialization and (potential) elevation</h3>
<p>When the installer is executed, it checks whether it has enough privileges (at least admin required) to deploy the rest of the files to the ESP and perform other actions requiring elevated process &ndash; like turning off HVCI or disabling BitLocker. If it&rsquo;s not the case, it tries to elevate by executing the installer again by using the UAC bypass method described in detail here: <a href="https://github.com/hfiref0x/UACME/issues/111" target="_blank" rel="noopener">UAC bypass via Program Compatibility assistant</a>.</p>
<p>With the necessary privileges, it continues, checking the UEFI Secure Boot status by reading the value of the SecureBoot UEFI variable using an available Windows API function, and determining the Windows version by directly accessing the <a href="https://www.geoffchappell.com/studies/windows/km/ntoskrnl/inc/api/ntexapi_x/kuser_shared_data/index.htm" target="_blank" rel="noopener">KUSER_SHARED_DATA</a> structure fields <span style="font-family: 'courier new', courier, monospace;">NtMajorVersion</span> and <span style="font-family: 'courier new', courier, monospace;">NtMinorVersion</span> in memory. It does so to decide whether or not bypassing UEFI Secure Boot is necessary to deploy the bootkit on the victim&rsquo;s system (since Secure Boot support was first added in Windows 8 and might not be enabled on any given machine).</p>
<p>Before proceeding to the next steps, it renames the legitimate Windows Boot Manager (<span style="font-family: 'courier new', courier, monospace;">bootmgfw.efi</span>) binary located in the <span style="font-family: 'courier new', courier, monospace;">ESP:\EFI\Microsoft\Boot\</span> directory to <span style="font-family: 'courier new', courier, monospace;">winload.efi</span>. This renamed<span style="font-family: 'courier new', courier, monospace;"> bootmgfw.efi</span> backup is later used by the bootkit to launch the OS, or to recover the original boot chain if the &ldquo;uninstall&rdquo; command is received from the C&amp;C server &ndash; more in the<em> <a href="#cc-communication">C&amp;C communication</a> </em>section.</p>
<h3>Step 1 &ndash; Deploying files</h3>
<p>If UEFI Secure Boot is enabled, the installer proceeds with dropping multiple files into the <span style="font-family: 'courier new', courier, monospace;">ESP:/EFI/Microsoft/Boot/</span> and <span style="font-family: 'courier new', courier, monospace;">ESP:/system32/</span> directories. While the former is a standard directory used by Windows, the latter is a custom folder created by the installer.</p>
<p>A list of files dropped by the installer with a short explanation of the role of each file in the execution chain is provided in Table 1. We will explain in detail how the execution chain works later; now just note that several legitimate Microsoft-signed files are dropped along with the malicious ones.</p>
<p><em>Table 1. Files deployed by the BlackLotus installer on systems with UEFI Secure Boot enabled</em></p>
<p><table>
<thead>
<tr>
<th>Folder</th>
<th>Filename</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="5"><span style="font-family: courier new, courier, monospace;">ESP:\EFI\Microsoft\Boot</span></td>
<td><span style="font-family: courier new, courier, monospace;">grubx64.efi</span></td>
<td>BlackLotus bootkit, malicious self-signed UEFI application.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">bootload.efi</span></td>
<td>Legitimate Microsoft-signed <span style="font-family: courier new, courier, monospace;">shim</span> binary (temporary name, later replaces <span style="font-family: courier new, courier, monospace;">bootmgfw.efi</span> after <a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21894" target="_blank" rel="noopener">CVE-2022-21894</a> exploitation).</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">bootmgfw.efi</span></td>
<td>Legitimate, but vulnerable (<a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21894" target="_blank" rel="noopener">CVE-2022-21894</a>) Windows Boot Manager binary, embedded in the installer or downloaded directly from the Microsoft Symbol Store.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">BCD</span></td>
<td>Attackers&rsquo; custom <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/boot-options-in-windows" target="_blank" rel="noopener">Boot Configuration Data</a> (BCD) store used in <a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21894" target="_blank" rel="noopener">CVE-2022-21894</a> exploitation chain.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">BCDR</span></td>
<td>Backup of victim&rsquo;s original BCD store.</td>
</tr>
<tr>
<td rowspan="5"><span style="font-family: courier new, courier, monospace;">ESP:\system32</span></td>
<td><span style="font-family: courier new, courier, monospace;">hvloader.efi</span></td>
<td>Legitimate, but vulnerable (<a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21894" target="_blank" rel="noopener">CVE-2022-21894</a>) Windows Hypervisor Loader binary, embedded inside an installer or downloaded directly from the Microsoft Symbol Store.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">bootmgr.efi</span></td>
<td>Legitimate, but vulnerable (<a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21894" target="_blank" rel="noopener">CVE-2022-21894</a>) Windows Boot Manager binary, embedded inside an installer or downloaded directly from the Microsoft Symbol Store.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">mcupdate_AuthenticAMD.dll</span></td>
<td>Malicious self-signed native PE binary. This file is executed by the <span style="font-family: courier new, courier, monospace;">hvloader.efi</span> after successful <a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21894" target="_blank" rel="noopener">CVE-2022-21894</a> exploitation (on systems using an AMD CPU).</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">mcupdate_GenuineIntel.dll</span></td>
<td>Malicious self-signed native PE binary. This file is executed by the <span style="font-family: courier new, courier, monospace;">hvloader.efi</span> after successful <a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21894" target="_blank" rel="noopener">CVE-2022-21894 </a>exploitation (on systems using an Intel CPU).</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">BCD</span></td>
<td>Attackers&rsquo; custom BCD used in <a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21894" target="_blank" rel="noopener">CVE-2022-21894</a> exploitation chain.</td>
</tr>
</tbody>
</table></p>
<p>In cases when the victim is running a Windows version not supporting UEFI Secure Boot, or in the case when it&rsquo;s disabled, the deployment is quite straightforward. The only thing that is needed to deploy the malicious bootkit is to replace the existing Windows Boot Manager (<span style="font-family: 'courier new', courier, monospace;">bootmgfw.efi</span>) binary in the <span style="font-family: 'courier new', courier, monospace;">ESP:\EFI\Microsoft\Boot\</span> directory, with the attackers&rsquo; own self-signed malicious UEFI application. Since UEFI Secure Boot is disabled (and thus no integrity verification is performed during the boot), exploitation is not necessary and the UEFI firmware simply executes the malicious boot manager without causing any security violations.</p>
<h3><a id="step-2"></a>Step 2 &ndash; Disabling Hypervisor-protected Code Integrity (HVCI)</h3>
<p>To be able to run custom unsigned kernel code later, the installer has to make sure that <a href="https://learn.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-vbs" target="_blank" rel="noopener">HVCI</a> is disabled on the system. One of our ESET colleagues wrote a very informative blogpost on this topic in 2022 (<a href="https://www.welivesecurity.com/2022/01/11/signed-kernel-drivers-unguarded-gateway-windows-core/" target="_blank" rel="noopener">Signed kernel drivers &ndash; Unguarded gateway to Windows&rsquo; core</a>):</p>
<p style="margin-left: 5%; margin-right: 5%;"><em>Virtualization-based security (VBS) offers several protection features with the most prominent one being Hypervisor-Protected Code Integrity (HVCI), which also comes as a standalone feature. HVCI enforces code integrity in the kernel and allows only signed code to be executed. It effectively prevents vulnerable drivers from being abused to execute unsigned kernel code or load malicious drivers (regardless of the exploitation method used) and it seems that malware abusing vulnerable drivers to load malicious code was one of the <a href="https://www.microsoft.com/en-us/security/blog/2021/01/11/new-surface-pcs-enable-virtualization-based-security-vbs-by-default-to-empower-customers-to-do-more-securely/" target="_blank" rel="noopener">main motivations behind Microsoft implementing this feature</a>.</em></p>
<p>As shown in Figure 5, to disable this feature, the installer sets the Enabled registry value under the <span style="font-family: 'courier new', courier, monospace;">HypervisorEnforcedCodeIntegrity</span> registry key to zero.</p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-5.-Hex-Rays-decompiled-code-of-BlackLotus-installer-function-responsible-for-disabling-HVCI.png"><img class="wp-image-169944 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-5.-Hex-Rays-decompiled-code-of-BlackLotus-installer-function-responsible-for-disabling-HVCI.png" alt="" width="1463" height="690" /></a>
<p class="caption-text"><em>Figure 5. Hex-Rays decompiled code of BlackLotus installer function responsible for disabling HVCI</em></p>
</div>
<h3><a id="step-3"></a>Step 3 &ndash; Disabling BitLocker</h3>
<p>The next feature deactivated by the installer is <a href="https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-overview" target="_blank" rel="noopener">BitLocker Drive Encryption</a>. The reason for this is that BitLocker can be used in a combination with <a href="https://learn.microsoft.com/en-us/windows/security/information-protection/tpm/trusted-platform-module-overview" target="_blank" rel="noopener">Trusted Platform Module (TPM)</a> to ensure that various boot files and configurations, including Secure Boot, haven&rsquo;t been tampered with since BitLocker drive encryption was configured on the system. Considering that the installer modifies the Windows boot chain on a compromised machine, keeping BitLocker on for systems with TPM support would lead to a BitLocker recovery screen at the next bootup and would tip the victim off that the system had been compromised.</p>
<p>To disable this protection, the BlackLotus installer:</p>
<ul>
<li>walks through all volumes under the <span style="font-family: 'courier new', courier, monospace;">Root\CIMV2\Security\MicrosoftVolumeEncryption</span> WMI namespace and checks their protection status by calling the <span style="font-family: 'courier new', courier, monospace;">GetProtectionStatus</span> method of the <span style="font-family: 'courier new', courier, monospace;">Win32_EncryptableVolume</span> WMI class</li>
<li>for those protected by BitLocker, it calls the <span style="font-family: 'courier new', courier, monospace;">DisableKeyProtectors</span> method with the <span style="font-family: 'courier new', courier, monospace;">DisableCount</span> parameter set to zero, meaning that the protection will be suspended until it is manually enabled</li>
</ul>
<p>With the necessary protections disabled and all files deployed, the installer registers itself to be deleted during the next system restart and reboots the machine to proceed to the exploitation of CVE-2022-21894.</p>
<h2>Bypassing Secure Boot and establishing persistence</h2>
<p>In this part, we take a closer look at how BlackLotus achieves persistence on systems with UEFI Secure Boot enabled. As the execution chain we are about to describe is quite complex, we will first explain basic principles and then dig deeper into technical details.</p>
<p>In a nutshell, this process consists of two key steps:</p>
<ol>
<li>Exploiting CVE-2022-21894 to bypass the Secure Boot feature and install the bootkit. This allows arbitrary code execution in early boot phases, where the platform is still owned by firmware and UEFI Boot Services functions are still available. This allows attackers to do many things that they should not be able to do on a machine with UEFI Secure Boot enabled without having physical access to it, such as modifying Boot-services-only NVRAM variables. And this is what attackers take advantage of to set up persistence for the bootkit in the next step. More information about exploitation can be found in the <a href="#exploiting-cve-2022-21894"><em>Exploiting CVE-2022-21894</em></a> section.</li>
<li>Setting persistence by writing its own MOK to the <span style="font-family: 'courier new', courier, monospace;">MokList</span>, Boot-services-only NVRAM variable. By doing this, it can use a legitimate Microsoft-signed <span style="font-family: 'courier new', courier, monospace;">shim</span> for loading its self-signed (signed by the private key belonging to the key written to <span style="font-family: 'courier new', courier, monospace;">MokList</span>) UEFI bootkit instead of exploiting the vulnerability on every boot. More about this in the<em>&nbsp;<a href="#bootkit-persistence">Bootkit persistence</a> </em>section.</li>
</ol>
<p>To make the detailed analysis in the next two sections easier, we will follow the steps shown in the execution diagram, Figure 6.</p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-6.-Bypassing-Secure-Boot-and-setting-up-persistence-using-MOK.png"><img class="wp-image-169945 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-6.-Bypassing-Secure-Boot-and-setting-up-persistence-using-MOK.png" alt="" width="1199" height="2000" /></a>
<p class="caption-text"><em>Figure 6. Bypassing Secure Boot and setting up persistence using MOK</em></p>
</div>
<h3><a id="exploiting-cve-2022-21894"></a>Exploiting CVE-2022-21894</h3>
<p>To bypass Secure Boot, BlackLotus uses the <a href="https://github.com/Wack0/CVE-2022-21894" target="_blank" rel="noopener">baton drop (CVE-2022-21894): Secure Boot Security Feature Bypass Vulnerability</a>. Despite its high impact on system security, this vulnerability did not get as much public attention as it deserved. Although the vulnerability was fixed in Microsoft&rsquo;s January 2022 update, its exploitation is still possible because the affected binaries have still not been added to the <a href="https://uefi.org/revocationlistfile" target="_blank" rel="noopener">UEFI revocation list</a>. As a result, attackers can bring their own copies of vulnerable binaries to their victims&rsquo; machines to exploit this vulnerability and bypass Secure Boot on up-to-date UEFI systems.</p>
<p>Moreover, a Proof of Concept (PoC) exploit for this vulnerability has been publicly available since August 2022. Considering the date of the first BlackLotus VirusTotal submission (see Figure 1), the malware developer has likely just adapted the available PoC to their needs without any need of deep understanding of how this exploit works.</p>
<p>Let&rsquo;s start with a brief introduction to the vulnerability, mostly summarizing key points from the write-up published along with the <a href="https://github.com/Wack0/CVE-2022-21894" target="_blank" rel="noopener">PoC on GitHub</a>:</p>
<ul>
<li>Affected Windows Boot Applications (such as <span style="font-family: 'courier new', courier, monospace;">bootmgr.efi</span>, <span style="font-family: 'courier new', courier, monospace;">hvloader.efi</span>, <span style="font-family: 'courier new', courier, monospace;">winload.efi</span>&hellip;) allow removing a serialized Secure Boot policy from memory &ndash; before it gets loaded by the application &ndash; by using the <span style="font-family: 'courier new', courier, monospace;">truncatememory</span> BCD boot option.</li>
<li>This allows attackers to use other dangerous BCD options like <span style="font-family: 'courier new', courier, monospace;">bootdebug</span>, <span style="font-family: 'courier new', courier, monospace;">testsigning</span>, or <span style="font-family: 'courier new', courier, monospace;">nointegritychecks</span>, thus breaking Secure Boot.</li>
<li>There are various ways to exploit this vulnerability &ndash; three of them are published in the PoC repository.</li>
<li>As an example, one of the PoCs shows how it can be exploited to make the legitimate <span style="font-family: 'courier new', courier, monospace;">hvloader.efi</span> load an arbitrary, self-signed <span style="font-family: 'courier new', courier, monospace;">mcupdate_&lt;platform&gt;.dll</span> binary (where <span style="font-family: 'courier new', courier, monospace;">&lt;platform&gt;</span> can be <span style="font-family: 'courier new', courier, monospace;">GenuineIntel</span> or <span style="font-family: 'courier new', courier, monospace;">AuthenticAMD</span>, based on the machine&rsquo;s CPU.).</li>
</ul>
<p>Now, we continue with describing how BlackLotus exploits this vulnerability (numbers in the list below describe corresponding steps in Figure 6):</p>
<ol>
<li>After the installer reboots the machine, the UEFI firmware proceeds with loading a first boot option. For Windows systems, the first boot option is by default <span style="font-family: 'courier new', courier, monospace;">bootmgfw.efi</span> located in the <span style="font-family: 'courier new', courier, monospace;">ESP:/EFI/Microsoft/Boot</span> folder on the ESP. This time, instead of executing the original victim&rsquo;s <span style="font-family: 'courier new', courier, monospace;">bootmgfw.efi</span> (which was previously renamed <span style="font-family: 'courier new', courier, monospace;">winload.efi</span> by the installer), the firmware executes the vulnerable one &ndash; deployed by the installer.</li>
<li>After <span style="font-family: 'courier new', courier, monospace;">bootmgfw.efi</span> is executed, it loads the BCD boot options, previously modified by the installer. Figure 7 shows a comparison of the legitimate BCD and the modified one.</li>
<li>As you can see in Figure 7 (path underlined with green), the legitimate Windows Boot Manager would normally load the Windows OS loader (<span style="font-family: 'courier new', courier, monospace;">\WINDOWS\system32\winload.efi</span>) as a default boot application. But this time, with the modified BCD, it continues with loading the vulnerable <span style="font-family: 'courier new', courier, monospace;">ESP:\system32\bootmgr.efi</span>, with the <span style="font-family: 'courier new', courier, monospace;">avoidlowmemory</span> BCD element set to value <span style="font-family: 'courier new', courier, monospace;">0x10000000</span> and the <span style="font-family: 'courier new', courier, monospace;">custom:22000023</span> BCD element pointing to another attackers&rsquo; BCD stored in <span style="font-family: 'courier new', courier, monospace;">ESP:\system32\bcd</span>. The explanation of using these elements can be found in the published <a href="https://github.com/Wack0/CVE-2022-21894" target="_blank" rel="noopener">PoC</a>:</li>
</ol>
<p style="margin-left: 6%; margin-right: -0%;"><span style="font-size: 12pt;"><em>The attacker needs to ensure the serialised Secure Boot Policy is allocated above a known physical address.</em><br /><em>[&hellip;]</em><br /><em>The <span style="font-family: 'courier new', courier, monospace;">avoidlowmemory</span> element can be used to ensure all allocations of physical memory are above a specified physical address.</em><br /><em>&emsp;&bull;&emsp;Since Windows 10, this element is disallowed if VBS is enabled, but as it is used during boot application initialisation, before the serialised Secure Boot policy is read from memory, loading <span style="font-family: 'courier new', courier, monospace;">bootmgr</span> and specifying a custom BCD path (using <span style="font-family: 'courier new', courier, monospace;">bcdfilepath</span> element aka <span style="font-family: 'courier new', courier, monospace;">custom:22000023</span>) can be used to bypass this.</em></span></p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-7.-Legitimate-BCD-store-BEFORE-vs-the-one-used-by-the-BlackLotus-installer-AFTER.png"><img class="wp-image-169946 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-7.-Legitimate-BCD-store-BEFORE-vs-the-one-used-by-the-BlackLotus-installer-AFTER.png" alt="" width="1763" height="813" /></a>
<p class="caption-text"><em>Figure 7. Legitimate BCD store (BEFORE) vs the one used by the BlackLotus installer (AFTER)</em></p>
</div>
<ol start="4">
<li>In the next step, the executed <span style="font-family: 'courier new', courier, monospace;">ESP:\system32\bootmgr.efi</span> loads that additional BCD located in <span style="font-family: 'courier new', courier, monospace;">ESP:\system32\bcd</span>. Parsed content of this additional BCD is shown in Figure 8.</li>
</ol>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-8.-Second-BCD-dropped-by-the-BlackLotus-installer-&ndash;-used-to-exploit-CVE-2022-21894.png"><img class="wp-image-169947 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-8.-Second-BCD-dropped-by-the-BlackLotus-installer-&ndash;-used-to-exploit-CVE-2022-21894.png" alt="" width="917" height="645" /></a>
<p class="caption-text"><em>Figure 8. Second BCD dropped by the BlackLotus installer &ndash; used to exploit CVE-2022-21894</em></p>
</div>
<ol start="5">
<li>Because of options loaded from the BCD file shown in Figure 8, <span style="font-family: 'courier new', courier, monospace;">bootmgr.efi</span> continues with loading another vulnerable Windows Boot Application deployed by the installer &ndash; <span style="font-family: 'courier new', courier, monospace;">ESP:\system32\hvloader.efi</span> &ndash; which is the Windows Hypervisor Loader. More importantly, additional BCD options are specified in the same BCD file (see Figure 8):<br />
<ol style="list-style-type: lower-alpha;">
<li><span style="font-family: 'courier new', courier, monospace;">truncatememory</span> with value set to <span style="font-family: 'courier new', courier, monospace;">0x10000000</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">nointegritychecks</span> set to Yes</li>
<li>and <span style="font-family: 'courier new', courier, monospace;">testsigning</span>, also set to Yes</li>
</ol>
</li>
</ol>
<p style="margin-left: 3%; margin-right: 0%;"><span style="font-size: 12pt;">And this is where the magic happens. As the serialized Secure Boot policy should be loaded in physical addresses above <span style="font-family: 'courier new', courier, monospace;">0x10000000</span> (because of <span style="font-family: 'courier new', courier, monospace;">avoidlowmemory</span> used in previous steps), specifying the <span style="font-family: 'courier new', courier, monospace;">truncatememory</span> element will effectively remove it &ndash; thus, break the Secure Boot and allow the use of dangerous BCD options like <span style="font-family: 'courier new', courier, monospace;">nointegritychecks</span> or <span style="font-family: 'courier new', courier, monospace;">testsigning</span>. By using these options, the attackers can make the <span style="font-family: 'courier new', courier, monospace;">hvloader.efi</span> execute their own, self-signed code.&nbsp;</span></p>
<ol start="6">
<li>To do this, the same trick as described in the <a href="https://github.com/Wack0/CVE-2022-21894" target="_blank" rel="noopener">PoC</a> is used: during its execution, the legitimate <span style="font-family: 'courier new', courier, monospace;">hvloader.efi</span> loads and executes the <span style="font-family: 'courier new', courier, monospace;">mcupdate_{GenuineIntel| AuthenticAMD}.dll</span> native binary from the <span style="font-family: 'courier new', courier, monospace;">&lt;device&gt;:\&lt;SystemRoot&gt;\system32\</span> directory. Commented Hex-Rays decompiled code of the function from <span style="font-family: 'courier new', courier, monospace;">hvloader.efi</span> responsible for loading this mcupdate*.dll binary is shown in Figure 9. Note that <span style="font-family: 'courier new', courier, monospace;">hvloader.efi</span> would normally load this legitimate <span style="font-family: 'courier new', courier, monospace;">mcupdate*.dll</span> binary from the &lt;OS_partition&gt;<span style="font-family: 'courier new', courier, monospace;">:\Windows\system32</span>, but this time the malicious attackers&rsquo; self-signed <span style="font-family: 'courier new', courier, monospace;">mcupdate*.dll</span> is executed from a custom ESP directory previously created by the installer (<span style="font-family: 'courier new', courier, monospace;">ESP:\system32</span>). It&rsquo;s caused by the BCD options <span style="font-family: 'courier new', courier, monospace;">device</span> and <span style="font-family: 'courier new', courier, monospace;">systemroot</span> used in the BCD from Figure 8 specifying the current device as <span style="font-family: 'courier new', courier, monospace;">boot</span> &ndash; meaning the ESP &ndash; and also specifying SystemRoot to be the root (<span style="font-family: 'courier new', courier, monospace;">\</span>) directory on this device.</li>
</ol>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-9.-Hex-Rays-decompilation-of-the-BtLoadUpdateDll-function-from-the-legitimate-hvloader.efi-responsible-for-loading-mcupdate_.dll_.png"><img class="wp-image-169948 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-9.-Hex-Rays-decompilation-of-the-BtLoadUpdateDll-function-from-the-legitimate-hvloader.efi-responsible-for-loading-mcupdate_.dll_.png" alt="" width="1114" height="786" /></a>
<p class="caption-text"><em>Figure 9. Hex-Rays decompilation of the </em><span style="font-family: 'courier new', courier, monospace;">BtLoadUpdateDll</span> <em>function from the legitimate </em><span style="font-family: 'courier new', courier, monospace;">hvloader.efi</span><em>, responsible for loading </em><span style="font-family: 'courier new', courier, monospace;">mcupdate_*.dll</span></p>
</div>
<ol start="7">
<li>Now, as the attackers&rsquo; own self-signed <span style="font-family: 'courier new', courier, monospace;">mcupdate*.dll</span> is loaded and executed, it continues with executing the final component in this chain &ndash; an embedded MokInstaller (UEFI Application) &ndash; see Figure 10 for details about how it&rsquo;s done.</li>
</ol>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-10.-Hex-Rays-decompiled-code-of-the-malicious-self-signed-mcupdate.dll-binary.png"><img class="wp-image-169949 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-10.-Hex-Rays-decompiled-code-of-the-malicious-self-signed-mcupdate.dll-binary.png" alt="" width="1620" height="1032" /></a>
<p class="caption-text"><em>Figure 10. Hex-Rays decompiled code of the malicious self-signed </em><span style="font-family: 'courier new', courier, monospace;">mcupdate*.dll</span><em> binary</em></p>
</div>
<h3><a id="bootkit-persistence"></a>Bootkit persistence</h3>
<p>Now, the MokInstaller can proceed with setting up persistence by enrolling the attackers&rsquo; MOK into the NVRAM variable and setting up the legitimate Microsoft-signed <span style="font-family: 'courier new', courier, monospace;">shim</span> binary as a default bootloader. Before proceeding to details, a little theory about <span style="font-family: 'courier new', courier, monospace;">shim</span> and MOK.</p>
<p><span style="font-family: 'courier new', courier, monospace;">shim</span> is a first stage UEFI bootloader developed by Linux developers to make various Linux distributions work with UEFI Secure Boot. It&rsquo;s a simple application and its purpose is to load, verify, and execute another application &ndash; in case of Linux systems, it&rsquo;s usually the GRUB bootloader. It works in a way that Microsoft signs only a <span style="font-family: 'courier new', courier, monospace;">shim</span>, and the <span style="font-family: 'courier new', courier, monospace;">shim</span> takes care of the rest &ndash; it can verify the integrity of a second-stage bootloader by using keys from <span style="font-family: 'courier new', courier, monospace;">db</span> UEFI variable, and also embeds its own list of &ldquo;allowed&rdquo; or &ldquo;revoked&rdquo; keys or hashes to make sure that components trusted by both &ndash; platform and shim developer (e.g. Canonical, RedHat, etc.,) &ndash; are allowed to be executed. In addition to these lists, <span style="font-family: 'courier new', courier, monospace;">shim</span> also allows the use of an external keys database managed by the user, known as the MOK list. Figure 11&nbsp;nicely illustrates how UEFI Secure Boot with MOK works.</p>
<p>This MOK database is stored in a Boot-only NVRAM variable named <span style="font-family: 'courier new', courier, monospace;">MokList</span>. Without exploiting a vulnerability like the one described above, physical access is required to modify it on a system with UEFI Secure Boot enabled (it&rsquo;s available only during boot, before the OS loader calls the UEFI Boot Services function <span style="font-family: 'courier new', courier, monospace;">ExitBootServices</span>). However, by exploiting this vulnerability, attackers are able to bypass UEFI Secure Boot and execute their own self-signed code before a call to <span style="font-family: 'courier new', courier, monospace;">ExitBootServices</span>, so they can easily enroll their own key (by modifying the <span style="font-family: 'courier new', courier, monospace;">MokList</span> NVRAM variable) to make the shim execute any application &ndash; signed by that enrolled key &ndash; without causing a security violation.</p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-11.-MOK-boot-process-overview.jpg"><img class="wp-image-169951 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-11.-MOK-boot-process-overview.jpg" alt="" width="1427" height="792" /></a>
<p class="caption-text"><em>Figure 11. MOK boot process overview (<a href="https://web.archive.org/web/20201026161357/https:/www.suse.com/media/presentation/uefi_secure_boot_webinar.pdf" target="_blank" rel="noopener"><u>image source</u></a>)</em></p>
</div>
<ol start="8">
<li>Continuing with describing the flow from Figure 6 &ndash; step 8&hellip; The MokInstaller UEFI application continues with setting up persistence for the BlackLotus UEFI bootkit and covering the tracks of exploitation by:<br />
<ol style="list-style-type: lower-alpha;">
<li><a id="restoring-the-victim-original-bcd-store"></a>Restoring the victim&rsquo;s original BCD store from the backup created by the installer and replacing the efi with the legitimate Microsoft-signed shim, previously dropped to the <span style="font-family: 'courier new', courier, monospace;">ESP:\system32\bootload.efi</span> by the installer.</li>
<li>Creating a <span style="font-family: 'courier new', courier, monospace;">MokList</span> NVRAM variable containing the attackers&rsquo; self-signed public key certificate. Note that this variable is formatted in the same way as any other UEFI signature database variables (such as db or dbx) and it can consist of zero or more signature lists of type <span style="font-family: 'courier new', courier, monospace;">EFI_SIGNATURE_LIST</span> &ndash; as defined in the UEFI Specification.</li>
<li>Deleting all files involved in exploitation from the attackers&lsquo; <span style="font-family: 'courier new', courier, monospace;">ESP:\system32\</span> folder.</li>
</ol>
</li>
<li>In the end, it reboots the machine to make the deployed shim execute the self-signed bootkit dropped to <span style="font-family: 'courier new', courier, monospace;">\EFI\Microsoft\Boot\grubx64.efi</span> by the installer (<span style="font-family: 'courier new', courier, monospace;">grubx64.efi</span> is usually the default second-stage bootloader executed by a <span style="font-family: 'courier new', courier, monospace;">shim</span> on x86-64 systems).</li>
</ol>
<p>Code performing the actions described in the last two steps is shown in Figure 12.</p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-12.-Hex-Rays-decompiled-code-&ndash;-MokInstaller-UEFI-app-setting-up-persistence-for-the-BlackLotus-bootkit.png"><img class="wp-image-169952 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-12.-Hex-Rays-decompiled-code-&ndash;-MokInstaller-UEFI-app-setting-up-persistence-for-the-BlackLotus-bootkit.png" alt="" width="1523" height="660" /></a>
<p class="caption-text"><em>Figure 12. Hex-Rays decompiled code &ndash; MokInstaller UEFI app setting up persistence for the BlackLotus bootkit</em></p>
</div>
<h2>BlackLotus UEFI bootkit</h2>
<p>Once the persistence is configured, the BlackLotus bootkit is executed on every system start. The bootkit&rsquo;s goal is to deploy a kernel driver and a final user-mode component &ndash; the HTTP downloader. During its execution, it tries to disable additional Windows security features &ndash; Virtualization-Based Security (VBS) and Windows Defender &ndash; to raise the chance of successful deployment and stealthy operation. Before jumping to the details about how that is done, let&rsquo;s summarize the basics about the kernel driver and HTTP downloader:</p>
<ul>
<li>The kernel driver is responsible for
<ul>
<li>Deploying the next component of the chain &ndash; an HTTP downloader.</li>
<li>Keeping the loader alive in case of termination.</li>
<li>Protecting bootkit files from being removed from ESP.</li>
<li>Executing additional kernel payloads, if so instructed by the HTTP downloader.</li>
<li>Uninstalling the bootkit, if so instructed by the HTTP downloader.</li>
</ul>
</li>
<li>The HTTP downloader is responsible for:
<ul>
<li>Communicating with its C&amp;C.</li>
<li>Executing commands received from the C&amp;C.</li>
<li>Downloading and executing payloads received from the C&amp;C (supports both kernel payloads and user-mode payloads).</li>
</ul>
</li>
</ul>
<p>The full execution flow (simplified), from the installer to HTTP downloader, is shown in Figure 13. We describe these individual steps in more detail in the next section.</p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-13.-Diagram-showing-execution-of-the-BlackLotus-UEFI-bootkit-1.png"><img class="wp-image-169954 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-13.-Diagram-showing-execution-of-the-BlackLotus-UEFI-bootkit-1.png" alt="" width="1054" height="2000" /></a>
<p class="caption-text"><em>Figure 13. Diagram showing execution of the BlackLotus UEFI bootkit</em></p>
</div>
<h2><a id="blacklotus-execution-flow"></a>BlackLotus execution flow</h2>
<p>Execution steps are as follows (these steps are shown in Figure 13):</p>
<ol>
<li>As a first step, the UEFI firmware executes the default Windows boot option, which is the file usually stored in <span style="font-family: 'courier new', courier, monospace;">\EFI\Microsoft\Boot\bootmgfw.efi</span>. As we described earlier&nbsp;(<em><a href="#restoring-the-victim-original-bcd-store">Bootkit persistence section, 8&nbsp;.a</a></em>),&nbsp;the MokInstaller binary replaced this file with a legitimate signed <span style="font-family: 'courier new', courier, monospace;">shim</span>.</li>
<li>When the <span style="font-family: 'courier new', courier, monospace;">shim</span> is executed, it reads the <span style="font-family: 'courier new', courier, monospace;">MokList</span> NVRAM variable, and uses the certificate previously stored inside by the attackers to verify the second-stage bootloader &ndash; the self-signed BlackLotus UEFI bootkit located in <span style="font-family: 'courier new', courier, monospace;">\EFI\Microsoft\Boot\grubx64.efi</span>.</li>
<li>When verified, the <span style="font-family: 'courier new', courier, monospace;">shim</span> executes the bootkit.</li>
<li>The bootkit starts with creating the Boot-only <span style="font-family: 'courier new', courier, monospace;">VbsPolicyDisable</span> NVRAM variable. As described <a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Cyber-Sicherheit/SiSyPHus/Workpackage6_Virtual_Secure_Mode.pdf?__blob=publicationFile&amp;v=1" target="_blank" rel="noopener">here</a>, this variable is evaluated by the Windows OS loader during boot and if defined, the core VBS features, such as HVCI and Credential Guard will not be initialized.</li>
<li>In the following steps (5.&nbsp;a&ndash;e), the bootkit continues with a common pattern used by UEFI bootkits. It intercepts the execution of components included in the typical Windows boot flow, such as Windows Boot Manager, Windows OS loader, and Windows OS kernel, and hooks some of their functions in memory. As a bonus, it also attempts to disable Windows Defender by patching some of its drivers. All this to achieve its payload&rsquo;s execution in the early stages of the OS startup process and to avoid detection. The following functions are hooked or patched:<br />
<ol style="list-style-type: lower-alpha;">
<li><span style="font-family: 'courier new', courier, monospace;">ImgArchStartBootApplication</span> in <span style="font-family: 'courier new', courier, monospace;">bootmgfw.efi</span> or <span style="font-family: 'courier new', courier, monospace;">bootmgr.efi</span>:<br />This function is commonly hooked by bootkits to catch the moment when the Windows OS loader (<span style="font-family: 'courier new', courier, monospace;">winload.efi</span>) is loaded in the memory but still hasn&rsquo;t been executed &ndash; which is the right moment to perform more in-memory patching.</li>
<li><span style="font-family: 'courier new', courier, monospace;">BlImgAllocateImageBuffer</span> in <span style="font-family: 'courier new', courier, monospace;">winload.efi</span>:<br />Used to allocate an additional memory buffer for the malicious kernel driver.</li>
<li><span style="font-family: 'courier new', courier, monospace;">OslArchTransferToKernel</span> in <span style="font-family: 'courier new', courier, monospace;">winload.efi</span>:<br />Hooked to catch the moment when the OS kernel and some of the system drivers are already loaded in the memory, but still haven&rsquo;t been executed &ndash; which is a perfect moment to perform more in-memory patching. The drivers mentioned below are patched in this hook. The code from this hook responsible for finding appropriate drivers in memory is shown in Figure 14.</li>
<li><span style="font-family: 'courier new', courier, monospace;">WdBoot.sys</span> and <span style="font-family: 'courier new', courier, monospace;">WdFilter.sys</span>:<br />BlackLotus patches the entry point of <span style="font-family: 'courier new', courier, monospace;">WdBoot.sys</span> and <span style="font-family: 'courier new', courier, monospace;">WdFilter.sys</span> &ndash; the Windows Defender ELAM driver and the Windows Defender file system filter driver, respectively &ndash; to return immediately.</li>
<li><span style="font-family: 'courier new', courier, monospace;">disk.sys</span>:<br />The bootkit hooks the entry point of the <span style="font-family: 'courier new', courier, monospace;">disk.sys</span> driver to execute the BlackLotus kernel driver in the early stages of system initialization.</li>
</ol>
</li>
</ol>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-14.-Hex-Rays-decompiled-code-of-OslArchTransferToKernel-hook-&ndash;-patching-Windows-Defender-drivers-and-searching-for-the-disk.sys-entry-point.png"><img class="wp-image-169955 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-14.-Hex-Rays-decompiled-code-of-OslArchTransferToKernel-hook-&ndash;-patching-Windows-Defender-drivers-and-searching-for-the-disk.sys-entry-point.png" alt="" width="1236" height="847" /></a>
<p class="caption-text"><em>Figure 14. Hex-Rays decompiled code of </em><span style="font-family: 'courier new', courier, monospace;">OslArchTransferToKernel</span><em> hook &ndash; patching Windows Defender drivers and searching for the </em><span style="font-family: 'courier new', courier, monospace;">disk.sys</span><em> entry point</em></p>
</div>
<ol start="6">
<li>Next, when the OS kernel executes the <span style="font-family: 'courier new', courier, monospace;">disk.sys</span> driver&rsquo;s entry point, the installed hook jumps to the malicious kernel driver entry point. The malicious code in turn restores the original <span style="font-family: 'courier new', courier, monospace;">disk.sys</span> to allow the system to function properly and waits until the <span style="font-family: 'courier new', courier, monospace;">winlogon.exe</span> process starts.</li>
<li>When the malicious driver detects that the <span style="font-family: 'courier new', courier, monospace;">winlogon.exe</span> process has started, it injects and executes the final user-mode component &ndash; the HTTP downloader &ndash; into it.</li>
</ol>
<h3>Kernel driver</h3>
<p>The kernel driver is responsible for four main tasks:</p>
<ul>
<li>Injecting the HTTP downloader into <span style="font-family: 'courier new', courier, monospace;">winlogon.exe</span> and reinjecting it in case the thread terminated.</li>
<li>Protecting bootkit files deployed on the ESP from being removed.</li>
<li>Disarming the user-mode Windows Defender process <span style="font-family: 'courier new', courier, monospace;">MsMpEngine.exe</span>.</li>
<li>Communicating with the HTTP downloader and if necessary, performing any commands.</li>
</ul>
<p>Let&rsquo;s look at them one by one.</p>
<h3>HTTP downloader persistence</h3>
<p>The kernel driver is responsible for deployment of the HTTP downloader. When the driver starts, it waits until the process named <span style="font-family: 'courier new', courier, monospace;">winlogon.exe</span> starts, before taking any other actions. Once the process has started, the driver decrypts the HTTP downloader binary, injects it into <span style="font-family: 'courier new', courier, monospace;">winlogon.exe</span>&rsquo;s address space, and executes it in a new thread. Then, the driver keeps periodically checking whether the thread is still running, and repeats the injection if necessary. The HTTP downloader won&rsquo;t be deployed if a kernel debugger is detected by the driver.</p>
<h3><a id="protecting-bootkit-files-on-the-ESP-from-removal"></a>Protecting bootkit files on the ESP from removal</h3>
<p>To protect the bootkit&rsquo;s files located on the ESP, the kernel driver uses a simple trick. It opens all files it wants to protect, duplicates and saves their handles, and uses the <span style="font-family: 'courier new', courier, monospace;">ObSetHandleAttributes</span> kernel function specifying the <span style="font-family: 'courier new', courier, monospace;">ProtectFromClose</span> flag inside <span style="font-family: 'courier new', courier, monospace;">HandleFlags</span> (<a href="https://www.geoffchappell.com/studies/windows/km/ntoskrnl/inc/api/ntobapi/object_handle_flag_information.htm" target="_blank" rel="noopener">OBJECT_HANDLE_FLAG_INFORMATION</a>) parameter to 1 &ndash; thus protecting the handles from being closed by any other processes. This will thwart any attempts to remove or modify the protected files. The following files are protected:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">ESP:\EFI\Microsoft\Boot\winload.efi</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">ESP:\EFI\Microsoft\Boot\bootmgfw.efi</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">ESP:\EFI\Microsoft\Boot\grubx64.efi</span></li>
</ul>
<p>Should a user try to delete these protected files, something like what is shown in Figure 15 will occur.</p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-15.-An-attempt-to-delete-the-files-protected-by-BlackLotus-driver.png"><img class="wp-image-169956 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-15.-An-attempt-to-delete-the-files-protected-by-BlackLotus-driver.png" alt="" width="939" height="364" /></a>
<p class="caption-text"><em>Figure 15. An attempt to delete the files protected by BlackLotus driver</em></p>
</div>
<p>As another layer of protection, in case the user or security software would be able to unset the protection flag and close the handles, the kernel driver continuously monitors them, and causes a BSOD by calling the <span style="font-family: 'courier new', courier, monospace;">KeBugCheck(INVALID_KERNEL_HANDLE)</span> function if any of the handles don&rsquo;t exist anymore.</p>
<h3>Disarming the main Windows Defender process</h3>
<p>The kernel driver also tries to disarm the main Windows Defender process &ndash; <span style="font-family: 'courier new', courier, monospace;">MsMpEng.exe</span>. It does so by removing all process&rsquo;s token privileges by setting the <span style="font-family: 'courier new', courier, monospace;">SE_PRIVILEGE_REMOVED</span> attribute to each of them. As a result, the Defender process should not be able to do its job &ndash; such as scanning files &ndash; properly. However, as this functionality is poorly implemented, it can be made ineffective by restarting the <span style="font-family: 'courier new', courier, monospace;">MsMpEng.exe</span> process.</p>
<h3><a id="communication-with-the-http-downloader"></a>Communication with the HTTP downloader</h3>
<p>The kernel driver is capable of communicating with the HTTP downloader by using a named Event and Section. Names of the named objects used are generated based on the victim&rsquo;s network adapter MAC address (ethernet). If a value of an octet is lower than 16, then 16 is added to it. The format of the generated objects names might vary in different samples. As an example, in one of the samples we analyzed, for the MAC address <span style="font-family: 'courier new', courier, monospace;">00-1c-0b-cd-ef-34</span>, the generated names would be:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">\BaseNamedObjects\101c1b</span>: for the named section (only the first three octets of the MAC are used)</li>
<li><span style="font-family: 'courier new', courier, monospace;">\BaseNamedObjects\<strong>Z</strong>01c1b</span>: for the named event &ndash; same as for the Section, but the first digit of the MAC address is replaced with <span style="font-family: 'courier new', courier, monospace;">Z</span></li>
</ul>
<p>In case the HTTP downloader wants to pass some command to the kernel driver, it simply creates a named section, writes a command with associated data inside, and waits for the command to be processed by the driver by creating a named event and waiting until the driver triggers (or signals) it.</p>
<p>The driver supports the following self-explanatory commands:</p>
<ul>
<li>Install kernel driver</li>
<li>Uninstall BlackLotus</li>
</ul>
<p>A careful reader might notice the BlackLotus weak point here &ndash; even though the bootkit protects its components against removal, the kernel driver can be tricked to uninstall the bootkit completely by creating the abovementioned named objects and sending the uninstall command to it.</p>
<h2><a id="http-downloader"></a>HTTP downloader</h2>
<p>The final component is responsible for communication with a C&amp;C server and execution of any C&amp;C commands received from it. All payloads we were able to discover contain three commands. These commands are very straightforward and as the section name suggests, it&rsquo;s mostly about downloading and executing additional payloads using various techniques.</p>
<h3><a id="cc-communication"></a>C&amp;C communication</h3>
<p>To communicate with its C&amp;C, the HTTP loader uses the HTTPS protocol. All information necessary for the communication is embedded directly in the downloader binary &ndash; including C&amp;C domains and HTTP resource paths used. The default interval for communication with a C&amp;C server is set to one minute, but can be changed based on the data from the C&amp;C. Each communication session with a C&amp;C starts with sending a beacon HTTP POST message to it. In samples we analyzed, the following HTTP resource paths can be specified in the HTTP POST headers:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">/network/API/hpb_gate[.]php</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">/API/hpb_gate[.]php</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">/gate[.]php</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">/hpb_gate[.]php</span></li>
</ul>
<p>The beacon message data is prepended with a <span style="font-family: 'courier new', courier, monospace;">checkin</span>= string, containing basic information about the compromised machine &ndash; including a custom machine identifier (referred to as <span style="font-family: 'courier new', courier, monospace;">HWID</span>), UEFI Secure Boot status, various hardware information, and a value that seems to be a BlackLotus build number. <span style="font-family: 'courier new', courier, monospace;">HWID</span> is generated from the machine MAC address (ethernet) and a system volume serial number. The format of the message before encryption is as seen in Figure 16</p>
<pre class="language-bash" title=""><code>{
    "HWID":"%s", 
    "Session":"%lu", 
    "Owner":"%s", 
    "IP":"%s", 
    "OS":"%s", 
    "Edition":"%s", 
    "CPU":"%s", 
    "GPU":"%s", 
    "RAM":"%lu", 
    "Integrity":"%lu", 
    "SecureBoot":"%i", 
    "Build":"%lu"
}</code></pre>
<p style="text-align: left;"><em>Figure 16. Format of beacon message</em></p>
<p>Before sending the message to the C&amp;C, the data is first encrypted using an embedded RSA key, then URL-safe base64 encoded. During the analysis, we found two different RSA keys being used in the samples. An example of such an HTTP beacon request is shown in Figure 17.</p>
<div class="caption center"><a href="https://web-assets.esetstatic.com/wls/2023/03/Figure-17.-Example-of-a-beacon-HTTP-POST-message-generated-by-a-sample-from-VirusTotal-&ndash;-the-one-with-local-IPs-instead-of-real-CC-addresses.png"><img class="wp-image-169957 size-full" src="https://web-assets.esetstatic.com/wls/2023/03/Figure-17.-Example-of-a-beacon-HTTP-POST-message-generated-by-a-sample-from-VirusTotal-&ndash;-the-one-with-local-IPs-instead-of-real-CC-addresses.png" alt="" width="613" height="452" /></a>
<p class="caption-text"><em>Figure 17. Example of a beacon HTTP POST message (generated by a sample from VirusTotal &ndash; the one with local IPs instead of real C&amp;C addresses)</em></p>
</div>
<p>Data received from the C&amp;C as a response to the beacon message should start with the two-byte magic value HP; otherwise, the response is not processed further. If the magic value is correct, the data following the magic value is decrypted using 256-bit AES in CBC mode with abovementioned HWID string used as the key.</p>
<p>After decryption, the message is similar to the beacon, a JSON-formatted string, and specifies a command identifier (referred to as <span style="font-family: 'courier new', courier, monospace;">Type</span>) and various additional parameters such as:</p>
<ul>
<li>C&amp;C communication interval</li>
<li>Execution method to use</li>
<li>Payload filename</li>
<li>Payload type based on file extension(<span style="font-family: 'courier new', courier, monospace;">.sys</span>, <span style="font-family: 'courier new', courier, monospace;">.exe</span>, or <span style="font-family: 'courier new', courier, monospace;">.dll</span> supported)</li>
<li>Authentication token that is supposed to be used to request download of payload data</li>
<li>AES key used for decrypting the payload data</li>
</ul>
<p>All supported commands and their descriptions are listed in Table 2.</p>
<p><em>Table 2. C&amp;C commands</em></p>
<p><table>
<thead>
<tr>
<th>Command&nbsp;Type</th>
<th>Command Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Download and execute a kernel driver, DLL, or a regular executable</td>
</tr>
<tr>
<td>2</td>
<td>Download a payload, uninstall the bootkit, and execute the payload &ndash; likely used to update the bootkit</td>
</tr>
<tr>
<td>3</td>
<td>Uninstall the bootkit and exit</td>
</tr>
</tbody>
</table></p>
<p>In these commands, the C&amp;C can specify, whether the payload should first be dropped to disk before executing it, or be executed directly in memory. In cases involving dropping the file to disk, the <span style="font-family: 'courier new', courier, monospace;">ProgramData</span> folder on the OS volume is used as the destination folder and filename and extension are specified by the C&amp;C server. In the case of executing files directly in memory, <span style="font-family: 'courier new', courier, monospace;">svchost.exe</span> is used as an injection target. When the C&amp;C sends a command requiring kernel driver cooperation, or an operator wants to execute code in kernel-mode, the mechanism described in the <a href="#communication-with-the-http-downloader"><em>Communication with the HTTP downloader</em></a> section is used.</p>
<h2>Anti-analysis tricks</h2>
<p>To make detection and analysis of this piece of malware harder, its author tried to limit visibility of standard file artifacts, such as text strings, imports, or other unencrypted embedded data to a minimum. Below is a summary of the techniques used.</p>
<ul>
<li>String and data encryption
<ul>
<li>All strings used within the samples are encrypted using a simple cipher.</li>
<li>All embedded files are encrypted using 256-bit AES in CBC mode.</li>
<li>Encryption keys for individual files can vary from sample to sample.</li>
<li>In addition to AES encryption, some files are also compressed using LZMS.</li>
</ul>
</li>
<li>Runtime-only API resolution
<ul>
<li>In all samples (when applicable), Windows APIs are always resolved exclusively during runtime and function hashes instead of function names are used to find the desired API function addresses in memory.</li>
<li>In some cases, a direct <span style="font-family: 'courier new', courier, monospace;">syscall</span> instruction invocation is used to invoke the desired system function.</li>
</ul>
</li>
<li>Network communication
<ul>
<li>Communicates using HTTPS.</li>
<li>All messages sent to the C&amp;C by the HTTP downloader are encrypted using an embedded RSA public key.</li>
<li>All messages sent from the C&amp;C to the HTTP downloader are encrypted using a key derived from the victim&rsquo;s machine environment or using an AES key provided by the C&amp;C.</li>
</ul>
</li>
<li>Anti-debug and anti-VM tricks &ndash; if used, usually placed right at the beginning of the entry point. Only casual sandbox or debugger detection tricks are used.</li>
</ul>
<h2>Mitigations and remediation</h2>
<ul>
<li>First of all, of course, keeping your system and its security product up to date is a must &ndash; to raise a chance that a threat will be stopped right at the beginning, before it&rsquo;s able to achieve pre-OS persistence.</li>
<li>Then, the key step that needs to be taken to prevent usage of known vulnerable UEFI binaries for bypassing UEFI Secure Boot is their revocation in the UEFI revocation database (<span style="font-family: 'courier new', courier, monospace;">dbx</span>) &ndash; on a Windows systems, <span style="font-family: 'courier new', courier, monospace;">dbx</span> updates should be distributed using Windows Updates.</li>
<li>The problem is that revocation of broadly used Windows UEFI binaries can lead to making thousands of outdated systems, recovery images, or backups unbootable &ndash; and therefore, revocation often takes too long.</li>
<li>Note that revocation of the Windows applications used by BlackLotus would prevent installation of the bootkit, but as the installer would replace the victim&rsquo;s bootloader with the revoked one, it could make the system unbootable. To recover in this case, an OS reinstall or just ESP recovery would resolve the issue.</li>
<li>If the revocation would happen after BlackLotus persistence is set, the bootkit would remain functional, as it uses a legitimate shim with custom MOK key for persistence. In this case, the safest mitigation solution would be to reinstall Windows and remove the attackers&rsquo; enrolled MOK key by using the <span style="font-family: 'courier new', courier, monospace;">mokutil</span> utility (physical presence is required to perform this operation due to necessary user interaction with the MOK Manager during the boot).</li>
</ul>
<h2>Takeaways</h2>
<p>Many critical vulnerabilities affecting security of UEFI systems have been discovered in the last few years. Unfortunately, due the complexity of the whole UEFI ecosystem and related supply-chain problems, many of these vulnerabilities have left many systems vulnerable even a long time after the vulnerabilities have been fixed &ndash; or at least after we were told they were fixed. For a better image, here are some examples of the patch or revocation failures allowing UEFI Secure Boot bypasses just from the last year:</p>
<ul>
<li>First of all, of course, CVE-2022-21894 &ndash; the vulnerability exploited by BlackLotus. One year since the vulnerability was fixed, vulnerable UEFI binaries are still not revoked, allowing threats such as BlackLotus to stealthily operate on systems with UEFI Secure Boot enabled, thus providing victims a false sense of security.</li>
<li>Early in 2022, we disclosed several UEFI vulnerabilities that allow, among other things, disabling UEFI Secure Boot. Many devices affected are not supported by the OEM anymore, thus not fixed (even though these devices were not so old &ndash; like 3-5 years at the time of vulnerability disclosure). Read more in our blogpost: <a href="https://www.welivesecurity.com/2022/04/19/when-secure-isnt-secure-uefi-vulnerabilities-lenovo-consumer-laptops/" target="_blank" rel="noopener">When &ldquo;secure&rdquo; isn&rsquo;t secure at all: High‚Äëimpact UEFI vulnerabilities discovered in Lenovo consumer laptops</a></li>
<li>Later in 2022, we discovered a <a href="https://twitter.com/ESETresearch/status/1590279782318878720" target="_blank" rel="noopener">few other UEFI vulnerabilities</a>, whose exploitation would also allow attackers to disable UEFI Secure Boot very easily. As pointed out by fellow researchers from <a href="https://binarly.io/posts/Firmware_Patch_Deep_Dive_Lenovo_Patches_Fail_to_Fix_Underlying_Vulnerabilities" target="_blank" rel="noopener">Binarly</a>, several devices listed in the <a href="https://support.lenovo.com/us/en/product_security/LEN-94952" target="_blank" rel="noopener">advisory</a> were left unpatched, or not patched correctly, even few months after the advisory &ndash; leaving the devices vulnerable. Needless to say, similar to the previous case, some devices will stay vulnerable forever, as they have reached their End-Of-Support date.</li>
</ul>
<p>It was just a matter of time before someone would take advantage of these failures and create a UEFI bootkit capable of operating on systems with UEFI Secure Boot enabled. As we suggested last year in our <a href="https://www.rsaconference.com/Library/presentation/USA/2022/ESPecter%20First%20Real-World%20UEFI%20Bootkit%20Persisting%20on%20ESP" target="_blank" rel="noopener">RSA presentation</a>, all of this makes the move to the ESP more feasible for attackers and a possible way forward for UEFI threats &ndash; the existence of BlackLotus confirms this.</p>
<p><em>ESET Research offers private APT intelligence reports and data feeds. For any inquiries about this service, visit the&nbsp;<a href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=blacklotus-uefi-bootkit-myth-confirmed" target="_blank" rel="noopener">ESET Threat Intelligence</a>&nbsp;page.</em></p>
<h2>IoCs</h2>
<h3>Files</h3>
<p><table>
<thead>
<tr>
<th>SHA-1</th>
<th>Filename</th>
<th>Detection</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><span style="font-family: courier new, courier, monospace;">05846D5B1D37EE2D716140DE4F4F984CF1E631D1</td>
<td>N/A</td>
<td>Win64/BlackLotus.A</td>
<td>BlackLotus installer.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">A5A530A91100ED5F07A5D74698B15C646DD44E16</td>
<td>N/A</td>
<td>Win64/BlackLotus.A</td>
<td>BlackLotus installer.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">D82539BFC2CC7CB504BE74AC74DF696B13DB486A</td>
<td>N/A</td>
<td>Win64/BlackLotus.A</td>
<td>BlackLotus installer.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">16B12CEA54360AA42E1120E82C1E9BC0371CB635</td>
<td>N/A</td>
<td>Win64/BlackLotus.A</td>
<td>BlackLotus installer.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">DAE7E7C4EEC2AC0DC7963C44A5A4F47D930C5508</td>
<td>N/A</td>
<td>Win64/BlackLotus.A</td>
<td>BlackLotus installer.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">45701A83DEC1DC71A48268C9D6D205F31D9E7FFB</td>
<td>N/A</td>
<td>Win64/BlackLotus.A</td>
<td>BlackLotus installer.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">2CE056AE323B0380B0E87225EA0AE087A33CD316</td>
<td>N/A</td>
<td>EFI/BlackLotus.B</td>
<td>BlackLotus UEFI bootkit.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">5A0074203ABD5DEB464BA0A79E14B7541A033216</td>
<td>N/A</td>
<td>EFI/BlackLotus.B</td>
<td>BlackLotus UEFI bootkit.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">5DC9CBD75ABD830E83641A0265BFFDDD2F602815</td>
<td>N/A</td>
<td>EFI/BlackLotus.B</td>
<td>BlackLotus UEFI bootkit.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">97AEC21042DF47D39AC212761729C6BE484D064D</td>
<td>N/A</td>
<td>EFI/BlackLotus.B</td>
<td>BlackLotus UEFI bootkit.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">ADCEEC18FF009BED635D168E0B116E72096F18D2</td>
<td>N/A</td>
<td>EFI/BlackLotus.B</td>
<td>BlackLotus UEFI bootkit.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">DBC064F757C69EC43517EFF496146B43CBA949D1</td>
<td>N/A</td>
<td>EFI/BlackLotus.B</td>
<td>BlackLotus UEFI bootkit.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">06AF3016ACCDB3DFE1C23657BF1BF91C13BAA757</td>
<td>N/A</td>
<td>Win64/BlackLotus.B</td>
<td>BlackLotus HTTP downloader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">0C0E78BF97116E781DDE0E00A1CD0C29E68D623D</td>
<td>N/A</td>
<td>Win64/BlackLotus.B</td>
<td>BlackLotus HTTP downloader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">6D8CEE28DA8BCF25A4D232FEB0810452ACADA11D</td>
<td>N/A</td>
<td>Win64/BlackLotus.B</td>
<td>BlackLotus HTTP downloader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">74FF58FCE8F19083D16DF0109DC91D78C94342FA</td>
<td>N/A</td>
<td>Win64/BlackLotus.B</td>
<td>BlackLotus HTTP downloader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">ACC74217CBE3F2E727A826B34BDE482DCAE15BE6</td>
<td>N/A</td>
<td>Win64/BlackLotus.B</td>
<td>BlackLotus HTTP downloader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">111C4998F3264617A7A9D9BF662D4B1577445B20</td>
<td>N/A</td>
<td>Win64/BlackLotus.B</td>
<td>BlackLotus&nbsp;HTTP&nbsp;downloader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">17FA047C1F979B180644906FE9265F21AF5B0509</td>
<td>N/A</td>
<td>Win64/BlackLotus.C</td>
<td>BlackLotus kernel driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">1F3799FED3CF43254FE30DCDFDB8DC02D82E662B</td>
<td>N/A</td>
<td>Win64/BlackLotus.C</td>
<td>BlackLotus kernel driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">4B882748FAF2C6C360884C6812DD5BCBCE75EBFF</td>
<td>N/A</td>
<td>Win64/BlackLotus.C</td>
<td>BlackLotus kernel driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">91F832F46E4C38ECC9335460D46F6F71352CFFED</td>
<td>N/A</td>
<td>Win64/BlackLotus.C</td>
<td>BlackLotus kernel driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">994DC79255AEB662A672A1814280DE73D405617A</td>
<td>N/A</td>
<td>Win64/BlackLotus.C</td>
<td>BlackLotus kernel driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">FFF4F28287677CAABC60C8AB36786C370226588D</td>
<td>N/A</td>
<td>Win64/BlackLotus.C</td>
<td>BlackLotus kernel driver.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">71559C3E2F3950D4EE016F24CA54DA17D28B9D82</td>
<td>N/A</td>
<td>EFI/BlackLotus.C</td>
<td>BlackLotus Boot Configuration Data (BCD) store dropped by BlackLotus installer.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">D6D3F3151B188A9DA62DEB95EA1D1ABEFF257914</td>
<td>N/A</td>
<td>EFI/BlackLotus.C</td>
<td>BlackLotus Boot Configuration Data (BCD) store dropped by BlackLotus installer.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">547FAA2D64B85BF883955B723B07635C0A09326B</td>
<td>N/A</td>
<td>EFI/BlackLotus.A</td>
<td>BlackLotus CVE-2022-21894 exploitation payload loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">D1BBAA3D408E944C70B3815471EED7FA9AEE6425</td>
<td>N/A</td>
<td>EFI/BlackLotus.A</td>
<td>BlackLotus CVE-2022-21894 exploitation payload loader.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">0E6DD7110C38464ECAA55EE4E2FA303ADA0EDEFB</td>
<td>N/A</td>
<td>EFI/BlackLotus.A</td>
<td>BlackLotus CVE-2022-21894 exploitation payload ‚Äì MokInstaller EFI app.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">D6BB89D8734B3E49725362DAE9A868AE681E8BD6</td>
<td>N/A</td>
<td>EFI/BlackLotus.A</td>
<td>BlackLotus CVE-2022-21894 exploitation payload ‚Äì MokInstaller EFI app.</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">164BB587109CFB20824303AD1609A65ABB36C3E9</td>
<td>N/A</td>
<td>Win64/BlackLotus.D</td>
<td>BlackLotus installer UAC bypass module.</td>
</tr>
</tbody>
</table></p>
<h3>Certificates</h3>
<p><table>
<thead>
<tr>
<th>Serial number</th>
<th><span style="font-family: courier new, courier, monospace;">570B5D22B723B4A442CC6EEEBC2580E8</th>
</tr>
</thead>
<tbody>
<tr>
<td>Thumbprint</td>
<td><span style="font-family: courier new, courier, monospace;">C8E6BF8B6FDA161BBFA5470BCC262B1BDC92A359</td>
</tr>
<tr>
<td>Subject CN</td>
<td>When They Cry CA</td>
</tr>
<tr>
<td>Subject O</td>
<td>N/A</td>
</tr>
<tr>
<td>Subject L</td>
<td>N/A</td>
</tr>
<tr>
<td>Subject S</td>
<td>N/A</td>
</tr>
<tr>
<td>Subject C</td>
<td>N/A</td>
</tr>
<tr>
<td>Valid from</td>
<td>2022-08-13 17:48:44</td>
</tr>
<tr>
<td>Valid to</td>
<td>2032-08-13 17:58:44</td>
</tr>
</tbody>
</table></p>
<h3>Network</h3>
<p><table>
<thead>
<tr>
<th>IP</th>
<th>Domain</th>
<th>Hosting provider</th>
<th>First seen</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td>N/A</td>
<td><span style="font-family: courier new, courier, monospace;">xrepositoryx[.]name</td>
<td>N/A</td>
<td><span class=nobr>2022&#8209;10&#8209;17</span></td>
<td>BlackLotus C&C.  <span style="font-family: courier new, courier, monospace;">https://xrepositoryx[.]name/network/API/hpb_gate.php</td>
</tr>
<tr>
<td>N/A</td>
<td><span style="font-family: courier new, courier, monospace;">myrepositoryx[.]com</td>
<td>N/A</td>
<td><span class=nobr>2022&#8209;10&#8209;16</span></td>
<td>BlackLotus C&C.<br />
<span style="font-family: courier new, courier, monospace;">https://myrepositoryx[.]com/network/API/hpb_gate.php</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">104.21.22[.]185</td>
<td><span style="font-family: courier new, courier, monospace;">erdjknfweklsgwfmewfgref[.]com</td>
<td>Cloudflare,&nbsp;Inc.</td>
<td><span class=nobr>2022&#8209;10&#8209;06</span></td>
<td>BlackLotus C&C.<br />
<span style="font-family: courier new, courier, monospace;">https://erdjknfweklsgwfmewfgref[.]com/API/hpb_gate.php</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">164.90.172[.]211</td>
<td><span style="font-family: courier new, courier, monospace;">harrysucksdick[.]com</td>
<td>DigitalOcean,&nbsp;LLC</td>
<td><span class=nobr>2022&#8209;10&#8209;09</span></td>
<td>BlackLotus C&C.<br />
<span style="font-family: courier new, courier, monospace;">https://harrysucksdick[.]com/API/hpb_gate.php</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">185.145.245[.]123</td>
<td><span style="font-family: courier new, courier, monospace;">heikickgn[.]com<br />
frassirishiproc[.]com</td>
<td>SIA VEESP</td>
<td><span class=nobr>2022&#8209;10&#8209;12</span></td>
<td>BlackLotus C&C.<br />
<span style="font-family: courier new, courier, monospace;">https://heikickgn[.]com/API/hpb_gate.php<br />
<span style="font-family: courier new, courier, monospace;">https://frassirishiproc[.]com/API/hpb_gate.php</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">185.150.24[.]114</td>
<td><span style="font-family: courier new, courier, monospace;">myrepository[.]name</td>
<td>SkyLink Data Center BV</td>
<td><span class=nobr>2022&#8209;10&#8209;14</span></td>
<td>BlackLotus C&C.<br />
<span style="font-family: courier new, courier, monospace;">myrepository[.]name/network/API/hpb_gate.php</td>
</tr>
<tr>
<td><span style="font-family: courier new, courier, monospace;">190.147.189[.]122</td>
<td><span style="font-family: courier new, courier, monospace;">egscorp[.]net</td>
<td>Telmex Colombia S.A.</td>
<td><span class=nobr>2022&#8209;08&#8209;24</span></td>
<td>BlackLotus C&C.<br />
<span style="font-family: courier new, courier, monospace;">https://egscorp[.]net/API/hpb_gate.php</td>
</tr>
</tbody>
</table></p>
<h2>MITRE ATT&amp;CK techniques</h2>
<p><em>This table was built using <a href="https://attack.mitre.org/resources/versions/">version 12</a> of the MITRE ATT&amp;CK framework<strong>.</strong></em></p>
<p><table>
<thead>
<tr>
<th>Tactic</th>
<th>ID</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2">Resource Develpment</td>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1587/002/" target="_blank" rel="noopener">T1587.002</a></td>
<td>Develop Capabilities: Code Signing Certificates</td>
<td>Some BlackLotus samples are signed with self-signed certificate.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1588/005/" target="_blank" rel="noopener">T1588.005</a></td>
<td>Obtain Capabilities: Exploits</td>
<td>BlackLotus used publicly known exploit to bypass UEFI Secure Boot.</td>
</tr>
<tr>
<td rowspan="4">Execution</td>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1203/" target="_blank" rel="noopener">T1203</a></td>
<td>Exploitation for Client Execution</td>
<td>BlackLotus installers can exploit CVE-2022-21894 to achieve arbitrary code execution on the systems with UEFI Secure Boot enabled.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1559/" target="_blank" rel="noopener">T1559</a></td>
<td>Inter-Process Communication</td>
<td>BlackLotus HTTP downloader uses named section to pass commands to the kernel-mode component.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1106/" target="_blank" rel="noopener">T1106</a></td>
<td>Native API</td>
<td>BlackLotus HTTP downloader uses various native Windows APIs to achieve code execution on the compromised machine.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1129/" target="_blank" rel="noopener">T1129</a></td>
<td>Shared Modules</td>
<td>BlackLotus HTTP downloader can load and execute DLLs received from the C&amp;C server.</td>
</tr>
<tr>
<td>Persistence</td>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1542/003/" target="_blank" rel="noopener">T1542.003</a></td>
<td>Pre-OS Boot: Bootkit</td>
<td>BlackLotus bootkit is deployed on the EFI System Partition and executed during the boot.</td>
</tr>
<tr>
<td rowspan="2">Privilege Escalation</td>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1548/002/" target="_blank" rel="noopener">T1548.002</a></td>
<td>Abuse Elevation Control Mechanism: Bypass User Account Control</td>
<td>BlackLotus installer attempts to escalate privileges by bypassing User Account Control.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1134/002/" target="_blank" rel="noopener">T1134.002</a></td>
<td>Access Token Manipulation: Create Process with Token</td>
<td>BlackLotus HTTP downloader can use WTSQueryUserToken and CreateProcessAsUserW to execute downloaded payloads within a new process with local system privileges.</td>
</tr>
<tr>
<td rowspan="15">Defense Evasion &nbsp;&nbsp;</td>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1622/" target="_blank" rel="noopener">T1622</a></td>
<td>Debugger Evasion</td>
<td>BlackLotus components use various techniques to detect whether a kernel-mode or user-mode debugger is running on a victim.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1574/" target="_blank" rel="noopener">T1574</a></td>
<td>Hijack Execution Flow</td>
<td>BlackLotus bootkit hijacks various components included in the early Windows boot process stages (Windows Boot Manager, Windows OS loader, Windows kernel and specific drivers) to avoid detection by deactivating various Windows security features (VBS, Windows Defender) and stealthily execute its kernel-mode and user-mode components</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1562/" target="_blank" rel="noopener">T1562</a></td>
<td>Impair Defenses</td>
<td>BlackLotus components can disable BitLocker and Windows Defender to avoid detection.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1070/004/" target="_blank" rel="noopener">T1070.004</a></td>
<td>Indicator Removal: File Deletion</td>
<td>BlackLotus installer deletes itself after successfully deploying files to the EFI System partition. Also after successful CVE-2022-21894 exploitation, BlackLotus removes traces of exploitation by deleting all files included in exploitation chain from EFI System Partition.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1070/009/" target="_blank" rel="noopener">T1070.009</a></td>
<td>Indicator Removal: Clear Persistence</td>
<td>BlackLotus can uninstall itself by removing all bootkit files from the ESP and restoring original victim&rsquo;s Windows Boot Manager.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1036/005/" target="_blank" rel="noopener">T1036.005</a></td>
<td>Masquerading: Match Legitimate Name or Location</td>
<td>BlackLotus attempts to hide its files deployed on the ESP by using legitimate filenames, such as grubx64.efi (if UEFI Secure Boot is enabled on compromised machine) or bootmgfw.efi (if UEFI Secure Boot is disabled on compromised machine).</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1112/" target="_blank" rel="noopener">T1112</a></td>
<td>Modify Registry</td>
<td>BlackLotus installer modifies Windows registry to disable Windows HVCI security feature.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1027/" target="_blank" rel="noopener">T1027</a></td>
<td>Obfuscated Files or Information</td>
<td>Almost all embedded strings in BlackLotus components are encrypted using a custom combined cipher and decrypted only when needed.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1027/007/" target="_blank" rel="noopener">T1027.007</a></td>
<td>Obfuscated Files or Information: Dynamic API Resolution</td>
<td>BlackLotus components use dynamic API resolution while using API names&rsquo; hashes instead of names.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1027/009/" target="_blank" rel="noopener">T1027.009</a></td>
<td>Obfuscated Files or Information: Embedded Payloads</td>
<td>Almost all embedded files in BlackLotus components are encrypted using AES.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1542/003/" target="_blank" rel="noopener">T1542.003</a></td>
<td>Pre-OS Boot: Bootkit</td>
<td>BlackLotus bootkit is deployed on the EFI System Partition and executed during the early OS boot stages, and thus is capable of controlling the OS boot process and evading detection.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1055/012/" target="_blank" rel="noopener">T1055.012</a></td>
<td>Process Injection: Dynamic-link Library Injection</td>
<td>BlackLotus HTTP downloader can inject a DLL into a newly created <span style="font-family: courier new, courier, monospace;">svchost.exe</span> process using process hollowing.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1055/002/" target="_blank" rel="noopener">T1055.002</a></td>
<td>Process Injection: Portable Executable Injection</td>
<td>BlackLotus driver injects the HTTP downloader portable executable into a <span style="font-family: courier new, courier, monospace;">winlogon.exe</span> process.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1014/" target="_blank" rel="noopener">T1014</a></td>
<td>Rootkit</td>
<td>BlackLotus kernel driver protects the bootkit files on the ESP from removal.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1497/001/" target="_blank" rel="noopener">T1497.001</a></td>
<td>Virtualization/Sandbox Evasion: System Checks</td>
<td>BlackLotus employs various system checks including checking sandbox-specific registry values, to detect and avoid virtualization and analysis environments.</td>
</tr>
<tr>
<td rowspan="6">Discovery</td>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1622/" target="_blank" rel="noopener">T1622</a></td>
<td>Debugger Evasion</td>
<td>BlackLotus components use various techniques to detect whether a kernel-mode or user-mode debugger is running on a victim.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1082/" target="_blank" rel="noopener">T1082</a></td>
<td>System Information Discovery</td>
<td>BlackLotus collects system information (IP, GPU, CPU, memory, OS version) on a compromised host.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1614/" target="_blank" rel="noopener">T1614</a></td>
<td>System Location Discovery</td>
<td>BlackLotus can exit if one of the following system locales is identified on the compromised host: <span style="font-family: courier new, courier, monospace;">ro-MD, ru-MD, ru-RU, uk-UA, be-BY, hy-AM, kk-KZ</span>.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1016/" target="_blank" rel="noopener">T1016</a></td>
<td>System Network Configuration Discovery</td>
<td>BlackLotus HTTP downloader can determine the public IP of a compromised host by requesting <span style="font-family: courier new, courier, monospace;">api.ipify[.]org</span> service.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1016/001/" target="_blank" rel="noopener">T1016.001</a></td>
<td>System Network Configuration Discovery: Internet Connection Discovery</td>
<td>BlackLotus HTTP downloader checks the internet connection by querying Microsoft&rsquo;s <span style="font-family: courier new, courier, monospace;">www.msftncsi[.]com/ncsi[.]txt</span></td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1497/001/" target="_blank" rel="noopener">T1497.001</a></td>
<td>Virtualization/Sandbox Evasion: System Checks</td>
<td>BlackLotus employs various system checks including checking sandbox-specific registry values, to detect and avoid virtualization and analysis environments.</td>
</tr>
<tr>
<td rowspan="4">Command and Control</td>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1071/001/" target="_blank" rel="noopener">T1071.001</a></td>
<td>Application Layer Protocol: Web Protocols</td>
<td>BlackLotus uses HTTPS for communication with its C&amp;C.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1132/001/" target="_blank" rel="noopener">T1132.001</a></td>
<td>Data Encoding: Standard Encoding</td>
<td>BlackLotus encodes encrypted data in C&amp;C communication with URL-safe base64.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1573/001/" target="_blank" rel="noopener">T1573.001</a></td>
<td>Encrypted Channel: Symmetric Cryptography</td>
<td>BlackLotus uses 256-bit AES in CBC mode to decrypt messages received from its C&amp;C.</td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v12/techniques/T1573/002/" target="_blank" rel="noopener">T1573.002</a></td>
<td>Encrypted Channel: Asymmetric Cryptography</td>
<td>BlackLotus uses an embedded RSA public key to encrypt messages sent to C&amp;C.</td>
</tr>
</tbody>
</table></p>
<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=blacklotus-uefi-bootkit-myth-confirmed" target="_blank" rel="noopener"><img class="aligncenter wp-image-168101 size-full" src="https://web-assets.esetstatic.com/wls/2022/12/eset-threat-intelligence.png" alt="" width="915" height="296" /></a></p>
</div>                
                <div class="article-subscribe-form mb-4">
                    <hr />
                    <div class="form-wrapper">
  <div class="overlay">
    <h2 class="title">
      Let us keep you <br class='d-md-none'>up to date
    </h2>
    <p class="subtitle">
      Sign up for our newsletters
    </p>
    <div class="form">
        <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter px-0" target="_blank" method="post" role="search">
            <div class="search-input clearfix">
                <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Your Email Address" required>
                    <input type="checkbox" id="TOPIC" name="TOPIC" value="We Live Security Ukraine Newsletter">
                    <label for="TOPIC">Ukraine Crisis newsletter</label>
                    <input type="checkbox" id="NEWSLETTER" name="NEWSLETTER" value="We Live Security">
                    <label for="NEWSLETTER">Regular weekly newsletter</label>
                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="0">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                <button type="submit" class="redirect-button primary">Subscribe</button>
            </div>
        </form>
    </div>
  </div>
  <svg class="wave-overlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 201.7451"><g><path class="cls-1" d="m600,0v176.576c0,13.8934-11.2757,25.1691-25.1691,25.1691H25.1691c-13.9034,0-25.1691-11.2757-25.1691-25.1691v-110.6331c36.0722,38.8207,82.2223,71.8325,145.2255,88.6052.0402,0,.0805.0101.1107.0301,0,0,.0906,0,.1107.0302,108.7605,28.9444,198.3321-8.95,271.9366-49.865l29.5585-16.9537L600,0Z" /></g></svg></div>                </div>

                                    <div class="d-block">
                        <div class="post-related-articles">
        <h4 class="articles-title-divider py-4 my-2">
            Related Articles
        </h4>
            <div class="articles-card-grid row g-0 pb-2 pb-md-3"><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/ransomware/first-known-ai-powered-ransomware-uncovered-eset-research/" title="First known AI-powered ransomware uncovered by ESET Research"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">First known AI-powered ransomware uncovered by ESET Research</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2025/08-25/ai-powered-ransomware.jpeg" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2025/08-25/ai-powered-ransomware.jpeg" alt="First known AI-powered ransomware uncovered by ESET Research" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">First known AI-powered ransomware uncovered by ESET Research</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/eset-research/update-winrar-tools-now-romcom-and-others-exploiting-zero-day-vulnerability/" title="Update WinRAR tools now: RomCom and others exploiting zero-day vulnerability"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">Update WinRAR tools now: RomCom and others exploiting zero-day vulnerability</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2025/08-25/winrar/winrar-zeroday-vulnerability-romcom-apt-eset-research.jpeg" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2025/08-25/winrar/winrar-zeroday-vulnerability-romcom-apt-eset-research.jpeg" alt="Update WinRAR tools now: RomCom and others exploiting zero-day vulnerability" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">Update WinRAR tools now: RomCom and others exploiting zero-day vulnerability</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/eset-research/toolshell-an-all-you-can-eat-buffet-for-threat-actors/" title="ToolShell: An all-you-can-eat buffet for threat actors"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">ToolShell: An all-you-can-eat buffet for threat actors</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2025/07-25/toolshell/toolshell-vulnerability-exploitation-research-eset.jpeg" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2025/07-25/toolshell/toolshell-vulnerability-exploitation-research-eset.jpeg" alt="ToolShell: An all-you-can-eat buffet for threat actors" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><div class="article-tags mb-1 dark small"><p class="article-tag text-capitalize">ESET Research</p></div><p class="title">ToolShell: An all-you-can-eat buffet for threat actors</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div></div></div>                    </div>
                            </div>
            <div id="article-page-sidebar" class="sidebar col col-lg-4 ps-5 d-none d-lg-block position-sticky">
                                    <div class="sidebar-section--table-of-contents">
                        <div class="sticky-top sticky-top--container">
                            <nav class="table-of-contents" data-controller="toggle">
        <h2 class="table-of-contents__title">
            Table of Contents
        </h2>
</nav>
                        </div>
                    </div>
                    <div class="sidebar-section--banner">
                        <div class="sticky-top sticky-top--container">
                                                                                                <a class="d-block sidebar-card-banner" href="https://www.eset.com/us/business/services/threat-intelligence/" title="ESET Threat Intelligence" target="_blank">
    <img src="https://www.welivesecurity.com/build/assets/eset-threat-intelligence-d0944f00.webp" alt="ESET Threat Intelligence" class="w-100" >
</a>                                                                                    </div>
                    </div>
                    <div class="sidebar-section--similar-articles">
                        <div class="sticky-top sticky-top--container">
                                                                                                                    <div class="pb-4">
                                <div class="share-article-card">
                                    <div class="sidebar-card-media">
    <div class="mb-3">
        <h3 class="articles-title-divider">Share Article</h3>    </div>
    <div class="medias">
        <a href="https://www.facebook.com/sharer/sharer.php?u&#x3D;https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/" title="Facebook" >
            <svg id="Layer_2" fill="#949ca1" class="facebook" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m30.9623,26.8125l.8054-5.2483h-5.0359v-3.4058c0-1.4358.7035-2.8354,2.9589-2.8354h2.2894v-4.4684s-2.0776-.3546-4.064-.3546c-4.1472,0-6.858,2.5137-6.858,7.0642v4h-4.61v5.2483h4.61v12.6875h5.6737v-12.6875h4.2305Z" /></g></svg>        </a>
        <a href="https://www.linkedin.com/shareArticle?mini&#x3D;true&amp;url&#x3D;https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/" title="LinkedIn" >
            <svg id="Layer_2" fill="#949ca1" class="linkedin" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m18.7686,35.9995h-4.9757v-16.0232h4.9757v16.0232Zm-2.4905-18.2089c-1.5911,0-2.8816-1.3179-2.8816-2.9089.0002-1.5915,1.2906-2.8814,2.882-2.8812,1.5911.0002,2.881,1.29,2.8812,2.8812,0,1.5911-1.2911,2.9089-2.8816,2.9089Zm21.113,18.2089h-4.965v-7.8c0-1.8589-.0375-4.2429-2.587-4.2429-2.587,0-2.9834,2.0196-2.9834,4.1089v7.9339h-4.9704v-16.0232h4.7721v2.1857h.0696c.6643-1.2589,2.287-2.5875,4.7079-2.5875,5.0357,0,5.9614,3.3161,5.9614,7.6232v8.8018h-.0054Z" /></g></svg>        </a>
        <a href="https://twitter.com/intent/tweet?url&#x3D;https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/" title="Twitter" >
            <svg id="Layer_2" fill="#949ca1" class="twitter" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="Layer_1-2"><g id="x"><g transform="scale(0.75) translate(8.33, 8.33)"><path fill="#fff" d="M 5.9199219 6 L 20.582031 27.375 L 6.2304688 44 L 9.4101562 44 L 21.986328 29.421875 L 31.986328 44 L 44 44 L 28.681641 21.669922 L 42.199219 6 L 39.029297 6 L 27.275391 19.617188 L 17.933594 6 L 5.9199219 6 z M 9.7167969 8 L 16.880859 8 L 40.203125 42 L 33.039062 42 L 9.7167969 8 z"/></g></g></g></g></svg>        </a>
        <a href="mailto:?&amp;subject&#x3D;I wanted you to see this site&amp;body&#x3D;https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/" title="mail" >
            <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path id="Path_7761" fill="white"d="m13.1593,14.9378c-.2808,0-.5616.0936-.8424.1872l11.8875,11.5131c.3744.468,1.0296.468,1.404.0936.0936,0,.0936-.0936.0936-.0936l12.0747-11.5131c-.2808-.0936-.5616-.1872-.7488-.1872H13.1593Zm-2.1529,1.9656v15.8188c-.0936,1.2168.8424,2.2465,2.0593,2.3401h23.8686c1.2168-.0936,2.1529-1.1232,2.0593-2.3401v-15.7252l-11.7939,11.3259c-1.2168,1.2168-3.1825,1.2168-4.3057,0l-11.8875-11.4195Z" /></g></svg>        </a>
        <a href="https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/" title="copy" class="copy-link" >
            <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m32.2813,27.4375l3.7-3.7c2.7-2.7,2.7-7,0-9.7-2.7-2.7-7-2.7-9.7,0h0l-5.3,5.3c-2.7,2.7-2.7,7,0,9.7.4.4.8.7,1.3,1l2.8-2.8c-.6-.1-1.1-.4-1.5-.8-1.2-1.2-1.2-3.2,0-4.4l5.3-5.3c1.3-1.2,3.2-1.1,4.4.1,1.1,1.2,1.1,3.1,0,4.3l-1.6,1.6c.7,1.4.9,3.1.6,4.7h0Zm-14.7-4.7l-3.6,3.6c-2.7,2.7-2.6,7,0,9.7,2.7,2.6,6.9,2.6,9.6,0l5.3-5.3c2.7-2.7,2.7-7,0-9.7-.4-.4-.8-.7-1.3-1l-2.8,2.8c1.7.4,2.7,2.1,2.3,3.7-.1.6-.4,1.1-.8,1.5l-5.3,5.4c-1.2,1.3-3.1,1.3-4.4.1-1.3-1.2-1.3-3.1-.1-4.4,0-.1.1-.1.1-.1l1.6-1.5c-.7-1.6-.9-3.2-.6-4.8h0Z" /></g></svg>        </a>
    </div>
</div>                                </div>
                            </div>
                        </div>
                    </div>
                            </div>
        </div>

        <div class="row">
            <div class="col col-lg-8 pe-lg-0">
                <div class="my-4">
                    <h3 class="articles-title-divider">Discussion</h3>
                </div>

                <div id="disqus_thread"></div>

            </div>
        </div>
    </div>
        </div>
        
        <!-- footer -->
        
        <footer class="page-footer">
  <div class="container">
    <div class="row g-0">
      <div class="col page-info-wrapper">
        <div class="logo-wrapper">
          <div class="logo">
            <a href="/en/" title="Welivesecurity">
              <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>            </a>
          </div>
        </div>
        <div class="page-info">
          <p>
            Award-winning news, views, and insight from the ESET security community
          </p>
        </div>
      </div>
      <div class="col footer-links">
        <a href="/en/company/about-us/" title="About us" 
         >About us</a>
        <a href="https://www.eset.com/us" title="ESET" 
         >ESET</a>
        <a href="/en/company/contact-us/" title="Contact us" 
         >Contact us</a>
        <a href="/en/company/privacy/" title="Privacy Policy" 
         >Privacy Policy</a>
        <a href="/en/company/legal-information/" title="Legal Information" 
         >Legal Information</a>
        <a href="/en/#" title="Manage Cookies" id="manage-cookies" 
         onclick="event.preventDefault()" >Manage Cookies</a>
        <a href="/en/rss/feed/" title="RSS Feed" 
         >RSS Feed</a>
      </div>
      <div class="col social-networks">
        <a href="https://www.facebook.com/eset/" title="Join our facebook fan site!">
          <svg id="Layer_2" fill="#949ca1" class="facebook" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m30.9623,26.8125l.8054-5.2483h-5.0359v-3.4058c0-1.4358.7035-2.8354,2.9589-2.8354h2.2894v-4.4684s-2.0776-.3546-4.064-.3546c-4.1472,0-6.858,2.5137-6.858,7.0642v4h-4.61v5.2483h4.61v12.6875h5.6737v-12.6875h4.2305Z" /></g></svg>        </a>
        <a href="https://youtube.com/esetglobal" title="Watch our videos at YouTube Channel.">
          <svg id="Layer_2" fill="#949ca1" class="youtube" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="Layer_1-2"><g id="youtube"><g id="SOCIAL_MEDIA"><path id="youtube-2" fill="white"d="m39.3741,17.7792c-.3492-1.2938-1.3598-2.3044-2.6536-2.6536-2.3399-.625-11.7206-.625-11.7206-.625,0,0-9.3745,0-11.7206.625-1.2941.3485-2.305,1.3594-2.6536,2.6536-.4319,2.3823-.6412,4.7997-.6249,7.2208-.0162,2.4211.193,4.8385.625,7.2208.3478,1.2946,1.359,2.3058,2.6536,2.6536,2.3399.625,11.7206.625,11.7206.625,0,0,9.3807,0,11.7206-.625,1.2942-.3485,2.3051-1.3594,2.6536-2.6536.4315-2.3824.6408-4.7997.625-7.2208.0158-2.4211-.1934-4.8384-.625-7.2208h0Zm-17.374,11.7205v-8.9994l7.7933,4.4997-7.7933,4.4997Z" /></g></g></g></g></svg>        </a>
        <a href="https://twitter.com/ESET" title="Visit the official WLS Twitter page.">
          <svg id="Layer_2" fill="#949ca1" class="twitter" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="Layer_1-2"><g id="x"><g transform="scale(0.75) translate(8.33, 8.33)"><path fill="#fff" d="M 5.9199219 6 L 20.582031 27.375 L 6.2304688 44 L 9.4101562 44 L 21.986328 29.421875 L 31.986328 44 L 44 44 L 28.681641 21.669922 L 42.199219 6 L 39.029297 6 L 27.275391 19.617188 L 17.933594 6 L 5.9199219 6 z M 9.7167969 8 L 16.880859 8 L 40.203125 42 L 33.039062 42 L 9.7167969 8 z"/></g></g></g></g></svg>        </a>
        <a href="https://www.linkedin.com/company/eset" title="Follow us on LinkedIn.">
          <svg id="Layer_2" fill="#949ca1" class="linkedin" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m18.7686,35.9995h-4.9757v-16.0232h4.9757v16.0232Zm-2.4905-18.2089c-1.5911,0-2.8816-1.3179-2.8816-2.9089.0002-1.5915,1.2906-2.8814,2.882-2.8812,1.5911.0002,2.881,1.29,2.8812,2.8812,0,1.5911-1.2911,2.9089-2.8816,2.9089Zm21.113,18.2089h-4.965v-7.8c0-1.8589-.0375-4.2429-2.587-4.2429-2.587,0-2.9834,2.0196-2.9834,4.1089v7.9339h-4.9704v-16.0232h4.7721v2.1857h.0696c.6643-1.2589,2.287-2.5875,4.7079-2.5875,5.0357,0,5.9614,3.3161,5.9614,7.6232v8.8018h-.0054Z" /></g></svg>        </a>
        <a href="https://www.welivesecurity.com/rss-configurator/" title="Don¬¥t miss a single post!">
          <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="rss"><g id="SOCIAL_MEDIA"><path id="rss-2" fill="white"d="m16.9299,36.9089c-1.8039-.0139-3.255-1.4876-3.2411-3.2915.0139-1.8039,1.4876-3.255,3.2915-3.2411,1.7931.0138,3.2398,1.4706,3.2412,3.2638-.006,1.8113-1.4791,3.2748-3.2904,3.2688-.0004,0-.0008,0-.0012,0Zm12.6168,0c-.0331-8.7521-7.1549-15.8203-15.907-15.7872h-.0014v4.6272c6.1869-.0232,11.2214,4.9731,11.2452,11.16h4.6632Zm8.0916,0c-.0503-13.2044-10.7953-23.8679-23.9997-23.8176-.0001,0-.0002,0-.0003,0v4.7628c10.5637-.0398,19.1597,8.4911,19.2,19.0548h4.8Z" /></g></g></g></svg>        </a>
      </div>
    </div>
    <div class="row g-0">
      <div class="col copyright">
        Copyright ¬© ESET, All Rights Reserved
      </div>
    </div>
  </div>
</footer>    </div>

    <!-- scroll to top button -->
    <button id="scrollToTopBtn" aria-label="Scroll to top">
    <svg viewBox="0 0 45 45">
        <defs>
            <style>
                .st0 {
                    fill: #949ca1;
                }
            </style>
        </defs>
        <g id="Group_1214">
            <polygon class="st0" points="36.1 26.9 34.6 28.5 22.9 16.8 11.2 28.5 9.7 26.9 22.9 13.7 36.1 26.9"/>
            <path id="Ellipse_360" class="st0" d="M22.5,2c-11.3,0-20.5,9.2-20.5,20.5,0,8.2,4.9,15.7,12.5,18.9,10.4,4.4,22.5-.5,26.9-10.9s-.5-22.5-10.9-26.9h0c-2.5-1.1-5.2-1.6-8-1.6M22.5,0C34.9,0,45,10.1,45,22.5s-10.1,22.5-22.5,22.5S0,34.9,0,22.5,10.1,0,22.5,0Z"/>
        </g>
    </svg>
</button>    <!-- scripts -->
    <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/app-7a4ecde0.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/app-7a4ecde0.js"></script>    <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/scrollToTopBtn-bfad6333.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/scrollToTopBtn-bfad6333.js"></script>    <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/search-9bd6bdd3.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/_commonjsHelpers-042e6b4d.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/search-9bd6bdd3.js"></script>        
<script>

    var disqus_config = function () {
        this.page.url = "https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/";
        this.page.identifier = "BlackLotus UEFI bootkit: Myth confirmed";
        this.page.title = "12716";
        this.language = "en";
    };
   
    (function() {
        var d = document, s = d.createElement('script');

        s.src = 'https://welivesecurity.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();

</script>

    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/prism-40494b65.css" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/prism-40d1b0a4.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/_commonjsHelpers-042e6b4d.js" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/prism-40494b65.css" /><script type="module" src="https://www.welivesecurity.com/build/assets/prism-40d1b0a4.js"></script>    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/article-e3625c4c.css" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/article-98874652.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/table-wrapper-135558d1.js" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/article-e3625c4c.css" /><script type="module" src="https://www.welivesecurity.com/build/assets/article-98874652.js"></script>            <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/tableOfContents-3064eaf8.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/tableOfContents-3064eaf8.js"></script>    </body>
</html>
